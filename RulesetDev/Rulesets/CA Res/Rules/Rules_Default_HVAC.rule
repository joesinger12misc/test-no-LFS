; -------------------------------------------------------------------------
; Rules pertaining to:   Defaulting the Proposed Building Model's HVAC objects
; CEC Title-24 Residential Energy Code
; -------------------------------------------------------------------------
; Copyright (c) 2012-2014, California Energy Commission
; Copyright (c) 2012-2014, Wrightsoft Corporation
; All rights reserved.
; Redistribution and use in source and binary forms, with or without modification,
; are permitted provided that the following conditions are met:
; - Redistributions of source code must retain the above copyright notice, this
;   list of conditions and the following disclaimer.
; - Redistributions in binary form must reproduce the above copyright notice, this
;   list of conditions, the following disclaimer in the documentation and/or other
;   materials provided with the distribution.
; - Neither the name of the California Energy Commission nor the names of its
;   contributors may be used to endorse or promote products derived from this
;   software without specific prior written permission.
; DISCLAIMER: THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
; "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
; THE IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
; NON-INFRINGEMENT ARE DISCLAIMED. IN NO EVENT SHALL CALIFORNIA ENERGY COMMISSION,
; WRIGHTSOFT CORPORATION, ITRON, INC. OR ANY OTHER AUTHOR OR COPYRIGHT HOLDER OF
; THIS SOFTWARE (COLLECTIVELY, THE "AUTHORS") BE LIABLE FOR ANY DIRECT, INDIRECT,
; INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
; LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
; OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
; LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
; OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
; ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.  EACH LICENSEE AND SUBLICENSEE OF THE
; SOFTWARE AGREES NOT TO ASSERT ANY CLAIM AGAINST ANY OF THE AUTHORS RELATING TO
; THIS SOFTWARE, WHETHER DUE TO PERFORMANCE ISSUES, TITLE OR INFRINGEMENT ISSUES,
; STRICT LIABILITY OR OTHERWISE.
; -------------------------------------------------------------------------

; SAC 10/24/16 - new rulelist to default zone height, HVAC & cool vent properties
;*************************************************************************
RULELIST "ProposedInput_HVAC" 0 0 0 0
;*************************************************************************
   ;--------------------------------------------------------------------
   ; ProposedInput: HVAC System Rules
   ;--------------------------------------------------------------------
;	"Set Zone:Top"			Zone:Top 	= {	Local( Bottom ) + (Local( FloorHeight ) * Local( NumStories ))  }
	"Set Zone:Top"			Zone:Top 	= {	Bottom + (FloorHeight * (NumStories - 1)) + CeilingHeight  }
	"Set OtherZone:Top"	OtherZone:Top 	= {	Bottom + (FloorHeight * (NumStories - 1)) + ValidOr( CeilingHeight, 9 )  }      ; SAC 9/18/19 - (MFamProto)

; debugging
;"dbg" Proj:Action = { MessageBox( "Proj:NumStories >\n   MaxAll( Zone:Top ) = %g\n   MaxAll( OtherZone:Top ) = %g\n   MinAll( Zone:Bottom ) = %g\n   MinAll( OtherZone:Bottom ) = %g\n   SumAll( Zone:CeilingHeight ) = %g\n   SumAll( OtherZone:CeilingHeight ) = %g\n   # Zone + OtherZone = %g",
;            MaxAll( Zone:Top ), MaxAll( OtherZone:Top ), MinAll( Zone:Bottom ), MinAll( OtherZone:Bottom ), SumAll( Zone:CeilingHeight ), SumAll( OtherZone:CeilingHeight ), ComponentCount( Zone ) + ComponentCount( OtherZone ) ) }
	; SAC 10/22/12 - should work reasonably well for floors < 4-5 and floor & ceiling heights fairly close to each other
	; SAC 4/8/13 - added "2 +" into formulaa to resolve issue believed to be decimal precision related, causing Proj:NumStories to truncate to 0
	"Set Proj:NumStories"			Proj:NumStories		= {
		if (ComponentCount( Zone ) < 1 .AND. ComponentCount( OtherZone ) < 1) then  1
		else if (SumAll( Zone:CeilingHeight ) < 1 .AND. SumAll( OtherZone:CeilingHeight ) < 1) then  1
		else if (ComponentCount( Zone ) > 0 .AND. ComponentCount( OtherZone ) > 0)
		then  (2 + max( MaxAll( Zone:Top    ), MaxAll( OtherZone:Top    ) ) -
		           min( MinAll( Zone:Bottom ), MinAll( OtherZone:Bottom ) )) / 
		       ((SumAll( Zone:CeilingHeight ) + SumAll( OtherZone:CeilingHeight )) /
		        (ComponentCount( Zone ) + ComponentCount( OtherZone )))
		else  (2 + MaxAll( Zone:Top ) - MinAll( Zone:Bottom )) / 
		       (SumAll( Zone:CeilingHeight ) / ComponentCount( Zone ))
		endif endif endif  }

   "Set Zone:Top_HasDHW"            Zone:Top_HasDHW         = {   if (HasDHWUse) then  Top     else  UNDEFINED  endif  }      ; SAC 08/30/20
   "Set OtherZone:Top_HasDHW"       OtherZone:Top_HasDHW    = {   if (HasDHWUse) then  Top     else  UNDEFINED  endif  }
   "Set Zone:Bottom_HasDHW"         Zone:Bottom_HasDHW      = {   if (HasDHWUse) then  Bottom  else  UNDEFINED  endif  }
   "Set OtherZone:Bottom_HasDHW"    OtherZone:Bottom_HasDHW = {   if (HasDHWUse) then  Bottom  else  UNDEFINED  endif  }
	"Set Proj:NumStories_HasDHW"		Proj:NumStories_HasDHW	=                                ; added for DHW-related calcs - SAC 08/30/20
	{	if (ComponentCount( Zone ) < 1 .AND. ComponentCount( OtherZone ) < 1) then  1
		else if (SumAll( Zone:Top_HasDHW ) < 1 .AND. SumAll( OtherZone:Top_HasDHW ) < 1) then  1
		else if (ComponentCount( Zone ) > 0 .AND. ComponentCount( OtherZone ) > 0)
		then  (2 + max( MaxAll( Zone:Top_HasDHW    ), MaxAll( OtherZone:Top_HasDHW    ) ) -
		           min( MinAll( Zone:Bottom_HasDHW ), MinAll( OtherZone:Bottom_HasDHW ) )) / 
		       ((SumAcrossIf( Zone:CeilingHeight, Zone:HasDHWUse ) + SumAcrossIf( OtherZone:CeilingHeight, OtherZone:HasDHWUse )) /
		        (SumAll( Zone:HasDHWUse ) + SumAll( OtherZone:HasDHWUse )))
		else  (2 + MaxAll( Zone:Top_HasDHW ) - MinAll( Zone:Bottom_HasDHW )) / 
		       (SumAcrossIf( Zone:CeilingHeight, Zone:HasDHWUse ) / SumAll( Zone:HasDHWUse ))
		endif endif endif  }

   "Call rulelist to UN-assign HVACSys objects from Zones in MFam models"     Zone:Action =        ; SAC 04/09/21
      {  if (Proj:IsMultiFamily < 0.5 .OR. Proj:RunAbbrev != "u" .OR. IfValidAnd( Proj:DefaultingRounds > 2 )) then  UNCHANGED   
         else if (LocalCompAssigned( HVACSystem    ) > 0 .OR.
                  LocalCompAssigned( AltHVACSystem ) > 0 .OR.
                  LocalCompAssigned( exHVACSystem  ) > 0)
         then  EvalRulelist( "Blast_Zone_HVACSys_Assignments", 1 )
         else  UNCHANGED  endif endif  }

;	mjb	10/27/14	Force assignment of HVACSystem from ActiveHVACSystem for AA & E+A+A when HVAC is existing
	"Force HVAC assignment for Additions Alone"	Zone:Action	=	{
	   if ( (Proj:IsAddAlone > 0.5 .OR. Proj:RunScope == 2) .AND. HVACSysStatus == 1)
	   then  EvalRulelist( "ForceDefault_Zone_HVAC", 1 )  else  UNCHANGED  endif  }

	"Consolidate all HVAC defaulting rules"	Proj:Action	= {	EvalRulelist( "Default_AllHVAC" )  }

   ; SAC 1/20/19 - moved HERE here mid-Shell defaulting to so that ClVentFan properties are defaulted before referenced (tic #1040)
   "Set Zone:ClVent*"	Proj:Action	= {	if (IsMultiFamily < 0.5)
														then  EvalRulelist( "Set_ZoneClVent_SFam" )
														else	EvalRulelist( "Set_ZoneClVent_MFam" )  endif  }

; SAC 12/31/15 - added new calcs & message to estimate & report attic relief vent free area for display in cool vent tab of project tabbed dialog (ticket #596)
	"Set Proj:ClVentAtticRelief"	Proj:ClVentAtticRelief	= {
		if (SumAll( Attic:ClVentableVolume ) < 0.1) then  0
		else if (UnitClVentOption == 3)		; CFI Cool Vent
		then	SumAll( HVACSys:AirNet_CoolVent   ) * UnitClVenTAreaMult / 
		         T24RClimateZoneCodeBase:WHFatticrelief( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
		else	ValidOr( Proj:UnitClVentCFMTot, 0 ) * UnitClVenTAreaMult / 
		         T24RClimateZoneCodeBase:WHFatticrelief( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase, "BldgType", Proj:BldgTypeTblStr )		endif endif  }
	"Set Proj:ClVentAtticRelMsg"	Proj:ClVentAtticRelMsg	= {
		if (ClVentAtticRelief < 0.01) then  " "
		else  Format( "%.1f ft2 of Attic Relief Vent Free Area", ClVentAtticRelief )  endif  }

   ; SAC 2/14/18 - added new cool vent fan power message (tic #977)
   ; SAC 1/20/19 - revised for new 'Whole House Fan exhausting to outside' UnitClVentOption option (tic #1040)
   "Set Proj:ClVentFanPowerTot-1"   Proj:ClVentFanPowerTot = {
      if ((EnableClVent < 0.5 .AND. LimitedClVent < 0.5) .OR. UnitClVentOption < 1) then  0
      else if (UnitClVentOption == 1 .OR. UnitClVentOption == 5)
      then 	T24RClimateZoneCodeBase:WHFWperCFM( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) * ValidOr( UnitClVentCFMTot, 0 )
      else if (UnitClVentOption == 2 .AND. LocalCompAssigned( UnitClVentFan[1] ))
      then	ValidOr( UnitClVentFan[1]:WperCFMCool, 0 ) * ValidOr( UnitClVentFan[1]:CoolingVent, 0 )
      else  0  endif endif endif  }
   "Set Proj:ClVentFanPowerTot-2"   Proj:ClVentFanPowerTot = {
      if (ClVentFanUI > 0 .AND. LocalCompAssigned( UnitClVentFan[2] ))
      then	ClVentFanPowerTot + (ValidOr( UnitClVentFan[2]:WperCFMCool, 0 ) * ValidOr( UnitClVentFan[2]:CoolingVent, 0 ))
      else  UNCHANGED  endif  }
   "Set Proj:ClVentFanPowerTot-3"   Proj:ClVentFanPowerTot = {
      if (ClVentFanUI > 0 .AND. LocalCompAssigned( UnitClVentFan[3] ))
      then	ClVentFanPowerTot + (ValidOr( UnitClVentFan[3]:WperCFMCool, 0 ) * ValidOr( UnitClVentFan[3]:CoolingVent, 0 ))
      else  UNCHANGED  endif  }
   "Set Proj:ClVentFanPowerTot-4"   Proj:ClVentFanPowerTot = {
      if (ClVentFanUI > 0 .AND. LocalCompAssigned( UnitClVentFan[4] ))
      then	ClVentFanPowerTot + (ValidOr( UnitClVentFan[4]:WperCFMCool, 0 ) * ValidOr( UnitClVentFan[4]:CoolingVent, 0 ))
      else  UNCHANGED  endif  }
   "Set Proj:ClVentFanPowerTot-5"   Proj:ClVentFanPowerTot = {
      if (ClVentFanUI > 0 .AND. LocalCompAssigned( UnitClVentFan[5] ))
      then	ClVentFanPowerTot + (ValidOr( UnitClVentFan[5]:WperCFMCool, 0 ) * ValidOr( UnitClVentFan[5]:CoolingVent, 0 ))
      else  UNCHANGED  endif  }
   "Set Proj:ClVentFanPowerTot-6"   Proj:ClVentFanPowerTot = {
      if (ClVentFanUI > 0 .AND. LocalCompAssigned( UnitClVentFan[6] ))
      then	ClVentFanPowerTot + (ValidOr( UnitClVentFan[6]:WperCFMCool, 0 ) * ValidOr( UnitClVentFan[6]:CoolingVent, 0 ))
      else  UNCHANGED  endif  }
   "Set Proj:ClVentFanPowerMsg"  Proj:ClVentFanPowerMsg = {
      if (IfValidAnd( ClVentFanPowerTot > 0 ) .AND. IfValidAnd( UnitClVentCFMTot > 0 ))
      then  Format( "%0.2f W/CFM (%s W)", (ClVentFanPowerTot / UnitClVentCFMTot), flttostr( ClVentFanPowerTot ) )
      else  UNDEFINED  endif  }

   "Set Proj:ClVentFansToAttic-1"      Proj:ClVentFansToAttic  =     ; SAC 4/23/19 (tic #1023)
      {  if (IsMultiFamily > 0) then  0
         else if (UnitClVentOption = 1 .OR. 
                 (UnitClVentOption = 2 .AND. IfValidAnd( UnitClVentNumFans >= 1 ) .AND. IfValidAnd( UnitClVentFan[1]:ExhaustsTo = 1 ))) then  1  else  0  endif endif  }
   "Set Proj:ClVentFansToAttic-2"      Proj:ClVentFansToAttic  =
      {  if (IsMultiFamily > 0) then  UNCHANGED
         else if (UnitClVentOption = 2 .AND. IfValidAnd( UnitClVentNumFans >= 2 ) .AND. IfValidAnd( UnitClVentFan[2]:ExhaustsTo = 1 ))
         then  ClVentFansToAttic + 1  else  UNCHANGED  endif endif  }
   "Set Proj:ClVentFansToAttic-3"      Proj:ClVentFansToAttic  =
      {  if (IsMultiFamily > 0) then  UNCHANGED
         else if (UnitClVentOption = 2 .AND. IfValidAnd( UnitClVentNumFans >= 3 ) .AND. IfValidAnd( UnitClVentFan[3]:ExhaustsTo = 1 ))
         then  ClVentFansToAttic + 1  else  UNCHANGED  endif endif  }
   "Set Proj:ClVentFansToAttic-4"      Proj:ClVentFansToAttic  =
      {  if (IsMultiFamily > 0) then  UNCHANGED
         else if (UnitClVentOption = 2 .AND. IfValidAnd( UnitClVentNumFans >= 4 ) .AND. IfValidAnd( UnitClVentFan[4]:ExhaustsTo = 1 ))
         then  ClVentFansToAttic + 1  else  UNCHANGED  endif endif  }
   "Set Proj:ClVentFansToAttic-5"      Proj:ClVentFansToAttic  =
      {  if (IsMultiFamily > 0) then  UNCHANGED
         else if (UnitClVentOption = 2 .AND. IfValidAnd( UnitClVentNumFans >= 5 ) .AND. IfValidAnd( UnitClVentFan[5]:ExhaustsTo = 1 ))
         then  ClVentFansToAttic + 1  else  UNCHANGED  endif endif  }
   "Set Proj:ClVentFansToAttic-6"      Proj:ClVentFansToAttic  =
      {  if (IsMultiFamily > 0) then  UNCHANGED
         else if (UnitClVentOption = 2 .AND. IfValidAnd( UnitClVentNumFans >= 6 ) .AND. IfValidAnd( UnitClVentFan[6]:ExhaustsTo = 1 ))
         then  ClVentFansToAttic + 1  else  UNCHANGED  endif endif  }

   "Set Proj:ClVentFansToOutsd-1"      Proj:ClVentFansToOutsd  =     ; SAC 4/23/19 (tic #1023)
      {  if (IsMultiFamily > 0) then  0
         else if (UnitClVentOption = 5 .OR. 
                 (UnitClVentOption = 2 .AND. IfValidAnd( UnitClVentNumFans >= 1 ) .AND. IfValidAnd( UnitClVentFan[1]:ExhaustsTo = 2 ))) then  1  else  0  endif endif  }
   "Set Proj:ClVentFansToOutsd-2"      Proj:ClVentFansToOutsd  =
      {  if (IsMultiFamily > 0) then  UNCHANGED
         else if (UnitClVentOption = 2 .AND. IfValidAnd( UnitClVentNumFans >= 2 ) .AND. IfValidAnd( UnitClVentFan[2]:ExhaustsTo = 2 ))
         then  ClVentFansToOutsd + 1  else  UNCHANGED  endif endif  }
   "Set Proj:ClVentFansToOutsd-3"      Proj:ClVentFansToOutsd  =
      {  if (IsMultiFamily > 0) then  UNCHANGED
         else if (UnitClVentOption = 2 .AND. IfValidAnd( UnitClVentNumFans >= 3 ) .AND. IfValidAnd( UnitClVentFan[3]:ExhaustsTo = 2 ))
         then  ClVentFansToOutsd + 1  else  UNCHANGED  endif endif  }
   "Set Proj:ClVentFansToOutsd-4"      Proj:ClVentFansToOutsd  =
      {  if (IsMultiFamily > 0) then  UNCHANGED
         else if (UnitClVentOption = 2 .AND. IfValidAnd( UnitClVentNumFans >= 4 ) .AND. IfValidAnd( UnitClVentFan[4]:ExhaustsTo = 2 ))
         then  ClVentFansToOutsd + 1  else  UNCHANGED  endif endif  }
   "Set Proj:ClVentFansToOutsd-5"      Proj:ClVentFansToOutsd  =
      {  if (IsMultiFamily > 0) then  UNCHANGED
         else if (UnitClVentOption = 2 .AND. IfValidAnd( UnitClVentNumFans >= 5 ) .AND. IfValidAnd( UnitClVentFan[5]:ExhaustsTo = 2 ))
         then  ClVentFansToOutsd + 1  else  UNCHANGED  endif endif  }
   "Set Proj:ClVentFansToOutsd-6"      Proj:ClVentFansToOutsd  =
      {  if (IsMultiFamily > 0) then  UNCHANGED
         else if (UnitClVentOption = 2 .AND. IfValidAnd( UnitClVentNumFans >= 6 ) .AND. IfValidAnd( UnitClVentFan[6]:ExhaustsTo = 2 ))
         then  ClVentFansToOutsd + 1  else  UNCHANGED  endif endif  }

   "Default Zone:AirFlowMeter - ID of air flow meter used to track/report hourly air flow"         Zone:AirFlowMeter =           ; SAC 10/01/20 (tic #1247)
      {  if (Type < 10) then  1  else  0  endif  }
   "Default OtherZone:AirFlowMeter - ID of air flow meter used to track/report hourly air flow"    OtherZone:AirFlowMeter =      ; SAC 10/01/20 (tic #1247)
      {  if (Type < 10) then  1  else  0  endif  }
   "Default Garage:AirFlowMeter - ID of air flow meter used to track/report hourly air flow"       Garage:AirFlowMeter     = {  0  }   ; SAC 10/01/20 (tic #1247)
   "Default Attic:AirFlowMeter - ID of air flow meter used to track/report hourly air flow"        Attic:AirFlowMeter      = {  0  }
   "Default CrawlSpace:AirFlowMeter - ID of air flow meter used to track/report hourly air flow"   CrawlSpace:AirFlowMeter = {  0  }

END
;*************************************************************************

;*************************************************************************
RULELIST "Default_AllHVAC" 0 0 0 0
;*************************************************************************
   ; limits on attic & crawlspace area before ducts can be located there - SAC 08/13/20 (tic #1062)
   "Set Proj:DuctsInAtticMinPctArea - minimum percent attic area for ducts to be located there" 
      Proj:DuctsInAtticMinPctArea  = {  10  }
   "Set Proj:DuctsInCrawlMinPctArea - minimum percent crawlspace area for ducts to be located there" 
      Proj:DuctsInCrawlMinPctArea  = {  15  }
   "Set Proj:AtticAreaOKForDucts - whether there is sufficient attic area for ducts" 
      Proj:AtticAreaOKForDucts = {  if ((SumAll( Attic:FloorAreaOverCond ) / ValidOr( CondFloorArea, 1 )) > ((DuctsInAtticMinPctArea/100)-0.0001))
                                    then  1  else  0  endif  }
;"dbg" Proj:Action = { PostMessageToLog( "   just set Proj:AtticAreaOKForDucts to %g for model '%s' - sum Attic:FloorAreaOverCond %g / CondFloorArea %g / DuctsInAtticMinPctArea %g", 
;                                                  AtticAreaOKForDucts, RunAbbrev, SumAll( Attic:FloorAreaOverCond ), ValidOr( CondFloorArea, 1 ), DuctsInAtticMinPctArea ) }
   "Set Proj:CrawlAreaOKForDucts - whether there is sufficient crawlspace area for ducts" 
      Proj:CrawlAreaOKForDucts = {  if ((SumAll( CrawlSpace:Area ) / ValidOr( CondFloorArea, 1 )) > ((DuctsInCrawlMinPctArea/100)-0.0001))
                                    then  1  else  0  endif  }

	"Set HVACSys:TypeAbbrev"			HVACSys:TypeAbbrev		= {  Local( Type )  }
	"Set HVACSys:TypeAbbrevStr"		HVACSys:TypeAbbrevStr	= {  EnumString( TypeAbbrev )  }

	; Whether or not the selected HVAC system type is valid/allowed/enabled
	"Set HVACSys:TypeOK"			HVACSys:TypeOK	= {	if (Type == 3 .AND. Proj:EnableVarFlowOAV < 0.5) then  0
																	else  1  endif  }

; moved to ForceDefault_Zone_HVAC rulelist, called from Rules_Default.rule
;;	mjb	10/14/14	assign HVACSystem from ActiveHVACSystem for IsAddAlone
;	"Conditionally Set HVACSystem to ActiveHVACSystem"	Zone:HVACSystem	=	{	if (Proj:IsAddAlone > 0.5) then ActiveHVACSystem else UNCHANGED endif	}
;
  ; SAC 12/5/13 - added logic to take into account Alt & Ex HVAC assignments
	"Set HVACSys:FloorAreaServed[1]"	HVACSys:FloorAreaServed[1]	= {
      SumRevRef( Zone:HVACSystem,		Zone:HVACNewCondFloorArea ) +
      SumRevRef( OtherZone:ozHVACSystem, OtherZone:HVACNewCondFloorArea ) +
      SumRevRef( Zone:AltHVACSystem,	Zone:HVACAltCondFloorArea ) +
      SumRevRef( Zone:exHVACSystem,		Zone:HVACExCondFloorArea  )  }
																		;				switch ( type )
																		;		; SAC 1/11/13 - revised default for whole house fan floor area served to be ALL CFA if fan data defaulted
																		;		;			case 10 :	SumRevRef( Zone:CoolVentSystem, Zone:CondFloorArea )
																		;	;				case 10 :	if (LocalCompAssigned( Fan ) == 0) then  SumRevRef( Zone:CoolVentSystem, Zone:CondFloorArea )
																		;	;								else if (Fan:DefaultSystem  < 0.5) then  SumRevRef( Zone:CoolVentSystem, Zone:CondFloorArea )
																		;	;								else	Proj:CondFloorArea  endif endif
																		;	; SAC 4/21/13 - revised default for whole house fan floor area served to be ALL CFA
																		;					case 10 :	Proj:CondFloorArea
																		;					case 20 :	SumRevRef( Zone:IAQVentSystem , Zone:CondFloorArea )
																		;					default :	SumRevRef( Zone:HVACSystem    , Zone:CondFloorArea )
																		;				endswitch  }
	; JP 8/26/19 moved here to ensure the HVACCool:HERSCheck will be created (tic #1060)
	"Set HVACSys:FloorAreaServed[2]"		HVACSys:FloorAreaServed[2]		= {	FloorAreaServed[1]  }
	"Set HVACSys:FloorAreaServed[3]"		HVACSys:FloorAreaServed[3]		= {	FloorAreaServed[1]  }
	"Set HVACSys:FloorAreaServed[4]"		HVACSys:FloorAreaServed[4]		= {	FloorAreaServed[1]  }
	"Set HVACSys:FloorAreaServed[5]"		HVACSys:FloorAreaServed[5]		= {	FloorAreaServed[1]  }
	"Set HVACSys:FloorAreaServed[6]"		HVACSys:FloorAreaServed[6]		= {	FloorAreaServed[1]  }
	"Set HVACSys:FloorAreaServed[7]"		HVACSys:FloorAreaServed[7]		= {	FloorAreaServed[1]  }
	"Set HVACSys:FloorAreaServed[8]"		HVACSys:FloorAreaServed[8]		= {	FloorAreaServed[1]  }
	"Set HVACSys:FloorAreaServed[9]"		HVACSys:FloorAreaServed[9]		= {	FloorAreaServed[1]  }
	"Set HVACSys:FloorAreaServed[10]"	HVACSys:FloorAreaServed[10]	= {	FloorAreaServed[1]  }

"Set HVACSys:FloorAreaSrvdInclV - Floor area served by this system (including altered/verified system area)"
      HVACSys:FloorAreaSrvdInclV	= {
         FloorAreaServed[1] + SumRevRef( Zone:exHVACSystem, Zone:HVACExVCondFloorArea )  }

	"Set HVACSys:AtticArea"				HVACSys:AtticArea				= {
      SumRevRef( Zone:HVACSystem,		Zone:AtticArea ) +
      SumRevRef( OtherZone:ozHVACSystem, OtherZone:AtticArea ) +
      SumRevRef( Zone:AltHVACSystem,	Zone:AtticArea ) +
      SumRevRef( Zone:exHVACSystem,		Zone:AtticArea  )  }
	"Set HVACSys:UncondAtticArea"		HVACSys:UncondAtticArea		= {
      SumRevRef( Zone:HVACSystem,		Zone:UncondAtticArea ) +
      SumRevRef( OtherZone:ozHVACSystem, OtherZone:UncondAtticArea ) +
      SumRevRef( Zone:AltHVACSystem,	Zone:UncondAtticArea ) +
      SumRevRef( Zone:exHVACSystem,		Zone:UncondAtticArea  )  }

	"Set HVACSys:MaxClVentableAtticVol[1]"		HVACSys:MaxClVentableAtticVol[1]	= {	MaxRevRef( Zone:HVACSystem   ,	Zone:MaxClVentableVolume )  }
	"Set HVACSys:MaxClVentableAtticVol[2]"		HVACSys:MaxClVentableAtticVol[2]	= {	MaxRevRef( Zone:AltHVACSystem,	Zone:MaxClVentableVolume )  }
	"Set HVACSys:MaxClVentableAtticVol[3]"		HVACSys:MaxClVentableAtticVol[3]	= {	MaxRevRef( Zone:exHVACSystem,		Zone:MaxClVentableVolume )  }
	"Set HVACSys:MaxClVentableAtticVol[4]"		HVACSys:MaxClVentableAtticVol[4]	= {	if (LocalStatus( MaxClVentableAtticVol[1] ) > 0.5)
																												then	if (LocalStatus( MaxClVentableAtticVol[2] ) > 0.5)
																														then	if (LocalStatus( MaxClVentableAtticVol[3] ) > 0.5)
																																then	max( MaxClVentableAtticVol[1], max( MaxClVentableAtticVol[2], MaxClVentableAtticVol[3] ) )
																																else	max( MaxClVentableAtticVol[1],      MaxClVentableAtticVol[2] )
																																endif
																														else	if (LocalStatus( MaxClVentableAtticVol[3] ) > 0.5)
																																then	max( MaxClVentableAtticVol[1], MaxClVentableAtticVol[3] )
																																else	     MaxClVentableAtticVol[1]
																																endif
																														endif
																												else	if (LocalStatus( MaxClVentableAtticVol[2] ) > 0.5)
																														then	if (LocalStatus( MaxClVentableAtticVol[3] ) > 0.5)
																																then	max( MaxClVentableAtticVol[2], MaxClVentableAtticVol[3] )
																																else	     MaxClVentableAtticVol[2]
																																endif
																														else	if (LocalStatus( MaxClVentableAtticVol[3] ) > 0.5)
																																then	     MaxClVentableAtticVol[3]
																																else	     0
																																endif
																														endif  endif  }
	"Set HVACSys:MaxClVentableAtticZn"	HVACSys:MaxClVentableAtticZn	= {	if (		ValidOr( MaxRevRef(	Zone:HVACSystem,		Zone:MaxClVentableVolume ), 0 ) > (MaxClVentableAtticVol[4]-1))
																									then  MaxRevRefComp( 			Zone:HVACSystem,		Zone:MaxClVentableVolume )
																									else if (ValidOr( MaxRevRef(	Zone:AltHVACSystem,	Zone:MaxClVentableVolume ), 0 ) > (MaxClVentableAtticVol[4]-1))
																									then  MaxRevRefComp( 			Zone:AltHVACSystem,	Zone:MaxClVentableVolume )
																									else if (ValidOr( MaxRevRef(	Zone:exHVACSystem,	Zone:MaxClVentableVolume ), 0 ) > (MaxClVentableAtticVol[4]-1))
																									then  MaxRevRefComp( 			Zone:exHVACSystem,	Zone:MaxClVentableVolume )
																									else	UNDEFINED  endif endif endif  }
	"Set HVACSys:MaxClVentableAttic"		HVACSys:MaxClVentableAttic		= {	if (LocalCompAssigned( MaxClVentableAtticZn ) < 0.5) then  UNDEFINED
																									else if (LocalCompAssigned( MaxClVentableAtticZn:MaxClVentableAttic ) < 0.5) then  UNDEFINED
																									else	MaxClVentableAtticZn:MaxClVentableAttic    endif endif  }

;	mjb	4/18/14	- added this to track existing (but not altered/verified) floor area at HVACSys level
	"Set HVACSys:exFloorAreaSrvd - existing Floor area served by this system"
			HVACSys:exFloorAreaSrvd	= {	SumRevRef( Zone:exHVACSystem, Zone:exCondFloorArea )  }

;	mjb	4/18/14	- added this to track HVAC Systems that are Active in Zones
	"Set HVACSys:ActiveInAnyZone"			HVACSys:ActiveInAnyZone	= {	SumRevRef( Zone:ActiveHVACSystem, Zone:HVACSysAssigned ) +
	                                                                  SumRevRef( OtherZone:ActiveHVACSystem, OtherZone:HVACSysAssigned )  }
;	"debug ActiveInAnyZone"			HVACSys:Action	= { MessageBox( "HVAC PI '%s' ActiveInAnyZone: %g", Name, ActiveInAnyZone )	}
;	"debug ActiveInAnyZone"			Zone:Action	= { MessageBox( "HVAC PI Zone: '%s' ActiveHVACSystem: '%s' HVACSysAssigned: %g", Name, ActiveHVACSystem:Name, HVACSysAssigned  )	}

; SAC 1/13/15 - moved up here from below in SetupHVACSys_Round1_HeatCool &  to ensure these defaults are in place PRIOR to their being referenced in rule logic
	"Default HVACSys:NumHeatSystemTypes"	HVACSys:NumHeatSystemTypes		= {	if (IfValidAnd( Type == 1 )==0 .AND. IfValidAnd( Type == 3 )==0) then  0		; Type invalid or NOT = 1 or 3
																										else if (LocalCompAssigned( HeatSystem[10] )) then  10
																										else if (LocalCompAssigned( HeatSystem[9]  )) then   9
																										else if (LocalCompAssigned( HeatSystem[8]  )) then   8
																										else if (LocalCompAssigned( HeatSystem[7]  )) then   7
																										else if (LocalCompAssigned( HeatSystem[6]  )) then   6
																										else if (LocalCompAssigned( HeatSystem[5]  )) then   5
																										else if (LocalCompAssigned( HeatSystem[4]  )) then   4
																										else if (LocalCompAssigned( HeatSystem[3]  )) then   3
																										else if (LocalCompAssigned( HeatSystem[2]  )) then   2  else  1  endif endif endif endif endif endif endif endif endif endif  }
	"Default HVACSys:NumCoolSystemTypes"	HVACSys:NumCoolSystemTypes		= {	if (IfValidAnd( Type == 1 )==0 .AND. IfValidAnd( Type == 3 )==0) then  0		; Type invalid or NOT = 1 or 3
																										else if (LocalCompAssigned( CoolSystem[10] )) then  10
																										else if (LocalCompAssigned( CoolSystem[9]  )) then   9
																										else if (LocalCompAssigned( CoolSystem[8]  )) then   8
																										else if (LocalCompAssigned( CoolSystem[7]  )) then   7
																										else if (LocalCompAssigned( CoolSystem[6]  )) then   6
																										else if (LocalCompAssigned( CoolSystem[5]  )) then   5
																										else if (LocalCompAssigned( CoolSystem[4]  )) then   4
																										else if (LocalCompAssigned( CoolSystem[3]  )) then   3
																										else if (LocalCompAssigned( CoolSystem[2]  )) then   2  else  1  endif endif endif endif endif endif endif endif endif endif  }
	"Default HVACSys:NumHtPumpSystemTypes"	HVACSys:NumHtPumpSystemTypes	= {	if (IfValidAnd( Type == 2 )==0) then  0		; Type invalid or NOT = 2
																										else if (LocalCompAssigned( HtPumpSystem[10] )) then  10
																										else if (LocalCompAssigned( HtPumpSystem[9]  )) then   9
																										else if (LocalCompAssigned( HtPumpSystem[8]  )) then   8
																										else if (LocalCompAssigned( HtPumpSystem[7]  )) then   7
																										else if (LocalCompAssigned( HtPumpSystem[6]  )) then   6
																										else if (LocalCompAssigned( HtPumpSystem[5]  )) then   5
																										else if (LocalCompAssigned( HtPumpSystem[4]  )) then   4
																										else if (LocalCompAssigned( HtPumpSystem[3]  )) then   3
																										else if (LocalCompAssigned( HtPumpSystem[2]  )) then   2  else  1  endif endif endif endif endif endif endif endif endif endif  }

  ; SAC 12/23/13 - added to improve defaulting of HVACCool/Heat/HtPump:FloorAreaServerd defaulting
  ; SAC 12/22/14 - added logic to ensure that Type of assigned systems is valid (not '- none -' or NoCooling)
  ; SAC 3/7/16 - expended to arrays of 10 to ensure SumRevRef() functions for assigned cool/heat objects get set properly 
	"Set HVACSys:ClFlrAreaServed[1]"		HVACSys:ClFlrAreaServed[1]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumCoolSystemTypes   >= 1 ) .AND. IfValidAnd( CoolSystem[1]:Type   > 1 )) then  FloorAreaServed[1]  else  0  endif  }
	"Set HVACSys:ClFlrAreaServed[2]"		HVACSys:ClFlrAreaServed[2]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumCoolSystemTypes   >= 2 ) .AND. IfValidAnd( CoolSystem[2]:Type   > 1 )) then  FloorAreaServed[2]  else  0  endif  }
	"Set HVACSys:ClFlrAreaServed[3]"		HVACSys:ClFlrAreaServed[3]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumCoolSystemTypes   >= 3 ) .AND. IfValidAnd( CoolSystem[3]:Type   > 1 )) then  FloorAreaServed[3]  else  0  endif  }
	"Set HVACSys:ClFlrAreaServed[4]"		HVACSys:ClFlrAreaServed[4]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumCoolSystemTypes   >= 4 ) .AND. IfValidAnd( CoolSystem[4]:Type   > 1 )) then  FloorAreaServed[4]  else  0  endif  }
	"Set HVACSys:ClFlrAreaServed[5]"		HVACSys:ClFlrAreaServed[5]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumCoolSystemTypes   >= 5 ) .AND. IfValidAnd( CoolSystem[5]:Type   > 1 )) then  FloorAreaServed[5]  else  0  endif  }
	"Set HVACSys:ClFlrAreaServed[6]"		HVACSys:ClFlrAreaServed[6]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumCoolSystemTypes   >= 6 ) .AND. IfValidAnd( CoolSystem[6]:Type   > 1 )) then  FloorAreaServed[6]  else  0  endif  }
	"Set HVACSys:ClFlrAreaServed[7]"		HVACSys:ClFlrAreaServed[7]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumCoolSystemTypes   >= 7 ) .AND. IfValidAnd( CoolSystem[7]:Type   > 1 )) then  FloorAreaServed[7]  else  0  endif  }
	"Set HVACSys:ClFlrAreaServed[8]"		HVACSys:ClFlrAreaServed[8]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumCoolSystemTypes   >= 8 ) .AND. IfValidAnd( CoolSystem[8]:Type   > 1 )) then  FloorAreaServed[8]  else  0  endif  }
	"Set HVACSys:ClFlrAreaServed[9]"		HVACSys:ClFlrAreaServed[9]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumCoolSystemTypes   >= 9 ) .AND. IfValidAnd( CoolSystem[9]:Type   > 1 )) then  FloorAreaServed[9]  else  0  endif  }
	"Set HVACSys:ClFlrAreaServed[10]"	HVACSys:ClFlrAreaServed[10]	= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumCoolSystemTypes   >=10 ) .AND. IfValidAnd( CoolSystem[10]:Type  > 1 )) then  FloorAreaServed[10] else  0  endif  }
	"Set HVACSys:HtFlrAreaServed[1]"		HVACSys:HtFlrAreaServed[1]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumHeatSystemTypes   >= 1 ) .AND. IfValidAnd( HeatSystem[1]:Type   > 0 )) then  FloorAreaServed[1]  else  0  endif  }
	"Set HVACSys:HtFlrAreaServed[2]"		HVACSys:HtFlrAreaServed[2]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumHeatSystemTypes   >= 2 ) .AND. IfValidAnd( HeatSystem[2]:Type   > 0 )) then  FloorAreaServed[2]  else  0  endif  }
	"Set HVACSys:HtFlrAreaServed[3]"		HVACSys:HtFlrAreaServed[3]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumHeatSystemTypes   >= 3 ) .AND. IfValidAnd( HeatSystem[3]:Type   > 0 )) then  FloorAreaServed[3]  else  0  endif  }
	"Set HVACSys:HtFlrAreaServed[4]"		HVACSys:HtFlrAreaServed[4]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumHeatSystemTypes   >= 4 ) .AND. IfValidAnd( HeatSystem[4]:Type   > 0 )) then  FloorAreaServed[4]  else  0  endif  }
	"Set HVACSys:HtFlrAreaServed[5]"		HVACSys:HtFlrAreaServed[5]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumHeatSystemTypes   >= 5 ) .AND. IfValidAnd( HeatSystem[5]:Type   > 0 )) then  FloorAreaServed[5]  else  0  endif  }
	"Set HVACSys:HtFlrAreaServed[6]"		HVACSys:HtFlrAreaServed[6]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumHeatSystemTypes   >= 6 ) .AND. IfValidAnd( HeatSystem[6]:Type   > 0 )) then  FloorAreaServed[6]  else  0  endif  }
	"Set HVACSys:HtFlrAreaServed[7]"		HVACSys:HtFlrAreaServed[7]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumHeatSystemTypes   >= 7 ) .AND. IfValidAnd( HeatSystem[7]:Type   > 0 )) then  FloorAreaServed[7]  else  0  endif  }
	"Set HVACSys:HtFlrAreaServed[8]"		HVACSys:HtFlrAreaServed[8]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumHeatSystemTypes   >= 8 ) .AND. IfValidAnd( HeatSystem[8]:Type   > 0 )) then  FloorAreaServed[8]  else  0  endif  }
	"Set HVACSys:HtFlrAreaServed[9]"		HVACSys:HtFlrAreaServed[9]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumHeatSystemTypes   >= 9 ) .AND. IfValidAnd( HeatSystem[9]:Type   > 0 )) then  FloorAreaServed[9]  else  0  endif  }
	"Set HVACSys:HtFlrAreaServed[10]"	HVACSys:HtFlrAreaServed[10]	= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumHeatSystemTypes   >=10 ) .AND. IfValidAnd( HeatSystem[10]:Type  > 0 )) then  FloorAreaServed[10] else  0  endif  }
	"Set HVACSys:HtPmpFlrAreaServed"		HVACSys:HtPmpFlrAreaServed[1] = {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type == 2 .AND. IfValidAnd( NumHtPumpSystemTypes >= 1 ) .AND. IfValidAnd( HtPumpSystem[1]:Type > 0 )) then  FloorAreaServed[1]  else  0  endif  }
   "Set HVACSys:SDHVFlrAreaServed - area served by SDHV system"   HVACSys:SDHVFlrAreaServed =   ; SAC 8/19/19 (tic #1041)
      {  if (Proj:EnergyCodeYearNum < 2019) then  0
         else if ( ( Type == 2                 .AND. IfValidAnd( NumHtPumpSystemTypes >= 1 ) .AND. IfValidAnd( HtPumpSystem[1]:Type = 19 )) .OR.
                   ((Type == 1 .OR. Type == 3) .AND. IfValidAnd( NumCoolSystemTypes   >= 1 ) .AND. IfValidAnd(   CoolSystem[1]:Type = 18 )) )
         then  FloorAreaServed[1]
         else  0  endif endif  }
	; SAC 12/23/14 - additional properties to track Existing/Altered/New heating floor area
	"Set HVACSys:HtExFlrAreaServed"		HVACSys:HtExFlrAreaServed		= {	if (Proj:RunScope == 2 .AND. Status == 1) then  HtFlrAreaServed  else  0  endif  }
	"Set HVACSys:HtAltFlrAreaServed"		HVACSys:HtAltFlrAreaServed		= {	if (Proj:RunScope == 2 .AND. Status == 2) then  HtFlrAreaServed  else  0  endif  }
	"Set HVACSys:HtNewFlrAreaServed"		HVACSys:HtNewFlrAreaServed		= {	if (                         Status == 3) then  HtFlrAreaServed  else  0  endif  }

;  mjb   11/7/14  populate the rest of the HtPmpFlrAreaServed array
; SAC 3/7/16 - revised logic along lines of above Cl/Ht arrays so that *FlrAreaServed only set if the # equip types and equip assignments are all valid
	"Set HVACSys:HtPmpFlrAreaServed[2]"		HVACSys:HtPmpFlrAreaServed[2]   = {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type == 2 .AND. IfValidAnd( NumHtPumpSystemTypes >= 2 ) .AND. IfValidAnd( HtPumpSystem[2]:Type > 0 )) then  FloorAreaServed[2]  else  0  endif  }
	"Set HVACSys:HtPmpFlrAreaServed[3]"		HVACSys:HtPmpFlrAreaServed[3]   = {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type == 2 .AND. IfValidAnd( NumHtPumpSystemTypes >= 3 ) .AND. IfValidAnd( HtPumpSystem[3]:Type > 0 )) then  FloorAreaServed[3]  else  0  endif  }
	"Set HVACSys:HtPmpFlrAreaServed[4]"		HVACSys:HtPmpFlrAreaServed[4]   = {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type == 2 .AND. IfValidAnd( NumHtPumpSystemTypes >= 4 ) .AND. IfValidAnd( HtPumpSystem[4]:Type > 0 )) then  FloorAreaServed[4]  else  0  endif  }
	"Set HVACSys:HtPmpFlrAreaServed[5]"		HVACSys:HtPmpFlrAreaServed[5]   = {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type == 2 .AND. IfValidAnd( NumHtPumpSystemTypes >= 5 ) .AND. IfValidAnd( HtPumpSystem[5]:Type > 0 )) then  FloorAreaServed[5]  else  0  endif  }
	"Set HVACSys:HtPmpFlrAreaServed[6]"		HVACSys:HtPmpFlrAreaServed[6]   = {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type == 2 .AND. IfValidAnd( NumHtPumpSystemTypes >= 6 ) .AND. IfValidAnd( HtPumpSystem[6]:Type > 0 )) then  FloorAreaServed[6]  else  0  endif  }
	"Set HVACSys:HtPmpFlrAreaServed[7]"		HVACSys:HtPmpFlrAreaServed[7]   = {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type == 2 .AND. IfValidAnd( NumHtPumpSystemTypes >= 7 ) .AND. IfValidAnd( HtPumpSystem[7]:Type > 0 )) then  FloorAreaServed[7]  else  0  endif  }
	"Set HVACSys:HtPmpFlrAreaServed[8]"		HVACSys:HtPmpFlrAreaServed[8]   = {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type == 2 .AND. IfValidAnd( NumHtPumpSystemTypes >= 8 ) .AND. IfValidAnd( HtPumpSystem[8]:Type > 0 )) then  FloorAreaServed[8]  else  0  endif  }
	"Set HVACSys:HtPmpFlrAreaServed[9]"		HVACSys:HtPmpFlrAreaServed[9]   = {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type == 2 .AND. IfValidAnd( NumHtPumpSystemTypes >= 9 ) .AND. IfValidAnd( HtPumpSystem[9]:Type > 0 )) then  FloorAreaServed[9]  else  0  endif  }
	"Set HVACSys:HtPmpFlrAreaServed[10]"	HVACSys:HtPmpFlrAreaServed[10]  = {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type == 2 .AND. IfValidAnd( NumHtPumpSystemTypes >=10 ) .AND. IfValidAnd( HtPumpSystem[10]:Type >0 )) then  FloorAreaServed[10] else  0  endif  }

;  mjb   11/12/14  poplate the HVACSys Status arrays
; SAC 11/21/14 - switched to using separate property name for Status ARRAY, to avoid third party vendor data model questions/issues
	"Set HVACSys:StatusArray[1]"		HVACSys:StatusArray[1]   = {	Status  }
	"Set HVACSys:StatusArray[2]"		HVACSys:StatusArray[2]   = {	Status  }
	"Set HVACSys:StatusArray[3]"		HVACSys:StatusArray[3]   = {	Status  }
	"Set HVACSys:StatusArray[4]"		HVACSys:StatusArray[4]   = {	Status  }
	"Set HVACSys:StatusArray[5]"		HVACSys:StatusArray[5]   = {	Status  }
	"Set HVACSys:StatusArray[6]"		HVACSys:StatusArray[6]   = {	Status  }
	"Set HVACSys:StatusArray[7]"		HVACSys:StatusArray[7]   = {	Status  }
	"Set HVACSys:StatusArray[8]"		HVACSys:StatusArray[8]   = {	Status  }
	"Set HVACSys:StatusArray[9]"		HVACSys:StatusArray[9]   = {	Status  }
	"Set HVACSys:StatusArray[10]"		HVACSys:StatusArray[10]  = {	Status  }

	"Set HVACSys:MinFloorHeight"		HVACSys:MinFloorHeight	=
	   {	if (SumRevRef( OtherZone:ozHVACSystem,  OtherZone:CondFloorArea ) > 0 .AND.
	          SumRevRef(      Zone:HVACSystem  ,       Zone:CondFloorArea ) > 0)
	      then  min( MinRevRef( OtherZone:ozHVACSystem,  OtherZone:FloorHeight ),
	                 MinRevRef(      Zone:HVACSystem  ,       Zone:FloorHeight ) )
	      else if (SumRevRef(  OtherZone:ozHVACSystem,  OtherZone:CondFloorArea ) > 0)
	      then  MinRevRef(     OtherZone:ozHVACSystem,  OtherZone:FloorHeight )
	      else  MinRevRef( Zone:HVACSystem    , Zone:FloorHeight )
	      endif endif  }
																		;				switch ( type )
																		;	;				case 10 :	MinRevRef( Zone:CoolVentSystem, Zone:FloorHeight )
																		;	; SAC 4/21/13 - revised default for whole house fan floor area served to be ALL CFA
																		;					case 10 :	MinAll(                         Zone:FloorHeight )
																		;					case 20 :	MinRevRef( Zone:IAQVentSystem , Zone:FloorHeight )
																		;					default :	MinRevRef( Zone:HVACSystem    , Zone:FloorHeight )
																		;				endswitch  }
	"Set HVACSys:FloorZRange"			HVACSys:FloorZRange		=
	   {	if (SumRevRef( OtherZone:ozHVACSystem,  OtherZone:CondFloorArea ) > 0 .AND.
	          SumRevRef(      Zone:HVACSystem  ,       Zone:CondFloorArea ) > 0)
	      then  max( MaxRevRef( OtherZone:ozHVACSystem, OtherZone:Bottom ),
	                 MaxRevRef(      Zone:HVACSystem  ,      Zone:Bottom ) ) -
	            min( MinRevRef( OtherZone:ozHVACSystem, OtherZone:Bottom ),
	                 MinRevRef(      Zone:HVACSystem  ,      Zone:Bottom ) )
	      else if (SumRevRef(  OtherZone:ozHVACSystem,  OtherZone:CondFloorArea ) > 0)
	      then  MaxRevRef( OtherZone:ozHVACSystem, OtherZone:Bottom ) - MinRevRef( OtherZone:ozHVACSystem, OtherZone:Bottom )
	      else  MaxRevRef( Zone:HVACSystem    , Zone:Bottom ) - MinRevRef( Zone:HVACSystem    , Zone:Bottom )
	      endif endif  }
																		;				switch ( type )
																		;	;				case 10 :	MaxRevRef( Zone:CoolVentSystem, Zone:Bottom ) - MinRevRef( Zone:CoolVentSystem, Zone:Bottom )
																		;	; SAC 4/21/13 - revised default for whole house fan floor area served to be ALL CFA
																		;					case 10 :	MaxAll(                         Zone:Bottom ) - MinAll(                         Zone:Bottom )
																		;					case 20 :	MaxRevRef( Zone:IAQVentSystem , Zone:Bottom ) - MinRevRef( Zone:IAQVentSystem , Zone:Bottom )
																		;					default :	MaxRevRef( Zone:HVACSystem    , Zone:Bottom ) - MinRevRef( Zone:HVACSystem    , Zone:Bottom )
																		;				endswitch  }
; SAC 4/30/14 - added logic to ensure that HVACSys:NumStoriesServed = 0 when FloorAreaServed[1] = 0 (designed to help resolve GC #297)
	"Set HVACSys:NumStoriesServed"	HVACSys:NumStoriesServed = {	if (IfValidAnd( FloorAreaServed[1] > 0.1 ) == 0) then  0
																						else if (IfValidAnd( MinFloorHeight > 0.1 ))
																						then  max( max( MaxRevRef( Zone:HVACSystem       , Zone:NumStories ),
																						                MaxRevRef( OtherZone:ozHVACSystem, OtherZone:NumStories ) ),
																						           int( (FloorZRange / MinFloorHeight) ) + 1 )
																						else  max( MaxRevRef( Zone:HVACSystem       , Zone:NumStories ),
																						           MaxRevRef( OtherZone:ozHVACSystem, OtherZone:NumStories ) )
																						endif endif  }
																		;				switch ( type )
																		;					case 10 :	if (Local( MinFloorHeight ) > 0.1)
																		;	;								then  max( MaxRevRef( Zone:CoolVentSystem, Zone:NumStories ),
																		;	;								           int( (Local( FloorZRange ) / Local( MinFloorHeight )) ) + 1 )
																		;	;								else       MaxRevRef( Zone:CoolVentSystem, Zone:NumStories )
																		;	; SAC 4/21/13 - revised default for whole house fan floor area served to be ALL CFA
																		;									then  max( MaxAll( Zone:NumStories ),
																		;									           int( (Local( FloorZRange ) / Local( MinFloorHeight )) ) + 1 )
																		;									else       MaxAll( Zone:NumStories )
																		;									endif
																		;					case 20 :	if (Local( MinFloorHeight ) > 0.1)
																		;									then  max( MaxRevRef( Zone:IAQVentSystem , Zone:NumStories ),
																		;									           int( (Local( FloorZRange ) / Local( MinFloorHeight )) ) + 1 )
																		;									else       MaxRevRef( Zone:IAQVentSystem , Zone:NumStories )
																		;									endif
																		;					default :	if (Local( MinFloorHeight ) > 0.1)
																		;									then  max( MaxRevRef( Zone:HVACSystem    , Zone:NumStories ),
																		;									           int( (Local( FloorZRange ) / Local( MinFloorHeight )) ) + 1 )
																		;									else       MaxRevRef( Zone:HVACSystem    , Zone:NumStories )
																		;									endif
																		;				endswitch  }

	"Set HVACSys:NumStoriesSrvdMsg"	HVACSys:NumStoriesSrvdMsg	= {	if (IfValidAnd( NumStoriesServed = 1 )) then  "(1 story)"
																							else if (LocalStatus( NumStoriesServed ) < 1) then  "(? stories)"
																							else  Format( "(%g stories)", Local( NumStoriesServed ) )
																							endif endif  }

   "Set HVACSys:NumDUsServed - # dwelling units served by this system"     HVACSys:NumDUsServed =           ; SAC 04/21/21
      {  if (Proj:IsMultiFamily < 0.5) then  1
         else  max( SumRevRef( Zone:HVACSystem, Zone:NumDwellingUnits ), 1 ) + 
               SumRevRef( OtherZone:ozHVACSystem, OtherZone:HVACSysAssigned )
         endif  }

; SAC 8/26/13 - added CFI (Central Fan Integrated) Cool Vent properties and defaulting
	"Set HVACSys:CFIClVentCompat"		HVACSys:CFIClVentCompat		= {	if (Proj:EnableClVent > 0.5 .AND. Proj:UnitClVentOption == 3)		; 3 => "Central Fan Ventilation Cooling System" (or old wording: "CFI (Central Fan Integrated) Cool Vent")
																						then  1  else  0  endif  }
	;	no default:  HVACSys:CFIClVentOption,  BEMP_Sym,  1,    0,                  "CFI (central fan integrated) cooling ventilation option"       
	"Set HVACSys:CFIClVentOptShow"	HVACSys:CFIClVentOptShow	= {	if (Type == 3 .OR. Proj:EnableFixedFlowOAV < 0.5) then  0		; never display for HVACSys:type = "Variable Outdoor Air Ventilation Central Heat/Cool System"  (3)
																							else if (Proj:EnableClVent > 0.5 .AND. Proj:UnitClVentOption == 3) then  2		; show & editable
																							else if (Proj:UnitClVentOption == 3 .OR. CFIClVentOption > 0) then  1		; show but uneditable - if it is currently set but the model is NOT compatible with CFI cool vent
																							else  0  endif endif endif  }
;	"Set HVACSys:CFIClVentMsg"		HVACSys:CFIClVentMsg		= {	if (Type == 3 .OR. Type < 1) then  " "
	"Set HVACSys:CFIClVentMsg"		HVACSys:CFIClVentMsg		= {	if (Type > 3 .OR. Type < 1 .OR. TypeOK < 0.5) then  " "
																					else if (Proj:EnableClVent > 0.5 .AND. Proj:UnitClVentOption == 3)
																					then  if (Type != 3 .AND. Proj:EnableFixedFlowOAV < 0.5) then  "(CFI cool vent NOT available - this feature is under development)"
																							else  " "  endif
																					else if (Type == 3 .OR. (Type != 3 .AND. CFIClVentOption != 0))
																					then	if (Proj:EnableClVent < 0.5) then				"(CFI cool vent NOT available - must be single family home with ventilated attic)"
																							else if (Proj:UnitClVentOption != 3) then		"(CFI cool vent NOT available - see Cool Vent tab of Project data dialog)"
																							else  " "  endif endif
																					else if (Proj:EnableClVent < 0.5 .AND. Proj:UnitClVentOption == 3) then  "(CFI cool vent available only for single family homes with attics)"
																					else  ; => CFIClVentOption == 0
																							if (Proj:EnableClVent < 0.5) then  				"(CFI cool vent available only for single family homes with ventilated attics)"
																							else if (Proj:UnitClVentOption != 3) then		"(activate CFI cool vent via Cool Vent tab of the Project data dialog)"
																							else  " "  endif endif
																					endif endif endif endif  }

   "Set HVACSys:TreeDescrip"     HVACSys:TreeDescrip  =        ; SAC 8/27/19   ; SAC 6/27/20 - revised to incl. "unused" for MFam models  ; removed MFam unused msg - SAC 08/10/20
   ;   {  if (Proj:IsMultiFamily > 0.5 .AND. ComponentCount( OtherZone ) < 1) then  "unused for multifamily models"
   ;      else if (Proj:RunScope == 1 .AND. Proj:IsAddAlone < 0.5)
      {  if (Proj:RunScope == 1 .AND. Proj:IsAddAlone < 0.5)
         then  if (FloorAreaServed[1] > 0.1)
               then  Format( "%s, %s SqFt assigned", TypeAbbrevStr, FltToStr( FloorAreaServed[1] ) )
               else  Format( "%s, not assigned", TypeAbbrevStr )
               endif
         else  if (FloorAreaServed[1] > 0.1)
               then  Format( "%s %s, %s SqFt assigned", EnumString( Status ), TypeAbbrevStr, FltToStr( FloorAreaServed[1] ) )
               else  Format( "%s %s, not assigned", EnumString( Status ), TypeAbbrevStr )
               endif  endif  }

; SAC 8/24/13 - setup initial set of HVACHeat/Cool/HtPump assignment properties
	"Initialize HVACSys Heat/Cool/HtPump properties"		HVACSys:Action		= {	if (Type == 1 .OR. Type == 3)
																											then  EvalRulelist( "SetupHVACSys_Round1_HeatCool", 1 )
																											else if (Type == 2)
																											then	EvalRulelist( "SetupHVACSys_Round1_HeatPump", 1 )
																											else	UNCHANGED  endif endif  }

   "Initialize MFam DwellUnitType area served properties - iff MFam model AND no HVACSys assigned to Zones (yet)"    Proj:Action =        ; SAC 04/08/21   ; SAC 04/09/21
      {  if (IsMultiFamily)
         then  EvalRulelist( "SetupDwellUnitType_AreaServed" )  else  UNCHANGED  endif  }

	"Set HVACDist:FloorAreaServed"	HVACDist:FloorAreaServed  =                  ; revised following rules to base *AreaServed on DwellUnitType data (iff MFam model AND no HVACSys assigned to Zones (yet)) - SAC 04/08/21   ; SAC 04/09/21
      {  if (Proj:IsMultiFamily)
         then  SumRevRef( DwellUnitType:HVACDistRef, DwellUnitType:DUFloorAreaServed ) +
               SumRevRef( HVACSys:DistribSystem, HVACSys:FloorAreaServed[1] )
         else  SumRevRef( HVACSys:DistribSystem, HVACSys:FloorAreaServed[1] )  endif  }
	"Set HVACFan:FloorAreaServed"  	HVACFan:FloorAreaServed   =
      {  if (Proj:IsMultiFamily)
         then  SumRevRef( DwellUnitType:HVACFanRef, DwellUnitType:DUFloorAreaServed ) +
               SumRevRef( HVACSys:Fan, 	        HVACSys:FloorAreaServed[1] )
         else  SumRevRef( HVACSys:Fan, 	        HVACSys:FloorAreaServed[1] )  endif  }
	"Set HVACFan:ClFlrAreaServed"  	HVACFan:ClFlrAreaServed   =
      {  if (Proj:IsMultiFamily)
         then  SumRevRef( DwellUnitType:HVACFanRef, DwellUnitType:DUClFlrAreaServed ) + SumRevRef( DwellUnitType:HVACFanRef, DwellUnitType:DUHtPmpFlrAreaServed ) +
               SumRevRef( HVACSys:Fan,           HVACSys:ClFlrAreaServed    ) + SumRevRef( HVACSys:Fan, HVACSys:HtPmpFlrAreaServed[1] )
         else  SumRevRef( HVACSys:Fan,           HVACSys:ClFlrAreaServed    ) + SumRevRef( HVACSys:Fan, HVACSys:HtPmpFlrAreaServed[1] )  endif  }		; GC issue 450
	"Set HVACFan:GasFurnAreaServed"  HVACFan:GasFurnAreaServed =
      {  if (Proj:IsMultiFamily)
         then  SumRevRef( DwellUnitType:HVACFanRef, DwellUnitType:DUGasFurnAreaServed ) +
               SumRevRef( HVACSys:Fan,           HVACSys:GasFurnAreaServed  )
         else  SumRevRef( HVACSys:Fan,           HVACSys:GasFurnAreaServed  )  endif  }		; 2019 code (tic #928) - SAC 2/5/18
	"Set HVACFan:HtPumpAreaServed"   HVACFan:HtPumpAreaServed  =
      {  if (Proj:IsMultiFamily)
         then  SumRevRef( DwellUnitType:HVACFanRef, DwellUnitType:DUHtPmpFlrAreaServed ) +
               SumRevRef( HVACSys:Fan,           HVACSys:HtPmpFlrAreaServed[1]  )
         else  SumRevRef( HVACSys:Fan,           HVACSys:HtPmpFlrAreaServed[1]  )  endif  }	; 2019 fan power defaulting (tic #1074) - SAC 5/16/19
	"Set HVACFan:SDHVAreaServed"     HVACFan:SDHVAreaServed    =
      {  if (Proj:IsMultiFamily)
         then  SumRevRef( DwellUnitType:HVACFanRef, DwellUnitType:DUSDHVFlrAreaServed ) +
               SumRevRef( HVACSys:Fan,           HVACSys:SDHVFlrAreaServed      )
         else  SumRevRef( HVACSys:Fan,           HVACSys:SDHVFlrAreaServed      )  endif  }	; 2019 fan power defaulting (tic #1041) - SAC 8/19/19
	"Set HVACDist:NumStoriesServed"	HVACDist:NumStoriesServed  = {  SumRevRef( HVACSys:DistribSystem, HVACSys:NumStoriesServed )  }
;	"Set HVACFan:NumStoriesServed"  	HVACFan:NumStoriesServed   = {  SumRevRef( HVACSys:Fan, 	         HVACSys:NumStoriesServed )  }

   "Blast HVACHtPump:CFMperTon if it is user-defined but not available for edit"    HVACHtPump:Action =        ; SAC 08/20/20 (tic #1003)   ; VCHP2 - SAC 11/01/20
      {  if (Type ==  7 .OR.   ; "RoomHeatPump"
             Type == 10 .OR.   ; "DuctlessMiniSplitHeatPump"  
             Type == 20 .OR.   ; "DuctlessMultiSplitHeatPump"
             Type == 21 .OR.   ; "DuctlessVRFHeatPump" 
             Type == 22 .OR.   ; "VCHP" 
             Type == 33 .OR.   ; "VCHP2" 
             Type == 26 .OR.   ; "PkgTermHeatPump"
             Type == 28 .OR.   ; "DuctedMiniSplitHeatPump"
             Type == 30 .OR.   ; "DuctedMultiSplitHeatPump"
             Type == 32 )      ; "Ducted+DuctlessMultiSplitHeatPump"
         then  EvalRulelist( "Blast_HVACHtPump_CFMperTon", 1 )
         else  UNCHANGED  endif  }

   "Blast HVACCool:CFMperTon if it is user-defined but not available for edit"      HVACCool:Action =          ; SAC 08/20/20 (tic #1003)
      {  if (Type ==  5 .OR.   ; "RoomAirCond"
             Type == 25 )      ; "PkgTermAirCond"
         then  EvalRulelist( "Blast_HVACCool_CFMperTon", 1 )
         else  UNCHANGED  endif  }

	"Call subordinate rulelist to default generic cooling system data"
		HVACCool:Action = {	EvalRulelist( "Default_HVACCool", 1 )  }

	"Call subordinate rulelist to default generic heating system data"
		HVACHeat:Action = {	EvalRulelist( "Default_HVACHeat", 1 )  }

	"Call subordinate rulelist to default generic heat pump system data"
		HVACHtPump:Action = {	EvalRulelist( "Default_HVACHeatPump", 1 )  }

	"Call subordinate rulelist to default type-specific heating system data"
		HVACHeat:Action 	= {	switch (Local( Type ))
											case  1 :  EvalRulelist( "Default_Heat_CntrlFurnace"      		, 1 )   				; "CntrlFurnace - Fuel-fired central furnace"
											case  2 :  EvalRulelist( "Default_Heat_WallFurnaceFan"    		, 1 )   				; "Heater - Non-central fuel-fired space heater"
											case  3 :  EvalRulelist( "Default_Heat_Boiler"         				, 1 )   				; "Boiler - Gas or oil boiler"
											case 17 :  EvalRulelist( "Default_Heat_WoodHeat"          		, 1 )   				; "WoodHeat - Wood heat meeting exceptional method criteria"
											case 18 :  EvalRulelist( "Default_Heat_PkgGasFurnace"    		, 1 )   				; "PkgGasFurnace - Packaged gas furnace"        ; SAC 6/22/20 (tic #1227)
											case 14 :  EvalRulelist( "Default_Heat_WallFurnaceGravity"		, 1 )   				; ""		- SAC 11/25/14 - value 4->14
							 				case 15 :  EvalRulelist( "Default_Heat_FloorFurnace"      		, 1 )   				; ""		- SAC 11/25/14 - value 5->15
											case 16 :  EvalRulelist( "Default_Heat_RoomHeater"  	    		, 1 )   				; ""		- SAC 11/25/14 - value 6->16
											case  8 :  EvalRulelist( "Default_Heat_Electric"          		, 1 )   				; "Electric - All electric heating systems other than heat pump"
											case  9 :  EvalRulelist( "Default_Heat_CombHydro"         		, 1 )   				; "CombHydro - Water heating system can be storage gas/elec/ht pump"
											default :  EvalRulelist( "Default_Heat_unknown"								, 1 )
										endswitch  }

	"Secondary call to subordinate rulelist(s) to force defaults of certain heating system data"
		HVACHeat:Action 	= {	switch (Local( Type ))
											case  9 :	if (IfValidAnd( AFUE == CHRecoveryEff )) then  UNCHANGED
															else  EvalRulelist( "ForceDefault_Heat_CombHydro_AFUE" , 1 )  endif   ; "CombHydro - Water heating system can be storage gas/elec/ht pump"  - to address GC issue 396
											default :  UNCHANGED
										endswitch  }
    ; RJH 2/11/20 tic #1176
    "Set HVACHtPump:HERS_LowStaticVCHP"    HVACHtPump:HERS_LowStaticVCHP = { UNDEFINED }
    "Set HVACHtPump:HERS_AirToHabitableRoomsVCHP"    HVACHtPump:HERS_AirToHabitableRoomsVCHP = { UNDEFINED }
    "Set HVACHtPump:HERS_MinimumAirflowVCHP"    HVACHtPump:HERS_MinimumAirflowVCHP = { UNDEFINED }
    "Set HVACHtPump:HERS_DuctsInConditionedSpaceTested"    HVACHtPump:HERS_DuctsInConditionedSpaceTested = { UNDEFINED }
    "Set HVACHtPump:HERS_WallThermostatVCHP"    HVACHtPump:HERS_WallThermostatVCHP = { UNDEFINED }
    "Set HVACHtPump:HERS_DuctlessInConditionedSpaceVCHP"    HVACHtPump:HERS_DuctlessInConditionedSpaceVCHP = { UNDEFINED }
    "Set HVACHtPump:HERS_FilterSizeVCHP"    HVACHtPump:HERS_FilterSizeVCHP = { UNDEFINED }
    "Set HVACHtPump:HERS_FilterPressureDropVCHP"    HVACHtPump:HERS_FilterPressureDropVCHP = { UNDEFINED }
    "Set HVACHtPump:HERS_CertifiedNonContinuousFanVCHP"    HVACHtPump:HERS_CertifiedNonContinuousFanVCHP = { UNDEFINED }
    "Set HVACHtPump:HERS_LowLeakageDuctsInConditionedSpace"    HVACHtPump:HERS_LowLeakageDuctsInConditionedSpace = { UNDEFINED }
    "Set HVACHtPump:HERS_CertifiedNonContinuousFanVCHP"    HVACHtPump:HERS_CertifiedNonContinuousFanVCHP = { UNDEFINED }

   "Set default HVACHtPump:TempLabels[1]"     HVACHtPump:TempLabels[1] = {  "@ 47F:"  }      ; SAC 07/24/21
   "Set default HVACHtPump:TempLabels[2]"     HVACHtPump:TempLabels[2] = {  "@ 35F:"  }
   "Set default HVACHtPump:TempLabels[3]"     HVACHtPump:TempLabels[3] = {  "@ 17F:"  }

   "Blast HVACHtPump:PerfDetailsErrMsg prior to defaulting"    HVACHtPump:PerfDetailsErrMsg = {  UNDEFINED  }   ; SAC 09/23/21
   "Blast HVACHtPump:PerfDetailsError prior to defaulting"     HVACHtPump:PerfDetailsError  = {  UNDEFINED  }

	"Call subordinate rulelist to default type-specific heat pump system data"
		HVACHtPump:Action = {	switch (Local( Type ))
											case  4 :  EvalRulelist( "Default_HtPump_SplitHeatPump"       , 1 )   				; "SplitHeatPump - Heating side of central split heat pump"
											case 26 :  EvalRulelist( "Default_HtPump_PkgTermHeatPump"     , 1 )   				; "PkgTermHeatPump - Packaged terminal heat pump (PTHP)"          ; SAC 6/22/20 (tic #1225)
											case 24 :  EvalRulelist( "Default_HtPump_PkgTermHeatPump"     , 1 )   				; "SglPkgVertHeatPump - Single package vertical heat pump"        ; SAC 6/22/20 (tic #1226)
											case 19 :  EvalRulelist( "Default_HtPump_SDHVSplitHeatPump"   , 1 )   				; "SDHVSplitHeatPump - Small duct, high velocity, central split heat pump"
											case 10 :  EvalRulelist( "Default_HtPump_DuctlessMiniSplitHeatPump"  , 1 )    ; "DuctlessMiniSplitHeatPump - Ductless mini-split heat pump"
											case 20 :  EvalRulelist( "Default_HtPump_DuctlessMiniSplitHeatPump" , 1 )     ; "DuctlessMultiSplitHeatPump - Ductless multi-split heat pump"      ; SAC 6/22/20 - consolidated into single rulelist (tic #1229)
											case 21 :  EvalRulelist( "Default_HtPump_DuctlessVRFHeatPump" , 1 )   				; "DuctlessVRFHeatPump - Ductless variable refrigerant flow (VRF) heat pump" 
											case 28 :  EvalRulelist( "Default_HtPump_DuctlessMiniSplitHeatPump" , 1 )     ; "DuctedMiniSplitHeatPump - Ducted mini-split heat pump"                        ; SAC 6/22/20 (tic #1229)
											case 30 :  EvalRulelist( "Default_HtPump_DuctlessMiniSplitHeatPump" , 1 )     ; "DuctedMultiSplitHeatPump - Ducted multi-split heat pump"                      ; SAC 6/22/20 (tic #1229)
											case 32 :  EvalRulelist( "Default_HtPump_DuctlessMiniSplitHeatPump" , 1 )     ; "Ducted+DuctlessMultiSplitHeatPump - Ducted+ductless multi-split heat pump"    ; SAC 6/22/20 (tic #1229)
											case  5 :  EvalRulelist( "Default_HtPump_PkgHeatPump"         , 1 )   				; "PkgHeatPump - Heating side of central packaged heat pump"
											case  6 :  EvalRulelist( "Default_HtPump_LrgPkgHeatPump"      , 1 )   				; "LrgPkgHeatPump - Heating side of large (>= 65 kBtuh) packaged unit"
											case  7 :  EvalRulelist( "Default_HtPump_RoomHeatPump"        , 1 )   				; "RoomHeatPump - Heating side of non-central room A/C system"
											case 11 :  EvalRulelist( "Default_HtPump_AirToWaterHeatPump"  , 1 )   				; "AirToWaterHeatPump - Air to water heat pump (able to heat DHW)"
											case 12 :  EvalRulelist( "Default_HtPump_GroundSourceHeatPump", 1 )   				; "GroundSourceHeatPump - Ground source heat pump (able to heat DHW)"
											case 22 :  EvalRulelist( "Default_HtPump_VariableCapHeatPump" , 1 )   				; "VCHP" - SAC 11/2/18
											case 33 :  EvalRulelist( "Default_HtPump_VariableCapHeatPump2", 1 )   				; "VCHP2" - SAC 11/01/20
											default :  EvalRulelist( "Default_HtPump_unknown", 1 )
										endswitch  }

   ; properties added for dual fuel heat pumps - SAC 12/08/20
   "Set HVACHtPump:AllowDualFuel - compatible w/ dual fuel flag"        HVACHtPump:AllowDualFuel =    ; logic added to prevent access in code vints prior to 2022 - SAC 03/10/21
      {  if (IfValidAnd( Proj:AnalysisVersion >= 220000 )==0) then  0
         else if (T24RHeatingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) > 0)
         then  1  else  0  endif endif  }
   "Default HVACHtPump:IsDualFuel - user dual fuel selection"           HVACHtPump:IsDualFuel =
      {  if (AllowDualFuel < 1) then  UNDEFINED  else  0  endif  }
   "Default HVACHtPump:AFUE  - backup efficiency (%)"                   HVACHtPump:AFUE =
      {  if (AllowDualFuel < 1 .OR. IfValidAnd( IsDualFuel > 0 )==0) then  UNDEFINED
         else  T24RHeatingEquipment:AFUE(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", "CntrlFurnace" )  endif  }
   "Default HVACHtPump:HasHPLockout - has lockout temp for HP"          HVACHtPump:HasHPLockout =
      {  if (AllowDualFuel < 1 .OR. IfValidAnd( IsDualFuel > 0 )==0) then  UNDEFINED  else  1  endif  }
   "Default HVACHtPump:HPLockoutTemp - lockout temperature for HP"      HVACHtPump:HPLockoutTemp =
      {  if (AllowDualFuel < 1 .OR. IfValidAnd( IsDualFuel > 0 )==0) then  UNDEFINED  else  35  endif  }
   "Set HVACHtPump:ModelDualFuel - whether dual fuel is compatible, selected & includes valid inputs"    HVACHtPump:ModelDualFuel =
      {  if (AllowDualFuel > 0 .AND. IfValidAnd( IsDualFuel > 0 ) .AND. IfValidAnd( AFUE > 0 ))
         then  1  else  UNDEFINED  endif  }

  "Call subordinate rulelist to default cooling system data"
		HVACCool:Action = {	switch (Local( Type ))
										case  1 :  EvalRulelist( "Default_Cool_None"										, 1 )   				; "NoCooling - No cooling equipment"
										case  2 :  EvalRulelist( "Default_Cool_SplitAirCond"						, 1 )   				; "SplitAirCond - Split air conditioning system"
										case 25 :  EvalRulelist( "Default_Cool_PkgTermAirCond"					, 1 )   				; "PkgTermAirCond - Packaged terminal air conditioner (PTAC)"     ; SAC 6/20/20 (tic #1225)
										case 23 :  EvalRulelist( "Default_Cool_PkgTermAirCond"   				, 1 )   				; "SglPkgVertAirCond - Single package vertical A/C system"        ; SAC 6/20/20 (tic #1226)
										case  3 :  EvalRulelist( "Default_Cool_PkgAirCond"							, 1 )   				; "PkgAirCond - Central packaged A/C system (< 65 kBtuh)"
										case  4 :  EvalRulelist( "Default_Cool_LrgPkgAirCond"						, 1 )						; "LrgPkgAirCond - Large packaged A/C system (>= 65 kBtuh)"
										case 18 :  EvalRulelist( "Default_Cool_SDHVSplitAirCond"				, 1 )   				; "SDHVSplitAirCond - Small duct, high velocity, split A/C system"
										case 16 :  EvalRulelist( "Default_Cool_DuctlessMiniSplitAirCond"			, 1 )		  ; "DuctlessMiniSplitAirCond  Ductless mini-split A/C system"
										case 20 :  EvalRulelist( "Default_Cool_DuctlessMiniSplitAirCond"			, 1 )		  ; "DuctlessMultiSplitAirCond - Ductless multi-split A/C system"       ; SAC 6/22/20 - consolidated into single rulelist (tic #1229)
										case 21 :  EvalRulelist( "Default_Cool_DuctlessVRFAirCond"		  , 1 )						; "DuctlessVRFAirCond - Ductless variable refrigerant flow (VRF) A/C system"
										case 27 :  EvalRulelist( "Default_Cool_DuctlessMiniSplitAirCond"			, 1 )		  ; "DuctedMiniSplitAirCond - Ducted mini-split A/C system"                         ; SAC 6/22/20 (tic #1229)
										case 29 :  EvalRulelist( "Default_Cool_DuctlessMiniSplitAirCond"			, 1 )		  ; "DuctedMultiSplitAirCond - Ducted multi-split A/C system"                       ; SAC 6/22/20 (tic #1229)
										case 31 :  EvalRulelist( "Default_Cool_DuctlessMiniSplitAirCond"			, 1 )		  ; "Ducted+DuctlessMultiSplitAirCond - Ducted+ductless multi-split A/C system"     ; SAC 6/22/20 (tic #1229)
										case  5 :  EvalRulelist( "Default_Cool_RoomAirCond"							, 1 )						; "RoomAirCond - Non-central room A/C system"
										case  14 : EvalRulelist( "Default_Cool_EvapCondenser"						, 1 )   ; "EvapCondenser - Evaporatively-cooled condenser for split AC systems"
										default :  EvalRulelist( "Default_Cool_unknown"									, 1 )		
									endswitch  }

   "Set HVACCool:IsPackaged"     HVACCool:IsPackaged  =
      {  switch (Local( Type ))
            case 25 :  1  	   ; "PkgTermAirCond - Packaged terminal air conditioner (PTAC)"     ; SAC 6/24/20 (tic #1225)
            case 23 :  1  	   ; "SglPkgVertAirCond - Single package vertical A/C system"        ; SAC 6/24/20 (tic #1226)
            default :  0
         endswitch  }

   "Reset HVACSys:AutoSizeCool[1] iff Autosized VCHP2"   HVACSys:AutoSizeCool[1] =        ; SAC 09/23/21 (VCHP2)
      {  if (FloorAreaServed[1] > 0.5 .AND. Type == 2 .AND.
             IfValidAnd( HtPumpSystem[1]:Type = 33 ) .AND.
             IfValidAnd( HtPumpSystem[1]:AutoSize = 0 )) then  0
         else  UNCHANGED  endif  }

	"Call subordinate rulelist to set cooling system reporting variables"		; SAC 5/27/14
		Proj:Action		= {	EvalRulelist( "SetupHVACCoolCF1RReportVariables" )  }


   "Set HVACHeat:NumAssigningDUs"      HVACHeat:NumAssigningDUs  =      ; SAC 6/27/20
      {  if (Proj:IsMultiFamily < 0.5) then  UNDEFINED
         else  SumRevRef( DwellUnitType:HVACHeatRef, DwellUnitType:NumAssigningHtClDUs )  endif  }
   "Set HVACCool:NumAssigningDUs"      HVACCool:NumAssigningDUs  = 
      {  if (Proj:IsMultiFamily < 0.5) then  UNDEFINED
         else  SumRevRef( DwellUnitType:HVACCoolRef, DwellUnitType:NumAssigningHtClDUs )  endif  }
   "Set HVACHtPump:NumAssigningDUs"    HVACHtPump:NumAssigningDUs  = 
      {  if (Proj:IsMultiFamily < 0.5) then  UNDEFINED
         else  SumRevRef( DwellUnitType:HVACHtPumpRef, DwellUnitType:NumAssigningHPDUs )  endif  }

   "Set HVACHeat:TreeDescrip"    HVACHeat:TreeDescrip   =               ; SAC 6/27/20
      {  if (Proj:IsMultiFamily > 0.5)
         then  if (IfValidAnd( NumAssigningDUs > 0 ))
               then  Format( "%s, serving %g dwelling unit(s)", TypeAbbrevStr, NumAssigningDUs )
               else  Format( "%s, not assigned", TypeAbbrevStr )
               endif
         else  if (FloorAreaServed > 1)
               then  Format( "%s, %s SqFt assigned", TypeAbbrevStr, FltToStr( FloorAreaServed ) )
               else  Format( "%s, not assigned", TypeAbbrevStr )
               endif
         endif  }
   "Set HVACCool:TreeDescrip"    HVACCool:TreeDescrip   =
      {  if (Proj:IsMultiFamily > 0.5)
         then  if (IfValidAnd( NumAssigningDUs > 0 ))
               then  Format( "%s, serving %g dwelling unit(s)", TypeAbbrevStr, NumAssigningDUs )
               else  Format( "%s, not assigned", TypeAbbrevStr )
               endif
         else  if (FloorAreaServed > 1)
               then  Format( "%s, %s SqFt assigned", TypeAbbrevStr, FltToStr( FloorAreaServed ) )
               else  Format( "%s, not assigned", TypeAbbrevStr )
               endif
         endif  }
   "Set HVACHtPump:TreeDescrip"  HVACHtPump:TreeDescrip   =    ; prepended 'dual fuel' label - SAC 12/08/20
      {  if (Proj:IsMultiFamily > 0.5)
         then  if (IfValidAnd( NumAssigningDUs > 0 ))
               then  if (IfValidAnd( ModelDualFuel > 0 ))
                     then  Format( "dual fuel %s, serving %g dwelling unit(s)", TypeAbbrevStr, NumAssigningDUs )
                     else  Format( "%s, serving %g dwelling unit(s)", TypeAbbrevStr, NumAssigningDUs )
                     endif
               else  if (IfValidAnd( ModelDualFuel > 0 ))
                     then  Format( "dual fuel %s, not assigned", TypeAbbrevStr )
                     else  Format( "%s, not assigned", TypeAbbrevStr )
                     endif
               endif
         else  if (FloorAreaServed > 1)
               then  if (IfValidAnd( ModelDualFuel > 0 ))
                     then  Format( "dual fuel %s, %s SqFt assigned", TypeAbbrevStr, FltToStr( FloorAreaServed ) )
                     else  Format( "%s, %s SqFt assigned", TypeAbbrevStr, FltToStr( FloorAreaServed ) )
                     endif
               else  if (IfValidAnd( ModelDualFuel > 0 ))
                     then  Format( "dual fuel %s, not assigned", TypeAbbrevStr )
                     else  Format( "%s, not assigned", TypeAbbrevStr )
                     endif
               endif
         endif  }

   ; SAC 11/14/18 - blast Ducted HP checkbox and Dist & Fan assignments for VCHP systems
   ; SAC 2/12/19 - revise rule to PREVENT blasting duct flag and assignments for Std, SMF, DRtg... runs    ; VCHP2 - SAC 11/01/20
   "Reset duct-related HVACSys properties for VCHP systems"    HVACSys:Action  =                   ; prevent duct/fan reset for VCHP2 systems - SAC 08/02/21
      {  if (IfValidAnd( Proj:RunAbbrev = "s" ) .OR. IfValidAnd( Proj:RunAbbrev = "smf" ) .OR.
             IfValidAnd( Proj:RunAbbrev = "dr" )) then  UNCHANGED
         else if ( (IfValidAnd( HtPumpDucted > 0 ) .OR. LocalCompAssigned( DistribSystem ) .OR.
                                                        LocalCompAssigned( Fan )) .AND.
                   Type == 2 .AND. IfValidAnd( NumHtPumpSystemTypes > 0 ) .AND.
                   IfValidAnd( HtPumpSystem[1]:Type = 22 ))
         then  EvalRulelist( "Reset_HVACSys_HtPump_Ducts", 1 )
         else  UNCHANGED  endif endif  }

	"Default HVACDist via subordinate rulelist"		HVACDist:Action	= {  EvalRulelist( "Default_HVACDist", 1 )  }

	"Default HVACDist - Verified Duct Design via subordinate rulelist"	Proj:Action	= {
	      if (Proj:StdDesignBase >= 2019)
         then  EvalRulelist( "Default_HVACDist_VerifiedDuctDesign" )
         else  UNCHANGED  endif  }

   "Set HVACDist:ReportDuctDesign"     HVACDist:ReportDuctDesign  =        ; SAC 4/13/19
      {  if (Proj:StdDesignBase >= 2019 .AND. IfValidAnd( DefaultSystem = 0 ) .AND. IfValidAnd( DuctsPresent > 0 ) .AND.
             IfValidAnd( DuctDesign > 0 ) .AND. IfValidAnd( FloorAreaServed > 0 ) .AND.
             SumChildren( DuctSeg:SupplyArea ) > 0.1 .AND. SumChildren( DuctSeg:ReturnArea ) > 0.1 .AND.
             IfValidAnd( DuctDesignInsRvalue > 0 ) .AND. IfValidAnd( RetDuctDesignInsRvalue > 0 ))
         then  1  else  UNDEFINED  endif  }

	"Default HVACFan via subordinate rulelist"		HVACFan:Action	 	= {  EvalRulelist( "Default_Fan", 1 )  }


  ; More HVACSys heating/cooling equipment summarization
	"Round2 of HVACSys Heat/Cool/HtPump property init"		HVACSys:Action		= {	if (Type == 1 .OR. Type == 3)
																											then  EvalRulelist( "SetupHVACSys_Round2_HeatCool", 1 )
																											else if (Type == 2)
																											then	EvalRulelist( "SetupHVACSys_Round2_HeatPump", 1 )
																											else	UNCHANGED  endif endif  }

  ; SAC 3/10/14 - set new property used to identify sum of all cool/heat/htpump equip units across all new, altered or existing/verified systems (used for generating SCSysRpt report records)
  ; mjb  4/21/14 - "Mech1" replaced with "SCSysRpt" in data model
  ; SAC 1/14/16 - moved down BELOW eval of 'SetupHVACSys_Round2_*' rules since HVACSys:MaxNumHVACEquipTypes not set until those rules due to new dependence on HtOrClDucted
	"Set Proj:NumSCSysEquipUnits"		Proj:NumSCSysEquipUnits		= {	SumAll( HVACSys:MaxNumHVACEquipTypes )  }

	; setup properties related to user toggle of cooling equipment simulation (in proposed model when No Cooling selected)
	"Default HVACSys:PreventCoolingSim"		HVACSys:PreventCoolingSim	= {	0  }		; toggle enabling user to toggle OFF cooling equipment simulation (in proposed model when No Cooling selected)
	"Set HVACSys:NoPropCoolingSim"			HVACSys:NoPropCoolingSim	= {	if (Proj:BypassRuleLimits > 0 .AND. PreventCoolingSim > 0 .AND.
																										 (Type == 1 .OR. Type == 3) .AND. CoolSysType == 1)		; "NoCooling - No cooling equipment"
																									then  1  else  0  endif  }

  ; SAC 7/16/14 - new property to track the CoolDucted setting for the INPUT model
  ; mjb 7/17/14	- converted this property to a 10 element array to match CoolSystem and HtPumpSystem
  ; mjb 8/25/14	- keeping tract at the equipment level is not needed for reporting
  ; SAC 4/23/15 - restored settings @ equipment level to prevent HERS airflow flags for equipment of unducted systems
	"Set HVACSys:CoolDuctedRpt"		HVACSys:CoolDuctedRpt	= {	if (IfValidAnd( Proj:RunNumber < 0.5 )) then  CoolDucted  else  UNCHANGED  endif  }
	"Set HVACSys:CoolDuctedRpt[2]"	HVACSys:CoolDuctedRpt[2]	= {	if (IfValidAnd( Proj:RunNumber < 0.5 ).AND. ( (Type!=2 .AND. NumCoolSystemTypes   >= 2 .AND. LocalCompAssigned(   CoolSystem[2] ) > 0) .OR.
																																						 (Type==2 .AND. NumHtPumpSystemTypes >= 2 .AND. LocalCompAssigned( HtPumpSystem[2] ) > 0))) then  CoolDucted  else  UNCHANGED  endif  }
	"Set HVACSys:CoolDuctedRpt[3]"	HVACSys:CoolDuctedRpt[3]	= {	if (IfValidAnd( Proj:RunNumber < 0.5 ).AND. ( (Type!=2 .AND. NumCoolSystemTypes   >= 3 .AND. LocalCompAssigned(   CoolSystem[3] ) > 0) .OR.
																																						 (Type==2 .AND. NumHtPumpSystemTypes >= 3 .AND. LocalCompAssigned( HtPumpSystem[3] ) > 0))) then  CoolDucted  else  UNCHANGED  endif  }
	"Set HVACSys:CoolDuctedRpt[4]"	HVACSys:CoolDuctedRpt[4]	= {	if (IfValidAnd( Proj:RunNumber < 0.5 ).AND. ( (Type!=2 .AND. NumCoolSystemTypes   >= 4 .AND. LocalCompAssigned(   CoolSystem[4] ) > 0) .OR.
																																						 (Type==2 .AND. NumHtPumpSystemTypes >= 4 .AND. LocalCompAssigned( HtPumpSystem[4] ) > 0))) then  CoolDucted  else  UNCHANGED  endif  }
	"Set HVACSys:CoolDuctedRpt[5]"	HVACSys:CoolDuctedRpt[5]	= {	if (IfValidAnd( Proj:RunNumber < 0.5 ).AND. ( (Type!=2 .AND. NumCoolSystemTypes   >= 5 .AND. LocalCompAssigned(   CoolSystem[5] ) > 0) .OR.
																																						 (Type==2 .AND. NumHtPumpSystemTypes >= 5 .AND. LocalCompAssigned( HtPumpSystem[5] ) > 0))) then  CoolDucted  else  UNCHANGED  endif  }
	"Set HVACSys:CoolDuctedRpt[6]"	HVACSys:CoolDuctedRpt[6]	= {	if (IfValidAnd( Proj:RunNumber < 0.5 ).AND. ( (Type!=2 .AND. NumCoolSystemTypes   >= 6 .AND. LocalCompAssigned(   CoolSystem[6] ) > 0) .OR.
																																						 (Type==2 .AND. NumHtPumpSystemTypes >= 6 .AND. LocalCompAssigned( HtPumpSystem[6] ) > 0))) then  CoolDucted  else  UNCHANGED  endif  }
	"Set HVACSys:CoolDuctedRpt[7]"	HVACSys:CoolDuctedRpt[7]	= {	if (IfValidAnd( Proj:RunNumber < 0.5 ).AND. ( (Type!=2 .AND. NumCoolSystemTypes   >= 7 .AND. LocalCompAssigned(   CoolSystem[7] ) > 0) .OR.
																																						 (Type==2 .AND. NumHtPumpSystemTypes >= 7 .AND. LocalCompAssigned( HtPumpSystem[7] ) > 0))) then  CoolDucted  else  UNCHANGED  endif  }
	"Set HVACSys:CoolDuctedRpt[8]"	HVACSys:CoolDuctedRpt[8]	= {	if (IfValidAnd( Proj:RunNumber < 0.5 ).AND. ( (Type!=2 .AND. NumCoolSystemTypes   >= 8 .AND. LocalCompAssigned(   CoolSystem[8] ) > 0) .OR.
																																						 (Type==2 .AND. NumHtPumpSystemTypes >= 8 .AND. LocalCompAssigned( HtPumpSystem[8] ) > 0))) then  CoolDucted  else  UNCHANGED  endif  }
	"Set HVACSys:CoolDuctedRpt[9]"	HVACSys:CoolDuctedRpt[9]	= {	if (IfValidAnd( Proj:RunNumber < 0.5 ).AND. ( (Type!=2 .AND. NumCoolSystemTypes   >= 9 .AND. LocalCompAssigned(   CoolSystem[9] ) > 0) .OR.
																																						 (Type==2 .AND. NumHtPumpSystemTypes >= 9 .AND. LocalCompAssigned( HtPumpSystem[9] ) > 0))) then  CoolDucted  else  UNCHANGED  endif  }
	"Set HVACSys:CoolDuctedRpt[10]"	HVACSys:CoolDuctedRpt[10]	= {	if (IfValidAnd( Proj:RunNumber < 0.5 ).AND. ( (Type!=2 .AND. NumCoolSystemTypes   >= 10 .AND. LocalCompAssigned(   CoolSystem[10] ) > 0) .OR.
																																						 (Type==2 .AND. NumHtPumpSystemTypes >= 10 .AND. LocalCompAssigned( HtPumpSystem[10] ) > 0))) then  CoolDucted  else  UNCHANGED  endif  }

	; mjb	4/17/14	set flags for HVAC objects that match HVACSys Prop. Design (set in Round2 rulelists above)
; AFUE
	"Set IsHtSysAFUE flag for HeatSystem[1]"		HVACSys:IsHtSysAFUE[1]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HeatSystem[1]) ) then
																													if ( IfValidAnd( HeatSystem[1]:AFUE <= HtSysAFUE ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHtSysAFUE flag for HeatSystem[2]"		HVACSys:IsHtSysAFUE[2]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HeatSystem[2]) ) then
																													if ( IfValidAnd( HeatSystem[2]:AFUE <= HtSysAFUE ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHtSysAFUE flag for HeatSystem[3]"		HVACSys:IsHtSysAFUE[3]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HeatSystem[3]) ) then
																													if ( IfValidAnd( HeatSystem[3]:AFUE <= HtSysAFUE ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHtSysAFUE flag for HeatSystem[4]"		HVACSys:IsHtSysAFUE[4]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HeatSystem[4]) ) then
																													if ( IfValidAnd( HeatSystem[4]:AFUE <= HtSysAFUE ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHtSysAFUE flag for HeatSystem[5]"		HVACSys:IsHtSysAFUE[5]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HeatSystem[5]) ) then
																													if ( IfValidAnd( HeatSystem[5]:AFUE <= HtSysAFUE ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHtSysAFUE flag for HeatSystem[6]"		HVACSys:IsHtSysAFUE[6]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HeatSystem[6]) ) then
																													if ( IfValidAnd( HeatSystem[6]:AFUE <= HtSysAFUE ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHtSysAFUE flag for HeatSystem[7]"		HVACSys:IsHtSysAFUE[7]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HeatSystem[7]) ) then
																													if ( IfValidAnd( HeatSystem[7]:AFUE <= HtSysAFUE ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHtSysAFUE flag for HeatSystem[8]"		HVACSys:IsHtSysAFUE[8]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HeatSystem[8]) ) then
																													if ( IfValidAnd( HeatSystem[8]:AFUE <= HtSysAFUE ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHtSysAFUE flag for HeatSystem[9]"		HVACSys:IsHtSysAFUE[9]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HeatSystem[9]) ) then
																													if ( IfValidAnd( HeatSystem[9]:AFUE <= HtSysAFUE ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHtSysAFUE flag for HeatSystem[10]"		HVACSys:IsHtSysAFUE[10]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HeatSystem[10]) ) then
																													if ( IfValidAnd( HeatSystem[10]:AFUE <= HtSysAFUE ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHtSysAFUE flag for HVACHeat"				HVACHeat:IsHtSysAFUE		=	{ MaxRevRef( HVACSys:HeatSystem, HVACSys:IsHtSysAFUE ) }

;	"debug"		HVACHeat:Action	= {	MessageBox( "Default -- HVACHeat: '%s':  IsHtSysAFUE = %g", Name, IsHtSysAFUE )  }
;	"debug"		HVACSys:Action	= {	MessageBox( "Default -- HVACSys: '%s':  ActiveInAnyZone = %g  IsHtSysAFUE[1] = %g  IsHtSysAFUE[2] = %g", Name, ActiveInAnyZone, IsHtSysAFUE[1], IsHtSysAFUE[2] )  }
; SEER - HVACCool
	"Set IsClSysSEER flag for CoolSystem[1]"		HVACSys:IsClSysSEER[1]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[1]) ) then
																													if ( IfValidAnd( CoolSystem[1]:SEER <= ClSysSEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysSEER flag for CoolSystem[2]"		HVACSys:IsClSysSEER[2]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[2]) ) then
																													if ( IfValidAnd( CoolSystem[2]:SEER <= ClSysSEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysSEER flag for CoolSystem[3]"		HVACSys:IsClSysSEER[3]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[3]) ) then
																													if ( IfValidAnd( CoolSystem[3]:SEER <= ClSysSEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysSEER flag for CoolSystem[4]"		HVACSys:IsClSysSEER[4]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[4]) ) then
																													if ( IfValidAnd( CoolSystem[4]:SEER <= ClSysSEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysSEER flag for CoolSystem[5]"		HVACSys:IsClSysSEER[5]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[5]) ) then
																													if ( IfValidAnd( CoolSystem[5]:SEER <= ClSysSEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysSEER flag for CoolSystem[6]"		HVACSys:IsClSysSEER[6]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[6]) ) then
																													if ( IfValidAnd( CoolSystem[6]:SEER <= ClSysSEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysSEER flag for CoolSystem[7]"		HVACSys:IsClSysSEER[7]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[7]) ) then
																													if ( IfValidAnd( CoolSystem[7]:SEER <= ClSysSEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysSEER flag for CoolSystem[8]"		HVACSys:IsClSysSEER[8]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[8]) ) then
																													if ( IfValidAnd( CoolSystem[8]:SEER <= ClSysSEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysSEER flag for CoolSystem[9]"		HVACSys:IsClSysSEER[9]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[9]) ) then
																													if ( IfValidAnd( CoolSystem[9]:SEER <= ClSysSEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysSEER flag for CoolSystem[10]"		HVACSys:IsClSysSEER[10]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[10]) ) then
																													if ( IfValidAnd( CoolSystem[10]:SEER <= ClSysSEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysSEER flag for HVACCool"				HVACCool:IsClSysSEER		=	{ MaxRevRef( HVACSys:CoolSystem, HVACSys:IsClSysSEER ) }

; EER - HVACCool
   ;--------------------------------------------------------------------
   ; Reset HVACCool:EER based on UseEERinAnalysis 		mjb-08/01/14
   ;--------------------------------------------------------------------
	"Set UseEERinAnalysis flag if EER is user-defined"
																	HVACCool:UseEERinAnalysis	=	{	if ( LocalStatus( EER ) == 7 ) then 1 else UNCHANGED endif	}
	"Reset EER if UseEERinAnalysis not checked"		HVACCool:Action = {	if (FloorAreaServed > 0.5 .AND. IfValidAnd( UseEERinAnalysis > 0.5 )==0 ) then
																									EvalRulelist( "ForceDefault_HVACCool_EER", 1 )
																								else UNCHANGED endif	}
;	"debug HVAC"			HVACCool:Action = { if (FloorAreaServed > 0.5) then PostWarning( "PostProposedInput  HVACCool: '%s'  EER: %g   EERRpt: %g",  Name, EER, EERRpt ) else UNCHANGED endif  }
   ;--------------------------------------------------------------------


	"Set IsClSysEER flag for CoolSystem[1]"		HVACSys:IsClSysEER[1]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[1]) ) then
																													if ( IfValidAnd( CoolSystem[1]:EER <= ClSysEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysEER flag for CoolSystem[2]"		HVACSys:IsClSysEER[2]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[2]) ) then
																													if ( IfValidAnd( CoolSystem[2]:EER <= ClSysEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysEER flag for CoolSystem[3]"		HVACSys:IsClSysEER[3]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[3]) ) then
																													if ( IfValidAnd( CoolSystem[3]:EER <= ClSysEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysEER flag for CoolSystem[4]"		HVACSys:IsClSysEER[4]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[4]) ) then
																													if ( IfValidAnd( CoolSystem[4]:EER <= ClSysEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysEER flag for CoolSystem[5]"		HVACSys:IsClSysEER[5]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[5]) ) then
																													if ( IfValidAnd( CoolSystem[5]:EER <= ClSysEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysEER flag for CoolSystem[6]"		HVACSys:IsClSysEER[6]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[6]) ) then
																													if ( IfValidAnd( CoolSystem[6]:EER <= ClSysEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysEER flag for CoolSystem[7]"		HVACSys:IsClSysEER[7]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[7]) ) then
																													if ( IfValidAnd( CoolSystem[7]:EER <= ClSysEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysEER flag for CoolSystem[8]"		HVACSys:IsClSysEER[8]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[8]) ) then
																													if ( IfValidAnd( CoolSystem[8]:EER <= ClSysEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysEER flag for CoolSystem[9]"		HVACSys:IsClSysEER[9]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[9]) ) then
																													if ( IfValidAnd( CoolSystem[9]:EER <= ClSysEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysEER flag for CoolSystem[10]"		HVACSys:IsClSysEER[10]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[10]) ) then
																													if ( IfValidAnd( CoolSystem[10]:EER <= ClSysEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysEER flag for HVACCool"				HVACCool:IsClSysEER		=	{ MaxRevRef( HVACSys:CoolSystem, HVACSys:IsClSysEER ) }

; CFMperTon - HVACCool
	"Set IsClSysCFMperTon flag for CoolSystem[1]"		HVACSys:IsClSysCFMperTon[1]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[1]) ) then
																													if ( IfValidAnd( CoolSystem[1]:CFMperTon <= ClSysCFMperTon ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysCFMperTon flag for CoolSystem[2]"		HVACSys:IsClSysCFMperTon[2]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[2]) ) then
																													if ( IfValidAnd( CoolSystem[2]:CFMperTon <= ClSysCFMperTon ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysCFMperTon flag for CoolSystem[3]"		HVACSys:IsClSysCFMperTon[3]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[3]) ) then
																													if ( IfValidAnd( CoolSystem[3]:CFMperTon <= ClSysCFMperTon ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysCFMperTon flag for CoolSystem[4]"		HVACSys:IsClSysCFMperTon[4]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[4]) ) then
																													if ( IfValidAnd( CoolSystem[4]:CFMperTon <= ClSysCFMperTon ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysCFMperTon flag for CoolSystem[5]"		HVACSys:IsClSysCFMperTon[5]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[5]) ) then
																													if ( IfValidAnd( CoolSystem[5]:CFMperTon <= ClSysCFMperTon ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysCFMperTon flag for CoolSystem[6]"		HVACSys:IsClSysCFMperTon[6]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[6]) ) then
																													if ( IfValidAnd( CoolSystem[6]:CFMperTon <= ClSysCFMperTon ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysCFMperTon flag for CoolSystem[7]"		HVACSys:IsClSysCFMperTon[7]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[7]) ) then
																													if ( IfValidAnd( CoolSystem[7]:CFMperTon <= ClSysCFMperTon ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysCFMperTon flag for CoolSystem[8]"		HVACSys:IsClSysCFMperTon[8]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[8]) ) then
																													if ( IfValidAnd( CoolSystem[8]:CFMperTon <= ClSysCFMperTon ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysCFMperTon flag for CoolSystem[9]"		HVACSys:IsClSysCFMperTon[9]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[9]) ) then
																													if ( IfValidAnd( CoolSystem[9]:CFMperTon <= ClSysCFMperTon ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysCFMperTon flag for CoolSystem[10]"		HVACSys:IsClSysCFMperTon[10]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[10]) ) then
																													if ( IfValidAnd( CoolSystem[10]:CFMperTon <= ClSysCFMperTon ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysCFMperTon flag for HVACCool"				HVACCool:IsClSysCFMperTon		=	{ MaxRevRef( HVACSys:CoolSystem, HVACSys:IsClSysCFMperTon ) }

; SEER - HVACHtPump
	"Set IsHPSysSEER flag for HtPumpSystem[1]"		HVACSys:IsHPSysSEER[1]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[1]) ) then
																													if ( IfValidAnd( HtPumpSystem[1]:SEER <= ClSysSEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysSEER flag for HtPumpSystem[2]"		HVACSys:IsHPSysSEER[2]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[2]) ) then
																													if ( IfValidAnd( HtPumpSystem[2]:SEER <= ClSysSEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysSEER flag for HtPumpSystem[3]"		HVACSys:IsHPSysSEER[3]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[3]) ) then
																													if ( IfValidAnd( HtPumpSystem[3]:SEER <= ClSysSEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysSEER flag for HtPumpSystem[4]"		HVACSys:IsHPSysSEER[4]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[4]) ) then
																													if ( IfValidAnd( HtPumpSystem[4]:SEER <= ClSysSEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysSEER flag for HtPumpSystem[5]"		HVACSys:IsHPSysSEER[5]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[5]) ) then
																													if ( IfValidAnd( HtPumpSystem[5]:SEER <= ClSysSEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysSEER flag for HtPumpSystem[6]"		HVACSys:IsHPSysSEER[6]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[6]) ) then
																													if ( IfValidAnd( HtPumpSystem[6]:SEER <= ClSysSEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysSEER flag for HtPumpSystem[7]"		HVACSys:IsHPSysSEER[7]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[7]) ) then
																													if ( IfValidAnd( HtPumpSystem[7]:SEER <= ClSysSEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysSEER flag for HtPumpSystem[8]"		HVACSys:IsHPSysSEER[8]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[8]) ) then
																													if ( IfValidAnd( HtPumpSystem[8]:SEER <= ClSysSEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysSEER flag for HtPumpSystem[9]"		HVACSys:IsHPSysSEER[9]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[9]) ) then
																													if ( IfValidAnd( HtPumpSystem[9]:SEER <= ClSysSEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysSEER flag for HtPumpSystem[10]"		HVACSys:IsHPSysSEER[10]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[10]) ) then
																													if ( IfValidAnd( HtPumpSystem[10]:SEER <= ClSysSEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysSEER flag for HVACHtPump"				HVACHtPump:IsClSysSEER		=	{ MaxRevRef( HVACSys:HtPumpSystem, HVACSys:IsHPSysSEER ) }

; EER - HVACCHtPump

"Set UseEERinAnalysis flag if EER is user-defined"	HVACHtPump:UseEERinAnalysis	=	{	if ( LocalStatus( EER ) == 7 ) then 1 else UNCHANGED endif	}

; SAC 11/4/18 - added logic to check EERValid flag before looking it up (prevent error in VCHP models)
"Reset EER if UseEERinAnalysis not checked"		HVACHtPump:Action = {	if (FloorAreaServed > 0.5 .AND. UseEERinAnalysis < 0.5 .AND.
                                                                            T24RCoolingEquipment:EERValid(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) > 0) then
																									EvalRulelist( "ForceDefault_HVACHtPump_EER", 1 )
																								else UNCHANGED endif	}
																								 
	"Set IsHPSysEER flag for HtPumpSystem[1]"		HVACSys:IsHPSysEER[1]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[1]) ) then
																													if ( IfValidAnd( HtPumpSystem[1]:EER <= ClSysEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysEER flag for HtPumpSystem[2]"		HVACSys:IsHPSysEER[2]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[2]) ) then
																													if ( IfValidAnd( HtPumpSystem[2]:EER <= ClSysEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysEER flag for HtPumpSystem[3]"		HVACSys:IsHPSysEER[3]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[3]) ) then
																													if ( IfValidAnd( HtPumpSystem[3]:EER <= ClSysEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysEER flag for HtPumpSystem[4]"		HVACSys:IsHPSysEER[4]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[4]) ) then
																													if ( IfValidAnd( HtPumpSystem[4]:EER <= ClSysEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysEER flag for HtPumpSystem[5]"		HVACSys:IsHPSysEER[5]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[5]) ) then
																													if ( IfValidAnd( HtPumpSystem[5]:EER <= ClSysEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysEER flag for HtPumpSystem[6]"		HVACSys:IsHPSysEER[6]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[6]) ) then
																													if ( IfValidAnd( HtPumpSystem[6]:EER <= ClSysEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysEER flag for HtPumpSystem[7]"		HVACSys:IsHPSysEER[7]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[7]) ) then
																													if ( IfValidAnd( HtPumpSystem[7]:EER <= ClSysEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysEER flag for HtPumpSystem[8]"		HVACSys:IsHPSysEER[8]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[8]) ) then
																													if ( IfValidAnd( HtPumpSystem[8]:EER <= ClSysEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysEER flag for HtPumpSystem[9]"		HVACSys:IsHPSysEER[9]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[9]) ) then
																													if ( IfValidAnd( HtPumpSystem[9]:EER <= ClSysEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysEER flag for HtPumpSystem[10]"	HVACSys:IsHPSysEER[10]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[10]) ) then
																													if ( IfValidAnd( HtPumpSystem[10]:EER <= ClSysEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysEER flag for HVACHtPump"			HVACHtPump:IsClSysEER		=	{ MaxRevRef( HVACSys:HtPumpSystem, HVACSys:IsHPSysEER ) }

; CFMperTon - HVACHtPump
	"Set IsHPSysCFMperTon flag for HtPumpSystem[1]"		HVACSys:IsHPSysCFMperTon[1]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[1]) ) then
																													if ( IfValidAnd( HtPumpSystem[1]:CFMperTon <= ClSysCFMperTon ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysCFMperTon flag for HtPumpSystem[2]"		HVACSys:IsHPSysCFMperTon[2]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[2]) ) then
																													if ( IfValidAnd( HtPumpSystem[2]:CFMperTon <= ClSysCFMperTon ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysCFMperTon flag for HtPumpSystem[3]"		HVACSys:IsHPSysCFMperTon[3]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[3]) ) then
																													if ( IfValidAnd( HtPumpSystem[3]:CFMperTon <= ClSysCFMperTon ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysCFMperTon flag for HtPumpSystem[4]"		HVACSys:IsHPSysCFMperTon[4]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[4]) ) then
																													if ( IfValidAnd( HtPumpSystem[4]:CFMperTon <= ClSysCFMperTon ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysCFMperTon flag for HtPumpSystem[5]"		HVACSys:IsHPSysCFMperTon[5]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[5]) ) then
																													if ( IfValidAnd( HtPumpSystem[5]:CFMperTon <= ClSysCFMperTon ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysCFMperTon flag for HtPumpSystem[6]"		HVACSys:IsHPSysCFMperTon[6]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[6]) ) then
																													if ( IfValidAnd( HtPumpSystem[6]:CFMperTon <= ClSysCFMperTon ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysCFMperTon flag for HtPumpSystem[7]"		HVACSys:IsHPSysCFMperTon[7]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[7]) ) then
																													if ( IfValidAnd( HtPumpSystem[7]:CFMperTon <= ClSysCFMperTon ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysCFMperTon flag for HtPumpSystem[8]"		HVACSys:IsHPSysCFMperTon[8]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[8]) ) then
																													if ( IfValidAnd( HtPumpSystem[8]:CFMperTon <= ClSysCFMperTon ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysCFMperTon flag for HtPumpSystem[9]"		HVACSys:IsHPSysCFMperTon[9]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[9]) ) then
																													if ( IfValidAnd( HtPumpSystem[9]:CFMperTon <= ClSysCFMperTon ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysCFMperTon flag for HtPumpSystem[10]"	HVACSys:IsHPSysCFMperTon[10]		=	{ if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[10]) ) then
																													if ( IfValidAnd( HtPumpSystem[10]:CFMperTon <= ClSysCFMperTon ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysCFMperTon flag for HVACHtPump"			HVACHtPump:IsClSysCFMperTon		=	{ MaxRevRef( HVACSys:HtPumpSystem, HVACSys:IsHPSysCFMperTon ) }

	;	no default:  HVACSys:CFIClVentFan,     BEMP_Obj,  1,    1, "ClVentFan",     "Fan type used to supply CFI cooling ventilation"               
	"Set HVACSys:CFIClVentFlow - PLACEHOLDER"	HVACSys:CFIClVentFlow	= {	if (Proj:EnableClVent < 0.5 .OR. Proj:UnitClVentOption != 3) then  0
																									else if (Type == 3)
																									then	if (LocalCompAssigned( CFIClVentFan ) == 0) then  0
																											else  1  endif    ; would be if it were already defaulted...: CFIClVentFan:CoolingVent  endif
																									else if (Type == 1 .OR. Type == 2)
																									then	if (CFIClVentOption < 1 .OR. LocalCompAssigned( CFIClVentFan ) == 0) then  0
																											else  1  endif    ; would be if it were already defaulted...: CFIClVentFan:CoolingVent  endif
																									else  0  endif endif endif  }

   "Set HVACHtPump:UIDialogMsg"     HVACHtPump:UIDialogMsg  = {
         if (IfValidAnd( IsAvailable > 0 )==0)
         then  "This system type is not yet available for compliance analysis"
         else if (Type == 22)  ; VCHP
         then  "HSPF, Cap @ 17, SEER and EER for reporting only, no analysis impact"
         else  UNDEFINED  endif endif  }


   ;--------------------------------------------------------------------
   ; ProposedInput:  HVACSys object used as DHWHeater
   ;--------------------------------------------------------------------
	"Set HtEqpCanBeDHWHtr flag for HtPumpSystem[1]"		HVACSys:HtEqpCanBeDHWHtr	= {	if (Type != 2) then  0
																													else if (NumHtPumpSystemTypes > 0 .AND. IfValidAnd( HtPumpSystem[1]:CanBeDHWHtr > -1 ))
																													then  HtPumpSystem[1]:CanBeDHWHtr
																													else  0  endif endif  }
	"Default HVACSys:ServesAsDHWHtr flag"					HVACSys:ServesAsDHWHtr		= {	HtEqpCanBeDHWHtr  }
	"Set CanBeDHWHtr flag"										HVACSys:CanBeDHWHtr			= {	if (HtEqpCanBeDHWHtr > 0.1 .AND. ServesAsDHWHtr > 0.5) then  1  else  0  endif  }

; probably MOVE these rules to a subordinate rulelist that sets them based on some reasonable logic referencing DHW-related HVACHtPump properties
; FOR NOW - hardwire to DHWHeater settings from a prototype model
; will need to move AFTER call to RULELIST "SetupHVACSys_Round2_HeatPump", where HPSysCOP47 is assigned
; move to rulelist that gets called from ASHP equivalent to above RULELIST?	
	; "Set HVACSys:DHWHeaterElementType"  HVACSys:DHWHeaterElementType	= {	"Heat Pump"      }
	; SAC 6/2/14 - added logic to account for new GSHP HeaterElementType option
	"Set HVACSys:DHWHeaterElementType"  HVACSys:DHWHeaterElementType	= {	if (IfValidAnd( Type = 2 ) .AND. IfValidAnd( HtPumpSysType = 12 ))  ; Type = HP / HtPumpSysType = "GroundSourceHeatPump - Ground source heat pump (able to heat DHW)"
																									then	"Ground-Source Heat Pump"
																									else	   "Air-Source Heat Pump"    endif  }
;	"Set HVACSys:DHWTankType"           HVACSys:DHWTankType         	= {	"Small Storage"  }			; SAC 5/7/14 - using "Unfired Storage Tank" or "Indirect" here doesn't work with Heat Pump
	"Set HVACSys:DHWTankType"           HVACSys:DHWTankType         	= {	"Indirect"       }			; SAC 6/6/14 - updated DHW engine now works w/ AWHP + Indirect tank
	"Set HVACSys:DHWInputRating"        HVACSys:DHWInputRating      	= {	0                }
	"Set HVACSys:DHWInputRatingUnits"	HVACSys:DHWInputRatingUnits	= {	switch (DHWHeaterElementType)
																										case  0 :	"watts"   ; "Electric Resistance" 
																										case  1 :   "Btu/hr"  ; "Natural Gas"   
																										case  2 :   "Btu/hr"  ; "Propane"             
																										case  3 :   "watts"   ; "Air-Source Heat Pump"           
																										case  6 :   "watts"   ; "Ground-Source Heat Pump"           
																										case  4 :   "Btu/hr"  ; "Oil"   
																										default :	" "
																									endswitch  }
;	"Set HVACSys:DHWEnergyFactor"       HVACSys:DHWEnergyFactor     	= {	(0.9376 * HVACSys:HPSysCOP47 - 0.7032) / (1.086 - 0.1102 * HVACSys:HPSysCOP47)	}
;	"Set HVACSys:DHWEnergyFactor"       HVACSys:DHWEnergyFactor     	= {	0.575	           }
	"Set HVACSys:DHWEnergyFactor"       HVACSys:DHWEnergyFactor     	= {	if (IfValidAnd( HPSysCOP47 > 0.5 )) then  HPSysCOP47  else  3  endif  }
	"Set HVACSys:DHWTankVolume"         HVACSys:DHWTankVolume       	= {	50               }
	"Set HVACSys:DHWIntInsulRVal"       HVACSys:DHWIntInsulRVal     	= {	0                }
	"Set HVACSys:DHWExtInsulRVal"       HVACSys:DHWExtInsulRVal     	= {	0                }
	"Set HVACSys:DHWAmbientCond"        HVACSys:DHWAmbientCond      	= {	"Unconditioned"  }
	"Set HVACSys:DHWStandbyLossFrac"    HVACSys:DHWStandbyLossFrac  	= {	0                }
;HSPF = (3.2 x COP)  2.4
;RE = HSPF / 3.413
;EF = RE/(1 + 0.1175 x RE)
; so EF = (.9376 x COP - .7032) / (1.086 - 0.1102 x COP)
	"Set HVACSys:DHWFloorAreaServed"		HVACSys:DHWFloorAreaServed 	= {	SumRevRef( DHWSys:DHWHeater, DHWSys:FloorAreaServed )  }		; SAC 5/7/14 - added to facilitate error checks


   ;--------------------------------------------------------------------
   ; ProposedInput: DwellUnitType HVAC Rules
   ;--------------------------------------------------------------------

	; "Default DwellUnitType:HVACSysType"
	"Set DwellUnitType:HVACSysTypeAbbrev"		DwellUnitType:HVACSysTypeAbbrev		= {	HVACSysType  }
	"Set DwellUnitType:HVACSysTypeAbbrevStr"	DwellUnitType:HVACSysTypeAbbrevStr	= {	EnumString( HVACSysTypeAbbrev )  }

	"Set DwellUnitType:HeatEquipNumLbl"		DwellUnitType:HeatEquipNumLbl		= {	if (HVACSysType == 2) then	"Heat Pump(s):"
																											else								"Heating:"				endif  }

	"Default DwellUnitType:NumHeatEquipTypes"		DwellUnitType:NumHeatEquipTypes	= {	1  }

  ; SAC 11/20/14 - rules to FORCE reset of array elements beyond those valid based on NumHeatEquipTypes
	"Force reset of DwellUnitType:HeatEquip*[1]"		DwellUnitType:Action		= {	if (NumHeatEquipTypes >= 1 .OR. (LocalStatus( HeatEquipCount[1] ) < 6 .AND. LocalStatus( HVACHeatRef[1] ) < 6)) then  UNCHANGED
																											else	EvalRulelist( "ForceReset_DwellUnitType_HeatEquip_1", 1 )  endif  }
	"Force reset of DwellUnitType:HeatEquip*[2]"		DwellUnitType:Action		= {	if (NumHeatEquipTypes >= 2 .OR. (LocalStatus( HeatEquipCount[2] ) < 6 .AND. LocalStatus( HVACHeatRef[2] ) < 6)) then  UNCHANGED
																											else	EvalRulelist( "ForceReset_DwellUnitType_HeatEquip_2", 1 )  endif  }
	"Force reset of DwellUnitType:HeatEquip*[3]"		DwellUnitType:Action		= {	if (NumHeatEquipTypes >= 3 .OR. (LocalStatus( HeatEquipCount[3] ) < 6 .AND. LocalStatus( HVACHeatRef[3] ) < 6)) then  UNCHANGED
																											else	EvalRulelist( "ForceReset_DwellUnitType_HeatEquip_3", 1 )  endif  }
	"Force reset of DwellUnitType:HeatEquip*[4]"		DwellUnitType:Action		= {	if (NumHeatEquipTypes >= 4 .OR. (LocalStatus( HeatEquipCount[4] ) < 6 .AND. LocalStatus( HVACHeatRef[4] ) < 6)) then  UNCHANGED
																											else	EvalRulelist( "ForceReset_DwellUnitType_HeatEquip_4", 1 )  endif  }
	"Force reset of DwellUnitType:HeatEquip*[5]"		DwellUnitType:Action		= {	if (NumHeatEquipTypes >= 5 .OR. (LocalStatus( HeatEquipCount[5] ) < 6 .AND. LocalStatus( HVACHeatRef[5] ) < 6)) then  UNCHANGED
																											else	EvalRulelist( "ForceReset_DwellUnitType_HeatEquip_5", 1 )  endif  }

	"Default DwellUnitType:HeatEquipCount[1]"		DwellUnitType:HeatEquipCount[1]	= {	if (NumHeatEquipTypes > 0) then  1  else  0  endif  }
	"Default DwellUnitType:HeatEquipCount[2]"		DwellUnitType:HeatEquipCount[2]	= {	if (NumHeatEquipTypes > 1) then  1  else  0  endif  }
	"Default DwellUnitType:HeatEquipCount[3]"		DwellUnitType:HeatEquipCount[3]	= {	if (NumHeatEquipTypes > 2) then  1  else  0  endif  }
	"Default DwellUnitType:HeatEquipCount[4]"		DwellUnitType:HeatEquipCount[4]	= {	if (NumHeatEquipTypes > 3) then  1  else  0  endif  }
	"Default DwellUnitType:HeatEquipCount[5]"		DwellUnitType:HeatEquipCount[5]	= {	if (NumHeatEquipTypes > 4) then  1  else  0  endif  }
	; "Default DwellUnitType:HVACHeatRef"

	"Set DwellUnitType:NumHeatEqpUnits - 1"	DwellUnitType:NumHeatEqpUnits	= {	if (NumHeatEquipTypes > 0 .AND. LocalCompAssigned( HVACHeatRef[1]  )) then                    HeatEquipCount[1]   else      0      endif  }
	"Set DwellUnitType:NumHeatEqpUnits - 2"	DwellUnitType:NumHeatEqpUnits	= {	if (NumHeatEquipTypes > 1 .AND. LocalCompAssigned( HVACHeatRef[2]  )) then  NumHeatEqpUnits + HeatEquipCount[2]   else  UNCHANGED  endif  }
	"Set DwellUnitType:NumHeatEqpUnits - 3"	DwellUnitType:NumHeatEqpUnits	= {	if (NumHeatEquipTypes > 2 .AND. LocalCompAssigned( HVACHeatRef[3]  )) then  NumHeatEqpUnits + HeatEquipCount[3]   else  UNCHANGED  endif  }
	"Set DwellUnitType:NumHeatEqpUnits - 4"	DwellUnitType:NumHeatEqpUnits	= {	if (NumHeatEquipTypes > 3 .AND. LocalCompAssigned( HVACHeatRef[4]  )) then  NumHeatEqpUnits + HeatEquipCount[4]   else  UNCHANGED  endif  }
	"Set DwellUnitType:NumHeatEqpUnits - 5"	DwellUnitType:NumHeatEqpUnits	= {	if (NumHeatEquipTypes > 4 .AND. LocalCompAssigned( HVACHeatRef[5]  )) then  NumHeatEqpUnits + HeatEquipCount[5]   else  UNCHANGED  endif  }

	"Set DwellUnitType:HeatEqpType"				DwellUnitType:HeatEqpType			= {	if (NumHeatEquipTypes > 0 .AND. LocalCompAssigned( HVACHeatRef[1] ))
																												then  HVACHeatRef[1]:Type  else  0  endif  }
	"Set DwellUnitType:HeatEqpTypeAbbrev"		DwellUnitType:HeatEqpTypeAbbrev	= {	if (NumHeatEquipTypes > 0 .AND. LocalCompAssigned( HVACHeatRef[1] ))
																												then  HVACHeatRef[1]:TypeAbbrevStr
																												else  " "  endif  }

	"Blast Heat* user input if HeatEqpType has changed"	DwellUnitType:Action	= {	if (LocalStatus( HeatEqpTypeSetup ) < 1 .OR. LocalStatus( PrevHeatEqpType ) < 1) then  UNCHANGED
																												else if (HeatEqpTypeSetup < 0.5) then  UNCHANGED
																												else if (HeatEqpType != PrevHeatEqpType)
																												then	EvalRulelist( "BlastDwellUnitTypeUserInput_Heating", 1 )
																												else	UNCHANGED  endif endif endif  }
	"Set DwellUnitType:PrevHeatEqpType"		DwellUnitType:PrevHeatEqpType		= {	HeatEqpType  }
	"Set DwellUnitType:HeatEqpTypeSetup"	DwellUnitType:HeatEqpTypeSetup	= {	if (HeatEqpType > 0) then  1  else  0  endif  }


	"Default DwellUnitType:NumHtPumpEquipTypes"		DwellUnitType:NumHtPumpEquipTypes	= {	1  }

  ; SAC 11/20/14 - rules to FORCE reset of array elements beyond those valid based on NumHtPumpEquipTypes
	"Force reset of DwellUnitType:HtPumpEquip*[1]"		DwellUnitType:Action		= {	if (NumHtPumpEquipTypes >= 1 .OR. (LocalStatus( HtPumpEquipCount[1] ) < 6 .AND. LocalStatus( HVACHtPumpRef[1] ) < 6)) then  UNCHANGED
																												else	EvalRulelist( "ForceReset_DwellUnitType_HtPumpEquip_1", 1 )  endif  }
	"Force reset of DwellUnitType:HtPumpEquip*[2]"		DwellUnitType:Action		= {	if (NumHtPumpEquipTypes >= 2 .OR. (LocalStatus( HtPumpEquipCount[2] ) < 6 .AND. LocalStatus( HVACHtPumpRef[2] ) < 6)) then  UNCHANGED
																												else	EvalRulelist( "ForceReset_DwellUnitType_HtPumpEquip_2", 1 )  endif  }
	"Force reset of DwellUnitType:HtPumpEquip*[3]"		DwellUnitType:Action		= {	if (NumHtPumpEquipTypes >= 3 .OR. (LocalStatus( HtPumpEquipCount[3] ) < 6 .AND. LocalStatus( HVACHtPumpRef[3] ) < 6)) then  UNCHANGED
																												else	EvalRulelist( "ForceReset_DwellUnitType_HtPumpEquip_3", 1 )  endif  }
	"Force reset of DwellUnitType:HtPumpEquip*[4]"		DwellUnitType:Action		= {	if (NumHtPumpEquipTypes >= 4 .OR. (LocalStatus( HtPumpEquipCount[4] ) < 6 .AND. LocalStatus( HVACHtPumpRef[4] ) < 6)) then  UNCHANGED
																												else	EvalRulelist( "ForceReset_DwellUnitType_HtPumpEquip_4", 1 )  endif  }
	"Force reset of DwellUnitType:HtPumpEquip*[5]"		DwellUnitType:Action		= {	if (NumHtPumpEquipTypes >= 5 .OR. (LocalStatus( HtPumpEquipCount[5] ) < 6 .AND. LocalStatus( HVACHtPumpRef[5] ) < 6)) then  UNCHANGED
																												else	EvalRulelist( "ForceReset_DwellUnitType_HtPumpEquip_5", 1 )  endif  }

	"Default DwellUnitType:HtPumpEquipCount[1]"		DwellUnitType:HtPumpEquipCount[1]	= {	if (NumHtPumpEquipTypes > 0) then  1  else  0  endif  }
	"Default DwellUnitType:HtPumpEquipCount[2]"		DwellUnitType:HtPumpEquipCount[2]	= {	if (NumHtPumpEquipTypes > 1) then  1  else  0  endif  }
	"Default DwellUnitType:HtPumpEquipCount[3]"		DwellUnitType:HtPumpEquipCount[3]	= {	if (NumHtPumpEquipTypes > 2) then  1  else  0  endif  }
	"Default DwellUnitType:HtPumpEquipCount[4]"		DwellUnitType:HtPumpEquipCount[4]	= {	if (NumHtPumpEquipTypes > 3) then  1  else  0  endif  }
	"Default DwellUnitType:HtPumpEquipCount[5]"		DwellUnitType:HtPumpEquipCount[5]	= {	if (NumHtPumpEquipTypes > 4) then  1  else  0  endif  }
	; "Default DwellUnitType:HVACHtPumpRef"

	"Set DwellUnitType:NumHtPumpEqpUnits - 1"		DwellUnitType:NumHtPumpEqpUnits		= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1]  )) then                      HtPumpEquipCount[1]   else      0      endif  }
	"Set DwellUnitType:NumHtPumpEqpUnits - 2"		DwellUnitType:NumHtPumpEqpUnits		= {	if (NumHtPumpEquipTypes > 1 .AND. LocalCompAssigned( HVACHtPumpRef[2]  )) then  NumHtPumpEqpUnits + HtPumpEquipCount[2]   else  UNCHANGED  endif  }
	"Set DwellUnitType:NumHtPumpEqpUnits - 3"		DwellUnitType:NumHtPumpEqpUnits		= {	if (NumHtPumpEquipTypes > 2 .AND. LocalCompAssigned( HVACHtPumpRef[3]  )) then  NumHtPumpEqpUnits + HtPumpEquipCount[3]   else  UNCHANGED  endif  }
	"Set DwellUnitType:NumHtPumpEqpUnits - 4"		DwellUnitType:NumHtPumpEqpUnits		= {	if (NumHtPumpEquipTypes > 3 .AND. LocalCompAssigned( HVACHtPumpRef[4]  )) then  NumHtPumpEqpUnits + HtPumpEquipCount[4]   else  UNCHANGED  endif  }
	"Set DwellUnitType:NumHtPumpEqpUnits - 5"		DwellUnitType:NumHtPumpEqpUnits		= {	if (NumHtPumpEquipTypes > 4 .AND. LocalCompAssigned( HVACHtPumpRef[5]  )) then  NumHtPumpEqpUnits + HtPumpEquipCount[5]   else  UNCHANGED  endif  }

	"Set DwellUnitType:HtPumpEqpType"				DwellUnitType:HtPumpEqpType			= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1] ))
																														then  HVACHtPumpRef[1]:Type  else  0  endif  }
	"Set DwellUnitType:HtPumpEqpTypeAbbrev"		DwellUnitType:HtPumpEqpTypeAbbrev	= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1] ))
																														then  HVACHtPumpRef[1]:TypeAbbrevStr
																														else  " "  endif  }

	"Blast HtPump* user input if HtPumpEqpType has changed"	DwellUnitType:Action	= {	if (LocalStatus( HtPumpEqpTypeSetup ) < 1 .OR. LocalStatus( PrevHtPumpEqpType ) < 1) then  UNCHANGED
																													else if (HtPumpEqpTypeSetup < 0.5) then  UNCHANGED
																													else if (HtPumpEqpType != PrevHtPumpEqpType)
																													then	EvalRulelist( "BlastDwellUnitTypeUserInput_HeatPump", 1 )
																													else	UNCHANGED  endif endif endif  }
	"Set DwellUnitType:PrevHtPumpEqpType"		DwellUnitType:PrevHtPumpEqpType		= {	HtPumpEqpType  }
	"Set DwellUnitType:HtPumpEqpTypeSetup"		DwellUnitType:HtPumpEqpTypeSetup		= {	if (HtPumpEqpType > 0) then  1  else  0  endif  }


	"Default DwellUnitType:NumCoolEquipTypes"		DwellUnitType:NumCoolEquipTypes	= {	1  }

  ; SAC 11/20/14 - rules to FORCE reset of array elements beyond those valid based on NumCoolEquipTypes
	"Force reset of DwellUnitType:CoolEquip*[1]"		DwellUnitType:Action		= {	if (NumCoolEquipTypes >= 1 .OR. (LocalStatus( CoolEquipCount[1] ) < 6 .AND. LocalStatus( HVACCoolRef[1] ) < 6)) then  UNCHANGED
																											else	EvalRulelist( "ForceReset_DwellUnitType_CoolEquip_1", 1 )  endif  }
	"Force reset of DwellUnitType:CoolEquip*[2]"		DwellUnitType:Action		= {	if (NumCoolEquipTypes >= 2 .OR. (LocalStatus( CoolEquipCount[2] ) < 6 .AND. LocalStatus( HVACCoolRef[2] ) < 6)) then  UNCHANGED
																											else	EvalRulelist( "ForceReset_DwellUnitType_CoolEquip_2", 1 )  endif  }
	"Force reset of DwellUnitType:CoolEquip*[3]"		DwellUnitType:Action		= {	if (NumCoolEquipTypes >= 3 .OR. (LocalStatus( CoolEquipCount[3] ) < 6 .AND. LocalStatus( HVACCoolRef[3] ) < 6)) then  UNCHANGED
																											else	EvalRulelist( "ForceReset_DwellUnitType_CoolEquip_3", 1 )  endif  }
	"Force reset of DwellUnitType:CoolEquip*[4]"		DwellUnitType:Action		= {	if (NumCoolEquipTypes >= 4 .OR. (LocalStatus( CoolEquipCount[4] ) < 6 .AND. LocalStatus( HVACCoolRef[4] ) < 6)) then  UNCHANGED
																											else	EvalRulelist( "ForceReset_DwellUnitType_CoolEquip_4", 1 )  endif  }
	"Force reset of DwellUnitType:CoolEquip*[5]"		DwellUnitType:Action		= {	if (NumCoolEquipTypes >= 5 .OR. (LocalStatus( CoolEquipCount[5] ) < 6 .AND. LocalStatus( HVACCoolRef[5] ) < 6)) then  UNCHANGED
																											else	EvalRulelist( "ForceReset_DwellUnitType_CoolEquip_5", 1 )  endif  }

	"Default DwellUnitType:CoolEquipCount[1]"		DwellUnitType:CoolEquipCount[1]	= {	if (NumCoolEquipTypes > 0) then  1  else  0  endif  }
	"Default DwellUnitType:CoolEquipCount[2]"		DwellUnitType:CoolEquipCount[2]	= {	if (NumCoolEquipTypes > 1) then  1  else  0  endif  }
	"Default DwellUnitType:CoolEquipCount[3]"		DwellUnitType:CoolEquipCount[3]	= {	if (NumCoolEquipTypes > 2) then  1  else  0  endif  }
	"Default DwellUnitType:CoolEquipCount[4]"		DwellUnitType:CoolEquipCount[4]	= {	if (NumCoolEquipTypes > 3) then  1  else  0  endif  }
	"Default DwellUnitType:CoolEquipCount[5]"		DwellUnitType:CoolEquipCount[5]	= {	if (NumCoolEquipTypes > 4) then  1  else  0  endif  }
	; "Default DwellUnitType:HVACCoolRef"

	"Set DwellUnitType:NumCoolEqpUnits - 1"	DwellUnitType:NumCoolEqpUnits	= {	if (NumCoolEquipTypes > 0 .AND. LocalCompAssigned( HVACCoolRef[1]  )) then                    CoolEquipCount[1]   else      0      endif  }
	"Set DwellUnitType:NumCoolEqpUnits - 2"	DwellUnitType:NumCoolEqpUnits	= {	if (NumCoolEquipTypes > 1 .AND. LocalCompAssigned( HVACCoolRef[2]  )) then  NumCoolEqpUnits + CoolEquipCount[2]   else  UNCHANGED  endif  }
	"Set DwellUnitType:NumCoolEqpUnits - 3"	DwellUnitType:NumCoolEqpUnits	= {	if (NumCoolEquipTypes > 2 .AND. LocalCompAssigned( HVACCoolRef[3]  )) then  NumCoolEqpUnits + CoolEquipCount[3]   else  UNCHANGED  endif  }
	"Set DwellUnitType:NumCoolEqpUnits - 4"	DwellUnitType:NumCoolEqpUnits	= {	if (NumCoolEquipTypes > 3 .AND. LocalCompAssigned( HVACCoolRef[4]  )) then  NumCoolEqpUnits + CoolEquipCount[4]   else  UNCHANGED  endif  }
	"Set DwellUnitType:NumCoolEqpUnits - 5"	DwellUnitType:NumCoolEqpUnits	= {	if (NumCoolEquipTypes > 4 .AND. LocalCompAssigned( HVACCoolRef[5]  )) then  NumCoolEqpUnits + CoolEquipCount[5]   else  UNCHANGED  endif  }

	"Set DwellUnitType:CoolEqpType"				DwellUnitType:CoolEqpType			= {	if (NumCoolEquipTypes > 0 .AND. LocalCompAssigned( HVACCoolRef[1] ))
																												then  HVACCoolRef[1]:Type  else  0  endif  }
	"Set DwellUnitType:CoolEqpTypeAbbrev"		DwellUnitType:CoolEqpTypeAbbrev	= {	if (NumCoolEquipTypes > 0 .AND. LocalCompAssigned( HVACCoolRef[1] ))
																												then  HVACCoolRef[1]:TypeAbbrevStr
																												else  " "  endif  }

	"Blast Cool* user input if CoolEqpType has changed"	DwellUnitType:Action	= {	if (LocalStatus( CoolEqpTypeSetup ) < 1 .OR. LocalStatus( PrevCoolEqpType ) < 1) then  UNCHANGED
																												else if (CoolEqpTypeSetup < 0.5) then  UNCHANGED
																												else if (CoolEqpType != PrevCoolEqpType)
																												then	EvalRulelist( "BlastDwellUnitTypeUserInput_Cooling", 1 )
																												else	UNCHANGED  endif endif endif  }
	"Set DwellUnitType:PrevCoolEqpType"		DwellUnitType:PrevCoolEqpType		= {	CoolEqpType  }
	"Set DwellUnitType:CoolEqpTypeSetup"	DwellUnitType:CoolEqpTypeSetup	= {	if (CoolEqpType > 0) then  1  else  0  endif  }

	; setup properties related to user toggle of cooling equipment simulation (in proposed model when No Cooling selected)
	"Default DwellUnitType:PreventCoolingSim"		DwellUnitType:PreventCoolingSim	= {	0  }		; toggle enabling user to toggle OFF cooling equipment simulation (in proposed model when No Cooling selected)
	"Set DwellUnitType:NoPropCoolingSim"			DwellUnitType:NoPropCoolingSim	= {	if (Proj:BypassRuleLimits > 0 .AND. PreventCoolingSim > 0 .AND.
																														 (HVACSysType == 1 .OR. HVACSysType == 3) .AND. CoolEqpType == 1)		; "NoCooling - No cooling equipment"
																													then  1  else  0  endif  }


  ; More DwellUnitType heating/cooling equipment summarization
	"Round2 of DwellUnitType Heat/Cool/HtPump property init"		DwellUnitType:Action	= {	if (HVACSysType == 1 .OR. HVACSysType == 3)
																														then  EvalRulelist( "SetupDwellUnitType_Round2_HeatCool", 1 )
																														else if (HVACSysType == 2)
																														then	EvalRulelist( "SetupDwellUnitType_Round2_HeatPump", 1 )
																														else	UNCHANGED  endif endif  }

   ; SAC 5/24/19 - added new flag indicating whether the DwellUnitType has mechanical cooling equip
   "Set DwellUnitType:HaveCooling"     DwellUnitType:HaveCooling  =
      {  if (HVACSysType == 1 .OR. HVACSysType == 3)
         then  if (NumCoolEquipTypes < 1 .OR. LocalCompAssigned( HVACCoolRef[1] ) < 1) then  0
               else if (HVACCoolRef[1]:Type < 2) then  0
               else  1  endif endif
         else  if (NumHtPumpEquipTypes < 1 .OR. LocalCompAssigned( HVACHtPumpRef[1] ) < 1) then  0
               else if (HVACHtPumpRef[1]:Type < 1) then  0
               else  1  endif endif
         endif  }

	"Set DwellUnitType:AddlEquipLabel"		DwellUnitType:AddlEquipLabel	= {	if (NumHeatEquipTypes > 1 .OR. NumHtPumpEquipTypes > 1 .OR. NumCoolEquipTypes > 1)
																										then	"All heating, cooling and heat pump equipment must be of the same 'Type'."
																										else	"Heating, cooling and heat pump equipment entered on main DwellUnitType tab."  endif  }


   ;--------------------------------------------------------------------
	; ClVentFan defaulting
   ;--------------------------------------------------------------------
   "Default ClVentFan:ExhaustsTo"      ClVentFan:ExhaustsTo =        ; SAC 4/23/19 (tic #1023)
      {  if (IfValidAnd( Proj:LimitedClVent = 1 )) then  2  else  1  endif  }

   "Default ClVentFan:DefaultSystem"			ClVentFan:DefaultSystem  = {  1  }
  ; SAC 1/28/13 - added check and rulelist call to ensure system defaults ARE in fact all defaulted if/when DefaultSystem selected
	"Ensure ClVentFan:DefaultSystem valid"		ClVentFan:Action	= {
						if (DefaultSystem > 0.5)
						then	if (	LocalStatus( WperCFMCool ) > 4  .OR.  LocalStatus( CoolingVent ) > 4 )
								then	EvalRulelist( "ForceDefaults_ClVentFan", 1 )
								else	UNCHANGED  endif
						else	UNCHANGED  endif  }

   ; SAC 8/27/13 - revised fan flow & power defaults for CFI scenario - from Bruce via e-mail: flow rate for these CFI systems is much lower that whole house fans - suggest 0.5 CFM/ft2
   ; SAC 9/4/13 - revised defaulting to enable user edits to HVACSys:CFIClVentFlow & CFIClVentPwr
   ; mjb 1/12/15 - use new T24RClimateZoneCodeBaseTable for code level lookups
   ; SAC 1/17/19 - added additional if statement to use table CFM/SF iff > 0 (requested by KN)
   "Default ClVentFan:CoolingVent"     ClVentFan:CoolingVent  =
      {  if (Proj:EnableClVent > 0.5 .AND. Proj:UnitClVentOption == 3 .AND.
             SumAll( HVACSys:CFIClVentFlow ) > 0.5 .AND. CountRefs( HVACSys:CFIClVentFan ) > 0.5)      ; SumRevRef( HVACSys:CFIClVentFan, HVACSys:CFIClVentFlow ) > 0.5)
         then  0.5 * SumRevRef( HVACSys:CFIClVentFan, HVACSys:FloorAreaServed[1] ) / CountRefs( HVACSys:CFIClVentFan )      ; SumRevRef( HVACSys:CFIClVentFan, HVACSys:CFIClVentFlow )
         else if (Global( Proj:ClimateZone ) < 0.5) then  UNDEFINED
         else if (T24RClimateZoneCodeBase:WHFcfmpersf( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0)
         then  T24RClimateZoneCodeBase:WHFcfmpersf( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) * 
               Proj:CondFloorArea
         else  Proj:CondFloorArea * 1.5
         endif endif endif  }
         ;              Local( FloorAreaServed )  endif  }
         ; SAC 4/21/13 - always use entire home area to default CoolingVent
   ; SAC 7/31/17 - replaced old default of 0.58 WperCFM value w/ table look-up for CFI cool vent (tic #882)
   ; SAC 2/12/18 - replaced 'hard-coded' 0.1 W/CFM default WHF power value w/ look-up table entry to accommodate 2019 update (tic #977)
   "Default ClVentFan:WperCFMCool"			ClVentFan:WperCFMCool    = {
      if (Proj:EnableClVent > 0.5 .AND. Proj:UnitClVentOption == 3 .AND.
          SumAll( HVACSys:CFIClVentFlow ) > 0.5 .AND. SumRevRef( HVACSys:CFIClVentFan, HVACSys:CFIClVentFlow ) > 0.5)
      then  T24RClimateZoneCodeBase:WperCFM(    "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
      else  T24RClimateZoneCodeBase:WHFWperCFM( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
      endif  }

   "Set ClVentFan:UIMessage[1]"     ClVentFan:UIMessage[1]  = {  Format( "Exhausts to %s", EnumString( ExhaustsTo ) )  }   ; SAC 4/23/19
   "Set ClVentFan:UIMessage[2]"     ClVentFan:UIMessage[2]  =
      {  if (ExhaustsTo = 1 .AND. IfValidAnd( Proj:LimitedClVent = 1 ))
         then  "Warning:  No attic present in model to exhaust to"
         else  UNDEFINED  endif  }

   "Re-default project-wide SFam ClVent in case ClVentFan properties have been updated"  Proj:Action =      ; SAC 1/20/19 (tic #1040)
      {  if (IsMultiFamily > 0.5 .OR. ClVentFanUI < 0.5) then  UNCHANGED
         else  EvalRulelist( "Default_SFam_CoolingVent" )  endif  }

; SAC 8/27/13 - secondary part of CFI (Central Fan Integrated) Cool Vent properties and defaulting - FOLLOWING ClVentFan defaulting
	"Set HVACSys:CFIClVentFlow"	HVACSys:CFIClVentFlow	= {	if (Proj:EnableClVent < 0.5 .OR. Proj:UnitClVentOption != 3) then  0
																					else if (Type == 3)
																					then	if (LocalCompAssigned( CFIClVentFan ) == 0)
																							then  0.5 * FloorAreaServed[1]
																							else  CFIClVentFan:CoolingVent  endif
																					else if (Type == 1 .OR. Type == 2)
																					then	if (CFIClVentOption < 1) then  0
																							else if (LocalCompAssigned( CFIClVentFan ) == 0)
																							then  0.5 * FloorAreaServed[1]
																							else  CFIClVentFan:CoolingVent  endif endif
																					else  0  endif endif endif  }
   ; SAC 7/31/17 - replaced old default of 0.58 WperCFM value w/ table look-up for CFI cool vent (tic #882)
	"Set HVACSys:CFIClVentPwr"		HVACSys:CFIClVentPwr		= {
      if (CFIClVentFlow < 1) then  0
      else if (LocalCompAssigned( CFIClVentFan ) == 0)
      then  T24RClimateZoneCodeBase:WperCFM( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
      else  CFIClVentFan:WperCFMCool  endif endif  }

; SAC 10/17/14 - added to accommodate multiple attics
	"Default HVACSys:CFIClVentAttic"	HVACSys:CFIClVentAttic		= 	{	if (Proj:EnableClVent < 0.5 .OR. LocalCompAssigned( MaxClVentableAttic ) < 0.5) then  UNDEFINED
																							else	MaxClVentableAttic  endif  }

; SAC 9/4/13 - revised to reflect NEW primary inputs of HVACSys:CFIClVentFlow & CFIClVentPwr  (as opposed to CFIClVentFan)
	"Set HVACSys:CFIClVentFanShow"	HVACSys:CFIClVentFanShow	= {	if (Type < 1 .OR. Type > 3) then  0
																							else if (Proj:EnableClVent > 0.5 .AND. Proj:UnitClVentOption == 3 .AND.
																											((Proj:EnableVarFlowOAV   .AND. Type == 3) .OR.
																											 (Proj:EnableFixedFlowOAV .AND. Type != 3 .AND. CFIClVentOption > 0))) then  1
																							else  0  endif endif  }
	"Set HVACSys:CFIClVentFanLbl"		HVACSys:CFIClVentFanLbl		= {	if (Type == 3) then  "Maximum Flow:"
																							else if (CFIClVentFanShow < 0.5) then  " "
																							else  "      Fixed Flow:"  endif endif  }
	"Set HVACSys:CFIClVentFanMsg"		HVACSys:CFIClVentFanMsg		= {	if (Type == 3 .OR. CFIClVentOption > 0)
																							then	if (Proj:EnableClVent < 0.5)
																									then  "(CFI cool vent available only for single family homes with ventilated attics)"
																									else if (Proj:UnitClVentOption != 3)
																									then  "(activate CFI cool vent via selection in Cool Vent tab of the Project data dialog)"
																									else  " "  endif endif
																					;				else if (LocalCompAssigned( CFIClVentFan ))
																					;				then	Format( "%s CFM, %.3f W/CFM (when operating in cool vent mode)", FltToStr( CFIClVentFan:CoolingVent ), CFIClVentFan:WperCFMCool )
																					;				else	"(maximum air flow and fan W when operating in cool vent mode)"
																					;				endif endif endif
																							else	" "  endif  }
; SAC 12/21/14 - address GC issue 435 by implementing a reporting property
	"Set HVACSys:CFIClVentOptionRpt"	HVACSys:CFIClVentOptionRpt	= {	if (Proj:EnableClVent > 0.5 .AND. Proj:UnitClVentOption == 3 .AND. IfValidAnd( FloorAreaServed[1] > 0 ) .AND.
																									IfValidAnd( CFIClVentFlow > 0 ) .AND. IfValidAnd( CFIClVentPwr > 0 ) .AND.
																									(Type == 3 .OR. CFIClVentOption > 0) )
																							then	if (Type == 3)
																									then	"Variable Flow"
																									else	"Fixed Flow"
																									endif
																							else	UNDEFINED
																							endif  }

	"Set HVACSys:IsVariableCFIClVent"	HVACSys:IsVariableCFIClVent = {If(Proj:EnableClVent > 0.5 .AND. Proj:UnitClVentOption == 3 .AND. IfValidAnd( FloorAreaServed[1] > 0 )
																	 .AND. Type=3 .AND. IfValidAnd( CFIClVentFlow > 0 ) .AND. IfValidAnd( CFIClVentPwr > 0 ) 
																	 .AND. LocalCompAssigned (HvacSys:CFIClVentAttic))
																	 then 1
																	 else 0
																	 endif}
																	 
	"Set HVACSys:IsFixedCFIClVent"		HVACSys:IsFixedCFIClVent = {If(Proj:EnableClVent > 0.5 .AND. Proj:UnitClVentOption == 3 .AND. IfValidAnd( FloorAreaServed[1] > 0 )
																	 .AND. Type!=3 .AND. CFIClVentOption > 0 .AND. IfValidAnd( CFIClVentFlow > 0 ) .AND. IfValidAnd( CFIClVentPwr > 0 ) 
																	 .AND. LocalCompAssigned (HvacSys:CFIClVentAttic))
																	 then 1
																	 else 0
																	 endif}

   ;--------------------------------------------------------------------
	; IAQFan defaulting
   ;--------------------------------------------------------------------
   ; moved primary IAQFan defaulting rules into Default_HVAC_IAQFan rulelist - SAC 7/21/20 (tic #1174)

; SAC 2/5/20 - moved IAQFan:NumAssignments up from below (in analysis prep rules) in order to take into account for backward compatibility (tic #1174)
	"Init all IAQFan:NumAssignments"							IAQFan:NumAssignments	= {	0  }
                        ; SAC 1/14/15 - updated rules for latest DwellUnitType structure and eliminate references to old (proj-based) MFam inputs
	"Incrament Proj:UnitIAQFan1[1]:NumAssignments"		Proj:UnitIAQFan1[1]:NumAssignments	= {	if (IsMultiFamily < 0.5 .AND. UnitIAQOption[1] == 2 .AND. IfValidAnd( UnitIAQFanCnt1[1] > 0.5 ) .AND. IAQDisabled < 0.5) then  UnitIAQFan1[1]:NumAssignments + 1  else  UNCHANGED  endif  }
	"Incrament Proj:UnitIAQFan2[1]:NumAssignments"		Proj:UnitIAQFan2[1]:NumAssignments	= {	if (IsMultiFamily < 0.5 .AND. UnitIAQOption[1] == 2 .AND. IfValidAnd( UnitIAQFanCnt2[1] > 0.5 ) .AND. IAQDisabled < 0.5) then  UnitIAQFan2[1]:NumAssignments + 1  else  UNCHANGED  endif  }
	"Incrament Proj:UnitIAQFan3[1]:NumAssignments"		Proj:UnitIAQFan3[1]:NumAssignments	= {	if (IsMultiFamily < 0.5 .AND. UnitIAQOption[1] == 2 .AND. IfValidAnd( UnitIAQFanCnt3[1] > 0.5 ) .AND. IAQDisabled < 0.5) then  UnitIAQFan3[1]:NumAssignments + 1  else  UNCHANGED  endif  }
	"Incrament Proj:UnitIAQFan4[1]:NumAssignments"		Proj:UnitIAQFan4[1]:NumAssignments	= {	if (IsMultiFamily < 0.5 .AND. UnitIAQOption[1] == 2 .AND. IfValidAnd( UnitIAQFanCnt4[1] > 0.5 ) .AND. IAQDisabled < 0.5) then  UnitIAQFan4[1]:NumAssignments + 1  else  UNCHANGED  endif  }

   ; ensure ADU IAQ fan assignments also tracked - SAC 06/01/21 (tic #1218)
	"Incra. ADU Proj:UnitIAQFan1[2]:NumAssignments"		Proj:UnitIAQFan1[2]:NumAssignments	= {	if (IsMultiFamily < 0.5 .AND. UnitIAQOption[2] == 2 .AND. IfValidAnd( UnitIAQFanCnt1[2] > 0.5 ) .AND. IfValidAnd( SFamADUIAQUI > 0 ) .AND. IAQDisabled < 0.5) then  UnitIAQFan1[2]:NumAssignments + 1  else  UNCHANGED  endif  }
	"Incra. ADU Proj:UnitIAQFan2[2]:NumAssignments"		Proj:UnitIAQFan2[2]:NumAssignments	= {	if (IsMultiFamily < 0.5 .AND. UnitIAQOption[2] == 2 .AND. IfValidAnd( UnitIAQFanCnt2[2] > 0.5 ) .AND. IfValidAnd( SFamADUIAQUI > 0 ) .AND. IAQDisabled < 0.5) then  UnitIAQFan2[2]:NumAssignments + 1  else  UNCHANGED  endif  }
	"Incra. ADU Proj:UnitIAQFan3[2]:NumAssignments"		Proj:UnitIAQFan3[2]:NumAssignments	= {	if (IsMultiFamily < 0.5 .AND. UnitIAQOption[2] == 2 .AND. IfValidAnd( UnitIAQFanCnt3[2] > 0.5 ) .AND. IfValidAnd( SFamADUIAQUI > 0 ) .AND. IAQDisabled < 0.5) then  UnitIAQFan3[2]:NumAssignments + 1  else  UNCHANGED  endif  }
	"Incra. ADU Proj:UnitIAQFan4[2]:NumAssignments"		Proj:UnitIAQFan4[2]:NumAssignments	= {	if (IsMultiFamily < 0.5 .AND. UnitIAQOption[2] == 2 .AND. IfValidAnd( UnitIAQFanCnt4[2] > 0.5 ) .AND. IfValidAnd( SFamADUIAQUI > 0 ) .AND. IAQDisabled < 0.5) then  UnitIAQFan4[2]:NumAssignments + 1  else  UNCHANGED  endif  }

	"Incrament DwellUnitType:IAQFanRef[1]:NumAssignments"		DwellUnitType:IAQFanRef[1]:NumAssignments	= {	if (Proj:IsMultiFamily > 0.5 .AND. IAQOption == 2 .AND. IfValidAnd( AssignedDUFlrArea = 0 )==0) then  IAQFanRef[1]:NumAssignments + 1  else  UNCHANGED  endif  }
	"Incrament DwellUnitType:IAQFanRef[2]:NumAssignments"		DwellUnitType:IAQFanRef[2]:NumAssignments	= {	if (Proj:IsMultiFamily > 0.5 .AND. IAQOption == 2 .AND. IfValidAnd( AssignedDUFlrArea = 0 )==0) then  IAQFanRef[2]:NumAssignments + 1  else  UNCHANGED  endif  }
	"Incrament DwellUnitType:IAQFanRef[3]:NumAssignments"		DwellUnitType:IAQFanRef[3]:NumAssignments	= {	if (Proj:IsMultiFamily > 0.5 .AND. IAQOption == 2 .AND. IfValidAnd( AssignedDUFlrArea = 0 )==0) then  IAQFanRef[3]:NumAssignments + 1  else  UNCHANGED  endif  }
	"Incrament DwellUnitType:IAQFanRef[4]:NumAssignments"		DwellUnitType:IAQFanRef[4]:NumAssignments	= {	if (Proj:IsMultiFamily > 0.5 .AND. IAQOption == 2 .AND. IfValidAnd( AssignedDUFlrArea = 0 )==0) then  IAQFanRef[4]:NumAssignments + 1  else  UNCHANGED  endif  }

   "Set IAQFan:WperCFMIAQRpt - iff this fan is referenced in analysis (for reporting as special feature)"   IAQFan:WperCFMIAQRpt  =   ; SAC 2/10/20 (tic #1174)
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. NumAssignments < 1 .OR. IfValidAnd( WperCFMIAQ > 0 )==0) then  UNDEFINED
         else  WperCFMIAQ  endif  }
   "Set IAQFan:HRV_SRE_Rpt - iff this fan is referenced in analysis (for reporting as special feature)"     IAQFan:HRV_SRE_Rpt   =   ; SAC 2/10/20 (tic #1174)
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. NumAssignments < 1 .OR. IAQFanType != 3 .OR.
             IncludesRecov < 1 .OR. IfValidAnd( SensRecovEff > 0 )==0) then  UNDEFINED
         else  SensRecovEff  endif  }
   "Set IAQFan:HRV_ASRE_Rpt - iff this fan is referenced in analysis (for reporting as special feature)"    IAQFan:HRV_ASRE_Rpt  =   ; SAC 2/10/20 (tic #1174)
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. NumAssignments < 1 .OR. IAQFanType != 3 .OR.
             IncludesRecov < 1 .OR. IfValidAnd( AdjSensRecovEff > 0 )==0) then  UNDEFINED
         else  AdjSensRecovEff  endif  }

   ; ----- IAQ fan heat recovery backward compatibility -----
   "hardwire IAQFan:IncludesRecov ON for older models w/ non-zero IAQRecovEffect"   IAQFan:Action  =     ; SAC 2/5/20 (tic #1174)
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 ) .AND. IAQFanType = 3 .AND. IAQRecovEffect > 0)
         then  EvalRulelist( "ForceOn_IAQFan_IncludesRecov", 1 )
         else  UNCHANGED  endif  }
   "force reset of IAQFan:IAQRecovEffect in 2019.2.0+ versions"   IAQFan:Action  =
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 ) .AND. LocalStatus( IAQRecovEffect ) > 4)
         then  EvalRulelist( "ForceReset_IAQFan_IAQRecovEffect", 1 )
         else  UNCHANGED  endif  }


   ;--------------------------------------------------------------------
	; RE-default some Fan-related data that might now be different than above
   ;--------------------------------------------------------------------
; SAC 12/12/13 - removed as it is no longer applicable.  Type can no longer be = 10 or 20 ('Cooling Vent' or 'IAQ Vent', respctively)
;	"Set HVACSys:FloorAreaServed[1]"		HVACSys:FloorAreaServed[1]	= {	switch ( type )
;																				; SAC 1/11/13 - revised default for whole house fan floor area served to be ALL CFA if fan data defaulted
;																				;			case 10 :	SumRevRef( Zone:CoolVentSystem, Zone:CondFloorArea )
;																			;				case 10 :	if (LocalCompAssigned( Fan ) == 0) then  SumRevRef( Zone:CoolVentSystem, Zone:CondFloorArea )
;																			;								else if (Fan:DefaultSystem  < 0.5) then  SumRevRef( Zone:CoolVentSystem, Zone:CondFloorArea )
;																			;								else	Proj:CondFloorArea  endif endif
;																			; SAC 4/21/13 - revised default for whole house fan floor area served to be ALL CFA if fan data defaulted
;																							case 10 :	Proj:CondFloorArea
;																							case 20 :	SumRevRef( Zone:IAQVentSystem , Zone:CondFloorArea )
;																							default :	SumRevRef( Zone:HVACSystem,		Zone:HVACNewCondFloorArea ) +
;																											SumRevRef( Zone:AltHVACSystem,	Zone:HVACAltCondFloorArea ) +
;																											SumRevRef( Zone:exHVACSystem,		Zone:HVACExCondFloorArea  )
;																						endswitch  }
;	"Set HVACSys:FloorAreaServed[2]"		HVACSys:FloorAreaServed[2]		= {	FloorAreaServed[1]  }
;	"Set HVACSys:FloorAreaServed[3]"		HVACSys:FloorAreaServed[3]		= {	FloorAreaServed[1]  }
;	"Set HVACSys:FloorAreaServed[4]"		HVACSys:FloorAreaServed[4]		= {	FloorAreaServed[1]  }
;	"Set HVACSys:FloorAreaServed[5]"		HVACSys:FloorAreaServed[5]		= {	FloorAreaServed[1]  }
;	"Set HVACSys:FloorAreaServed[6]"		HVACSys:FloorAreaServed[6]		= {	FloorAreaServed[1]  }
;	"Set HVACSys:FloorAreaServed[7]"		HVACSys:FloorAreaServed[7]		= {	FloorAreaServed[1]  }
;	"Set HVACSys:FloorAreaServed[8]"		HVACSys:FloorAreaServed[8]		= {	FloorAreaServed[1]  }
;	"Set HVACSys:FloorAreaServed[9]"		HVACSys:FloorAreaServed[9]		= {	FloorAreaServed[1]  }
;	"Set HVACSys:FloorAreaServed[10]"	HVACSys:FloorAreaServed[10]	= {	FloorAreaServed[1]  }

  ; SAC 1/15/13 - added new HVACSys:DfltWHFAreaServed to facilitate default WHF system assignment
	"Set HVACSys:DfltWHFAreaServed"	HVACSys:DfltWHFAreaServed = {	if (type == 10 .AND. LocalCompAssigned( Fan ) > 0.5)
																						then	if (Fan:DefaultSystem > 0.5) then  FloorAreaServed[1]
																								else  0  endif
																						else  0  endif  }


   ;--------------------------------------------------------------------
   ; ProposedInput: more Zone Rules (related to default assignment of whole house fan to appropriate zone)
   ;--------------------------------------------------------------------
; SAC 5/1/13 - moved up to be set prior to SFam ClVent defaulting rules
;	"Set Zone:ClgBlwAtticArea"			Zone:ClgBlwAtticArea		= {	SumChildren( CeilingBelowAttic:Area )  }
;	"Set Zone:CondClgBlwAtticArea"	Zone:CondClgBlwAtticArea ={	if (Type < 10) then  ClgBlwAtticArea  else  0  endif  }
;	"Set Zone:HasCondClgBlwAttic"		Zone:HasCondClgBlwAttic	= {	if (CondClgBlwAtticArea > 0.1) then  1  else  0  endif  }
	"Set Proj:DfltCoolVentZone"		Proj:DfltCoolVentZone	= {	if (ComponentCount( HVACSys ) < 1) then  UNDEFINED
																						else  MaxAllComp( Zone:CondClgBlwAtticArea )  endif  }

;	"Set Proj:DfltCoolVentSys"			Proj:DfltCoolVentSys		= {	if (ComponentCount( HVACSys ) < 1) then  UNDEFINED
;																						else  MaxAllComp( HVACSys:DfltWHFAreaServed )  endif  }

;	"Default assignment of Cool Vent system in conditioned Zone w/ maximal ClgBlwAtticArea"
;			Proj:DfltCoolVentZone:CoolVentSystem	= {	if (LocalCompAssigned( DfltCoolVentSys ) > 0.5) then	DfltCoolVentSys
;																		else  UNDEFINED  endif  }

;	"Default HVACSys:AirNet_CoolVentZone"		HVACSys:AirNet_CoolVentZone	= {	if (Type != 10) then  UNDEFINED
;																											else  MaxRevRefComp( Zone:CoolVentSystem, Zone:CondClgBlwAtticArea )  endif  }
;	"Default HVACSys:AirNet_CoolVentZone #2"	HVACSys:AirNet_CoolVentZone	= {	if (Type != 10 .OR. LocalCompAssigned( AirNet_CoolVentZone )) then  UNCHANGED
;																											else  MaxAllComp( Zone:CondClgBlwAtticArea )  endif  }


   ;--------------------------------------------------------------------
   ; ProposedInput: ACH50 defaulting
   ;--------------------------------------------------------------------
; SAC 9/4/13 - replaced above property & rules w/ following to fix ACH50 defaulting bug (GC issue 169)
	"Set HVACSys:VLLCDuctAreaSrvd"		HVACSys:VLLCDuctAreaSrvd	= {	if (Type < 1 .OR. Type > 3) then  0
																						;		else if (Type == 2 .AND. IfValidAnd( HtPumpSysType == 10 )) then  0		; SAC 11/3/14 - set to 0 for DuctlessHeatPump (GC issue 405)
																								else if (LocalCompAssigned( DistribSystem ) == 0)   ; no ducts
																								then  FloorAreaServed[1]
																								else if (DistribSystem:Type == 12 .OR.		; "Verified low-leakage ducts entirely in conditioned space"
																											DistribSystem:Type == 8 )			; "Distribution systems without ducts"
																								then	FloorAreaServed[1]
																								else  0  endif endif endif  }

; SAC 11/18/14 - secondary rules to zero OUT HVACSys:VLLCDuctAreaSrvd for generic, non-ducted or PropEqStd equipment
	"Reset HVACSys:VLLCDuctAreaSrvd - HtCl"	HVACSys:VLLCDuctAreaSrvd	= {
		if (VLLCDuctAreaSrvd < 0.1 .OR. ((IfValidAnd( HeatDucted > 0.5 ) .OR. IfValidAnd( CoolDucted > 0.5 )) .AND.
        (IfValidAnd( DistribSystem:Type == 12 ) .OR. IfValidAnd( DistribSystem:Type == 8 )))) 
    then  UNCHANGED
    else if (Type != 2)
    then ; Is not a heat pump
      if ( IfValidAnd( HeatSysType > 0.5 ) )
      then ; Has heating
        if ( T24RHeatingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HeatSysTypeAbbrev ) < 0.5 .OR. 
             T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HeatSysTypeAbbrev ) > 0.5 )
        then  0
        else UNCHANGED
        endif
      else if ( IfValidAnd( CoolSysType > 0.5 ) )
      then ; Has cooling
        if ( T24RCoolingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev ) < 0.5 .OR.
             T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev ) > 0.5 )
        then 0
    	  else UNCHANGED
    	  endif
    	else 0 ; Has no heating or cooling
    	endif endif
    else if ( IfValidAnd( HtPumpSysType > 0.5 ) )
    then ; Has a HeatPump
      if ( T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) > 0.5 .OR. 
           T24RHeatingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) < 0.5 )
      then  0
      else UNCHANGED
    	endif
    else 0
    endif endif endif }

	"Set HVACSys:UncondDuctAreaSrvd"		HVACSys:UncondDuctAreaSrvd	= {	if (VLLCDuctAreaSrvd > 0) then  0
																								else	FloorAreaServed[1]  endif  }


; SAC 9/9/13 - added rule to FORCE the defaulting of ACH50 (should it be defined in a model for which it should always be defaulted)
; SAC 4/15/15 - adjust for MFam duplex/townhomes options (based on Proj:IsMFamDupOrTownhm)
; revised to prevent re-default for ERM or BRL (research) - SAC 7/19/20 (MFamProto)
; removed logic preventing re-default for ERM or BRL (research) - SAC 03/05/21
; prevent reset for s, smf & dr runs - SAC 06/28/21 (tic #1274)
	"Force re-default of Proj:ACH50 (iff necessary)"		Proj:Action	=     ; added logic to prevent reset of ACH50 for 2022+ models where UseDefaultACH50 = 0 - SAC 07/06/21
      {  if ( LocalStatus( ACH50 ) > 5 .AND. Proj:IsMultiFamily .AND. Proj:IsMFamDupOrTownhm < 0.5 .AND.
              Proj:RunAbbrev != "dr" .AND. Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" .AND.
              (IfValidAnd( EnergyCodeYearNum	< 2022 ) .OR. IfValidAnd( UseDefaultACH50 = 0 )==0) )
         then  EvalRulelist( "ForceDefault_Proj_ACH50", 1 )
         else  UNCHANGED  endif  }

   "Default Proj:UseDefaultACH50"   Proj:UseDefaultACH50 =        ; SAC 06/27/21 (tic #1274)
      {  if (LocalStatus( UseDefaultACH50 ) < 1)
         then  if (LocalStatus( ACH50 ) > 5)
               then  0
               else  1  endif
         else  UNCHANGED  endif  }
   "Force re-default of Proj:ACH50 #2"    Proj:Action	=           ; SAC 06/27/21 (tic #1274)
      {  if ( LocalStatus( ACH50 ) > 5 .AND. IfValidAnd( UseDefaultACH50 > 0 ) .AND.
              Proj:RunAbbrev != "dr" .AND. Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" )
         then  EvalRulelist( "ForceDefault_Proj_ACH50", 1 )
         else  UNCHANGED  endif  }

; SAC 1/7/13 - moved ACH50 defaulting down here, BELOW system duct rules, so that presence of ducts in unconditioned space is known
; SAC 9/4/13 - revised logic to fix ACH50 defaulting bug (GC issue 169)
; mjb 1/30/15 - mods to lookup std ACH50 from T24RClimateZoneCodeBase
;	"Default Proj:ACH50 - per ACM section 2.2.2.1"		Proj:ACH50	= {	if (SumAll( HVACSys:VLLCDuctAreaSrvd ) > 1 .AND. SumAll( HVACSys:UncondDuctAreaSrvd ) < 1)
;																								then  if (Proj:IsMultiFamily > 0.5) then	6.2  else  4.4  endif
;																								else  if (Proj:IsMultiFamily > 0.5) then	7.0  else  5.0  endif endif  }
; SAC 4/15/15 - adjust for MFam duplex/townhomes options (based on Proj:IsMFamDupOrTownhm)
; SAC 5/3/16 - revisions to first set DefaultACH50 based on model details, then set analysis ACH50 based on the default (DefaultACH50) (tic #627)
	"Set Proj:DefaultACH50 - per ACM section 2.2.2.1"		Proj:DefaultACH50	= {
													if (SumAll( HVACSys:VLLCDuctAreaSrvd ) > 1 .AND. SumAll( HVACSys:UncondDuctAreaSrvd ) < 1)
													then  if (Proj:IsMultiFamily > 0.5 .AND. Proj:IsMFamDupOrTownhm < 0.5)
															then	(T24RClimateZoneCodeBase:ACH50( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) - 0.8)
															else  (T24RClimateZoneCodeBase:ACH50( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) - 0.6)  endif
													else  T24RClimateZoneCodeBase:ACH50( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
													endif  }
   "Default ExEDR Proj:DefaultACH50"      Proj:Action  = {
         if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( DefaultACH50 ) < 6)
         then  EvalRulelist( "ExEDRDefault_Proj_DefaultACH50", 1 )
         else  UNCHANGED  endif  }     ; SAC 5/24/17
	"Default Proj:ACH50 (based on DefaultACH50)"		Proj:ACH50	= {	DefaultACH50  }

	"Default Proj:CFM50"				Proj:CFM50			=	{	Proj:ACH50 * Proj:CondVolume / 60	}

; SAC 5/13/13 - moved down here from above (to access defaulted HVACHeat:ConstHtgSetpt)
   ;--------------------------------------------------------------------
   ; ProposedInput: Thermostat Setpoint Rules
   ;--------------------------------------------------------------------
	"Default Proj:SZHeat_DefaultTDaySch based on library entry (if not already defined)"
			Proj:SZHeat_DefaultTDaySch		= {	if (LocalStatus( SZHeat_DefaultTDaySch ) > 0) then  UNCHANGED
															else  RuleLibrary( SchDay, "CARes2013 SZ Heat Hrly" )  endif  }
	"Default Proj:LivHeat_DefaultTDaySch based on library entry (if not already defined)"
			Proj:LivHeat_DefaultTDaySch	= {	if (LocalStatus( LivHeat_DefaultTDaySch ) > 0) then  UNCHANGED
															else  RuleLibrary( SchDay, "CARes2013 Liv Heat Hrly" )  endif  }
	"Default Proj:SlpHeat_DefaultTDaySch based on library entry (if not already defined)"
			Proj:SlpHeat_DefaultTDaySch	= {	if (LocalStatus( SlpHeat_DefaultTDaySch ) > 0) then  UNCHANGED
															else  RuleLibrary( SchDay, "CARes2013 Slp Heat Hrly" )  endif  }
	"Default Proj:SZCool_DefaultTDaySch based on library entry (if not already defined)"
			Proj:SZCool_DefaultTDaySch		= {	if (LocalStatus( SZCool_DefaultTDaySch ) > 0) then  UNCHANGED
															else  RuleLibrary( SchDay, "CARes2013 SZ Cool Hrly" )  endif  }
	"Default Proj:LivCool_DefaultTDaySch based on library entry (if not already defined)"
			Proj:LivCool_DefaultTDaySch	= {	if (LocalStatus( LivCool_DefaultTDaySch ) > 0) then  UNCHANGED
															else  RuleLibrary( SchDay, "CARes2013 Liv Cool Hrly" )  endif  }
	"Default Proj:SlpCool_DefaultTDaySch based on library entry (if not already defined)"
			Proj:SlpCool_DefaultTDaySch	= {	if (LocalStatus( SlpCool_DefaultTDaySch ) > 0) then  UNCHANGED
															else  RuleLibrary( SchDay, "CARes2013 Slp Cool Hrly" )  endif  }
; the following rules will need to be expanded beyond SZ schedules... mjb RESNET 030816
	"Reset Proj:SZCool_DefaultTDaySch for Design Rating model"
			Proj:SZCool_DefaultTDaySch		= {	if (Proj:DRtgRefRunID == 2014) then RuleLibrary( SchDay, "RESNET SZ Cool Hrly" )
															else  UNCHANGED   endif  }
	"Reset Proj:SZHeat_DefaultTDaySch for Design Rating model"
			Proj:SZHeat_DefaultTDaySch		= {	if (Proj:DRtgRefRunID == 2014) then  RuleLibrary( SchDay, "RESNET SZ Heat Hrly" )
															else  UNCHANGED   endif  }

  ; SAC 5/13/13 - enable constant heating t-stat schedules
; SAC 8/23/13 - moved ConstHtgSetpt from HVACHeat as part of HVAHeat array mods
	"Set constant heating t-stat temperature if defined for assigned heating system"
				Zone:ConstHtgSetpt	= {	if (LocalCompAssigned( ActiveHVACSystem ) > 0)
													then	ActiveHVACSystem:ConstHtgSetpt
													else  -1  endif  }
;													then	if (LocalCompAssigned( ActiveHVACSystem:HeatSystem ) > 0)
;															then	if (LocalStatus( ActiveHVACSystem:HeatSystem:ConstHtgSetpt ) > 0)
;																	then	ActiveHVACSystem:HeatSystem:ConstHtgSetpt
;																	else  -1  endif
;															else  -1  endif
;													else  -1  endif  }
	"Set constant heating t-stat temperature if defined for assigned heating system"
				OtherZone:ConstHtgSetpt	= {	if (LocalCompAssigned( ActiveHVACSystem ) > 0)
													then	ActiveHVACSystem:ConstHtgSetpt
													else  -1  endif  }

  ; SAC 8/2/13 - added to enable compliance reporting
	"Thermostat type (used for compliance reporting)"
		Zone:ThermostatTypeRpt	= {	if (ConstHtgSetpt > 0)
												then  "Not Setback"
												else  "Setback"      endif  }

	"Default heating thermostat setpoint profile (Zone:HeatTDaySched)"
				Zone:HeatTDaySched	= {	if (ConstHtgSetpt > 0) then  UNDEFINED
													else  switch (Local( Type ))
											case 1:	;	conditioned/single zone
													if (GlobalStatus( Proj:SZHeat_DefaultTDaySch ) > 0) then  Global( Proj:SZHeat_DefaultTDaySch )
													else  UNCHANGED  endif
											case 2:	;	living
													if (GlobalStatus( Proj:LivHeat_DefaultTDaySch ) > 0) then  Global( Proj:LivHeat_DefaultTDaySch )
													else  UNCHANGED  endif
											case 3:	;	sleeping
													if (GlobalStatus( Proj:SlpHeat_DefaultTDaySch ) > 0) then  Global( Proj:SlpHeat_DefaultTDaySch )
													else  UNCHANGED  endif
											default: ; unconditioned
													UNCHANGED
										endswitch  endif	}

	"Default cooling thermostat setpoint profile (Zone:CoolTDaySched)"
				Zone:CoolTDaySched	= {	switch (Local( Type ))
											case 1:	;	conditioned/single zone
													if (GlobalStatus( Proj:SZCool_DefaultTDaySch ) > 0) then  Global( Proj:SZCool_DefaultTDaySch )
													else  UNCHANGED  endif
											case 2:	;	living
													if (GlobalStatus( Proj:LivCool_DefaultTDaySch ) > 0) then  Global( Proj:LivCool_DefaultTDaySch )
													else  UNCHANGED  endif
											case 3:	;	sleeping
													if (GlobalStatus( Proj:SlpCool_DefaultTDaySch ) > 0) then  Global( Proj:SlpCool_DefaultTDaySch )
													else  UNCHANGED  endif
											default: ; unconditioned
													UNCHANGED
										endswitch	}

	"Thermostat type (used for compliance reporting)"       ; SAC 9/20/19 - OtherZone (MFamProto)
		OtherZone:ThermostatTypeRpt	= {	if (ConstHtgSetpt > 0)
												then  "Not Setback"
												else  "Setback"      endif  }
	"Default heating thermostat setpoint profile (OtherZone:HeatTDaySched)"
				OtherZone:HeatTDaySched	= {	if (ConstHtgSetpt > 0) then  UNDEFINED
													else  switch (Local( Type ))
											case 1:	;	conditioned/single zone
													if (GlobalStatus( Proj:SZHeat_DefaultTDaySch ) > 0) then  Global( Proj:SZHeat_DefaultTDaySch )
													else  UNCHANGED  endif
											default: ; unconditioned
													UNCHANGED
										endswitch  endif	}
	"Default cooling thermostat setpoint profile (OtherZone:CoolTDaySched)"
				OtherZone:CoolTDaySched	= {	switch (Local( Type ))
											case 1:	;	conditioned/single zone
													if (GlobalStatus( Proj:SZCool_DefaultTDaySch ) > 0) then  Global( Proj:SZCool_DefaultTDaySch )
													else  UNCHANGED  endif
											default: ; unconditioned
													UNCHANGED
										endswitch	}

; change setpoint schedules for design rating   mjb  RESNET 02/12/16
	"Reset Zone:CoolTDaySched for Design Rating model"
			Zone:CoolTDaySched	= {	if (Proj:DRtgRefRunID == 2014) then  RuleLibrary( SchDay, "RESNET SZ Cool Hrly" )
															else  UNCHANGED   endif  }
	"Reset Zone:HeatTDaySched for Design Rating model"
			Zone:HeatTDaySched	= {	if (Proj:DRtgRefRunID == 2014) then  RuleLibrary( SchDay, "RESNET SZ Heat Hrly" )
															else  UNCHANGED   endif  }
	"Reset OtherZone:CoolTDaySched for Design Rating model"       ; SAC 9/20/19 - OtherZone (MFamProto)
			OtherZone:CoolTDaySched	= {	if (Proj:DRtgRefRunID == 2014) then  RuleLibrary( SchDay, "RESNET SZ Cool Hrly" )
															else  UNCHANGED   endif  }
	"Reset OtherZone:HeatTDaySched for Design Rating model"       ; SAC 9/20/19 - OtherZone (MFamProto)
			OtherZone:HeatTDaySched	= {	if (Proj:DRtgRefRunID == 2014) then  RuleLibrary( SchDay, "RESNET SZ Heat Hrly" )
															else  UNCHANGED   endif  }

	"Default Proj:DefaultWinterVentTemp"     Proj:DefaultWinterVentTemp	= {	77  }
	"Default Proj:DefaultWinterCoolTemp"     Proj:DefaultWinterCoolTemp	= {	78  }
	"Default Proj:DefaultSummerVentTemp"     Proj:DefaultSummerVentTemp	= {	68  }
	"Default Proj:DefaultSummerHeatTemp"     Proj:DefaultSummerHeatTemp	= {	60  }

	"Set Zone:WinterVentTemp"				Zone:WinterVentTemp			= {	Global(Proj:DefaultWinterVentTemp)  }
	"Set Zone:WinterCoolTemp"				Zone:WinterCoolTemp			= {	Global(Proj:DefaultWinterCoolTemp)  }
	"Set Zone:SummerVentTemp"				Zone:SummerVentTemp			= {	Global(Proj:DefaultSummerVentTemp)  }
	"Set Zone:SummerHeatTemp"				Zone:SummerHeatTemp			= {	Global(Proj:DefaultSummerHeatTemp)  }

	"Set OtherZone:WinterVentTemp"		OtherZone:WinterVentTemp	= {	Global(Proj:DefaultWinterVentTemp)  }       ; SAC 9/20/19 - OtherZone (MFamProto)
	"Set OtherZone:WinterCoolTemp"		OtherZone:WinterCoolTemp	= {	Global(Proj:DefaultWinterCoolTemp)  }
	"Set OtherZone:SummerVentTemp"		OtherZone:SummerVentTemp	= {	Global(Proj:DefaultSummerVentTemp)  }
	"Set OtherZone:SummerHeatTemp"		OtherZone:SummerHeatTemp	= {	Global(Proj:DefaultSummerHeatTemp)  }

	; new CSE thermostat setpoint include file mechanism - SAC 7/2/15
	; Zone:TstatIncludeFile    Prescribed    BEMP_Str   "CSE Include file to be used in place of individual thermostat setpoints" 
	"Set Zone:UseTstatIncFile - flag indicating CSE Include file to be used in place of thermostat setpoints/expressions" 
			Zone:UseTstatIncFile		= {	if (Proj:BypassRuleLimits > 0.5 .AND. LocalStatus( TstatIncludeFile ) > 0)
													then	if (strlen( TstatIncludeFile ) > 0)
															then  1
															else  0  endif
													else  0  endif  }
	"Set OtherZone:UseTstatIncFile - flag indicating CSE Include file to be used in place of thermostat setpoints/expressions" 
			OtherZone:UseTstatIncFile	= {	if (Proj:BypassRuleLimits > 0.5 .AND. LocalStatus( TstatIncludeFile ) > 0)
														then	if (strlen( TstatIncludeFile ) > 0)
																then  1
																else  0  endif
														else  0  endif  }

   ;--------------------------------------------------------------------  ; SAC 03/24/22 (VCHP2)
   ; ProposedInput: UMLH Rules (unmet load hours)
   ;--------------------------------------------------------------------
   "Set Zone:TrackUMLHs - Conditioned only"     Zone:TrackUMLHs =       ; revise tracking to include ALL conditioned zones - SAC 03/25/22
      {  if (IfValidAnd( ActiveHVACSystem:Type > 0 ) .AND.
             IfValidAnd( Zone:Type < 10 ))
         then  1  else  0  endif  }
   ;   {  if (IfValidAnd( ActiveHVACSystem:Type = 2 ) .AND.
   ;          IfValidAnd( ActiveHVACSystem:HtPumpSysType = 33 ))
   "Set Zone:ClgUMLHLimit"       Zone:ClgUMLHLimit = {  if (TrackUMLHs > 0) then  150.1  else  UNDEFINED  endif  }   ; using same 0.1 factor as used in check done on NRes models - SAC 03/25/22
   "Set Zone:HtgUMLHLimit"       Zone:HtgUMLHLimit = {  if (TrackUMLHs > 0) then  150.1  else  UNDEFINED  endif  }

END
;*************************************************************************


;************************************************************************* SAC 7/21/20 (tic #1174)
RULELIST "Default_HVAC_IAQFan" 0 0 0 0
;*************************************************************************
; moved primary IAQFan defaulting rules from inside Default_AllHVAC into this rulelist to fix evaluation order issue - SAC 7/21/20 (tic #1174)

;   "Set IAQFan:MinIAQCFM"				IAQFan:MinIAQCFM      = {  (0.01 * Local( FloorAreaServed )) + (7.5 * (Max(Global( Proj:NumBedrooms ),1) + 1))  }							    ; added Max function in case NumBedrooms < 1 ...MJB 4/22/13
   "Default IAQFan:IAQCFM"				IAQFan:IAQCFM         = {  UNDEFINED  }		; Local( MinIAQCFM )  }
   ; removed IAQFan:WperCFMIAQ default for 2019.2.0+ versions - SAC 7/20/20 (tic #1174)
   "Default IAQFan:WperCFMIAQ"		IAQFan:WperCFMIAQ     =       ; SAC 2/12/20 - installed new std design IAQFan:WperCFMIAQ of 0.3 & 0.6 for SFam/MFam as new defaults (tic #1174)
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 ))
		   then  UNDEFINED
		   else  0.25     ; Stand Alone IAQ Fan (prior to 2019.2.0)
		   endif  }
   "Default IAQFan:IAQFanType"		IAQFan:IAQFanType     = {  1  }    ; "Exhaust"
   "Default IAQFan:IAQRecovEffect"	IAQFan:IAQRecovEffect = {  0  }    ; No Heat Recovery ...MJB 4/22/13	

   "Prevent SensRecovEff & AdjSensRecovEff user inputs if not ResearchMode (for versions before 2019.2.0)"  IAQFan:Action =         ; SAC 10/21/19
      {  if (IfValidAnd( Proj:EnableResearchMode > 0 ) .OR. IfValidAnd( Proj:AnalysisVersion >= 190200 )) then  UNCHANGED
         else if (LocalStatus( SensRecovEff ) > 4 .OR. LocalStatus( AdjSensRecovEff ) > 4)
         then  EvalRulelist( "ForceReset_IAQFan_SensRecovEff", 1 )
         else  UNCHANGED  endif endif  }

   "default IAQFan:IncludesRecov to 0"    IAQFan:IncludesRecov  = {  0  }     ; SAC 2/5/20 (tic #1174)
   ; no defaults for new HRV/ERV inputs:
   ;     IAQFan:SensRecovEff
   ;     IAQFan:AdjSensRecovEff

   "default IAQFan:SetPerfByHVIInterp to 0"    IAQFan:SetPerfByHVIInterp  = {  0  }     ; SAC 2/7/20 (tic #1174)

   "Set SensRecovEff & AdjSensRecovEff based on HVI listing interpolation"    IAQFan:Action  =
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IncludesRecov == 0 .OR.
             SetPerfByHVIInterp == 0) then  UNCHANGED
         else if (IfValidAnd( HVIListedInterpCFM[1] > 0 ) .AND. IfValidAnd( HVIListedInterpSRE[1] > 0 ) .AND. IfValidAnd( HVIListedInterpASRE[1] > 0 ) .AND.
                  IfValidAnd( HVIListedInterpCFM[2] > 0 ) .AND. IfValidAnd( HVIListedInterpSRE[2] > 0 ) .AND. IfValidAnd( HVIListedInterpASRE[2] > 0 ) .AND.
                  IfValidAnd( HVIListedInterpCFM[1] <= IAQCFM ) .AND. IfValidAnd( HVIListedInterpCFM[2] >= IAQCFM ) .AND.
                  IfValidAnd( HVIListedInterpCFM[2] > HVIListedInterpCFM[1] ))
         then  EvalRulelist( "Interpolate_IAQFan_SRE_ASRE", 1 )
         else  EvalRulelist( "ForceReset_IAQFan_SensRecovEff", 1 )  endif endif  }

   "Default IAQFan:HERSVerified - whether IAQ fan is HERS verified"     IAQFan:HERSVerified =      ; SAC 7/20/20 (tic #1174)
      {  0  }     ; eventually this may become a user input
   ; revised to restrict IAQ HERS multipliers to Proposed model(s) - SAC 7/21/20 (tic #1174)
   ; removed limit to MFam fans, added separate mults by y/n HtRecov and revised multipliers - SAC 01/20/21 (tic #1243)
   ; added logic to retain settings for 's' & 'smf' runs when NOT Proj:IAQSupInletsAccessible - SAC 01/26/21 (tic #1243)
   ; modified logic to keep std design Exhaust power mult @ 1 when IAQSupInletsAccessible < 1 - SAC 03/18/21 (tic #1243)
   ; changed logic on 115% derating from exclusively IncludesRecov to include all supply & balanced fans - SAC 03/18/21 (tic #1243)
   ; added logic to prevent reset of FanPowerMult when HardwireStdFanPower flag set - SAC 03/18/21 (tic #1243)
   ; revised adjustment to NOT degrade when FID present - SAC 08/22/21 (tic #1243)
   "Set IAQFan:FanPowerMult"        IAQFan:FanPowerMult =         ; postponed HERS derating until 2023 (placeholder) - SAC 08/23/21 (tic #1243)
      {  if (IfValidAnd( HardwireStdFanPower > 0 )) then  1
         else if ( IfValidAnd( Proj:AnalysisVersion >= 190200 ) .AND. Proj:RunAbbrev != "dr" .AND.
                   ( (Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf") .OR.
                     (Proj:IAQSupInletsAccessible < 1 .AND. IAQFanType > 1) ) )
         then  if (IAQFanType > 1 .AND. IfValidAnd( Proj:IAQHasFID > 0 )==0)  ; not Exhaust & not FID
               then  if (HERSVerified == 0 .AND. IfValidAnd( Proj:AnalysisVersion >= 230000 ))
                     then  1.15
                     else  1.10  endif
               else  if (HERSVerified == 0 .AND. IfValidAnd( Proj:AnalysisVersion >= 230000 ))
                     then  1.05
                     else  1     endif endif
         else  1  endif endif  }
   ; removed limit to MFam fans, added separate mults by y/n HtRecov and revised multipliers - SAC 01/20/21 (tic #1243)
   ; added logic to retain settings for 's' & 'smf' runs when NOT Proj:IAQSupInletsAccessible - SAC 01/26/21 (tic #1243)
   ; revised adjustment to NOT degrade when FID present - SAC 08/22/21 (tic #1243)
   "Set IAQFan:FanHeatRecovMult"    IAQFan:FanHeatRecovMult =     ; postponed HERS derating until 2023 (placeholder) - SAC 08/23/21 (tic #1243)
      {  if ( IfValidAnd( Proj:AnalysisVersion >= 190200 ) .AND. IfValidAnd( IncludesRecov > 0 ) .AND. Proj:RunAbbrev != "dr" .AND.
              ((Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf") .OR. Proj:IAQSupInletsAccessible < 1) )
         then  if (IfValidAnd( Proj:IAQHasFID > 0 ))
               then  if (HERSVerified == 0 .AND. IfValidAnd( Proj:AnalysisVersion >= 230000 ))
                     then  0.95
                     else  1     endif
               else  if (HERSVerified == 0 .AND. IfValidAnd( Proj:AnalysisVersion >= 230000 ))
                     then  0.85
                     else  0.9   endif
               endif
         else  1  endif  }

   ; SAC 2/7/20 (tic #1174)      ; added check for WperCFMIAQ > 0 - SAC 7/21/20 (tic #1174)
   "Set IAQFan:IAQErrID"      IAQFan:IAQErrID  =            ; prevent HVI look-up error checks when IAQFanType != 3 - SAC 7/24/20 (tic #1174)
      {  if (IfValidAnd( IAQCFM > 0 )==0) then  1
         else if (IfValidAnd( WperCFMIAQ > 0 )==0) then  5
         else if (IfValidAnd( Proj:AnalysisVersion >= 190200 ) .AND.
                  IAQFanType == 3 .AND. IncludesRecov)
         then  if (SetPerfByHVIInterp .AND.
                   (IfValidAnd( HVIListedInterpCFM[1] > 0 )==0 .OR. IfValidAnd( HVIListedInterpSRE[1] > 0 )==0 .OR. IfValidAnd( HVIListedInterpASRE[1] > 0 )==0 .OR.
                    IfValidAnd( HVIListedInterpCFM[2] > 0 )==0 .OR. IfValidAnd( HVIListedInterpSRE[2] > 0 )==0 .OR. IfValidAnd( HVIListedInterpASRE[2] > 0 )==0))
               then  2
               else if (SetPerfByHVIInterp .AND.
                        (IfValidAnd( HVIListedInterpCFM[1] <= IAQCFM )==0 .OR. IfValidAnd( HVIListedInterpCFM[2] >= IAQCFM )==0 .OR.
                         IfValidAnd( HVIListedInterpCFM[2] > HVIListedInterpCFM[1] )==0))
               then  3
               else if (SetPerfByHVIInterp == 0 .AND. 
                        (IfValidAnd( SensRecovEff > 0 )==0 .OR. IfValidAnd( AdjSensRecovEff > 0 )==0))
               then  4
               else  0  endif endif endif
         else  0  endif endif endif  }
   "Set IAQFan:IAQErrMsg"     IAQFan:IAQErrMsg  =
      {  switch (IAQErrID)
            case  1 :  "Fan CFM must be specified."
            case  2 :  Format( "CFM, SRE and ASRE for HVI-listed fans that bound design %s CFM required below.", FltToStr( IAQCFM, 11 ) )
            case  3 :  Format( "HVI-listed fan CFMs invalid:  low %s <= design %s <= high %s required below.", FltToStr( HVIListedInterpCFM[1], 11 ), FltToStr( IAQCFM, 11 ), FltToStr( HVIListedInterpCFM[2], 11 ) )
            case  4 :  "Fan SRE and ASRE are required inputs when modeling heat recovery."
            case  5 :  "Fan Power (W/CFM) must be specified."
            default :  UNDEFINED
         endswitch  }

   "Set IAQFan:IAQFanTypeStr"    IAQFan:IAQFanTypeStr  = {  EnumString( IAQFanType )  }     ; SAC 8/13/13
   "Set IAQFan:TreeDescrip"      IAQFan:TreeDescrip    =
      {  switch (IAQErrID)
            case  1 :   IAQFanTypeStr + ", missing fan CFM"
            case  2 :   IAQFanTypeStr + ", missing HVI-listed fan interpolation data"
            case  3 :   IAQFanTypeStr + ", invalid HVI-listed fan interpolation data"
            case  4 :   IAQFanTypeStr + ", missing SRE and/or ASRE inputs"
            case  5 :   IAQFanTypeStr + ", missing fan power"
            default :   if (IfValidAnd( Proj:AnalysisVersion >= 190200 ))
                        then  if (IAQFanType == 3 .AND. IncludesRecov)
                              then  Format( "%s, %g CFM, HRV SRE %g%%, ASRE %g%", IAQFanTypeStr, IAQCFM, SensRecovEff, AdjSensRecovEff )
                              else  Format( "%s, %g CFM", IAQFanTypeStr, IAQCFM )  endif
                        else  if (IAQFanType == 3 .AND. IAQRecovEffect > 0)
                              then  Format( "%s, %g CFM, HRV RecovEff %g%", IAQFanTypeStr, IAQCFM, IAQRecovEffect )
                              else  Format( "%s, %g CFM", IAQFanTypeStr, IAQCFM )  endif endif
         endswitch  }
END
;*************************************************************************


; SAC 8/24/13 - setup initial set of HVACHeat/Cool/HtPump assignment properties
;*************************************************************************
RULELIST "SetupHVACSys_Round1_HeatCool" 0 0 0 0
;*************************************************************************
  ; SAC 11/20/14 - rules to FORCE reset of array elements beyond those valid based on NumHeatSystemTypes
	"Force reset of HVACSys:HeatSystem*[1]"		HVACSys:Action		= {	if (IfValidAnd( NumHeatSystemTypes >= 1 ) .OR. (LocalStatus( HeatSystemCount[1] ) < 6 .AND. LocalStatus( HeatSystem[1] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HeatSystem_1", 1 )  endif  }
	"Force reset of HVACSys:HeatSystem*[2]"		HVACSys:Action		= {	if (IfValidAnd( NumHeatSystemTypes >= 2 ) .OR. (LocalStatus( HeatSystemCount[2] ) < 6 .AND. LocalStatus( HeatSystem[2] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HeatSystem_2", 1 )  endif  }
	"Force reset of HVACSys:HeatSystem*[3]"		HVACSys:Action		= {	if (IfValidAnd( NumHeatSystemTypes >= 3 ) .OR. (LocalStatus( HeatSystemCount[3] ) < 6 .AND. LocalStatus( HeatSystem[3] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HeatSystem_3", 1 )  endif  }
	"Force reset of HVACSys:HeatSystem*[4]"		HVACSys:Action		= {	if (IfValidAnd( NumHeatSystemTypes >= 4 ) .OR. (LocalStatus( HeatSystemCount[4] ) < 6 .AND. LocalStatus( HeatSystem[4] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HeatSystem_4", 1 )  endif  }
	"Force reset of HVACSys:HeatSystem*[5]"		HVACSys:Action		= {	if (IfValidAnd( NumHeatSystemTypes >= 5 ) .OR. (LocalStatus( HeatSystemCount[5] ) < 6 .AND. LocalStatus( HeatSystem[5] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HeatSystem_5", 1 )  endif  }
	"Force reset of HVACSys:HeatSystem*[6]"		HVACSys:Action		= {	if (IfValidAnd( NumHeatSystemTypes >= 6 ) .OR. (LocalStatus( HeatSystemCount[6] ) < 6 .AND. LocalStatus( HeatSystem[6] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HeatSystem_6", 1 )  endif  }
	"Force reset of HVACSys:HeatSystem*[7]"		HVACSys:Action		= {	if (IfValidAnd( NumHeatSystemTypes >= 7 ) .OR. (LocalStatus( HeatSystemCount[7] ) < 6 .AND. LocalStatus( HeatSystem[7] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HeatSystem_7", 1 )  endif  }
	"Force reset of HVACSys:HeatSystem*[8]"		HVACSys:Action		= {	if (IfValidAnd( NumHeatSystemTypes >= 8 ) .OR. (LocalStatus( HeatSystemCount[8] ) < 6 .AND. LocalStatus( HeatSystem[8] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HeatSystem_8", 1 )  endif  }
	"Force reset of HVACSys:HeatSystem*[9]"		HVACSys:Action		= {	if (IfValidAnd( NumHeatSystemTypes >= 9 ) .OR. (LocalStatus( HeatSystemCount[9] ) < 6 .AND. LocalStatus( HeatSystem[9] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HeatSystem_9", 1 )  endif  }
	"Force reset of HVACSys:HeatSystem*[10]"		HVACSys:Action		= {	if (IfValidAnd( NumHeatSystemTypes >= 10 ) .OR. (LocalStatus( HeatSystemCount[10] ) < 6 .AND. LocalStatus( HeatSystem[10] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HeatSystem_10", 1 )  endif  }

	"Default HVACSys:HeatSystemCount[1]"	HVACSys:HeatSystemCount[1]		= {	if (NumHeatSystemTypes > 0) then  1  else  0  endif  }
	"Default HVACSys:HeatSystemCount[2]"	HVACSys:HeatSystemCount[2]		= {	if (NumHeatSystemTypes > 1) then  1  else  0  endif  }
	"Default HVACSys:HeatSystemCount[3]"	HVACSys:HeatSystemCount[3]		= {	if (NumHeatSystemTypes > 2) then  1  else  0  endif  }
	"Default HVACSys:HeatSystemCount[4]"	HVACSys:HeatSystemCount[4]		= {	if (NumHeatSystemTypes > 3) then  1  else  0  endif  }
	"Default HVACSys:HeatSystemCount[5]"	HVACSys:HeatSystemCount[5]		= {	if (NumHeatSystemTypes > 4) then  1  else  0  endif  }
	"Default HVACSys:HeatSystemCount[6]"	HVACSys:HeatSystemCount[6]		= {	if (NumHeatSystemTypes > 5) then  1  else  0  endif  }
	"Default HVACSys:HeatSystemCount[7]"	HVACSys:HeatSystemCount[7]		= {	if (NumHeatSystemTypes > 6) then  1  else  0  endif  }
	"Default HVACSys:HeatSystemCount[8]"	HVACSys:HeatSystemCount[8]		= {	if (NumHeatSystemTypes > 7) then  1  else  0  endif  }
	"Default HVACSys:HeatSystemCount[9]"	HVACSys:HeatSystemCount[9]		= {	if (NumHeatSystemTypes > 8) then  1  else  0  endif  }
	"Default HVACSys:HeatSystemCount[10]"	HVACSys:HeatSystemCount[10]	= {	if (NumHeatSystemTypes > 9) then  1  else  0  endif  }
;	HVACSys:HeatSystem[ALL],          Default,   0,    1,   1,    1,  1,  1

	"Set HVACSys:NumHeatSysUnits - 1"	HVACSys:NumHeatSysUnits	= {	if (NumHeatSystemTypes > 0 .AND. LocalCompAssigned( HeatSystem[1]  )) then                    HeatSystemCount[1]   else      0      endif  }
	"Set HVACSys:NumHeatSysUnits - 2"	HVACSys:NumHeatSysUnits	= {	if (NumHeatSystemTypes > 1 .AND. LocalCompAssigned( HeatSystem[2]  )) then  NumHeatSysUnits + HeatSystemCount[2]   else  UNCHANGED  endif  }
	"Set HVACSys:NumHeatSysUnits - 3"	HVACSys:NumHeatSysUnits	= {	if (NumHeatSystemTypes > 2 .AND. LocalCompAssigned( HeatSystem[3]  )) then  NumHeatSysUnits + HeatSystemCount[3]   else  UNCHANGED  endif  }
	"Set HVACSys:NumHeatSysUnits - 4"	HVACSys:NumHeatSysUnits	= {	if (NumHeatSystemTypes > 3 .AND. LocalCompAssigned( HeatSystem[4]  )) then  NumHeatSysUnits + HeatSystemCount[4]   else  UNCHANGED  endif  }
	"Set HVACSys:NumHeatSysUnits - 5"	HVACSys:NumHeatSysUnits	= {	if (NumHeatSystemTypes > 4 .AND. LocalCompAssigned( HeatSystem[5]  )) then  NumHeatSysUnits + HeatSystemCount[5]   else  UNCHANGED  endif  }
	"Set HVACSys:NumHeatSysUnits - 6"	HVACSys:NumHeatSysUnits	= {	if (NumHeatSystemTypes > 5 .AND. LocalCompAssigned( HeatSystem[6]  )) then  NumHeatSysUnits + HeatSystemCount[6]   else  UNCHANGED  endif  }
	"Set HVACSys:NumHeatSysUnits - 7"	HVACSys:NumHeatSysUnits	= {	if (NumHeatSystemTypes > 6 .AND. LocalCompAssigned( HeatSystem[7]  )) then  NumHeatSysUnits + HeatSystemCount[7]   else  UNCHANGED  endif  }
	"Set HVACSys:NumHeatSysUnits - 8"	HVACSys:NumHeatSysUnits	= {	if (NumHeatSystemTypes > 7 .AND. LocalCompAssigned( HeatSystem[8]  )) then  NumHeatSysUnits + HeatSystemCount[8]   else  UNCHANGED  endif  }
	"Set HVACSys:NumHeatSysUnits - 9"	HVACSys:NumHeatSysUnits	= {	if (NumHeatSystemTypes > 8 .AND. LocalCompAssigned( HeatSystem[9]  )) then  NumHeatSysUnits + HeatSystemCount[9]   else  UNCHANGED  endif  }
	"Set HVACSys:NumHeatSysUnits - 10"	HVACSys:NumHeatSysUnits	= {	if (NumHeatSystemTypes > 9 .AND. LocalCompAssigned( HeatSystem[10] )) then  NumHeatSysUnits + HeatSystemCount[10]  else  UNCHANGED  endif  }

   ; SAC 6/24/20 - added logic to ensure HeatSysType consistent w/ StdHeatingType for S, SMF & DR runs (tic #1225 & #1226)
   "Set HVACSys:HeatSysType"     HVACSys:HeatSysType  = {
         if (NumHeatSystemTypes > 0 .AND. LocalCompAssigned( HeatSystem[1] ))
         then  if (Proj:RunAbbrev == "s" .OR. Proj:RunAbbrev == "smf" .OR. Proj:RunAbbrev == "dr")
					then  StdHeatingType
					else  HeatSystem[1]:Type  endif
         else  0  endif  }

   ; SAC 7/3/20 - added PkgGasFurnace (18) to HeatSysTypes that are considered 'Gas Furnace' (tic #1227)
   "Set HVACSys:GasFurnAreaServed - area served iff heating type is Gas Furnace"     ; 2019 code (tic #928) - SAC 2/5/18
      HVACSys:GasFurnAreaServed  = {
         if (HeatSysType == 1 .OR. HeatSysType == 18) then  FloorAreaServed[1]    ; CntrlFurnace or PkgGasFurnace
         else  0  endif  }

   "Set HVACSys:SDHVAreaServed - area served if HP type or Cl type is SDHV"     ; 2019 code (tic #1130) - JP 8/16/19
      HVACSys:SDHVAreaServed  = {
         if (CoolSysType == 18) then  FloorAreaServed[1]    ; "SDHVSplitAirCond or SDHVSplitHeatPump"
         else  0  endif  }

	"Blast Heat* user input if HeatSysType has changed"	HVACSys:Action	= {	if (LocalStatus( HeatSysTypeSetup ) < 1 .OR. LocalStatus( PrevHeatSysType ) < 1) then  UNCHANGED
																										else if (HeatSysTypeSetup < 0.5) then  UNCHANGED
																										else if (HeatSysType != PrevHeatSysType)
																										then	EvalRulelist( "BlastHVACSysUserInput_Heating", 1 )
																										else	UNCHANGED  endif endif endif  }
	"Set HVACSys:PrevHeatSysType"		HVACSys:PrevHeatSysType		= {	HeatSysType  }
	"Set HVACSys:HeatSysTypeSetup"	HVACSys:HeatSysTypeSetup	= {	if (HeatSysType > 0) then  1  else  0  endif  }

  ; SAC 1/10/13 - revised to prevent setting AUTOSIZE for rsCapH when system is of type ASHP
	"Default HVACSys:AutoSizeHeatInp"		HVACSys:AutoSizeHeatInp	= {	1  }

	; need to set this such that we error on the HIGH side, so that referenced objects that are not used due to lack of floor area or incompatible system types don't cause assigned HVACHeat obejcts to get set to 0
	"Set HVACSys:AutoSizeHeat[1]"		HVACSys:AutoSizeHeat[1]		= {	if (AutoSizeHeatInp == 0 .AND. FloorAreaServed[1] > 0.5 .AND. NumHeatSystemTypes > 0) then  0  else  1  endif  }

	"Set HVACSys:HasCentralFurnace"	HVACSys:HasCentralFurnace	= {	if (NumHeatSystemTypes > 0 .AND. LocalCompAssigned( HeatSystem[1] ))
																							then  if (HeatSystem[1]:Type == 1) then  1  else  0  endif
																							else if (NumHeatSystemTypes > 1 .AND. LocalCompAssigned( HeatSystem[2] ))
																							then  if (HeatSystem[2]:Type == 1) then  1  else  0  endif
																							else if (NumHeatSystemTypes > 2 .AND. LocalCompAssigned( HeatSystem[3] ))
																							then  if (HeatSystem[3]:Type == 1) then  1  else  0  endif
																							else if (NumHeatSystemTypes > 3 .AND. LocalCompAssigned( HeatSystem[4] ))
																							then  if (HeatSystem[4]:Type == 1) then  1  else  0  endif
																							else if (NumHeatSystemTypes > 4 .AND. LocalCompAssigned( HeatSystem[5] ))
																							then  if (HeatSystem[5]:Type == 1) then  1  else  0  endif
																							else	0  endif endif endif endif endif  }


  ; SAC 11/20/14 - rules to FORCE reset of array elements beyond those valid based on NumCoolSystemTypes
	"Force reset of HVACSys:CoolSystem*[1]"		HVACSys:Action		= {	if (IfValidAnd( NumCoolSystemTypes >= 1 ) .OR. (LocalStatus( CoolSystemCount[1] ) < 6 .AND. LocalStatus( CoolSystem[1] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_CoolSystem_1", 1 )  endif  }
	"Force reset of HVACSys:CoolSystem*[2]"		HVACSys:Action		= {	if (IfValidAnd( NumCoolSystemTypes >= 2 ) .OR. (LocalStatus( CoolSystemCount[2] ) < 6 .AND. LocalStatus( CoolSystem[2] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_CoolSystem_2", 1 )  endif  }
	"Force reset of HVACSys:CoolSystem*[3]"		HVACSys:Action		= {	if (IfValidAnd( NumCoolSystemTypes >= 3 ) .OR. (LocalStatus( CoolSystemCount[3] ) < 6 .AND. LocalStatus( CoolSystem[3] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_CoolSystem_3", 1 )  endif  }
	"Force reset of HVACSys:CoolSystem*[4]"		HVACSys:Action		= {	if (IfValidAnd( NumCoolSystemTypes >= 4 ) .OR. (LocalStatus( CoolSystemCount[4] ) < 6 .AND. LocalStatus( CoolSystem[4] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_CoolSystem_4", 1 )  endif  }
	"Force reset of HVACSys:CoolSystem*[5]"		HVACSys:Action		= {	if (IfValidAnd( NumCoolSystemTypes >= 5 ) .OR. (LocalStatus( CoolSystemCount[5] ) < 6 .AND. LocalStatus( CoolSystem[5] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_CoolSystem_5", 1 )  endif  }
	"Force reset of HVACSys:CoolSystem*[6]"		HVACSys:Action		= {	if (IfValidAnd( NumCoolSystemTypes >= 6 ) .OR. (LocalStatus( CoolSystemCount[6] ) < 6 .AND. LocalStatus( CoolSystem[6] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_CoolSystem_6", 1 )  endif  }
	"Force reset of HVACSys:CoolSystem*[7]"		HVACSys:Action		= {	if (IfValidAnd( NumCoolSystemTypes >= 7 ) .OR. (LocalStatus( CoolSystemCount[7] ) < 6 .AND. LocalStatus( CoolSystem[7] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_CoolSystem_7", 1 )  endif  }
	"Force reset of HVACSys:CoolSystem*[8]"		HVACSys:Action		= {	if (IfValidAnd( NumCoolSystemTypes >= 8 ) .OR. (LocalStatus( CoolSystemCount[8] ) < 6 .AND. LocalStatus( CoolSystem[8] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_CoolSystem_8", 1 )  endif  }
	"Force reset of HVACSys:CoolSystem*[9]"		HVACSys:Action		= {	if (IfValidAnd( NumCoolSystemTypes >= 9 ) .OR. (LocalStatus( CoolSystemCount[9] ) < 6 .AND. LocalStatus( CoolSystem[9] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_CoolSystem_9", 1 )  endif  }
	"Force reset of HVACSys:CoolSystem*[10]"		HVACSys:Action		= {	if (IfValidAnd( NumCoolSystemTypes >= 10 ) .OR. (LocalStatus( CoolSystemCount[10] ) < 6 .AND. LocalStatus( CoolSystem[10] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_CoolSystem_10", 1 )  endif  }

	"Default HVACSys:CoolSystemCount[1]"	HVACSys:CoolSystemCount[1]		= {	if (NumCoolSystemTypes > 0) then  1  else  0  endif  }
	"Default HVACSys:CoolSystemCount[2]"	HVACSys:CoolSystemCount[2]		= {	if (NumCoolSystemTypes > 1) then  1  else  0  endif  }
	"Default HVACSys:CoolSystemCount[3]"	HVACSys:CoolSystemCount[3]		= {	if (NumCoolSystemTypes > 2) then  1  else  0  endif  }
	"Default HVACSys:CoolSystemCount[4]"	HVACSys:CoolSystemCount[4]		= {	if (NumCoolSystemTypes > 3) then  1  else  0  endif  }
	"Default HVACSys:CoolSystemCount[5]"	HVACSys:CoolSystemCount[5]		= {	if (NumCoolSystemTypes > 4) then  1  else  0  endif  }
	"Default HVACSys:CoolSystemCount[6]"	HVACSys:CoolSystemCount[6]		= {	if (NumCoolSystemTypes > 5) then  1  else  0  endif  }
	"Default HVACSys:CoolSystemCount[7]"	HVACSys:CoolSystemCount[7]		= {	if (NumCoolSystemTypes > 6) then  1  else  0  endif  }
	"Default HVACSys:CoolSystemCount[8]"	HVACSys:CoolSystemCount[8]		= {	if (NumCoolSystemTypes > 7) then  1  else  0  endif  }
	"Default HVACSys:CoolSystemCount[9]"	HVACSys:CoolSystemCount[9]		= {	if (NumCoolSystemTypes > 8) then  1  else  0  endif  }
	"Default HVACSys:CoolSystemCount[10]"	HVACSys:CoolSystemCount[10]	= {	if (NumCoolSystemTypes > 9) then  1  else  0  endif  }
;	HVACSys:CoolSystem[ALL],          Default,   0,    1,   1,    1,  1,  1

	"Set HVACSys:NumCoolSysUnits - 1"	HVACSys:NumCoolSysUnits	= {	if (NumCoolSystemTypes > 0 .AND. LocalCompAssigned( CoolSystem[1]  )) then                    CoolSystemCount[1]   else      0      endif  }
	"Set HVACSys:NumCoolSysUnits - 2"	HVACSys:NumCoolSysUnits	= {	if (NumCoolSystemTypes > 1 .AND. LocalCompAssigned( CoolSystem[2]  )) then  NumCoolSysUnits + CoolSystemCount[2]   else  UNCHANGED  endif  }
	"Set HVACSys:NumCoolSysUnits - 3"	HVACSys:NumCoolSysUnits	= {	if (NumCoolSystemTypes > 2 .AND. LocalCompAssigned( CoolSystem[3]  )) then  NumCoolSysUnits + CoolSystemCount[3]   else  UNCHANGED  endif  }
	"Set HVACSys:NumCoolSysUnits - 4"	HVACSys:NumCoolSysUnits	= {	if (NumCoolSystemTypes > 3 .AND. LocalCompAssigned( CoolSystem[4]  )) then  NumCoolSysUnits + CoolSystemCount[4]   else  UNCHANGED  endif  }
	"Set HVACSys:NumCoolSysUnits - 5"	HVACSys:NumCoolSysUnits	= {	if (NumCoolSystemTypes > 4 .AND. LocalCompAssigned( CoolSystem[5]  )) then  NumCoolSysUnits + CoolSystemCount[5]   else  UNCHANGED  endif  }
	"Set HVACSys:NumCoolSysUnits - 6"	HVACSys:NumCoolSysUnits	= {	if (NumCoolSystemTypes > 5 .AND. LocalCompAssigned( CoolSystem[6]  )) then  NumCoolSysUnits + CoolSystemCount[6]   else  UNCHANGED  endif  }
	"Set HVACSys:NumCoolSysUnits - 7"	HVACSys:NumCoolSysUnits	= {	if (NumCoolSystemTypes > 6 .AND. LocalCompAssigned( CoolSystem[7]  )) then  NumCoolSysUnits + CoolSystemCount[7]   else  UNCHANGED  endif  }
	"Set HVACSys:NumCoolSysUnits - 8"	HVACSys:NumCoolSysUnits	= {	if (NumCoolSystemTypes > 7 .AND. LocalCompAssigned( CoolSystem[8]  )) then  NumCoolSysUnits + CoolSystemCount[8]   else  UNCHANGED  endif  }
	"Set HVACSys:NumCoolSysUnits - 9"	HVACSys:NumCoolSysUnits	= {	if (NumCoolSystemTypes > 8 .AND. LocalCompAssigned( CoolSystem[9]  )) then  NumCoolSysUnits + CoolSystemCount[9]   else  UNCHANGED  endif  }
	"Set HVACSys:NumCoolSysUnits - 10"	HVACSys:NumCoolSysUnits	= {	if (NumCoolSystemTypes > 9 .AND. LocalCompAssigned( CoolSystem[10] )) then  NumCoolSysUnits + CoolSystemCount[10]  else  UNCHANGED  endif  }

   ; SAC 6/24/20 - added logic to ensure CoolSysType consistent w/ StdCoolingType for S, SMF & DR runs (tic #1225 & #1226)
	"Set HVACSys:CoolSysType"			HVACSys:CoolSysType			= {	if (NumCoolSystemTypes > 0 .AND. LocalCompAssigned( CoolSystem[1] ))
																							then  if (Proj:RunAbbrev == "s" .OR. Proj:RunAbbrev == "smf" .OR. Proj:RunAbbrev == "dr")
																							      then  StdCoolingType
																							      else  CoolSystem[1]:Type  endif
																							else  0  endif  }

	"Blast Cool* user input if CoolSysType has changed"	HVACSys:Action	= {	if (LocalStatus( CoolSysTypeSetup ) < 1 .OR. LocalStatus( PrevCoolSysType ) < 1) then  UNCHANGED
																										else if (CoolSysTypeSetup < 0.5) then  UNCHANGED
																										else if (CoolSysType != PrevCoolSysType)
																										then	EvalRulelist( "BlastHVACSysUserInput_Cooling", 1 )
																										else	UNCHANGED  endif endif endif  }
	"Set HVACSys:PrevCoolSysType"		HVACSys:PrevCoolSysType		= {	CoolSysType  }
	"Set HVACSys:CoolSysTypeSetup"	HVACSys:CoolSysTypeSetup	= {	if (CoolSysType > 0) then  1  else  0  endif  }

  ; SAC 1/10/13 - revised to prevent setting AUTOSIZE for rsCapH when system is of type ASHP
	"Default HVACSys:AutoSizeCoolInp"		HVACSys:AutoSizeCoolInp	= {	1  }

	; need to set this such that we error on the HIGH side, so that referenced objects that are not used due to lack of floor area or incompatible system types don't cause assigned HVACCool obejcts to get set to 0
	"Set HVACSys:AutoSizeCool[1]"		HVACSys:AutoSizeCool[1]		= {	if (AutoSizeCoolInp == 0 .AND. FloorAreaServed[1] > 0.5 .AND. NumCoolSystemTypes > 0) then  0  else  1  endif  }

	"Init HVACSys:NumHtPumpSysUnits"			HVACSys:NumHtPumpSysUnits		= {	0  }

  ; SAC 3/10/14 - set new property used to identify # of SCSysRpt report records this HVACSys will need
  ; mjb  4/21/14 - "Mech1" replaced with "SCSysRpt" in data model
  ; SAC 1/14/16 - moved down into 'SetupHVACSys_Round2_*' rulelist since HVACSys:MaxNumHVACEquipTypes now dependent on HVACSys:HtOrClDucted which is not set until that point
;	"Set HVACSys:MaxNumHVACEquipTypes"		HVACSys:MaxNumHVACEquipTypes	= {	if (FloorAreaServed[1] > 0.5 .AND. (Proj:RunScope == 1 .OR. Status > 1 .OR. (IsExisting .AND. IsVerified)))
;																										then  max( NumHeatSysUnits, NumCoolSysUnits )  	; Project is New Cons .OR. HVACSys is New or Altered
;																										else  0  endif  }

	"Initialize other generic properties (commong to Ht/Cl/HP)"		HVACSys:Action	= {	EvalRulelist( "SetupHVACSys_Round1_common", 1 )  }
END


; SAC 8/24/13 - setup initial set of HVACHeat/Cool/HtPump assignment properties
;*************************************************************************
RULELIST "SetupHVACSys_Round1_HeatPump" 0 0 0 0
;*************************************************************************
  ; SAC 11/20/14 - rules to FORCE reset of array elements beyond those valid based on NumHtPumpSystemTypes
	"Force reset of HVACSys:HtPumpSystem*[1]"		HVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 1 ) .OR. (LocalStatus( HtPumpSystemCount[1] ) < 6 .AND. LocalStatus( HtPumpSystem[1] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HtPumpSystem_1", 1 )  endif  }
	"Force reset of HVACSys:HtPumpSystem*[2]"		HVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 2 ) .OR. (LocalStatus( HtPumpSystemCount[2] ) < 6 .AND. LocalStatus( HtPumpSystem[2] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HtPumpSystem_2", 1 )  endif  }
	"Force reset of HVACSys:HtPumpSystem*[3]"		HVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 3 ) .OR. (LocalStatus( HtPumpSystemCount[3] ) < 6 .AND. LocalStatus( HtPumpSystem[3] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HtPumpSystem_3", 1 )  endif  }
	"Force reset of HVACSys:HtPumpSystem*[4]"		HVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 4 ) .OR. (LocalStatus( HtPumpSystemCount[4] ) < 6 .AND. LocalStatus( HtPumpSystem[4] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HtPumpSystem_4", 1 )  endif  }
	"Force reset of HVACSys:HtPumpSystem*[5]"		HVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 5 ) .OR. (LocalStatus( HtPumpSystemCount[5] ) < 6 .AND. LocalStatus( HtPumpSystem[5] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HtPumpSystem_5", 1 )  endif  }
	"Force reset of HVACSys:HtPumpSystem*[6]"		HVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 6 ) .OR. (LocalStatus( HtPumpSystemCount[6] ) < 6 .AND. LocalStatus( HtPumpSystem[6] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HtPumpSystem_6", 1 )  endif  }
	"Force reset of HVACSys:HtPumpSystem*[7]"		HVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 7 ) .OR. (LocalStatus( HtPumpSystemCount[7] ) < 6 .AND. LocalStatus( HtPumpSystem[7] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HtPumpSystem_7", 1 )  endif  }
	"Force reset of HVACSys:HtPumpSystem*[8]"		HVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 8 ) .OR. (LocalStatus( HtPumpSystemCount[8] ) < 6 .AND. LocalStatus( HtPumpSystem[8] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HtPumpSystem_8", 1 )  endif  }
	"Force reset of HVACSys:HtPumpSystem*[9]"		HVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 9 ) .OR. (LocalStatus( HtPumpSystemCount[9] ) < 6 .AND. LocalStatus( HtPumpSystem[9] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HtPumpSystem_9", 1 )  endif  }
	"Force reset of HVACSys:HtPumpSystem*[10]"	HVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 10 ) .OR. (LocalStatus( HtPumpSystemCount[10] ) < 6 .AND. LocalStatus( HtPumpSystem[10] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HtPumpSystem_10", 1 )  endif  }

	"Default HVACSys:HtPumpSystemCount[1]"		HVACSys:HtPumpSystemCount[1]		= {	if (NumHtPumpSystemTypes > 0) then  1  else  0  endif  }
	"Default HVACSys:HtPumpSystemCount[2]"		HVACSys:HtPumpSystemCount[2]		= {	if (NumHtPumpSystemTypes > 1) then  1  else  0  endif  }
	"Default HVACSys:HtPumpSystemCount[3]"		HVACSys:HtPumpSystemCount[3]		= {	if (NumHtPumpSystemTypes > 2) then  1  else  0  endif  }
	"Default HVACSys:HtPumpSystemCount[4]"		HVACSys:HtPumpSystemCount[4]		= {	if (NumHtPumpSystemTypes > 3) then  1  else  0  endif  }
	"Default HVACSys:HtPumpSystemCount[5]"		HVACSys:HtPumpSystemCount[5]		= {	if (NumHtPumpSystemTypes > 4) then  1  else  0  endif  }
	"Default HVACSys:HtPumpSystemCount[6]"		HVACSys:HtPumpSystemCount[6]		= {	if (NumHtPumpSystemTypes > 5) then  1  else  0  endif  }
	"Default HVACSys:HtPumpSystemCount[7]"		HVACSys:HtPumpSystemCount[7]		= {	if (NumHtPumpSystemTypes > 6) then  1  else  0  endif  }
	"Default HVACSys:HtPumpSystemCount[8]"		HVACSys:HtPumpSystemCount[8]		= {	if (NumHtPumpSystemTypes > 7) then  1  else  0  endif  }
	"Default HVACSys:HtPumpSystemCount[9]"		HVACSys:HtPumpSystemCount[9]		= {	if (NumHtPumpSystemTypes > 8) then  1  else  0  endif  }
	"Default HVACSys:HtPumpSystemCount[10]"	HVACSys:HtPumpSystemCount[10]		= {	if (NumHtPumpSystemTypes > 9) then  1  else  0  endif  }
;	HVACSys:HtPumpSystem[ALL],          Default,   0,    1,   1,    1,  1,  1

	"Set HVACSys:NumHtPumpSysUnits - 1"		HVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1]  )) then                      HtPumpSystemCount[1]   else      0      endif  }
	"Set HVACSys:NumHtPumpSysUnits - 2"		HVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 1 .AND. LocalCompAssigned( HtPumpSystem[2]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[2]   else  UNCHANGED  endif  }
	"Set HVACSys:NumHtPumpSysUnits - 3"		HVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 2 .AND. LocalCompAssigned( HtPumpSystem[3]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[3]   else  UNCHANGED  endif  }
	"Set HVACSys:NumHtPumpSysUnits - 4"		HVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 3 .AND. LocalCompAssigned( HtPumpSystem[4]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[4]   else  UNCHANGED  endif  }
	"Set HVACSys:NumHtPumpSysUnits - 5"		HVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 4 .AND. LocalCompAssigned( HtPumpSystem[5]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[5]   else  UNCHANGED  endif  }
	"Set HVACSys:NumHtPumpSysUnits - 6"		HVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 5 .AND. LocalCompAssigned( HtPumpSystem[6]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[6]   else  UNCHANGED  endif  }
	"Set HVACSys:NumHtPumpSysUnits - 7"		HVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 6 .AND. LocalCompAssigned( HtPumpSystem[7]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[7]   else  UNCHANGED  endif  }
	"Set HVACSys:NumHtPumpSysUnits - 8"		HVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 7 .AND. LocalCompAssigned( HtPumpSystem[8]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[8]   else  UNCHANGED  endif  }
	"Set HVACSys:NumHtPumpSysUnits - 9"		HVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 8 .AND. LocalCompAssigned( HtPumpSystem[9]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[9]   else  UNCHANGED  endif  }
	"Set HVACSys:NumHtPumpSysUnits - 10"	HVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 9 .AND. LocalCompAssigned( HtPumpSystem[10] )) then  NumHtPumpSysUnits + HtPumpSystemCount[10]  else  UNCHANGED  endif  }

   ; SAC 6/24/20 - added logic to ensure HtPumpSysType consistent w/ StdHeatingType for S, SMF & DR runs (tic #1225 & #1226)
   ; revised logic to ensure HtPumpSysType NOT updated for Existing systems in Std, SMF & DR models - SAC 06/24/21
	"Set HVACSys:HtPumpSysType"			HVACSys:HtPumpSysType			= {	if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1] ))
																									then  if ((Proj:RunScope == 2 .OR. Proj:IsAddAlone > 0.5) .AND. MinRevRef( Zone:ActiveHVACSystem, Zone:HVACSysStatus ) < 2)
                                                                                 then  HtPumpSystem[1]:Type
                                                                                 else if (Proj:RunAbbrev == "s" .OR. Proj:RunAbbrev == "smf" .OR. Proj:RunAbbrev == "dr")
																							            then  StdHeatingType
																							            else  HtPumpSystem[1]:Type  endif endif
																									else  0  endif  }

   "Set HVACSys:GasFurnAreaServed - area served iff heating type is Gas Furnace"     ; 2019 code (tic #928) - SAC 2/5/18
      HVACSys:GasFurnAreaServed  = {  0  }

   "Set HVACSys:SDHVAreaServed - area served if HP type or Cl type is SDHV"     ; 2019 code (tic #1130) - JP 8/16/19
      HVACSys:SDHVAreaServed  = {
         if (HtPumpSysType == 19) then  FloorAreaServed[1]    ; "SDHVSplitAirCond or SDHVSplitHeatPump"
         else  0  endif  }

	"Blast HtPump* user input if HtPumpSysType has changed"	HVACSys:Action	= {	if (LocalStatus( HtPumpSysTypeSetup ) < 1 .OR. LocalStatus( PrevHtPumpSysType ) < 1) then  UNCHANGED
																											else if (HtPumpSysTypeSetup < 0.5) then  UNCHANGED
																											else if (HtPumpSysType != PrevHtPumpSysType)
																											then	EvalRulelist( "BlastHVACSysUserInput_HeatPump", 1 )
																											else	UNCHANGED  endif endif endif  }
	"Set HVACSys:PrevHtPumpSysType"		HVACSys:PrevHtPumpSysType		= {	HtPumpSysType  }
	"Set HVACSys:HtPumpSysTypeSetup"		HVACSys:HtPumpSysTypeSetup		= {	if (HtPumpSysType > 0) then  1  else  0  endif  }

; SAC 9/29/13 - added logic to cause standard design HPs to auto-size their heat caps
; SAC 10/27/15 - added check for design rating run abbreviation (Proj:RunAbbrev == "dr")
	"Default HVACSys:AutoSizeHeatInp"	HVACSys:AutoSizeHeatInp			= {	if (GlobalStatus( Proj:RunAbbrev ) < 1) then  0
																									else if (Proj:RunAbbrev == "s" .OR. Proj:RunAbbrev == "S" .OR. Proj:RunAbbrev == "smf" .OR. Proj:RunAbbrev == "dr") then  1  else  0  endif endif  }
	"Set HVACSys:AutoSizeHeat[1]"			HVACSys:AutoSizeHeat[1]			= {	0  }   ; never cause AUTOSIZE to get set for heating portion of HP in CSE
	"Default HVACSys:AutoSizeCoolInp"	HVACSys:AutoSizeCoolInp			= {	1  }
	"Set HVACSys:AutoSizeCool[1]"			HVACSys:AutoSizeCool[1]			= {	1  }

	"Init HVACSys:NumHeatSysUnits"		HVACSys:NumHeatSysUnits			= {	0  }
	"Init HVACSys:NumCoolSysUnits"		HVACSys:NumCoolSysUnits			= {	0  }

  ; SAC 3/10/14 - set new property used to identify # of SCSysRpt report records this HVACSys will need
  ; mjb  4/21/14 - "Mech1" replaced with "SCSysRpt" in data model
  ; SAC 1/14/16 - moved down into 'SetupHVACSys_Round2_*' rulelist since HVACSys:MaxNumHVACEquipTypes now dependent on HVACSys:HtOrClDucted which is not set until that point
;	"Set HVACSys:MaxNumHVACEquipTypes"		HVACSys:MaxNumHVACEquipTypes	= {	if (FloorAreaServed[1] > 0.5 .AND. (Proj:RunScope == 1 .OR. Status > 1 .OR. (IsExisting .AND. IsVerified) .OR.
;																																						(IsExisting .AND. (IfValidAnd() .OR. IfValidAnd()))))
;																										then  NumHtPumpSysUnits  	; Project is New Cons .OR. HVACSys is New or Altered
;																										else  0  endif  }

	"Initialize other generic properties (commong to Ht/Cl/HP)"		HVACSys:Action	= {	EvalRulelist( "SetupHVACSys_Round1_common", 1 )  }
END


; SAC 8/24/13 - setup initial set of HVACHeat/Cool/HtPump assignment properties
;*************************************************************************
RULELIST "SetupHVACSys_Round1_common" 0 0 0 0
;*************************************************************************
	"Set HVACSys:HeatSysEntryMsg"		HVACSys:HeatSysEntryMsg	= {	if (Type == 2) then  "Heating equipment entered on main HVAC system or Heat Pump tab for this system."
																						else if (NumHeatSystemTypes < 2) then  "Heating equipment entered on main HVAC System tab for this system."
																						else  "All heating equipment assignments must be of the same 'Type'."  endif endif  }

	"Set HVACSys:CoolSysEntryMsg"		HVACSys:CoolSysEntryMsg	= {	if (Type == 2) then  "Cooling equipment entered on main HVAC system or Heat Pump tab for this system."
																						else if (NumCoolSystemTypes < 2) then  "Cooling equipment entered on main HVAC System tab for this system."
																						else  "All cooling equipment assignments must be of the same 'Type'."  endif endif  }

	"Set HVACSys:HtPumpSysEntryMsg"	HVACSys:HtPumpSysEntryMsg	= {	if (Type == 1 .OR. Type == 3) then  "Heating & cooling equipment entered on other tabs for this system."
																							else if (NumHtPumpSystemTypes < 2) then  "Heat pump equipment entered on main HVAC System tab for this system."
																							else  "All heat pump equipment assignments must be of the same 'Type'."  endif endif  }

	"Set HVACSys:HeatEquipNumLbl"		HVACSys:HeatEquipNumLbl		= {	if (Type == 2) then	"Heat Pump(s):"
																							else						"Heating:"				endif  }
	"Set HVACSys:HeatEquipRefLbl"		HVACSys:HeatEquipRefLbl		= {	if (Type == 2 .And. NumHtPumpSystemTypes == 1) then  "Heat Pump:"
																							else if ((Type == 1 .OR. Type == 3) .And. NumHeatSystemTypes == 1) then  "Heating Unit:"
																							else  " "  endif endif  }

	"Set HVACSys:AutoSizeHeat[2]"		HVACSys:AutoSizeHeat[2]		= {	AutoSizeHeat[1]  }
	"Set HVACSys:AutoSizeHeat[3]"		HVACSys:AutoSizeHeat[3]		= {	AutoSizeHeat[1]  }
	"Set HVACSys:AutoSizeHeat[4]"		HVACSys:AutoSizeHeat[4]		= {	AutoSizeHeat[1]  }
	"Set HVACSys:AutoSizeHeat[5]"		HVACSys:AutoSizeHeat[5]		= {	AutoSizeHeat[1]  }
	"Set HVACSys:AutoSizeHeat[6]"		HVACSys:AutoSizeHeat[6]		= {	AutoSizeHeat[1]  }
	"Set HVACSys:AutoSizeHeat[7]"		HVACSys:AutoSizeHeat[7]		= {	AutoSizeHeat[1]  }
	"Set HVACSys:AutoSizeHeat[8]"		HVACSys:AutoSizeHeat[8]		= {	AutoSizeHeat[1]  }
	"Set HVACSys:AutoSizeHeat[9]"		HVACSys:AutoSizeHeat[9]		= {	AutoSizeHeat[1]  }
	"Set HVACSys:AutoSizeHeat[10]"	HVACSys:AutoSizeHeat[10]	= {	AutoSizeHeat[1]  }

	"Set HVACSys:AutoSizeCool[2]"		HVACSys:AutoSizeCool[2]		= {	AutoSizeCool[1]  }
	"Set HVACSys:AutoSizeCool[3]"		HVACSys:AutoSizeCool[3]		= {	AutoSizeCool[1]  }
	"Set HVACSys:AutoSizeCool[4]"		HVACSys:AutoSizeCool[4]		= {	AutoSizeCool[1]  }
	"Set HVACSys:AutoSizeCool[5]"		HVACSys:AutoSizeCool[5]		= {	AutoSizeCool[1]  }
	"Set HVACSys:AutoSizeCool[6]"		HVACSys:AutoSizeCool[6]		= {	AutoSizeCool[1]  }
	"Set HVACSys:AutoSizeCool[7]"		HVACSys:AutoSizeCool[7]		= {	AutoSizeCool[1]  }
	"Set HVACSys:AutoSizeCool[8]"		HVACSys:AutoSizeCool[8]		= {	AutoSizeCool[1]  }
	"Set HVACSys:AutoSizeCool[9]"		HVACSys:AutoSizeCool[9]		= {	AutoSizeCool[1]  }
	"Set HVACSys:AutoSizeCool[10]"	HVACSys:AutoSizeCool[10]	= {	AutoSizeCool[1]  }
END


; SAC 8/24/13 - setup secondary set of HVACSys Heat/Cool/HtPump assignment properties
;*************************************************************************
RULELIST "SetupHVACSys_Round2_HeatCool" 0 0 0 0
;*************************************************************************
   ; SAC 6/25/20 - revised logic to set HeatSysTypeAbbrev properly for Std, SMF & DR models (tic #1225 & #1226)
	"Set HVACSys:HeatSysTypeAbbrev"	HVACSys:HeatSysTypeAbbrev	=
      {  if (NumHeatSystemTypes > 0 .AND. LocalCompAssigned( HeatSystem[1] ))
         then  HeatSystem[1]:TypeAbbrevStr
         else  " "  endif  }
      ; SAC 6/26/20 - rollback 6/25 mod which caused issues w/ presence of ducts in std design models (tic #1225 & #1226)
      ;   then  if (Proj:RunAbbrev == "s" .OR. Proj:RunAbbrev == "smf" .OR. Proj:RunAbbrev == "dr")
      ;         then  if (HtOrClDucted < 0.5)
      ;               then T24RHeatingEquipment:DuctlessStdSys( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HeatSystem[1]:TypeAbbrevStr )
      ;               else T24RHeatingEquipment:DuctedStdSys(   "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HeatSystem[1]:TypeAbbrevStr )
      ;               endif
      ;         else  HeatSystem[1]:TypeAbbrevStr
      ;         endif
      ;   else  " "  endif  }

; SAC 8/24/13 - moved Ducted* properties to HVACSys from HVACHeat
	"Default HVACSys:HeatDuctedEditable"	HVACSys:HeatDuctedEditable		= {	if (HeatSysType < 1 .OR. LocalCompAssigned( HeatSystem[1] ) == 0) then  0
																										else if (HeatSystem[1]:IsAvailable < 0.5) then  0
																										else if (T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HeatSysTypeAbbrev ) < 0) then  1
																										else  0  endif endif endif  }
	; SAC 11/26/14 - added rule to blast user-specified HeatDucted if it is inconsistent w/ the DuctFlag value in the heating equipment table
	"Force reset of HeatDucted if needed"	HVACSys:Action						= {	if (HeatDuctedEditable > 0.5 .OR. LocalStatus( HeatDucted ) < 6 .OR. HeatSysType < 1 .OR. LocalCompAssigned( HeatSystem[1] ) == 0) then  UNCHANGED
																										else if (HeatSystem[1]:IsAvailable < 0.5) then  UNCHANGED
																										else if (HeatDucted != T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HeatSysTypeAbbrev ))
																										then	EvalRulelist( "BlastUserUnput_HVACSys_HeatDucted", 1 )
																										else	UNCHANGED  endif endif endif  }
	; SAC 4/7/15 - added 4th if() to default to 1 if equipment is ductable (=-1) AND there is a valid duct system assigned to the system
	"Default HVACSys:HeatDucted"				HVACSys:HeatDucted				= {	if (HeatSysType < 1 .OR. LocalCompAssigned( HeatSystem[1] ) == 0) then  0
																										else if (HeatSystem[1]:IsAvailable < 0.5) then  0
																										else if (T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HeatSysTypeAbbrev ) == 1) then  1
																										else if (T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HeatSysTypeAbbrev ) == -1 .AND.
																													LocalCompAssigned( DistribSystem ) .AND. IfValidAnd( DistribSystem:Type > 0 ) .AND. IfValidAnd( DistribSystem:Type != 8 )) then  1
																										else  0  endif endif endif endif  }

; SAC 1/6/14 - revised logic to handle defaulting of AFUE for combined hydronic systems (related to GC issue #254)
; SAC 1/6/16 - switched out HeatSystem[*]:Type for ...:TypeAbbrev in order to differentiate CombHydro from ElecCombHydro (tic 374)
	"Set HVACSys:HtSysAFUE - 1"	HVACSys:HtSysAFUE	= {	if (NumHeatSystemTypes > 0 .AND. LocalCompAssigned( HeatSystem[1]  ) .AND. (HeatSystem[1]:DisplayAFUE  > 0 .OR. HeatSystem[1]:TypeAbbrev  == 9)) then                  HeatSystem[1]:AFUE     else      0      endif  }
	"Set HVACSys:HtSysAFUE - 2"	HVACSys:HtSysAFUE	= {	if (NumHeatSystemTypes > 1 .AND. LocalCompAssigned( HeatSystem[2]  ) .AND. (HeatSystem[2]:DisplayAFUE  > 0 .OR. HeatSystem[2]:TypeAbbrev  == 9)) then  min( HtSysAFUE, HeatSystem[2]:AFUE  )  else  UNCHANGED  endif  }
	"Set HVACSys:HtSysAFUE - 3"	HVACSys:HtSysAFUE	= {	if (NumHeatSystemTypes > 2 .AND. LocalCompAssigned( HeatSystem[3]  ) .AND. (HeatSystem[3]:DisplayAFUE  > 0 .OR. HeatSystem[3]:TypeAbbrev  == 9)) then  min( HtSysAFUE, HeatSystem[3]:AFUE  )  else  UNCHANGED  endif  }
	"Set HVACSys:HtSysAFUE - 4"	HVACSys:HtSysAFUE	= {	if (NumHeatSystemTypes > 3 .AND. LocalCompAssigned( HeatSystem[4]  ) .AND. (HeatSystem[4]:DisplayAFUE  > 0 .OR. HeatSystem[4]:TypeAbbrev  == 9)) then  min( HtSysAFUE, HeatSystem[4]:AFUE  )  else  UNCHANGED  endif  }
	"Set HVACSys:HtSysAFUE - 5"	HVACSys:HtSysAFUE	= {	if (NumHeatSystemTypes > 4 .AND. LocalCompAssigned( HeatSystem[5]  ) .AND. (HeatSystem[5]:DisplayAFUE  > 0 .OR. HeatSystem[5]:TypeAbbrev  == 9)) then  min( HtSysAFUE, HeatSystem[5]:AFUE  )  else  UNCHANGED  endif  }
	"Set HVACSys:HtSysAFUE - 6"	HVACSys:HtSysAFUE	= {	if (NumHeatSystemTypes > 5 .AND. LocalCompAssigned( HeatSystem[6]  ) .AND. (HeatSystem[6]:DisplayAFUE  > 0 .OR. HeatSystem[6]:TypeAbbrev  == 9)) then  min( HtSysAFUE, HeatSystem[6]:AFUE  )  else  UNCHANGED  endif  }
	"Set HVACSys:HtSysAFUE - 7"	HVACSys:HtSysAFUE	= {	if (NumHeatSystemTypes > 6 .AND. LocalCompAssigned( HeatSystem[7]  ) .AND. (HeatSystem[7]:DisplayAFUE  > 0 .OR. HeatSystem[7]:TypeAbbrev  == 9)) then  min( HtSysAFUE, HeatSystem[7]:AFUE  )  else  UNCHANGED  endif  }
	"Set HVACSys:HtSysAFUE - 8"	HVACSys:HtSysAFUE	= {	if (NumHeatSystemTypes > 7 .AND. LocalCompAssigned( HeatSystem[8]  ) .AND. (HeatSystem[8]:DisplayAFUE  > 0 .OR. HeatSystem[8]:TypeAbbrev  == 9)) then  min( HtSysAFUE, HeatSystem[8]:AFUE  )  else  UNCHANGED  endif  }
	"Set HVACSys:HtSysAFUE - 9"	HVACSys:HtSysAFUE	= {	if (NumHeatSystemTypes > 8 .AND. LocalCompAssigned( HeatSystem[9]  ) .AND. (HeatSystem[9]:DisplayAFUE  > 0 .OR. HeatSystem[9]:TypeAbbrev  == 9)) then  min( HtSysAFUE, HeatSystem[9]:AFUE  )  else  UNCHANGED  endif  }
	"Set HVACSys:HtSysAFUE - 10"	HVACSys:HtSysAFUE	= {	if (NumHeatSystemTypes > 9 .AND. LocalCompAssigned( HeatSystem[10] ) .AND. (HeatSystem[10]:DisplayAFUE > 0 .OR. HeatSystem[10]:TypeAbbrev == 9)) then  min( HtSysAFUE, HeatSystem[10]:AFUE )  else  UNCHANGED  endif  }

	"Set HVACSys:HtSysSizingFactor - 1"		HVACSys:HtSysSizingFactor	= {	if (NumHeatSystemTypes > 0 .AND. LocalCompAssigned( HeatSystem[1]  ) .AND. HeatSystemCount[1]  > 0) then                      (HeatSystem[1]:SizingFactor  * HeatSystemCount[1] )  else      0      endif  }
	"Set HVACSys:HtSysSizingFactor - 2"		HVACSys:HtSysSizingFactor	= {	if (NumHeatSystemTypes > 1 .AND. LocalCompAssigned( HeatSystem[2]  ) .AND. HeatSystemCount[2]  > 0) then  HtSysSizingFactor + (HeatSystem[2]:SizingFactor  * HeatSystemCount[2] )  else  UNCHANGED  endif  }
	"Set HVACSys:HtSysSizingFactor - 3"		HVACSys:HtSysSizingFactor	= {	if (NumHeatSystemTypes > 2 .AND. LocalCompAssigned( HeatSystem[3]  ) .AND. HeatSystemCount[3]  > 0) then  HtSysSizingFactor + (HeatSystem[3]:SizingFactor  * HeatSystemCount[3] )  else  UNCHANGED  endif  }
	"Set HVACSys:HtSysSizingFactor - 4"		HVACSys:HtSysSizingFactor	= {	if (NumHeatSystemTypes > 3 .AND. LocalCompAssigned( HeatSystem[4]  ) .AND. HeatSystemCount[4]  > 0) then  HtSysSizingFactor + (HeatSystem[4]:SizingFactor  * HeatSystemCount[4] )  else  UNCHANGED  endif  }
	"Set HVACSys:HtSysSizingFactor - 5"		HVACSys:HtSysSizingFactor	= {	if (NumHeatSystemTypes > 4 .AND. LocalCompAssigned( HeatSystem[5]  ) .AND. HeatSystemCount[5]  > 0) then  HtSysSizingFactor + (HeatSystem[5]:SizingFactor  * HeatSystemCount[5] )  else  UNCHANGED  endif  }
	"Set HVACSys:HtSysSizingFactor - 6"		HVACSys:HtSysSizingFactor	= {	if (NumHeatSystemTypes > 5 .AND. LocalCompAssigned( HeatSystem[6]  ) .AND. HeatSystemCount[6]  > 0) then  HtSysSizingFactor + (HeatSystem[6]:SizingFactor  * HeatSystemCount[6] )  else  UNCHANGED  endif  }
	"Set HVACSys:HtSysSizingFactor - 7"		HVACSys:HtSysSizingFactor	= {	if (NumHeatSystemTypes > 6 .AND. LocalCompAssigned( HeatSystem[7]  ) .AND. HeatSystemCount[7]  > 0) then  HtSysSizingFactor + (HeatSystem[7]:SizingFactor  * HeatSystemCount[7] )  else  UNCHANGED  endif  }
	"Set HVACSys:HtSysSizingFactor - 8"		HVACSys:HtSysSizingFactor	= {	if (NumHeatSystemTypes > 7 .AND. LocalCompAssigned( HeatSystem[8]  ) .AND. HeatSystemCount[8]  > 0) then  HtSysSizingFactor + (HeatSystem[8]:SizingFactor  * HeatSystemCount[8] )  else  UNCHANGED  endif  }
	"Set HVACSys:HtSysSizingFactor - 9"		HVACSys:HtSysSizingFactor	= {	if (NumHeatSystemTypes > 8 .AND. LocalCompAssigned( HeatSystem[9]  ) .AND. HeatSystemCount[9]  > 0) then  HtSysSizingFactor + (HeatSystem[9]:SizingFactor  * HeatSystemCount[9] )  else  UNCHANGED  endif  }
	"Set HVACSys:HtSysSizingFactor - 10"	HVACSys:HtSysSizingFactor	= {	if (NumHeatSystemTypes > 9 .AND. LocalCompAssigned( HeatSystem[10] ) .AND. HeatSystemCount[10] > 0) then  HtSysSizingFactor + (HeatSystem[10]:SizingFactor * HeatSystemCount[10])  else  UNCHANGED  endif  }
	"Set HVACSys:HtSysSizingFactor - XX"	HVACSys:HtSysSizingFactor	= {	if (NumHeatSysUnits > 0.5) then  HtSysSizingFactor / NumHeatSysUnits  else  UNCHANGED  endif  }

	"Set HVACSys:HtSysCapacity - 1"		HVACSys:HtSysCapacity	= {	if (AutoSizeHeat[1]  == 0 .AND. NumHeatSystemTypes > 0 .AND. LocalCompAssigned( HeatSystem[1]  ) .AND. HeatSystemCount[1]  > 0) then                  (HeatSystem[1]:TotalCapacity  * HeatSystemCount[1] )  else      0      endif  }
	"Set HVACSys:HtSysCapacity - 2"		HVACSys:HtSysCapacity	= {	if (AutoSizeHeat[2]  == 0 .AND. NumHeatSystemTypes > 1 .AND. LocalCompAssigned( HeatSystem[2]  ) .AND. HeatSystemCount[2]  > 0) then  HtSysCapacity + (HeatSystem[2]:TotalCapacity  * HeatSystemCount[2] )  else  UNCHANGED  endif  }
	"Set HVACSys:HtSysCapacity - 3" 		HVACSys:HtSysCapacity	= {	if (AutoSizeHeat[3]  == 0 .AND. NumHeatSystemTypes > 2 .AND. LocalCompAssigned( HeatSystem[3]  ) .AND. HeatSystemCount[3]  > 0) then  HtSysCapacity + (HeatSystem[3]:TotalCapacity  * HeatSystemCount[3] )  else  UNCHANGED  endif  }
	"Set HVACSys:HtSysCapacity - 4" 		HVACSys:HtSysCapacity	= {	if (AutoSizeHeat[4]  == 0 .AND. NumHeatSystemTypes > 3 .AND. LocalCompAssigned( HeatSystem[4]  ) .AND. HeatSystemCount[4]  > 0) then  HtSysCapacity + (HeatSystem[4]:TotalCapacity  * HeatSystemCount[4] )  else  UNCHANGED  endif  }
	"Set HVACSys:HtSysCapacity - 5" 		HVACSys:HtSysCapacity	= {	if (AutoSizeHeat[5]  == 0 .AND. NumHeatSystemTypes > 4 .AND. LocalCompAssigned( HeatSystem[5]  ) .AND. HeatSystemCount[5]  > 0) then  HtSysCapacity + (HeatSystem[5]:TotalCapacity  * HeatSystemCount[5] )  else  UNCHANGED  endif  }
	"Set HVACSys:HtSysCapacity - 6" 		HVACSys:HtSysCapacity	= {	if (AutoSizeHeat[6]  == 0 .AND. NumHeatSystemTypes > 5 .AND. LocalCompAssigned( HeatSystem[6]  ) .AND. HeatSystemCount[6]  > 0) then  HtSysCapacity + (HeatSystem[6]:TotalCapacity  * HeatSystemCount[6] )  else  UNCHANGED  endif  }
	"Set HVACSys:HtSysCapacity - 7" 		HVACSys:HtSysCapacity	= {	if (AutoSizeHeat[7]  == 0 .AND. NumHeatSystemTypes > 6 .AND. LocalCompAssigned( HeatSystem[7]  ) .AND. HeatSystemCount[7]  > 0) then  HtSysCapacity + (HeatSystem[7]:TotalCapacity  * HeatSystemCount[7] )  else  UNCHANGED  endif  }
	"Set HVACSys:HtSysCapacity - 8" 		HVACSys:HtSysCapacity	= {	if (AutoSizeHeat[8]  == 0 .AND. NumHeatSystemTypes > 7 .AND. LocalCompAssigned( HeatSystem[8]  ) .AND. HeatSystemCount[8]  > 0) then  HtSysCapacity + (HeatSystem[8]:TotalCapacity  * HeatSystemCount[8] )  else  UNCHANGED  endif  }
	"Set HVACSys:HtSysCapacity - 9" 		HVACSys:HtSysCapacity	= {	if (AutoSizeHeat[9]  == 0 .AND. NumHeatSystemTypes > 8 .AND. LocalCompAssigned( HeatSystem[9]  ) .AND. HeatSystemCount[9]  > 0) then  HtSysCapacity + (HeatSystem[9]:TotalCapacity  * HeatSystemCount[9] )  else  UNCHANGED  endif  }
	"Set HVACSys:HtSysCapacity - 10"		HVACSys:HtSysCapacity	= {	if (AutoSizeHeat[10] == 0 .AND. NumHeatSystemTypes > 9 .AND. LocalCompAssigned( HeatSystem[10] ) .AND. HeatSystemCount[10] > 0) then  HtSysCapacity + (HeatSystem[10]:TotalCapacity * HeatSystemCount[10])  else  UNCHANGED  endif  }


; SAC 1/6/14 - revised logic to incorporate AFUE for combined hydronic systems into efficiency message (related to GC issue #254)
; SAC 1/14/14 - fixed other labels (namely ELecFurn) (GC issue #271)
	"Set HVACSys:HeatEquipSummary"	HVACSys:HeatEquipSummary	= {
					if (NumHeatSystemTypes <= 0) then  " "
					else if (NumHeatSysUnits < 1) then  "No heating equipment units (counts) defined"
					else if (LocalCompAssigned( HeatSystem[1] ) == 0) then  "Heating equipment assignment #1 not defined"
					else if (HeatSystem[1]:IsAvailable > 0 .AND. HeatSystem[1]:Type == 9)
					then	Format( "%.0f %s unit(s), AFUEeff %.1f", NumHeatSysUnits, HeatSysTypeAbbrev, HtSysAFUE )
					else if (HeatSystem[1]:IsAvailable > 0 .AND. HeatSystem[1]:DisplayAFUE > 0)
					then	Format( "%.0f %s unit(s), AFUE %.1f", NumHeatSysUnits, HeatSysTypeAbbrev, HtSysAFUE )
					else	switch (HeatSystem[1]:Type)
								case  2 :	Format( "%.0f %s unit(s)", NumHeatSysUnits, HeatSysTypeAbbrev ) 	; "Heater - Non-central fuel-fired space heater"
								case  3 :	Format( "%.0f %s unit(s)", NumHeatSysUnits, HeatSysTypeAbbrev )		; "Boiler - Gas or oil boiler"
								case  8 :	Format( "%.0f %s unit(s)", NumHeatSysUnits, HeatSysTypeAbbrev )		; "Electric - All electric heating systems other than heat pump"
								default :	Format( "%.0f %s unit(s)", NumHeatSysUnits, HeatSysTypeAbbrev )
							endswitch
					endif endif endif endif endif  }

	"Set HVACSys:HeatEquipIssue"		HVACSys:HeatEquipIssue		= {
					if (NumHeatSystemTypes <= 0) then  " "
					else if (NumHeatSystemTypes > 0 .AND. LocalCompAssigned( HeatSystem[1]  ) == 0) then  "All heating equipment assignments must be specified (first is excluded)"
					else if (NumHeatSystemTypes > 1 .AND. LocalCompAssigned( HeatSystem[2]  ) == 0) then  "All heating equipment assignments must be specified (second is excluded)"
					else if (NumHeatSystemTypes > 2 .AND. LocalCompAssigned( HeatSystem[3]  ) == 0) then  "All heating equipment assignments must be specified (third is excluded)"
					else if (NumHeatSystemTypes > 3 .AND. LocalCompAssigned( HeatSystem[4]  ) == 0) then  "All heating equipment assignments must be specified (fourth is excluded)"
					else if (NumHeatSystemTypes > 4 .AND. LocalCompAssigned( HeatSystem[5]  ) == 0) then  "All heating equipment assignments must be specified (fifth is excluded)"
					else if (NumHeatSystemTypes > 5 .AND. LocalCompAssigned( HeatSystem[6]  ) == 0) then  "All heating equipment assignments must be specified (sixth is excluded)"
					else if (NumHeatSystemTypes > 6 .AND. LocalCompAssigned( HeatSystem[7]  ) == 0) then  "All heating equipment assignments must be specified (seventh is excluded)"
					else if (NumHeatSystemTypes > 7 .AND. LocalCompAssigned( HeatSystem[8]  ) == 0) then  "All heating equipment assignments must be specified (eighth is excluded)"
					else if (NumHeatSystemTypes > 8 .AND. LocalCompAssigned( HeatSystem[9]  ) == 0) then  "All heating equipment assignments must be specified (ninth is excluded)"
					else if (NumHeatSystemTypes > 9 .AND. LocalCompAssigned( HeatSystem[10] ) == 0) then  "All heating equipment assignments must be specified (tenth is excluded)"
					else if (NumHeatSystemTypes > 1 .AND. HeatSystem[2]:Type  != HeatSystem[1]:Type) then  Format( "All assigned heating equipment must be of the same type (#1: %s / #2: %s)",  HeatSystem[1]:TypeAbbrevStr, HeatSystem[2]:TypeAbbrevStr )
					else if (NumHeatSystemTypes > 2 .AND. HeatSystem[3]:Type  != HeatSystem[1]:Type) then  Format( "All assigned heating equipment must be of the same type (#1: %s / #3: %s)",  HeatSystem[1]:TypeAbbrevStr, HeatSystem[3]:TypeAbbrevStr )
					else if (NumHeatSystemTypes > 3 .AND. HeatSystem[4]:Type  != HeatSystem[1]:Type) then  Format( "All assigned heating equipment must be of the same type (#1: %s / #4: %s)",  HeatSystem[1]:TypeAbbrevStr, HeatSystem[4]:TypeAbbrevStr )
					else if (NumHeatSystemTypes > 4 .AND. HeatSystem[5]:Type  != HeatSystem[1]:Type) then  Format( "All assigned heating equipment must be of the same type (#1: %s / #5: %s)",  HeatSystem[1]:TypeAbbrevStr, HeatSystem[5]:TypeAbbrevStr )
					else if (NumHeatSystemTypes > 5 .AND. HeatSystem[6]:Type  != HeatSystem[1]:Type) then  Format( "All assigned heating equipment must be of the same type (#1: %s / #6: %s)",  HeatSystem[1]:TypeAbbrevStr, HeatSystem[6]:TypeAbbrevStr )
					else if (NumHeatSystemTypes > 6 .AND. HeatSystem[7]:Type  != HeatSystem[1]:Type) then  Format( "All assigned heating equipment must be of the same type (#1: %s / #7: %s)",  HeatSystem[1]:TypeAbbrevStr, HeatSystem[7]:TypeAbbrevStr )
					else if (NumHeatSystemTypes > 7 .AND. HeatSystem[8]:Type  != HeatSystem[1]:Type) then  Format( "All assigned heating equipment must be of the same type (#1: %s / #8: %s)",  HeatSystem[1]:TypeAbbrevStr, HeatSystem[8]:TypeAbbrevStr )
					else if (NumHeatSystemTypes > 8 .AND. HeatSystem[9]:Type  != HeatSystem[1]:Type) then  Format( "All assigned heating equipment must be of the same type (#1: %s / #9: %s)",  HeatSystem[1]:TypeAbbrevStr, HeatSystem[9]:TypeAbbrevStr )
					else if (NumHeatSystemTypes > 9 .AND. HeatSystem[10]:Type != HeatSystem[1]:Type) then  Format( "All assigned heating equipment must be of the same type (#1: %s / #10: %s)", HeatSystem[1]:TypeAbbrevStr, HeatSystem[10]:TypeAbbrevStr )
					else  " "  endif endif endif endif endif endif endif endif endif endif endif endif endif endif endif endif endif endif endif endif  }


  ; More HVACSys cooling equipment summarization
   ; SAC 6/25/20 - revised logic to set HeatSysTypeAbbrev properly for Std, SMF & DR models (tic #1225 & #1226)
	"Set HVACSys:CoolSysTypeAbbrev"	HVACSys:CoolSysTypeAbbrev	=
      {  if (NumCoolSystemTypes > 0 .AND. LocalCompAssigned( CoolSystem[1] ))
         then  if (Proj:RunAbbrev == "s" .OR. Proj:RunAbbrev == "smf" .OR. Proj:RunAbbrev == "dr")
               then  T24RCoolingEquipment:StdSystem( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSystem[1]:TypeAbbrevStr )
               else  CoolSystem[1]:TypeAbbrevStr
               endif
         else  " "  endif  }
      ; SAC 6/26/20 - old logic
      ;   then  CoolSystem[1]:TypeAbbrevStr
      ;   else  " "  endif  }

; SAC 8/24/13 - moved Ducted* properties to HVACSys from HVACHeat
	"Default HVACSys:CoolDuctedEditable"	HVACSys:CoolDuctedEditable		= {	if (CoolSysType < 1 .OR. LocalCompAssigned( CoolSystem[1] ) == 0) then  0
																										else if (CoolSystem[1]:IsAvailable < 0.5) then  0
																										else if (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev ) < 0) then  1
																										else  0  endif endif endif  }
	; SAC 11/26/14 - added rule to blast user-specified CoolDucted if it is inconsistent w/ the DuctFlag value in the cooling equipment table
	"Force reset of CoolDucted if needed"	HVACSys:Action						= {	if (CoolDuctedEditable > 0.5 .OR. LocalStatus( CoolDucted ) < 6 .OR. CoolSysType < 1 .OR. LocalCompAssigned( CoolSystem[1] ) == 0) then  UNCHANGED
																										else if (CoolSystem[1]:IsAvailable < 0.5) then  UNCHANGED
																										else if (CoolDucted != T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev ))
																										then	EvalRulelist( "BlastUserUnput_HVACSys_CoolDucted", 1 )
																										else	UNCHANGED  endif endif endif  }
	; SAC 4/7/15 - added 4th if() to default to 1 if equipment is ductable (=-1) AND there is a valid duct system assigned to the system
	"Default HVACSys:CoolDucted"				HVACSys:CoolDucted				= {	if (CoolSysType < 1 .OR. LocalCompAssigned( CoolSystem[1] ) == 0) then  0
																										else if (CoolSystem[1]:IsAvailable < 0.5) then  0
																										else if (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev ) == 1) then  1
																										else if (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev ) == -1 .AND.
																													CoolSysType > 1 .AND. LocalCompAssigned( DistribSystem ) .AND. IfValidAnd( DistribSystem:Type > 0 ) .AND. IfValidAnd( DistribSystem:Type != 8 )) then  1
																										else  0  endif endif endif endif  }

	"Set HVACSys:ClSysSEER - 1"	HVACSys:ClSysSEER	= {	if (NumCoolSystemTypes > 0 .AND. IfValidAnd( CoolSystem[1]:SEER  >= 0 )) then                  CoolSystem[1]:SEER     else      0      endif  }
	"Set HVACSys:ClSysSEER - 2"	HVACSys:ClSysSEER	= {	if (NumCoolSystemTypes > 1 .AND. IfValidAnd( CoolSystem[2]:SEER  >= 0 )) then  min( ClSysSEER, CoolSystem[2]:SEER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSEER - 3"	HVACSys:ClSysSEER	= {	if (NumCoolSystemTypes > 2 .AND. IfValidAnd( CoolSystem[3]:SEER  >= 0 )) then  min( ClSysSEER, CoolSystem[3]:SEER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSEER - 4"	HVACSys:ClSysSEER	= {	if (NumCoolSystemTypes > 3 .AND. IfValidAnd( CoolSystem[4]:SEER  >= 0 )) then  min( ClSysSEER, CoolSystem[4]:SEER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSEER - 5"	HVACSys:ClSysSEER	= {	if (NumCoolSystemTypes > 4 .AND. IfValidAnd( CoolSystem[5]:SEER  >= 0 )) then  min( ClSysSEER, CoolSystem[5]:SEER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSEER - 6"	HVACSys:ClSysSEER	= {	if (NumCoolSystemTypes > 5 .AND. IfValidAnd( CoolSystem[6]:SEER  >= 0 )) then  min( ClSysSEER, CoolSystem[6]:SEER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSEER - 7"	HVACSys:ClSysSEER	= {	if (NumCoolSystemTypes > 6 .AND. IfValidAnd( CoolSystem[7]:SEER  >= 0 )) then  min( ClSysSEER, CoolSystem[7]:SEER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSEER - 8"	HVACSys:ClSysSEER	= {	if (NumCoolSystemTypes > 7 .AND. IfValidAnd( CoolSystem[8]:SEER  >= 0 )) then  min( ClSysSEER, CoolSystem[8]:SEER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSEER - 9"	HVACSys:ClSysSEER	= {	if (NumCoolSystemTypes > 8 .AND. IfValidAnd( CoolSystem[9]:SEER  >= 0 )) then  min( ClSysSEER, CoolSystem[9]:SEER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSEER - 10"	HVACSys:ClSysSEER	= {	if (NumCoolSystemTypes > 9 .AND. IfValidAnd( CoolSystem[10]:SEER >= 0 )) then  min( ClSysSEER, CoolSystem[10]:SEER )  else  UNCHANGED  endif  }

	"Set HVACSys:ClSysEER - 1"		HVACSys:ClSysEER	= {	if (NumCoolSystemTypes > 0 .AND. IfValidAnd( CoolSystem[1]:EER  >= 0 )) then                 CoolSystem[1]:EER     else      0      endif  }
	"Set HVACSys:ClSysEER - 2"		HVACSys:ClSysEER	= {	if (NumCoolSystemTypes > 1 .AND. IfValidAnd( CoolSystem[2]:EER  >= 0 )) then  min( ClSysEER, CoolSystem[2]:EER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysEER - 3"		HVACSys:ClSysEER	= {	if (NumCoolSystemTypes > 2 .AND. IfValidAnd( CoolSystem[3]:EER  >= 0 )) then  min( ClSysEER, CoolSystem[3]:EER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysEER - 4"		HVACSys:ClSysEER	= {	if (NumCoolSystemTypes > 3 .AND. IfValidAnd( CoolSystem[4]:EER  >= 0 )) then  min( ClSysEER, CoolSystem[4]:EER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysEER - 5"		HVACSys:ClSysEER	= {	if (NumCoolSystemTypes > 4 .AND. IfValidAnd( CoolSystem[5]:EER  >= 0 )) then  min( ClSysEER, CoolSystem[5]:EER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysEER - 6"		HVACSys:ClSysEER	= {	if (NumCoolSystemTypes > 5 .AND. IfValidAnd( CoolSystem[6]:EER  >= 0 )) then  min( ClSysEER, CoolSystem[6]:EER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysEER - 7"		HVACSys:ClSysEER	= {	if (NumCoolSystemTypes > 6 .AND. IfValidAnd( CoolSystem[7]:EER  >= 0 )) then  min( ClSysEER, CoolSystem[7]:EER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysEER - 8"		HVACSys:ClSysEER	= {	if (NumCoolSystemTypes > 7 .AND. IfValidAnd( CoolSystem[8]:EER  >= 0 )) then  min( ClSysEER, CoolSystem[8]:EER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysEER - 9"		HVACSys:ClSysEER	= {	if (NumCoolSystemTypes > 8 .AND. IfValidAnd( CoolSystem[9]:EER  >= 0 )) then  min( ClSysEER, CoolSystem[9]:EER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysEER - 10"	HVACSys:ClSysEER	= {	if (NumCoolSystemTypes > 9 .AND. IfValidAnd( CoolSystem[10]:EER >= 0 )) then  min( ClSysEER, CoolSystem[10]:EER )  else  UNCHANGED  endif  }

	"Set HVACSys:ClSysCFMperTon - 1"		HVACSys:ClSysCFMperTon	= {	if (NumCoolSystemTypes > 0 .AND. IfValidAnd( CoolSystem[1]:CFMperTon  >= 0 )) then                       CoolSystem[1]:CFMperTon     else      0      endif  }
	"Set HVACSys:ClSysCFMperTon - 2"		HVACSys:ClSysCFMperTon	= {	if (NumCoolSystemTypes > 1 .AND. IfValidAnd( CoolSystem[2]:CFMperTon  >= 0 )) then  min( ClSysCFMperTon, CoolSystem[2]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCFMperTon - 3"		HVACSys:ClSysCFMperTon	= {	if (NumCoolSystemTypes > 2 .AND. IfValidAnd( CoolSystem[3]:CFMperTon  >= 0 )) then  min( ClSysCFMperTon, CoolSystem[3]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCFMperTon - 4"		HVACSys:ClSysCFMperTon	= {	if (NumCoolSystemTypes > 3 .AND. IfValidAnd( CoolSystem[4]:CFMperTon  >= 0 )) then  min( ClSysCFMperTon, CoolSystem[4]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCFMperTon - 5"		HVACSys:ClSysCFMperTon	= {	if (NumCoolSystemTypes > 4 .AND. IfValidAnd( CoolSystem[5]:CFMperTon  >= 0 )) then  min( ClSysCFMperTon, CoolSystem[5]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCFMperTon - 6"		HVACSys:ClSysCFMperTon	= {	if (NumCoolSystemTypes > 5 .AND. IfValidAnd( CoolSystem[6]:CFMperTon  >= 0 )) then  min( ClSysCFMperTon, CoolSystem[6]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCFMperTon - 7"		HVACSys:ClSysCFMperTon	= {	if (NumCoolSystemTypes > 6 .AND. IfValidAnd( CoolSystem[7]:CFMperTon  >= 0 )) then  min( ClSysCFMperTon, CoolSystem[7]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCFMperTon - 8"		HVACSys:ClSysCFMperTon	= {	if (NumCoolSystemTypes > 7 .AND. IfValidAnd( CoolSystem[8]:CFMperTon  >= 0 )) then  min( ClSysCFMperTon, CoolSystem[8]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCFMperTon - 9"		HVACSys:ClSysCFMperTon	= {	if (NumCoolSystemTypes > 8 .AND. IfValidAnd( CoolSystem[9]:CFMperTon  >= 0 )) then  min( ClSysCFMperTon, CoolSystem[9]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCFMperTon - 10"	HVACSys:ClSysCFMperTon	= {	if (NumCoolSystemTypes > 9 .AND. IfValidAnd( CoolSystem[10]:CFMperTon >= 0 )) then  min( ClSysCFMperTon, CoolSystem[10]:CFMperTon )  else  UNCHANGED  endif  }

	"Set HVACSys:ClSysRefrigChgAdjFctr - 1"	HVACSys:ClSysRefrigChgAdjFctr	= {	if (NumCoolSystemTypes > 0 .AND. IfValidAnd( CoolSystem[1]:RefrigChgAdjFctr  >= 0 )) then                              CoolSystem[1]:RefrigChgAdjFctr     else      0      endif  }
	"Set HVACSys:ClSysRefrigChgAdjFctr - 2"	HVACSys:ClSysRefrigChgAdjFctr	= {	if (NumCoolSystemTypes > 1 .AND. IfValidAnd( CoolSystem[2]:RefrigChgAdjFctr  >= 0 )) then  min( ClSysRefrigChgAdjFctr, CoolSystem[2]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysRefrigChgAdjFctr - 3"	HVACSys:ClSysRefrigChgAdjFctr	= {	if (NumCoolSystemTypes > 2 .AND. IfValidAnd( CoolSystem[3]:RefrigChgAdjFctr  >= 0 )) then  min( ClSysRefrigChgAdjFctr, CoolSystem[3]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysRefrigChgAdjFctr - 4"	HVACSys:ClSysRefrigChgAdjFctr	= {	if (NumCoolSystemTypes > 3 .AND. IfValidAnd( CoolSystem[4]:RefrigChgAdjFctr  >= 0 )) then  min( ClSysRefrigChgAdjFctr, CoolSystem[4]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysRefrigChgAdjFctr - 5"	HVACSys:ClSysRefrigChgAdjFctr	= {	if (NumCoolSystemTypes > 4 .AND. IfValidAnd( CoolSystem[5]:RefrigChgAdjFctr  >= 0 )) then  min( ClSysRefrigChgAdjFctr, CoolSystem[5]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysRefrigChgAdjFctr - 6"	HVACSys:ClSysRefrigChgAdjFctr	= {	if (NumCoolSystemTypes > 5 .AND. IfValidAnd( CoolSystem[6]:RefrigChgAdjFctr  >= 0 )) then  min( ClSysRefrigChgAdjFctr, CoolSystem[6]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysRefrigChgAdjFctr - 7"	HVACSys:ClSysRefrigChgAdjFctr	= {	if (NumCoolSystemTypes > 6 .AND. IfValidAnd( CoolSystem[7]:RefrigChgAdjFctr  >= 0 )) then  min( ClSysRefrigChgAdjFctr, CoolSystem[7]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysRefrigChgAdjFctr - 8"	HVACSys:ClSysRefrigChgAdjFctr	= {	if (NumCoolSystemTypes > 7 .AND. IfValidAnd( CoolSystem[8]:RefrigChgAdjFctr  >= 0 )) then  min( ClSysRefrigChgAdjFctr, CoolSystem[8]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysRefrigChgAdjFctr - 9"	HVACSys:ClSysRefrigChgAdjFctr	= {	if (NumCoolSystemTypes > 8 .AND. IfValidAnd( CoolSystem[9]:RefrigChgAdjFctr  >= 0 )) then  min( ClSysRefrigChgAdjFctr, CoolSystem[9]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysRefrigChgAdjFctr - 10"	HVACSys:ClSysRefrigChgAdjFctr	= {	if (NumCoolSystemTypes > 9 .AND. IfValidAnd( CoolSystem[10]:RefrigChgAdjFctr >= 0 )) then  min( ClSysRefrigChgAdjFctr, CoolSystem[10]:RefrigChgAdjFctr )  else  UNCHANGED  endif  }

; RULES TO SUMMARIZE ADDIITONAL COOLING PERFORMANCE PARAMETERS PASSED INTO CSE FOR SIMULATION

	"Set HVACSys:ClSysSizingFactor - 1"		HVACSys:ClSysSizingFactor	= {	if (NumCoolSystemTypes > 0 .AND. LocalCompAssigned( CoolSystem[1]  ) .AND. CoolSystemCount[1]  > 0) then                      (CoolSystem[1]:SizingFactor  * CoolSystemCount[1] )  else      0      endif  }
	"Set HVACSys:ClSysSizingFactor - 2"		HVACSys:ClSysSizingFactor	= {	if (NumCoolSystemTypes > 1 .AND. LocalCompAssigned( CoolSystem[2]  ) .AND. CoolSystemCount[2]  > 0) then  ClSysSizingFactor + (CoolSystem[2]:SizingFactor  * CoolSystemCount[2] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSizingFactor - 3"		HVACSys:ClSysSizingFactor	= {	if (NumCoolSystemTypes > 2 .AND. LocalCompAssigned( CoolSystem[3]  ) .AND. CoolSystemCount[3]  > 0) then  ClSysSizingFactor + (CoolSystem[3]:SizingFactor  * CoolSystemCount[3] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSizingFactor - 4"		HVACSys:ClSysSizingFactor	= {	if (NumCoolSystemTypes > 3 .AND. LocalCompAssigned( CoolSystem[4]  ) .AND. CoolSystemCount[4]  > 0) then  ClSysSizingFactor + (CoolSystem[4]:SizingFactor  * CoolSystemCount[4] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSizingFactor - 5"		HVACSys:ClSysSizingFactor	= {	if (NumCoolSystemTypes > 4 .AND. LocalCompAssigned( CoolSystem[5]  ) .AND. CoolSystemCount[5]  > 0) then  ClSysSizingFactor + (CoolSystem[5]:SizingFactor  * CoolSystemCount[5] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSizingFactor - 6"		HVACSys:ClSysSizingFactor	= {	if (NumCoolSystemTypes > 5 .AND. LocalCompAssigned( CoolSystem[6]  ) .AND. CoolSystemCount[6]  > 0) then  ClSysSizingFactor + (CoolSystem[6]:SizingFactor  * CoolSystemCount[6] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSizingFactor - 7"		HVACSys:ClSysSizingFactor	= {	if (NumCoolSystemTypes > 6 .AND. LocalCompAssigned( CoolSystem[7]  ) .AND. CoolSystemCount[7]  > 0) then  ClSysSizingFactor + (CoolSystem[7]:SizingFactor  * CoolSystemCount[7] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSizingFactor - 8"		HVACSys:ClSysSizingFactor	= {	if (NumCoolSystemTypes > 7 .AND. LocalCompAssigned( CoolSystem[8]  ) .AND. CoolSystemCount[8]  > 0) then  ClSysSizingFactor + (CoolSystem[8]:SizingFactor  * CoolSystemCount[8] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSizingFactor - 9"		HVACSys:ClSysSizingFactor	= {	if (NumCoolSystemTypes > 8 .AND. LocalCompAssigned( CoolSystem[9]  ) .AND. CoolSystemCount[9]  > 0) then  ClSysSizingFactor + (CoolSystem[9]:SizingFactor  * CoolSystemCount[9] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSizingFactor - 10"	HVACSys:ClSysSizingFactor	= {	if (NumCoolSystemTypes > 9 .AND. LocalCompAssigned( CoolSystem[10] ) .AND. CoolSystemCount[10] > 0) then  ClSysSizingFactor + (CoolSystem[10]:SizingFactor * CoolSystemCount[10])  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSizingFactor - XX"	HVACSys:ClSysSizingFactor	= {	if (NumCoolSysUnits > 0.5) then  ClSysSizingFactor / NumCoolSysUnits  else  UNCHANGED  endif  }

	"Set HVACSys:ClSysCapacity - 1"		HVACSys:ClSysCapacity	= {	if (AutoSizeCool[1]  == 0 .AND. NumCoolSystemTypes > 0 .AND. LocalCompAssigned( CoolSystem[1]  ) .AND. CoolSystemCount[1]  > 0) then                  (CoolSystem[1]:TotalCapacity  * CoolSystemCount[1] )  else      0      endif  }
	"Set HVACSys:ClSysCapacity - 2"		HVACSys:ClSysCapacity	= {	if (AutoSizeCool[2]  == 0 .AND. NumCoolSystemTypes > 1 .AND. LocalCompAssigned( CoolSystem[2]  ) .AND. CoolSystemCount[2]  > 0) then  ClSysCapacity + (CoolSystem[2]:TotalCapacity  * CoolSystemCount[2] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCapacity - 3" 		HVACSys:ClSysCapacity	= {	if (AutoSizeCool[3]  == 0 .AND. NumCoolSystemTypes > 2 .AND. LocalCompAssigned( CoolSystem[3]  ) .AND. CoolSystemCount[3]  > 0) then  ClSysCapacity + (CoolSystem[3]:TotalCapacity  * CoolSystemCount[3] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCapacity - 4" 		HVACSys:ClSysCapacity	= {	if (AutoSizeCool[4]  == 0 .AND. NumCoolSystemTypes > 3 .AND. LocalCompAssigned( CoolSystem[4]  ) .AND. CoolSystemCount[4]  > 0) then  ClSysCapacity + (CoolSystem[4]:TotalCapacity  * CoolSystemCount[4] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCapacity - 5" 		HVACSys:ClSysCapacity	= {	if (AutoSizeCool[5]  == 0 .AND. NumCoolSystemTypes > 4 .AND. LocalCompAssigned( CoolSystem[5]  ) .AND. CoolSystemCount[5]  > 0) then  ClSysCapacity + (CoolSystem[5]:TotalCapacity  * CoolSystemCount[5] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCapacity - 6" 		HVACSys:ClSysCapacity	= {	if (AutoSizeCool[6]  == 0 .AND. NumCoolSystemTypes > 5 .AND. LocalCompAssigned( CoolSystem[6]  ) .AND. CoolSystemCount[6]  > 0) then  ClSysCapacity + (CoolSystem[6]:TotalCapacity  * CoolSystemCount[6] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCapacity - 7" 		HVACSys:ClSysCapacity	= {	if (AutoSizeCool[7]  == 0 .AND. NumCoolSystemTypes > 6 .AND. LocalCompAssigned( CoolSystem[7]  ) .AND. CoolSystemCount[7]  > 0) then  ClSysCapacity + (CoolSystem[7]:TotalCapacity  * CoolSystemCount[7] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCapacity - 8" 		HVACSys:ClSysCapacity	= {	if (AutoSizeCool[8]  == 0 .AND. NumCoolSystemTypes > 7 .AND. LocalCompAssigned( CoolSystem[8]  ) .AND. CoolSystemCount[8]  > 0) then  ClSysCapacity + (CoolSystem[8]:TotalCapacity  * CoolSystemCount[8] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCapacity - 9" 		HVACSys:ClSysCapacity	= {	if (AutoSizeCool[9]  == 0 .AND. NumCoolSystemTypes > 8 .AND. LocalCompAssigned( CoolSystem[9]  ) .AND. CoolSystemCount[9]  > 0) then  ClSysCapacity + (CoolSystem[9]:TotalCapacity  * CoolSystemCount[9] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCapacity - 10"		HVACSys:ClSysCapacity	= {	if (AutoSizeCool[10] == 0 .AND. NumCoolSystemTypes > 9 .AND. LocalCompAssigned( CoolSystem[10] ) .AND. CoolSystemCount[10] > 0) then  ClSysCapacity + (CoolSystem[10]:TotalCapacity * CoolSystemCount[10])  else  UNCHANGED  endif  }

	"Set HVACSys:CoolEquipSummary"	HVACSys:CoolEquipSummary	=              ; SAC 6/21/20 - prevent reporting SEER when not valid input (tic #1226)   ; SAC 08/19/20 (tic #1003)   ; SAC 08/31/20 (tic #1003)
				{	if (NumCoolSystemTypes <= 0) then  " "
					else if (NumCoolSysUnits < 1) then  "No cooling equipment units (counts) defined"
					else if (LocalCompAssigned( CoolSystem[1] ) == 0) then  "Cooling equipment assignment #1 not defined"
					else if (CoolSystem[1]:IsAvailable > 0 .AND. IfValidAnd( CoolSystem[1]:ShowCEER > 0 ))
					then	Format( "%.0f %s unit(s), %.1f CEER", NumCoolSysUnits, CoolSysTypeAbbrev, CoolSystem[1]:CEER )
					else if (CoolSystem[1]:IsAvailable > 0 .AND. IfValidAnd( CoolSystem[1]:ShowSEER > 0 )==0 .AND.
                        (CoolSystem[1]:Type == 5 .OR. CoolSystem[1]:Type == 25))
					then	Format( "%.0f %s unit(s), %.1f EER", NumCoolSysUnits, CoolSysTypeAbbrev, ClSysEER )
					else if (CoolSystem[1]:IsAvailable > 0 .AND. IfValidAnd( CoolSystem[1]:ShowSEER > 0 )==0)
					then	Format( "%.0f %s unit(s), %.1f EER, %.1f CFM/ton", NumCoolSysUnits, CoolSysTypeAbbrev, ClSysEER, ClSysCFMperTon )
					else if (CoolSystem[1]:IsAvailable > 0)
					then	Format( "%.0f %s unit(s), %.1f SEER, %.1f EER, %.1f CFM/ton", NumCoolSysUnits, CoolSysTypeAbbrev, ClSysSEER, ClSysEER, ClSysCFMperTon )
					else	Format( "%.0f %s unit(s)", NumCoolSysUnits, CoolSysTypeAbbrev )
					endif endif endif endif endif endif endif  }

  ; SAC 6/4/14 - modified rule to check consistency between each assigned sys [2-N] w/ sys[1]:TypeRpt (rather than :Type), since No Cooling case will override user's sys[1] w/ a std design cooling system
	"Set HVACSys:CoolEquipIssue"		HVACSys:CoolEquipIssue		= {
					if (NumCoolSystemTypes <= 0) then  " "
					else if (NumCoolSystemTypes > 0 .AND. LocalCompAssigned( CoolSystem[1]  ) == 0) then  "All cooling equipment assignments must be specified (first is excluded)"
					else if (NumCoolSystemTypes > 1 .AND. LocalCompAssigned( CoolSystem[2]  ) == 0) then  "All cooling equipment assignments must be specified (second is excluded)"
					else if (NumCoolSystemTypes > 2 .AND. LocalCompAssigned( CoolSystem[3]  ) == 0) then  "All cooling equipment assignments must be specified (third is excluded)"
					else if (NumCoolSystemTypes > 3 .AND. LocalCompAssigned( CoolSystem[4]  ) == 0) then  "All cooling equipment assignments must be specified (fourth is excluded)"
					else if (NumCoolSystemTypes > 4 .AND. LocalCompAssigned( CoolSystem[5]  ) == 0) then  "All cooling equipment assignments must be specified (fifth is excluded)"
					else if (NumCoolSystemTypes > 5 .AND. LocalCompAssigned( CoolSystem[6]  ) == 0) then  "All cooling equipment assignments must be specified (sixth is excluded)"
					else if (NumCoolSystemTypes > 6 .AND. LocalCompAssigned( CoolSystem[7]  ) == 0) then  "All cooling equipment assignments must be specified (seventh is excluded)"
					else if (NumCoolSystemTypes > 7 .AND. LocalCompAssigned( CoolSystem[8]  ) == 0) then  "All cooling equipment assignments must be specified (eighth is excluded)"
					else if (NumCoolSystemTypes > 8 .AND. LocalCompAssigned( CoolSystem[9]  ) == 0) then  "All cooling equipment assignments must be specified (ninth is excluded)"
					else if (NumCoolSystemTypes > 9 .AND. LocalCompAssigned( CoolSystem[10] ) == 0) then  "All cooling equipment assignments must be specified (tenth is excluded)"
					else if (NumCoolSystemTypes > 1 .AND. CoolSystem[2]:Type  != CoolSystem[1]:TypeRpt) then  Format( "All assigned cooling equipment must be of the same type (#1: %s / #2: %s)",  CoolSystem[1]:TypeAbbrevStr, CoolSystem[2]:TypeAbbrevStr )
					else if (NumCoolSystemTypes > 2 .AND. CoolSystem[3]:Type  != CoolSystem[1]:TypeRpt) then  Format( "All assigned cooling equipment must be of the same type (#1: %s / #3: %s)",  CoolSystem[1]:TypeAbbrevStr, CoolSystem[3]:TypeAbbrevStr )
					else if (NumCoolSystemTypes > 3 .AND. CoolSystem[4]:Type  != CoolSystem[1]:TypeRpt) then  Format( "All assigned cooling equipment must be of the same type (#1: %s / #4: %s)",  CoolSystem[1]:TypeAbbrevStr, CoolSystem[4]:TypeAbbrevStr )
					else if (NumCoolSystemTypes > 4 .AND. CoolSystem[5]:Type  != CoolSystem[1]:TypeRpt) then  Format( "All assigned cooling equipment must be of the same type (#1: %s / #5: %s)",  CoolSystem[1]:TypeAbbrevStr, CoolSystem[5]:TypeAbbrevStr )
					else if (NumCoolSystemTypes > 5 .AND. CoolSystem[6]:Type  != CoolSystem[1]:TypeRpt) then  Format( "All assigned cooling equipment must be of the same type (#1: %s / #6: %s)",  CoolSystem[1]:TypeAbbrevStr, CoolSystem[6]:TypeAbbrevStr )
					else if (NumCoolSystemTypes > 6 .AND. CoolSystem[7]:Type  != CoolSystem[1]:TypeRpt) then  Format( "All assigned cooling equipment must be of the same type (#1: %s / #7: %s)",  CoolSystem[1]:TypeAbbrevStr, CoolSystem[7]:TypeAbbrevStr )
					else if (NumCoolSystemTypes > 7 .AND. CoolSystem[8]:Type  != CoolSystem[1]:TypeRpt) then  Format( "All assigned cooling equipment must be of the same type (#1: %s / #8: %s)",  CoolSystem[1]:TypeAbbrevStr, CoolSystem[8]:TypeAbbrevStr )
					else if (NumCoolSystemTypes > 8 .AND. CoolSystem[9]:Type  != CoolSystem[1]:TypeRpt) then  Format( "All assigned cooling equipment must be of the same type (#1: %s / #9: %s)",  CoolSystem[1]:TypeAbbrevStr, CoolSystem[9]:TypeAbbrevStr )
					else if (NumCoolSystemTypes > 9 .AND. CoolSystem[10]:Type != CoolSystem[1]:TypeRpt) then  Format( "All assigned cooling equipment must be of the same type (#1: %s / #10: %s)", CoolSystem[1]:TypeAbbrevStr, CoolSystem[10]:TypeAbbrevStr )
					else  " "  endif endif endif endif endif endif endif endif endif endif endif endif endif endif endif endif endif endif endif endif  }

; SAC 8/23/13 - moved ConstHtgSetpt from HVACHeat as part of HVAHeat array mods
	"Default HVACSys:ConstHtgSetpt"		HVACSys:ConstHtgSetpt	= {	if (strlen( HeatSysTypeAbbrev ) < 2) then  -1
																							else  T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HeatSysTypeAbbrev )  endif  }
	"Init HVACSys:ConstClgSetpt"			HVACSys:ConstClgSetpt	= {	UNDEFINED  }

	"Set HVACSys:EqpCountsMustAlign"		HVACSys:EqpCountsMustAlign	= {	if (HeatDucted > 0.5 .AND. (CoolDucted > 0.5 .OR. NumCoolSystemTypes <= 0 .OR.
																																	 LocalCompAssigned( CoolSystem[1] ) == 0 .OR. IfValidAnd( CoolSystem[1]:Type == 1 ))) then  1  else  0  endif  }
																	; SAC 4/30/15 - revised logic to require equipment alignment if HeatDucted and there is No Cooling (related to issue 517)
																	;							if (HeatDucted > 0.5 .AND. CoolDucted > 0.5) then  1  else  0  endif  }

	; SAC 5/3/16 - added new flag to facilitate HERS flag for zonal systems w/ bypass ducts (tic #634)
	"Set HVACSys:ZonalSysBypassDuct"		HVACSys:ZonalSysBypassDuct	= {
								if (FloorAreaServed[1] < 1 .OR. (HeatDucted < 0.5 .AND. CoolDucted < 0.5) .OR. LocalCompAssigned( DistribSystem ) < 1) then  0
								else if (IfValidAnd( DistribSystem:HasBypassDuct > 0.5 )==0 .OR. IfValidAnd( DistribSystem:DuctsPresent > 0.5 )==0) then  0
								else if (NumCoolSystemTypes >=  1 .AND. IfValidAnd( CoolSystem[1]:IsZonal  > 0.5 ) .AND. IfValidAnd( CoolSystem[1]:ShowIsZonal  > 0.5 )) then  1
								else if (NumCoolSystemTypes >=  2 .AND. IfValidAnd( CoolSystem[2]:IsZonal  > 0.5 ) .AND. IfValidAnd( CoolSystem[2]:ShowIsZonal  > 0.5 )) then  1
								else if (NumCoolSystemTypes >=  3 .AND. IfValidAnd( CoolSystem[3]:IsZonal  > 0.5 ) .AND. IfValidAnd( CoolSystem[3]:ShowIsZonal  > 0.5 )) then  1
								else if (NumCoolSystemTypes >=  4 .AND. IfValidAnd( CoolSystem[4]:IsZonal  > 0.5 ) .AND. IfValidAnd( CoolSystem[4]:ShowIsZonal  > 0.5 )) then  1
								else if (NumCoolSystemTypes >=  5 .AND. IfValidAnd( CoolSystem[5]:IsZonal  > 0.5 ) .AND. IfValidAnd( CoolSystem[5]:ShowIsZonal  > 0.5 )) then  1
								else if (NumCoolSystemTypes >=  6 .AND. IfValidAnd( CoolSystem[6]:IsZonal  > 0.5 ) .AND. IfValidAnd( CoolSystem[6]:ShowIsZonal  > 0.5 )) then  1
								else if (NumCoolSystemTypes >=  7 .AND. IfValidAnd( CoolSystem[7]:IsZonal  > 0.5 ) .AND. IfValidAnd( CoolSystem[7]:ShowIsZonal  > 0.5 )) then  1
								else if (NumCoolSystemTypes >=  8 .AND. IfValidAnd( CoolSystem[8]:IsZonal  > 0.5 ) .AND. IfValidAnd( CoolSystem[8]:ShowIsZonal  > 0.5 )) then  1
								else if (NumCoolSystemTypes >=  9 .AND. IfValidAnd( CoolSystem[9]:IsZonal  > 0.5 ) .AND. IfValidAnd( CoolSystem[9]:ShowIsZonal  > 0.5 )) then  1
								else if (NumCoolSystemTypes >= 10 .AND. IfValidAnd( CoolSystem[10]:IsZonal > 0.5 ) .AND. IfValidAnd( CoolSystem[10]:ShowIsZonal > 0.5 )) then  1
								else	0  endif endif endif endif endif endif endif endif endif endif endif endif  }

	"Init HVACSys:HtPumpDucted"       HVACSys:HtPumpDucted      = {	0  }
	"Init HVACSys:HaveHtPump"         HVACSys:HaveHtPump        = {	0  }
	"Init HVACSys:HtPumpEquipIssue"   HVACSys:HtPumpEquipIssue  = {	UNDEFINED  }
	"Init HVACSys:HPSysHSPF"          HVACSys:HPSysHSPF         = {	UNDEFINED  }
	"Init HVACSys:HPSysAutoSize"      HVACSys:HPSysAutoSize     = {	UNDEFINED  }
	"Init HVACSys:HPSysCap47"         HVACSys:HPSysCap47        = {	UNDEFINED  }
	"Init HVACSys:HPSysMinCap47"      HVACSys:HPSysMinCap47     = {	UNDEFINED  }
	"Init HVACSys:HPSysCap35"         HVACSys:HPSysCap35        = {	UNDEFINED  }
	"Init HVACSys:HPSysCap17"         HVACSys:HPSysCap17        = {	UNDEFINED  }
	"Init HVACSys:HPSysCOP47"         HVACSys:HPSysCOP47        = {	UNDEFINED  }
	"Init HVACSys:HPSysCOP35"         HVACSys:HPSysCOP35        = {	UNDEFINED  }
	"Init HVACSys:HPSysCOP17"         HVACSys:HPSysCOP17        = {	UNDEFINED  }
	"Init HVACSys:HPSysAuxHtgCap"     HVACSys:HPSysAuxHtgCap    = {	UNDEFINED  }
	"Init HVACSys:HPSysVCHPFanPwr"    HVACSys:HPSysVCHPFanPwr   = {	UNDEFINED  }
	"Init HVACSys:HPModelDualFuel"    HVACSys:HPModelDualFuel   = {	UNDEFINED  }
	"Init HVACSys:HPDFAFUE"           HVACSys:HPDFAFUE          = {	UNDEFINED  }
	"Init HVACSys:HPLockoutTemp"      HVACSys:HPLockoutTemp     = {	UNDEFINED  }
   "Init HVACSys:LrgHtPumpStdFanPwr" HVACSys:LrgHtPumpStdFanPwr =    ; 2022 - SAC 03/11/21  ; SAC 03/15/21
      {  if (Proj:RunAbbrev == "s" .OR. Proj:RunAbbrev == "smf" .OR. Proj:RunAbbrev == "dr")
         then  UNCHANGED
         else  0  endif  }
   "Init HVACSys:PropHtPumpAutoSz"   HVACSys:PropHtPumpAutoSz  =     ; 2022 - SAC 03/11/21  ; SAC 03/15/21
      {  if (Proj:RunAbbrev == "s" .OR. Proj:RunAbbrev == "smf" .OR. Proj:RunAbbrev == "dr")
         then  UNCHANGED
         else  0  endif  }

	"Initialize other generic properties (common to Ht/Cl/HP)"		HVACSys:Action	= {	EvalRulelist( "SetupHVACSys_Round2_common", 1 )  }

; mjb 7/29/14	-	set flag if CoolSystem == EvapCond
	"Set HVACSys:HaveEvapCond"			HVACSys:HaveEvapCond			= {	if (NumCoolSystemTypes <= 0) then  0  
																								else if (CoolSystem[1]:Type == 14) then 1 else 0 endif endif	}
; mjb 7/29/14	-	calculate HVACSys average evaporative effectiveness
;	"Set HVACSys:SysEvapCondEff round 1"			HVACSys:SysEvapCondEff		= {	switch (NumCoolSystemTypes) 
;																								case  0 :  UNDEFINED   
;																								case  1 :  CoolSystem[1]:EvapCondEff   
;																								case  2 :  (CoolSystem[1]:EvapCondEff * CoolSystem[1]:FloorAreaServed) + (CoolSystem[2]:EvapCondEff * CoolSystem[2]:FloorAreaServed)  
;																								case  3 :  (CoolSystem[1]:EvapCondEff * CoolSystem[1]:FloorAreaServed) + (CoolSystem[2]:EvapCondEff * CoolSystem[2]:FloorAreaServed) + (CoolSystem[3]:EvapCondEff * CoolSystem[3]:FloorAreaServed)  
;																								case  4 :  (CoolSystem[1]:EvapCondEff * CoolSystem[1]:FloorAreaServed) + (CoolSystem[2]:EvapCondEff * CoolSystem[2]:FloorAreaServed) + (CoolSystem[3]:EvapCondEff * CoolSystem[3]:FloorAreaServed) + (CoolSystem[4]:EvapCondEff * CoolSystem[4]:FloorAreaServed)  
;																								case  5 :  (CoolSystem[1]:EvapCondEff * CoolSystem[1]:FloorAreaServed) + (CoolSystem[2]:EvapCondEff * CoolSystem[2]:FloorAreaServed) + (CoolSystem[3]:EvapCondEff * CoolSystem[3]:FloorAreaServed) + (CoolSystem[4]:EvapCondEff * CoolSystem[4]:FloorAreaServed) + (CoolSystem[5]:EvapCondEff * CoolSystem[5]:FloorAreaServed)  
;																								case  6 :  (CoolSystem[1]:EvapCondEff * CoolSystem[1]:FloorAreaServed) + (CoolSystem[2]:EvapCondEff * CoolSystem[2]:FloorAreaServed) + (CoolSystem[3]:EvapCondEff * CoolSystem[3]:FloorAreaServed) + (CoolSystem[4]:EvapCondEff * CoolSystem[4]:FloorAreaServed) + (CoolSystem[5]:EvapCondEff * CoolSystem[5]:FloorAreaServed)  
;																												+ (CoolSystem[6]:EvapCondEff * CoolSystem[6]:FloorAreaServed)
;																								case  7 :  (CoolSystem[1]:EvapCondEff * CoolSystem[1]:FloorAreaServed) + (CoolSystem[2]:EvapCondEff * CoolSystem[2]:FloorAreaServed) + (CoolSystem[3]:EvapCondEff * CoolSystem[3]:FloorAreaServed) + (CoolSystem[4]:EvapCondEff * CoolSystem[4]:FloorAreaServed) + (CoolSystem[5]:EvapCondEff * CoolSystem[5]:FloorAreaServed)  
;																												+ (CoolSystem[6]:EvapCondEff * CoolSystem[6]:FloorAreaServed) + (CoolSystem[7]:EvapCondEff * CoolSystem[7]:FloorAreaServed)
;																								case  8 :  (CoolSystem[1]:EvapCondEff * CoolSystem[1]:FloorAreaServed) + (CoolSystem[2]:EvapCondEff * CoolSystem[2]:FloorAreaServed) + (CoolSystem[3]:EvapCondEff * CoolSystem[3]:FloorAreaServed) + (CoolSystem[4]:EvapCondEff * CoolSystem[4]:FloorAreaServed) + (CoolSystem[5]:EvapCondEff * CoolSystem[5]:FloorAreaServed)  
;																												+ (CoolSystem[6]:EvapCondEff * CoolSystem[6]:FloorAreaServed) + (CoolSystem[7]:EvapCondEff * CoolSystem[7]:FloorAreaServed) + (CoolSystem[8]:EvapCondEff * CoolSystem[8]:FloorAreaServed)
;																								case  9 :  (CoolSystem[1]:EvapCondEff * CoolSystem[1]:FloorAreaServed) + (CoolSystem[2]:EvapCondEff * CoolSystem[2]:FloorAreaServed) + (CoolSystem[3]:EvapCondEff * CoolSystem[3]:FloorAreaServed) + (CoolSystem[4]:EvapCondEff * CoolSystem[4]:FloorAreaServed) + (CoolSystem[5]:EvapCondEff * CoolSystem[5]:FloorAreaServed)  
;																												+ (CoolSystem[6]:EvapCondEff * CoolSystem[6]:FloorAreaServed) + (CoolSystem[7]:EvapCondEff * CoolSystem[7]:FloorAreaServed) + (CoolSystem[8]:EvapCondEff * CoolSystem[8]:FloorAreaServed) + (CoolSystem[9]:EvapCondEff * CoolSystem[9]:FloorAreaServed)
;																								case  10 :  (CoolSystem[1]:EvapCondEff * CoolSystem[1]:FloorAreaServed) + (CoolSystem[2]:EvapCondEff * CoolSystem[2]:FloorAreaServed) + (CoolSystem[3]:EvapCondEff * CoolSystem[3]:FloorAreaServed) + (CoolSystem[4]:EvapCondEff * CoolSystem[4]:FloorAreaServed) + (CoolSystem[5]:EvapCondEff * CoolSystem[5]:FloorAreaServed)  
;																												+ (CoolSystem[6]:EvapCondEff * CoolSystem[6]:FloorAreaServed) + (CoolSystem[7]:EvapCondEff * CoolSystem[7]:FloorAreaServed) + (CoolSystem[8]:EvapCondEff * CoolSystem[8]:FloorAreaServed) + (CoolSystem[9]:EvapCondEff * CoolSystem[9]:FloorAreaServed)+ (CoolSystem[10]:EvapCondEff * CoolSystem[10]:FloorAreaServed)
;																								default :  CoolSystem[1]:EvapCondEff   
;																							endswitch  }
;	"Set HVACSys:SysEvapCondEff round 2"			HVACSys:SysEvapCondEff		= {	if (NumCoolSystemTypes > 1) then SysEvapCondEff / FloorAreaServed else UNCHANGED endif	}
;	"Set HVACSys:SysEvapCondEff round 3"			HVACSys:SysEvapCondEff		= {	if (HaveEvapCond > 0) then UNCHANGED else UNDEFINED endif	}

END

; SAC 8/24/13 - setup secondary set of HVACSys Heat/Cool/HtPump assignment properties
;*************************************************************************
RULELIST "SetupHVACSys_Round2_HeatPump" 0 0 0 0
;*************************************************************************
;	"debug HtPumpSystem[1]:TypeAbbrevStr"		HVACSys:Action		= {	PostWarning( "HtPumpSystem[1]:TypeAbbrevStr '%s'", HtPumpSystem[1]:TypeAbbrevStr )  }
   ; SAC 6/25/20 - revised logic to set HtPumpSysTypeAbbrev properly for Std, SMF & DR models (tic #1225 & #1226)
   ; revised logic to ensure HtPumpSysTypeAbbrev NOT updated for Existing systems in Std, SMF & DR models - SAC 06/24/21
	"Set HVACSys:HtPumpSysTypeAbbrev"	HVACSys:HtPumpSysTypeAbbrev	=
      {  if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1] ))
         then  if (Proj:RunAbbrev == "s" .OR. Proj:RunAbbrev == "smf" .OR. Proj:RunAbbrev == "dr")
               then  if ((Proj:RunScope == 2 .OR. Proj:IsAddAlone > 0.5) .AND. MinRevRef( Zone:ActiveHVACSystem, Zone:HVACSysStatus ) < 2)
                     then  UNCHANGED
                     else if (HtOrClDucted < 0.5)
                     then T24RHeatingEquipment:DuctlessStdSys( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSystem[1]:TypeAbbrevStr )
                     else T24RHeatingEquipment:DuctedStdSys(   "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSystem[1]:TypeAbbrevStr )
                     endif endif
               else  HtPumpSystem[1]:TypeAbbrevStr
               endif
         else  " "  endif  }
      ; SAC 6/26/20 - old logic
      ;   then  HtPumpSystem[1]:TypeAbbrevStr
      ;   else  " "  endif  }

	"Default HVACSys:HtPumpDuctedEditable"		HVACSys:HtPumpDuctedEditable	= {	if (HtPumpSysType < 1 .OR. LocalCompAssigned( HtPumpSystem[1] ) == 0) then  0
																											else if (HtPumpSystem[1]:IsAvailable < 0.5) then  0
																											else if (T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) < 0) then  1
																											else  0  endif endif endif  }
	; SAC 11/26/14 - added rule to blast user-specified HtPumpDucted if it is inconsistent w/ the DuctFlag value in the heat pump equipment table
	"Force reset of HtPumpDucted if needed"	HVACSys:Action						= {	if (HtPumpDuctedEditable > 0.5 .OR. LocalStatus( HtPumpDucted ) < 6 .OR. HtPumpSysType < 1 .OR. LocalCompAssigned( HtPumpSystem[1] ) == 0) then  UNCHANGED
																											else if (HtPumpSystem[1]:IsAvailable < 0.5) then  UNCHANGED
																											else if (HtPumpDucted != T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ))
																											then	EvalRulelist( "BlastUserUnput_HVACSys_HtPumpDucted", 1 )
																											else	UNCHANGED  endif endif endif  }
	; SAC 4/7/15 - added 4th if() to default to 1 if equipment is ductable (=-1) AND there is a valid duct system assigned to the system
	"Default HVACSys:HtPumpDucted"				HVACSys:HtPumpDucted				= {	if (HtPumpSysType < 1 .OR. LocalCompAssigned( HtPumpSystem[1] ) == 0) then  0
																											else if (HtPumpSystem[1]:IsAvailable < 0.5) then  0
																											else if (T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) == 1) then  1
																											else if (T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) == -1 .AND.
																														LocalCompAssigned( DistribSystem ) .AND. IfValidAnd( DistribSystem:Type > 0 ) .AND. IfValidAnd( DistribSystem:Type != 8 )) then  1
																											else  0  endif endif endif endif  }

;	"debug Duct Flag"		HVACSys:Action		= {	MessageBox( "check HtPumpDucted %g", HVACSys:HtPumpDucted )  }

  ; SAC 1/18/16 - revised rules to force override of HVACSys:HeatDucted & CoolDucted if they are user-defiend and inconsistent w/ HtPumpDucted (to fix HERS AHUAirFlow reporting bug)
	"Set HVACSys:HeatDucted"		HVACSys:Action			= {	if (IfValidAnd( HeatDucted = HtPumpDucted )) then  UNCHANGED
																				else	EvalRulelist( "Force_HVACSys_HeatDucted_HtPumpDucted", 1 )  endif  }
	"Set HVACSys:CoolDucted"		HVACSys:Action			= {	if (IfValidAnd( CoolDucted = HtPumpDucted )) then  UNCHANGED
																				else	EvalRulelist( "Force_HVACSys_CoolDucted_HtPumpDucted", 1 )  endif  }
;	"debug Duct Flag"		HVACSys:Action		= {	MessageBox( "check #1 CoolDucted %g HeatDucted %g", HVACSys:CoolDucted, HVACSys:HeatDucted )  }

	"Set HVACSys:HPSysHSPF - 1"	HVACSys:HPSysHSPF	= {	if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) .AND. IfValidAnd( HtPumpSystem[1]:HSPF  > 0 )) then                  HtPumpSystem[1]:HSPF     else      0      endif  }
	"Set HVACSys:HPSysHSPF - 2"	HVACSys:HPSysHSPF	= {	if (NumHtPumpSystemTypes > 1 .AND. LocalCompAssigned( HtPumpSystem[2]  ) .AND. IfValidAnd( HtPumpSystem[2]:HSPF  > 0 )) then  min( HPSysHSPF, HtPumpSystem[2]:HSPF  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysHSPF - 3"	HVACSys:HPSysHSPF	= {	if (NumHtPumpSystemTypes > 2 .AND. LocalCompAssigned( HtPumpSystem[3]  ) .AND. IfValidAnd( HtPumpSystem[3]:HSPF  > 0 )) then  min( HPSysHSPF, HtPumpSystem[3]:HSPF  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysHSPF - 4"	HVACSys:HPSysHSPF	= {	if (NumHtPumpSystemTypes > 3 .AND. LocalCompAssigned( HtPumpSystem[4]  ) .AND. IfValidAnd( HtPumpSystem[4]:HSPF  > 0 )) then  min( HPSysHSPF, HtPumpSystem[4]:HSPF  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysHSPF - 5"	HVACSys:HPSysHSPF	= {	if (NumHtPumpSystemTypes > 4 .AND. LocalCompAssigned( HtPumpSystem[5]  ) .AND. IfValidAnd( HtPumpSystem[5]:HSPF  > 0 )) then  min( HPSysHSPF, HtPumpSystem[5]:HSPF  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysHSPF - 6"	HVACSys:HPSysHSPF	= {	if (NumHtPumpSystemTypes > 5 .AND. LocalCompAssigned( HtPumpSystem[6]  ) .AND. IfValidAnd( HtPumpSystem[6]:HSPF  > 0 )) then  min( HPSysHSPF, HtPumpSystem[6]:HSPF  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysHSPF - 7"	HVACSys:HPSysHSPF	= {	if (NumHtPumpSystemTypes > 6 .AND. LocalCompAssigned( HtPumpSystem[7]  ) .AND. IfValidAnd( HtPumpSystem[7]:HSPF  > 0 )) then  min( HPSysHSPF, HtPumpSystem[7]:HSPF  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysHSPF - 8"	HVACSys:HPSysHSPF	= {	if (NumHtPumpSystemTypes > 7 .AND. LocalCompAssigned( HtPumpSystem[8]  ) .AND. IfValidAnd( HtPumpSystem[8]:HSPF  > 0 )) then  min( HPSysHSPF, HtPumpSystem[8]:HSPF  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysHSPF - 9"	HVACSys:HPSysHSPF	= {	if (NumHtPumpSystemTypes > 8 .AND. LocalCompAssigned( HtPumpSystem[9]  ) .AND. IfValidAnd( HtPumpSystem[9]:HSPF  > 0 )) then  min( HPSysHSPF, HtPumpSystem[9]:HSPF  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysHSPF - 10"	HVACSys:HPSysHSPF	= {	if (NumHtPumpSystemTypes > 9 .AND. LocalCompAssigned( HtPumpSystem[10] ) .AND. IfValidAnd( HtPumpSystem[10]:HSPF > 0 )) then  min( HPSysHSPF, HtPumpSystem[10]:HSPF )  else  UNCHANGED  endif  }

	"Set HVACSys:HPSysAutoSize - 1"	HVACSys:HPSysAutoSize	= {	if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) .AND. IfValidAnd( HtPumpSystem[1]:AutoSize  > 0 )) then  1  else      0      endif  }    ; SAC 9/22/17 - auto-size sim if ANY assigned HP is flagged for autosize
	"Set HVACSys:HPSysAutoSize - 2"	HVACSys:HPSysAutoSize	= {	if (NumHtPumpSystemTypes > 1 .AND. LocalCompAssigned( HtPumpSystem[2]  ) .AND. IfValidAnd( HtPumpSystem[2]:AutoSize  > 0 )) then  1  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysAutoSize - 3"	HVACSys:HPSysAutoSize	= {	if (NumHtPumpSystemTypes > 2 .AND. LocalCompAssigned( HtPumpSystem[3]  ) .AND. IfValidAnd( HtPumpSystem[3]:AutoSize  > 0 )) then  1  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysAutoSize - 4"	HVACSys:HPSysAutoSize	= {	if (NumHtPumpSystemTypes > 3 .AND. LocalCompAssigned( HtPumpSystem[4]  ) .AND. IfValidAnd( HtPumpSystem[4]:AutoSize  > 0 )) then  1  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysAutoSize - 5"	HVACSys:HPSysAutoSize	= {	if (NumHtPumpSystemTypes > 4 .AND. LocalCompAssigned( HtPumpSystem[5]  ) .AND. IfValidAnd( HtPumpSystem[5]:AutoSize  > 0 )) then  1  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysAutoSize - 6"	HVACSys:HPSysAutoSize	= {	if (NumHtPumpSystemTypes > 5 .AND. LocalCompAssigned( HtPumpSystem[6]  ) .AND. IfValidAnd( HtPumpSystem[6]:AutoSize  > 0 )) then  1  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysAutoSize - 7"	HVACSys:HPSysAutoSize	= {	if (NumHtPumpSystemTypes > 6 .AND. LocalCompAssigned( HtPumpSystem[7]  ) .AND. IfValidAnd( HtPumpSystem[7]:AutoSize  > 0 )) then  1  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysAutoSize - 8"	HVACSys:HPSysAutoSize	= {	if (NumHtPumpSystemTypes > 7 .AND. LocalCompAssigned( HtPumpSystem[8]  ) .AND. IfValidAnd( HtPumpSystem[8]:AutoSize  > 0 )) then  1  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysAutoSize - 9"	HVACSys:HPSysAutoSize	= {	if (NumHtPumpSystemTypes > 8 .AND. LocalCompAssigned( HtPumpSystem[9]  ) .AND. IfValidAnd( HtPumpSystem[9]:AutoSize  > 0 )) then  1  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysAutoSize - 10"	HVACSys:HPSysAutoSize	= {	if (NumHtPumpSystemTypes > 9 .AND. LocalCompAssigned( HtPumpSystem[10] ) .AND. IfValidAnd( HtPumpSystem[10]:AutoSize > 0 )) then  1  else  UNCHANGED  endif  }

	"Set HVACSys:HPSysCap47 - 1"	HVACSys:HPSysCap47	= {	if (NumHtPumpSystemTypes > 0 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) .AND. IfValidAnd( HtPumpSystem[1]:Cap47  > 0 )) then               (HtPumpSystem[1]:Cap47  * HtPumpSystemCount[1] )  else      0      endif  }
	"Set HVACSys:HPSysCap47 - 2"	HVACSys:HPSysCap47	= {	if (NumHtPumpSystemTypes > 1 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[2]  ) .AND. IfValidAnd( HtPumpSystem[2]:Cap47  > 0 )) then  HPSysCap47 + (HtPumpSystem[2]:Cap47  * HtPumpSystemCount[2] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCap47 - 3" 	HVACSys:HPSysCap47	= {	if (NumHtPumpSystemTypes > 2 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[3]  ) .AND. IfValidAnd( HtPumpSystem[3]:Cap47  > 0 )) then  HPSysCap47 + (HtPumpSystem[3]:Cap47  * HtPumpSystemCount[3] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCap47 - 4" 	HVACSys:HPSysCap47	= {	if (NumHtPumpSystemTypes > 3 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[4]  ) .AND. IfValidAnd( HtPumpSystem[4]:Cap47  > 0 )) then  HPSysCap47 + (HtPumpSystem[4]:Cap47  * HtPumpSystemCount[4] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCap47 - 5" 	HVACSys:HPSysCap47	= {	if (NumHtPumpSystemTypes > 4 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[5]  ) .AND. IfValidAnd( HtPumpSystem[5]:Cap47  > 0 )) then  HPSysCap47 + (HtPumpSystem[5]:Cap47  * HtPumpSystemCount[5] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCap47 - 6" 	HVACSys:HPSysCap47	= {	if (NumHtPumpSystemTypes > 5 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[6]  ) .AND. IfValidAnd( HtPumpSystem[6]:Cap47  > 0 )) then  HPSysCap47 + (HtPumpSystem[6]:Cap47  * HtPumpSystemCount[6] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCap47 - 7" 	HVACSys:HPSysCap47	= {	if (NumHtPumpSystemTypes > 6 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[7]  ) .AND. IfValidAnd( HtPumpSystem[7]:Cap47  > 0 )) then  HPSysCap47 + (HtPumpSystem[7]:Cap47  * HtPumpSystemCount[7] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCap47 - 8" 	HVACSys:HPSysCap47	= {	if (NumHtPumpSystemTypes > 7 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[8]  ) .AND. IfValidAnd( HtPumpSystem[8]:Cap47  > 0 )) then  HPSysCap47 + (HtPumpSystem[8]:Cap47  * HtPumpSystemCount[8] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCap47 - 9" 	HVACSys:HPSysCap47	= {	if (NumHtPumpSystemTypes > 8 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[9]  ) .AND. IfValidAnd( HtPumpSystem[9]:Cap47  > 0 )) then  HPSysCap47 + (HtPumpSystem[9]:Cap47  * HtPumpSystemCount[9] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCap47 - 10"	HVACSys:HPSysCap47	= {	if (NumHtPumpSystemTypes > 9 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[10] ) .AND. IfValidAnd( HtPumpSystem[10]:Cap47 > 0 )) then  HPSysCap47 + (HtPumpSystem[10]:Cap47 * HtPumpSystemCount[10])  else  UNCHANGED  endif  }

   ; added to facilitate new 2022 HP standard design fan power - SAC 03/11/21
	"Set HVACSys:HPSysMinCap47 - 1"	HVACSys:HPSysMinCap47	= {	if (NumHtPumpSystemTypes > 0 .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HtPumpSystem[1]:Cap47  > 0 )) then                                                             HtPumpSystem[1]:Cap47   else      0      endif  }
	"Set HVACSys:HPSysMinCap47 - 2"	HVACSys:HPSysMinCap47	= {	if (NumHtPumpSystemTypes > 1 .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HtPumpSystem[2]:Cap47  > 0 ) .AND. IfValidAnd( HtPumpSystem[2]:Cap47  < HPSysMinCap47 )) then  HtPumpSystem[2]:Cap47   else  UNCHANGED  endif  }
	"Set HVACSys:HPSysMinCap47 - 3" 	HVACSys:HPSysMinCap47	= {	if (NumHtPumpSystemTypes > 2 .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HtPumpSystem[3]:Cap47  > 0 ) .AND. IfValidAnd( HtPumpSystem[3]:Cap47  < HPSysMinCap47 )) then  HtPumpSystem[3]:Cap47   else  UNCHANGED  endif  }
	"Set HVACSys:HPSysMinCap47 - 4" 	HVACSys:HPSysMinCap47	= {	if (NumHtPumpSystemTypes > 3 .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HtPumpSystem[4]:Cap47  > 0 ) .AND. IfValidAnd( HtPumpSystem[4]:Cap47  < HPSysMinCap47 )) then  HtPumpSystem[4]:Cap47   else  UNCHANGED  endif  }
	"Set HVACSys:HPSysMinCap47 - 5" 	HVACSys:HPSysMinCap47	= {	if (NumHtPumpSystemTypes > 4 .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HtPumpSystem[5]:Cap47  > 0 ) .AND. IfValidAnd( HtPumpSystem[5]:Cap47  < HPSysMinCap47 )) then  HtPumpSystem[5]:Cap47   else  UNCHANGED  endif  }
	"Set HVACSys:HPSysMinCap47 - 6" 	HVACSys:HPSysMinCap47	= {	if (NumHtPumpSystemTypes > 5 .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HtPumpSystem[6]:Cap47  > 0 ) .AND. IfValidAnd( HtPumpSystem[6]:Cap47  < HPSysMinCap47 )) then  HtPumpSystem[6]:Cap47   else  UNCHANGED  endif  }
	"Set HVACSys:HPSysMinCap47 - 7" 	HVACSys:HPSysMinCap47	= {	if (NumHtPumpSystemTypes > 6 .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HtPumpSystem[7]:Cap47  > 0 ) .AND. IfValidAnd( HtPumpSystem[7]:Cap47  < HPSysMinCap47 )) then  HtPumpSystem[7]:Cap47   else  UNCHANGED  endif  }
	"Set HVACSys:HPSysMinCap47 - 8" 	HVACSys:HPSysMinCap47	= {	if (NumHtPumpSystemTypes > 7 .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HtPumpSystem[8]:Cap47  > 0 ) .AND. IfValidAnd( HtPumpSystem[8]:Cap47  < HPSysMinCap47 )) then  HtPumpSystem[8]:Cap47   else  UNCHANGED  endif  }
	"Set HVACSys:HPSysMinCap47 - 9" 	HVACSys:HPSysMinCap47	= {	if (NumHtPumpSystemTypes > 8 .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HtPumpSystem[9]:Cap47  > 0 ) .AND. IfValidAnd( HtPumpSystem[9]:Cap47  < HPSysMinCap47 )) then  HtPumpSystem[9]:Cap47   else  UNCHANGED  endif  }
	"Set HVACSys:HPSysMinCap47 - 10"	HVACSys:HPSysMinCap47	= {	if (NumHtPumpSystemTypes > 9 .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HtPumpSystem[10]:Cap47 > 0 ) .AND. IfValidAnd( HtPumpSystem[10]:Cap47 < HPSysMinCap47 )) then  HtPumpSystem[10]:Cap47  else  UNCHANGED  endif  }

	"Set HVACSys:HPSysCap35 - 1"	HVACSys:HPSysCap35	= {	if (NumHtPumpSystemTypes > 0 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) .AND. LocalStatus( HtPumpSystem[1]:Cap35  ) > 0) then               (HtPumpSystem[1]:Cap35  * HtPumpSystemCount[1] )  else      0      endif  }
	"Set HVACSys:HPSysCap35 - 2"	HVACSys:HPSysCap35	= {	if (NumHtPumpSystemTypes > 1 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[2]  ) .AND. LocalStatus( HtPumpSystem[2]:Cap35  ) > 0) then  HPSysCap35 + (HtPumpSystem[2]:Cap35  * HtPumpSystemCount[2] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCap35 - 3" 	HVACSys:HPSysCap35	= {	if (NumHtPumpSystemTypes > 2 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[3]  ) .AND. LocalStatus( HtPumpSystem[3]:Cap35  ) > 0) then  HPSysCap35 + (HtPumpSystem[3]:Cap35  * HtPumpSystemCount[3] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCap35 - 4" 	HVACSys:HPSysCap35	= {	if (NumHtPumpSystemTypes > 3 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[4]  ) .AND. LocalStatus( HtPumpSystem[4]:Cap35  ) > 0) then  HPSysCap35 + (HtPumpSystem[4]:Cap35  * HtPumpSystemCount[4] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCap35 - 5" 	HVACSys:HPSysCap35	= {	if (NumHtPumpSystemTypes > 4 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[5]  ) .AND. LocalStatus( HtPumpSystem[5]:Cap35  ) > 0) then  HPSysCap35 + (HtPumpSystem[5]:Cap35  * HtPumpSystemCount[5] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCap35 - 6" 	HVACSys:HPSysCap35	= {	if (NumHtPumpSystemTypes > 5 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[6]  ) .AND. LocalStatus( HtPumpSystem[6]:Cap35  ) > 0) then  HPSysCap35 + (HtPumpSystem[6]:Cap35  * HtPumpSystemCount[6] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCap35 - 7" 	HVACSys:HPSysCap35	= {	if (NumHtPumpSystemTypes > 6 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[7]  ) .AND. LocalStatus( HtPumpSystem[7]:Cap35  ) > 0) then  HPSysCap35 + (HtPumpSystem[7]:Cap35  * HtPumpSystemCount[7] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCap35 - 8" 	HVACSys:HPSysCap35	= {	if (NumHtPumpSystemTypes > 7 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[8]  ) .AND. LocalStatus( HtPumpSystem[8]:Cap35  ) > 0) then  HPSysCap35 + (HtPumpSystem[8]:Cap35  * HtPumpSystemCount[8] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCap35 - 9" 	HVACSys:HPSysCap35	= {	if (NumHtPumpSystemTypes > 8 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[9]  ) .AND. LocalStatus( HtPumpSystem[9]:Cap35  ) > 0) then  HPSysCap35 + (HtPumpSystem[9]:Cap35  * HtPumpSystemCount[9] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCap35 - 10"	HVACSys:HPSysCap35	= {	if (NumHtPumpSystemTypes > 9 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[10] ) .AND. LocalStatus( HtPumpSystem[10]:Cap35 ) > 0) then  HPSysCap35 + (HtPumpSystem[10]:Cap35 * HtPumpSystemCount[10])  else  UNCHANGED  endif  }

	"Set HVACSys:HPSysCap17 - 1"	HVACSys:HPSysCap17	= {	if (NumHtPumpSystemTypes > 0 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) .AND. LocalStatus( HtPumpSystem[1]:Cap17  ) > 0) then               (HtPumpSystem[1]:Cap17  * HtPumpSystemCount[1] )  else      0      endif  }
	"Set HVACSys:HPSysCap17 - 2"	HVACSys:HPSysCap17	= {	if (NumHtPumpSystemTypes > 1 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[2]  ) .AND. LocalStatus( HtPumpSystem[2]:Cap17  ) > 0) then  HPSysCap17 + (HtPumpSystem[2]:Cap17  * HtPumpSystemCount[2] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCap17 - 3" 	HVACSys:HPSysCap17	= {	if (NumHtPumpSystemTypes > 2 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[3]  ) .AND. LocalStatus( HtPumpSystem[3]:Cap17  ) > 0) then  HPSysCap17 + (HtPumpSystem[3]:Cap17  * HtPumpSystemCount[3] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCap17 - 4" 	HVACSys:HPSysCap17	= {	if (NumHtPumpSystemTypes > 3 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[4]  ) .AND. LocalStatus( HtPumpSystem[4]:Cap17  ) > 0) then  HPSysCap17 + (HtPumpSystem[4]:Cap17  * HtPumpSystemCount[4] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCap17 - 5" 	HVACSys:HPSysCap17	= {	if (NumHtPumpSystemTypes > 4 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[5]  ) .AND. LocalStatus( HtPumpSystem[5]:Cap17  ) > 0) then  HPSysCap17 + (HtPumpSystem[5]:Cap17  * HtPumpSystemCount[5] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCap17 - 6" 	HVACSys:HPSysCap17	= {	if (NumHtPumpSystemTypes > 5 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[6]  ) .AND. LocalStatus( HtPumpSystem[6]:Cap17  ) > 0) then  HPSysCap17 + (HtPumpSystem[6]:Cap17  * HtPumpSystemCount[6] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCap17 - 7" 	HVACSys:HPSysCap17	= {	if (NumHtPumpSystemTypes > 6 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[7]  ) .AND. LocalStatus( HtPumpSystem[7]:Cap17  ) > 0) then  HPSysCap17 + (HtPumpSystem[7]:Cap17  * HtPumpSystemCount[7] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCap17 - 8" 	HVACSys:HPSysCap17	= {	if (NumHtPumpSystemTypes > 7 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[8]  ) .AND. LocalStatus( HtPumpSystem[8]:Cap17  ) > 0) then  HPSysCap17 + (HtPumpSystem[8]:Cap17  * HtPumpSystemCount[8] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCap17 - 9" 	HVACSys:HPSysCap17	= {	if (NumHtPumpSystemTypes > 8 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[9]  ) .AND. LocalStatus( HtPumpSystem[9]:Cap17  ) > 0) then  HPSysCap17 + (HtPumpSystem[9]:Cap17  * HtPumpSystemCount[9] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCap17 - 10"	HVACSys:HPSysCap17	= {	if (NumHtPumpSystemTypes > 9 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[10] ) .AND. LocalStatus( HtPumpSystem[10]:Cap17 ) > 0) then  HPSysCap17 + (HtPumpSystem[10]:Cap17 * HtPumpSystemCount[10])  else  UNCHANGED  endif  }

	"Set HVACSys:HPSysCOP47 - 1"	HVACSys:HPSysCOP47	= {	if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) .AND. IfValidAnd( HtPumpSystem[1]:COP47  > 0 )) then                   HtPumpSystem[1]:COP47     else      0      endif  }
	"Set HVACSys:HPSysCOP47 - 2"	HVACSys:HPSysCOP47	= {	if (NumHtPumpSystemTypes > 1 .AND. LocalCompAssigned( HtPumpSystem[2]  ) .AND. IfValidAnd( HtPumpSystem[2]:COP47  > 0 )) then  min( HPSysCOP47, HtPumpSystem[2]:COP47  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCOP47 - 3"	HVACSys:HPSysCOP47	= {	if (NumHtPumpSystemTypes > 2 .AND. LocalCompAssigned( HtPumpSystem[3]  ) .AND. IfValidAnd( HtPumpSystem[3]:COP47  > 0 )) then  min( HPSysCOP47, HtPumpSystem[3]:COP47  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCOP47 - 4"	HVACSys:HPSysCOP47	= {	if (NumHtPumpSystemTypes > 3 .AND. LocalCompAssigned( HtPumpSystem[4]  ) .AND. IfValidAnd( HtPumpSystem[4]:COP47  > 0 )) then  min( HPSysCOP47, HtPumpSystem[4]:COP47  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCOP47 - 5"	HVACSys:HPSysCOP47	= {	if (NumHtPumpSystemTypes > 4 .AND. LocalCompAssigned( HtPumpSystem[5]  ) .AND. IfValidAnd( HtPumpSystem[5]:COP47  > 0 )) then  min( HPSysCOP47, HtPumpSystem[5]:COP47  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCOP47 - 6"	HVACSys:HPSysCOP47	= {	if (NumHtPumpSystemTypes > 5 .AND. LocalCompAssigned( HtPumpSystem[6]  ) .AND. IfValidAnd( HtPumpSystem[6]:COP47  > 0 )) then  min( HPSysCOP47, HtPumpSystem[6]:COP47  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCOP47 - 7"	HVACSys:HPSysCOP47	= {	if (NumHtPumpSystemTypes > 6 .AND. LocalCompAssigned( HtPumpSystem[7]  ) .AND. IfValidAnd( HtPumpSystem[7]:COP47  > 0 )) then  min( HPSysCOP47, HtPumpSystem[7]:COP47  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCOP47 - 8"	HVACSys:HPSysCOP47	= {	if (NumHtPumpSystemTypes > 7 .AND. LocalCompAssigned( HtPumpSystem[8]  ) .AND. IfValidAnd( HtPumpSystem[8]:COP47  > 0 )) then  min( HPSysCOP47, HtPumpSystem[8]:COP47  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCOP47 - 9"	HVACSys:HPSysCOP47	= {	if (NumHtPumpSystemTypes > 8 .AND. LocalCompAssigned( HtPumpSystem[9]  ) .AND. IfValidAnd( HtPumpSystem[9]:COP47  > 0 )) then  min( HPSysCOP47, HtPumpSystem[9]:COP47  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCOP47 - 10"	HVACSys:HPSysCOP47	= {	if (NumHtPumpSystemTypes > 9 .AND. LocalCompAssigned( HtPumpSystem[10] ) .AND. IfValidAnd( HtPumpSystem[10]:COP47 > 0 )) then  min( HPSysCOP47, HtPumpSystem[10]:COP47 )  else  UNCHANGED  endif  }
   "Hardwire HVACSys:HPSysCOP47 for Packaged HP systems"    HVACSys:HPSysCOP47 =       ; SAC 08/18/20 (tic #1003)
      {  if (IfValidAnd( HtPumpSysTypeAbbrev = "PkgTermHeatPump"    ) .OR.
             IfValidAnd( HtPumpSysTypeAbbrev = "SglPkgVertHeatPump" ))
         then  T24RHeatingEquipment:COP47( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev )
         else  UNCHANGED  endif  }

	"Set HVACSys:HPSysCOP35 - 1"	HVACSys:HPSysCOP35	= {	if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) .AND. IfValidAnd( HtPumpSystem[1]:COP35  > 0 )) then                   HtPumpSystem[1]:COP35     else      0      endif  }
	"Set HVACSys:HPSysCOP35 - 2"	HVACSys:HPSysCOP35	= {	if (NumHtPumpSystemTypes > 1 .AND. LocalCompAssigned( HtPumpSystem[2]  ) .AND. IfValidAnd( HtPumpSystem[2]:COP35  > 0 )) then  min( HPSysCOP35, HtPumpSystem[2]:COP35  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCOP35 - 3"	HVACSys:HPSysCOP35	= {	if (NumHtPumpSystemTypes > 2 .AND. LocalCompAssigned( HtPumpSystem[3]  ) .AND. IfValidAnd( HtPumpSystem[3]:COP35  > 0 )) then  min( HPSysCOP35, HtPumpSystem[3]:COP35  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCOP35 - 4"	HVACSys:HPSysCOP35	= {	if (NumHtPumpSystemTypes > 3 .AND. LocalCompAssigned( HtPumpSystem[4]  ) .AND. IfValidAnd( HtPumpSystem[4]:COP35  > 0 )) then  min( HPSysCOP35, HtPumpSystem[4]:COP35  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCOP35 - 5"	HVACSys:HPSysCOP35	= {	if (NumHtPumpSystemTypes > 4 .AND. LocalCompAssigned( HtPumpSystem[5]  ) .AND. IfValidAnd( HtPumpSystem[5]:COP35  > 0 )) then  min( HPSysCOP35, HtPumpSystem[5]:COP35  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCOP35 - 6"	HVACSys:HPSysCOP35	= {	if (NumHtPumpSystemTypes > 5 .AND. LocalCompAssigned( HtPumpSystem[6]  ) .AND. IfValidAnd( HtPumpSystem[6]:COP35  > 0 )) then  min( HPSysCOP35, HtPumpSystem[6]:COP35  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCOP35 - 7"	HVACSys:HPSysCOP35	= {	if (NumHtPumpSystemTypes > 6 .AND. LocalCompAssigned( HtPumpSystem[7]  ) .AND. IfValidAnd( HtPumpSystem[7]:COP35  > 0 )) then  min( HPSysCOP35, HtPumpSystem[7]:COP35  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCOP35 - 8"	HVACSys:HPSysCOP35	= {	if (NumHtPumpSystemTypes > 7 .AND. LocalCompAssigned( HtPumpSystem[8]  ) .AND. IfValidAnd( HtPumpSystem[8]:COP35  > 0 )) then  min( HPSysCOP35, HtPumpSystem[8]:COP35  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCOP35 - 9"	HVACSys:HPSysCOP35	= {	if (NumHtPumpSystemTypes > 8 .AND. LocalCompAssigned( HtPumpSystem[9]  ) .AND. IfValidAnd( HtPumpSystem[9]:COP35  > 0 )) then  min( HPSysCOP35, HtPumpSystem[9]:COP35  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCOP35 - 10"	HVACSys:HPSysCOP35	= {	if (NumHtPumpSystemTypes > 9 .AND. LocalCompAssigned( HtPumpSystem[10] ) .AND. IfValidAnd( HtPumpSystem[10]:COP35 > 0 )) then  min( HPSysCOP35, HtPumpSystem[10]:COP35 )  else  UNCHANGED  endif  }

	"Set HVACSys:HPSysCOP17 - 1"	HVACSys:HPSysCOP17	= {	if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) .AND. IfValidAnd( HtPumpSystem[1]:COP17  > 0 )) then                   HtPumpSystem[1]:COP17     else      0      endif  }
	"Set HVACSys:HPSysCOP17 - 2"	HVACSys:HPSysCOP17	= {	if (NumHtPumpSystemTypes > 1 .AND. LocalCompAssigned( HtPumpSystem[2]  ) .AND. IfValidAnd( HtPumpSystem[2]:COP17  > 0 )) then  min( HPSysCOP17, HtPumpSystem[2]:COP17  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCOP17 - 3"	HVACSys:HPSysCOP17	= {	if (NumHtPumpSystemTypes > 2 .AND. LocalCompAssigned( HtPumpSystem[3]  ) .AND. IfValidAnd( HtPumpSystem[3]:COP17  > 0 )) then  min( HPSysCOP17, HtPumpSystem[3]:COP17  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCOP17 - 4"	HVACSys:HPSysCOP17	= {	if (NumHtPumpSystemTypes > 3 .AND. LocalCompAssigned( HtPumpSystem[4]  ) .AND. IfValidAnd( HtPumpSystem[4]:COP17  > 0 )) then  min( HPSysCOP17, HtPumpSystem[4]:COP17  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCOP17 - 5"	HVACSys:HPSysCOP17	= {	if (NumHtPumpSystemTypes > 4 .AND. LocalCompAssigned( HtPumpSystem[5]  ) .AND. IfValidAnd( HtPumpSystem[5]:COP17  > 0 )) then  min( HPSysCOP17, HtPumpSystem[5]:COP17  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCOP17 - 6"	HVACSys:HPSysCOP17	= {	if (NumHtPumpSystemTypes > 5 .AND. LocalCompAssigned( HtPumpSystem[6]  ) .AND. IfValidAnd( HtPumpSystem[6]:COP17  > 0 )) then  min( HPSysCOP17, HtPumpSystem[6]:COP17  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCOP17 - 7"	HVACSys:HPSysCOP17	= {	if (NumHtPumpSystemTypes > 6 .AND. LocalCompAssigned( HtPumpSystem[7]  ) .AND. IfValidAnd( HtPumpSystem[7]:COP17  > 0 )) then  min( HPSysCOP17, HtPumpSystem[7]:COP17  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCOP17 - 8"	HVACSys:HPSysCOP17	= {	if (NumHtPumpSystemTypes > 7 .AND. LocalCompAssigned( HtPumpSystem[8]  ) .AND. IfValidAnd( HtPumpSystem[8]:COP17  > 0 )) then  min( HPSysCOP17, HtPumpSystem[8]:COP17  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCOP17 - 9"	HVACSys:HPSysCOP17	= {	if (NumHtPumpSystemTypes > 8 .AND. LocalCompAssigned( HtPumpSystem[9]  ) .AND. IfValidAnd( HtPumpSystem[9]:COP17  > 0 )) then  min( HPSysCOP17, HtPumpSystem[9]:COP17  )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysCOP17 - 10"	HVACSys:HPSysCOP17	= {	if (NumHtPumpSystemTypes > 9 .AND. LocalCompAssigned( HtPumpSystem[10] ) .AND. IfValidAnd( HtPumpSystem[10]:COP17 > 0 )) then  min( HPSysCOP17, HtPumpSystem[10]:COP17 )  else  UNCHANGED  endif  }

	"Set HVACSys:HPSysAuxHtgCap - 1"		HVACSys:HPSysAuxHtgCap	= {	if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) .AND. LocalStatus( HtPumpSystem[1]:AuxHtgCap  ) > 0) then                   (HtPumpSystem[1]:AuxHtgCap  * HtPumpSystemCount[1] )  else      0      endif  }
	"Set HVACSys:HPSysAuxHtgCap - 2"		HVACSys:HPSysAuxHtgCap	= {	if (NumHtPumpSystemTypes > 1 .AND. LocalCompAssigned( HtPumpSystem[2]  ) .AND. LocalStatus( HtPumpSystem[2]:AuxHtgCap  ) > 0) then  HPSysAuxHtgCap + (HtPumpSystem[2]:AuxHtgCap  * HtPumpSystemCount[2] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysAuxHtgCap - 3" 	HVACSys:HPSysAuxHtgCap	= {	if (NumHtPumpSystemTypes > 2 .AND. LocalCompAssigned( HtPumpSystem[3]  ) .AND. LocalStatus( HtPumpSystem[3]:AuxHtgCap  ) > 0) then  HPSysAuxHtgCap + (HtPumpSystem[3]:AuxHtgCap  * HtPumpSystemCount[3] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysAuxHtgCap - 4" 	HVACSys:HPSysAuxHtgCap	= {	if (NumHtPumpSystemTypes > 3 .AND. LocalCompAssigned( HtPumpSystem[4]  ) .AND. LocalStatus( HtPumpSystem[4]:AuxHtgCap  ) > 0) then  HPSysAuxHtgCap + (HtPumpSystem[4]:AuxHtgCap  * HtPumpSystemCount[4] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysAuxHtgCap - 5" 	HVACSys:HPSysAuxHtgCap	= {	if (NumHtPumpSystemTypes > 4 .AND. LocalCompAssigned( HtPumpSystem[5]  ) .AND. LocalStatus( HtPumpSystem[5]:AuxHtgCap  ) > 0) then  HPSysAuxHtgCap + (HtPumpSystem[5]:AuxHtgCap  * HtPumpSystemCount[5] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysAuxHtgCap - 6" 	HVACSys:HPSysAuxHtgCap	= {	if (NumHtPumpSystemTypes > 5 .AND. LocalCompAssigned( HtPumpSystem[6]  ) .AND. LocalStatus( HtPumpSystem[6]:AuxHtgCap  ) > 0) then  HPSysAuxHtgCap + (HtPumpSystem[6]:AuxHtgCap  * HtPumpSystemCount[6] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysAuxHtgCap - 7" 	HVACSys:HPSysAuxHtgCap	= {	if (NumHtPumpSystemTypes > 6 .AND. LocalCompAssigned( HtPumpSystem[7]  ) .AND. LocalStatus( HtPumpSystem[7]:AuxHtgCap  ) > 0) then  HPSysAuxHtgCap + (HtPumpSystem[7]:AuxHtgCap  * HtPumpSystemCount[7] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysAuxHtgCap - 8" 	HVACSys:HPSysAuxHtgCap	= {	if (NumHtPumpSystemTypes > 7 .AND. LocalCompAssigned( HtPumpSystem[8]  ) .AND. LocalStatus( HtPumpSystem[8]:AuxHtgCap  ) > 0) then  HPSysAuxHtgCap + (HtPumpSystem[8]:AuxHtgCap  * HtPumpSystemCount[8] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysAuxHtgCap - 9" 	HVACSys:HPSysAuxHtgCap	= {	if (NumHtPumpSystemTypes > 8 .AND. LocalCompAssigned( HtPumpSystem[9]  ) .AND. LocalStatus( HtPumpSystem[9]:AuxHtgCap  ) > 0) then  HPSysAuxHtgCap + (HtPumpSystem[9]:AuxHtgCap  * HtPumpSystemCount[9] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysAuxHtgCap - 10"	HVACSys:HPSysAuxHtgCap	= {	if (NumHtPumpSystemTypes > 9 .AND. LocalCompAssigned( HtPumpSystem[10] ) .AND. LocalStatus( HtPumpSystem[10]:AuxHtgCap ) > 0) then  HPSysAuxHtgCap + (HtPumpSystem[10]:AuxHtgCap * HtPumpSystemCount[10])  else  UNCHANGED  endif  }

	"Set HVACSys:HPSysVCHPFanPwr - 1"	HVACSys:HPSysVCHPFanPwr	= {	if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) .AND. LocalStatus( HtPumpSystem[1]:VCHPFanPower  ) > 0) then                    (HtPumpSystem[1]:VCHPFanPower  * HtPumpSystemCount[1] )  else      0      endif  }
	"Set HVACSys:HPSysVCHPFanPwr - 2"	HVACSys:HPSysVCHPFanPwr	= {	if (NumHtPumpSystemTypes > 1 .AND. LocalCompAssigned( HtPumpSystem[2]  ) .AND. LocalStatus( HtPumpSystem[2]:VCHPFanPower  ) > 0) then  HPSysVCHPFanPwr + (HtPumpSystem[2]:VCHPFanPower  * HtPumpSystemCount[2] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysVCHPFanPwr - 3" 	HVACSys:HPSysVCHPFanPwr	= {	if (NumHtPumpSystemTypes > 2 .AND. LocalCompAssigned( HtPumpSystem[3]  ) .AND. LocalStatus( HtPumpSystem[3]:VCHPFanPower  ) > 0) then  HPSysVCHPFanPwr + (HtPumpSystem[3]:VCHPFanPower  * HtPumpSystemCount[3] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysVCHPFanPwr - 4" 	HVACSys:HPSysVCHPFanPwr	= {	if (NumHtPumpSystemTypes > 3 .AND. LocalCompAssigned( HtPumpSystem[4]  ) .AND. LocalStatus( HtPumpSystem[4]:VCHPFanPower  ) > 0) then  HPSysVCHPFanPwr + (HtPumpSystem[4]:VCHPFanPower  * HtPumpSystemCount[4] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysVCHPFanPwr - 5" 	HVACSys:HPSysVCHPFanPwr	= {	if (NumHtPumpSystemTypes > 4 .AND. LocalCompAssigned( HtPumpSystem[5]  ) .AND. LocalStatus( HtPumpSystem[5]:VCHPFanPower  ) > 0) then  HPSysVCHPFanPwr + (HtPumpSystem[5]:VCHPFanPower  * HtPumpSystemCount[5] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysVCHPFanPwr - 6" 	HVACSys:HPSysVCHPFanPwr	= {	if (NumHtPumpSystemTypes > 5 .AND. LocalCompAssigned( HtPumpSystem[6]  ) .AND. LocalStatus( HtPumpSystem[6]:VCHPFanPower  ) > 0) then  HPSysVCHPFanPwr + (HtPumpSystem[6]:VCHPFanPower  * HtPumpSystemCount[6] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysVCHPFanPwr - 7" 	HVACSys:HPSysVCHPFanPwr	= {	if (NumHtPumpSystemTypes > 6 .AND. LocalCompAssigned( HtPumpSystem[7]  ) .AND. LocalStatus( HtPumpSystem[7]:VCHPFanPower  ) > 0) then  HPSysVCHPFanPwr + (HtPumpSystem[7]:VCHPFanPower  * HtPumpSystemCount[7] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysVCHPFanPwr - 8" 	HVACSys:HPSysVCHPFanPwr	= {	if (NumHtPumpSystemTypes > 7 .AND. LocalCompAssigned( HtPumpSystem[8]  ) .AND. LocalStatus( HtPumpSystem[8]:VCHPFanPower  ) > 0) then  HPSysVCHPFanPwr + (HtPumpSystem[8]:VCHPFanPower  * HtPumpSystemCount[8] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysVCHPFanPwr - 9" 	HVACSys:HPSysVCHPFanPwr	= {	if (NumHtPumpSystemTypes > 8 .AND. LocalCompAssigned( HtPumpSystem[9]  ) .AND. LocalStatus( HtPumpSystem[9]:VCHPFanPower  ) > 0) then  HPSysVCHPFanPwr + (HtPumpSystem[9]:VCHPFanPower  * HtPumpSystemCount[9] )  else  UNCHANGED  endif  }
	"Set HVACSys:HPSysVCHPFanPwr - 10"	HVACSys:HPSysVCHPFanPwr	= {	if (NumHtPumpSystemTypes > 9 .AND. LocalCompAssigned( HtPumpSystem[10] ) .AND. LocalStatus( HtPumpSystem[10]:VCHPFanPower ) > 0) then  HPSysVCHPFanPwr + (HtPumpSystem[10]:VCHPFanPower * HtPumpSystemCount[10])  else  UNCHANGED  endif  }

	"Set HVACSys:HPModelDualFuel - 1"	HVACSys:HPModelDualFuel = {	if (NumHtPumpSystemTypes > 0 .AND. IfValidAnd( HtPumpSystem[1]:ModelDualFuel > 0 )) then  1  else      0      endif  }  ; SAC 12/08/20
	"Set HVACSys:HPModelDualFuel - 2"	HVACSys:HPModelDualFuel = {	if (NumHtPumpSystemTypes > 1 .AND. IfValidAnd( HtPumpSystem[2]:ModelDualFuel > 0 )) then  1  else  UNCHANGED  endif  }
	"Set HVACSys:HPModelDualFuel - 3"	HVACSys:HPModelDualFuel = {	if (NumHtPumpSystemTypes > 2 .AND. IfValidAnd( HtPumpSystem[3]:ModelDualFuel > 0 )) then  1  else  UNCHANGED  endif  }
	"Set HVACSys:HPModelDualFuel - 4"	HVACSys:HPModelDualFuel = {	if (NumHtPumpSystemTypes > 3 .AND. IfValidAnd( HtPumpSystem[4]:ModelDualFuel > 0 )) then  1  else  UNCHANGED  endif  }
	"Set HVACSys:HPModelDualFuel - 5"	HVACSys:HPModelDualFuel = {	if (NumHtPumpSystemTypes > 4 .AND. IfValidAnd( HtPumpSystem[5]:ModelDualFuel > 0 )) then  1  else  UNCHANGED  endif  }
	"Set HVACSys:HPModelDualFuel - 6"	HVACSys:HPModelDualFuel = {	if (NumHtPumpSystemTypes > 5 .AND. IfValidAnd( HtPumpSystem[6]:ModelDualFuel > 0 )) then  1  else  UNCHANGED  endif  }
	"Set HVACSys:HPModelDualFuel - 7"	HVACSys:HPModelDualFuel = {	if (NumHtPumpSystemTypes > 6 .AND. IfValidAnd( HtPumpSystem[7]:ModelDualFuel > 0 )) then  1  else  UNCHANGED  endif  }
	"Set HVACSys:HPModelDualFuel - 8"	HVACSys:HPModelDualFuel = {	if (NumHtPumpSystemTypes > 7 .AND. IfValidAnd( HtPumpSystem[8]:ModelDualFuel > 0 )) then  1  else  UNCHANGED  endif  }
	"Set HVACSys:HPModelDualFuel - 9"	HVACSys:HPModelDualFuel = {	if (NumHtPumpSystemTypes > 8 .AND. IfValidAnd( HtPumpSystem[9]:ModelDualFuel > 0 )) then  1  else  UNCHANGED  endif  }
	"Set HVACSys:HPModelDualFuel - 10"	HVACSys:HPModelDualFuel = {	if (NumHtPumpSystemTypes > 9 .AND. IfValidAnd( HtPumpSystem[10]ModelDualFuel > 0 )) then  1  else  UNCHANGED  endif  }

	"Set HVACSys:HPDFAFUE - 1"	   HVACSys:HPDFAFUE  = {	if (NumHtPumpSystemTypes > 0 .AND. IfValidAnd( HtPumpSystem[1]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[1]:AFUE > 0 ))        then  HtPumpSystem[1]:AFUE  else     101     endif  }
	"Set HVACSys:HPDFAFUE - 2"	   HVACSys:HPDFAFUE  = {	if (NumHtPumpSystemTypes > 1 .AND. IfValidAnd( HtPumpSystem[2]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[2]:AFUE < HPDFAFUE )) then  HtPumpSystem[2]:AFUE  else  UNCHANGED  endif  }
	"Set HVACSys:HPDFAFUE - 3"	   HVACSys:HPDFAFUE  = {	if (NumHtPumpSystemTypes > 2 .AND. IfValidAnd( HtPumpSystem[3]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[3]:AFUE < HPDFAFUE )) then  HtPumpSystem[3]:AFUE  else  UNCHANGED  endif  }
	"Set HVACSys:HPDFAFUE - 4"	   HVACSys:HPDFAFUE  = {	if (NumHtPumpSystemTypes > 3 .AND. IfValidAnd( HtPumpSystem[4]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[4]:AFUE < HPDFAFUE )) then  HtPumpSystem[4]:AFUE  else  UNCHANGED  endif  }
	"Set HVACSys:HPDFAFUE - 5"	   HVACSys:HPDFAFUE  = {	if (NumHtPumpSystemTypes > 4 .AND. IfValidAnd( HtPumpSystem[5]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[5]:AFUE < HPDFAFUE )) then  HtPumpSystem[5]:AFUE  else  UNCHANGED  endif  }
	"Set HVACSys:HPDFAFUE - 6"	   HVACSys:HPDFAFUE  = {	if (NumHtPumpSystemTypes > 5 .AND. IfValidAnd( HtPumpSystem[6]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[6]:AFUE < HPDFAFUE )) then  HtPumpSystem[6]:AFUE  else  UNCHANGED  endif  }
	"Set HVACSys:HPDFAFUE - 7"	   HVACSys:HPDFAFUE  = {	if (NumHtPumpSystemTypes > 6 .AND. IfValidAnd( HtPumpSystem[7]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[7]:AFUE < HPDFAFUE )) then  HtPumpSystem[7]:AFUE  else  UNCHANGED  endif  }
	"Set HVACSys:HPDFAFUE - 8"	   HVACSys:HPDFAFUE  = {	if (NumHtPumpSystemTypes > 7 .AND. IfValidAnd( HtPumpSystem[8]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[8]:AFUE < HPDFAFUE )) then  HtPumpSystem[8]:AFUE  else  UNCHANGED  endif  }
	"Set HVACSys:HPDFAFUE - 9"	   HVACSys:HPDFAFUE  = {	if (NumHtPumpSystemTypes > 8 .AND. IfValidAnd( HtPumpSystem[9]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[9]:AFUE < HPDFAFUE )) then  HtPumpSystem[9]:AFUE  else  UNCHANGED  endif  }
	"Set HVACSys:HPDFAFUE - 10"	HVACSys:HPDFAFUE  = {	if (NumHtPumpSystemTypes > 9 .AND. IfValidAnd( HtPumpSystem[10]ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[10]AFUE < HPDFAFUE )) then  HtPumpSystem[10]AFUE  else  UNCHANGED  endif  }

	"Set HVACSys:HPLockoutTemp - 1"	   HVACSys:HPLockoutTemp  = {	if (NumHtPumpSystemTypes > 0 .AND. IfValidAnd( HtPumpSystem[1]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[1]:HasHPLockout > 0 ) .AND. IfValidAnd( HtPumpSystem[1]:HPLockoutTemp > -999 ))          then  HtPumpSystem[1]:HPLockoutTemp  else    -999     endif  }
	"Set HVACSys:HPLockoutTemp - 2"	   HVACSys:HPLockoutTemp  = {	if (NumHtPumpSystemTypes > 1 .AND. IfValidAnd( HtPumpSystem[2]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[2]:HasHPLockout > 0 ) .AND. IfValidAnd( HtPumpSystem[2]:HPLockoutTemp > HPLockoutTemp )) then  HtPumpSystem[2]:HPLockoutTemp  else  UNCHANGED  endif  }
	"Set HVACSys:HPLockoutTemp - 3"	   HVACSys:HPLockoutTemp  = {	if (NumHtPumpSystemTypes > 2 .AND. IfValidAnd( HtPumpSystem[3]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[3]:HasHPLockout > 0 ) .AND. IfValidAnd( HtPumpSystem[3]:HPLockoutTemp > HPLockoutTemp )) then  HtPumpSystem[3]:HPLockoutTemp  else  UNCHANGED  endif  }
	"Set HVACSys:HPLockoutTemp - 4"	   HVACSys:HPLockoutTemp  = {	if (NumHtPumpSystemTypes > 3 .AND. IfValidAnd( HtPumpSystem[4]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[4]:HasHPLockout > 0 ) .AND. IfValidAnd( HtPumpSystem[4]:HPLockoutTemp > HPLockoutTemp )) then  HtPumpSystem[4]:HPLockoutTemp  else  UNCHANGED  endif  }
	"Set HVACSys:HPLockoutTemp - 5"	   HVACSys:HPLockoutTemp  = {	if (NumHtPumpSystemTypes > 4 .AND. IfValidAnd( HtPumpSystem[5]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[5]:HasHPLockout > 0 ) .AND. IfValidAnd( HtPumpSystem[5]:HPLockoutTemp > HPLockoutTemp )) then  HtPumpSystem[5]:HPLockoutTemp  else  UNCHANGED  endif  }
	"Set HVACSys:HPLockoutTemp - 6"	   HVACSys:HPLockoutTemp  = {	if (NumHtPumpSystemTypes > 5 .AND. IfValidAnd( HtPumpSystem[6]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[6]:HasHPLockout > 0 ) .AND. IfValidAnd( HtPumpSystem[6]:HPLockoutTemp > HPLockoutTemp )) then  HtPumpSystem[6]:HPLockoutTemp  else  UNCHANGED  endif  }
	"Set HVACSys:HPLockoutTemp - 7"	   HVACSys:HPLockoutTemp  = {	if (NumHtPumpSystemTypes > 6 .AND. IfValidAnd( HtPumpSystem[7]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[7]:HasHPLockout > 0 ) .AND. IfValidAnd( HtPumpSystem[7]:HPLockoutTemp > HPLockoutTemp )) then  HtPumpSystem[7]:HPLockoutTemp  else  UNCHANGED  endif  }
	"Set HVACSys:HPLockoutTemp - 8"	   HVACSys:HPLockoutTemp  = {	if (NumHtPumpSystemTypes > 7 .AND. IfValidAnd( HtPumpSystem[8]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[8]:HasHPLockout > 0 ) .AND. IfValidAnd( HtPumpSystem[8]:HPLockoutTemp > HPLockoutTemp )) then  HtPumpSystem[8]:HPLockoutTemp  else  UNCHANGED  endif  }
	"Set HVACSys:HPLockoutTemp - 9"	   HVACSys:HPLockoutTemp  = {	if (NumHtPumpSystemTypes > 8 .AND. IfValidAnd( HtPumpSystem[9]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[9]:HasHPLockout > 0 ) .AND. IfValidAnd( HtPumpSystem[9]:HPLockoutTemp > HPLockoutTemp )) then  HtPumpSystem[9]:HPLockoutTemp  else  UNCHANGED  endif  }
	"Set HVACSys:HPLockoutTemp - 10"	   HVACSys:HPLockoutTemp  = {	if (NumHtPumpSystemTypes > 9 .AND. IfValidAnd( HtPumpSystem[10]ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[10]HasHPLockout > 0 ) .AND. IfValidAnd( HtPumpSystem[10]HPLockoutTemp > HPLockoutTemp )) then  HtPumpSystem[10]HPLockoutTemp  else  UNCHANGED  endif  }

   "Set HVACSys:LrgHtPumpStdFanPwr"    HVACSys:LrgHtPumpStdFanPwr =        ; 2022 - SAC 03/11/21  ; SAC 03/15/21
      {  if (Proj:RunAbbrev == "s" .OR. Proj:RunAbbrev == "smf" .OR. Proj:RunAbbrev == "dr")
         then  UNCHANGED
         else if (FloorAreaServed[1] > 0.5 .AND. (Proj:RunScope == 1 .OR. Status == 3) .AND. 
             IfValidAnd( HtPumpDucted > 0 ) .AND. LocalCompAssigned( Fan ) > 0.5 .AND.
             T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) < 0.5 .AND.
             IfValidAnd( Proj:AnalysisVersion >= 220000 ) .AND. HPSysAutoSize == 0 .AND. HPSysMinCap47 >= 54000)
         then  0.58
         else  0  endif endif  }
   "Set HVACSys:PropHtPumpAutoSz"      HVACSys:PropHtPumpAutoSz  =         ; 2022 - SAC 03/11/21  ; SAC 03/15/21
      {  if (Proj:RunAbbrev == "s" .OR. Proj:RunAbbrev == "smf" .OR. Proj:RunAbbrev == "dr")
         then  UNCHANGED
         else if (HPSysAutoSize > 0) then  1  else  0  endif endif  }

   ; SAC 6/22/20 - added COP47 reporting for PkgTermHeatPump & SglPkgVertHeatPump (tic #1225 & #1226)   ; SAC 08/19/20 (tic #1003)
	"Set HVACSys:HeatEquipSummary"	HVACSys:HeatEquipSummary	=     ; added dual fuel (DF) indicators - SAC 12/08/20
				{	if (NumHtPumpSystemTypes <= 0) then  " "
					else if (NumHtPumpSysUnits < 1) then  "No heat pump equipment units (counts) defined"
					else if (LocalCompAssigned( HtPumpSystem[1] ) == 0) then  "Heat pump equipment assignment #1 not defined"
					else if (HtPumpSystem[1]:IsAvailable > 0)
			;		then	Format( "%.0f %s unit(s), HSPF %.1f, Cap@47 %s, Cap@17 %s", NumHtPumpSysUnits, HtPumpSysTypeAbbrev, HPSysHSPF, FltToStr( HPSysCap47 ), FltToStr( HPSysCap17 ) )
					then	if (IfValidAnd( HtPumpSystem[1]:AutoSize > 0 ))
					      then  if (HtPumpSystem[1]:Type == 7)
      							then	Format( "%.0f %s unit(s), auto-sized", NumHtPumpSysUnits, HtPumpSysTypeAbbrev )
		      					else if (HtPumpSystem[1]:Type == 11 .OR. HtPumpSystem[1]:Type == 26 .OR. HtPumpSystem[1]:Type == 24)
      							then	if (HPModelDualFuel > 0)
                                 then  Format( "%.0f DF %s unit(s), @47: COP %.1f, auto-sized", NumHtPumpSysUnits, HtPumpSysTypeAbbrev, HPSysCOP47 )
                                 else  Format( "%.0f %s unit(s), @47: COP %.1f, auto-sized",    NumHtPumpSysUnits, HtPumpSysTypeAbbrev, HPSysCOP47 )
                                 endif
		      					else	if (HPModelDualFuel > 0)
                                 then  Format( "%.0f DF %s unit(s), HSPF %.1f, auto-sized", NumHtPumpSysUnits, HtPumpSysTypeAbbrev, HPSysHSPF )
                                 else  Format( "%.0f %s unit(s), HSPF %.1f, auto-sized",    NumHtPumpSysUnits, HtPumpSysTypeAbbrev, HPSysHSPF )
                                 endif
				      			endif endif
					      else  if (HtPumpSystem[1]:Type == 7)
      							then	Format( "%.0f %s unit(s), @47: Cap %s Btuh", NumHtPumpSysUnits, HtPumpSysTypeAbbrev, FltToStr( HPSysCap47 ) )
      							else if (HtPumpSystem[1]:Type == 11 .OR. HtPumpSystem[1]:Type == 26 .OR. HtPumpSystem[1]:Type == 24)
      							then	if (HPModelDualFuel > 0)
                                 then  Format( "%.0f DF %s unit(s), @47: COP %.1f, Cap %s Btuh", NumHtPumpSysUnits, HtPumpSysTypeAbbrev, HPSysCOP47, FltToStr( HPSysCap47 ) )
                                 else  Format( "%.0f %s unit(s), @47: COP %.1f, Cap %s Btuh",    NumHtPumpSysUnits, HtPumpSysTypeAbbrev, HPSysCOP47, FltToStr( HPSysCap47 ) )
                                 endif
      							else if (HtPumpSystem[1]:Type == 22)   ; SAC 11/2/18 - VCHP  - SAC 11/13/18 - removed Cap17 reporting
      							then	Format( "%.0f %s unit(s), Cap@47 %s Btuh", NumHtPumpSysUnits, HtPumpSysTypeAbbrev, FltToStr( HPSysCap47 ) )
		      					else	if (HPModelDualFuel > 0)
                                 then  Format( "%.0f DF %s unit(s), HSPF %.1f, Cap@47 %s Btuh", NumHtPumpSysUnits, HtPumpSysTypeAbbrev, HPSysHSPF, FltToStr( HPSysCap47 ) )
                                 else  Format( "%.0f %s unit(s), HSPF %.1f, Cap@47 %s Btuh",    NumHtPumpSysUnits, HtPumpSysTypeAbbrev, HPSysHSPF, FltToStr( HPSysCap47 ) )
                                 endif
				      			endif endif endif  endif
					else	Format( "%.0f %s unit(s),  ?? efficiency ??", NumHtPumpSysUnits, HtPumpSysTypeAbbrev )
					endif endif endif endif  }
;	"debug HVACSys:HeatEquipSummary"		HVACSys:Action		= {	if (FloorAreaServed > 0.5) then PostWarning( "HVACSys: '%s' HeatEquipSummary: '%s'", Name, HeatEquipSummary ) else UNCHANGED endif }

  ; More HVACSys cooling equipment summarization
	"Set HVACSys:ClSysSEER - 1"	HVACSys:ClSysSEER	= {	if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) .AND. IfValidAnd( HtPumpSystem[1]:SEER  > 0 )) then                  HtPumpSystem[1]:SEER     else      0      endif  }
	"Set HVACSys:ClSysSEER - 2"	HVACSys:ClSysSEER	= {	if (NumHtPumpSystemTypes > 1 .AND. LocalCompAssigned( HtPumpSystem[2]  ) .AND. IfValidAnd( HtPumpSystem[2]:SEER  > 0 )) then  min( ClSysSEER, HtPumpSystem[2]:SEER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSEER - 3"	HVACSys:ClSysSEER	= {	if (NumHtPumpSystemTypes > 2 .AND. LocalCompAssigned( HtPumpSystem[3]  ) .AND. IfValidAnd( HtPumpSystem[3]:SEER  > 0 )) then  min( ClSysSEER, HtPumpSystem[3]:SEER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSEER - 4"	HVACSys:ClSysSEER	= {	if (NumHtPumpSystemTypes > 3 .AND. LocalCompAssigned( HtPumpSystem[4]  ) .AND. IfValidAnd( HtPumpSystem[4]:SEER  > 0 )) then  min( ClSysSEER, HtPumpSystem[4]:SEER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSEER - 5"	HVACSys:ClSysSEER	= {	if (NumHtPumpSystemTypes > 4 .AND. LocalCompAssigned( HtPumpSystem[5]  ) .AND. IfValidAnd( HtPumpSystem[5]:SEER  > 0 )) then  min( ClSysSEER, HtPumpSystem[5]:SEER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSEER - 6"	HVACSys:ClSysSEER	= {	if (NumHtPumpSystemTypes > 5 .AND. LocalCompAssigned( HtPumpSystem[6]  ) .AND. IfValidAnd( HtPumpSystem[6]:SEER  > 0 )) then  min( ClSysSEER, HtPumpSystem[6]:SEER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSEER - 7"	HVACSys:ClSysSEER	= {	if (NumHtPumpSystemTypes > 6 .AND. LocalCompAssigned( HtPumpSystem[7]  ) .AND. IfValidAnd( HtPumpSystem[7]:SEER  > 0 )) then  min( ClSysSEER, HtPumpSystem[7]:SEER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSEER - 8"	HVACSys:ClSysSEER	= {	if (NumHtPumpSystemTypes > 7 .AND. LocalCompAssigned( HtPumpSystem[8]  ) .AND. IfValidAnd( HtPumpSystem[8]:SEER  > 0 )) then  min( ClSysSEER, HtPumpSystem[8]:SEER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSEER - 9"	HVACSys:ClSysSEER	= {	if (NumHtPumpSystemTypes > 8 .AND. LocalCompAssigned( HtPumpSystem[9]  ) .AND. IfValidAnd( HtPumpSystem[9]:SEER  > 0 )) then  min( ClSysSEER, HtPumpSystem[9]:SEER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSEER - 10"	HVACSys:ClSysSEER	= {	if (NumHtPumpSystemTypes > 9 .AND. LocalCompAssigned( HtPumpSystem[10] ) .AND. IfValidAnd( HtPumpSystem[10]:SEER > 0 )) then  min( ClSysSEER, HtPumpSystem[10]:SEER )  else  UNCHANGED  endif  }

	"Set HVACSys:ClSysEER - 1"		HVACSys:ClSysEER	= {	if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) .AND. IfValidAnd( HtPumpSystem[1]:EER  > 0 )) then                 HtPumpSystem[1]:EER     else      0      endif  }
	"Set HVACSys:ClSysEER - 2"		HVACSys:ClSysEER	= {	if (NumHtPumpSystemTypes > 1 .AND. LocalCompAssigned( HtPumpSystem[2]  ) .AND. IfValidAnd( HtPumpSystem[2]:EER  > 0 )) then  min( ClSysEER, HtPumpSystem[2]:EER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysEER - 3"		HVACSys:ClSysEER	= {	if (NumHtPumpSystemTypes > 2 .AND. LocalCompAssigned( HtPumpSystem[3]  ) .AND. IfValidAnd( HtPumpSystem[3]:EER  > 0 )) then  min( ClSysEER, HtPumpSystem[3]:EER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysEER - 4"		HVACSys:ClSysEER	= {	if (NumHtPumpSystemTypes > 3 .AND. LocalCompAssigned( HtPumpSystem[4]  ) .AND. IfValidAnd( HtPumpSystem[4]:EER  > 0 )) then  min( ClSysEER, HtPumpSystem[4]:EER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysEER - 5"		HVACSys:ClSysEER	= {	if (NumHtPumpSystemTypes > 4 .AND. LocalCompAssigned( HtPumpSystem[5]  ) .AND. IfValidAnd( HtPumpSystem[5]:EER  > 0 )) then  min( ClSysEER, HtPumpSystem[5]:EER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysEER - 6"		HVACSys:ClSysEER	= {	if (NumHtPumpSystemTypes > 5 .AND. LocalCompAssigned( HtPumpSystem[6]  ) .AND. IfValidAnd( HtPumpSystem[6]:EER  > 0 )) then  min( ClSysEER, HtPumpSystem[6]:EER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysEER - 7"		HVACSys:ClSysEER	= {	if (NumHtPumpSystemTypes > 6 .AND. LocalCompAssigned( HtPumpSystem[7]  ) .AND. IfValidAnd( HtPumpSystem[7]:EER  > 0 )) then  min( ClSysEER, HtPumpSystem[7]:EER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysEER - 8"		HVACSys:ClSysEER	= {	if (NumHtPumpSystemTypes > 7 .AND. LocalCompAssigned( HtPumpSystem[8]  ) .AND. IfValidAnd( HtPumpSystem[8]:EER  > 0 )) then  min( ClSysEER, HtPumpSystem[8]:EER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysEER - 9"		HVACSys:ClSysEER	= {	if (NumHtPumpSystemTypes > 8 .AND. LocalCompAssigned( HtPumpSystem[9]  ) .AND. IfValidAnd( HtPumpSystem[9]:EER  > 0 )) then  min( ClSysEER, HtPumpSystem[9]:EER  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysEER - 10"	HVACSys:ClSysEER	= {	if (NumHtPumpSystemTypes > 9 .AND. LocalCompAssigned( HtPumpSystem[10] ) .AND. IfValidAnd( HtPumpSystem[10]:EER > 0 )) then  min( ClSysEER, HtPumpSystem[10]:EER )  else  UNCHANGED  endif  }

	"Set HVACSys:ClSysCFMperTon - 1"		HVACSys:ClSysCFMperTon	= {	if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) .AND. IfValidAnd( HtPumpSystem[1]:CFMperTon  > 0 )) then                       HtPumpSystem[1]:CFMperTon     else      0      endif  }
	"Set HVACSys:ClSysCFMperTon - 2"		HVACSys:ClSysCFMperTon	= {	if (NumHtPumpSystemTypes > 1 .AND. LocalCompAssigned( HtPumpSystem[2]  ) .AND. IfValidAnd( HtPumpSystem[2]:CFMperTon  > 0 )) then  min( ClSysCFMperTon, HtPumpSystem[2]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCFMperTon - 3"		HVACSys:ClSysCFMperTon	= {	if (NumHtPumpSystemTypes > 2 .AND. LocalCompAssigned( HtPumpSystem[3]  ) .AND. IfValidAnd( HtPumpSystem[3]:CFMperTon  > 0 )) then  min( ClSysCFMperTon, HtPumpSystem[3]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCFMperTon - 4"		HVACSys:ClSysCFMperTon	= {	if (NumHtPumpSystemTypes > 3 .AND. LocalCompAssigned( HtPumpSystem[4]  ) .AND. IfValidAnd( HtPumpSystem[4]:CFMperTon  > 0 )) then  min( ClSysCFMperTon, HtPumpSystem[4]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCFMperTon - 5"		HVACSys:ClSysCFMperTon	= {	if (NumHtPumpSystemTypes > 4 .AND. LocalCompAssigned( HtPumpSystem[5]  ) .AND. IfValidAnd( HtPumpSystem[5]:CFMperTon  > 0 )) then  min( ClSysCFMperTon, HtPumpSystem[5]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCFMperTon - 6"		HVACSys:ClSysCFMperTon	= {	if (NumHtPumpSystemTypes > 5 .AND. LocalCompAssigned( HtPumpSystem[6]  ) .AND. IfValidAnd( HtPumpSystem[6]:CFMperTon  > 0 )) then  min( ClSysCFMperTon, HtPumpSystem[6]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCFMperTon - 7"		HVACSys:ClSysCFMperTon	= {	if (NumHtPumpSystemTypes > 6 .AND. LocalCompAssigned( HtPumpSystem[7]  ) .AND. IfValidAnd( HtPumpSystem[7]:CFMperTon  > 0 )) then  min( ClSysCFMperTon, HtPumpSystem[7]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCFMperTon - 8"		HVACSys:ClSysCFMperTon	= {	if (NumHtPumpSystemTypes > 7 .AND. LocalCompAssigned( HtPumpSystem[8]  ) .AND. IfValidAnd( HtPumpSystem[8]:CFMperTon  > 0 )) then  min( ClSysCFMperTon, HtPumpSystem[8]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCFMperTon - 9"		HVACSys:ClSysCFMperTon	= {	if (NumHtPumpSystemTypes > 8 .AND. LocalCompAssigned( HtPumpSystem[9]  ) .AND. IfValidAnd( HtPumpSystem[9]:CFMperTon  > 0 )) then  min( ClSysCFMperTon, HtPumpSystem[9]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCFMperTon - 10"	HVACSys:ClSysCFMperTon	= {	if (NumHtPumpSystemTypes > 9 .AND. LocalCompAssigned( HtPumpSystem[10] ) .AND. IfValidAnd( HtPumpSystem[10]:CFMperTon > 0 )) then  min( ClSysCFMperTon, HtPumpSystem[10]:CFMperTon )  else  UNCHANGED  endif  }

	"Set HVACSys:ClSysRefrigChgAdjFctr - 1"	HVACSys:ClSysRefrigChgAdjFctr	= {	if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) .AND. IfValidAnd( HtPumpSystem[1]:RefrigChgAdjFctr  > 0 )) then                              HtPumpSystem[1]:RefrigChgAdjFctr     else      0      endif  }
	"Set HVACSys:ClSysRefrigChgAdjFctr - 2"	HVACSys:ClSysRefrigChgAdjFctr	= {	if (NumHtPumpSystemTypes > 1 .AND. LocalCompAssigned( HtPumpSystem[2]  ) .AND. IfValidAnd( HtPumpSystem[2]:RefrigChgAdjFctr  > 0 )) then  min( ClSysRefrigChgAdjFctr, HtPumpSystem[2]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysRefrigChgAdjFctr - 3"	HVACSys:ClSysRefrigChgAdjFctr	= {	if (NumHtPumpSystemTypes > 2 .AND. LocalCompAssigned( HtPumpSystem[3]  ) .AND. IfValidAnd( HtPumpSystem[3]:RefrigChgAdjFctr  > 0 )) then  min( ClSysRefrigChgAdjFctr, HtPumpSystem[3]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysRefrigChgAdjFctr - 4"	HVACSys:ClSysRefrigChgAdjFctr	= {	if (NumHtPumpSystemTypes > 3 .AND. LocalCompAssigned( HtPumpSystem[4]  ) .AND. IfValidAnd( HtPumpSystem[4]:RefrigChgAdjFctr  > 0 )) then  min( ClSysRefrigChgAdjFctr, HtPumpSystem[4]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysRefrigChgAdjFctr - 5"	HVACSys:ClSysRefrigChgAdjFctr	= {	if (NumHtPumpSystemTypes > 4 .AND. LocalCompAssigned( HtPumpSystem[5]  ) .AND. IfValidAnd( HtPumpSystem[5]:RefrigChgAdjFctr  > 0 )) then  min( ClSysRefrigChgAdjFctr, HtPumpSystem[5]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysRefrigChgAdjFctr - 6"	HVACSys:ClSysRefrigChgAdjFctr	= {	if (NumHtPumpSystemTypes > 5 .AND. LocalCompAssigned( HtPumpSystem[6]  ) .AND. IfValidAnd( HtPumpSystem[6]:RefrigChgAdjFctr  > 0 )) then  min( ClSysRefrigChgAdjFctr, HtPumpSystem[6]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysRefrigChgAdjFctr - 7"	HVACSys:ClSysRefrigChgAdjFctr	= {	if (NumHtPumpSystemTypes > 6 .AND. LocalCompAssigned( HtPumpSystem[7]  ) .AND. IfValidAnd( HtPumpSystem[7]:RefrigChgAdjFctr  > 0 )) then  min( ClSysRefrigChgAdjFctr, HtPumpSystem[7]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysRefrigChgAdjFctr - 8"	HVACSys:ClSysRefrigChgAdjFctr	= {	if (NumHtPumpSystemTypes > 7 .AND. LocalCompAssigned( HtPumpSystem[8]  ) .AND. IfValidAnd( HtPumpSystem[8]:RefrigChgAdjFctr  > 0 )) then  min( ClSysRefrigChgAdjFctr, HtPumpSystem[8]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysRefrigChgAdjFctr - 9"	HVACSys:ClSysRefrigChgAdjFctr	= {	if (NumHtPumpSystemTypes > 8 .AND. LocalCompAssigned( HtPumpSystem[9]  ) .AND. IfValidAnd( HtPumpSystem[9]:RefrigChgAdjFctr  > 0 )) then  min( ClSysRefrigChgAdjFctr, HtPumpSystem[9]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysRefrigChgAdjFctr - 10"	HVACSys:ClSysRefrigChgAdjFctr	= {	if (NumHtPumpSystemTypes > 9 .AND. LocalCompAssigned( HtPumpSystem[10] ) .AND. IfValidAnd( HtPumpSystem[10]:RefrigChgAdjFctr > 0 )) then  min( ClSysRefrigChgAdjFctr, HtPumpSystem[10]:RefrigChgAdjFctr )  else  UNCHANGED  endif  }

; RULES TO SUMMARIZE ADDIITONAL COOLING PERFORMANCE PARAMETERS PASSED INTO CSE FOR SIMULATION

	"Set HVACSys:ClSysSizingFactor - 1"		HVACSys:ClSysSizingFactor	= {	if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) .AND. HtPumpSystemCount[1]  > 0 .AND. IfValidAnd( HtPumpSystem[1]:ClSizingFactor  > 0 )) then                      (HtPumpSystem[1]:ClSizingFactor  * HtPumpSystemCount[1] )  else      0      endif  }
	"Set HVACSys:ClSysSizingFactor - 2"		HVACSys:ClSysSizingFactor	= {	if (NumHtPumpSystemTypes > 1 .AND. LocalCompAssigned( HtPumpSystem[2]  ) .AND. HtPumpSystemCount[2]  > 0 .AND. IfValidAnd( HtPumpSystem[2]:ClSizingFactor  > 0 )) then  ClSysSizingFactor + (HtPumpSystem[2]:ClSizingFactor  * HtPumpSystemCount[2] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSizingFactor - 3"		HVACSys:ClSysSizingFactor	= {	if (NumHtPumpSystemTypes > 2 .AND. LocalCompAssigned( HtPumpSystem[3]  ) .AND. HtPumpSystemCount[3]  > 0 .AND. IfValidAnd( HtPumpSystem[3]:ClSizingFactor  > 0 )) then  ClSysSizingFactor + (HtPumpSystem[3]:ClSizingFactor  * HtPumpSystemCount[3] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSizingFactor - 4"		HVACSys:ClSysSizingFactor	= {	if (NumHtPumpSystemTypes > 3 .AND. LocalCompAssigned( HtPumpSystem[4]  ) .AND. HtPumpSystemCount[4]  > 0 .AND. IfValidAnd( HtPumpSystem[4]:ClSizingFactor  > 0 )) then  ClSysSizingFactor + (HtPumpSystem[4]:ClSizingFactor  * HtPumpSystemCount[4] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSizingFactor - 5"		HVACSys:ClSysSizingFactor	= {	if (NumHtPumpSystemTypes > 4 .AND. LocalCompAssigned( HtPumpSystem[5]  ) .AND. HtPumpSystemCount[5]  > 0 .AND. IfValidAnd( HtPumpSystem[5]:ClSizingFactor  > 0 )) then  ClSysSizingFactor + (HtPumpSystem[5]:ClSizingFactor  * HtPumpSystemCount[5] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSizingFactor - 6"		HVACSys:ClSysSizingFactor	= {	if (NumHtPumpSystemTypes > 5 .AND. LocalCompAssigned( HtPumpSystem[6]  ) .AND. HtPumpSystemCount[6]  > 0 .AND. IfValidAnd( HtPumpSystem[6]:ClSizingFactor  > 0 )) then  ClSysSizingFactor + (HtPumpSystem[6]:ClSizingFactor  * HtPumpSystemCount[6] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSizingFactor - 7"		HVACSys:ClSysSizingFactor	= {	if (NumHtPumpSystemTypes > 6 .AND. LocalCompAssigned( HtPumpSystem[7]  ) .AND. HtPumpSystemCount[7]  > 0 .AND. IfValidAnd( HtPumpSystem[7]:ClSizingFactor  > 0 )) then  ClSysSizingFactor + (HtPumpSystem[7]:ClSizingFactor  * HtPumpSystemCount[7] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSizingFactor - 8"		HVACSys:ClSysSizingFactor	= {	if (NumHtPumpSystemTypes > 7 .AND. LocalCompAssigned( HtPumpSystem[8]  ) .AND. HtPumpSystemCount[8]  > 0 .AND. IfValidAnd( HtPumpSystem[8]:ClSizingFactor  > 0 )) then  ClSysSizingFactor + (HtPumpSystem[8]:ClSizingFactor  * HtPumpSystemCount[8] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSizingFactor - 9"		HVACSys:ClSysSizingFactor	= {	if (NumHtPumpSystemTypes > 8 .AND. LocalCompAssigned( HtPumpSystem[9]  ) .AND. HtPumpSystemCount[9]  > 0 .AND. IfValidAnd( HtPumpSystem[9]:ClSizingFactor  > 0 )) then  ClSysSizingFactor + (HtPumpSystem[9]:ClSizingFactor  * HtPumpSystemCount[9] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSizingFactor - 10"	HVACSys:ClSysSizingFactor	= {	if (NumHtPumpSystemTypes > 9 .AND. LocalCompAssigned( HtPumpSystem[10] ) .AND. HtPumpSystemCount[10] > 0 .AND. IfValidAnd( HtPumpSystem[10]:ClSizingFactor > 0 )) then  ClSysSizingFactor + (HtPumpSystem[10]:ClSizingFactor * HtPumpSystemCount[10])  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysSizingFactor - XX"	HVACSys:ClSysSizingFactor	= {	if (NumHtPumpSysUnits > 0.5) then  ClSysSizingFactor / NumHtPumpSysUnits  else  UNCHANGED  endif  }

	"Set HVACSys:ClSysCapacity - 1"		HVACSys:ClSysCapacity	= {	if (AutoSizeCool[1]  == 0 .AND. NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) .AND. HtPumpSystemCount[1]  > 0 .AND. IfValidAnd( HtPumpSystem[1]:TotalCapacity  > 0 )) then                  (HtPumpSystem[1]:TotalCapacity  * HtPumpSystemCount[1] )  else      0      endif  }
	"Set HVACSys:ClSysCapacity - 2"		HVACSys:ClSysCapacity	= {	if (AutoSizeCool[2]  == 0 .AND. NumHtPumpSystemTypes > 1 .AND. LocalCompAssigned( HtPumpSystem[2]  ) .AND. HtPumpSystemCount[2]  > 0 .AND. IfValidAnd( HtPumpSystem[2]:TotalCapacity  > 0 )) then  ClSysCapacity + (HtPumpSystem[2]:TotalCapacity  * HtPumpSystemCount[2] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCapacity - 3" 		HVACSys:ClSysCapacity	= {	if (AutoSizeCool[3]  == 0 .AND. NumHtPumpSystemTypes > 2 .AND. LocalCompAssigned( HtPumpSystem[3]  ) .AND. HtPumpSystemCount[3]  > 0 .AND. IfValidAnd( HtPumpSystem[3]:TotalCapacity  > 0 )) then  ClSysCapacity + (HtPumpSystem[3]:TotalCapacity  * HtPumpSystemCount[3] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCapacity - 4" 		HVACSys:ClSysCapacity	= {	if (AutoSizeCool[4]  == 0 .AND. NumHtPumpSystemTypes > 3 .AND. LocalCompAssigned( HtPumpSystem[4]  ) .AND. HtPumpSystemCount[4]  > 0 .AND. IfValidAnd( HtPumpSystem[4]:TotalCapacity  > 0 )) then  ClSysCapacity + (HtPumpSystem[4]:TotalCapacity  * HtPumpSystemCount[4] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCapacity - 5" 		HVACSys:ClSysCapacity	= {	if (AutoSizeCool[5]  == 0 .AND. NumHtPumpSystemTypes > 4 .AND. LocalCompAssigned( HtPumpSystem[5]  ) .AND. HtPumpSystemCount[5]  > 0 .AND. IfValidAnd( HtPumpSystem[5]:TotalCapacity  > 0 )) then  ClSysCapacity + (HtPumpSystem[5]:TotalCapacity  * HtPumpSystemCount[5] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCapacity - 6" 		HVACSys:ClSysCapacity	= {	if (AutoSizeCool[6]  == 0 .AND. NumHtPumpSystemTypes > 5 .AND. LocalCompAssigned( HtPumpSystem[6]  ) .AND. HtPumpSystemCount[6]  > 0 .AND. IfValidAnd( HtPumpSystem[6]:TotalCapacity  > 0 )) then  ClSysCapacity + (HtPumpSystem[6]:TotalCapacity  * HtPumpSystemCount[6] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCapacity - 7" 		HVACSys:ClSysCapacity	= {	if (AutoSizeCool[7]  == 0 .AND. NumHtPumpSystemTypes > 6 .AND. LocalCompAssigned( HtPumpSystem[7]  ) .AND. HtPumpSystemCount[7]  > 0 .AND. IfValidAnd( HtPumpSystem[7]:TotalCapacity  > 0 )) then  ClSysCapacity + (HtPumpSystem[7]:TotalCapacity  * HtPumpSystemCount[7] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCapacity - 8" 		HVACSys:ClSysCapacity	= {	if (AutoSizeCool[8]  == 0 .AND. NumHtPumpSystemTypes > 7 .AND. LocalCompAssigned( HtPumpSystem[8]  ) .AND. HtPumpSystemCount[8]  > 0 .AND. IfValidAnd( HtPumpSystem[8]:TotalCapacity  > 0 )) then  ClSysCapacity + (HtPumpSystem[8]:TotalCapacity  * HtPumpSystemCount[8] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCapacity - 9" 		HVACSys:ClSysCapacity	= {	if (AutoSizeCool[9]  == 0 .AND. NumHtPumpSystemTypes > 8 .AND. LocalCompAssigned( HtPumpSystem[9]  ) .AND. HtPumpSystemCount[9]  > 0 .AND. IfValidAnd( HtPumpSystem[9]:TotalCapacity  > 0 )) then  ClSysCapacity + (HtPumpSystem[9]:TotalCapacity  * HtPumpSystemCount[9] )  else  UNCHANGED  endif  }
	"Set HVACSys:ClSysCapacity - 10"		HVACSys:ClSysCapacity	= {	if (AutoSizeCool[10] == 0 .AND. NumHtPumpSystemTypes > 9 .AND. LocalCompAssigned( HtPumpSystem[10] ) .AND. HtPumpSystemCount[10] > 0 .AND. IfValidAnd( HtPumpSystem[10]:TotalCapacity > 0 )) then  ClSysCapacity + (HtPumpSystem[10]:TotalCapacity * HtPumpSystemCount[10])  else  UNCHANGED  endif  }

	"Set HVACSys:CoolEquipSummary"	HVACSys:CoolEquipSummary	=        ; SAC 6/22/20 - added COP47 reporting for PkgTermHeatPump & SglPkgVertHeatPump (tic #1225 & #1226)   ; SAC 08/19/20 (tic #1003)
				{	if (NumHtPumpSystemTypes <= 0 .OR. NumHtPumpSysUnits < 1 .OR. LocalCompAssigned( HtPumpSystem[1] ) == 0) then  " "
					else if (HtPumpSystem[1]:IsAvailable > 0)
			;		then	Format( "%.0f %s unit(s), %.1f SEER, %.1f EER, %.1f CFM/ton", NumCoolSysUnits, CoolSysTypeAbbrev, ClSysSEER, ClSysEER, ClSysCFMperTon )
					then	if (HtPumpSystem[1]:Type == 22 .OR. HtPumpSystem[1]:Type == 33)   ; SAC 11/2/18 - VCHP   ; VCHP2 - SAC 11/01/20
  							then  " "
							else if (IfValidAnd( HtPumpSystem[1]:ShowCEER > 0 ))
							then	Format( "%.1f CEER", HtPumpSystem[1]:CEER )
							else if (HtPumpSystem[1]:Type == 11 .OR. IfValidAnd( HtPumpSystem[1]:Show4717COPs > 0 ))
							then	Format( "%.1f EER", ClSysEER )
  							else 	Format( "%.1f SEER, %.1f EER, %.0f CFM/ton", ClSysSEER, ClSysEER, ClSysCFMperTon )
							endif endif endif
					else	" "
					endif endif  }
;	"debug HVACSys:CoolEquipSummary"		HVACSys:Action		= {	if (FloorAreaServed > 0.5) then PostWarning( "HVACSys: '%s' CoolEquipSummary: '%s'", Name, CoolEquipSummary ) else UNCHANGED endif }

	"Set HVACSys:HtPumpEquipIssue"		HVACSys:HtPumpEquipIssue		=           ; added checks to ensure consistency in AutoSize flags - SAC 03/11/21
				{	if (NumHtPumpSystemTypes <= 0) then  " "
					else if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) == 0) then  "All heat pump equipment assignments must be specified (first is excluded)"
					else if (NumHtPumpSystemTypes > 1 .AND. LocalCompAssigned( HtPumpSystem[2]  ) == 0) then  "All heat pump equipment assignments must be specified (second is excluded)"
					else if (NumHtPumpSystemTypes > 2 .AND. LocalCompAssigned( HtPumpSystem[3]  ) == 0) then  "All heat pump equipment assignments must be specified (third is excluded)"
					else if (NumHtPumpSystemTypes > 3 .AND. LocalCompAssigned( HtPumpSystem[4]  ) == 0) then  "All heat pump equipment assignments must be specified (fourth is excluded)"
					else if (NumHtPumpSystemTypes > 4 .AND. LocalCompAssigned( HtPumpSystem[5]  ) == 0) then  "All heat pump equipment assignments must be specified (fifth is excluded)"
					else if (NumHtPumpSystemTypes > 5 .AND. LocalCompAssigned( HtPumpSystem[6]  ) == 0) then  "All heat pump equipment assignments must be specified (sixth is excluded)"
					else if (NumHtPumpSystemTypes > 6 .AND. LocalCompAssigned( HtPumpSystem[7]  ) == 0) then  "All heat pump equipment assignments must be specified (seventh is excluded)"
					else if (NumHtPumpSystemTypes > 7 .AND. LocalCompAssigned( HtPumpSystem[8]  ) == 0) then  "All heat pump equipment assignments must be specified (eighth is excluded)"
					else if (NumHtPumpSystemTypes > 8 .AND. LocalCompAssigned( HtPumpSystem[9]  ) == 0) then  "All heat pump equipment assignments must be specified (ninth is excluded)"
					else if (NumHtPumpSystemTypes > 9 .AND. LocalCompAssigned( HtPumpSystem[10] ) == 0) then  "All heat pump equipment assignments must be specified (tenth is excluded)"
					else if (NumHtPumpSystemTypes > 1 .AND. HtPumpSystem[2]:Type  != HtPumpSystem[1]:Type) then  Format( "All assigned heat pump equipment must be of the same type (#1: %s / #2: %s)",  HtPumpSystem[1]:TypeAbbrevStr, HtPumpSystem[2]:TypeAbbrevStr )
					else if (NumHtPumpSystemTypes > 2 .AND. HtPumpSystem[3]:Type  != HtPumpSystem[1]:Type) then  Format( "All assigned heat pump equipment must be of the same type (#1: %s / #3: %s)",  HtPumpSystem[1]:TypeAbbrevStr, HtPumpSystem[3]:TypeAbbrevStr )
					else if (NumHtPumpSystemTypes > 3 .AND. HtPumpSystem[4]:Type  != HtPumpSystem[1]:Type) then  Format( "All assigned heat pump equipment must be of the same type (#1: %s / #4: %s)",  HtPumpSystem[1]:TypeAbbrevStr, HtPumpSystem[4]:TypeAbbrevStr )
					else if (NumHtPumpSystemTypes > 4 .AND. HtPumpSystem[5]:Type  != HtPumpSystem[1]:Type) then  Format( "All assigned heat pump equipment must be of the same type (#1: %s / #5: %s)",  HtPumpSystem[1]:TypeAbbrevStr, HtPumpSystem[5]:TypeAbbrevStr )
					else if (NumHtPumpSystemTypes > 5 .AND. HtPumpSystem[6]:Type  != HtPumpSystem[1]:Type) then  Format( "All assigned heat pump equipment must be of the same type (#1: %s / #6: %s)",  HtPumpSystem[1]:TypeAbbrevStr, HtPumpSystem[6]:TypeAbbrevStr )
					else if (NumHtPumpSystemTypes > 6 .AND. HtPumpSystem[7]:Type  != HtPumpSystem[1]:Type) then  Format( "All assigned heat pump equipment must be of the same type (#1: %s / #7: %s)",  HtPumpSystem[1]:TypeAbbrevStr, HtPumpSystem[7]:TypeAbbrevStr )
					else if (NumHtPumpSystemTypes > 7 .AND. HtPumpSystem[8]:Type  != HtPumpSystem[1]:Type) then  Format( "All assigned heat pump equipment must be of the same type (#1: %s / #8: %s)",  HtPumpSystem[1]:TypeAbbrevStr, HtPumpSystem[8]:TypeAbbrevStr )
					else if (NumHtPumpSystemTypes > 8 .AND. HtPumpSystem[9]:Type  != HtPumpSystem[1]:Type) then  Format( "All assigned heat pump equipment must be of the same type (#1: %s / #9: %s)",  HtPumpSystem[1]:TypeAbbrevStr, HtPumpSystem[9]:TypeAbbrevStr )
					else if (NumHtPumpSystemTypes > 9 .AND. HtPumpSystem[10]:Type != HtPumpSystem[1]:Type) then  Format( "All assigned heat pump equipment must be of the same type (#1: %s / #10: %s)", HtPumpSystem[1]:TypeAbbrevStr, HtPumpSystem[10]:TypeAbbrevStr )
					else if (NumHtPumpSystemTypes > 1 .AND. HtPumpSystem[2]:AutoSize  != HtPumpSystem[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized heat pump equipment (#1 & #2 inconsistent)"
					else if (NumHtPumpSystemTypes > 2 .AND. HtPumpSystem[3]:AutoSize  != HtPumpSystem[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized heat pump equipment (#1 & #3 inconsistent)"
					else if (NumHtPumpSystemTypes > 3 .AND. HtPumpSystem[4]:AutoSize  != HtPumpSystem[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized heat pump equipment (#1 & #4 inconsistent)"
					else if (NumHtPumpSystemTypes > 4 .AND. HtPumpSystem[5]:AutoSize  != HtPumpSystem[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized heat pump equipment (#1 & #5 inconsistent)"
					else if (NumHtPumpSystemTypes > 5 .AND. HtPumpSystem[6]:AutoSize  != HtPumpSystem[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized heat pump equipment (#1 & #6 inconsistent)"
					else if (NumHtPumpSystemTypes > 6 .AND. HtPumpSystem[7]:AutoSize  != HtPumpSystem[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized heat pump equipment (#1 & #7 inconsistent)"
					else if (NumHtPumpSystemTypes > 7 .AND. HtPumpSystem[8]:AutoSize  != HtPumpSystem[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized heat pump equipment (#1 & #8 inconsistent)"
					else if (NumHtPumpSystemTypes > 8 .AND. HtPumpSystem[9]:AutoSize  != HtPumpSystem[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized heat pump equipment (#1 & #9 inconsistent)"
					else if (NumHtPumpSystemTypes > 9 .AND. HtPumpSystem[10]:AutoSize != HtPumpSystem[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized heat pump equipment (#1 & #10 inconsistent)"
					else  " "  endif endif endif endif endif endif endif endif endif endif endif  endif endif endif endif endif endif endif endif endif  endif endif endif endif endif endif endif endif endif  }

; SAC 8/23/13 - moved ConstHtgSetpt from HVACHeat as part of HVAHeat array mods
	"Default HVACSys:ConstHtgSetpt"		HVACSys:ConstHtgSetpt	= {	if (strlen( HtPumpSysTypeAbbrev ) < 2) then  -1
																							else  T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev )  endif  }
	"Init HVACSys:ConstClgSetpt"			HVACSys:ConstClgSetpt	= {	UNDEFINED  }

	"Set HVACSys:EqpCountsMustAlign"		HVACSys:EqpCountsMustAlign	= {	0  }

	; SAC 5/3/16 - added new flag to facilitate HERS flag for zonal systems w/ bypass ducts (tic #634)
	"Set HVACSys:ZonalSysBypassDuct"		HVACSys:ZonalSysBypassDuct	= {
								if (FloorAreaServed[1] < 1 .OR. (HeatDucted < 0.5 .AND. CoolDucted < 0.5) .OR. LocalCompAssigned( DistribSystem ) < 1) then  0
								else if (IfValidAnd( DistribSystem:HasBypassDuct > 0.5 )==0 .OR. IfValidAnd( DistribSystem:DuctsPresent > 0.5 )==0) then  0
								else if (NumHtPumpSystemTypes >=  1 .AND. IfValidAnd( HtPumpSystem[1]:IsZonal  > 0.5 ) .AND. IfValidAnd( HtPumpSystem[1]:ShowIsZonal  > 0.5 )) then  1
								else if (NumHtPumpSystemTypes >=  2 .AND. IfValidAnd( HtPumpSystem[2]:IsZonal  > 0.5 ) .AND. IfValidAnd( HtPumpSystem[2]:ShowIsZonal  > 0.5 )) then  1
								else if (NumHtPumpSystemTypes >=  3 .AND. IfValidAnd( HtPumpSystem[3]:IsZonal  > 0.5 ) .AND. IfValidAnd( HtPumpSystem[3]:ShowIsZonal  > 0.5 )) then  1
								else if (NumHtPumpSystemTypes >=  4 .AND. IfValidAnd( HtPumpSystem[4]:IsZonal  > 0.5 ) .AND. IfValidAnd( HtPumpSystem[4]:ShowIsZonal  > 0.5 )) then  1
								else if (NumHtPumpSystemTypes >=  5 .AND. IfValidAnd( HtPumpSystem[5]:IsZonal  > 0.5 ) .AND. IfValidAnd( HtPumpSystem[5]:ShowIsZonal  > 0.5 )) then  1
								else if (NumHtPumpSystemTypes >=  6 .AND. IfValidAnd( HtPumpSystem[6]:IsZonal  > 0.5 ) .AND. IfValidAnd( HtPumpSystem[6]:ShowIsZonal  > 0.5 )) then  1
								else if (NumHtPumpSystemTypes >=  7 .AND. IfValidAnd( HtPumpSystem[7]:IsZonal  > 0.5 ) .AND. IfValidAnd( HtPumpSystem[7]:ShowIsZonal  > 0.5 )) then  1
								else if (NumHtPumpSystemTypes >=  8 .AND. IfValidAnd( HtPumpSystem[8]:IsZonal  > 0.5 ) .AND. IfValidAnd( HtPumpSystem[8]:ShowIsZonal  > 0.5 )) then  1
								else if (NumHtPumpSystemTypes >=  9 .AND. IfValidAnd( HtPumpSystem[9]:IsZonal  > 0.5 ) .AND. IfValidAnd( HtPumpSystem[9]:ShowIsZonal  > 0.5 )) then  1
								else if (NumHtPumpSystemTypes >= 10 .AND. IfValidAnd( HtPumpSystem[10]:IsZonal > 0.5 ) .AND. IfValidAnd( HtPumpSystem[10]:ShowIsZonal > 0.5 )) then  1
								else	0  endif endif endif endif endif endif endif endif endif endif endif endif  }

	"Init HVACSys:HeatDuctedEditable"	HVACSys:HeatDuctedEditable	= {	UNDEFINED  }
	"Init HVACSys:HtSysAFUE"				HVACSys:HtSysAFUE				= {	UNDEFINED  }
	"Init HVACSys:HtSysSizingFactor"		HVACSys:HtSysSizingFactor	= {	UNDEFINED  }
	"Init HVACSys:HtSysCapacity"			HVACSys:HtSysCapacity		= {	UNDEFINED  }
	"Init HVACSys:HeatEquipIssue"			HVACSys:HeatEquipIssue		= {	UNDEFINED  }
	"Init HVACSys:CoolDuctedEditable"	HVACSys:CoolDuctedEditable	= {	UNDEFINED  }
	"Init HVACSys:CoolEquipIssue"			HVACSys:CoolEquipIssue		= {	UNDEFINED  }

	"Initialize other generic properties (common to Ht/Cl/HP)"		HVACSys:Action	= {	EvalRulelist( "SetupHVACSys_Round2_common", 1 )  }
END

; SAC 11/26/14 - added rulelists to blast user-specified *Ducted if it is inconsistent w/ the DuctFlag value in the HVAC equipment tables
;*************************************************************************
RULELIST "BlastUserUnput_HVACSys_HeatDucted" 1 0 0 0
	"Blast user input HVACSys:HeatDucted"		HVACSys:HeatDucted	= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "BlastUserUnput_HVACSys_CoolDucted" 1 0 0 0
	"Blast user input HVACSys:CoolDucted"		HVACSys:CoolDucted	= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "BlastUserUnput_HVACSys_HtPumpDucted" 1 0 0 0
	"Blast user input HVACSys:HtPumpDucted"	HVACSys:HtPumpDucted	= {	UNDEFINED  }
END
;*************************************************************************

;*************************************************************************    - SAC 11/14/18 - blast Ducted HP checkbox and Dist & Fan assignments for VCHP systems
RULELIST "Reset_HVACSys_HtPump_Ducts" 1 0 0 0
   "Reset HVACSys:HtPumpDucted"     HVACSys:HtPumpDucted   = {  UNDEFINED  }
   "Reset HVACSys:DistribSystem"    HVACSys:DistribSystem  = {  UNDEFINED  }
   "Reset HVACSys:Fan"              HVACSys:Fan            = {  UNDEFINED  }
END
;*************************************************************************

; SAC 1/18/16 - revised rules to force override of HVACSys:HeatDucted & CoolDucted if they are user-defiend and inconsistent w/ HtPumpDucted (to fix HERS AHUAirFlow reporting bug)
;*************************************************************************
RULELIST "Force_HVACSys_HeatDucted_HtPumpDucted" 1 0 0 0
	"Set HVACSys:HeatDucted"		HVACSys:HeatDucted	= {	HtPumpDucted  }
END
;*************************************************************************
RULELIST "Force_HVACSys_CoolDucted_HtPumpDucted" 1 0 0 0
	"Set HVACSys:CoolDucted"		HVACSys:CoolDucted	= {	HtPumpDucted  }
END
;*************************************************************************

; SAC 6/21/14 - setup secondary set of DwellUnitType Heat/Cool assignment properties
;*************************************************************************
RULELIST "SetupDwellUnitType_Round2_HeatCool" 0 0 0 0
;*************************************************************************
	"Set DwellUnitType:HeatEqpTypeAbbrev"	DwellUnitType:HeatEqpTypeAbbrev	= {	if (NumHeatEquipTypes > 0 .AND. LocalCompAssigned( HVACHeatRef[1] ))
																							then  HVACHeatRef[1]:TypeAbbrevStr
																							else  " "  endif  }

;	; SAC 8/24/13 - moved Ducted* properties to HVACSys from HVACHeat
;		"Default DwellUnitType:HeatDucted"				DwellUnitType:HeatDucted				= {	if (HeatEqpType < 1 .OR. LocalCompAssigned( HVACHeatRef[1] ) == 0) then  0
;																											else if (HVACHeatRef[1]:IsAvailable < 0.5) then  0
;																											else if (T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HeatEqpTypeAbbrev ) == 1) then  1
;																											else  0  endif endif endif  }
;		"Default DwellUnitType:HeatDuctedEditable"	DwellUnitType:HeatDuctedEditable		= {	if (HeatEqpType < 1 .OR. LocalCompAssigned( HVACHeatRef[1] ) == 0) then  0
;																											else if (HVACHeatRef[1]:IsAvailable < 0.5) then  0
;																											else if (T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HeatEqpTypeAbbrev ) < 0) then  1
;																											else  0  endif endif endif  }

; SAC 1/6/14 - revised logic to handle defaulting of AFUE for combined hydronic Equips (related to GC issue #254)
	"Set DwellUnitType:HtEqpAFUE - 1"	DwellUnitType:HtEqpAFUE	= {	if (NumHeatEquipTypes > 0 .AND. LocalCompAssigned( HVACHeatRef[1]  ) .AND. (HVACHeatRef[1]:DisplayAFUE  > 0 .OR. HVACHeatRef[1]:Type  == 9)) then                  HVACHeatRef[1]:AFUE     else      0      endif  }
	"Set DwellUnitType:HtEqpAFUE - 2"	DwellUnitType:HtEqpAFUE	= {	if (NumHeatEquipTypes > 1 .AND. LocalCompAssigned( HVACHeatRef[2]  ) .AND. (HVACHeatRef[2]:DisplayAFUE  > 0 .OR. HVACHeatRef[2]:Type  == 9)) then  min( HtEqpAFUE, HVACHeatRef[2]:AFUE  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:HtEqpAFUE - 3"	DwellUnitType:HtEqpAFUE	= {	if (NumHeatEquipTypes > 2 .AND. LocalCompAssigned( HVACHeatRef[3]  ) .AND. (HVACHeatRef[3]:DisplayAFUE  > 0 .OR. HVACHeatRef[3]:Type  == 9)) then  min( HtEqpAFUE, HVACHeatRef[3]:AFUE  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:HtEqpAFUE - 4"	DwellUnitType:HtEqpAFUE	= {	if (NumHeatEquipTypes > 3 .AND. LocalCompAssigned( HVACHeatRef[4]  ) .AND. (HVACHeatRef[4]:DisplayAFUE  > 0 .OR. HVACHeatRef[4]:Type  == 9)) then  min( HtEqpAFUE, HVACHeatRef[4]:AFUE  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:HtEqpAFUE - 5"	DwellUnitType:HtEqpAFUE	= {	if (NumHeatEquipTypes > 4 .AND. LocalCompAssigned( HVACHeatRef[5]  ) .AND. (HVACHeatRef[5]:DisplayAFUE  > 0 .OR. HVACHeatRef[5]:Type  == 9)) then  min( HtEqpAFUE, HVACHeatRef[5]:AFUE  )  else  UNCHANGED  endif  }

;		"Set DwellUnitType:HtEqpSizingFactor - 1"		DwellUnitType:HtEqpSizingFactor	= {	if (NumHeatEquipTypes > 0 .AND. LocalCompAssigned( HVACHeatRef[1]  ) .AND. HeatEquipCount[1]  > 0) then                      (HVACHeatRef[1]:SizingFactor  * HeatEquipCount[1] )  else      0      endif  }
;		"Set DwellUnitType:HtEqpSizingFactor - 2"		DwellUnitType:HtEqpSizingFactor	= {	if (NumHeatEquipTypes > 1 .AND. LocalCompAssigned( HVACHeatRef[2]  ) .AND. HeatEquipCount[2]  > 0) then  HtEqpSizingFactor + (HVACHeatRef[2]:SizingFactor  * HeatEquipCount[2] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HtEqpSizingFactor - 3"		DwellUnitType:HtEqpSizingFactor	= {	if (NumHeatEquipTypes > 2 .AND. LocalCompAssigned( HVACHeatRef[3]  ) .AND. HeatEquipCount[3]  > 0) then  HtEqpSizingFactor + (HVACHeatRef[3]:SizingFactor  * HeatEquipCount[3] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HtEqpSizingFactor - 4"		DwellUnitType:HtEqpSizingFactor	= {	if (NumHeatEquipTypes > 3 .AND. LocalCompAssigned( HVACHeatRef[4]  ) .AND. HeatEquipCount[4]  > 0) then  HtEqpSizingFactor + (HVACHeatRef[4]:SizingFactor  * HeatEquipCount[4] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HtEqpSizingFactor - 5"		DwellUnitType:HtEqpSizingFactor	= {	if (NumHeatEquipTypes > 4 .AND. LocalCompAssigned( HVACHeatRef[5]  ) .AND. HeatEquipCount[5]  > 0) then  HtEqpSizingFactor + (HVACHeatRef[5]:SizingFactor  * HeatEquipCount[5] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HtEqpSizingFactor - XX"	DwellUnitType:HtEqpSizingFactor	= {	if (NumHeatEqpUnits > 0.5) then  HtEqpSizingFactor / NumHeatEqpUnits  else  UNCHANGED  endif  }
;	
;		"Set DwellUnitType:HtEqpCapacity - 1"		DwellUnitType:HtEqpCapacity	= {	if (AutoSizeHeat[1]  == 0 .AND. NumHeatEquipTypes > 0 .AND. LocalCompAssigned( HVACHeatRef[1]  ) .AND. HeatEquipCount[1]  > 0) then                  (HVACHeatRef[1]:TotalCapacity  * HeatEquipCount[1] )  else      0      endif  }
;		"Set DwellUnitType:HtEqpCapacity - 2"		DwellUnitType:HtEqpCapacity	= {	if (AutoSizeHeat[2]  == 0 .AND. NumHeatEquipTypes > 1 .AND. LocalCompAssigned( HVACHeatRef[2]  ) .AND. HeatEquipCount[2]  > 0) then  HtEqpCapacity + (HVACHeatRef[2]:TotalCapacity  * HeatEquipCount[2] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HtEqpCapacity - 3" 		DwellUnitType:HtEqpCapacity	= {	if (AutoSizeHeat[3]  == 0 .AND. NumHeatEquipTypes > 2 .AND. LocalCompAssigned( HVACHeatRef[3]  ) .AND. HeatEquipCount[3]  > 0) then  HtEqpCapacity + (HVACHeatRef[3]:TotalCapacity  * HeatEquipCount[3] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HtEqpCapacity - 4" 		DwellUnitType:HtEqpCapacity	= {	if (AutoSizeHeat[4]  == 0 .AND. NumHeatEquipTypes > 3 .AND. LocalCompAssigned( HVACHeatRef[4]  ) .AND. HeatEquipCount[4]  > 0) then  HtEqpCapacity + (HVACHeatRef[4]:TotalCapacity  * HeatEquipCount[4] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HtEqpCapacity - 5" 		DwellUnitType:HtEqpCapacity	= {	if (AutoSizeHeat[5]  == 0 .AND. NumHeatEquipTypes > 4 .AND. LocalCompAssigned( HVACHeatRef[5]  ) .AND. HeatEquipCount[5]  > 0) then  HtEqpCapacity + (HVACHeatRef[5]:TotalCapacity  * HeatEquipCount[5] )  else  UNCHANGED  endif  }

; SAC 1/6/14 - revised logic to incorporate AFUE for combined hydronic Equips into efficiency message (related to GC issue #254)
; SAC 1/14/14 - fixed other labels (namely ELecFurn) (GC issue #271)
	"Set DwellUnitType:HeatEquipSummary"	DwellUnitType:HeatEquipSummary	= {
					if (NumHeatEquipTypes <= 0) then  " "
					else if (NumHeatEqpUnits < 1) then  "No heating equipment units (counts) defined"
					else if (LocalCompAssigned( HVACHeatRef[1] ) == 0) then  "Heating equipment assignment #1 not defined"
					else if (HVACHeatRef[1]:IsAvailable > 0 .AND. HVACHeatRef[1]:Type == 9)
					then	Format( "%.0f %s unit(s), AFUEeff %.1f", NumHeatEqpUnits, HeatEqpTypeAbbrev, HtEqpAFUE )
					else if (HVACHeatRef[1]:IsAvailable > 0 .AND. HVACHeatRef[1]:DisplayAFUE > 0)
					then	Format( "%.0f %s unit(s), AFUE %.1f", NumHeatEqpUnits, HeatEqpTypeAbbrev, HtEqpAFUE )
					else	switch (HVACHeatRef[1]:Type)
								case  2 :	Format( "%.0f %s unit(s)", NumHeatEqpUnits, HeatEqpTypeAbbrev ) 	; "Heater - Non-central fuel-fired space heater"
								case  3 :	Format( "%.0f %s unit(s)", NumHeatEqpUnits, HeatEqpTypeAbbrev )		; "Boiler - Gas or oil boiler"
								case  8 :	Format( "%.0f %s unit(s)", NumHeatEqpUnits, HeatEqpTypeAbbrev )		; "Electric - All electric heating Equips other than heat pump"
								default :	Format( "%.0f %s unit(s)", NumHeatEqpUnits, HeatEqpTypeAbbrev )
							endswitch
					endif endif endif endif endif  }

	"Set DwellUnitType:HeatEquipIssue"		DwellUnitType:HeatEquipIssue		= {
					if (NumHeatEquipTypes <= 0) then  " "
					else if (NumHeatEquipTypes > 0 .AND. LocalCompAssigned( HVACHeatRef[1]  ) == 0) then  "All heating equipment assignments must be specified (first is excluded)"
					else if (NumHeatEquipTypes > 1 .AND. LocalCompAssigned( HVACHeatRef[2]  ) == 0) then  "All heating equipment assignments must be specified (second is excluded)"
					else if (NumHeatEquipTypes > 2 .AND. LocalCompAssigned( HVACHeatRef[3]  ) == 0) then  "All heating equipment assignments must be specified (third is excluded)"
					else if (NumHeatEquipTypes > 3 .AND. LocalCompAssigned( HVACHeatRef[4]  ) == 0) then  "All heating equipment assignments must be specified (fourth is excluded)"
					else if (NumHeatEquipTypes > 4 .AND. LocalCompAssigned( HVACHeatRef[5]  ) == 0) then  "All heating equipment assignments must be specified (fifth is excluded)"
					else if (NumHeatEquipTypes > 1 .AND. HVACHeatRef[2]:Type  != HVACHeatRef[1]:Type) then  Format( "All assigned heating equipment must be of the same type (#1: %s / #2: %s)",  HVACHeatRef[1]:TypeAbbrevStr, HVACHeatRef[2]:TypeAbbrevStr )
					else if (NumHeatEquipTypes > 2 .AND. HVACHeatRef[3]:Type  != HVACHeatRef[1]:Type) then  Format( "All assigned heating equipment must be of the same type (#1: %s / #3: %s)",  HVACHeatRef[1]:TypeAbbrevStr, HVACHeatRef[3]:TypeAbbrevStr )
					else if (NumHeatEquipTypes > 3 .AND. HVACHeatRef[4]:Type  != HVACHeatRef[1]:Type) then  Format( "All assigned heating equipment must be of the same type (#1: %s / #4: %s)",  HVACHeatRef[1]:TypeAbbrevStr, HVACHeatRef[4]:TypeAbbrevStr )
					else if (NumHeatEquipTypes > 4 .AND. HVACHeatRef[5]:Type  != HVACHeatRef[1]:Type) then  Format( "All assigned heating equipment must be of the same type (#1: %s / #5: %s)",  HVACHeatRef[1]:TypeAbbrevStr, HVACHeatRef[5]:TypeAbbrevStr )
					else  " "  endif endif endif endif endif endif endif endif endif endif  }


  ; More HVACSys cooling equipment summarization
	"Set DwellUnitType:CoolEqpTypeAbbrev"	DwellUnitType:CoolEqpTypeAbbrev	= {	if (NumCoolEquipTypes > 0 .AND. LocalCompAssigned( HVACCoolRef[1] ))
																							then  HVACCoolRef[1]:TypeAbbrevStr
																							else  " "  endif  }

;	; SAC 8/24/13 - moved Ducted* properties to HVACSys from HVACHeat
;		"Default DwellUnitType:CoolDucted"				DwellUnitType:CoolDucted				= {	if (CoolEqpType < 1 .OR. LocalCompAssigned( HVACCoolRef[1] ) == 0) then  0
;																											else if (HVACCoolRef[1]:IsAvailable < 0.5) then  0
;																											else if (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolEqpTypeAbbrev ) == 1) then  1
;																											else  0  endif endif endif  }
;		"Default DwellUnitType:CoolDuctedEditable"	DwellUnitType:CoolDuctedEditable		= {	if (CoolEqpType < 1 .OR. LocalCompAssigned( HVACCoolRef[1] ) == 0) then  0
;																											else if (HVACCoolRef[1]:IsAvailable < 0.5) then  0
;																											else if (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolEqpTypeAbbrev ) < 0) then  1
;																											else  0  endif endif endif  }

	"Set DwellUnitType:ClEqpSEER - 1"	DwellUnitType:ClEqpSEER	= {	if (NumCoolEquipTypes > 0 .AND. IfValidAnd( HVACCoolRef[1]:SEER  >= 0 )) then                  HVACCoolRef[1]:SEER     else      0      endif  }
	"Set DwellUnitType:ClEqpSEER - 2"	DwellUnitType:ClEqpSEER	= {	if (NumCoolEquipTypes > 1 .AND. IfValidAnd( HVACCoolRef[2]:SEER  >= 0 )) then  min( ClEqpSEER, HVACCoolRef[2]:SEER  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpSEER - 3"	DwellUnitType:ClEqpSEER	= {	if (NumCoolEquipTypes > 2 .AND. IfValidAnd( HVACCoolRef[3]:SEER  >= 0 )) then  min( ClEqpSEER, HVACCoolRef[3]:SEER  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpSEER - 4"	DwellUnitType:ClEqpSEER	= {	if (NumCoolEquipTypes > 3 .AND. IfValidAnd( HVACCoolRef[4]:SEER  >= 0 )) then  min( ClEqpSEER, HVACCoolRef[4]:SEER  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpSEER - 5"	DwellUnitType:ClEqpSEER	= {	if (NumCoolEquipTypes > 4 .AND. IfValidAnd( HVACCoolRef[5]:SEER  >= 0 )) then  min( ClEqpSEER, HVACCoolRef[5]:SEER  )  else  UNCHANGED  endif  }

	"Set DwellUnitType:ClEqpEER - 1"		DwellUnitType:ClEqpEER	= {	if (NumCoolEquipTypes > 0 .AND. IfValidAnd( HVACCoolRef[1]:EER  >= 0 )) then                 HVACCoolRef[1]:EER     else      0      endif  }
	"Set DwellUnitType:ClEqpEER - 2"		DwellUnitType:ClEqpEER	= {	if (NumCoolEquipTypes > 1 .AND. IfValidAnd( HVACCoolRef[2]:EER  >= 0 )) then  min( ClEqpEER, HVACCoolRef[2]:EER  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpEER - 3"		DwellUnitType:ClEqpEER	= {	if (NumCoolEquipTypes > 2 .AND. IfValidAnd( HVACCoolRef[3]:EER  >= 0 )) then  min( ClEqpEER, HVACCoolRef[3]:EER  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpEER - 4"		DwellUnitType:ClEqpEER	= {	if (NumCoolEquipTypes > 3 .AND. IfValidAnd( HVACCoolRef[4]:EER  >= 0 )) then  min( ClEqpEER, HVACCoolRef[4]:EER  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpEER - 5"		DwellUnitType:ClEqpEER	= {	if (NumCoolEquipTypes > 4 .AND. IfValidAnd( HVACCoolRef[5]:EER  >= 0 )) then  min( ClEqpEER, HVACCoolRef[5]:EER  )  else  UNCHANGED  endif  }

	"Set DwellUnitType:ClEqpCFMperTon - 1"		DwellUnitType:ClEqpCFMperTon	= {	if (NumCoolEquipTypes > 0 .AND. IfValidAnd( HVACCoolRef[1]:CFMperTon  >= 0 )) then                       HVACCoolRef[1]:CFMperTon     else      0      endif  }
	"Set DwellUnitType:ClEqpCFMperTon - 2"		DwellUnitType:ClEqpCFMperTon	= {	if (NumCoolEquipTypes > 1 .AND. IfValidAnd( HVACCoolRef[2]:CFMperTon  >= 0 )) then  min( ClEqpCFMperTon, HVACCoolRef[2]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpCFMperTon - 3"		DwellUnitType:ClEqpCFMperTon	= {	if (NumCoolEquipTypes > 2 .AND. IfValidAnd( HVACCoolRef[3]:CFMperTon  >= 0 )) then  min( ClEqpCFMperTon, HVACCoolRef[3]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpCFMperTon - 4"		DwellUnitType:ClEqpCFMperTon	= {	if (NumCoolEquipTypes > 3 .AND. IfValidAnd( HVACCoolRef[4]:CFMperTon  >= 0 )) then  min( ClEqpCFMperTon, HVACCoolRef[4]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpCFMperTon - 5"		DwellUnitType:ClEqpCFMperTon	= {	if (NumCoolEquipTypes > 4 .AND. IfValidAnd( HVACCoolRef[5]:CFMperTon  >= 0 )) then  min( ClEqpCFMperTon, HVACCoolRef[5]:CFMperTon  )  else  UNCHANGED  endif  }

;		"Set DwellUnitType:ClEqpRefrigChgAdjFctr - 1"	DwellUnitType:ClEqpRefrigChgAdjFctr	= {	if (NumCoolEquipTypes > 0 .AND. IfValidAnd( HVACCoolRef[1]:RefrigChgAdjFctr  >= 0 )) then                              HVACCoolRef[1]:RefrigChgAdjFctr     else      0      endif  }
;		"Set DwellUnitType:ClEqpRefrigChgAdjFctr - 2"	DwellUnitType:ClEqpRefrigChgAdjFctr	= {	if (NumCoolEquipTypes > 1 .AND. IfValidAnd( HVACCoolRef[2]:RefrigChgAdjFctr  >= 0 )) then  min( ClEqpRefrigChgAdjFctr, HVACCoolRef[2]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpRefrigChgAdjFctr - 3"	DwellUnitType:ClEqpRefrigChgAdjFctr	= {	if (NumCoolEquipTypes > 2 .AND. IfValidAnd( HVACCoolRef[3]:RefrigChgAdjFctr  >= 0 )) then  min( ClEqpRefrigChgAdjFctr, HVACCoolRef[3]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpRefrigChgAdjFctr - 4"	DwellUnitType:ClEqpRefrigChgAdjFctr	= {	if (NumCoolEquipTypes > 3 .AND. IfValidAnd( HVACCoolRef[4]:RefrigChgAdjFctr  >= 0 )) then  min( ClEqpRefrigChgAdjFctr, HVACCoolRef[4]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpRefrigChgAdjFctr - 5"	DwellUnitType:ClEqpRefrigChgAdjFctr	= {	if (NumCoolEquipTypes > 4 .AND. IfValidAnd( HVACCoolRef[5]:RefrigChgAdjFctr  >= 0 )) then  min( ClEqpRefrigChgAdjFctr, HVACCoolRef[5]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
;	
;	; RULES TO SUMMARIZE ADDIITONAL COOLING PERFORMANCE PARAMETERS PASSED INTO CSE FOR SIMULATION
;	
;		"Set DwellUnitType:ClEqpSizingFactor - 1"		DwellUnitType:ClEqpSizingFactor	= {	if (NumCoolEquipTypes > 0 .AND. LocalCompAssigned( HVACCoolRef[1]  ) .AND. CoolEquipCount[1]  > 0) then                      (HVACCoolRef[1]:SizingFactor  * CoolEquipCount[1] )  else      0      endif  }
;		"Set DwellUnitType:ClEqpSizingFactor - 2"		DwellUnitType:ClEqpSizingFactor	= {	if (NumCoolEquipTypes > 1 .AND. LocalCompAssigned( HVACCoolRef[2]  ) .AND. CoolEquipCount[2]  > 0) then  ClEqpSizingFactor + (HVACCoolRef[2]:SizingFactor  * CoolEquipCount[2] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpSizingFactor - 3"		DwellUnitType:ClEqpSizingFactor	= {	if (NumCoolEquipTypes > 2 .AND. LocalCompAssigned( HVACCoolRef[3]  ) .AND. CoolEquipCount[3]  > 0) then  ClEqpSizingFactor + (HVACCoolRef[3]:SizingFactor  * CoolEquipCount[3] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpSizingFactor - 4"		DwellUnitType:ClEqpSizingFactor	= {	if (NumCoolEquipTypes > 3 .AND. LocalCompAssigned( HVACCoolRef[4]  ) .AND. CoolEquipCount[4]  > 0) then  ClEqpSizingFactor + (HVACCoolRef[4]:SizingFactor  * CoolEquipCount[4] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpSizingFactor - 5"		DwellUnitType:ClEqpSizingFactor	= {	if (NumCoolEquipTypes > 4 .AND. LocalCompAssigned( HVACCoolRef[5]  ) .AND. CoolEquipCount[5]  > 0) then  ClEqpSizingFactor + (HVACCoolRef[5]:SizingFactor  * CoolEquipCount[5] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpSizingFactor - XX"	DwellUnitType:ClEqpSizingFactor	= {	if (NumCoolEqpUnits > 0.5) then  ClEqpSizingFactor / NumCoolEqpUnits  else  UNCHANGED  endif  }
;	
;		"Set DwellUnitType:ClEqpCapacity - 1"		DwellUnitType:ClEqpCapacity	= {	if (AutoSizeCool[1]  == 0 .AND. NumCoolEquipTypes > 0 .AND. LocalCompAssigned( HVACCoolRef[1]  ) .AND. CoolEquipCount[1]  > 0) then                  (HVACCoolRef[1]:TotalCapacity  * CoolEquipCount[1] )  else      0      endif  }
;		"Set DwellUnitType:ClEqpCapacity - 2"		DwellUnitType:ClEqpCapacity	= {	if (AutoSizeCool[2]  == 0 .AND. NumCoolEquipTypes > 1 .AND. LocalCompAssigned( HVACCoolRef[2]  ) .AND. CoolEquipCount[2]  > 0) then  ClEqpCapacity + (HVACCoolRef[2]:TotalCapacity  * CoolEquipCount[2] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpCapacity - 3" 		DwellUnitType:ClEqpCapacity	= {	if (AutoSizeCool[3]  == 0 .AND. NumCoolEquipTypes > 2 .AND. LocalCompAssigned( HVACCoolRef[3]  ) .AND. CoolEquipCount[3]  > 0) then  ClEqpCapacity + (HVACCoolRef[3]:TotalCapacity  * CoolEquipCount[3] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpCapacity - 4" 		DwellUnitType:ClEqpCapacity	= {	if (AutoSizeCool[4]  == 0 .AND. NumCoolEquipTypes > 3 .AND. LocalCompAssigned( HVACCoolRef[4]  ) .AND. CoolEquipCount[4]  > 0) then  ClEqpCapacity + (HVACCoolRef[4]:TotalCapacity  * CoolEquipCount[4] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpCapacity - 5" 		DwellUnitType:ClEqpCapacity	= {	if (AutoSizeCool[5]  == 0 .AND. NumCoolEquipTypes > 4 .AND. LocalCompAssigned( HVACCoolRef[5]  ) .AND. CoolEquipCount[5]  > 0) then  ClEqpCapacity + (HVACCoolRef[5]:TotalCapacity  * CoolEquipCount[5] )  else  UNCHANGED  endif  }

	"Set DwellUnitType:CoolEquipSummary"	DwellUnitType:CoolEquipSummary	=           ; SAC 6/21/20 - prevent reporting SEER when not valid input (tic #1226)   ; SAC 08/19/20 (tic #1003)   ; SAC 08/31/20 (tic #1003)
				{	if (NumCoolEquipTypes <= 0) then  " "
					else if (NumCoolEqpUnits < 1) then  "No cooling equipment units (counts) defined"
					else if (LocalCompAssigned( HVACCoolRef[1] ) == 0) then  "Cooling equipment assignment #1 not defined"
					else if (HVACCoolRef[1]:IsAvailable > 0 .AND. IfValidAnd( HVACCoolRef[1]:ShowCEER > 0 ))
					then	Format( "%.0f %s unit(s), %.1f CEER", NumCoolEqpUnits, CoolEqpTypeAbbrev, HVACCoolRef[1]:CEER )
					else if (HVACCoolRef[1]:IsAvailable > 0 .AND. IfValidAnd( HVACCoolRef[1]:ShowSEER > 0 )==0 .AND.
                        (HVACCoolRef[1]:Type == 5 .OR. HVACCoolRef[1]:Type == 25))
					then	Format( "%.0f %s unit(s), %.1f EER", NumCoolEqpUnits, CoolEqpTypeAbbrev, ClEqpEER )
					else if (HVACCoolRef[1]:IsAvailable > 0 .AND. IfValidAnd( HVACCoolRef[1]:ShowSEER > 0 )==0)
					then	Format( "%.0f %s unit(s), %.1f EER, %.1f CFM/ton", NumCoolEqpUnits, CoolEqpTypeAbbrev, ClEqpEER, ClEqpCFMperTon )
					else if (HVACCoolRef[1]:IsAvailable > 0)
					then	Format( "%.0f %s unit(s), %.1f SEER, %.1f EER, %.1f CFM/ton", NumCoolEqpUnits, CoolEqpTypeAbbrev, ClEqpSEER, ClEqpEER, ClEqpCFMperTon )
					else	Format( "%.0f %s unit(s)", NumCoolEqpUnits, CoolEqpTypeAbbrev )
					endif endif endif endif endif endif endif  }

  ; SAC 6/4/14 - modified rule to check consistency between each assigned sys [2-N] w/ sys[1]:TypeRpt (rather than :Type), since No Cooling case will override user's sys[1] w/ a std design cooling Equip
	"Set DwellUnitType:CoolEquipIssue"		DwellUnitType:CoolEquipIssue		= {
					if (NumCoolEquipTypes <= 0) then  " "
					else if (NumCoolEquipTypes > 0 .AND. LocalCompAssigned( HVACCoolRef[1]  ) == 0) then  "All cooling equipment assignments must be specified (first is excluded)"
					else if (NumCoolEquipTypes > 1 .AND. LocalCompAssigned( HVACCoolRef[2]  ) == 0) then  "All cooling equipment assignments must be specified (second is excluded)"
					else if (NumCoolEquipTypes > 2 .AND. LocalCompAssigned( HVACCoolRef[3]  ) == 0) then  "All cooling equipment assignments must be specified (third is excluded)"
					else if (NumCoolEquipTypes > 3 .AND. LocalCompAssigned( HVACCoolRef[4]  ) == 0) then  "All cooling equipment assignments must be specified (fourth is excluded)"
					else if (NumCoolEquipTypes > 4 .AND. LocalCompAssigned( HVACCoolRef[5]  ) == 0) then  "All cooling equipment assignments must be specified (fifth is excluded)"
					else if (NumCoolEquipTypes > 1 .AND. HVACCoolRef[2]:Type  != HVACCoolRef[1]:TypeRpt) then  Format( "All assigned cooling equipment must be of the same type (#1: %s / #2: %s)",  HVACCoolRef[1]:TypeAbbrevStr, HVACCoolRef[2]:TypeAbbrevStr )
					else if (NumCoolEquipTypes > 2 .AND. HVACCoolRef[3]:Type  != HVACCoolRef[1]:TypeRpt) then  Format( "All assigned cooling equipment must be of the same type (#1: %s / #3: %s)",  HVACCoolRef[1]:TypeAbbrevStr, HVACCoolRef[3]:TypeAbbrevStr )
					else if (NumCoolEquipTypes > 3 .AND. HVACCoolRef[4]:Type  != HVACCoolRef[1]:TypeRpt) then  Format( "All assigned cooling equipment must be of the same type (#1: %s / #4: %s)",  HVACCoolRef[1]:TypeAbbrevStr, HVACCoolRef[4]:TypeAbbrevStr )
					else if (NumCoolEquipTypes > 4 .AND. HVACCoolRef[5]:Type  != HVACCoolRef[1]:TypeRpt) then  Format( "All assigned cooling equipment must be of the same type (#1: %s / #5: %s)",  HVACCoolRef[1]:TypeAbbrevStr, HVACCoolRef[5]:TypeAbbrevStr )
					else  " "  endif endif endif endif endif endif endif endif endif endif  }

; SAC 11/14/14 - added new properties to aid in CF1R reporting of heating & cooling (& duct/fan) equipment
	"Set DwellUnitType:HeatEquipDucted"		DwellUnitType:HeatEquipDucted		= {	if (NumHeatEquipTypes < 1 .OR. LocalCompAssigned( HVACHeatRef[1] ) < 1) then  0
																											else if (HVACHeatRef[1]:Type < 1) then  0
																											else	switch (T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HeatEqpTypeAbbrev ))
																														case  1 :	1
																														case  0 :	0
																														default :	if (LocalCompAssigned( HVACDistRef ) < 1) then  0
																																		else if (HVACDistRef:Type > 0 .AND. HVACDistRef:Type != 8) then  1  else  0  endif endif
																													endswitch
																											endif endif  }
	"Set DwellUnitType:CoolEquipDucted"		DwellUnitType:CoolEquipDucted		= {	if (NumCoolEquipTypes < 1 .OR. LocalCompAssigned( HVACCoolRef[1] ) < 1) then  0
																											else if (HVACCoolRef[1]:Type < 1) then  0
																											else	switch (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolEqpTypeAbbrev ))
																														case  1 :	1
																														case  0 :	0
																														default :	if (LocalCompAssigned( HVACDistRef ) < 1) then  0
																																		else if (HVACDistRef:Type > 0 .AND. HVACDistRef:Type != 8) then  1  else  0  endif endif
																													endswitch
																											endif endif  }
	"Set DwellUnitType:HtPumpEquipDucted"	DwellUnitType:HtPumpEquipDucted	= {	0  }
	"Set DwellUnitType:EqpCountsMustAlign"	DwellUnitType:EqpCountsMustAlign	= {	if (HeatEquipDucted < 1 .OR. CoolEquipDucted < 1) then  0
																											else if (LocalCompAssigned( HVACDistRef ) < 1) then  0
																											else if (HVACDistRef:Type > 0 .AND. HVACDistRef:Type != 8) then  1
																											else  0  endif endif endif  }

;	; SAC 8/23/13 - moved ConstHtgSetpt from HVACHeat as part of HVAHeat array mods
;		"Default DwellUnitType:ConstHtgSetpt"		DwellUnitType:ConstHtgSetpt	= {	if (strlen( HeatEqpTypeAbbrev ) < 2) then  -1
;																								else  T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HeatEqpTypeAbbrev )  endif  }
;		"Init DwellUnitType:ConstClgSetpt"			DwellUnitType:ConstClgSetpt	= {	UNDEFINED  }
;	
;		"Init DwellUnitType:HtPumpDucted"       DwellUnitType:HtPumpDucted      = {	0  }
;		"Init DwellUnitType:HaveHtPump"         DwellUnitType:HaveHtPump        = {	0  }
	"Init DwellUnitType:HtPumpEquipIssue"   DwellUnitType:HtPumpEquipIssue  = {	UNDEFINED  }
;		"Init DwellUnitType:HPEqpHSPF"          DwellUnitType:HPEqpHSPF         = {	UNDEFINED  }
;		"Init DwellUnitType:HPEqpCap47"         DwellUnitType:HPEqpCap47        = {	UNDEFINED  }
;		"Init DwellUnitType:HPEqpCap35"         DwellUnitType:HPEqpCap35        = {	UNDEFINED  }
;		"Init DwellUnitType:HPEqpCap17"         DwellUnitType:HPEqpCap17        = {	UNDEFINED  }
;		"Init DwellUnitType:HPEqpCOP47"         DwellUnitType:HPEqpCOP47        = {	UNDEFINED  }
;		"Init DwellUnitType:HPEqpCOP35"         DwellUnitType:HPEqpCOP35        = {	UNDEFINED  }
;		"Init DwellUnitType:HPEqpCOP17"         DwellUnitType:HPEqpCOP17        = {	UNDEFINED  }
;		"Init DwellUnitType:HPEqpAuxHtgCap"     DwellUnitType:HPEqpAuxHtgCap    = {	UNDEFINED  }

  ; DwellUnitType heating equipment used for DHW heating
	"Set HtEqpCanBeDHWHtr flag"							DwellUnitType:HtEqpCanBeDHWHtr	= {	0  }	; only allowed for air-to-water and ground-source heat pumps (for now)
	"Default DwellUnitType:ServesAsDHWHtr flag"		DwellUnitType:ServesAsDHWHtr		= {	0  }
	"Set DwellUnitType:HtEqpUsedAsDHWHtr flag"		DwellUnitType:HtEqpUsedAsDHWHtr	= {	0  }

;		"Initialize other generic properties (common to Ht/Cl/HP)"		DwellUnitType:Action	= {	EvalRulelist( "SetupHVACSys_Round2_common", 1 )  }
END

; SAC 6/21/14 - setup secondary set of DwellUnitType HtPump assignment properties
;*************************************************************************
RULELIST "SetupDwellUnitType_Round2_HeatPump" 0 0 0 0
;*************************************************************************
;	"debug HVACHtPumpRef[1]:TypeAbbrevStr"		DwellUnitType:Action		= {	PostWarning( "HVACHtPumpRef[1]:TypeAbbrevStr '%s'", HVACHtPumpRef[1]:TypeAbbrevStr )  }
	"Set DwellUnitType:HtPumpEqpTypeAbbrev"	DwellUnitType:HtPumpEqpTypeAbbrev	= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1] ))
																													then  HVACHtPumpRef[1]:TypeAbbrevStr
																													else  " "  endif  }

;		"Default DwellUnitType:HtPumpDucted"				DwellUnitType:HtPumpDucted				= {	if (HtPumpEqpType < 1 .OR. LocalCompAssigned( HVACHtPumpRef[1] ) == 0) then  0
;																												else if (HVACHtPumpRef[1]:IsAvailable < 0.5) then  0
;																												else if (T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpEqpTypeAbbrev ) == 1) then  1
;																												else  0  endif endif endif  }
;		"Default DwellUnitType:HtPumpDuctedEditable"		DwellUnitType:HtPumpDuctedEditable	= {	if (HtPumpEqpType < 1 .OR. LocalCompAssigned( HVACHtPumpRef[1] ) == 0) then  0
;																												else if (HVACHtPumpRef[1]:IsAvailable < 0.5) then  0
;																												else if (T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpEqpTypeAbbrev ) < 0) then  1
;																												else  0  endif endif endif  }

;	"debug Duct Flag"		DwellUnitType:Action		= {	MessageBox( "check HtPumpDucted %g", DwellUnitType:HtPumpDucted )  }

;		"Set DwellUnitType:HeatDucted"		DwellUnitType:HeatDucted	= {	HtPumpDucted  }
;		"Set DwellUnitType:CoolDucted"		DwellUnitType:CoolDucted	= {	HtPumpDucted  }
;	"debug Duct Flag"		DwellUnitType:Action		= {	MessageBox( "check #1 CoolDucted %g HeatDucted %g", DwellUnitType:CoolDucted, DwellUnitType:HeatDucted )  }

	"Set DwellUnitType:HPEqpHSPF - 1"	DwellUnitType:HPEqpHSPF	= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1]  ) .AND. IfValidAnd( HVACHtPumpRef[1]:HSPF  > 0 )) then                  HVACHtPumpRef[1]:HSPF     else      0      endif  }
	"Set DwellUnitType:HPEqpHSPF - 2"	DwellUnitType:HPEqpHSPF	= {	if (NumHtPumpEquipTypes > 1 .AND. LocalCompAssigned( HVACHtPumpRef[2]  ) .AND. IfValidAnd( HVACHtPumpRef[2]:HSPF  > 0 )) then  min( HPEqpHSPF, HVACHtPumpRef[2]:HSPF  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPEqpHSPF - 3"	DwellUnitType:HPEqpHSPF	= {	if (NumHtPumpEquipTypes > 2 .AND. LocalCompAssigned( HVACHtPumpRef[3]  ) .AND. IfValidAnd( HVACHtPumpRef[3]:HSPF  > 0 )) then  min( HPEqpHSPF, HVACHtPumpRef[3]:HSPF  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPEqpHSPF - 4"	DwellUnitType:HPEqpHSPF	= {	if (NumHtPumpEquipTypes > 3 .AND. LocalCompAssigned( HVACHtPumpRef[4]  ) .AND. IfValidAnd( HVACHtPumpRef[4]:HSPF  > 0 )) then  min( HPEqpHSPF, HVACHtPumpRef[4]:HSPF  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPEqpHSPF - 5"	DwellUnitType:HPEqpHSPF	= {	if (NumHtPumpEquipTypes > 4 .AND. LocalCompAssigned( HVACHtPumpRef[5]  ) .AND. IfValidAnd( HVACHtPumpRef[5]:HSPF  > 0 )) then  min( HPEqpHSPF, HVACHtPumpRef[5]:HSPF  )  else  UNCHANGED  endif  }

	"Set DwellUnitType:HPEqpCap47 - 1"	DwellUnitType:HPEqpCap47	= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1]  ) .AND. IfValidAnd( HVACHtPumpRef[1]:Cap47  > 0 )) then               (HVACHtPumpRef[1]:Cap47  * HtPumpEquipCount[1] )  else      0      endif  }
	"Set DwellUnitType:HPEqpCap47 - 2"	DwellUnitType:HPEqpCap47	= {	if (NumHtPumpEquipTypes > 1 .AND. LocalCompAssigned( HVACHtPumpRef[2]  ) .AND. IfValidAnd( HVACHtPumpRef[2]:Cap47  > 0 )) then  HPEqpCap47 + (HVACHtPumpRef[2]:Cap47  * HtPumpEquipCount[2] )  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPEqpCap47 - 3" 	DwellUnitType:HPEqpCap47	= {	if (NumHtPumpEquipTypes > 2 .AND. LocalCompAssigned( HVACHtPumpRef[3]  ) .AND. IfValidAnd( HVACHtPumpRef[3]:Cap47  > 0 )) then  HPEqpCap47 + (HVACHtPumpRef[3]:Cap47  * HtPumpEquipCount[3] )  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPEqpCap47 - 4" 	DwellUnitType:HPEqpCap47	= {	if (NumHtPumpEquipTypes > 3 .AND. LocalCompAssigned( HVACHtPumpRef[4]  ) .AND. IfValidAnd( HVACHtPumpRef[4]:Cap47  > 0 )) then  HPEqpCap47 + (HVACHtPumpRef[4]:Cap47  * HtPumpEquipCount[4] )  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPEqpCap47 - 5" 	DwellUnitType:HPEqpCap47	= {	if (NumHtPumpEquipTypes > 4 .AND. LocalCompAssigned( HVACHtPumpRef[5]  ) .AND. IfValidAnd( HVACHtPumpRef[5]:Cap47  > 0 )) then  HPEqpCap47 + (HVACHtPumpRef[5]:Cap47  * HtPumpEquipCount[5] )  else  UNCHANGED  endif  }

;		"Set DwellUnitType:HPEqpCap35 - 1"	DwellUnitType:HPEqpCap35	= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1]  ) .AND. LocalStatus( HVACHtPumpRef[1]:Cap35  ) > 0) then               (HVACHtPumpRef[1]:Cap35  * HtPumpEquipCount[1] )  else      0      endif  }
;		"Set DwellUnitType:HPEqpCap35 - 2"	DwellUnitType:HPEqpCap35	= {	if (NumHtPumpEquipTypes > 1 .AND. LocalCompAssigned( HVACHtPumpRef[2]  ) .AND. LocalStatus( HVACHtPumpRef[2]:Cap35  ) > 0) then  HPEqpCap35 + (HVACHtPumpRef[2]:Cap35  * HtPumpEquipCount[2] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HPEqpCap35 - 3" 	DwellUnitType:HPEqpCap35	= {	if (NumHtPumpEquipTypes > 2 .AND. LocalCompAssigned( HVACHtPumpRef[3]  ) .AND. LocalStatus( HVACHtPumpRef[3]:Cap35  ) > 0) then  HPEqpCap35 + (HVACHtPumpRef[3]:Cap35  * HtPumpEquipCount[3] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HPEqpCap35 - 4" 	DwellUnitType:HPEqpCap35	= {	if (NumHtPumpEquipTypes > 3 .AND. LocalCompAssigned( HVACHtPumpRef[4]  ) .AND. LocalStatus( HVACHtPumpRef[4]:Cap35  ) > 0) then  HPEqpCap35 + (HVACHtPumpRef[4]:Cap35  * HtPumpEquipCount[4] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HPEqpCap35 - 5" 	DwellUnitType:HPEqpCap35	= {	if (NumHtPumpEquipTypes > 4 .AND. LocalCompAssigned( HVACHtPumpRef[5]  ) .AND. LocalStatus( HVACHtPumpRef[5]:Cap35  ) > 0) then  HPEqpCap35 + (HVACHtPumpRef[5]:Cap35  * HtPumpEquipCount[5] )  else  UNCHANGED  endif  }

	"Set DwellUnitType:HPEqpCap17 - 1"	DwellUnitType:HPEqpCap17	= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1]  ) .AND. LocalStatus( HVACHtPumpRef[1]:Cap17  ) > 0) then               (HVACHtPumpRef[1]:Cap17  * HtPumpEquipCount[1] )  else      0      endif  }
	"Set DwellUnitType:HPEqpCap17 - 2"	DwellUnitType:HPEqpCap17	= {	if (NumHtPumpEquipTypes > 1 .AND. LocalCompAssigned( HVACHtPumpRef[2]  ) .AND. LocalStatus( HVACHtPumpRef[2]:Cap17  ) > 0) then  HPEqpCap17 + (HVACHtPumpRef[2]:Cap17  * HtPumpEquipCount[2] )  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPEqpCap17 - 3" 	DwellUnitType:HPEqpCap17	= {	if (NumHtPumpEquipTypes > 2 .AND. LocalCompAssigned( HVACHtPumpRef[3]  ) .AND. LocalStatus( HVACHtPumpRef[3]:Cap17  ) > 0) then  HPEqpCap17 + (HVACHtPumpRef[3]:Cap17  * HtPumpEquipCount[3] )  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPEqpCap17 - 4" 	DwellUnitType:HPEqpCap17	= {	if (NumHtPumpEquipTypes > 3 .AND. LocalCompAssigned( HVACHtPumpRef[4]  ) .AND. LocalStatus( HVACHtPumpRef[4]:Cap17  ) > 0) then  HPEqpCap17 + (HVACHtPumpRef[4]:Cap17  * HtPumpEquipCount[4] )  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPEqpCap17 - 5" 	DwellUnitType:HPEqpCap17	= {	if (NumHtPumpEquipTypes > 4 .AND. LocalCompAssigned( HVACHtPumpRef[5]  ) .AND. LocalStatus( HVACHtPumpRef[5]:Cap17  ) > 0) then  HPEqpCap17 + (HVACHtPumpRef[5]:Cap17  * HtPumpEquipCount[5] )  else  UNCHANGED  endif  }

	"Set DwellUnitType:HPEqpCOP47 - 1"	DwellUnitType:HPEqpCOP47	= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1]  ) .AND. IfValidAnd( HVACHtPumpRef[1]:COP47  > 0 )) then                   HVACHtPumpRef[1]:COP47     else      0      endif  }
	"Set DwellUnitType:HPEqpCOP47 - 2"	DwellUnitType:HPEqpCOP47	= {	if (NumHtPumpEquipTypes > 1 .AND. LocalCompAssigned( HVACHtPumpRef[2]  ) .AND. IfValidAnd( HVACHtPumpRef[2]:COP47  > 0 )) then  min( HPEqpCOP47, HVACHtPumpRef[2]:COP47  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPEqpCOP47 - 3"	DwellUnitType:HPEqpCOP47	= {	if (NumHtPumpEquipTypes > 2 .AND. LocalCompAssigned( HVACHtPumpRef[3]  ) .AND. IfValidAnd( HVACHtPumpRef[3]:COP47  > 0 )) then  min( HPEqpCOP47, HVACHtPumpRef[3]:COP47  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPEqpCOP47 - 4"	DwellUnitType:HPEqpCOP47	= {	if (NumHtPumpEquipTypes > 3 .AND. LocalCompAssigned( HVACHtPumpRef[4]  ) .AND. IfValidAnd( HVACHtPumpRef[4]:COP47  > 0 )) then  min( HPEqpCOP47, HVACHtPumpRef[4]:COP47  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPEqpCOP47 - 5"	DwellUnitType:HPEqpCOP47	= {	if (NumHtPumpEquipTypes > 4 .AND. LocalCompAssigned( HVACHtPumpRef[5]  ) .AND. IfValidAnd( HVACHtPumpRef[5]:COP47  > 0 )) then  min( HPEqpCOP47, HVACHtPumpRef[5]:COP47  )  else  UNCHANGED  endif  }

;		"Set DwellUnitType:HPEqpCOP35 - 1"	DwellUnitType:HPEqpCOP35	= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1]  ) .AND. IfValidAnd( HVACHtPumpRef[1]:COP35  > 0 )) then                   HVACHtPumpRef[1]:COP35     else      0      endif  }
;		"Set DwellUnitType:HPEqpCOP35 - 2"	DwellUnitType:HPEqpCOP35	= {	if (NumHtPumpEquipTypes > 1 .AND. LocalCompAssigned( HVACHtPumpRef[2]  ) .AND. IfValidAnd( HVACHtPumpRef[2]:COP35  > 0 )) then  min( HPEqpCOP35, HVACHtPumpRef[2]:COP35  )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HPEqpCOP35 - 3"	DwellUnitType:HPEqpCOP35	= {	if (NumHtPumpEquipTypes > 2 .AND. LocalCompAssigned( HVACHtPumpRef[3]  ) .AND. IfValidAnd( HVACHtPumpRef[3]:COP35  > 0 )) then  min( HPEqpCOP35, HVACHtPumpRef[3]:COP35  )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HPEqpCOP35 - 4"	DwellUnitType:HPEqpCOP35	= {	if (NumHtPumpEquipTypes > 3 .AND. LocalCompAssigned( HVACHtPumpRef[4]  ) .AND. IfValidAnd( HVACHtPumpRef[4]:COP35  > 0 )) then  min( HPEqpCOP35, HVACHtPumpRef[4]:COP35  )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HPEqpCOP35 - 5"	DwellUnitType:HPEqpCOP35	= {	if (NumHtPumpEquipTypes > 4 .AND. LocalCompAssigned( HVACHtPumpRef[5]  ) .AND. IfValidAnd( HVACHtPumpRef[5]:COP35  > 0 )) then  min( HPEqpCOP35, HVACHtPumpRef[5]:COP35  )  else  UNCHANGED  endif  }
;	
;		"Set DwellUnitType:HPEqpCOP17 - 1"	DwellUnitType:HPEqpCOP17	= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1]  ) .AND. IfValidAnd( HVACHtPumpRef[1]:COP17  > 0 )) then                   HVACHtPumpRef[1]:COP17     else      0      endif  }
;		"Set DwellUnitType:HPEqpCOP17 - 2"	DwellUnitType:HPEqpCOP17	= {	if (NumHtPumpEquipTypes > 1 .AND. LocalCompAssigned( HVACHtPumpRef[2]  ) .AND. IfValidAnd( HVACHtPumpRef[2]:COP17  > 0 )) then  min( HPEqpCOP17, HVACHtPumpRef[2]:COP17  )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HPEqpCOP17 - 3"	DwellUnitType:HPEqpCOP17	= {	if (NumHtPumpEquipTypes > 2 .AND. LocalCompAssigned( HVACHtPumpRef[3]  ) .AND. IfValidAnd( HVACHtPumpRef[3]:COP17  > 0 )) then  min( HPEqpCOP17, HVACHtPumpRef[3]:COP17  )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HPEqpCOP17 - 4"	DwellUnitType:HPEqpCOP17	= {	if (NumHtPumpEquipTypes > 3 .AND. LocalCompAssigned( HVACHtPumpRef[4]  ) .AND. IfValidAnd( HVACHtPumpRef[4]:COP17  > 0 )) then  min( HPEqpCOP17, HVACHtPumpRef[4]:COP17  )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HPEqpCOP17 - 5"	DwellUnitType:HPEqpCOP17	= {	if (NumHtPumpEquipTypes > 4 .AND. LocalCompAssigned( HVACHtPumpRef[5]  ) .AND. IfValidAnd( HVACHtPumpRef[5]:COP17  > 0 )) then  min( HPEqpCOP17, HVACHtPumpRef[5]:COP17  )  else  UNCHANGED  endif  }
;	
;		"Set DwellUnitType:HPEqpAuxHtgCap - 1"		DwellUnitType:HPEqpAuxHtgCap	= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1]  ) .AND. LocalStatus( HVACHtPumpRef[1]:AuxHtgCap  ) > 0) then                   (HVACHtPumpRef[1]:AuxHtgCap  * HtPumpEquipCount[1] )  else      0      endif  }
;		"Set DwellUnitType:HPEqpAuxHtgCap - 2"		DwellUnitType:HPEqpAuxHtgCap	= {	if (NumHtPumpEquipTypes > 1 .AND. LocalCompAssigned( HVACHtPumpRef[2]  ) .AND. LocalStatus( HVACHtPumpRef[2]:AuxHtgCap  ) > 0) then  HPEqpAuxHtgCap + (HVACHtPumpRef[2]:AuxHtgCap  * HtPumpEquipCount[2] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HPEqpAuxHtgCap - 3" 	DwellUnitType:HPEqpAuxHtgCap	= {	if (NumHtPumpEquipTypes > 2 .AND. LocalCompAssigned( HVACHtPumpRef[3]  ) .AND. LocalStatus( HVACHtPumpRef[3]:AuxHtgCap  ) > 0) then  HPEqpAuxHtgCap + (HVACHtPumpRef[3]:AuxHtgCap  * HtPumpEquipCount[3] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HPEqpAuxHtgCap - 4" 	DwellUnitType:HPEqpAuxHtgCap	= {	if (NumHtPumpEquipTypes > 3 .AND. LocalCompAssigned( HVACHtPumpRef[4]  ) .AND. LocalStatus( HVACHtPumpRef[4]:AuxHtgCap  ) > 0) then  HPEqpAuxHtgCap + (HVACHtPumpRef[4]:AuxHtgCap  * HtPumpEquipCount[4] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HPEqpAuxHtgCap - 5" 	DwellUnitType:HPEqpAuxHtgCap	= {	if (NumHtPumpEquipTypes > 4 .AND. LocalCompAssigned( HVACHtPumpRef[5]  ) .AND. LocalStatus( HVACHtPumpRef[5]:AuxHtgCap  ) > 0) then  HPEqpAuxHtgCap + (HVACHtPumpRef[5]:AuxHtgCap  * HtPumpEquipCount[5] )  else  UNCHANGED  endif  }

	"Set DwellUnitType:HPModelDualFuel - 1"	DwellUnitType:HPModelDualFuel	= {	if (NumHtPumpEquipTypes > 0 .AND. IfValidAnd( HVACHtPumpRef[1]:ModelDualFuel > 0 )) then  1  else      0      endif  }    ; SAC 12/08/20
	"Set DwellUnitType:HPModelDualFuel - 2"	DwellUnitType:HPModelDualFuel	= {	if (NumHtPumpEquipTypes > 1 .AND. IfValidAnd( HVACHtPumpRef[2]:ModelDualFuel > 0 )) then  1  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPModelDualFuel - 3"	DwellUnitType:HPModelDualFuel	= {	if (NumHtPumpEquipTypes > 2 .AND. IfValidAnd( HVACHtPumpRef[3]:ModelDualFuel > 0 )) then  1  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPModelDualFuel - 4"	DwellUnitType:HPModelDualFuel	= {	if (NumHtPumpEquipTypes > 3 .AND. IfValidAnd( HVACHtPumpRef[4]:ModelDualFuel > 0 )) then  1  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPModelDualFuel - 5"	DwellUnitType:HPModelDualFuel	= {	if (NumHtPumpEquipTypes > 4 .AND. IfValidAnd( HVACHtPumpRef[5]:ModelDualFuel > 0 )) then  1  else  UNCHANGED  endif  }

	"Set DwellUnitType:HPDFAFUE - 1"	DwellUnitType:HPDFAFUE	= {	if (NumHtPumpEquipTypes > 0 .AND. IfValidAnd( HVACHtPumpRef[1]:ModelDualFuel > 0 ) .AND. IfValidAnd( HVACHtPumpRef[1]:AFUE > 0 ))        then  HVACHtPumpRef[1]:AFUE  else     101     endif  }
	"Set DwellUnitType:HPDFAFUE - 2"	DwellUnitType:HPDFAFUE	= {	if (NumHtPumpEquipTypes > 1 .AND. IfValidAnd( HVACHtPumpRef[2]:ModelDualFuel > 0 ) .AND. IfValidAnd( HVACHtPumpRef[2]:AFUE < HPDFAFUE )) then  HVACHtPumpRef[2]:AFUE  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPDFAFUE - 3"	DwellUnitType:HPDFAFUE	= {	if (NumHtPumpEquipTypes > 2 .AND. IfValidAnd( HVACHtPumpRef[3]:ModelDualFuel > 0 ) .AND. IfValidAnd( HVACHtPumpRef[3]:AFUE < HPDFAFUE )) then  HVACHtPumpRef[3]:AFUE  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPDFAFUE - 4"	DwellUnitType:HPDFAFUE	= {	if (NumHtPumpEquipTypes > 3 .AND. IfValidAnd( HVACHtPumpRef[4]:ModelDualFuel > 0 ) .AND. IfValidAnd( HVACHtPumpRef[4]:AFUE < HPDFAFUE )) then  HVACHtPumpRef[4]:AFUE  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPDFAFUE - 5"	DwellUnitType:HPDFAFUE	= {	if (NumHtPumpEquipTypes > 4 .AND. IfValidAnd( HVACHtPumpRef[5]:ModelDualFuel > 0 ) .AND. IfValidAnd( HVACHtPumpRef[5]:AFUE < HPDFAFUE )) then  HVACHtPumpRef[5]:AFUE  else  UNCHANGED  endif  }

	"Set DwellUnitType:HPLockoutTemp - 1"	DwellUnitType:HPLockoutTemp	= {	if (NumHtPumpEquipTypes > 0 .AND. IfValidAnd( HVACHtPumpRef[1]:ModelDualFuel > 0 ) .AND. IfValidAnd( HVACHtPumpRef[1]:HasHPLockout > 0 ) .AND. IfValidAnd( HVACHtPumpRef[1]:HPLockoutTemp > -999 ))          then  HVACHtPumpRef[1]:HPLockoutTemp  else    -999     endif  }
	"Set DwellUnitType:HPLockoutTemp - 2"	DwellUnitType:HPLockoutTemp	= {	if (NumHtPumpEquipTypes > 1 .AND. IfValidAnd( HVACHtPumpRef[2]:ModelDualFuel > 0 ) .AND. IfValidAnd( HVACHtPumpRef[2]:HasHPLockout > 0 ) .AND. IfValidAnd( HVACHtPumpRef[2]:HPLockoutTemp > HPLockoutTemp )) then  HVACHtPumpRef[2]:HPLockoutTemp  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPLockoutTemp - 3"	DwellUnitType:HPLockoutTemp	= {	if (NumHtPumpEquipTypes > 2 .AND. IfValidAnd( HVACHtPumpRef[3]:ModelDualFuel > 0 ) .AND. IfValidAnd( HVACHtPumpRef[3]:HasHPLockout > 0 ) .AND. IfValidAnd( HVACHtPumpRef[3]:HPLockoutTemp > HPLockoutTemp )) then  HVACHtPumpRef[3]:HPLockoutTemp  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPLockoutTemp - 4"	DwellUnitType:HPLockoutTemp	= {	if (NumHtPumpEquipTypes > 3 .AND. IfValidAnd( HVACHtPumpRef[4]:ModelDualFuel > 0 ) .AND. IfValidAnd( HVACHtPumpRef[4]:HasHPLockout > 0 ) .AND. IfValidAnd( HVACHtPumpRef[4]:HPLockoutTemp > HPLockoutTemp )) then  HVACHtPumpRef[4]:HPLockoutTemp  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPLockoutTemp - 5"	DwellUnitType:HPLockoutTemp	= {	if (NumHtPumpEquipTypes > 4 .AND. IfValidAnd( HVACHtPumpRef[5]:ModelDualFuel > 0 ) .AND. IfValidAnd( HVACHtPumpRef[5]:HasHPLockout > 0 ) .AND. IfValidAnd( HVACHtPumpRef[5]:HPLockoutTemp > HPLockoutTemp )) then  HVACHtPumpRef[5]:HPLockoutTemp  else  UNCHANGED  endif  }

	"Set DwellUnitType:HeatEquipSummary"	DwellUnitType:HeatEquipSummary	=              ; SAC 6/27/20 - added COP47 reporting for PkgTermHeatPump & SglPkgVertHeatPump (tic #1225 & #1226)   ; SAC 08/19/20 (tic #1003)
				{	if (NumHtPumpEquipTypes <= 0) then  " "
					else if (NumHtPumpEqpUnits < 1) then  "No heat pump equipment units (counts) defined"
					else if (LocalCompAssigned( HVACHtPumpRef[1] ) == 0) then  "Heat pump equipment assignment #1 not defined"
					else if (HVACHtPumpRef[1]:IsAvailable > 0)
			;		then	Format( "%.0f %s unit(s), HSPF %.1f, Cap@47 %s, Cap@17 %s", NumHtPumpEqpUnits, HtPumpEqpTypeAbbrev, HPEqpHSPF, FltToStr( HPEqpCap47 ), FltToStr( HPEqpCap17 ) )
					then	if (HVACHtPumpRef[1]:Type == 7)
                     then  if (IfValidAnd( HVACHtPumpRef[1]:AutoSize > 0 ))
							      then  Format( "%.0f %s unit(s), auto-sized",     NumHtPumpEqpUnits, HtPumpEqpTypeAbbrev )
							      else  Format( "%.0f %s unit(s), Cap@47 %s Btuh", NumHtPumpEqpUnits, HtPumpEqpTypeAbbrev, FltToStr( HPEqpCap47 ) )  endif
                     else if (HVACHtPumpRef[1]:Type == 11 .OR. HVACHtPumpRef[1]:Type == 26 .OR. HVACHtPumpRef[1]:Type == 24)
							then	if (IfValidAnd( HVACHtPumpRef[1]:AutoSize > 0 ))
							      then  Format( "%.0f %s unit(s), @47: COP %.1f, auto-sized",  NumHtPumpEqpUnits, HtPumpEqpTypeAbbrev, HPEqpCOP47 )
							      else  Format( "%.0f %s unit(s), @47: COP %.1f, Cap %s Btuh", NumHtPumpEqpUnits, HtPumpEqpTypeAbbrev, HPEqpCOP47, FltToStr( HPEqpCap47 ) )  endif
							else	if (IfValidAnd( HVACHtPumpRef[1]:AutoSize > 0 ))
							      then  Format( "%.0f %s unit(s), HSPF %.1f, auto-sized",     NumHtPumpEqpUnits, HtPumpEqpTypeAbbrev, HPEqpHSPF )
							      else  Format( "%.0f %s unit(s), HSPF %.1f, Cap@47 %s Btuh", NumHtPumpEqpUnits, HtPumpEqpTypeAbbrev, HPEqpHSPF, FltToStr( HPEqpCap47 ) )  endif
							endif endif
					else	Format( "%.0f %s unit(s),  ?? efficiency ??", NumHtPumpEqpUnits, HtPumpEqpTypeAbbrev )
					endif endif endif endif  }
	"Set DwellUnitType:HeatEquipSummary"	DwellUnitType:HeatEquipSummary	=              ; added dual fuel HP info - SAC 12/08/20
      {  if (IfValidAnd( HPModelDualFuel > 0 )==0) then  UNCHANGED
         else if (IfValidAnd( HPLockoutTemp > -999 ))
         then  Format( "%s, dual fuel AFUE %s%%, lockout @ %sF", HeatEquipSummary, FltToStr( HPDFAFUE ), FltToStr( HPLockoutTemp ) ) 
         else  Format( "%s, dual fuel AFUE %s%, no lockout",     HeatEquipSummary, FltToStr( HPDFAFUE ) ) 
         endif endif  }
;	"debug DwellUnitType:HeatEquipSummary"		DwellUnitType:Action		= {	if (FloorAreaServed > 0.5) then PostWarning( "DwellUnitType: '%s' HeatEquipSummary: '%s'", Name, HeatEquipSummary ) else UNCHANGED endif }

  ; More HVACSys cooling equipment summarization
	"Set DwellUnitType:ClEqpSEER - 1"	DwellUnitType:ClEqpSEER	= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1]  ) .AND. IfValidAnd( HVACHtPumpRef[1]:SEER  > 0 )) then                  HVACHtPumpRef[1]:SEER     else      0      endif  }
	"Set DwellUnitType:ClEqpSEER - 2"	DwellUnitType:ClEqpSEER	= {	if (NumHtPumpEquipTypes > 1 .AND. LocalCompAssigned( HVACHtPumpRef[2]  ) .AND. IfValidAnd( HVACHtPumpRef[2]:SEER  > 0 )) then  min( ClEqpSEER, HVACHtPumpRef[2]:SEER  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpSEER - 3"	DwellUnitType:ClEqpSEER	= {	if (NumHtPumpEquipTypes > 2 .AND. LocalCompAssigned( HVACHtPumpRef[3]  ) .AND. IfValidAnd( HVACHtPumpRef[3]:SEER  > 0 )) then  min( ClEqpSEER, HVACHtPumpRef[3]:SEER  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpSEER - 4"	DwellUnitType:ClEqpSEER	= {	if (NumHtPumpEquipTypes > 3 .AND. LocalCompAssigned( HVACHtPumpRef[4]  ) .AND. IfValidAnd( HVACHtPumpRef[4]:SEER  > 0 )) then  min( ClEqpSEER, HVACHtPumpRef[4]:SEER  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpSEER - 5"	DwellUnitType:ClEqpSEER	= {	if (NumHtPumpEquipTypes > 4 .AND. LocalCompAssigned( HVACHtPumpRef[5]  ) .AND. IfValidAnd( HVACHtPumpRef[5]:SEER  > 0 )) then  min( ClEqpSEER, HVACHtPumpRef[5]:SEER  )  else  UNCHANGED  endif  }

	"Set DwellUnitType:ClEqpEER - 1"		DwellUnitType:ClEqpEER	= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1]  ) .AND. IfValidAnd( HVACHtPumpRef[1]:EER  > 0 )) then                 HVACHtPumpRef[1]:EER     else      0      endif  }
	"Set DwellUnitType:ClEqpEER - 2"		DwellUnitType:ClEqpEER	= {	if (NumHtPumpEquipTypes > 1 .AND. LocalCompAssigned( HVACHtPumpRef[2]  ) .AND. IfValidAnd( HVACHtPumpRef[2]:EER  > 0 )) then  min( ClEqpEER, HVACHtPumpRef[2]:EER  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpEER - 3"		DwellUnitType:ClEqpEER	= {	if (NumHtPumpEquipTypes > 2 .AND. LocalCompAssigned( HVACHtPumpRef[3]  ) .AND. IfValidAnd( HVACHtPumpRef[3]:EER  > 0 )) then  min( ClEqpEER, HVACHtPumpRef[3]:EER  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpEER - 4"		DwellUnitType:ClEqpEER	= {	if (NumHtPumpEquipTypes > 3 .AND. LocalCompAssigned( HVACHtPumpRef[4]  ) .AND. IfValidAnd( HVACHtPumpRef[4]:EER  > 0 )) then  min( ClEqpEER, HVACHtPumpRef[4]:EER  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpEER - 5"		DwellUnitType:ClEqpEER	= {	if (NumHtPumpEquipTypes > 4 .AND. LocalCompAssigned( HVACHtPumpRef[5]  ) .AND. IfValidAnd( HVACHtPumpRef[5]:EER  > 0 )) then  min( ClEqpEER, HVACHtPumpRef[5]:EER  )  else  UNCHANGED  endif  }

	"Set DwellUnitType:ClEqpCFMperTon - 1"		DwellUnitType:ClEqpCFMperTon	= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1]  ) .AND. IfValidAnd( HVACHtPumpRef[1]:CFMperTon  > 0 )) then                       HVACHtPumpRef[1]:CFMperTon     else      0      endif  }
	"Set DwellUnitType:ClEqpCFMperTon - 2"		DwellUnitType:ClEqpCFMperTon	= {	if (NumHtPumpEquipTypes > 1 .AND. LocalCompAssigned( HVACHtPumpRef[2]  ) .AND. IfValidAnd( HVACHtPumpRef[2]:CFMperTon  > 0 )) then  min( ClEqpCFMperTon, HVACHtPumpRef[2]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpCFMperTon - 3"		DwellUnitType:ClEqpCFMperTon	= {	if (NumHtPumpEquipTypes > 2 .AND. LocalCompAssigned( HVACHtPumpRef[3]  ) .AND. IfValidAnd( HVACHtPumpRef[3]:CFMperTon  > 0 )) then  min( ClEqpCFMperTon, HVACHtPumpRef[3]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpCFMperTon - 4"		DwellUnitType:ClEqpCFMperTon	= {	if (NumHtPumpEquipTypes > 3 .AND. LocalCompAssigned( HVACHtPumpRef[4]  ) .AND. IfValidAnd( HVACHtPumpRef[4]:CFMperTon  > 0 )) then  min( ClEqpCFMperTon, HVACHtPumpRef[4]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpCFMperTon - 5"		DwellUnitType:ClEqpCFMperTon	= {	if (NumHtPumpEquipTypes > 4 .AND. LocalCompAssigned( HVACHtPumpRef[5]  ) .AND. IfValidAnd( HVACHtPumpRef[5]:CFMperTon  > 0 )) then  min( ClEqpCFMperTon, HVACHtPumpRef[5]:CFMperTon  )  else  UNCHANGED  endif  }

;		"Set DwellUnitType:ClEqpRefrigChgAdjFctr - 1"	DwellUnitType:ClEqpRefrigChgAdjFctr	= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1]  ) .AND. IfValidAnd( HVACHtPumpRef[1]:RefrigChgAdjFctr  > 0 )) then                              HVACHtPumpRef[1]:RefrigChgAdjFctr     else      0      endif  }
;		"Set DwellUnitType:ClEqpRefrigChgAdjFctr - 2"	DwellUnitType:ClEqpRefrigChgAdjFctr	= {	if (NumHtPumpEquipTypes > 1 .AND. LocalCompAssigned( HVACHtPumpRef[2]  ) .AND. IfValidAnd( HVACHtPumpRef[2]:RefrigChgAdjFctr  > 0 )) then  min( ClEqpRefrigChgAdjFctr, HVACHtPumpRef[2]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpRefrigChgAdjFctr - 3"	DwellUnitType:ClEqpRefrigChgAdjFctr	= {	if (NumHtPumpEquipTypes > 2 .AND. LocalCompAssigned( HVACHtPumpRef[3]  ) .AND. IfValidAnd( HVACHtPumpRef[3]:RefrigChgAdjFctr  > 0 )) then  min( ClEqpRefrigChgAdjFctr, HVACHtPumpRef[3]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpRefrigChgAdjFctr - 4"	DwellUnitType:ClEqpRefrigChgAdjFctr	= {	if (NumHtPumpEquipTypes > 3 .AND. LocalCompAssigned( HVACHtPumpRef[4]  ) .AND. IfValidAnd( HVACHtPumpRef[4]:RefrigChgAdjFctr  > 0 )) then  min( ClEqpRefrigChgAdjFctr, HVACHtPumpRef[4]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpRefrigChgAdjFctr - 5"	DwellUnitType:ClEqpRefrigChgAdjFctr	= {	if (NumHtPumpEquipTypes > 4 .AND. LocalCompAssigned( HVACHtPumpRef[5]  ) .AND. IfValidAnd( HVACHtPumpRef[5]:RefrigChgAdjFctr  > 0 )) then  min( ClEqpRefrigChgAdjFctr, HVACHtPumpRef[5]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
;	
;	; RULES TO SUMMARIZE ADDIITONAL COOLING PERFORMANCE PARAMETERS PASSED INTO CSE FOR SIMULATION
;	
;		"Set DwellUnitType:ClEqpSizingFactor - 1"		DwellUnitType:ClEqpSizingFactor	= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1]  ) .AND. HtPumpEquipCount[1]  > 0 .AND. IfValidAnd( HVACHtPumpRef[1]:ClSizingFactor  > 0 )) then                      (HVACHtPumpRef[1]:ClSizingFactor  * HtPumpEquipCount[1] )  else      0      endif  }
;		"Set DwellUnitType:ClEqpSizingFactor - 2"		DwellUnitType:ClEqpSizingFactor	= {	if (NumHtPumpEquipTypes > 1 .AND. LocalCompAssigned( HVACHtPumpRef[2]  ) .AND. HtPumpEquipCount[2]  > 0 .AND. IfValidAnd( HVACHtPumpRef[2]:ClSizingFactor  > 0 )) then  ClEqpSizingFactor + (HVACHtPumpRef[2]:ClSizingFactor  * HtPumpEquipCount[2] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpSizingFactor - 3"		DwellUnitType:ClEqpSizingFactor	= {	if (NumHtPumpEquipTypes > 2 .AND. LocalCompAssigned( HVACHtPumpRef[3]  ) .AND. HtPumpEquipCount[3]  > 0 .AND. IfValidAnd( HVACHtPumpRef[3]:ClSizingFactor  > 0 )) then  ClEqpSizingFactor + (HVACHtPumpRef[3]:ClSizingFactor  * HtPumpEquipCount[3] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpSizingFactor - 4"		DwellUnitType:ClEqpSizingFactor	= {	if (NumHtPumpEquipTypes > 3 .AND. LocalCompAssigned( HVACHtPumpRef[4]  ) .AND. HtPumpEquipCount[4]  > 0 .AND. IfValidAnd( HVACHtPumpRef[4]:ClSizingFactor  > 0 )) then  ClEqpSizingFactor + (HVACHtPumpRef[4]:ClSizingFactor  * HtPumpEquipCount[4] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpSizingFactor - 5"		DwellUnitType:ClEqpSizingFactor	= {	if (NumHtPumpEquipTypes > 4 .AND. LocalCompAssigned( HVACHtPumpRef[5]  ) .AND. HtPumpEquipCount[5]  > 0 .AND. IfValidAnd( HVACHtPumpRef[5]:ClSizingFactor  > 0 )) then  ClEqpSizingFactor + (HVACHtPumpRef[5]:ClSizingFactor  * HtPumpEquipCount[5] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpSizingFactor - XX"	DwellUnitType:ClEqpSizingFactor	= {	if (NumHtPumpEqpUnits > 0.5) then  ClEqpSizingFactor / NumHtPumpEqpUnits  else  UNCHANGED  endif  }
;	
;		"Set DwellUnitType:ClEqpCapacity - 1"		DwellUnitType:ClEqpCapacity	= {	if (AutoSizeCool[1]  == 0 .AND. NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1]  ) .AND. HtPumpEquipCount[1]  > 0 .AND. IfValidAnd( HVACHtPumpRef[1]:TotalCapacity  > 0 )) then                  (HVACHtPumpRef[1]:TotalCapacity  * HtPumpEquipCount[1] )  else      0      endif  }
;		"Set DwellUnitType:ClEqpCapacity - 2"		DwellUnitType:ClEqpCapacity	= {	if (AutoSizeCool[2]  == 0 .AND. NumHtPumpEquipTypes > 1 .AND. LocalCompAssigned( HVACHtPumpRef[2]  ) .AND. HtPumpEquipCount[2]  > 0 .AND. IfValidAnd( HVACHtPumpRef[2]:TotalCapacity  > 0 )) then  ClEqpCapacity + (HVACHtPumpRef[2]:TotalCapacity  * HtPumpEquipCount[2] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpCapacity - 3" 		DwellUnitType:ClEqpCapacity	= {	if (AutoSizeCool[3]  == 0 .AND. NumHtPumpEquipTypes > 2 .AND. LocalCompAssigned( HVACHtPumpRef[3]  ) .AND. HtPumpEquipCount[3]  > 0 .AND. IfValidAnd( HVACHtPumpRef[3]:TotalCapacity  > 0 )) then  ClEqpCapacity + (HVACHtPumpRef[3]:TotalCapacity  * HtPumpEquipCount[3] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpCapacity - 4" 		DwellUnitType:ClEqpCapacity	= {	if (AutoSizeCool[4]  == 0 .AND. NumHtPumpEquipTypes > 3 .AND. LocalCompAssigned( HVACHtPumpRef[4]  ) .AND. HtPumpEquipCount[4]  > 0 .AND. IfValidAnd( HVACHtPumpRef[4]:TotalCapacity  > 0 )) then  ClEqpCapacity + (HVACHtPumpRef[4]:TotalCapacity  * HtPumpEquipCount[4] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpCapacity - 5" 		DwellUnitType:ClEqpCapacity	= {	if (AutoSizeCool[5]  == 0 .AND. NumHtPumpEquipTypes > 4 .AND. LocalCompAssigned( HVACHtPumpRef[5]  ) .AND. HtPumpEquipCount[5]  > 0 .AND. IfValidAnd( HVACHtPumpRef[5]:TotalCapacity  > 0 )) then  ClEqpCapacity + (HVACHtPumpRef[5]:TotalCapacity  * HtPumpEquipCount[5] )  else  UNCHANGED  endif  }

	"Set DwellUnitType:CoolEquipSummary"	DwellUnitType:CoolEquipSummary	=        ; CEER reporting - SAC 08/19/20 (tic #1003)
				{	if (NumHtPumpEquipTypes <= 0 .OR. NumHtPumpEqpUnits < 1 .OR. LocalCompAssigned( HVACHtPumpRef[1] ) == 0) then  " "
					else if (HVACHtPumpRef[1]:IsAvailable > 0)
			;		then	Format( "%.0f %s unit(s), %.1f SEER, %.1f EER, %.1f CFM/ton", NumCoolEqpUnits, CoolEqpTypeAbbrev, ClEqpSEER, ClEqpEER, ClEqpCFMperTon )
					then	if (IfValidAnd( HVACHtPumpRef[1]:ShowCEER > 0 ))
                     then  Format( "%.1f CEER", HVACHtPumpRef[1]:CEER )
                     else if (HVACHtPumpRef[1]:Type == 11)
							then	Format( "%.1f EER", ClEqpEER )
							else	Format( "%.1f SEER, %.1f EER, %.0f CFM/ton", ClEqpSEER, ClEqpEER, ClEqpCFMperTon )
							endif endif
					else	" "
					endif endif  }
;	"debug DwellUnitType:CoolEquipSummary"		DwellUnitType:Action		= {	if (FloorAreaServed > 0.5) then PostWarning( "DwellUnitType: '%s' CoolEquipSummary: '%s'", Name, CoolEquipSummary ) else UNCHANGED endif }

	"Set DwellUnitType:HtPumpEquipIssue"		DwellUnitType:HtPumpEquipIssue		=           ; added checks to ensure consistency in AutoSize flags - SAC 03/11/21
				{	if (NumHtPumpEquipTypes <= 0) then  " "
					else if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1]  ) == 0) then  "All heat pump equipment assignments must be specified (first is excluded)"
					else if (NumHtPumpEquipTypes > 1 .AND. LocalCompAssigned( HVACHtPumpRef[2]  ) == 0) then  "All heat pump equipment assignments must be specified (second is excluded)"
					else if (NumHtPumpEquipTypes > 2 .AND. LocalCompAssigned( HVACHtPumpRef[3]  ) == 0) then  "All heat pump equipment assignments must be specified (third is excluded)"
					else if (NumHtPumpEquipTypes > 3 .AND. LocalCompAssigned( HVACHtPumpRef[4]  ) == 0) then  "All heat pump equipment assignments must be specified (fourth is excluded)"
					else if (NumHtPumpEquipTypes > 4 .AND. LocalCompAssigned( HVACHtPumpRef[5]  ) == 0) then  "All heat pump equipment assignments must be specified (fifth is excluded)"
					else if (NumHtPumpEquipTypes > 1 .AND. HVACHtPumpRef[2]:Type  != HVACHtPumpRef[1]:Type) then  Format( "All assigned heat pump equipment must be of the same type (#1: %s / #2: %s)",  HVACHtPumpRef[1]:TypeAbbrevStr, HVACHtPumpRef[2]:TypeAbbrevStr )
					else if (NumHtPumpEquipTypes > 2 .AND. HVACHtPumpRef[3]:Type  != HVACHtPumpRef[1]:Type) then  Format( "All assigned heat pump equipment must be of the same type (#1: %s / #3: %s)",  HVACHtPumpRef[1]:TypeAbbrevStr, HVACHtPumpRef[3]:TypeAbbrevStr )
					else if (NumHtPumpEquipTypes > 3 .AND. HVACHtPumpRef[4]:Type  != HVACHtPumpRef[1]:Type) then  Format( "All assigned heat pump equipment must be of the same type (#1: %s / #4: %s)",  HVACHtPumpRef[1]:TypeAbbrevStr, HVACHtPumpRef[4]:TypeAbbrevStr )
					else if (NumHtPumpEquipTypes > 4 .AND. HVACHtPumpRef[5]:Type  != HVACHtPumpRef[1]:Type) then  Format( "All assigned heat pump equipment must be of the same type (#1: %s / #5: %s)",  HVACHtPumpRef[1]:TypeAbbrevStr, HVACHtPumpRef[5]:TypeAbbrevStr )
					else if (NumHtPumpEquipTypes > 1 .AND. HVACHtPumpRef[2]:AutoSize != HVACHtPumpRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized heat pump equipment (#1 & #2 inconsistent)"
					else if (NumHtPumpEquipTypes > 2 .AND. HVACHtPumpRef[3]:AutoSize != HVACHtPumpRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized heat pump equipment (#1 & #3 inconsistent)"
					else if (NumHtPumpEquipTypes > 3 .AND. HVACHtPumpRef[4]:AutoSize != HVACHtPumpRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized heat pump equipment (#1 & #4 inconsistent)"
					else if (NumHtPumpEquipTypes > 4 .AND. HVACHtPumpRef[5]:AutoSize != HVACHtPumpRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized heat pump equipment (#1 & #5 inconsistent)"
					else  " "  endif endif endif endif endif endif  endif endif endif endif  endif endif endif endif  }

; SAC 11/14/14 - added new properties to aid in CF1R reporting of heating & cooling (& duct/fan) equipment
	"Set DwellUnitType:HeatEquipDucted"		DwellUnitType:HeatEquipDucted		= {	0  }
	"Set DwellUnitType:CoolEquipDucted"		DwellUnitType:CoolEquipDucted		= {	0  }
	"Set DwellUnitType:HtPumpEquipDucted"	DwellUnitType:HtPumpEquipDucted	= {	if (NumHtPumpEquipTypes < 1 .OR. LocalCompAssigned( HVACHtPumpRef[1] ) < 1) then  0
																											else if (HVACHtPumpRef[1]:Type < 1) then  0
																											else	switch (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpEqpTypeAbbrev ))
																														case  1 :	1
																														case  0 :	0
																														default :	if (LocalCompAssigned( HVACDistRef ) < 1) then  0
																																		else if (HVACDistRef:Type > 0 .AND. HVACDistRef:Type != 8) then  1  else  0  endif endif
																													endswitch
																											endif endif  }
	"Set DwellUnitType:EqpCountsMustAlign"	DwellUnitType:EqpCountsMustAlign	= {	0  }

;	; SAC 8/23/13 - moved ConstHtgSetpt from HVACHeat as part of HVAHeat array mods
;		"Default DwellUnitType:ConstHtgSetpt"		DwellUnitType:ConstHtgSetpt	= {	if (strlen( HtPumpEqpTypeAbbrev ) < 2) then  -1
;																								else  T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "EqpType", HtPumpEqpTypeAbbrev )  endif  }
;		"Init DwellUnitType:ConstClgSetpt"			DwellUnitType:ConstClgSetpt	= {	UNDEFINED  }
;	
;	
;		"Init DwellUnitType:HeatDuctedEditable"	DwellUnitType:HeatDuctedEditable	= {	UNDEFINED  }
;		"Init DwellUnitType:HtEqpAFUE"				DwellUnitType:HtEqpAFUE				= {	UNDEFINED  }
;		"Init DwellUnitType:HtEqpSizingFactor"		DwellUnitType:HtEqpSizingFactor	= {	UNDEFINED  }
;		"Init DwellUnitType:HtEqpCapacity"			DwellUnitType:HtEqpCapacity		= {	UNDEFINED  }
	"Init DwellUnitType:HeatEquipIssue"			DwellUnitType:HeatEquipIssue		= {	UNDEFINED  }
;		"Init DwellUnitType:CoolDuctedEditable"	DwellUnitType:CoolDuctedEditable	= {	UNDEFINED  }
	"Init DwellUnitType:CoolEquipIssue"			DwellUnitType:CoolEquipIssue		= {	UNDEFINED  }

  ; DwellUnitType heating equipment used for DHW heating
	"Set HtEqpCanBeDHWHtr flag for HtPumpSystem[1]"		DwellUnitType:HtEqpCanBeDHWHtr	= {	if (NumHtPumpEquipTypes > 0 .AND. IfValidAnd( HVACHtPumpRef[1]:CanBeDHWHtr > -1 ))
																															then  HVACHtPumpRef[1]:CanBeDHWHtr
																															else  0  endif  }
	"Default DwellUnitType:ServesAsDHWHtr flag"			DwellUnitType:ServesAsDHWHtr		= {	0	}		; or default to TRUE if it CAN be DHW heater??  - was: HtEqpCanBeDHWHtr  }
	"Set DwellUnitType:HtEqpUsedAsDHWHtr flag"			DwellUnitType:HtEqpUsedAsDHWHtr	= {	if (HtEqpCanBeDHWHtr < 1 .OR. ServesAsDHWHtr < 1) then  0  else  1  endif  }
	"Default other DwellUnitType DHW heating properties"		DwellUnitType:Action			= {	if (HtEqpUsedAsDHWHtr < 1) then  UNCHANGED
																															else	EvalRulelist( "DefaultDwellUnitType_DHWHeating", 1 )  endif  }

;		"Initialize other generic properties (common to Ht/Cl/HP)"		DwellUnitType:Action	= {	EvalRulelist( "SetupHVACSys_Round2_common", 1 )  }
END


; SAC 9/3/15 - Defaulting of DwellUnitType (heating equipment) used as DHWHeater
;*************************************************************************
RULELIST "DefaultDwellUnitType_DHWHeating" 0 0 0 0
;*************************************************************************

	; DwellUnitType:DHWSystemType  - defaulted via enumeration definitions

	"Default DwellUnitType:DHWHeaterElementType"		DwellUnitType:DHWHeaterElementType	= {	"Air-Source Heat Pump"  }		; SAC 9/3/15 - always use ASHP, even when htg equip is GSHP - same as how we handle DHW-heating HVACSys objects
																											;				if (IfValidAnd( HVACSysType = 2 ) .AND. IfValidAnd( HVACHtPumpRef[1]:Type = 12 ))  ; Type = HP / HtPumpSysType = "GroundSourceHeatPump - Ground source heat pump (able to heat DHW)"
																											;				then	"Ground-Source Heat Pump"
																											;				else	   "Air-Source Heat Pump"    endif  }
;			0, DwellUnitType:DHWHeaterElementType,  3
;			2,          3, "Air-Source Heat Pump"
;			2,          6, "Ground-Source Heat Pump"

	"Default DwellUnitType:DHWTankType"					DwellUnitType:DHWTankType         	= {	if (IfValidAnd( HVACHtPumpRef[1]:Type = 12 ) .OR.								; GSHP -> 'Small Storage'
																																 IfValidAnd( HVACHtPumpRef[1]:Type = 11 ) ) then  "Small Storage"		; AWHP -> 'Small Storage'	- SAC 1/13/16 - added (tic 560)
																															else	"Indirect"  endif  }																; SAC 6/6/14 - updated DHW engine now works w/ AWHP + Indirect tank
;			0, DwellUnitType:DHWTankType,  1
;			2,          1, "Indirect"                ; %WHTYPE_IND =      1		' indirect    
;			2,          6, "Small Storage"           ; %WHTYPE_SSTOR =    6		' small storage

	"Default DwellUnitType:DHWInputRating"				DwellUnitType:DHWInputRating      	= {	if (DHWTankType == 6) then  8000			; small storage
																															else	0  endif                }
	"Default DwellUnitType:DHWInputRatingUnits"		DwellUnitType:DHWInputRatingUnits	= {	switch (DHWHeaterElementType)
																														;		case  0 :	"watts"   ; "Electric Resistance" 
																														;		case  1 :   "Btu/hr"  ; "Natural Gas"   
																														;		case  2 :   "Btu/hr"  ; "Propane"             
																																case  3 :   "watts"   ; "Air-Source Heat Pump"           
																																case  6 :   "watts"   ; "Ground-Source Heat Pump"           
																														;		case  4 :   "Btu/hr"  ; "Oil"   
																																default :	" "
																															endswitch  }

;	"Default DwellUnitType:DHWEnergyFactor"			DwellUnitType:DHWEnergyFactor     	= {	(0.9376 * HVACSys:HPSysCOP47 - 0.7032) / (1.086 - 0.1102 * HVACSys:HPSysCOP47)	}
;	"Default DwellUnitType:DHWEnergyFactor"			DwellUnitType:DHWEnergyFactor     	= {	0.575	           }
	"Default DwellUnitType:DHWEnergyFactor"			DwellUnitType:DHWEnergyFactor     	= {	if (IfValidAnd( HVACHtPumpRef[1]:Type = 12 ))
																															then		if (Proj:Fuel_HaveNatGas > 0.5) then  2.8  else  1.85  endif		; GSHP defaulting		; SAC 11/10/15
																															else if (IfValidAnd( HPEqpCOP47 > 0.5 )) then  HPEqpCOP47  else  3  endif endif  }

	"Default DwellUnitType:DHWTankVolume"				DwellUnitType:DHWTankVolume       	= {	50               }
	"Default DwellUnitType:DHWIntInsulRVal"			DwellUnitType:DHWIntInsulRVal     	= {	0                }
	"Default DwellUnitType:DHWExtInsulRVal"			DwellUnitType:DHWExtInsulRVal     	= {	0                }
	"Default DwellUnitType:DHWAmbientCond"				DwellUnitType:DHWAmbientCond      	= {	"Unconditioned"  }
	"Default DwellUnitType:DHWStandbyLossFrac"		DwellUnitType:DHWStandbyLossFrac  	= {	0                }

	; DwellUnitType:DHWSolFracType  - defaulted via enumeration definitions
	"Default DwellUnitType:DHWSolFracAnn"					DwellUnitType:DHWSolFracAnn		= {	0  }
	"Default DwellUnitType:DHWSolFracMon[1] - Jan"		DwellUnitType:DHWSolFracMon[1]	= {	0  }
	"Default DwellUnitType:DHWSolFracMon[2] - Feb"		DwellUnitType:DHWSolFracMon[2]	= {	0  }
	"Default DwellUnitType:DHWSolFracMon[3] - Mar"		DwellUnitType:DHWSolFracMon[3]	= {	0  }
	"Default DwellUnitType:DHWSolFracMon[4] - Apr"		DwellUnitType:DHWSolFracMon[4]	= {	0  }
	"Default DwellUnitType:DHWSolFracMon[5] - May"		DwellUnitType:DHWSolFracMon[5]	= {	0  }
	"Default DwellUnitType:DHWSolFracMon[6] - Jun"		DwellUnitType:DHWSolFracMon[6]	= {	0  }
	"Default DwellUnitType:DHWSolFracMon[7] - Jul"		DwellUnitType:DHWSolFracMon[7]	= {	0  }
	"Default DwellUnitType:DHWSolFracMon[8] - Aug"		DwellUnitType:DHWSolFracMon[8]	= {	0  }
	"Default DwellUnitType:DHWSolFracMon[9] - Sep"		DwellUnitType:DHWSolFracMon[9]	= {	0  }
	"Default DwellUnitType:DHWSolFracMon[10] - Oct"		DwellUnitType:DHWSolFracMon[10]	= {	0  }
	"Default DwellUnitType:DHWSolFracMon[11] - Nov"		DwellUnitType:DHWSolFracMon[11]	= {	0  }
	"Default DwellUnitType:DHWSolFracMon[12] - Dec"		DwellUnitType:DHWSolFracMon[12]	= {	0  }

	"Set DwellUnitType:DHWSolFracMonAvg"		DwellUnitType:DHWSolFracMonAvg		= {		; SAC 6/17/16 - tic #682
						switch (DHWSolFracType)
							case  1 :	if (LocalStatus( DHWSolFracAnn ) > 1) then  DHWSolFracAnn  else  0  endif
							case  2 :	if (	LocalStatus( DHWSolFracMon[1]  ) > 1 .AND. LocalStatus( DHWSolFracMon[2]  ) > 1 .AND. LocalStatus( DHWSolFracMon[3]  ) > 1 .AND. 
													LocalStatus( DHWSolFracMon[4]  ) > 1 .AND. LocalStatus( DHWSolFracMon[5]  ) > 1 .AND. LocalStatus( DHWSolFracMon[6]  ) > 1 .AND. 
													LocalStatus( DHWSolFracMon[7]  ) > 1 .AND. LocalStatus( DHWSolFracMon[8]  ) > 1 .AND. LocalStatus( DHWSolFracMon[9]  ) > 1 .AND. 
													LocalStatus( DHWSolFracMon[10] ) > 1 .AND. LocalStatus( DHWSolFracMon[11] ) > 1 .AND. LocalStatus( DHWSolFracMon[12] ) > 1 )
											then  ( (DHWSolFracMon[1]  * 31) + (DHWSolFracMon[2]  * 28) + (DHWSolFracMon[3]  * 31) + (DHWSolFracMon[4]  * 30) +
													  (DHWSolFracMon[5]  * 31) + (DHWSolFracMon[6]  * 30) + (DHWSolFracMon[7]  * 31) + (DHWSolFracMon[8]  * 31) + 
													  (DHWSolFracMon[9]  * 30) + (DHWSolFracMon[10] * 31) + (DHWSolFracMon[11] * 30) + (DHWSolFracMon[12] * 31) ) / 365
											else  0  endif
							default :  0
						endswitch  }
END


; SAC 8/24/13 - setup secondary set of HVACSys Heat/Cool/HtPump assignment properties
;*************************************************************************
RULELIST "SetupHVACSys_Round2_common" 0 0 0 0
;*************************************************************************

;	"store BEMProc details"		HVACSys:Action = {  StoreBEMProc( "b4 setting HVACSys-HaveHeating", 0 )  }
;	"debugging"		HVACSys:Action		= {	MessageBox( "check BEMProc file for HVACSys '%s'", HVACSys:Name )  }

; SAC 1/14/14 - added logic to check for Std design run being performed to ensure that HtPump auto-sizing is turned ON
; SAC 5/22/14 - added references to PropEqStd table values so that zeroed out capacities don't result in no heating/cooling settings
; SAC 10/27/15 - added check for design rating run abbreviation (Proj:RunAbbrev == "dr" or "DR")
; SAC 11/13/18 - revise logic to prevent requirement of Cap17 > 0 to HaveHeating for VCHP equipment
	"Set HVACSys:HaveHeating"		HVACSys:HaveHeating	= {	if (Type < 1) then  0
																				else if (Type == 2)
																				then	if (NumHtPumpSystemTypes <= 0 .OR. LocalCompAssigned( HtPumpSystem[1] ) == 0) then  0
																		;				else if (AutoSizeHeat[1] > 0.5 .OR. (HPSysCap47 > 1 .AND. HPSysCap17 > 1)) then  1    - replaced this w/ below as part of GC issue 186 fix (SAC 9/29/13)
																						else if (IfValidAnd( AutoSizeHeatInp > 0.5 ) .OR. IfValidAnd( HtPumpSystem[1]:AutoSize > 0.5 ) .OR.
																						         Proj:RunAbbrev == "s" .OR. Proj:RunAbbrev == "S" .OR. Proj:RunAbbrev == "smf" .OR. Proj:RunAbbrev == "dr" .OR. Proj:RunAbbrev == "DR" .OR.
																									((IfValidAnd( HPSysCap47 > 1 ) .AND. (IfValidAnd(HPSysCap17 > 1) .OR. IfValidAnd( HtPumpSystem[1]:IsPackaged > 0 ) .OR.
																									                                      IfValidAnd(HtPumpSystem[1]:Type == 12) .OR. IfValidAnd(HtPumpSystem[1]:Type == 22) .OR. IfValidAnd(HtPumpSystem[1]:Type == 33))) .OR.
																										T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) > 0.5)) then  1
																						else  0
																						endif endif
																				else	if (NumHeatSystemTypes <= 0 .OR. LocalCompAssigned( HeatSystem[1] ) == 0) then  0
																						else if (IfValidAnd( AutoSizeHeat[1] > 0.5 ) .OR. IfValidAnd( HtSysCapacity > 1 ) .OR.
																									T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HeatSysTypeAbbrev ) > 0.5) then  1
																						else  0
																						endif endif
																				endif endif  } 
	"Set HVACSys:ServesHeating"	HVACSys:ServesHeating = {	if (HaveHeating .AND. FloorAreaServed[1] > 0.5) then  1  else  0  endif  }    ; SAC 5/14/19

 ; SAC 1/11/14 - added logic to set HaveCooling to 0 when cooling sys type = NoCooling																				
	"Set HVACSys:HaveCooling"		HVACSys:HaveCooling	= {	if (Type < 1) then  0
																				else if (Type == 2)
																				then	if (NumHtPumpSystemTypes <= 0 .OR. LocalCompAssigned( HtPumpSystem[1] ) == 0) then  0
																						else if (IfValidAnd( AutoSizeCool[1] > 0.5 ) .OR. IfValidAnd( HtPumpSystem[1]:Type = 33 ) .OR.
                                                                           IfValidAnd( ClSysCapacity > 1 ) .OR.
																									T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) > 0.5) then  1
																						else  0
																						endif endif
																				else	if (NumCoolSystemTypes <= 0 .OR. LocalCompAssigned( CoolSystem[1] ) == 0) then  0
																						else if (CoolSystem[1]:Type == 1) then  0		; NoCooling
																						else if (IfValidAnd( AutoSizeCool[1] > 0.5 ) .OR. IfValidAnd( ClSysCapacity > 1 ) .OR.
																									T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev ) > 0.5) then  1
																						else  0
																						endif endif endif 
																				endif endif  } 
	"Set HVACSys:ServesCooling"	HVACSys:ServesCooling = {	if (HaveCooling .AND. FloorAreaServed[1] > 0.5) then  1  else  0  endif  }    ; SAC 5/14/19

	"Set HVACSys:HaveHtPump"		HVACSys:HaveHtPump	= {	if (Type == 2 .AND. HaveHeating .AND. HaveCooling) then  1  else  0  endif  }

  ; SAC 4/30/14 - revised rule to include logic unique to Heat Pump (Type==2) systems vs. other systems
	"Set HVACSys:HtOrClDucted - heat"	HVACSys:HtOrClDucted		= {	if (Type == 2)
																							then	if (HtPumpDucted > 0.5) then  1  else  0  endif
																							else if (HaveHeating)
																							then  if (HeatDucted > 0.5) then  1  else  0  endif
																							else  0  endif endif  }
	"Set HVACSys:HtOrClDucted - cool"	HVACSys:HtOrClDucted		= {	if (Type == 2)
																							then	if (HtPumpDucted > 0.5) then  HtOrClDucted + 2  else  UNCHANGED  endif
																							else if (HaveCooling)
																							then  if (CoolDucted > 0.5) then  HtOrClDucted + 2  else  UNCHANGED  endif
																							else  UNCHANGED  endif endif  }
;	"debug Duct Flag"		HVACSys:Action		= {	if (Type == 2) then	MessageBox( "check #2 HtPumpDucted %g   HtOrClDucted %g", HVACSys:HtPumpDucted, HVACSys:HtOrClDucted  )
;																					else	MessageBox( "check #2 CoolDucted %g   HtOrClDucted %g", HVACSys:CoolDucted, HVACSys:HtOrClDucted  )  endif  }

  ; SAC 1/14/16 - moved and combined rules that set HVACSys:MaxNumHVACEquipTypes from above in 'SetupHVACSys_Round1_*' rulelists to here since it is now also dependent on HVACSys:HtOrClDucted - done to ensure SCSysRpt objects created for existing ducted systems w/ altered ducts
  ; SAC 1/8/20 - revised logic to include output of heat, cool & ducts for Existing duct systems
	"Set HVACSys:MaxNumHVACEquipTypes"		HVACSys:MaxNumHVACEquipTypes	= {	if (FloorAreaServed[1] < 0.5) then  0
																										else 	if (Type == 2)
																												then  NumHtPumpSysUnits									; Project is New Cons .OR. HVACSys is New or Altered or HVACDist is New or Altered
																												else	max( NumHeatSysUnits, NumCoolSysUnits )
																												endif
																										endif  }
;																										else if (Proj:RunScope == 1 .OR. Status > 1 .OR. (IsExisting .AND. IsVerified) .OR.
;																													(IsExisting .AND. HtOrClDucted > 0.5 .AND. IfValidAnd( DistribSystem:Status > 1 )))

; SAC 9/4/13 - added logic to allow no ducts when distrib system's HVACDist:Type = 12 ("LowLlCod - Verified low-leakage ducts in conditioned space") - GC issue 163
; SAC 5/21/14 - added 'LocalStatus( DistribSystem ) > 4' check to prevent bogus DuctMsg when DistribSystem created & assigned via ruleset (happens when simulated heat/cool system requires ducts even though user input system doesn't) - GC #312
	"Set HVACSys:DuctMsg"	HVACSys:DuctMsg	= {	if (HtOrClDucted > 0.5 .AND. LocalCompAssigned( DistribSystem ) == 0)
																	then	switch (HtOrClDucted)
																				case  1 : "Ducts required for heating system but not defined for this system."
																				case  2 : "Ducts required for cooling system but not defined for this system."
																				default : "Ducts required for heating & cooling systems but not defined for this system."
																			endswitch
																	else if (HtOrClDucted > 0.5 .AND. DistribSystem:DuctsPresent == 0 .AND. DistribSystem:Type != 7 .AND. DistribSystem:Type != 12)
																	then	switch (HtOrClDucted)
																				case  1 : "Ducts required for heating system but assigned distribution system lacks ducts."
																				case  2 : "Ducts required for cooling system but assigned distribution system lacks ducts."
																				default : "Ducts required for htg & clg systems but assigned distribution system lacks ducts."
																			endswitch
																	else if (HtOrClDucted < 0.5 .AND. LocalCompAssigned( DistribSystem ) > 0 .AND. LocalStatus( DistribSystem ) > 4)
																	then	if (DistribSystem:DuctsPresent > 0 .AND. Proj:BypassRuleLimits < 0.5)
																			then  "Ducts not required for heating or cooling but included in assigned distribution system."
																			else  " "  endif
																	else  " "  endif endif endif  }


	"Rules to compare HVACSys vs. Standard design"		HVACSys:Action		= {	if (Type == 1 .OR. Type == 3)
																										then  EvalRulelist( "SetupHVACSys_HeatCoolVsStandard", 1 )
																										else if (Type == 2)
																										then	EvalRulelist( "SetupHVACSys_HtPumpVsStandard", 1 )
																										else	UNCHANGED  endif endif  }

; SAC 12/26/14 - logic to setup duct vs. std design enumeration
; mjb 1/29/15 - mods to lookup Std Duct Leakage & Rval from T24RClimateZoneCodeBase table
; mjb 1/29/15 - P.S. why do SAC rules check validity of DuctInsRvalue twice?  why do SAC rules use Rval = 6 when Stds vary between 6 and 8, by CZ?
;	"Set HVACSys:DuctsVsStandard"		HVACSys:DuctsVsStandard	= {	if (HtOrClDucted < 1)
;																						then  -1		; "Worse than Standard"
;																						else if (IfValidAnd( DistribSystem:DuctLeakageValUse = 8.0 ) .AND.
;																									IfValidAnd( DistribSystem:DuctInsRvalue     = 6.0 ) .AND.
;																									IfValidAnd( DistribSystem:DuctInsRvalue     = 6.0 ))
;																						then	 0		; "Equal to Standard"
;																						else if (IfValidAnd( DistribSystem:DuctLeakageValUse <= 8.0 ) .AND.
;																									IfValidAnd( DistribSystem:DuctInsRvalue     >= 6.0 ) .AND.
;																									IfValidAnd( DistribSystem:DuctInsRvalue     >= 6.0 ))
;																						then	 1		; "Better than Standard"
;																						else  -1		; "Worse than Standard"
;																						endif endif endif  }
; SAC 11/9/15 - revised thrid operation in each if/then to reference "Ret"DuctInsRvalue & added logic comparing altered inputs to ALTERED DuctRval values
	"Set HVACSys:DuctsVsStandard"		HVACSys:DuctsVsStandard	= {	if (HtOrClDucted < 1)
																						then  -1		; "Worse than Standard"
																						else if (DistribSystem:Status == 2)	; ALTERED
																						then	if (		IfValidAnd( DistribSystem:DuctLeakageValUse =  T24RClimateZoneCodeBase:DuctLkg(     "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ) .AND.
																											IfValidAnd( DistribSystem:DuctInsRvalue     =  T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ) .AND.
																											IfValidAnd( DistribSystem:RetDuctInsRvalue  =  T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ))
																								then	 0		; "Equal to Standard"
																								else if (IfValidAnd( DistribSystem:DuctLeakageValUse <= T24RClimateZoneCodeBase:DuctLkg(     "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ) .AND.
																											IfValidAnd( DistribSystem:DuctInsRvalue     >= T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ) .AND.
																											IfValidAnd( DistribSystem:RetDuctInsRvalue  >= T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ))
																								then	 1		; "Better than Standard"
																								else  -1		; "Worse than Standard"
																								endif endif
																						else	if (		IfValidAnd( DistribSystem:DuctLeakageValUse =  T24RClimateZoneCodeBase:DuctLkg(  "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ) .AND.
																											IfValidAnd( DistribSystem:DuctInsRvalue     =  T24RClimateZoneCodeBase:DuctRval( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ) .AND.
																											IfValidAnd( DistribSystem:RetDuctInsRvalue  =  T24RClimateZoneCodeBase:DuctRval( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ))
																								then	 0		; "Equal to Standard"
																								else if (IfValidAnd( DistribSystem:DuctLeakageValUse <= T24RClimateZoneCodeBase:DuctLkg(  "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ) .AND.
																											IfValidAnd( DistribSystem:DuctInsRvalue     >= T24RClimateZoneCodeBase:DuctRval( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ) .AND.
																											IfValidAnd( DistribSystem:RetDuctInsRvalue  >= T24RClimateZoneCodeBase:DuctRval( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ))
																								then	 1		; "Better than Standard"
																								else  -1		; "Worse than Standard"
																								endif endif
																						endif endif  }
	"Set HVACSys:DistribSystem:DuctsVsStandard"		HVACSys:DistribSystem:DuctsVsStandard	= {	DuctsVsStandard  }

;	"store BEMProc details"		HVACSys:Action = {  StoreBEMProc( "after setting HVACSys-HaveHeating", 0 )  }
;	"debugging"		HVACSys:Action		= {	MessageBox( "check BEMProc file for HVACSys '%s'", HVACSys:Name )  }
	
END


; SAC 12/26/14 - new rulelists to check for system performance vs. standard design
;*************************************************************************
RULELIST "SetupHVACSys_HeatCoolVsStandard" 0 0 0 0
;*************************************************************************
	"Set HVACSys:StdSysSEER & StdSysEER via subordinate rulelists"
			HVACSys:Action	= {	if (HaveCooling < 1 .OR. CoolSysType < 1)
										then  EvalRulelist( "Default_HVACSys_StdCool_Undefined", 1 )
										else if (T24RCoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev ) > 0)
										then  EvalRulelist( "Default_HVACSys_StdCoolViaCaliforniaSEERtoEERFormula", 1 )
										else if (T24RCoolingEquipment:EERValid(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev ) > 0)
										then  EvalRulelist( "Default_HVACSys_StdCoolViaCaliforniaEERtoSEERFormula", 1 )
										else  EvalRulelist( "Default_HVACSys_StdCool_Undefined", 1 )
										endif endif endif  }
; mjb 1/30/15 - mods to lookup CFMperTon std from T24RClimateZoneCodeBase
;	"Set HVACSys:CoolEqpVsStandard"		HVACSys:CoolEqpVsStandard	= {	if (HaveCooling < 1 .OR. CoolSysType < 1) then  -1		; "Worse than Standard"
;																								else if (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev ) ==  0 .OR.
;																										  (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev ) == -1 .AND. IfValidAnd( HtOrClDucted > 1 )))
;																								then	; System IS COOL DUCTED - so include CFMperTon in Std design comparison
;																										if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER = ClSysSEER )) .AND.
;																											  (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  = ClSysEER  )) .AND.
;																											  (IfValidAnd( ClSysCFMperTon = 0 ) .OR. IfValidAnd( ClSysCFMperTon = 350 )) )
;																										then	 0		; "Equal to Standard"
;																										else if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER <= ClSysSEER )) .AND.
;																													 (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  <= ClSysEER  )) .AND.
;																													 (IfValidAnd( ClSysCFMperTon = 0 ) .OR. IfValidAnd( ClSysCFMperTon <= 350 )) )
;																										then	 1		; "Better than Standard"
;																										else	-1		; "Worse than Standard"
;																										endif endif
;																								else	; System IS NOT COOL DUCTED - so EXclude CFMperTon in Std design comparison
;																										if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER = ClSysSEER )) .AND.
;																											  (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  = ClSysEER  )) )
;																										then	 0		; "Equal to Standard"
;																										else if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER <= ClSysSEER )) .AND.
;																													 (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  <= ClSysEER  )) )
;																										then	 1		; "Better than Standard"
;																										else	-1		; "Worse than Standard"
;																										endif endif
;																								endif endif  }
	"Set HVACSys:CoolEqpVsStandard"		HVACSys:CoolEqpVsStandard	= {	if (HaveCooling < 1 .OR. CoolSysType < 1) then  -1		; "Worse than Standard"
																								else if (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev ) ==  0 .OR.
																										  (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev ) == -1 .AND. IfValidAnd( HtOrClDucted > 1 )))
																								then	; System IS COOL DUCTED - so include CFMperTon in Std design comparison
																										if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER = ClSysSEER )) .AND.
																											  (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  = ClSysEER  )) .AND.
																											  (IfValidAnd( ClSysCFMperTon = 0 ) .OR. IfValidAnd( ClSysCFMperTon = T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) )) )
																										then	 0		; "Equal to Standard"
																										else if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER <= ClSysSEER )) .AND.
																													 (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  <= ClSysEER  )) .AND.
																													 (IfValidAnd( ClSysCFMperTon = 0 ) .OR. IfValidAnd( ClSysCFMperTon <= T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) )) )
																										then	 1		; "Better than Standard"
																										else	-1		; "Worse than Standard"
																										endif endif
																								else	; System IS NOT COOL DUCTED - so EXclude CFMperTon in Std design comparison
																										if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER = ClSysSEER )) .AND.
																											  (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  = ClSysEER  )) )
																										then	 0		; "Equal to Standard"
																										else if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER <= ClSysSEER )) .AND.
																													 (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  <= ClSysEER  )) )
																										then	 1		; "Better than Standard"
																										else	-1		; "Worse than Standard"
																										endif endif
																								endif endif  }

	"Set HVACSys:HeatEqpVsStandard"		HVACSys:HeatEqpVsStandard	= {	if (HaveHeating < 1 .OR. HeatSysType < 1) then  -1		; "Worse than Standard"
																								else if (T24RHeatingEquipment:AFUEValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HeatSysTypeAbbrev ) > 0 .AND.
																											LocalStatus( HtSysAFUE ) > 0)
																								then	if (HtSysAFUE == T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HeatSysTypeAbbrev ))
																										then	 0		; "Equal to Standard"
																										else if (HtSysAFUE > T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HeatSysTypeAbbrev ))
																										then	 1		; "Better than Standard"
																										else	-1		; "Worse than Standard"
																										endif endif
																								else if (T24RHeatingEquipment:HSPFValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HeatSysTypeAbbrev ) > 0 .AND.
																											LocalStatus( HPSysHSPF ) > 0)
																								then	if (HPSysHSPF == T24RHeatingEquipment:HSPF( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HeatSysTypeAbbrev ))
																										then	 0		; "Equal to Standard"
																										else if (HPSysHSPF > T24RHeatingEquipment:HSPF( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HeatSysTypeAbbrev ))
																										then	 1		; "Better than Standard"
																										else	-1		; "Worse than Standard"
																										endif endif
																								else			-1		; "Worse than Standard"
																								endif endif endif  }
END
;*************************************************************************
RULELIST "SetupHVACSys_HtPumpVsStandard" 0 0 0 0
;*************************************************************************
	"Set HVACSys:StdSysSEER & StdSysEER via subordinate rulelists"
			HVACSys:Action	= {	if (HtPumpSysType < 1)
										then  EvalRulelist( "Default_HVACSys_StdCool_Undefined", 1 )
										else if (T24RCoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) > 0)
										then  EvalRulelist( "Default_HVACSys_StdHtPumpCoolViaCaliforniaSEERtoEERFormula", 1 )
										else if (T24RCoolingEquipment:EERValid(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) > 0)
										then  EvalRulelist( "Default_HVACSys_StdHtPumpCoolViaCaliforniaEERtoSEERFormula", 1 )
										else  EvalRulelist( "Default_HVACSys_StdCool_Undefined", 1 )
										endif endif endif  }
; mjb 1/30/15 - mods to lookup CFMperTon std. from T24RClimateZoneCodeBase
;	"Set HVACSys:CoolEqpVsStandard"		HVACSys:CoolEqpVsStandard	= {	if (HtPumpSysType < 1) then  -1		; "Worse than Standard"
;																								else if (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) ==  0 .OR.
;																										  (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) == -1 .AND. HtOrClDucted > 1))
;																								then	; System IS COOL DUCTED - so include CFMperTon in Std design comparison
;																										if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER = ClSysSEER )) .AND.
;																											  (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  = ClSysEER  )) .AND.
;																											  (ClSysCFMperTon == 0 .OR. ClSysCFMperTon == 350) )
;																										then	 0		; "Equal to Standard"
;																										else if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER <= ClSysSEER )) .AND.
;																													 (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  <= ClSysEER  )) .AND.
;																													 (ClSysCFMperTon == 0 .OR. ClSysCFMperTon <= 350) )
;																										then	 1		; "Better than Standard"
;																										else	-1		; "Worse than Standard"
;																										endif endif
;																								else	; System IS NOT COOL DUCTED - so EXclude CFMperTon in Std design comparison
;																										if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER = ClSysSEER )) .AND.
;																											  (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  = ClSysEER  )) )
;																										then	 0		; "Equal to Standard"
;																										else if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER <= ClSysSEER )) .AND.
;																													 (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  <= ClSysEER  )) )
;																										then	 1		; "Better than Standard"
;																										else	-1		; "Worse than Standard"
;																										endif endif
;																								endif endif  }
	"Set HVACSys:CoolEqpVsStandard"		HVACSys:CoolEqpVsStandard	= {	if (HtPumpSysType < 1) then  -1		; "Worse than Standard"
																								else if (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) ==  0 .OR.
																										  (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) == -1 .AND. HtOrClDucted > 1))
																								then	; System IS COOL DUCTED - so include CFMperTon in Std design comparison
																										if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER = ClSysSEER )) .AND.
																											  (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  = ClSysEER  )) .AND.
																											  (ClSysCFMperTon == 0 .OR. ClSysCFMperTon == T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )) )
																										then	 0		; "Equal to Standard"
																										else if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER <= ClSysSEER )) .AND.
																													 (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  <= ClSysEER  )) .AND.
																													 (ClSysCFMperTon == 0 .OR. ClSysCFMperTon <= T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )) )
																										then	 1		; "Better than Standard"
																										else	-1		; "Worse than Standard"
																										endif endif
																								else	; System IS NOT COOL DUCTED - so EXclude CFMperTon in Std design comparison
																										if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER = ClSysSEER )) .AND.
																											  (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  = ClSysEER  )) )
																										then	 0		; "Equal to Standard"
																										else if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER <= ClSysSEER )) .AND.
																													 (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  <= ClSysEER  )) )
																										then	 1		; "Better than Standard"
																										else	-1		; "Worse than Standard"
																										endif endif
																								endif endif  }

	"Set HVACSys:HeatEqpVsStandard"		HVACSys:HeatEqpVsStandard	= {	if (HtPumpSysType < 1) then  -1		; "Worse than Standard"
																								else if (T24RHeatingEquipment:HSPFValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) > 0)
																								then	if (HPSysHSPF == T24RHeatingEquipment:HSPF( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ))
																										then	 0		; "Equal to Standard"
																										else if (HPSysHSPF > T24RHeatingEquipment:HSPF( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ))
																										then	 1		; "Better than Standard"
																										else	-1		; "Worse than Standard"
																										endif endif
																								else if (T24RHeatingEquipment:AFUEValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) > 0)
																								then	if (HtSysAFUE == T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ))
																										then	 0		; "Equal to Standard"
																										else if (HtSysAFUE > T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ))
																										then	 1		; "Better than Standard"
																										else	-1		; "Worse than Standard"
																										endif endif
																								else			-1		; "Worse than Standard"
																								endif endif endif  }
END


;*************************************************************************
RULELIST "BlastHVACSysUserInput_Heating" 1 0 0 0
   "Redefault HVACSys:AutoSizeHeatInp"		HVACSys:AutoSizeHeatInp		= {   UNDEFINED  }
   "Redefault HVACSys:HeatDucted"			HVACSys:HeatDucted			= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "BlastHVACSysUserInput_Cooling" 1 0 0 0
   "Redefault HVACSys:AutoSizeCoolInp"		HVACSys:AutoSizeCoolInp		= {   UNDEFINED  }
   "Redefault HVACSys:CoolDucted"			HVACSys:CoolDucted			= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "BlastHVACSysUserInput_HeatPump" 1 0 0 0
;   "Redefault HVACSys:AutoSizeHeatInp"		HVACSys:AutoSizeHeatInp		= {   UNDEFINED  }
;   "Redefault HVACSys:AutoSizeCoolInp"		HVACSys:AutoSizeCoolInp		= {   UNDEFINED  }
   "Redefault HVACSys:HtPumpDucted"			HVACSys:HtPumpDucted			= {	UNDEFINED  }
END
;*************************************************************************

;*************************************************************************
RULELIST "BlastDwellUnitTypeUserInput_Heating" 1 0 0 0
;   "Redefault DwellUnitType:AutoSizeHeatInp"		DwellUnitType:AutoSizeHeatInp		= {   UNDEFINED  }
;   "Redefault DwellUnitType:HeatDucted"			DwellUnitType:HeatDucted			= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "BlastDwellUnitTypeUserInput_Cooling" 1 0 0 0
;   "Redefault DwellUnitType:AutoSizeCoolInp"		DwellUnitType:AutoSizeCoolInp		= {   UNDEFINED  }
;   "Redefault DwellUnitType:CoolDucted"			DwellUnitType:CoolDucted			= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "BlastDwellUnitTypeUserInput_HeatPump" 1 0 0 0
;;   "Redefault DwellUnitType:AutoSizeHeatInp"		DwellUnitType:AutoSizeHeatInp		= {   UNDEFINED  }
;;   "Redefault DwellUnitType:AutoSizeCoolInp"		DwellUnitType:AutoSizeCoolInp		= {   UNDEFINED  }
;   "Redefault DwellUnitType:HtPumpDucted"			DwellUnitType:HtPumpDucted			= {	UNDEFINED  }
END
;*************************************************************************


;*************************************************************************
RULELIST "Default_HVACDist" 0 0 0 0
;*************************************************************************
   ; SAC 6/1/17 - tic #621
   "Default HVACDist properties that may impact default Type"  HVACDist:Action  = {
         EvalRulelist( "Default_HVACDist_PriorToType", 1 )  }

   ; SAC 8/25/13 - added default for HVACDist:Type
   ; SAC 5/22/14 - added logic to default to attic only if attic area above cond zone(s) >= 10% of CFA and in crawl space (also if >= 10% CFA)
   ; SAC 5/23/14 - revised defaulting to require user input if a valid attic is not present (per call w/ Bruce 5/23/14)
   ; SAC 4/15/15 - adjust for MFam duplex/townhomes options (based on Proj:IsMFamDupOrTownhm)
   ; SAC 6/1/17 - added logic to prevent Type default of 1 (attic) if attic too small for default ducts (tic #621)
   ; revised logic to reference Proj:AtticAreaOKForDucts - SAC 08/13/20 (tic #1062)
	"Set HVACDist:Type"		HVACDist:Type	 	= {	
    if( ( Proj:IsMultiFamily == 0 .OR. Proj:IsMFamDupOrTownhm > 0.5) .AND. 
        ComponentCount( Attic ) > 0.5 .AND. 
        SumAll( Attic:ClVentableArea ) > 0 .AND.
			  SumAll( Attic:FloorAreaOverCond ) > 0 .AND. 
        IfValidAnd( Proj:CondFloorArea > 1 ))
    then  if (IfValidAnd( Proj:AtticAreaOKForDucts > 0 ) .AND.
              IfValidAnd( DuctsTooLrgForAttic = 0 ))
      then	1		; "Ducts located in attic (Ventilated and Unventilated)"
      else  0		; "- select distribution system type -"
      endif
    else  	0		; "- select distribution system type -"
    endif  }

	"Set HVACDist:DuctsCreatedForAnalysis"		HVACDist:DuctsCreatedForAnalysis		= {	0  }	; SAC 7/12/14

; mjb 12/2/15 - need no duct losses in Design Rating model for RESNET harmonization
	"Reset HVACDist:Type"		HVACDist:Type	 	= {	if (Proj:DRtgRefRunID == 2014) then  12
	                                                   else UNCHANGED endif }
	
;	"debug"		HVACDist:Action	= {	PostMessageToLog( "inside Default_HVACDist - HVACDist '%s':  Type = '%s' (%g) (status %d)  Attic:FloorArea = %g  Attic:FloorAreaOverCond = %g  Proj:CondFloorArea = %g",
;																		Name, EnumString( Type ), Type, LocalStatus( Type ), SumAll( Attic:FloorArea ), SumAll( Attic:FloorAreaOverCond ), Proj:CondFloorArea )  }

	"Default remaining HVACDist properties"	HVACDist:Action	= {	EvalRulelist( "Default_HVACDist_OtherThanType", 1 )  }
END
;*************************************************************************
RULELIST "Default_HVACDist_ForceTypeDefault" 1 0 1 0
;*************************************************************************
   ; SAC 6/1/17 - tic #621
   "Default HVACDist properties that may impact default Type"  HVACDist:Action  = {
         EvalRulelist( "Default_HVACDist_PriorToType", 1 )  }

   ; SAC 8/25/13 - added default for HVACDist:Type
   ; SAC 5/22/14 - added logic to default to attic only if attic area above cond zone(s) >= 10% of CFA and in crawl space (also if >= 10% CFA)
   ; SAC 4/15/15 - adjust for MFam duplex/townhomes options (based on Proj:IsMFamDupOrTownhm)
   ; LDH 8/03/16 - updated priority for single-family and/or Duplex/Townhome - Attic, Crawl, Conditioned Space (tic 689)
   ; SAC 6/1/17 - added logic to prevent Type default of 1 (attic) if attic too small for default ducts (tic #621)
   ; revised logic to reference Proj:AtticAreaOKForDucts & CrawlAreaOKForDucts - SAC 08/13/20 (tic #1062)
   "Set HVACDist:Type"		HVACDist:Type	 	= {	
    if ( ( Proj:IsMultiFamily == 0 .OR. Proj:IsMFamDupOrTownhm > 0.5 ) .AND. 
         IfValidAnd( Proj:CondFloorArea > 1 ) )
    then  if( ComponentCount( Attic ) > 0.5 .AND. SumAll( Attic:ClVentableArea ) > 0 .AND.
              IfValidAnd( Proj:AtticAreaOKForDucts > 0 ) .AND.
              IfValidAnd( DuctsTooLrgForAttic = 0 ) )
          then 1    ; "Ducts located in Attic (Ventilated and Unventilated)"
          else if (IfValidAnd( Proj:CrawlAreaOKForDucts > 0 ))
          then 2    ; "Ducts located in a crawl space"
          else 7    ; "Ducts located entirely in conditioned space"
          endif endif
    else  		7    ; MFAM or Townhouse: "Ducts located entirely in conditioned space"
    endif }

	"Set HVACDist:DuctsCreatedForAnalysis"		HVACDist:DuctsCreatedForAnalysis		= {	1  }	; SAC 7/12/14

; mjb 12/2/15 - need no duct losses in Design Rating model for RESNET harmonization
	"Reset HVACDist:Type"		HVACDist:Type	 	= {	if (Proj:DRtgRefRunID == 2014) then  12
	                                                   else UNCHANGED endif }
	
;	"debug"		HVACDist:Action	= {	PostMessageToLog( "inside Default_HVACDist_ForceTypeDefault - HVACDist '%s':  Type = '%s' (%g) (status %d)  Attic:FloorArea = %g  Attic:FloorAreaOverCond = %g  Proj:CondFloorArea = %g",
;																		Name, EnumString( Type ), Type, LocalStatus( Type ), SumAll( Attic:FloorArea ), SumAll( Attic:FloorAreaOverCond ), Proj:CondFloorArea )  }

;  mjb   10/28/14 - mods for existing HVAC in Additions Alone or E+A+A
; SAC 12/22/14 - removed logic preventing 'Default_HVACDist_OtherThanType' from being called for Existing HVACSys objects, since this HVACDist JUST CREATED for analysis and therefore requires defaulting... (GC issue 451)
	"Default remaining HVACDist properties"	HVACDist:Action	= {	; if ((Proj:IsAddAlone > 0.5 .AND. MinRevRef( HVACSys:DistribSystem, HVACSys:Status ) < 2) .OR. (Proj:RunScope == 2 .AND. MinRevRef( HVACSys:DistribSystem, HVACSys:Status ) < 2)) then UNCHANGED else EvalRulelist( "Default_HVACDist_OtherThanType", 1 ) endif }
																							EvalRulelist( "Default_HVACDist_OtherThanType", 1 )  }
END

; SAC 6/1/17 - broke up ...OtherThanType HVACDist defaulting into rules to be evaluated PRIOR to Type (enabling determination of Attic size prior to defaulting Type)
;*************************************************************************
RULELIST "Default_HVACDist_PriorToType" 0 0 0 0
;*************************************************************************
	"Set HVACDist:FloorAreaServed"	HVACDist:FloorAreaServed   	=              ; revised following rule to base *AreaServed on DwellUnitType data (iff MFam model AND no HVACSys assigned to Zones (yet)) - SAC 04/08/21
      {  if (Proj:IsMultiFamily .AND. SumAll( HVACSys:FloorAreaServed[1] ) < 1)
         then  SumRevRef( DwellUnitType:HVACDistRef, DwellUnitType:DUFloorAreaServed )
         else  SumRevRef( HVACSys:DistribSystem, HVACSys:FloorAreaServed )  endif  }
;	mjb	4/17/14	need to keep track of existing floor area served to weight-average duct Rvalue for new HVACDist Status = 4 (Existing + New)
	"Set HVACDist:exFloorAreaServed"	HVACDist:exFloorAreaServed   	= {  SumRevRef( HVACSys:DistribSystem, HVACSys:exFloorAreaSrvd )  }
;	"debug"		HVACDist:Action	= {	MessageBox( "Default -- HVACDist '%s':  FloorAreaServed = %g  exFloorAreaServed = %g", Name, FloorAreaServed, exFloorAreaServed )  }
	"Set HVACDist:NumStoriesServed"	HVACDist:NumStoriesServed		= {  SumRevRef( HVACSys:DistribSystem, HVACSys:NumStoriesServed )  }

   ; default duct insulation R-values (for calculating default duct exterior surface areas) (tic #621) - SAC 6/1/17
   "Set HVACDist:DfltSupDuctInsRval - Default R value of supply duct insulation (for calc of duct areas)"  ; SAC 6/1/17 - tic #621 
      HVACDist:DfltSupDuctInsRval  = {
         if (IfValidAnd( DuctsPresent > 0 ) .AND. IfValidAnd( DefaultSystem = 0 ) .AND.
             IfValidAnd( DuctDesign   > 0 ) .AND. IfValidAnd( DuctDesignInsRvalue > 0 ))
         then  DuctDesignInsRvalue
         else if (Proj:RunScope == 2 .AND. Status == 2)
         then  T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", ValidOr( Proj:ClimateZone, 7 ), "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
         else  T24RClimateZoneCodeBase:DuctRval(    "ClimateZone", ValidOr( Proj:ClimateZone, 7 ), "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
         endif endif  }
   "Adjust high HVACDist:DfltSupDuctInsRval"    HVACDist:DfltSupDuctInsRval  = {
         if (IfValidAnd( DfltSupDuctInsRval <= 4.2 )) then  UNCHANGED
         else	(100 / (85 / (DfltSupDuctInsRval + 0.7) + 3.061)) - 0.7
         endif  }

   "Adjust HVACDist:DfltRetDuctInsRval - Default R value of return duct insulation (for calc of duct areas)"  ; SAC 6/1/17 - tic #621 
      HVACDist:DfltRetDuctInsRval  = {
         if (IfValidAnd( DuctsPresent > 0 ) .AND. IfValidAnd( DefaultSystem = 0 ) .AND.
             IfValidAnd( DuctDesign   > 0 ) .AND. IfValidAnd( RetDuctDesignInsRvalue > 0 ))
         then  RetDuctDesignInsRvalue
         else if (Proj:RunScope == 2 .AND. Status == 2)
         then  T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", ValidOr( Proj:ClimateZone, 7 ), "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
         else  T24RClimateZoneCodeBase:DuctRval(    "ClimateZone", ValidOr( Proj:ClimateZone, 7 ), "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
         endif endif  }
   "Adjust high HVACDist:DfltRetDuctInsRval"    HVACDist:DfltRetDuctInsRval  = {
         if (IfValidAnd( DuctDesign > 0.5 ) .OR. (Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified) .OR.
             (Proj:RunScope == 2 .AND. Status == 1) )
         then  if (IfValidAnd( DfltRetDuctInsRval <= 4.2 )) then  UNCHANGED
               else	(100 / (85 / (DfltRetDuctInsRval + 0.7) + 3.061)) - 0.7
               endif
         else DfltRetDuctInsRval	endif  }

   ; default duct areas assuming ducts located in attic - used to ensure attic contains sufficient area for locating ducts
   "Set HVACDist:DefaultSupDuctArea"      HVACDist:DefaultSupDuctArea  = {
         if (IfValidAnd( NumStoriesServed > 1.5))
         then  0.65 * 0.27 * ValidOr( FloorAreaServed, 0 )
         else         0.27 * ValidOr( FloorAreaServed, 0 )
         endif  }
   "Set HVACDist:DefaultRetDuctArea"      HVACDist:DefaultRetDuctArea  = {
         if (IfValidAnd( NumStoriesServed > 1.5))
         then  0.10 * ValidOr( FloorAreaServed, 0 )
         else  0.05 * ValidOr( FloorAreaServed, 0 )
         endif  }

   "Default HVACDist:SupplyDuctDiam"		HVACDist:SupplyDuctDiam	= {	 8  }
   "Default HVACDist:ReturnDuctDiam"		HVACDist:ReturnDuctDiam	= {	16  }

   ; rules to set supply & return duct surface areas (and max areas) to ensure they fit in the selected attic (if attic located) (tic #621) - SAC 6/1/17
   "Set HVACDist:SupDuctSurfaceArea - Surface area of DEFAULT supply ducts (used in check for ducts too large for attic)"  ; SAC 6/1/17 - tic #621 
      HVACDist:SupDuctSurfaceArea  = {
         if (SupplyDuctDiam <= 0 .OR. IfValidAnd( DfltSupDuctInsRval > 0 )==0)
         then  DefaultSupDuctArea
         else  DefaultSupDuctArea * ( (SupplyDuctDiam/12) + (2 * DfltSupDuctInsRval / (ValidOr( Proj:DuctInsRValPerInch, 3 ) * 12) ) ) / (SupplyDuctDiam/12)
         endif  }
   "Set HVACDist:RetDuctSurfaceArea - Surface area of DEFAULT return ducts (used in check for ducts too large for attic)"  ; SAC 6/1/17 - tic #621
      HVACDist:RetDuctSurfaceArea  = {
         if (ReturnDuctDiam <= 0 .OR. IfValidAnd( DfltRetDuctInsRval > 0 )==0)
         then  DefaultRetDuctArea
         else  DefaultRetDuctArea * ( (ReturnDuctDiam/12) + (2 * DfltRetDuctInsRval / (ValidOr( Proj:DuctInsRValPerInch, 3 ) * 12) ) ) / (ReturnDuctDiam/12)
         endif  }

   "Set HVACDist:DuctsTooLrgForAttic - Flag indicating ducts too large for attic (0=they fit, 1=Supply too large, 2=Return too large, 3=No default Attic)"  ; SAC 6/1/17 - tic #621
      HVACDist:DuctsTooLrgForAttic  = {
         if (IfValidAnd( Proj:MaxDuctFracArea > 0 )==0 .OR. SupplyDuctDiam <= 0 .OR. 
             GlobalCompAssigned( Proj:DefaultDuctAtticRef ) < 1)
         then  3
         else if ( SupDuctSurfaceArea /
                   ( ValidOr( Proj:DefaultDuctAtticRef:DeckArea, 0 ) +
                     ValidOr( Proj:DefaultDuctAtticRef:TrussArea, 0 ) +
                     SupDuctSurfaceArea + RetDuctSurfaceArea ) > Proj:MaxDuctFracArea)
         then  1
         else if ( RetDuctSurfaceArea /
                   ( ValidOr( Proj:DefaultDuctAtticRef:DeckArea, 0 ) +
                     ValidOr( Proj:DefaultDuctAtticRef:TrussArea, 0 ) +
                     SupDuctSurfaceArea + RetDuctSurfaceArea ) > Proj:MaxDuctFracArea)
         then  2
         else  0  endif endif endif  }
;"dbg" HVACDist:Action = { PostMessageToLog( "   just set HVACDist:DuctsTooLrgForAttic to %g for model '%s', HVACDist '%s' - SupDuctSurfaceArea %g / DefaultDuctAtticRef:DeckArea %g / DefaultDuctAtticRef:TrussArea %g / SupDuctSurfaceArea %g / RetDuctSurfaceArea %g / Proj:MaxDuctFracArea %g", 
;                                                   DuctsTooLrgForAttic, Proj:RunAbbrev, Name, SupDuctSurfaceArea, ValidOr( Proj:DefaultDuctAtticRef:DeckArea, 0 ),
;                                                   ValidOr( Proj:DefaultDuctAtticRef:TrussArea, 0 ), SupDuctSurfaceArea, RetDuctSurfaceArea, Proj:MaxDuctFracArea ) }
END

;*************************************************************************
RULELIST "Default_HVACDist_OtherThanType" 0 0 0 0
;*************************************************************************
	"Set HVACDist:TypeAbbrev"			HVACDist:TypeAbbrev	 	= {  Local( Type )  }
	"Set HVACDist:TypeAbbrevStr"		HVACDist:TypeAbbrevStr	= {  EnumString( TypeAbbrev )  }
	"Set HVACDist:IsAvailable"			HVACDist:IsAvailable 	= {  1  }		; until flags setup to disable unimplemented distribution types...

; HVACDist:Status,       	     		Default,   0,    1,   1,    1,  1,  1
	"Set HVACDist:ShowStatus"			HVACDist:ShowStatus		= {	if (Proj:RunScope == 2 .OR. (Proj:RunScope == 1 .AND. Proj:IsAddAlone > 0.5)) then  1  else  0  endif  }		; SAC 4/10/15

; mjb - removed case options for HVACDist:Type(s) no longer suported 8/20/13
	"Set HVACDist:DuctsPresent"		HVACDist:DuctsPresent = {	switch (Local( Type ))
																					case  0 :  0   ; "- select distribution system type -"
																					case  7 :  0   ; "Ducts located entirely in conditioned space"  - SAC 4/7/13 - added to prevent duct modeling for DuctsInAll (GC Issue #50)
																					case  8 :  0   ; "Distribution systems without ducts"
																	;				case 10 :  0   ; "Ductless-Furnaces - Heating equipment such as wall and floor furnaces"
																	;				case 11 :  0   ; "Ductless-Radiant - Radiant electric panels or fanless systems"
																					case 12 :  0   ; "Verified low-leakage ducts entirely in conditioned space"
																	;				case 14 :  0   ; "Baseboard - Electric or hydronic baseboards"
																					default :  1   ; all other system types
																				endswitch  }
	"Set HVACDist:DuctsMayReqReport - flag value for tracking whether ducts may require compliance reporting" 		; SAC 4/28/15 - in part for issue 504
									HVACDist:DuctsMayReqReport	= {	switch (Type)
																					case  0 :  0   ; "- select distribution system type -"
																	;				case  7 :  0   ; "DuctsInAll - HVAC system(s) with all HVAC ducts located in conditioned space"  - SAC 4/7/13 - added to prevent duct modeling for DuctsInAll (GC Issue #50)
																					case  8 :  0   ; "DuctsNone - Air distribution systems without ducts"
																	;				case 10 :  0   ; "Ductless-Furnaces - Heating equipment such as wall and floor furnaces"
																	;				case 11 :  0   ; "Ductless-Radiant - Radiant electric panels or fanless systems"
																	;				case 12 :  0   ; "LowLlCod - Verified low-leakage ducts in conditioned space"
																	;				case 14 :  0   ; "Baseboard - Electric or hydronic baseboards"
																					default :  1   ; all other system types
																				endswitch  }

  ; SAC 12/30/15 - added to force HVACDist defaulting when assigned to heat-only systems (tic 544)
  ; LDH  8/23/16 - removed rule to allow user input HeatingOnly HVACDist properties to reamin in proposed model (tic 689)
;	"Reset HVACDist:DefaultSystem if serves heat-only system(s)"	HVACDist:Action	= {
;				if (LocalStatus( DefaultSystem ) < 5 .OR. IfValidAnd( DefaultSystem > 0.5 )) then  UNCHANGED
;				else if (FloorAreaServed < 0.1 .OR. IfValidAnd( Proj:CondFloorArea > 1 ) == 0) then  UNCHANGED
;				else if (SumRevRef( HVACSys:DistribSystem, HVACSys:HaveHeating ) == SumRevRef( HVACSys:DistribSystem, HVACSys:HaveCooling )) then  UNCHANGED
;				else	EvalRulelist( "ForceDefault_HVACDist_DefaultSystem", 1 )  endif endif endif  }

;   "Default HVACDist:DefaultSystem"     HVACDist:DefaultSystem   = {  if (Status == 1) then 0 else 1 endif }
   "Default HVACDist:DefaultSystem"     HVACDist:DefaultSystem   = {  1  }

  ; SAC 1/28/13 - added check and rulelist call to ensure system defaults ARE in fact all defaulted if/when DefaultSystem selected
  ; SAC 7/15/14 - expanded HVACDist defaulting to be more consistent w/ hierarchical reset definitions (GC issue #327)
  ; SAC 12/27/14 - added logic to PRESERVE ALL data when defaulting Std design model for altered/verified system
  ; SAC 10/27/15 - added check for design rating run abbreviation (Proj:RunAbbrev == "dr")
	"Ensure HVACDist:DefaultSystem valid"		HVACDist:Action	= {
						if (IfValidAnd( Proj:EnergyCodeYearNum = 0 )) then  UNCHANGED   ; SAC 3/13/17 - do nothing for ExEDR
						else if ((Proj:RunAbbrev == "s" .OR. Proj:RunAbbrev == "S" .OR. Proj:RunAbbrev == "smf" .OR. Proj:RunAbbrev == "dr") .AND.
						         Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND. IfValidAnd( DuctsVsStandard >= 0 )) then  UNCHANGED
						else if (ValidOr( DefaultSystem, 1 ) > 0.5) then	EvalRulelist( "ForceDefaults_HVACDist", 1 )
						else if (ValidOr( LowLkgAH, 0 ) < 0.5) then			EvalRulelist( "ForceDefaults_HVACDist_LowLkgAH", 1 )
						else if (IfValidAnd( DuctLeakage > 0 )) then			EvalRulelist( "ForceDefaults_HVACDist_DuctLeakage", 1 )
						else  UNCHANGED  endif endif endif endif endif  }
				;		then	if (	LocalStatus( DuctLeakage    ) > 4  .OR.  LocalStatus( DuctLeakageVal   ) > 4  .OR.  LocalStatus( DuctInsRvalOpt ) > 4  .OR.
				;						LocalStatus( DuctInsRvalue  ) > 4  .OR.  LocalStatus( SupplyDuctArea   ) > 4  .OR.  LocalStatus( ReturnDuctArea ) > 4  .OR.
				;						LocalStatus( SupplyDuctDiam ) > 4  .OR.  LocalStatus( ReturnDuctDiam   ) > 4  .OR.  LocalStatus( SupplyDuctLoc  ) > 4  .OR.
				;						LocalStatus( ReturnDuctLoc  ) > 4  .OR.  LocalStatus( RetDuctInsRvalue ) > 4  .OR.  LocalStatus( DuctDesign     ) > 4  .OR.  LocalStatus( LowLkgAH ) > 4 )
				;				then	EvalRulelist( "ForceDefaults_HVACDist", 1 )
				;				else	UNCHANGED  endif
				;		else	UNCHANGED  endif  }
	"Ensure valid HVACDist:DuctDesign defaulting"		HVACDist:Action	= {
	               if (DefaultSystem < 0.5 .AND. ValidOr( DuctDesign, 0 ) < 0.5) then	EvalRulelist( "ForceDefaults_HVACDist_DuctDesign", 1 )
						else  UNCHANGED  endif  }

	"Default HVACDist:LowLkgAH"				HVACDist:LowLkgAH				= {	0  }		; mjb 10/02/13 - need to ensure Low Leakage Air Handler is properly defaulted to zero

	"Default HVACDist:DuctLeakage"			HVACDist:DuctLeakage			= {	if (IfValidAnd( Proj:EnergyCodeYearNum = 0 )) then  0   ; SAC 3/13/17 - ExEDR
	                                                                        else if ( FloorAreaServed  > 0 .AND. (Status == 1 .OR. (Status == 4 .AND. IfValidAnd(IsLessThanFortyFt > 0.5))) )
																									then  900		; "Existing (not specified)"		; mjb	8/1/14	- added for E+A+A reporting
																									else  800		; "Sealed and tested"
																									endif endif  }
; mjb 1/29/15 - mods to lookup Std Duct Leakage from T24RClimateZoneCodeBase table
; mjb 1/29/15 - I think DuctLeakageVal default actually only used for LowLkgAH default, which is why it is set to 6 not 8
;	"Default HVACDist:DuctLeakageVal"		HVACDist:DuctLeakageVal 	= {	6  }	
	"Default HVACDist:DuctLeakageVal"		HVACDist:DuctLeakageVal 	= {	T24RClimateZoneCodeBase:DuctLkg( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) - 2  }	

   ; SAC 10/30/19 - ensure buried duct inputs that were previously user inputs are defaulted for 2019+ code vintages (tic #1128)
   "Redefault AreBuried & AreDeeplyBuried flags if user-defined in 2019+ code vintages"   HVACDist:Action  =
      {  if (Proj:StdDesignBase < 2019 .OR. (LocalStatus( AreBuried ) < 6 .AND. LocalStatus( AreDeeplyBuried ) < 6)) then  UNCHANGED
         else  EvalRulelist( "Blast_HVACDist_AreBuriedFlags", 1 )  endif  }

;	mjb	4/24/14	added defaulting for buried ducts
	"Default HVACDist:DuctDesign"				HVACDist:DuctDesign			= {	0  }		
	"Default HVACDist:AreBuried"				HVACDist:AreBuried			= {	0  }		
	"Default HVACDist:AreDeeplyBuried"		HVACDist:AreDeeplyBuried	= {	0  }		
	"Default HVACDist:IsLessThanFortyFt"	HVACDist:IsLessThanFortyFt	= {	0  }  ; SAC 6/15/18 - restore rule to default IsLessThanFortyFt so that it is VALID in future value checks (tic #981)

;    HVACDist:DuctLeakage

  ; SAC 10/8/13 - mod to ensure that proper DuctLeakageVal defined when DuctLeakage set to something OTHER THAN '- specify -'  (GC issue #167)
   "Ensure HVACDist:DuctLeakageVal reset when DuctLeakage != '- specify -'"	HVACDist:Action	= {
						if (DefaultSystem < 0.5 .AND. DuctLeakage > 0 .AND. LocalStatus( DuctLeakageVal ) > 4)
						then  EvalRulelist( "ForceDefaults_HVACDist_DuctLeakage", 1 )  else  UNCHANGED  endif  }

;	mjb-10/9/13 ALWAYS default DuctLeakageVal to 8.0
; mjb-10/21/13 	EXCEPT when there is a LowLkgAH - then default to 6.0
;	mjb 5/6/14	except when ducts are existing
; SAC 12/26/14 - additional logic to handle altered/verified duct leakage
; mjb 1/29/15 - mods to lookup Std Duct Leakage from T24RClimateZoneCodeBase table
;	"Default HVACDist:DuctLeakageValUse"			HVACDist:DuctLeakageValUse	= {	if (Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND. LocalStatus( exDuctLeakageValUse ) > 0)
;																											then	exDuctLeakageValUse
;																											else if ( Proj:RunScope == 2 .AND. Status == 1 ) then 15 
;																											else if (LowLkgAH < 0.5 ) then 8.0 else DuctLeakageVal  endif endif endif	}
;	"Set HVACDist:DuctLeakageValRpt"					HVACDist:DuctLeakageValRpt	= { 	if ( Proj:RunScope == 2 .AND. Status == 1 ) then 15
;																								 			else if (LowLkgAH < 0.5 ) then 6.0 else DuctLeakageValUse endif endif	}
; SAC 5/22/17 - mods to ensure use of higher T24RClimateZoneCodeBase:exDuctLkg setting for Existing+New ducts where IsLessThanFortyFt = 0 (tic #822)
; SAC 5/7/18 - added logic to treat AA models the same as EAA re: duct leakage (tic #986)
	"Default HVACDist:DuctLeakageValUse"			HVACDist:DuctLeakageValUse	= {
         if ((Proj:RunScope == 2 .OR. Proj:IsAddAlone > 0.5) .AND.
             Status == 2 .AND. IsVerified .AND. LocalStatus( exDuctLeakageValUse ) > 0)
         then	exDuctLeakageValUse
         else if ( (Proj:RunScope == 2 .OR. Proj:IsAddAlone > 0.5) .AND.
                   ( (Status == 4 .AND. IfValidAnd( IsLessThanFortyFt = 0 )) .OR.
                      Status == 1 ) ) then T24RClimateZoneCodeBase:exDuctLkg( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) 
         else if (LowLkgAH > 0.5 .OR. (DuctLeakage < 1 .AND. IfValidAnd( Proj:EnergyCodeYearNum = 0 ))) then  DuctLeakageVal
         else  T24RClimateZoneCodeBase:DuctLkg( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif endif endif	}
; SAC 2/19/20 - revised reporting value for MFam models to adjust by -1 for MFam models (vs. -2 for SFam) (tic #1168)
	"Set HVACDist:DuctLeakageValRpt"					HVACDist:DuctLeakageValRpt	= {
         if ( (Proj:RunScope == 2 .OR. Proj:IsAddAlone > 0.5) .AND.
              ((Status == 4 .AND. IfValidAnd( IsLessThanFortyFt = 0 )) .OR.
                Status == 1) ) then T24RClimateZoneCodeBase:exDuctLkg( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
         else if (LowLkgAH > 0.5 .OR. (DuctLeakage < 1 .AND. IfValidAnd( Proj:EnergyCodeYearNum = 0 ))) then  DuctLeakageValUse
         else if (Proj:IsMultiFamily > 0.5)
         then  T24RClimateZoneCodeBase:DuctLkg( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )- 1
         else  T24RClimateZoneCodeBase:DuctLkg( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )- 2  endif endif endif	}
;	"debug DuctLeakageValRpt"					HVACDist:Action	= { 	if ( Status != 1 ) then UNCHANGED else
;																							MessageBox( "HVACDist: '%s'  DuctLeakageValRpt %g", Name, DuctLeakageValRpt )
;																						endif	}
;	"Default HVACDist:DuctLeakageVal"		HVACDist:DuctLeakageVal	= {	if (DuctLeakage > 10) then  DuctLeakage / 100
;																								else  UNDEFINED  endif  }

	"Default HVACDist:HasBypassDuct"			HVACDist:HasBypassDuct	= {	0  }		; SAC 5/20/13 - added per Bruce request

   ; SAC 5/7/18 - force reset of HVACDist:exDuctInsRvalOpt if not displayed (to fix problem where default in prior versions not set properly) (tic #986)
   "Force reset of HVACDist:exDuctInsRvalOpt if not currently an input"
      HVACDist:Action = {  if (LocalStatus( exDuctInsRvalOpt ) < 7) then  UNCHANGED    ; not user-defined
                           else if (Proj:RunScope = 2 .AND.
                                    ((Status = 2 .AND. IsVerified > 0) .OR.
                                      Status = 4 )) then  UNCHANGED  ; currently a valid input
                           else  EvalRulelist( "ForceDefault_HVACDist_exDuctInsRvalOpt", 1 )  endif endif  }

;   "Default HVACDist:DuctInsRvalue"     HVACDist:DuctInsRvalue   = {  if (Global( Proj:ClimateZone ) < 0.5) then  UNDEFINED
;																							 else  ClimateZoneTable( Global( Proj:ClimateZone ), 4 )  endif  }
; SAC 12/27/14 - added logic to prevent setting DuctInsRvalOpt in cases where we need to retain a valid (previous) DuctInsRvalue in order to set an altered/verified ins r-val below (setting this causes a reset of DuctInsRvalue which prevents the rule below from working as designed)
; mjb 1/12/15 - use new T24RClimateZoneCodeBaseTable for code level lookups
; SAC 11/9/15 - added call to new T24RClimateZoneCodeBase:AltDuctRval() for ALTERED analysis
; SAC 6/15/16 - added logic to set duct R-val to 0 when ducts are not present (no ducts or ducts in cond space) (tic #654)
; SAC 9/14/16 - expand (DuctsPresent < 0.5) logic to ensure proper 2016 default (mandatory requirement sec. 150.0(m)) of 4.2 (tic #749)
; SAC 9/30/16 - Similar mod to above (#749) but for 2013 - ensure un-modeled ducts report InsRVal of 6.0 (or 8 depending on CZ) to meet CalCerts requirement (tic #754)
;"dbg std dsgn HVACDist:DuctInsRvalOpt"  HVACDist:Action = {  if (IfValidAnd( Proj:RunAbbrev = "s" )==0) then  UNCHANGED
;      else  MessageBox( "setting HVACDist '%s' DuctInsRvalOpt (%g status %g):  HVACDist:Status %g,  IsVerified %g,  DuctInsRvalue %g,  exDuctInsRvalue %g", Name, DuctInsRvalOpt, LocalStatus( DuctInsRvalOpt ), Status, IsVerified, DuctInsRvalue, exDuctInsRvalue )  endif  }
   "Default HVACDist:DuctInsRvalOpt"		HVACDist:DuctInsRvalOpt	= {
         if (Global( Proj:ClimateZone ) < 0.5) then  UNDEFINED
         else if (Status == 1) then UNCHANGED
         else if (IfValidAnd( DuctInsRvalue > 0 ) .AND. Proj:RunScope == 2 .AND. Status == 2 .AND.
                  IsVerified .AND. IfValidAnd( exDuctInsRvalue > 0 )) then  UNCHANGED
;			else  ClimateZoneTable( Global( Proj:ClimateZone ), 4 ) * 100  endif endif endif }
			else if (DuctsPresent < 0.5)
			then  if (Proj:StdDesignBase >= 2016 .AND. 
			            ( Type ==  7 .OR.   ; "Ducts located entirely in conditioned space"
			              Type == 12 ))     ; "Verified low-leakage ducts entirely in conditioned space"
			      then  420      ; ensures proper reporting w/out effecting analysis
			      else if (Proj:StdDesignBase < 2016 .AND. 
   			            ( Type ==  7 .OR.   ; "Ducts located entirely in conditioned space"
	   		              Type == 12 ))     ; "Verified low-leakage ducts entirely in conditioned space"
      		 	then  T24RClimateZoneCodeBase:DuctRval( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) * 100
			      else  0
			      endif endif
			else if (Proj:RunScope == 2 .AND. Status == 2)
			then  T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) * 100 
			else  T24RClimateZoneCodeBase:DuctRval(    "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) * 100  endif endif endif endif endif }
   "Default HVACDist:DuctDesignInsRvalue"			HVACDist:DuctDesignInsRvalue	= {	if (Global( Proj:ClimateZone ) < 0.5) then  UNDEFINED
;																							 					else  ClimateZoneTable( Global( Proj:ClimateZone ), 4 )  endif  }
																												else if (Proj:RunScope == 2 .AND. Status == 2)
																											 	then  T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
																							 					else  T24RClimateZoneCodeBase:DuctRval(    "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif endif  }
   "Default HVACDist:RetDuctDesignInsRvalue"		HVACDist:RetDuctDesignInsRvalue	= {	if (Global( Proj:ClimateZone ) < 0.5) then  UNDEFINED
;																							 						else  ClimateZoneTable( Global( Proj:ClimateZone ), 4 )  endif  }
																													else if (Proj:RunScope == 2 .AND. Status == 2)
																												 	then  T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
																							 						else  T24RClimateZoneCodeBase:DuctRval(    "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif endif  }
; mjb 5/6/14 - added outer-most if/then logic to properly account for Designed Ducts
; mjb 7/10/14 - only execute this rule for Ducts used in Project (FloorAreaServed > 0)
; mjb 10/28/14 - mods to work wtih existing Ducts in Additions Alone

;   "Default HVACDist:Status for Additions Alone with existing HVCSys"
;                                          Zone:HVACSystem:DistribSystem:Status   =  {  if ( Proj:IsAddAlone > 0.5 .AND. HVACSysStatus == 1 ) then 1 else UNCHANGED endif   }
   "Default exDuctInsRvalue for Additions Alone with existing Ducts"
                                          HVACDist:exDuctInsRvalue   =  {  if ( Proj:IsAddAlone > 0.5 .AND. Status == 1 ) then DuctInsRvalOpt/100 else UNCHANGED endif   }

; mjb 1/12/15 - use new T24RClimateZoneCodeBaseTable for code level lookups
; SAC 11/9/15 - switched T24RClimateZoneCodeBase:DuctRval() to ...:AltDuctRval() (ALTERED analysis)
; SAC 5/7/18 - added reference to new ExistDuctsInVerifSys property to prevent reset of DuctInsRvalue for Existing Ducts assigned to Altered & Verified HVACSystems (tic #986)
	"Default HVACDist:DuctInsRvalue"			HVACDist:DuctInsRvalue	= {
         if (IfValidAnd( DuctDesign < 0.5 ) ) then
				if ( Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND. LocalStatus( exDuctInsRvalue ) > 0 ) then
					if (IfValidAnd( ExistDuctsInVerifSys > 0 )) then  exDuctInsRvalue
					else if ( IfValidAnd( DuctInsRvalue >= T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ) ) then exDuctInsRvalue 
					else T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) endif endif
				else if ( (Proj:RunScope == 2 .OR. Proj:IsAddAlone > 0.5) .AND. Status == 1 .AND. LocalStatus( exDuctInsRvalue ) > 0 ) then exDuctInsRvalue
				else if ( (Proj:RunScope == 2 .OR. Proj:IsAddAlone > 0.5) .AND. Status == 4 .AND. LocalStatus( exDuctInsRvalue ) > 0 .AND. FloorAreaServed > 0 ) then
					((DuctInsRvalOpt/100 * (FloorAreaServed - exFloorAreaServed)) + (exDuctInsRvalue * exFloorAreaServed))/FloorAreaServed
				else if ( IfValidAnd( DuctInsRvalOpt > -.1 ) ) then  DuctInsRvalOpt / 100	else  UNDEFINED  endif endif endif endif
			else
				if ( Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND. LocalStatus( exDuctInsRvalue ) > 0 ) then
					if (IfValidAnd( ExistDuctsInVerifSys > 0 )) then  exDuctInsRvalue
					else if ( IfValidAnd( DuctDesignInsRvalue >= T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ) ) then exDuctInsRvalue 
					else T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) endif endif
				else if ( (Proj:RunScope == 2 .OR. Proj:IsAddAlone > 0.5) .AND. Status == 1 .AND. LocalStatus( exDuctInsRvalue ) > 0 ) then exDuctInsRvalue
				else if ( (Proj:RunScope == 2 .OR. Proj:IsAddAlone > 0.5) .AND. Status == 4 .AND. LocalStatus( exDuctInsRvalue ) > 0 .AND. LocalStatus( DuctDesignInsRvalue ) > 0 .AND. FloorAreaServed > 0 ) then
					((DuctDesignInsRvalue * (FloorAreaServed - exFloorAreaServed)) + (exDuctInsRvalue * exFloorAreaServed))/FloorAreaServed
				else if ( IfValidAnd( DuctDesignInsRvalue > -.1 ) ) then  DuctDesignInsRvalue	else  UNDEFINED  endif endif endif endif
			endif	}
;	mjb 1/12/15																					if ( IfValidAnd( DuctInsRvalue >= ClimateZoneTable( Global( Proj:ClimateZone ), 4 ) ) ) then exDuctInsRvalue 
;	replaced these lines with new table in above rule								else ClimateZoneTable( Global( Proj:ClimateZone ), 4 ) endif
;	would not compile with these lines commented out								if ( IfValidAnd( DuctDesignInsRvalue >= ClimateZoneTable( Global( Proj:ClimateZone ), 4 ) ) ) then exDuctInsRvalue 
;																									else ClimateZoneTable( Global( Proj:ClimateZone ), 4 ) endif
																								
;	"Check for buried ducts"					HVACDist:DuctInsRvalue	= {	if ( AreBuried .AND. AreDeeplyBuried ) then
;																									((BuriedDuctRvalue * BuriedDuctLength) + (DeepBuriedDuctRvalue * DeepBuriedDuctLength))/(BuriedDuctLength + DeepBuriedDuctLength)
;																								else if ( AreBuried ) then
;																									BuriedDuctRvalue
;																								else if ( AreDeeplyBuried ) then
;																									DeepBuriedDuctRvalue
;																								else UNCHANGED endif	endif endif	}

;	mjb	4/17/14	on above rule, added E+A+A logic to floor-area weight average Duct R-value when Ducts have Status = 4 (Existing + New)
;	"debug Adjust DuctInsRvalue"				HVACDist:Action	= { if ( Status != 4 ) then UNCHANGED else
;																						MessageBox( "Adjusted DuctInsRvalue in Default '%s' %g", Name, DuctInsRvalue )
;																					endif	}
; mjb	3/13/14	-.1 above used to be 50, but this won't work for zero insulation																								
;	"debug"		HVACDist:Action	= {	if (FloorAreaServed > 0) then MessageBox( "Default -- HVACDist '%s':  Proj:RunScope = %g,  Status = %g,  IsVerified = %g,  DuctInsRvalue = %g  exDuctInsRvalue = %g", Name, Proj:RunScope, Status, IsVerified,	DuctInsRvalue, exDuctInsRvalue ) else UNCHANGED endif }
;	"debug"		HVACDist:Action	= {	if (exFloorAreaServed > 0) then MessageBox( "Default -- HVACDist '%s':  Proj:RunScope = %g,  Status = %g,  DuctInsRvalue = %g  DuctInsRvalOpt = %g exDuctInsRvalOpt = %g", Name, Proj:RunScope, Status, DuctInsRvalue, DuctInsRvalOpt, exDuctInsRvalOpt ) else UNCHANGED endif  }

; 	mjb 4/28/14 replaced the following with equation for DuctInsAdjRval for ALL values of DuctInsRvalue						
;	"Set HVACDist:DuctInsAdjRval"				HVACDist:DuctInsAdjRval	= {	if (DuctInsRvalue == 4.2) then  4.2
;																									else if (DuctInsRvalue == 6  ) then  5.65
;																									else if (DuctInsRvalue == 8  ) then  7.09
;																								else  DuctInsRvalue  endif endif endif		}		; should throw error if no specific conversion to DuctInsAdjRval found
;	mjb	4/28/14	=(100/(85/(DuctInsRvalue+0.7)+3.061))-0.7  from Bruce's duct R-value correction spreadsheet (considers 15% of ductwork only able to have min insulation of R=4.2)
; SAC 10/24/14 - added if statement to prevent duct ins Rval adjustment if the user input is <= R4.2
; SAC 4/12/19 - added new InsAdjRval logic for 2019 rules - R-6 mandatory min duct R & new formula (from CB) taking into account this plus fraction of existing ducts (tic #874)					
	"Set HVACDist:DuctInsAdjRval"				HVACDist:DuctInsAdjRval	= {
	      if (Proj:EnergyCodeYearNum < 2019)
	      then  if (IfValidAnd( DuctInsRvalue <= 4.2 )) then  DuctInsRvalue
					else	(100 / (85 / (DuctInsRvalue + 0.7) + 3.061)) - 0.7
					endif
         else  if ( IfValidAnd( DuctInsRvalue <= 4.2 ) .OR.
                   (IfValidAnd( DuctInsRvalue <= 6.0 ) .AND. IfValidAnd( SupplyDuctFracEx > 0)==0)) then  DuctInsRvalue
					else	(100 / (85/(DuctInsRvalue + 0.7) + ValidOr(SupplyDuctFracEx, 0) * 15/(4.2 + 0.7) + (1 - ValidOr(SupplyDuctFracEx, 0))*15/(6 + 0.7))) - 0.7
					endif
			endif  }

;	mjb - duplicate rules to default new return duct insulation	8/22/13
;	"Default HVACDist:RetDuctInsRvalue"			HVACDist:RetDuctInsRvalue	= {	if (DuctDesign > 0.5) then UNCHANGED else DuctInsRvalue endif	}
; SAC 8/29/13 - revised to ensure valid default whenever (GC issue 151)
; mjb 5/6/14 - added outer-most if/then logic to properly account for Designed Ducts
; mjb 7/10/14 - only execute this rule for Ducts used in Project (FloorAreaServed > 0)
; mjb 1/12/15 - use new T24RClimateZoneCodeBaseTable for code level lookups
; SAC 11/9/15 - switched T24RClimateZoneCodeBase:DuctRval() to ...:AltDuctRval() (ALTERED analysis)
; SAC 5/7/18 - added reference to new ExistDuctsInVerifSys property to prevent reset of DuctInsRvalue for Existing Ducts assigned to Altered & Verified HVACSystems (tic #986)
	"Default HVACDist:RetDuctInsRvalue"			HVACDist:RetDuctInsRvalue	= {
         if (IfValidAnd( DuctDesign < 0.5 ) ) then
				if ( Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND. LocalStatus( exRetDuctInsRvalue ) > 0 ) then
					if (IfValidAnd( ExistDuctsInVerifSys > 0 )) then  exRetDuctInsRvalue
					else if ( IfValidAnd( RetDuctInsRvalue >= T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ) ) then exRetDuctInsRvalue 
					else T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) endif endif
				else if ( Proj:RunScope == 2 .AND. Status == 1 .AND. LocalStatus( exRetDuctInsRvalue ) > 0) then exRetDuctInsRvalue 
				else if ( Proj:RunScope == 2 .AND. Status == 4 .AND. LocalStatus( exDuctInsRvalue ) > 0 .AND. FloorAreaServed > 0 ) then
					((DuctInsRvalOpt/100 * (FloorAreaServed - exFloorAreaServed)) + (exDuctInsRvalue * exFloorAreaServed))/FloorAreaServed
				else if ( IfValidAnd( DuctInsRvalOpt > -.1 ) ) then  DuctInsRvalOpt / 100	else  UNDEFINED  endif endif endif endif
			else
				if ( Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND. LocalStatus( exRetDuctInsRvalue ) > 0 ) then
					if (IfValidAnd( ExistDuctsInVerifSys > 0 )) then  exRetDuctInsRvalue
					else if ( IfValidAnd( RetDuctDesignInsRvalue >= T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ) ) then exRetDuctInsRvalue 
					else T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) endif endif
				else if ( Proj:RunScope == 2 .AND. Status == 1 .AND. LocalStatus( exRetDuctInsRvalue ) > 0) then exRetDuctInsRvalue 
				else if ( Proj:RunScope == 2 .AND. Status == 4 .AND. LocalStatus( exDuctInsRvalue ) > 0 .AND. LocalStatus( RetDuctDesignInsRvalue ) > 0 .AND. FloorAreaServed > 0 ) then
					((RetDuctDesignInsRvalue * (FloorAreaServed - exFloorAreaServed)) + (exDuctInsRvalue * exFloorAreaServed))/FloorAreaServed
				else if ( IfValidAnd( RetDuctDesignInsRvalue > -.1 ) ) then  RetDuctDesignInsRvalue	else  UNDEFINED  endif endif endif endif
			endif	}
;	mjb 1/12/15  																						if ( IfValidAnd( RetDuctInsRvalue >= ClimateZoneTable( Global( Proj:ClimateZone ), 4 ) ) ) then exRetDuctInsRvalue 
;	replaced these lines with new table in above rule										else ClimateZoneTable( Global( Proj:ClimateZone ), 4 ) endif
;	would not compile with these lines commented out										if ( IfValidAnd( RetDuctDesignInsRvalue >= ClimateZoneTable( Global( Proj:ClimateZone ), 4 ) ) ) then exRetDuctInsRvalue 
;																											else ClimateZoneTable( Global( Proj:ClimateZone ), 4 ) endif

; SAC 12/12/13 - added logic to ensure that RetDuctInsAdjRval is set based on RetDuctInsRvalue in Altered & Verified E+A+A scenario
; 	mjb 4/28/14 replaced the following with equation for DuctInsAdjRval for ALL values of DuctInsRvalue	
; SAC 10/24/14 - added if statement to prevent duct ins Rval adjustment if the user input is <= R4.2					
;	"Set HVACDist:RetDuctInsAdjRval"				HVACDist:RetDuctInsAdjRval	= {	if (IfValidAnd(DuctDesign > 0.5) .OR. (Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified) .OR. (Proj:RunScope == 2 .AND. Status == 1) )
;																										then	if (IfValidAnd( RetDuctInsRvalue <= 4.2 )) then  RetDuctInsRvalue
;																												else	(100 / (85 / (RetDuctInsRvalue + 0.7) + 3.061)) - 0.7
;																												endif
;															  											else DuctInsAdjRval	endif  }   ; should throw error if no specific conversion to DuctInsAdjRval found
;;															  if (RetDuctInsRvalue == 4.2) then  4.2
;;																else if (RetDuctInsRvalue == 6  ) then  5.65
;;															   else if (RetDuctInsRvalue == 8  ) then  7.09
;;																else     RetDuctInsRvalue  endif endif endif 
; SAC 4/12/19 - added new InsAdjRval logic for 2019 rules - R-6 mandatory min duct R & new formula (from CB) taking into account this plus fraction of existing ducts (tic #874)					
	"Set HVACDist:RetDuctInsAdjRval"				HVACDist:RetDuctInsAdjRval	= {
         if (IfValidAnd(DuctDesign > 0.5) .OR. (Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified) .OR. (Proj:RunScope == 2 .AND. Status == 1) )
         then	if (Proj:EnergyCodeYearNum < 2019)
      	      then  if (IfValidAnd( RetDuctInsRvalue <= 4.2 )) then  RetDuctInsRvalue
                     else	(100 / (85 / (RetDuctInsRvalue + 0.7) + 3.061)) - 0.7
                     endif
               else  if ( IfValidAnd( RetDuctInsRvalue <= 4.2 ) .OR.
                         (IfValidAnd( RetDuctInsRvalue <= 6.0 ) .AND. IfValidAnd( ReturnDuctFracEx > 0)==0)) then  RetDuctInsRvalue
      					else	(100 / (85/(RetDuctInsRvalue + 0.7) + ValidOr(ReturnDuctFracEx, 0) * 15/(4.2 + 0.7) + (1 - ValidOr(ReturnDuctFracEx, 0))*15/(6 + 0.7))) - 0.7
		      			endif
               endif
         else DuctInsAdjRval	endif  }

; SAC 9/4/13 - added logic to not ever specify Attic for MFam ducts due to fire code restrictions (GC issue 164)
; SAC 4/15/15 - adjust for MFam duplex/townhomes options
; LDH 8/04/16 - updated HVACDist:Type and HVACDist:DuctLocation descriptions per current enums
	"Default HVACDist:DuctLocation"      HVACDist:DuctLocation    = {
		;	if (DuctsPresent < 0.5) then  0    - removed dependence on DuctsPresent, as leakage still needing to be modeled even when DuctsPresent = 0 (GC issue 162 - SAC 9/4/13)
		;	else	switch ( Type )
					switch ( Type )
						case  2 :  5  ; "Ducts located in a crawl space" -->> "Crawl Space"
				;		case  3 :  5  ; "DuctsCVC - Ducts located underfloor in a controlled ventilation crawl space"
						case  4 :  2  ; "Ducts located in a garage" -->> 
				;		case  5 :  4  ; "DuctsBasemt - Ducts located in an unconditioned basement"
						case  6 :     ; "Ducts located within the conditioned space (except < 12 lineal ft)" -->> "Outside" (MFAM) or "Attic"		; SAC 9/4/13 - was 3 - switched to 1 - related to GC issue 162 where duct leakage modeled TO attic zone
										if ((Proj:IsMultiFamily > 0.5 .AND. Proj:IsMFamDupOrTownhm < 0.5) .OR. MaxAll( Attic:FloorArea ) < 1) then  6  else  1  endif	  ; SAC 6/10/18 - apply same mod as below (check of attic area) to address tic #949
						case  7 :     ; "Ducts located entirely in conditioned space" -->>  "Outside" (MFAM or no Attic) or "Attic"		; SAC 9/4/13 - was 3 - switched to 1 - related to GC issue 162 where duct leakage modeled TO attic zone
										if ((Proj:IsMultiFamily > 0.5 .AND. Proj:IsMFamDupOrTownhm < 0.5) .OR. MaxAll( Attic:FloorArea ) < 1) then  6  else  1  endif	  ; SAC 10/7/13 - added check of attic area to if statement in attempt to fix comment #1 of GC issue #197
						case  8 :  3  ; "Distribution systems without ducts" -->> "Conditioned Zone"
						case  9 :  6  ; "Ducts located in outdoor locations" -->> "Outside"
						case  12 : 0  ; "Verified low-leakage ducts entirely in conditioned space" -->> "n/a"
						case  13 : 7  ; "Ducts located in multiple places"  -->>  "Multiple"
						default :  	  ; -else-  Attic  (iff allowed)
										1		; SAC 10/30/14 - removed logic to model attic ducts outside for MFam models - was:  if (Proj:IsMultiFamily > 0.5) then  6  else  1  endif
					endswitch  }
	"Default HVACDist:DuctLocation - round 2: Garage, Crawl, Uncond -> Attic if no garage/crawl"
			HVACDist:DuctLocation	= {		  if (DuctLocation == 2 .AND. (Proj:HasGarage < 0.5 .OR. MaxAll( Garage:Area ) < 1)) then  1
													else if (DuctLocation == 5 .AND.  MaxAll( CrawlSpace:Area      ) < 1 ) then  1
													else  UNCHANGED  endif endif  }
; SAC 7/17/14 - modified rule to relocate ducts from attic to conditioned space if insufficient attic area over conditioned space exists
	"Default HVACDist:DuctLocation - round 3: Attic -> Cond if no attic"
			HVACDist:DuctLocation	= {	if (DuctLocation == 1 .AND. (SumAll( Attic:FloorAreaOverCond ) / Proj:CondFloorArea) <= 0.0999) then  3
													else  UNCHANGED  endif  }

; SAC 10/30/14 - removed logic to prevent ducts in attic for MFam models
;;	mjb - added Round 4 for MF change in Default	8/22/13
;	"Default HVACDist:DuctLocation - round 4: Attic -> Cond if multi-family"
;			HVACDist:DuctLocation	= {	if (DuctLocation == 1 .AND. Proj:IsMultiFamily > 0.5) then  3
;													else  UNCHANGED  endif  }

   ; SAC 4/7/19 - added for UI mods associated w/ buried ducts work (tic #874)
   "Set HVACDist:LocationLabels[1]-Supply"   HVACDist:LocationLabels[1]  = {
         ; if (IfValidAnd( DuctDesign > 0 )) then  UNDEFINED
         if (Type > 12.5) then  "Supply Duct Location:"
         else if (Type = 1 .AND. IfValidAnd( DefaultSystem = 0 )) then  "Supply Duct Attic:"
         else  UNDEFINED  endif endif  }
   "Set HVACDist:LocationLabels[2]-Return"   HVACDist:LocationLabels[2]  = {
         ; if (IfValidAnd( DuctDesign > 0 )) then  UNDEFINED
         if (Type > 12.5) then  "Return Duct Location:"
         else if (Type = 1 .AND. IfValidAnd( DefaultSystem = 0 )) then  "Return Duct Attic:"
         else  UNDEFINED  endif endif  }

   ; SAC 5/6/15 - moved initial Attic defaulting from HVACDist:*DuctLoc rules into new :*DuctAttic rules, then reference those data in the :*DuctLoc defaults
   ; SAC 6/1/17 - replaced Attic selection logic w/ reference to new Proj:DefaultDuctAtticRef property (tic #621)
	"Default HVACDist:SupplyDuctAttic"	HVACDist:SupplyDuctAttic	= {
         if (DuctLocation != 1) then  UNDEFINED
         else  Proj:DefaultDuctAtticRef
         endif  }
	"Default HVACDist:ReturnDuctAttic"	HVACDist:ReturnDuctAttic	= {	SupplyDuctAttic  }

;"dbg" HVACDist:Action = { if (DuctLocation != 7) then UNCHANGED
;         else PostMessageToLog( "   locating '%s' ducts to multiple places:  DuctsTooLrgForAttic %g", Name, ValidOr( DuctsTooLrgForAttic, -1 ) ) endif }
   ;	mjb - modified case statement to match DuctLocation update 	8/22/13
   ; SAC 9/10/19 - added OtherZone logic (MFamProto)
   "Default HVACDist:SupplyDuctLoc"		HVACDist:SupplyDuctLoc =            ; added logic to prevent assignment to attic when DuctsTooLrgForAttic flag set - SAC 05/06/21
	   {  switch ( DuctLocation )
            case  1 :	SupplyDuctAttic                     ; "Attic"               
            case  2 :	MaxAllComp( Garage:Area          )  ; "Garage"              
            case  3 :	if (SumAll( OtherZone:CondFloorArea ) > 0 .AND. SumAll( Zone:CondFloorArea ) > 0)
                        then  if (MaxAll( OtherZone:CondFloorArea ) > MaxAll( Zone:CondFloorArea ))
                              then  MaxAllComp( OtherZone:CondFloorArea )
                              else  MaxAllComp(      Zone:CondFloorArea )  endif
                        else  MaxAllComp(            Zone:CondFloorArea )  endif  ; "Conditioned Zone"    
     ;       case  4 :	MaxAllComp( Zone:UncondFloorArea )  ; "Unconditioned Zone"  
            case  5 :	MaxAllComp( CrawlSpace:Area      )  ; "Crawl Space"         
            case  7 :	     if (IfValidAnd( DuctsTooLrgForAttic > 0 )==0 .AND.        ; "Multiple"
                                 SumAll( Attic:ClVentableVolume ) > 0.1)  then  MaxAllComp( Attic:ClVentableVolume )
            				else if (IfValidAnd( DuctsTooLrgForAttic > 0 )==0 .AND.
                                 SumAll( Attic:FloorAreaOverCond ) > 0.1) then  MaxAllComp( Attic:FloorAreaOverCond )
								else if (SumAll( CrawlSpace:Area ) > 0)           then  MaxAllComp( CrawlSpace:Area )
								else if (SumAll( Garage:Area ) > 0 .AND.
											Global( Proj:HasGarage ) > 0.1)          then  MaxAllComp( Garage:Area )
            				else if (IfValidAnd( DuctsTooLrgForAttic > 0 )==0 .AND.
                                 SumAll( Attic:FloorArea ) > 0.1 )        then  MaxAllComp( Attic:FloorArea )
								else if (SumAll( OtherZone:CondFloorArea ) > 0 .AND. SumAll( Zone:CondFloorArea ) > 0)
                        then  if (MaxAll( OtherZone:CondFloorArea ) > MaxAll( Zone:CondFloorArea ))
                              then  MaxAllComp( OtherZone:CondFloorArea )
                              else  MaxAllComp(      Zone:CondFloorArea )  endif
                        else  MaxAllComp(            Zone:CondFloorArea )    ; "Conditioned Zone"
								endif endif endif endif endif endif        
				default :	UNDEFINED
			endswitch  }
   "Default HVACDist:ReturnDuctLoc"		HVACDist:ReturnDuctLoc = {  SupplyDuctLoc  }

; SAC 5/6/15 - new properties that reference either (new) HVACDist:*DuctAttic or :*DuctLoc to track the location actually used to simulate the duct location
	"Set HVACDist:SupplyDuctLocUse"		HVACDist:SupplyDuctLocUse	= {	switch ( DuctLocation )
																									case  1 :	SupplyDuctAttic    ; "Attic"
																									default :	SupplyDuctLoc      ; any other
																								endswitch  }
	"Set HVACDist:ReturnDuctLocUse"		HVACDist:ReturnDuctLocUse	= {	switch ( DuctLocation )
																									case  1 :	ReturnDuctAttic    ; "Attic"
																									default :	ReturnDuctLoc      ; any other
																								endswitch  }

   "Default HVACDist:SupplyDuctDiam"		HVACDist:SupplyDuctDiam	= {	 8  }
   "Default HVACDist:ReturnDuctDiam"		HVACDist:ReturnDuctDiam	= {	16  }

;   "Default HVACDist:SupplyDuctArea"    HVACDist:SupplyDuctArea  = {  0.27 * Local( FloorAreaServed )  }
;   "Default HVACDist:ReturnDuctArea"    HVACDist:ReturnDuctArea  = {  	if (Local( NumStoriesServed ) > 1.5)
;																								then  0.10 * Local( FloorAreaServed )
;																								else  0.05 * Local( FloorAreaServed )  endif  }
; SAC 9/4/13 - GC issue 162 - revised above rules to set *DuctAreas to 0 when DuctsPresent flag set to 0 - certain duct Types still require duct modeling w/ surfaces areas = 0
; SAC 9/4/13 - GC issue 164 - added logic to ensure ducts located outside still get proper area defined, but zero area for MFam models (GC issue 166)
   "Default HVACDist:SupplyDuctArea"    HVACDist:SupplyDuctArea	= {	if (DuctsPresent < 0.5 .OR. (Proj:IsMultiFamily > 0.5 .AND. DuctLocation == 6)) then  0
																								else  if (Type == 6)										; "DuctsInEx12 - Ducts located within the conditioned space (except < 12 lineal ft)"
																										then	0.027 * Local( FloorAreaServed )
																										else	0.27  * Local( FloorAreaServed )  endif endif  }
; mjb 4/24/14 - GC issue 297 - added if home > 1 floor - mult SupDuctArea * 0.65
	"Adjust HVACDist:SupplyDuctArea"		 HVACDist:SupplyDuctArea	= {	if (Local( NumStoriesServed ) > 1.5)
																										then  0.65 * SupplyDuctArea
																										else  UNCHANGED  endif	}
   "Default HVACDist:ReturnDuctArea"    HVACDist:ReturnDuctArea	= {	if (DuctsPresent < 0.5 .OR. (Proj:IsMultiFamily > 0.5 .AND. DuctLocation == 6)) then  0
																								else	if (Local( NumStoriesServed ) > 1.5)
																										then  0.10 * Local( FloorAreaServed )
																										else  0.05 * Local( FloorAreaServed )  endif
																								endif  }

   ; added rules to set supply & return duct surface areas (and max areas) to ensure they fit in the selected attic (if attic located) (tic #621) - SAC 5/31/17
   "Set HVACDist:SupDuctSurfaceArea - Surface area of supply ducts (used in check for ducts too large for attic)"  ; SAC 5/31/17 - tic #621 
      HVACDist:SupDuctSurfaceArea  = {
         if (SupplyDuctDiam <= 0 .OR. IfValidAnd( DuctInsAdjRval > 0 )==0)
         then  SupplyDuctArea
         else  SupplyDuctArea * ( (SupplyDuctDiam/12) + (2 * DuctInsAdjRval / (ValidOr( Proj:DuctInsRValPerInch, 3 ) * 12) ) ) / (SupplyDuctDiam/12)
         endif  }
   "Set HVACDist:RetDuctSurfaceArea - Surface area of return ducts (used in check for ducts too large for attic)"  ; SAC 5/31/17 - tic #621
      HVACDist:RetDuctSurfaceArea  = {
         if (ReturnDuctDiam <= 0 .OR. IfValidAnd( RetDuctInsAdjRval > 0 )==0)
         then  ReturnDuctArea
         else  ReturnDuctArea * ( (ReturnDuctDiam/12) + (2 * RetDuctInsAdjRval / (ValidOr( Proj:DuctInsRValPerInch, 3 ) * 12) ) ) / (ReturnDuctDiam/12)
         endif  }

   "Set HVACDist:MaxSupDuctArea-1 - Max supply duct SURFACE area"  ; SAC 5/31/17 - tic #621 
      HVACDist:MaxSupDuctArea  = {
         if (DuctsPresent < 0.5 .OR. IfValidAnd( Proj:MaxDuctFracArea > 0 )==0 .OR. Type != 1 .OR.
             LocalCompAssigned( SupplyDuctAttic ) < 1 .OR. SupplyDuctDiam <= 0)
         then  -1
         else if (IfValidAnd( SupplyDuctAttic = ReturnDuctAttic ))
         then  (ValidOr( SupplyDuctAttic:DeckArea, 0 ) + ValidOr( SupplyDuctAttic:TrussArea, 0 ) + RetDuctSurfaceArea) /
               ((1/Proj:MaxDuctFracArea)-1)
         else  (ValidOr( SupplyDuctAttic:DeckArea, 0 ) + ValidOr( SupplyDuctAttic:TrussArea, 0 )) /
               ((1/Proj:MaxDuctFracArea)-1)
         endif endif  }
   "Set HVACDist:MaxSupDuctArea-2 - Max supply duct area (to be simulated in selected location)"  ; SAC 5/31/17 - tic #621 
      HVACDist:MaxSupDuctArea  = {
         if (MaxSupDuctArea < 0 .OR. IfValidAnd( DuctInsAdjRval > 0 )==0) then  UNCHANGED
         else  MaxSupDuctArea / 
               ( ( (SupplyDuctDiam/12) + (2 * DuctInsAdjRval / (ValidOr( Proj:DuctInsRValPerInch, 3 ) * 12) ) ) / (SupplyDuctDiam/12) )
         endif  }

   "Set HVACDist:MaxRetDuctArea-1 - Max return duct SURFACE area"  ; SAC 5/31/17 - tic #621 
      HVACDist:MaxRetDuctArea  = {
         if (DuctsPresent < 0.5 .OR. IfValidAnd( Proj:MaxDuctFracArea > 0 )==0 .OR. Type != 1 .OR.
             LocalCompAssigned( ReturnDuctAttic ) < 1 .OR. ReturnDuctDiam <= 0)
         then  -1
         else if (IfValidAnd( SupplyDuctAttic = ReturnDuctAttic ))
         then  (ValidOr( ReturnDuctAttic:DeckArea, 0 ) + ValidOr( ReturnDuctAttic:TrussArea, 0 ) + SupDuctSurfaceArea) /
               ((1/Proj:MaxDuctFracArea)-1)
         else  (ValidOr( ReturnDuctAttic:DeckArea, 0 ) + ValidOr( ReturnDuctAttic:TrussArea, 0 )) /
               ((1/Proj:MaxDuctFracArea)-1)
         endif endif  }
   "Set HVACDist:MaxRetDuctArea-2 - Max return duct area (to be simulated in selected location)"  ; SAC 5/31/17 - tic #621 
      HVACDist:MaxRetDuctArea  = {
         if (MaxRetDuctArea < 0 .OR. IfValidAnd( RetDuctInsAdjRval > 0 )==0) then  UNCHANGED
         else  MaxRetDuctArea / 
               ( ( (ReturnDuctDiam/12) + (2 * RetDuctInsAdjRval / (ValidOr( Proj:DuctInsRValPerInch, 3 ) * 12) ) ) / (ReturnDuctDiam/12) )
         endif  }

;	mjb - moved to HVAC:Cool 	8/21/13
;	"Set HVACDist:ShowIsZonal"		HVACDist:ShowIsZonal		= {	if (LocalStatus( Type ) < 2) then  0
;																					else	T24RDistributionSystemsTable( Type, 2 )  endif  }
;	"Default HVACDist:IsZonal"		HVACDist:IsZonal			= {	0  }

; SAC 10/23/14 - moved up into ProposedInput rules so that they are set prior to export of Proposed model for reporting
   ;--------------------------------------------------------------------
   ; Assign physical duct locations for reporting 	mjb-10/08/13
   ;--------------------------------------------------------------------
;0,    "n/a"
;1,    "Attic"
;2,    "Garage"
;3,    "Conditioned Zone"
;4,    "Unconditioned Zone"
;5,    "Crawl Space"
;6,    "Outside"
;7,    "Multiple"
;Type:
;0,    "- select distribution system type -"
;1,    "Ducts located in unconditioned attic"
;2,    "Ducts located in a crawl space"
;4,    "Ducts located in a garage"
;6,    "Ducts located within the conditioned space (except < 12 lineal ft)"
;7,    "Ducts located entirely in conditioned space"
;8,    "Distribution systems without ducts"
;9,    "Ducts located in outdoor locations"
;12,    "Verified low-leakage ducts entirely in conditioned space"
;13,    "Ducts located in multiple places"

   ; SAC 9/18/19 - revised to support OtherZone assignments
	"Assign supply duct physical location"		HVACDist:SupplyRptLocation = { switch (Type)
									case   1 :	1
									case   2 :	5
									case   3 :	5
									case   4 :	2
									case   5 :	4
									case   6 :	3
									case   7 :	3
									case   8 :	0
									case   9 :	6
									case  12 :	3
									case  13 :	  if ( LocalCompAssigned( SupplyDuctLocUse ) = ComponentType( "Zone" ) .OR.
									                   LocalCompAssigned( SupplyDuctLocUse ) = ComponentType( "OtherZone" ) ) then 3
												else if ( LocalCompAssigned( SupplyDuctLocUse ) = ComponentType( "Attic" ) ) then 1
												else if ( LocalCompAssigned( SupplyDuctLocUse ) = ComponentType( "Garage" ) ) then 2
												else if ( LocalCompAssigned( SupplyDuctLocUse ) = ComponentType( "Crawlspace" ) ) then 5
												else UNDEFINED
											endif endif endif endif 
									default  :	1
								endswitch }

	"Assign return duct physical location"		HVACDist:ReturnRptLocation = { switch (Type)
									case   1 :	1
									case   2 :	5
									case   3 :	5
									case   4 :	2
									case   5 :	4
									case   6 :	3
									case   7 :	3
									case   8 :	0
									case   9 :	6
									case  12 :	3
									case  13 :	  if ( LocalCompAssigned( ReturnDuctLocUse ) = ComponentType( "Zone" ) .OR.
									                   LocalCompAssigned( ReturnDuctLocUse ) = ComponentType( "OtherZone" ) ) then 3
												else if ( LocalCompAssigned( ReturnDuctLocUse ) = ComponentType( "Attic" ) ) then 1
												else if ( LocalCompAssigned( ReturnDuctLocUse ) = ComponentType( "Garage" ) ) then 2
												else if ( LocalCompAssigned( ReturnDuctLocUse ) = ComponentType( "Crawlspace" ) ) then 5
												else UNDEFINED
											endif endif endif endif 
									default  :	1
								endswitch }

  ; SAC 1/3/16 - Screen message re: QII or high duct R-value (tic 597)
  ; SAC 4/18/19 - added logic to report 'cannot exceed R-8' messages for 2016 and earlier codes only, as new 2019 DuctSeg UI disallows this
	"Set HVACDist:DuctScreenMsg"		HVACDist:DuctScreenMsg	= {
				if (FloorAreaServed < 0.1 .OR. DefaultSystem > 0.5) then  " "
				else if (DuctDesign > 0.5 .AND. (IfValidAnd( AreBuried > 0 ) .OR. IfValidAnd( AreDeeplyBuried > 0 )))
				then	"QII is required for buried duct credits"
				else if (Status != 1 .AND. DuctDesign < 0.5 .AND. DuctInsRvalOpt > 801)
				then	Format( "Error: Duct R-value (R-%g) cannot exceed R-8 unless verified and buried", (DuctInsRvalOpt/100) )
				else if (Proj:StdDesignBase <= 2016 .AND. Status != 1 .AND. DuctDesign > 0.5 .AND. IfValidAnd( AreBuried < 0.5 ) .AND. IfValidAnd( AreDeeplyBuried < 0.5 ) .AND.
								(IfValidAnd( DuctDesignInsRvalue > 8 ) .OR. IfValidAnd( RetDuctDesignInsRvalue > 8 )))
				then	if (IfValidAnd( DuctDesignInsRvalue > 8 ) .AND. IfValidAnd( RetDuctDesignInsRvalue > 8 ))
						then	"Error: Supply and return duct R-values cannot exceed R-8 unless verified and buried"
						else if (IfValidAnd( DuctDesignInsRvalue > 8 ))
						then	Format( "Error: Supply duct R-value (R-%g) cannot exceed R-8 unless verified and buried",    DuctDesignInsRvalue )
						else	Format( "Error: Return duct R-value (R-%g) cannot exceed R-8 unless verified and buried", RetDuctDesignInsRvalue )
						endif endif
				else	" "  endif endif endif endif  }

END

;*************************************************************************
RULELIST "Default_HVACDist_VerifiedDuctDesign" 0 0 0 0
;*************************************************************************

;    "BuriedPerACM"  enum options: 0-No / 1-Yes "whether or not duct R-value to be determined based on ACM rules on buried ducts"    - SAC 4/11/19

   "Reset DuctSeg:InsulRValue if it's invalid"     DuctSeg:Action  = {
         if (LocalSymbolInvalid( InsulRValue )) then  EvalRulelist( "ForceReset_DuctSeg_InsulRValue", 1 )
         else  UNCHANGED  endif  }

   "Set DuctSeg:AtticInsulDepth"    DuctSeg:AtticInsulDepth  = {
         if (AtticInsulType > 0 .AND. AtticInsulRValue > 0)
         then  switch (AtticInsulType)
                  case  1 :  (AtticInsulRValue/10) / 2.5   ; Fiberglass @ R-2.5/in
                  case  2 :  (AtticInsulRValue/10) / 3.2   ; Cellulose  @ R-3.2/in
                  default :  0
               endswitch
         else  0  endif  }

   ; SAC 4/5/19 - added look-up table sand rules to set individual DuctSeg data
   "Set DuctSeg:EffectiveRValue"    DuctSeg:EffectiveRValue  = {
         if (BuriedPerACM = 0) then  InsulRValue/10
         else if (InsulRValue > 0 .AND. AtticInsulType > 0 .AND. AtticInsulRValue > 0 .AND. Diameter > 0)
         then  BuriedDuctEffectiveRValue:EffR( "CodeBase", Proj:StdDesignBase, "DuctInsul", EnumString( InsulRValue ), "Material", EnumString( AtticInsulType ),
                                                                               "AtticInsulR", AtticInsulRValue/10, "DuctDiam", EnumString( Diameter ) )
         else  UNDEFINED  endif endif  }
   "Set DuctSeg:BuriedLevel"        DuctSeg:BuriedLevel  = {
         if (BuriedPerACM = 0) then  0
         else if (InsulRValue > 0 .AND. IfValidAnd( EffectiveRValue > 0 ))
         then  BuriedDuctLevel:Level( "CodeBase", Proj:StdDesignBase, "DuctInsul", EnumString( InsulRValue ), "EffR", EffectiveRValue )
         else  UNDEFINED  endif endif  }
   "Set DuctSeg:BuriedLevelFlags[1]-Not flag"   DuctSeg:BuriedLevelFlags[1] = {  if (BuriedPerACM > 0 .AND. BuriedLevel = 0) then  1  else  UNDEFINED  endif  }
   "Set DuctSeg:BuriedLevelFlags[2]-Part flag"  DuctSeg:BuriedLevelFlags[2] = {  if (BuriedPerACM > 0 .AND. BuriedLevel = 1) then  1  else  UNDEFINED  endif  }
   "Set DuctSeg:BuriedLevelFlags[3]-Full flag"  DuctSeg:BuriedLevelFlags[3] = {  if (BuriedPerACM > 0 .AND. BuriedLevel = 2) then  1  else  UNDEFINED  endif  }
   "Set DuctSeg:BuriedLevelFlags[4]-Deep flag"  DuctSeg:BuriedLevelFlags[4] = {  if (BuriedPerACM > 0 .AND. BuriedLevel = 3) then  1  else  UNDEFINED  endif  }

   "Reset DuctSeg:ContainmentSystem if needed"     DuctSeg:Action =     ; SAC 4/10/19 - tic #874
      {  ; if (LocalStatus( ContainmentSystem ) < 5) then  UNCHANGED  else
         if ( (BuriedLevel != 3 .AND. ContainmentSystem > 0) .OR.
              (BuriedLevel == 3 .AND. ContainmentSystem < 1) )
         then  EvalRulelist( "ForceDefault_DuctSeg_ContainmentSystem", 1 )
         else  UNCHANGED  endif  }

   "Set DuctSeg:SupplyArea"         DuctSeg:SupplyArea  = {
         if (Type != 1 .OR. IfValidAnd( Length > 0 )==0 .OR. Diameter < 10) then  UNDEFINED
         else  Length * 3.14159 * (Diameter/120)
         endif  }
   "Set DuctSeg:ReturnArea"         DuctSeg:ReturnArea  = {
         if (Type != 2 .OR. IfValidAnd( Length > 0 )==0 .OR. Diameter < 10) then  UNDEFINED
         else  Length * 3.14159 * (Diameter/120)
         endif  }

   ; SAC 4/12/19 (tic #874)
   "Set DuctSeg:ExSupplyArea"       DuctSeg:ExSupplyArea  = {
         if (IfValidAnd( SupplyArea > 0 ) .AND. Proj:RunScope == 2 .AND. Status == 1) then  SupplyArea
         else  UNDEFINED  endif  }
   "Set DuctSeg:ExReturnArea"       DuctSeg:ExReturnArea  = {
         if (IfValidAnd( ReturnArea > 0 ) .AND. Proj:RunScope == 2 .AND. Status == 1) then  ReturnArea
         else  UNDEFINED  endif  }

   "Set DuctSeg:SupplyUA"           DuctSeg:SupplyUA  = {
         if (IfValidAnd( SupplyArea > 0 )==0 .OR. IfValidAnd( EffectiveRValue > 0 )==0) then  UNDEFINED
         else  SupplyArea / (EffectiveRValue + 0.7)
         endif  }
   "Set DuctSeg:ReturnUA"           DuctSeg:ReturnUA  = {
         if (IfValidAnd( ReturnArea > 0 )==0 .OR. IfValidAnd( EffectiveRValue > 0 )==0) then  UNDEFINED
         else  ReturnArea / (EffectiveRValue + 0.7)
         endif  }

   "Set DuctSeg:ErrorID"      DuctSeg:ErrorID  = {
         if (IfValidAnd( Length > 0 )==0) then  100
         else  0  endif  }

   "Set DuctSeg:DuctRTooHiError - flag 0/1 indicating this duct's R-value is too high (>8 w/ BuriedPerACM = Yes)"    DuctSeg:DuctRTooHiError  =   ; SAC 4/18/19
      {  if (BuriedPerACM > 0 .AND. BuriedLevel < 1 .AND. IfValidAnd( EffectiveRValue >= 8.01 ))
         then  1  else  0  endif  }

   "Set HVACDist Supply duct design data if DuctSeg data valid"     HVACDist:Action  = {
         if (IfValidAnd( DefaultSystem != 0 ) .OR. IfValidAnd( DuctsPresent > 0 )==0 .OR.
             IfValidAnd( DuctDesign > 0 )==0) then  UNCHANGED  ; do nothing if not doing duct design
         else if (MaxChild( DuctSeg:ErrorID ) > 0 .OR. SumChildren( DuctSeg:SupplyArea ) < 0.1)
         then  EvalRulelist( "Blast_HVACDist_VerifiedDuctDesign_Supply", 1 )
         else  EvalRulelist( "Set_HVACDist_VerifiedDuctDesign_Supply", 1 )
         endif endif  }
   "Set HVACDist:SupplyDuctFracEx"        HVACDist:SupplyDuctFracEx  =     ; SAC 4/12/19 (tic #874)
      {  if (IfValidAnd( DefaultSystem != 0 ) .OR. IfValidAnd( DuctsPresent > 0 )==0 .OR.
             IfValidAnd( DuctDesign > 0 )==0 .OR. ChildCount( DuctSeg ) < 1) then  0
         else if (MaxChild( DuctSeg:ErrorID ) > 0) then  0
         else if (IfValidAnd( SupplyDuctArea > 0 ) .AND. SumChildren( DuctSeg:SupplyArea ) > 0)
         then  SumChildren( DuctSeg:ExSupplyArea ) / SumChildren( DuctSeg:SupplyArea )
         else  0  endif endif endif  }

   "Set HVACDist Return duct design data if DuctSeg data valid"     HVACDist:Action  = {
         if (IfValidAnd( DefaultSystem != 0 ) .OR. IfValidAnd( DuctsPresent > 0 )==0 .OR.
             IfValidAnd( DuctDesign > 0 )==0) then  UNCHANGED  ; do nothing if not doing duct design
         else if (MaxChild( DuctSeg:ErrorID ) > 0 .OR. SumChildren( DuctSeg:ReturnArea ) < 0.1)
         then  EvalRulelist( "Blast_HVACDist_VerifiedDuctDesign_Return", 1 )
         else  EvalRulelist( "Set_HVACDist_VerifiedDuctDesign_Return", 1 )
         endif endif  }
   "Set HVACDist:ReturnDuctFracEx"        HVACDist:ReturnDuctFracEx  =     ; SAC 4/12/19 (tic #874)
      {  if (IfValidAnd( DefaultSystem != 0 ) .OR. IfValidAnd( DuctsPresent > 0 )==0 .OR.
             IfValidAnd( DuctDesign > 0 )==0 .OR. ChildCount( DuctSeg ) < 1) then  0
         else if (MaxChild( DuctSeg:ErrorID ) > 0) then  0
         else if (IfValidAnd( ReturnDuctArea > 0 ) .AND. SumChildren( DuctSeg:ReturnArea ) > 0)
         then  SumChildren( DuctSeg:ExReturnArea ) / SumChildren( DuctSeg:ReturnArea )
         else  0  endif endif endif  }

   "Set HVACDist:DuctDesignDlgMsg"     HVACDist:DuctDesignDlgMsg  = {
         if (IfValidAnd( DefaultSystem != 0 ) .OR. IfValidAnd( DuctsPresent > 0 )==0 .OR.
             IfValidAnd( DuctDesign > 0 )==0) then  UNDEFINED  ; do message if not doing duct design
         else if (MaxChild( DuctSeg:ErrorID ) > 0)
         then  switch (MaxChild( DuctSeg:ErrorID ))
                  case  100 :  Format( "  Describe each duct segment of HVACDist '%s':  Invalid or missing DuctSeg Length(s)", Name )
                  default   :  Format( "  Describe each duct segment of HVACDist '%s':  DuctSeg error(s) encountered", Name )
               endswitch
         else if (SumChildren( DuctSeg:SupplyArea ) > 0.1 .AND. SumChildren( DuctSeg:ReturnArea ) > 0.1)
         then  Format( "  Describe each duct segment of HVACDist '%s':  Supply duct area %.0f, R-value %.1f / Return duct area %.0f, R-value %.1f",
                           Name, SupplyDuctArea, DuctDesignInsRvalue, ReturnDuctArea, RetDuctDesignInsRvalue )
         else if (SumChildren( DuctSeg:SupplyArea ) > 0.1)
         then  Format( "  Describe each duct segment of HVACDist '%s':  Supply duct area %.0f, R-value %.1f", Name, SupplyDuctArea, DuctDesignInsRvalue )
         else if (SumChildren( DuctSeg:ReturnArea ) > 0.1)
         then  Format( "  Describe each duct segment of HVACDist '%s':  Return duct area %.0f, R-value %.1f", Name, ReturnDuctArea, RetDuctDesignInsRvalue )
         else  Format( "  Describe each duct segment of HVACDist '%s':", Name )
         endif endif endif endif endif  }
END
;************************************************************************* - SAC 4/11/19
RULELIST "ForceReset_DuctSeg_InsulRValue" 1 0 0 0
   "Set valid DuctSeg:InsulRValue"     DuctSeg:InsulRValue  = {  EnsureSymbolExists()  }
END
;************************************************************************* - SAC 4/10/19
RULELIST "ForceDefault_DuctSeg_ContainmentSystem" 1 0 0 0
   "Force default of DuctSeg:ContainmentSystem"    DuctSeg:ContainmentSystem = {
         if (BuriedLevel = 3)
         then  1   ; "not required"
         else  0   ; "n/a"
         endif  }
END

;*************************************************************************
; SAC 10/30/19 - ensure buried duct inputs that were previously user inputs are defaulted for 2019+ code vintages (tic #1128)
RULELIST  "Blast_HVACDist_AreBuriedFlags"  1 0 0 1
	"Blast HVACDist:AreBuried"				HVACDist:AreBuried			= {	UNDEFINED  }		
	"Blast HVACDist:AreDeeplyBuried"		HVACDist:AreDeeplyBuried	= {	UNDEFINED  }		
END
;************************************************************************* - SAC 4/9/19
RULELIST "Set_HVACDist_VerifiedDuctDesign_Supply" 1 0 1 0
   "Set HVACDist:SupplyDuctArea"          HVACDist:SupplyDuctArea  = {
         SumChildren( DuctSeg:SupplyArea ) * 1.1765  }   ; SAC 4/12/19 - apply 17.65% increase to represent plenums, etc. (tic #874)
   "Set HVACDist:DuctDesignInsRvalue"     HVACDist:DuctDesignInsRvalue  = {
         if (SumChildren( DuctSeg:SupplyUA ) < 0.001) then  UNDEFINED
         else  (SumChildren( DuctSeg:SupplyArea ) / SumChildren( DuctSeg:SupplyUA )) - 0.7  endif  }  ; SAC 4/12/19 - calc based on UN-adjusted area (tic #874)
   "Set HVACDist:AreBuried"         HVACDist:AreBuried        = {  if (SumChildren( DuctSeg:BuriedLevelFlags[2] ) .OR.
                                                                       SumChildren( DuctSeg:BuriedLevelFlags[3] )) then  1  else  UNCHANGED  endif  }  ; SAC 4/18/19 - revised to set AreBuried for either Partially or Fully buried (tic #874)
   "Set HVACDist:AreDeeplyBuried"   HVACDist:AreDeeplyBuried  = {  if (SumChildren( DuctSeg:BuriedLevelFlags[4] )) then  1  else  UNCHANGED  endif  }
END
;************************************************************************* - SAC 4/18/19
RULELIST "Blast_HVACDist_VerifiedDuctDesign_Supply" 1 0 0 0
   "Blast HVACDist:SupplyDuctArea"       HVACDist:SupplyDuctArea       = {  UNDEFINED  }
   "Blast HVACDist:DuctDesignInsRvalue"  HVACDist:DuctDesignInsRvalue  = {  UNDEFINED  }
END
;************************************************************************* - SAC 4/9/19
RULELIST "Set_HVACDist_VerifiedDuctDesign_Return" 1 0 1 0
   "Set HVACDist:ReturnDuctArea"          HVACDist:ReturnDuctArea  = {
         SumChildren( DuctSeg:ReturnArea ) * 1.1765  }   ; SAC 4/12/19 - apply 17.65% increase to represent plenums, etc. (tic #874)
   "Set HVACDist:RetDuctDesignInsRvalue"  HVACDist:RetDuctDesignInsRvalue  = {
         if (SumChildren( DuctSeg:ReturnUA ) < 0.001) then  UNDEFINED
         else  (SumChildren( DuctSeg:ReturnArea ) / SumChildren( DuctSeg:ReturnUA )) - 0.7  endif  }  ; SAC 4/12/19 - calc based on UN-adjusted area (tic #874)
   "Set HVACDist:AreBuried"         HVACDist:AreBuried        = {  if (SumChildren( DuctSeg:BuriedLevelFlags[2] ) .OR.
                                                                       SumChildren( DuctSeg:BuriedLevelFlags[3] )) then  1  else  UNCHANGED  endif  }  ; SAC 4/18/19 - revised to set AreBuried for either Partially or Fully buried (tic #874)
   "Set HVACDist:AreDeeplyBuried"   HVACDist:AreDeeplyBuried  = {  if (SumChildren( DuctSeg:BuriedLevelFlags[4] )) then  1  else  UNCHANGED  endif  }
END
;************************************************************************* - SAC 4/18/19
RULELIST "Blast_HVACDist_VerifiedDuctDesign_Return" 1 0 0 0
   "Blast HVACDist:ReturnDuctArea"          HVACDist:ReturnDuctArea          = {  UNDEFINED  }
   "Blast HVACDist:RetDuctDesignInsRvalue"  HVACDist:RetDuctDesignInsRvalue  = {  UNDEFINED  }
END
;*************************************************************************


;*************************************************************************
RULELIST "Default_Fan" 0 0 0 0
;*************************************************************************
	"Default HVACFan:Type"	HVACFan:Type	= {	if (MaxRevRef( HVACSys:Fan, HVACSys:HasCentralFurnace ) > 0.5)
																then  1		; "Single Speed PSC Furnace Fan"
										; later add check for IAQ system assignment => Fan:Type = 3: "Single Speed Stand Alone IAQ Fan"
																else  0  endif  }
	"Set HVACFan:TypeAbbrev"		HVACFan:TypeAbbrev		= {  Local( Type )  }
	"Set HVACFan:TypeAbbrevStr"	HVACFan:TypeAbbrevStr	= {  EnumString( TypeAbbrev )  }
	"Set HVACFan:IsAvailable"		HVACFan:IsAvailable		= {  1  }		; until flags setup to disable unimplemented fan types...
	"Set HVACFan:FloorAreaServed"  	HVACFan:FloorAreaServed   =         ; revised following rules to base *AreaServed on DwellUnitType data (iff MFam model AND no HVACSys assigned to Zones (yet)) - SAC 04/08/21
      {  if (Proj:IsMultiFamily .AND. SumAll( HVACSys:FloorAreaServed[1] ) < 1)
         then  SumRevRef( DwellUnitType:HVACFanRef, DwellUnitType:DUFloorAreaServed )
         else  SumRevRef( HVACSys:Fan, HVACSys:FloorAreaServed[1] )  endif  }
	"Set HVACFan:ClFlrAreaServed"  	HVACFan:ClFlrAreaServed   =
      {  if (Proj:IsMultiFamily .AND. SumAll( HVACSys:FloorAreaServed[1] ) < 1)
         then  SumRevRef( DwellUnitType:HVACFanRef, DwellUnitType:DUClFlrAreaServed ) + SumRevRef( DwellUnitType:HVACFanRef, DwellUnitType:DUHtPmpFlrAreaServed )
         else  SumRevRef( HVACSys:Fan, HVACSys:ClFlrAreaServed    ) + SumRevRef( HVACSys:Fan, HVACSys:HtPmpFlrAreaServed[1] )  endif  }		; GC issue 450
	"Set HVACFan:GasFurnAreaServed"  HVACFan:GasFurnAreaServed =
      {  if (Proj:IsMultiFamily .AND. SumAll( HVACSys:FloorAreaServed[1] ) < 1)
         then  SumRevRef( DwellUnitType:HVACFanRef, DwellUnitType:DUGasFurnAreaServed )
         else  SumRevRef( HVACSys:Fan, HVACSys:GasFurnAreaServed  )  endif  }		; 2019 code (tic #928) - SAC 2/5/18
	"Set HVACFan:HtPumpAreaServed"   HVACFan:HtPumpAreaServed  =
      {  if (Proj:IsMultiFamily .AND. SumAll( HVACSys:FloorAreaServed[1] ) < 1)
         then  SumRevRef( DwellUnitType:HVACFanRef, DwellUnitType:DUHtPmpFlrAreaServed )
         else  SumRevRef( HVACSys:Fan, HVACSys:HtPmpFlrAreaServed[1]  )  endif  }	; 2019 fan power defaulting (tic #1074) - SAC 5/16/19
	"Set HVACFan:SDHVAreaServed"     HVACFan:SDHVAreaServed    =
      {  if (Proj:IsMultiFamily .AND. SumAll( HVACSys:FloorAreaServed[1] ) < 1)
         then  SumRevRef( DwellUnitType:HVACFanRef, DwellUnitType:DUSDHVFlrAreaServed )
         else  SumRevRef( HVACSys:Fan, HVACSys:SDHVFlrAreaServed      )  endif  }	; 2019 fan power defaulting (tic #1041) - SAC 8/19/19

	"Call subordinate rulelist to default fan data"
		HVACFan:Action = {	switch (Local( Type ))
										case  1 :  EvalRulelist( "Default_Fan_PSCFurnace", 1 )      ; "Single Speed PSC Furnace Fan"
							;			case  2 :  EvalRulelist( "Default_Fan_WholeHouse", 1 )      ; "Whole House Fan"
							;			case  3 :  EvalRulelist( "Default_Fan_StandAloneIAQ", 1 )   ; "Single Speed Stand Alone IAQ Fan"
										default :  EvalRulelist( "Default_Fan_unknown", 1 )
									endswitch  }
END

;*************************************************************************
RULELIST "Setup_HVACDistFan" 1 0 1 0
;*************************************************************************
	"Set HVACFan:Type"	HVACFan:Type	= {	1  }		; Single Speed PSC Furnace Fan
	"Default Fan"			HVACFan:Action	= {	EvalRulelist( "Default_Fan", 1 )  }
; mjb	6/12/14	set TypeRpt = 0 for HVAC Fan when no cooling in Proposed Design
	"Set Fan TypeRpt"		HVACFan:TypeRpt	= { 0 }
;	"DBG msg" HVACFan:Action = { MessageBox( "Setup_HVACDistFan -- HVACFan '%s' TypeRpt = %g", Name, TypeRpt ) }
END
;*************************************************************************
RULELIST "Setup_HVACDist" 1 0 1 0
;*************************************************************************
	"Default HVACDist"			HVACDist:Action	= {	EvalRulelist( "Default_HVACDist_ForceTypeDefault", 1 )  }
;	"Set HVACDist TypeRpt"		HVACDist:TypeRpt	= { 0 }
;	"DBG msg" HVACDist:Action = { MessageBox( "Setup_HVACDist -- HVACDist '%s' TypeRpt = %g", Name, TypeRpt ) }
END

; SAC 12/30/15 - added to force HVACDist defaulting when assigned to heat-only systems (tic 544)
;*************************************************************************
RULELIST "ForceDefault_HVACDist_DefaultSystem" 1 0 0 0
;*************************************************************************
	"Post message to log alerting to HVACDist:DefaultSystem reset"
			HVACDist:Action	= {	PostMessageToLog( "HVACDist '%s' being reset to default settings.  Duct performance trade-offs not allowed for heating-only systems.", Name )  }
	"Force reset of HVACDist:DefaultSystem"	HVACDist:DefaultSystem	= {  1  }
END

;*************************************************************************
RULELIST "ForceDefaults_HVACDist" 1 0 0 0
;*************************************************************************
	"Force Default of HVACDist:DuctLeakage"    		HVACDist:DuctLeakage     = {	if (LocalStatus( DuctLeakage    ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Default of HVACDist:DuctLeakageVal" 		HVACDist:DuctLeakageVal  = {  if (LocalStatus( DuctLeakageVal ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Default of HVACDist:DuctInsRvalOpt" 		HVACDist:DuctInsRvalOpt  = {  if (LocalStatus( DuctInsRvalOpt ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Default of HVACDist:DuctInsRvalue"  		HVACDist:DuctInsRvalue   = {  if (LocalStatus( DuctInsRvalue  ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Default of HVACDist:RetDuctInsRvalue"  	HVACDist:RetDuctInsRvalue   = {  if (LocalStatus( RetDuctInsRvalue  ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
;	"Force Default of HVACDist:SupplyDuctArea" 		HVACDist:SupplyDuctArea  = {  if (LocalStatus( SupplyDuctArea ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
;	"Force Default of HVACDist:ReturnDuctArea" 		HVACDist:ReturnDuctArea  = {  if (LocalStatus( ReturnDuctArea ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Default of HVACDist:SupplyDuctDiam" 		HVACDist:SupplyDuctDiam  = {  if (LocalStatus( SupplyDuctDiam ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Default of HVACDist:ReturnDuctDiam" 		HVACDist:ReturnDuctDiam  = {  if (LocalStatus( ReturnDuctDiam ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Default of HVACDist:SupplyDuctLoc"  		HVACDist:SupplyDuctLoc   = {  if (LocalStatus( SupplyDuctLoc  ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Default of HVACDist:ReturnDuctLoc"  		HVACDist:ReturnDuctLoc   = {  if (LocalStatus( ReturnDuctLoc  ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Default of HVACDist:SupplyDuctAttic"  	HVACDist:SupplyDuctAttic = {  if (LocalStatus( SupplyDuctAttic ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Default of HVACDist:ReturnDuctAttic"  	HVACDist:ReturnDuctAttic = {  if (LocalStatus( ReturnDuctAttic ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
;	mjb - moved to HVACCool	8/21/13
;	"Force Default of HVACDist:IsZonal"  				HVACDist:IsZonal   		 = {  if (LocalStatus( IsZonal        ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
; SAC 8/29/13 - added for consistency
; remove default of bypass duct setting
;	"Force Default of HVACDist:HasBypassDuct"  		HVACDist:HasBypassDuct   = {  if (LocalStatus( HasBypassDuct  ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Default of HVACDist:DuctDesign"  			HVACDist:DuctDesign      = {  if (LocalStatus( DuctDesign     ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Default of HVACDist:LowLkgAH"		  		HVACDist:LowLkgAH        = {  if (LocalStatus( LowLkgAH       ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Defaulting of LowLkgAH dependencies"		HVACDist:Action          = {  EvalRulelist( "ForceDefaults_HVACDist_LowLkgAH", 1 )  }
	"Force Defaulting of DuctDesign dependencies"	HVACDist:Action          = {  EvalRulelist( "ForceDefaults_HVACDist_DuctDesign", 1 )  }
;	"Force Default of HVACDist:IsLessThanFortyFt"	HVACDist:IsLessThanFortyFt	= {  if (LocalStatus( IsLessThanFortyFt ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
END
;*************************************************************************
RULELIST "ForceDefaults_HVACDist_LowLkgAH" 1 0 0 0
	"Force Default of HVACDist:DuctLeakage"			HVACDist:DuctLeakage		= {  if (LocalStatus( DuctLeakage ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Defaulting of DuctLeakage dependencies"	HVACDist:Action			= {  EvalRulelist( "ForceDefaults_HVACDist_DuctLeakage", 1 )  }
END
;*************************************************************************
RULELIST "ForceDefaults_HVACDist_DuctLeakage" 1 0 0 0
	"Force Default of HVACDist:DuctLeakageVal"		HVACDist:DuctLeakageVal	= {  if (LocalStatus( DuctLeakageVal ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
END
;*************************************************************************
RULELIST "ForceDefaults_HVACDist_DuctDesign" 1 0 0 0
	"Force Default of HVACDist:SupplyDuctArea"			HVACDist:SupplyDuctArea				= {  if (LocalStatus( SupplyDuctArea         ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Default of HVACDist:ReturnDuctArea"			HVACDist:ReturnDuctArea				= {  if (LocalStatus( ReturnDuctArea         ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
   "Force Default of HVACDist:DuctDesignInsRvalue"		HVACDist:DuctDesignInsRvalue		= {  if (LocalStatus( DuctDesignInsRvalue    ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
   "Force Default of HVACDist:RetDuctDesignInsRvalue"	HVACDist:RetDuctDesignInsRvalue	= {  if (LocalStatus( RetDuctDesignInsRvalue ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
   "Force Default of HVACDist:AreBuried"					HVACDist:AreBuried					= {  if (LocalStatus( AreBuried              ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
   "Force Default of HVACDist:AreDeeplyBuried"			HVACDist:AreDeeplyBuried			= {  if (LocalStatus( AreDeeplyBuried        ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
END
;*************************************************************************   ; SAC 5/7/18 - (tic #986)
RULELIST "ForceDefault_HVACDist_exDuctInsRvalOpt" 1 0 0 0
   "Force Default of HVACDist:exDuctInsRvalOpt"    HVACDist:exDuctInsRvalOpt  = {  UNDEFINED  }
END


;*************************************************************************
RULELIST "Default_HVACHeat" 0 0 0 0
;*************************************************************************
;"dbg"  HVACHeat:Action = {  if (Type == 9 .AND. IfValidAnd( CHWHeater:HeaterElementType = 0 ))
;         then  PostMessageToLog( "setting '%s' HVACHeat:TypeAbbrev = 'ElecCombHydro' (29) for Proj:RunAbbrev '%s'", Name, Proj:RunAbbrev )  else  UNCHANGED  endif  }
   ; SAC 6/12/18 - modified special logic setting TypeAbbrev to 'ElecCombHydro' (29) to EXCLUDE standard or design rating runs (tic #942)
	"Set HVACHeat:TypeAbbrev"				HVACHeat:TypeAbbrev  		= {	if (Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" .AND. Proj:RunAbbrev != "dr" .AND.
                                                                            Type == 9 .AND. IfValidAnd( CHWHeater:HeaterElementType = 0 )) then  29		; SAC 1/6/16 - map CombHydro & Elec DHW -> ElecCombHydro (tic 374)
																								else	Local( Type )  endif  }
	"Set HVACHeat:TypeAbbrevStr"			HVACHeat:TypeAbbrevStr 		= {  EnumString( TypeAbbrev )  }
	"Set HVACHeat:IsAvailable"				HVACHeat:IsAvailable 		= {  T24RHeatingEquipment:SysAvail( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }
  ; SAC 5/13/13
;	"Default HVACHeat:Ducted"				HVACHeat:Ducted				= {	if (Type < 1 .OR. IsAvailable < 0.5) then  0
;																								else if (T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) == 1) then  1
;																								else  0  endif endif  }
;	"Default HVACHeat:DuctedEditable"	HVACHeat:DuctedEditable		= {	if (Type < 1 .OR. IsAvailable < 0.5) then  0
;																								else if (T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) < 0) then  1
;																								else  0  endif endif  }

;	"Set HVACHeat:FloorAreaServed"		HVACHeat:FloorAreaServed 	= {  SumRevRef( HVACSys:HeatSystem,    HVACSys:FloorAreaServed )  }
	"Set HVACHeat:FloorAreaServed"		HVACHeat:FloorAreaServed 	= {  SumRevRef( HVACSys:HeatSystem,    HVACSys:HtFlrAreaServed )  }		; SAC 12/23/13
	"Set HVACHeat:ExFlrAreaServed"		HVACHeat:ExFlrAreaServed 	= {  SumRevRef( HVACSys:HeatSystem,    HVACSys:HtExFlrAreaServed )  }	; SAC 12/23/14
	"Set HVACHeat:AltFlrAreaServed"		HVACHeat:AltFlrAreaServed 	= {  SumRevRef( HVACSys:HeatSystem,    HVACSys:HtAltFlrAreaServed )  }
	"Set HVACHeat:NewFlrAreaServed"		HVACHeat:NewFlrAreaServed 	= {  SumRevRef( HVACSys:HeatSystem,    HVACSys:HtNewFlrAreaServed )  }

;	"Set HVACHeat:NumStoriesServed"		HVACHeat:NumStoriesServed  = {  SumRevRef( HVACSys:HeatSystem,    HVACSys:NumStoriesServed )  }
   "Default DisplayAFUE flag"				HVACHeat:DisplayAFUE			= {	0  }

; SAC 8/23/13 - moved ConstHtgSetpt to HVACHeat as part of HVAHeat array mods
;   "Default HVACHeat:ConstHtgSetpt"		HVACHeat:ConstHtgSetpt		= {  T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }

   "Default HVACHeat:AutoSize"			HVACHeat:AutoSize				= {	MinRevRef( HVACSys:HeatSystem, HVACSys:AutoSizeHeat, HVACSys:NumHeatSystemTypes )  }
   "Default HVACHeat:AutoSize - 2"		HVACHeat:AutoSize				= {	if (LocalStatus( AutoSize ) < 1) then  1  else  UNCHANGED  endif  }
   "Default HVACHeat:SizingFactor"		HVACHeat:SizingFactor		= {	2  }   ; BAW changed from 1.5 to 2 130508

; SAC 5/13/13 - properties for combined hydronic
;	"Default HVACHeat:DisplayCHData"		HVACHeat:DisplayCHData		= {	-1  }
;	"Default HVACHeat:HydronicWHType"	HVACHeat:HydronicWHType		= {	UNDEFINED  }
	"Default HVACHeat:CHUCndPipeLength"	HVACHeat:CHUCndPipeLength	= {	UNDEFINED  }
	"Default HVACHeat:CHRecoveryEff"		HVACHeat:CHRecoveryEff		= {	UNDEFINED  }
	"Set HVACHeat:CHFloorAreaServed"		HVACHeat:CHFloorAreaServed	 = {	if (Type == 9) then  FloorAreaServed   else  0  endif  }
	"Set HVACHeat:CHExFlrAreaServed"		HVACHeat:CHExFlrAreaServed	 = {	if (Type == 9) then  ExFlrAreaServed   else  0  endif  }
	"Set HVACHeat:CHAltFlrAreaServed"	HVACHeat:CHAltFlrAreaServed = {	if (Type == 9) then  AltFlrAreaServed  else  0  endif  }
	"Set HVACHeat:CHNewFlrAreaServed"	HVACHeat:CHNewFlrAreaServed = {	if (Type == 9) then  NewFlrAreaServed  else  0  endif  }

END

;*************************************************************************
RULELIST "Default_HVACHeatPump" 0 0 0 0
;*************************************************************************
	"Set HVACHtPump:TypeAbbrev"					HVACHtPump:TypeAbbrev  			= {  Local( Type )  }
	"Set HVACHtPump:TypeAbbrevStr"			HVACHtPump:TypeAbbrevStr 		= {  EnumString( TypeAbbrev )  }
	"Set HVACHtPump:IsAvailable"				HVACHtPump:IsAvailable 			= {  T24RHeatingEquipment:SysAvail( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }
	"Set HVACHtPump:CanBeDHWHtr"				HVACHtPump:CanBeDHWHtr 			= {  T24RHeatingEquipment:CanDHW(   "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }		; SAC 4/20/14
   "Set HVACHtPump:IsPackaged"   HVACHtPump:IsPackaged  =
      {  switch ( Type )
            case 26 :  1  	   ; "PkgTermHeatPump - Packaged terminal heat pump (PTHP)"          ; SAC 6/24/20 (tic #1225)
            case 24 :  1  	   ; "SglPkgVertHeatPump - Single package vertical heat pump"        ; SAC 6/24/20 (tic #1226)
            default :  0
         endswitch  }
   "Set HVACHtPump:ShowCapLabel"    HVACHtPump:ShowCapLabel  =       ; VCHP2 - SAC 07/26/21
      {  if (IsAvailable > 0 .AND. (IfValidAnd( AutoSize > 0 )==0 .OR. Type = 33)) then  1  else  0  endif  }
	"Set HVACHtPump:Show4717COPs"				HVACHtPump:Show4717COPs			=        ; SAC 6/22/20 - PkgTermHeatPump & SglPkgVertHeatPump (tic #1225 & #1226)   ; VCHP2 - SAC 11/01/20
      {  if (Proj:AnalysisType < 3 .OR. Type = 11 .OR. Type = 12 .OR. Type = 26 .OR. Type = 24 .OR. Type = 33) then  1  else  0  endif  }
	"Set HVACHtPump:Show4717Labels"			HVACHtPump:Show4717Labels		=        ; VCHP2 - SAC 11/10/20
      {  if (IsAvailable > 0 .AND. Type != 12 .AND. (IfValidAnd( AutoSize > 0 )==0 .OR. Show4717COPs > 0)) then  1  else  0  endif  }
	"Set HVACHtPump:Show17COP"				   HVACHtPump:Show17COP			   =        ; VCHP2 - SAC 11/02/20
      {  if (Show4717COPs > 0 .AND. (Type = 11 .OR. Type == 33)) then  1  else  0  endif  }
	"Set HVACHtPump:Show35Props"				HVACHtPump:Show35Props			=        ; VCHP2 - SAC 11/02/20
      {  0  }
   ;   {  if (Proj:AnalysisType == 0 .OR. Type = 33) then  1  else  0  endif  }   ; VCHP2 now uses 47, 17 & 5 - SAC 07/24/21
	"Set HVACHtPump:ShowVCHPDucts"			HVACHtPump:ShowVCHPDucts		=        ; VCHP2 - SAC 11/02/20  ; toggled OFF for VCHP2 - SAC 08/02/21
      {  if (Type == 22) then  1  else  0  endif  }
	"Set HVACHtPump:ShowHSPF"						HVACHtPump:ShowHSPF				=     ; SAC 6/22/20 - PkgTermHeatPump & SglPkgVertHeatPump (tic #1225 & #1226)
      {  if (IsAvailable > 0 .AND. Type != 11 .AND. Type != 12 .AND. Type != 26 .AND. Type != 24 .AND. Type != 7) then  1  else  0  endif  }
	"Set HVACHtPump:ShowHeatPower"				HVACHtPump:ShowHeatPower		=     ; SAC 08/19/20 (tic #1003)
      {  if (IsAvailable > 0 .AND. Type == 7) then  1  else  0  endif  }
	"Set HVACHtPump:ShowUseEER"					HVACHtPump:ShowUseEER			=     ; SAC 6/22/20 - PkgTermHeatPump & SglPkgVertHeatPump (tic #1225 & #1226)
      {  if (IsAvailable > 0 .AND. Type != 22 .AND. Type != 33 .AND. Type != 26 .AND. Type != 24) then  1  else  0  endif  }    ; SAC 11/2/18 - VCHP   ; VCHP2 - SAC 11/01/20
	"Set HVACHtPump:ShowCEER"					   HVACHtPump:ShowCEER		      =     ; SAC 08/19/20 (tic #1003)
      {  if (IsAvailable > 0 .AND. (Type == 7 .OR. Type == 33) .AND.
             T24RCoolingEquipment:CEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ))
         then  1  else  0  endif  }
	"Set HVACHtPump:ShowSEER"					   HVACHtPump:ShowSEER		      =     ; VCHP2 - SAC 11/02/20
      {  if ((Show4717COPs < 1 .AND. ShowCEER < 1) .OR. Type == 33)  then  1  else  0  endif  }
	"Set HVACHtPump:SEERCEERLabel"			   HVACHtPump:SEERCEERLabel	   =     ; SAC 08/19/20 (tic #1003)
      {  if (ShowCEER) then  "CEER:"
         else if (IsAvailable > 0 .AND. ShowSEER > 0) then  "SEER:"
         else  UNDEFINED  endif endif  }
	"Set HVACHtPump:MinCEER"			HVACHtPump:MinCEER		=              ; SAC 08/19/20 (tic #1003)
      {  if (ShowCEER == 0) then  UNDEFINED
         else  T24RCoolingEquipment:CEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  endif  }
   "Set HVACHtPump:ShowCFMperTon - whether or not to display the CFM per Ton"   HVACHtPump:ShowCFMperTon =     ; SAC 08/19/20 (tic #1003)
      {  if (Type == 24) then  1    ; SglPkgVertHeatPump
         else if (Show4717COPs < 1 .AND. Type !=10 .AND. Type < 20 .AND. Type != 7) then  1
         else  0  endif endif  }
   "Set HVACHtPump:ShowRefrigerant - whether or not to display Refrigerant"     HVACHtPump:ShowRefrigerant =   ; SAC 08/31/20 (tic #1003)
      {  if (Show4717COPs < 1 .AND. Type !=10 .AND. Type != 7 .AND. Type < 20 .AND. IsPackaged < 1)
         then  1  else  0  endif  }

   "Set HVACHtPump:ShowPerfDetails - whether or not to show 'Performance Details' dialog tab"      HVACHtPump:ShowPerfDetails =     ; SAC 09/21/21
      {  if (Type == 33) then  1  else  0  endif  }
   "Set HVACHtPump:PerfDetailsMsgs[1]"    HVACHtPump:PerfDetailsMsgs[1] =
      {  switch (ShowPerfDetails)
            case  1 :  "(enter details on 'Performance Details Data' tab)"
            default :  UNDEFINED  endswitch  }
   "Set HVACHtPump:PerfDetailsMsgs[2]"    HVACHtPump:PerfDetailsMsgs[2] =
      {  switch (ShowPerfDetails)
            case  1 :  UNDEFINED
            default :  "Performance Data entered on first tab"  endswitch  }

; SAC 1/8/16 - added code vintage-specific values for SEER input range check warning
; SAC 1/13/16 - removed check for heat pumps, since this requirement is NOT based on INSTALLED DATE (which is the focus of the CEC request to add it)
;	"Set HVACHtPump:MinSEER_1501"		HVACHtPump:MinSEER_1501		= {	if (IsAvailable < 0.5 .OR. Proj:StandardsVersion < 2015) then  UNDEFINED
;																							else if (Type ==  4 .OR.	; "SplitHeatPump - Central split heat pump"
;																										Type ==  5 .OR.	; "PkgHeatPump - Central packaged heat pump"
;																										Type == 10 .OR.	; "DuctlessHeatPump - Ductless mini-split heat pump"
;																										Type == 11 .OR.	; "AirToWaterHeatPump - Air to water heat pump (able to heat DHW)"
;																										Type == 12 )		; "GroundSourceHeatPump - Ground source heat pump (able to heat DHW)"
;																							then	T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )
;																							else	UNDEFINED  endif endif  }

	"Set HVACHtPump:FloorAreaServed"			HVACHtPump:FloorAreaServed 	= {  SumRevRef( HVACSys:HtPumpSystem,    HVACSys:HtPmpFlrAreaServed )  }	; SAC 12/23/13

	"Default HVACHtPump:RefrigChgAdjFctr"	HVACHtPump:RefrigChgAdjFctr	= {	UNDEFINED  }

   "Default HVACHtPump:ClSizingFactor"		HVACHtPump:ClSizingFactor		= {	1.2  }      ; SAC 02/25/22

	"Set HVACHtPump:ShowMultiSpeed"			HVACHtPump:ShowMultiSpeed		= {	if (Type < 1 .OR. IsAvailable < 0.5) then  0
																										else  T24RCoolingEquipment:ShowMultSpd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  endif  }
	"Default HVACHtPump:IsMultiSpeed"		HVACHtPump:IsMultiSpeed			= {	0  }

	"Set HVACHtPump:ShowIsZonal"		HVACHtPump:ShowIsZonal	= {	if (CountRefs( HVACSys:HtPumpSystem, HVACSys:NumHtPumpSystemTypes ) < 1) then  0
																						else if (SumRevRef( HVACSys:HtPumpSystem, HVACSys:HtPumpDucted ) < 1) then  0  else	1  endif endif  }		; SAC 11/19/15 - CoolDucted -> HtPumpDucted
	"Default HVACHtPump:IsZonal"		HVACHtPump:IsZonal		= {	0  }
;	"debug HVACHtPump"			HVACHtPump:Action = { if (FloorAreaServed > 0.5) then PostWarning( "Default HVACHtPump  Name:  '%s'  Type: %g  TypeAbbrevStr: '%s'",  Name, Type, TypeAbbrevStr ) else UNCHANGED endif  }

   "Init HVACHtPump:VCHPFanPower"   HVACHtPump:VCHPFanPower = {  UNDEFINED  }
END

;*************************************************************************
RULELIST "Default_HVACCool" 0 0 0 0
;*************************************************************************
	"Set HVACCool:TypeAbbrev"				HVACCool:TypeAbbrev  		= {  Local( Type )  }
	"Set HVACCool:TypeAbbrevStr"			HVACCool:TypeAbbrevStr 		= {  EnumString( TypeAbbrev )  }
	"Set HVACCool:IsAvailable"				HVACCool:IsAvailable 		= {  T24RCoolingEquipment:SysAvail( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }
  ; SAC 5/13/13
;	"Default HVACCool:Ducted"				HVACCool:Ducted				= {	if (Type < 1 .OR. IsAvailable < 0.5) then  0
;																								else if (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) == 1) then  1
;																								else  0  endif endif  }
;	"Default HVACCool:DuctedEditable"	HVACCool:DuctedEditable		= {	if (Type < 1 .OR. IsAvailable < 0.5) then  0
;																								else if (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) < 0) then  1
;																								else  0  endif endif  }

;	"Set HVACCool:FloorAreaServed"		HVACCool:FloorAreaServed	= {  SumRevRef( HVACSys:CoolSystem,    HVACSys:FloorAreaServed )  }
	"Set HVACCool:FloorAreaServed"		HVACCool:FloorAreaServed	= {  SumRevRef( HVACSys:CoolSystem,    HVACSys:ClFlrAreaServed )  }		; SAC 12/23/13

;	"Set HVACCool:NumStoriesServed"		HVACCool:NumStoriesServed  = {  SumRevRef( HVACSys:CoolSystem,    HVACSys:NumStoriesServed )  }
;   "Default DisplayHPData flag"			HVACCool:DisplayHPData		= {	0  }
;   "Default HVACCool:ConstClgSetpt"		HVACCool:ConstClgSetpt		= {	UNDEFINED  }

   "Default HVACCool:AutoSize"			HVACCool:AutoSize				= {	MinRevRef( HVACSys:CoolSystem, HVACSys:AutoSizeCool, HVACSys:NumCoolSystemTypes )  }
   "Default HVACCool:AutoSize - 2"		HVACCool:AutoSize				= {	if (LocalStatus( AutoSize ) < 1) then  1  else  UNCHANGED  endif  }

   "Default HVACCool:SizingFactor"		HVACCool:SizingFactor		= {	1.2  }      ; SAC 02/25/22
  ; SAC 3/4/13
	"Default HVACCool:RefrigChgAdjFctr"		HVACCool:RefrigChgAdjFctr	= {	UNDEFINED  }

	"Set HVACCool:ShowMultiSpeed"			HVACCool:ShowMultiSpeed		= {	if (Type < 1 .OR. IsAvailable < 0.5) then  0
																								else  T24RCoolingEquipment:ShowMultSpd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  endif  }
	"Default HVACCool:IsMultiSpeed"		HVACCool:IsMultiSpeed		= {	0  }

;	mjb - moved from HVAC:Dist 	8/21/13
;	"Set HVACCool:ShowIsZonal"		HVACCool:ShowIsZonal		= {	if (HVACCool:Ducted < 1) then  0  else	1  endif  }
	"Set HVACCool:ShowIsZonal"		HVACCool:ShowIsZonal		= {	if (CountRefs( HVACSys:CoolSystem, HVACSys:NumCoolSystemTypes ) < 1) then  0
																					else if (SumRevRef( HVACSys:CoolSystem, HVACSys:CoolDucted ) < 1) then  0  else	1  endif endif  }
	"Default HVACCool:IsZonal"		HVACCool:IsZonal		= {	0  }

	"Set HVACCool:ShowEER"			HVACCool:ShowEER		=              ; SAC 6/20/20 - replaced Type value checks w/ EERValid look-up (tic #1225)
      {  if (IsAvailable > 0 .AND. T24RCoolingEquipment:EERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ))
         then  1  else  0  endif  }	; SAC 1/7/16
	"Set HVACCool:ShowSEER"			HVACCool:ShowSEER		=              ; SAC 6/20/20 - replaced Type value checks w/ SEERValid look-up (tic #1225)
      {  if (ShowEER > 0 .AND. T24RCoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ))
         then  1  else  0  endif  }
	"Set HVACCool:ShowCEER"			HVACCool:ShowCEER		=              ; SAC 08/19/20 (tic #1003)
      {  if (T24RCoolingEquipment:CEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ))
         then  1  else  0  endif  }
	"Set HVACCool:MinCEER"			HVACCool:MinCEER		=              ; SAC 08/19/20 (tic #1003)
      {  if (ShowCEER == 0) then  UNDEFINED
         else  T24RCoolingEquipment:CEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  endif  }

; SAC 1/8/16 - added code vintage-specific values for SEER & EER input range check warnings
; SAC 1/13/16 - REMOVED these checks for DuctlessSplitAirCond (based on CEC request)
; SAC 1/13/16 - Hard coded spilt EER check value to 12.2, since anything less than that MAY violate DOE requirements based on equipment size
	"Set HVACCool:MinSEER_Split1501"		HVACCool:MinSEER_Split1501		= {	if (ShowSEER < 0.5 .OR. Proj:StandardsVersion < 2015) then  UNDEFINED
																									else if (Type ==  2) ; .OR.	; "SplitAirCond - Split air conditioning system"
																												; Type == 16)			; "DuctlessSplitAirCond - Ductless mini-split and multi-split heat A/C"
																									then	T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )
																									else	UNDEFINED  endif endif  }
	"Set HVACCool:MinSEER_Pckg1501"		HVACCool:MinSEER_Pckg1501		= {	if (ShowSEER < 0.5 .OR. Proj:StandardsVersion < 2015) then  UNDEFINED
																									else if (Type ==  3)			; "PkgAirCond - Central packaged A/C system (< 65 kBtuh)"
																									then	T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )
																									else	UNDEFINED  endif endif  }
	"Set HVACCool:MinEER_Split1501"		HVACCool:MinEER_Split1501		= {	if (ShowEER < 0.5 .OR. Proj:StandardsVersion < 2015 .OR. IfValidAnd( UseEERInAnalysis > 0.5 )==0) then  UNDEFINED
																									else if (Type ==  2) ; .OR.	; "SplitAirCond - Split air conditioning system"
																												; Type == 16)			; "DuctlessSplitAirCond - Ductless mini-split and multi-split heat A/C"
																									then	12.2  ; T24RCoolingEquipment:EER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )
																									else	UNDEFINED  endif endif  }
	"Set HVACCool:MinEER_Pckg1501"		HVACCool:MinEER_Pckg1501		= {	if (ShowEER < 0.5 .OR. Proj:StandardsVersion < 2015 .OR. IfValidAnd( UseEERInAnalysis > 0.5 )==0) then  UNDEFINED
																									else if (Type ==  3)			; "PkgAirCond - Central packaged A/C system (< 65 kBtuh)"
																									then	T24RCoolingEquipment:EER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )
																									else	UNDEFINED  endif endif  }
END


;*************************************************************************
RULELIST "Default_PreCooling" 0 0 0 0
;*************************************************************************
  ; SAC 8/1/17 - re-enable pre-cooling following 2019.0.4 release
  ; ; SAC 6/14/17 - toggled OFF Precooling access for 2019.0.4 release
  ; "Force Proj:UsePreCooling off for 2019.0.4 release"   Proj:Action  = {
  ;       if (IfValidAnd( EnergyCodeYearNum >= 2019 )==0 .OR.
  ;           IfValidAnd( UsePreCooling > 0 )==0) then  UNCHANGED
  ;       else   EvalRulelist( "ForceDefault_UsePreCooling" )  endif  }
; PreCooling properties - SAC 4/3/17  - updated 4/7/17
   "Default Proj:UsePreCooling"        Proj:UsePreCooling      = {
         if (IfValidAnd( EnergyCodeYearNum >= 2019 )==0) then  UNDEFINED
         else   0  endif  }
   "Force Precooling OFF for 2022 releases, until updated for 2022 tstats & TDV"  Proj:Action =
      {  if (IfValidAnd( UsePreCooling > 0 )==0 .OR.
             IfValidAnd( EnergyCodeYearNum < 2022 ) .OR.
             EnableResearchMode > 0) then  UNCHANGED
         else  EvalRulelist( "ForceDefault_UsePreCooling" )  endif  }
   "Default Proj:PreCl_TDVThreshold"   Proj:PreCl_TDVThreshold = {
         if (IfValidAnd( EnergyCodeYearNum >= 2019 )==0 .OR.
             IfValidAnd( UsePreCooling     >     0 )==0) then  UNDEFINED
         else  10  endif  }
   "Default Proj:PreCl_PCsetTstat"     Proj:PreCl_PCsetTstat   = {
         if (IfValidAnd( EnergyCodeYearNum >= 2019 )==0 .OR.
             IfValidAnd( UsePreCooling     >     0 )==0) then  UNDEFINED
         else  "MAX(78-0.25*(@Weather.taDbpk-82),73)   // Cooling setpoint down to 73 with peak taDB > 101"
         endif  }
      ;   else  "MAX(((78-(@Weather.taDbAvg-78)/2)),73)   // Cooling setpoint down to 73 on hottest days"  - previous version implemented 4/3/17
   "Default Proj:PreCl_ZnCoolSetpt"    Proj:PreCl_ZnCoolSetpt  =     ; updated Precl setpt to 2022 tstat schedules - SAC 04/25/22
      {  if (IfValidAnd( EnergyCodeYearNum >= 2019 )==0 .OR.
             IfValidAnd( UsePreCooling     >     0 )==0) then  UNDEFINED
         else  if (IfValidAnd( EnergyCodeYearNum = 2019 ))
               then  "select( $dsDay==1, 83, $dsDay==2, 78, @Weather.tdvElecAvg>10&&@Weather.tdvElec<25&&@Weather.taDbAvg>78&&$hour>6, PCset, default hourval(78,78,78,78,78,78,78,83,83,83,83,83,83,82,81,80,79,78,78,78,78,78,78,78))"
               else  "select( $dsDay==1, 83, $dsDay==2, 75, @Weather.tdvElecAvg>10&&@Weather.tdvElec<25&&@Weather.taDbAvg>78&&$hour>6, PCset, default 78 )"
               endif
         endif  }
      ;   else  "select( $dsDay==1, 83, $dsDay==2, 78, @Weather.tdvElecAvg>10&&@Weather.taDbAvg>78&&$hour<18&&$hour>7, PCset, default hourval(78,78,78,78,78,78,78,83,83,83,83,83,83,82,81,80,79,78,78,78,78,78,78,78))"  - previous version implemented 4/3/17

   "Set Proj:PreCl_DataMsg"      Proj:PreCl_DataMsg      = {
         if (IfValidAnd( UsePreCooling > 0 )==0) then  UNDEFINED
         else if (IfValidAnd( EnergyCodeYearNum >= 2019 )==0)
         then  "PreCooling implemented only for 2019 (and later) code vintages" 
         else if ( (Proj:IsMultiFamily > 0.5 .AND. SumAcrossIf( DwellUnitType:HaveCooling, DwellUnitType:AssignedDUFlrArea > 1 ) < 1) .OR.
                   (Proj:IsMultiFamily < 0.5 .AND. SumAcrossIf( HVACSys:HaveCooling,       HVACSys:FloorAreaServed[1]      > 1 ) < 1) )
         then  "Mechanical cooling equipment must exist in model to use PreCooling" 
         else if (IfValidAnd( PreCl_TDVThreshold > 0 )==0)
         then  "PreCooling Average Hourly TDV Threshold (Proj:PreCl_TDVThreshold) must be > 0" 
         else if (strlen( PreCl_PCsetTstat ) < 1)
         then  "Cooling Setpoint for Precool hours (Proj:PreCl_PCsetTstat) expression must be defined"
         else if (strlen( PreCl_ZnCoolSetpt ) < 1)
         then  "Cooling Setpoint (Proj:PreCl_ZnCoolSetpt) expression must be defined"
         else  UNDEFINED  endif endif endif endif endif endif  }
   "Set Proj:PreCl_DataValid"    Proj:PreCl_DataValid    = {
         if (IfValidAnd( UsePreCooling > 0 ) .AND. LocalStatus( PreCl_DataMsg ) < 1)
         then  1  else  0  endif  }
END


; SAC 3/10/14 - added rulelists designed to setup and default SCSysRpt reporting objects
  ; mjb  4/21/14 - "Mech1" replaced with "SCSysRpt" in data model
;*************************************************************************
RULELIST "Setup_SCSysReportingObjects" 1 0 1 0
;*************************************************************************
	"Delete all SCSysRpt objects currently in building description"									Proj:Action		= {	DeleteAllComps( SCSysRpt )  }
	"Create new SCSysRpt objects and populate w/ initial object references & indexes/counts"	Proj:Action		= {	CreateSCSysRptObjects()  }
	"Evaluate rules to summarize building model for reporting purposes"		Proj:Action	= {	EvalRulelist( "Reporting_SummarizeModel" )  }
	"Default SCSysRpt properties - general"		SCSysRpt:Action	= {	EvalRulelist( "Default_SCSysReportObject", 1 )  }
;	"Default SCSysRpt properties - general"		SCSysRpt:Action	= {	if (ParentComponentType() == "HVACSys" .OR. ParentComponentType() == "DwellUnit")
;																								then  EvalRulelist( "Default_SCSysReportObject", 1 )
;																								else	UNCHANGED  endif  }

;	"debug RefCounts"		Proj:Action	= {	MessageBox( "Run Number %g - SCSysRpt equipment counts:\n   %g  Heating\n   %g  Cooling\n   %g  Heat Pumps", ValidOr( RunNumber, -1 ),
;																SumAll( SCSysRpt:RefCountByType[1] ), SumAll( SCSysRpt:RefCountByType[2] ), SumAll( SCSysRpt:RefCountByType[3] ) )  }
END

; SAC 11/14/14 - revised for new SCSysRpt structure/data model
;;*************************************************************************
;RULELIST "Default_SCSysReportObject" 0 0 0 0
;;*************************************************************************
;	"Default SCSysRpt properties - general"		SCSysRpt:Action	= {	     if (ParentComponentType() == "HVACSys"  ) then  EvalRulelist( "Default_SCSysReportObject_HVACSysParent", 1 )
;																								else if (ParentComponentType() == "DwellUnit") then  EvalRulelist( "Default_SCSysReportObject_DwellUnitParent", 1 )
;																								else	UNCHANGED  endif endif  }
;
;	"Default SCSysRpt properties - heating"		SCSysRpt:Action	= {	if (SCSysTypeVal == 2 .AND. LocalCompAssigned( HtPumpSystem ))
;																								then	EvalRulelist( "Default_SCSysReportObject_HtPump", 1 )
;																								else if (SCSysTypeVal != 2 .AND. LocalCompAssigned( HeatSystem ))
;																								then	EvalRulelist( "Default_SCSysReportObject_Heat"  , 1 )
;																								else  UNCHANGED  endif endif  }
;	"Default SCSysRpt properties - cooling"		SCSysRpt:Action	= {	if (SCSysTypeVal != 2 .AND. LocalCompAssigned( CoolSystem ))
;																								then	EvalRulelist( "Default_SCSysReportObject_Cool"  , 1 )
;																								else  UNCHANGED  endif  }
;
;;	"debug SCSysRpt"			SCSysRpt:Action = { PostWarning( "Assign HERSAirFltrRptMsg  DistribSystem:HERSCheck:AirFltrRptMsg: '%s'",  DistribSystem:HERSCheck:AirFltrRptMsg )  }
;END

;*************************************************************************
; SAC 11/14/14 - revised for new SCSysRpt structure/data model
RULELIST "Default_SCSysReportObject" 0 0 0 0
;RULELIST "Default_SCSysReportObject_HVACSysParent" 0 0 0 0
;*************************************************************************
;	"Default SCSysRpt:SCSysType"		SCSysRpt:SCSysType		= {	Parent( TypeAbbrevStr )  }
;	"Default SCSysRpt:SCSysName"		SCSysRpt:SCSysName		= {	if (Parent( Type ) == 2 .AND. LocalCompAssigned( HtPumpSystem ))
;																							then	Format( "Space Conditioning Unit (%g/%g)", HtPumpSysUnitTypeIdx, HtPumpSysUnitTypeCnt )
;																						else if (Parent( Type ) != 2 .AND. LocalCompAssigned( HeatSystem ))
;																							then	Format( "Space Conditioning Unit (%.0f/%.0f)", HeatSysUnitTypeIdx, HeatSysUnitTypeCnt )
;																						else  UNCHANGED  endif endif }
;	"Set SCSysRpt:SCSysTypeVal"		SCSysRpt:SCSysTypeVal	= {	Parent( Type )  }
;	"Default SCSysRpt:DwellingUnit"	SCSysRpt:DwellingUnit	= {	if (Parent( Type ) == 2 .AND. LocalCompAssigned( HtPumpSystem ))
;																							then	Format( "Dwelling Unit %.0f/%.0f", HtPumpSysUnitTypeIdx, HtPumpSysUnitTypeCnt )
;																						else if (Parent( Type ) != 2 .AND. LocalCompAssigned( HeatSystem ))
;																							then	Format( "Dwelling Unit %.0f/%.0f", HeatSysUnitTypeIdx, HeatSysUnitTypeCnt )
;																						else  UNCHANGED  endif endif }

	"Default SCSysRpt:FanType"			SCSysRpt:FanType			= {	if (LocalCompAssigned( HVACFanRef  ) < 1) then  UNDEFINED
																						else	if (LocalStatus( HVACFanRef:TypeAbbrevStr  ) < 1 ) then UNDEFINED else HVACFanRef:TypeAbbrevStr  endif endif  }
	"Default SCSysRpt:DistribType"	SCSysRpt:DistribType		= {	if (LocalCompAssigned( HVACDistRef ) < 1) then  UNDEFINED
																						else	if (LocalStatus( HVACDistRef:TypeAbbrevStr ) < 1 ) then UNDEFINED else HVACDistRef:TypeAbbrevStr endif  endif	}

	"Default SCSysRpt:DistribType"	SCSysRpt:DistribType		= {	if (LocalCompAssigned( HVACDistRef ) < 1) then  UNDEFINED
																						else	if (LocalStatus( HVACDistRef:TypeAbbrevStr ) < 1 ) then UNDEFINED else HVACDistRef:TypeAbbrevStr endif  endif	}
	; SAC 6/21/16 - ReferenceCount added to provide count of these equipment combinations locally (tic #
	;"Set SCSysRpt:ReferenceCount"		SCSysRpt:ReferenceCount		= {	if (Proj:IsMultiFamily > 0.5)
	;																						then	SumRevRef( DwellUnitType:SCSysRptRef, DwellUnitType:SCSysRptDUCount )
	"Set SCSysRpt:ReferenceCount"		SCSysRpt:ReferenceCount		= {	if (ParentComponentType() == "DwellUnit")
																							then	ValidOr( DUEquipCnt, 1 )
																							else	SumRevRef(       HVACSys:SCSysRptRef,       HVACSys:SCSysRptCount )
																							endif  }

	; SAC 4/30/15 - to be set via direct assignment of HVACDist:Type (issue 517)
	"Set SCSysRpt:DuctLocationRpt"	SCSysRpt:DuctLocationRpt	= {	if (LocalCompAssigned( HVACDistRef ) < 1) then  8
																							else	if (LocalStatus( HVACDistRef:Type ) < 1 ) then  8  else  HVACDistRef:Type  endif endif	}

	"Default SCSysRpt:LLAHUStatus"			SCSysRpt:LLAHUStatus			= {	if (IfValidAnd( HVACDistRef:LowLkgAH > 0.5 )) then "Has Low Leakage Air Handler" else "None" endif }
	"Default SCSysRpt:BypassDuctStatus"		SCSysRpt:BypassDuctStatus	= {	if (IfValidAnd( HVACDistRef:HasBypassDuct > 0.5 )) then "Has Bypass Duct" else "None" endif  }
	"Default SCSysRpt:LLAHUStatus"			SCSysRpt:LLAHUStatus			= {	if (IfValidAnd( HVACDistRef:LowLkgAH > 0.5 )) then "Has Low Leakage Air Handler" else "None" endif }
	"Default SCSysRpt:BypassDuctStatus"		SCSysRpt:BypassDuctStatus	= {	if (IfValidAnd( HVACDistRef:HasBypassDuct > 0.5 )) then "Has Bypass Duct" else "None" endif  }

	"Default SCSysRpt:MinDistribInsRval"	SCSysRpt:MinDistribInsRval	= {	if (IfValidAnd( HVACDistRef:DuctInsRvalue >= 0 )) then HVACDistRef:DuctInsRvalue else UNDEFINED endif  }

;	"debug"		SCSysRpt:Action	= {	MessageBox( "SCSysRpt -- DistribSystem:HERSCheck:DuctLocation: %g", DistribSystem:HERSCheck:DuctLocation )  }

	"Assign HERSDuctLeakage"			SCSysRpt:HERSDuctLeakage 		= {	ValidOr( HVACDistRef:HERSCheck:DuctLeakage, -1 )  }
	"Assign HERSDuctLkgRptMsg"			SCSysRpt:HERSDuctLkgRptMsg 	= {	if (IfValidAnd( HERSDuctLeakage > 0.5 )) then  HVACDistRef:HERSCheck:DuctLkgRptMsg  else  "none"  endif  }
	"Assign HERSDuctLocation"			SCSysRpt:HERSDuctLocation 		= {	ValidOr( HVACDistRef:HERSCheck:DuctLocation, -1 )  }
	"Assign HERSDuctLocRptMsg"			SCSysRpt:HERSDuctLocRptMsg 	= {	if (IfValidAnd( HERSDuctLocation > -1 )) then  EnumString( HVACDistRef:HERSCheck:DuctLocRptMsg )  else  "none"  endif  }
;	; SAC 6/27/16 - added custom messages for certain selections (tic #627)
;	"Assign HERSDuctLocRptMsg"			SCSysRpt:HERSDuctLocRptMsg 	= {	if (IfValidAnd( HERSDuctLocation > -1 )) then  ;  EnumString( HVACDistRef:HERSCheck:DuctLocRptMsg )  else  "none"  endif  }
;																									switch ( HVACDistRef:HERSCheck:DuctLocRptMsg )
;																										case  7 : "Ducts located entirely in conditioned space confirmed by duct leakage testing"
;																										case 12 : "Verified low-leakage ducts in conditioned space must meet maximum 25 cfm leakage to outside (RA3.1.4.3.8)"
;																										default :  EnumString( HVACDistRef:HERSCheck:DuctLocRptMsg )
;																									endswitch
;																								else  "none"  endif  }
	"Assign HERSRetDuctDesign"			SCSysRpt:HERSRetDuctDesign 	= {	ValidOr( HVACDistRef:HERSCheck:RetDuctDesign, -1 )  }
	"Assign HERSRetDuctRptMsg"			SCSysRpt:HERSRetDuctRptMsg 	= {	if (IfValidAnd( HERSRetDuctDesign > 0.5 )) then  HVACDistRef:HERSCheck:RetDuctRptMsg  else  "none"  endif  }
	"Assign HERSSupDuctDesign"			SCSysRpt:HERSSupDuctDesign 	= {	ValidOr( HVACDistRef:HERSCheck:SupDuctDesign, -1 )  }
	"Assign HERSSupDuctRptMsg"			SCSysRpt:HERSSupDuctRptMsg 	= {	if (IfValidAnd( HERSSupDuctDesign > 0.5 )) then  HVACDistRef:HERSCheck:SupDuctRptMsg  else  "none"  endif  }
;	"Assign HERSAirFilterDesign"		SCSysRpt:HERSAirFilterDesign 	= {	ValidOr( HVACDistRef:HERSCheck:AirFilterDesign, -1 )  }
;	"Assign HERSAirFltrRptMsg"			SCSysRpt:HERSAirFltrRptMsg 	= {	if (IfValidAnd( HERSAirFilterDesign > 0.5 )) then  HVACDistRef:HERSCheck:AirFltrRptMsg  else  "none"  endif  }
	"Assign HERSFanEff"					SCSysRpt:HERSFanEff 				= {	ValidOr( HVACFanRef:HERSCheck:AHUFanEff, -1 )  }
	"Assign HERSFanEffRptMsg"			SCSysRpt:HERSFanEffRptMsg	 	= {	if (IfValidAnd( HERSFanEff > 0.5 )) then  HVACFanRef:HERSCheck:FanEffRptMsg  else  "none"  endif  }

	"Default SCSysRpt properties - heating"		SCSysRpt:Action	= {	if (SCSysTypeVal == 2 .AND. LocalCompAssigned( HtPumpSystem ))
																								then	EvalRulelist( "Default_SCSysReportObject_HtPump", 1 )
																								else if (SCSysTypeVal != 2 .AND. LocalCompAssigned( HeatSystem ))
																								then	EvalRulelist( "Default_SCSysReportObject_Heat"  , 1 )
																								else  UNCHANGED  endif endif  }
	"Default SCSysRpt properties - cooling"		SCSysRpt:Action	= {	if (SCSysTypeVal != 2 .AND. LocalCompAssigned( CoolSystem ))
																								then	EvalRulelist( "Default_SCSysReportObject_Cool"  , 1 )
																								else  UNCHANGED  endif  }

;	"debug SCSysRpt"			SCSysRpt:Action = { PostWarning( "Assign HERSAirFltrRptMsg  DistribSystem:HERSCheck:AirFltrRptMsg: '%s'",  DistribSystem:HERSCheck:AirFltrRptMsg )  }
END

;*************************************************************************
RULELIST "Default_SCSysReportObject_HtPump" 0 0 0 0
;*************************************************************************
	"Set SCSysRpt:RefCountByType[3]-HtPump"	SCSysRpt:RefCountByType[3]	= {	ReferenceCount  }
	"Default SCSysRpt:HeatingType"				SCSysRpt:HeatingType			= {	HtPumpSystem:TypeAbbrevStr  }
;	"Default SCSysRpt:HeatSysName"				SCSysRpt:HeatSysName			= {	Format( "%s (%.0f/%.0f)", HtPumpSystem:Name, HtPumpSysUnitTypeIdx, HtPumpSysUnitTypeCnt )  }
	"Default SCSysRpt:CoolingType"				SCSysRpt:CoolingType			= {	if ( LocalStatus(HeatingType) < 1 ) then UNDEFINED else HeatingType endif  }
	"Default SCSysRpt:CoolSysName"				SCSysRpt:CoolSysName			= {	if ( LocalStatus(HeatSysName) < 1 ) then UNDEFINED else HeatSysName endif  }
	"Default SCSysRpt:TStatType"					SCSysRpt:TStatType			= {	"Constant Heating"  }
	"Default SCSysRpt:ZonalCoolingType"			SCSysRpt:ZonalCoolingType	= {	if (IfValidAnd( HtPumpSystem:IsZonal > 0.5 )) then "Zonally Controlled" else "Not Zonal" endif  }
	"Default SCSysRpt:CoolCompType"				SCSysRpt:CoolCompType		= {	if (IfValidAnd( HtPumpSystem:IsMultiSpeed > 0.5 )) then "Multi-speed" else "Single Speed" endif   }
	"Default SCSysRpt:MinHeatEffic"				SCSysRpt:HeatEfficType		= {	if (IfValidAnd( HtPumpSystem:IsAvailable > 0 ) .AND. IfValidAnd( HtPumpSystem:Show4717COPs > 0 ) .AND. IfValidAnd( HtPumpSystem:ShowHSPF < 1 ))
																										then	"COP"
																										else	"HSPF"  endif  }
	"Default SCSysRpt:MinHeatEffic"				SCSysRpt:MinHeatEffic		= {	if (IfValidAnd( HtPumpSystem:IsAvailable > 0 ) .AND. IfValidAnd( HtPumpSystem:Show4717COPs > 0 ) .AND. IfValidAnd( HtPumpSystem:ShowHSPF < 1 ))
																										then	if ( LocalStatus(HtPumpSystem:COP47) < 1 ) then UNDEFINED else HtPumpSystem:COP47 endif
																										else	if ( LocalStatus(HtPumpSystem:HSPF ) < 1 ) then UNDEFINED else HtPumpSystem:HSPF  endif   endif  }
	"Default SCSysRpt:MinCoolEER"					SCSysRpt:MinCoolEER			= {	if ( LocalStatus(HtPumpSystem:EER) < 1 ) then UNDEFINED else HtPumpSystem:EER endif  }
	"Default SCSysRpt:MinCoolSEER"				SCSysRpt:MinCoolSEER			= {	if ( LocalStatus(HtPumpSystem:SEER) < 1 ) then UNDEFINED else HtPumpSystem:SEER endif  }
	"Default SCSysRpt:HtPumpCap17"				SCSysRpt:HtPumpCap17			= {	if ( LocalStatus(HtPumpSystem:Cap17) < 1 ) then UNDEFINED else HtPumpSystem:Cap17 endif  }
	"Default SCSysRpt:HtPumpCap47"				SCSysRpt:HtPumpCap47			= {	if ( LocalStatus(HtPumpSystem:Cap47) < 1 ) then UNDEFINED else HtPumpSystem:Cap47 endif  }
	"Default SCSysRpt:MinCoolCFMperTon"			SCSysRpt:MinCoolCFMperTon	= {	if ( LocalStatus(HtPumpSystem:CFMperTon) < 1 ) then UNDEFINED else HtPumpSystem:CFMperTon endif  }
	"Assign HERSAHUAirFlow"							SCSysRpt:HERSAHUAirFlow 	= {	HtPumpSystem:HERSCheck:AHUAirFlow	}
	"Assign HERSAirFlowRptMsg"						SCSysRpt:HERSAirFlowRptMsg = {	if (IfValidAnd( HERSAHUAirFlow > 0.5 )) then 
																										HtPumpSystem:HERSCheck:AirFlowRptMsg
																										else "none" endif	}
	"Assign HERSSEER"									SCSysRpt:HERSSEER 			= {	HtPumpSystem:HERSCheck:SEER	}
	"Assign HERSSEERRptMsg"							SCSysRpt:HERSSEERRptMsg 	= {	if (IfValidAnd( HERSSEER > 0.5 )) then
																										HtPumpSystem:HERSCheck:SEERRptMsg
																										else "none" endif	}
	"Assign HERSEER"									SCSysRpt:HERSEER 				= {	HtPumpSystem:HERSCheck:EER	}
	"Assign HERSEERRptMsg"							SCSysRpt:HERSEERRptMsg 		= {	if (IfValidAnd( HERSEER > 0.5 )) then
																										HtPumpSystem:HERSCheck:EERRptMsg
																										else "none" endif	}
	"Assign HERSACCharg"								SCSysRpt:HERSACCharg 		= {	HtPumpSystem:HERSCheck:ACCharg	}
	"Assign HERSACChargRptMsg"						SCSysRpt:HERSACChargRptMsg = {	if (IfValidAnd( HERSACCharg > 0.5 )) then
																										EnumString( HtPumpSystem:HERSCheck:ACChargRptMsg ) 
																										else "none" endif	}
END

;*************************************************************************
RULELIST "Default_SCSysReportObject_Heat" 0 0 0 0
;*************************************************************************
	"Set SCSysRpt:RefCountByType[1]-Heat"	SCSysRpt:RefCountByType[1]	= {	ReferenceCount  }
	"Default SCSysRpt:HeatingType"			SCSysRpt:HeatingType			= {	if ( LocalStatus(HeatSystem:TypeAbbrevStr) < 1 ) then UNDEFINED else HeatSystem:TypeAbbrevStr endif	}
;	"Default SCSysRpt:HeatSysName"			SCSysRpt:HeatSysName			= {	Format( "%s (%.0f/%.0f)", HeatSystem:Name, HeatSysUnitTypeIdx, HeatSysUnitTypeCnt )  }
	"Default SCSysRpt:TStatType"				SCSysRpt:TStatType			= {	"Constant Heating"  }
   ; SAC 11/14/17 - revisions to report "3.413 HSPF" for Electric heating systems (tic #926)
   ; SAC 11/28/17 - revisions to report "3.413 HSPF" for ElecCombHydro heating systems (tic #910)
	"Default SCSysRpt:MinHeatEffic"		SCSysRpt:HeatEfficType	= {
         if (IfValidAnd( HeatSystem:TypeAbbrev =  8 ) .OR.  ; Electric
             IfValidAnd( HeatSystem:TypeAbbrev = 29 ))      ; ElecCombHydro
         then  "HSPF"
         else  "AFUE"  endif  }
	"Default SCSysRpt:MinHeatEffic"		SCSysRpt:MinHeatEffic	= {
         if (IfValidAnd( HeatSystem:TypeAbbrev =  8 ) .OR.  ; Electric
             IfValidAnd( HeatSystem:TypeAbbrev = 29 ))      ; ElecCombHydro
         then  3.413
         else if ( LocalStatus(HeatSystem:AFUE) < 1 )
         then  UNDEFINED
         else  HeatSystem:AFUE
         endif endif  }
;	"debug SCSysRpt"			SCSysRpt:Action = { PostWarning( "Default SCSysRpt:DistribType  '%s'",  DistribSystem:TypeAbbrevStr )  }
END

;*************************************************************************
RULELIST "Default_SCSysReportObject_Cool" 0 0 0 0
;*************************************************************************
	"Set SCSysRpt:RefCountByType[2]-Cool"	SCSysRpt:RefCountByType[2]		= {	ReferenceCount  }
	"Default SCSysRpt:CoolingType"			SCSysRpt:CoolingType				= {	CoolSystem:TypeAbbrevStr  }
;	"Default SCSysRpt:CoolSysName"			SCSysRpt:CoolSysName				= {	Format( "%s (%.0f/%.0f)", CoolSystem:Name, CoolSysUnitTypeIdx, CoolSysUnitTypeCnt )  }
	"Default SCSysRpt:ZonalCoolingType"		SCSysRpt:ZonalCoolingType		= {	if (IfValidAnd( CoolSystem:IsZonal > 0.5 )) then "Zonally Controlled" else "Not Zonal" endif  }
	"Default SCSysRpt:CoolCompType"			SCSysRpt:CoolCompType			= {	if (IfValidAnd( CoolSystem:IsMultiSpeed > 0.5 )) then "Multi-speed" else "Single Speed" endif   }
	"Default SCSysRpt:MinCoolEER"				SCSysRpt:MinCoolEER				= {	if ( LocalStatus(CoolSystem:EER) < 1 ) then UNDEFINED else CoolSystem:EER endif  }
	"Default SCSysRpt:MinCoolSEER"			SCSysRpt:MinCoolSEER				= {	if ( LocalStatus(CoolSystem:SEER) < 1 ) then UNDEFINED else CoolSystem:SEER endif  }
	"Default SCSysRpt:MinCoolCFMperTon"		SCSysRpt:MinCoolCFMperTon		= {	if ( LocalStatus(CoolSystem:CFMperTon) < 1 ) then UNDEFINED else CoolSystem:CFMperTon endif  }
	"Assign HERSAHUAirFlow"						SCSysRpt:HERSAHUAirFlow 		= {	CoolSystem:HERSCheck:AHUAirFlow	}
	"Assign HERSAirFlowRptMsg"					SCSysRpt:HERSAirFlowRptMsg 	= {	if (IfValidAnd( HERSAHUAirFlow > 0.5 )) then 
																										CoolSystem:HERSCheck:AirFlowRptMsg
																										else "none" endif	}
	"Assign HERSSEER"								SCSysRpt:HERSSEER 				= {	CoolSystem:HERSCheck:SEER	}
	"Assign HERSSEERRptMsg"						SCSysRpt:HERSSEERRptMsg 		= {	if (IfValidAnd( HERSSEER > 0.5 )) then
																										CoolSystem:HERSCheck:SEERRptMsg
																										else "none" endif	}
	"Assign HERSEER"								SCSysRpt:HERSEER 					= {	CoolSystem:HERSCheck:EER	}
	"Assign HERSEERRptMsg"						SCSysRpt:HERSEERRptMsg 			= {	if (IfValidAnd( HERSEER > 0.5 )) then
																										CoolSystem:HERSCheck:EERRptMsg
																										else "none" endif	}
	"Assign HERSACCharg"							SCSysRpt:HERSACCharg 			= {	CoolSystem:HERSCheck:ACCharg	}
	"Assign HERSACChargRptMsg"					SCSysRpt:HERSACChargRptMsg 	= {	if (IfValidAnd( HERSACCharg > 0.5 )) then
																										EnumString( CoolSystem:HERSCheck:ACChargRptMsg ) 
																										else "none" endif	}
;	"debug SCSysRpt"			SCSysRpt:Action = { PostWarning( "Assign HERSAHUAirFlow  %g",  CoolSystem:HERSCheck:AHUAirFlow )  }
;	"debug SCSysRpt"			SCSysRpt:Action = { PostWarning( "Assign HERSAirFlowRptMsg  CoolSystem:HERSCheck:AirFlowRptMsg: '%s'",  CoolSystem:HERSCheck:AirFlowRptMsg )  }
;	"debug SCSysRpt"			SCSysRpt:Action = { PostWarning( "Assign HERSSEERRptMsg  CoolSystem:HERSCheck:SEERRptMsg: '%s'",  CoolSystem:HERSCheck:SEERRptMsg )  }
;	"debug SCSysRpt"			SCSysRpt:Action = { PostWarning( "Assign HERSACChargRptMsg  CoolSystem:HERSCheck:ACChargRptMsg: '%s'",  CoolSystem:HERSCheck:ACChargRptMsg )  }
;	"debug SCSysRpt"			SCSysRpt:Action = { PostWarning( "Assign HERSEERRptMsg  CoolSystem:HERSCheck:EERRptMsg: '%s'",  CoolSystem:HERSCheck:EERRptMsg )  }
END

; mjb 3/24/14 - added rulelists designed to setup and default DHWSysRpt objects
;*************************************************************************
RULELIST "Setup_DHWSysReportingObjects" 1 0 1 0
;*************************************************************************
	"Delete all DHWSysRpt objects currently in building description"									Proj:Action		= {	DeleteAllComps( DHWSysRpt )  }
	"Create new DHWSysRpt objects and populate w/ initial object references & indexes/counts"	Proj:Action		= {	CreateDHWRptObjects()  }
	"Evaluate rules to summarize building model for reporting purposes"		Proj:Action	= {	EvalRulelist( "Reporting_SummarizeModel" )  }
	"Default DHWSysRpt properties - general"		DHWSysRpt:Action	= {	     if (ParentComponentType() == "DHWSys") then  EvalRulelist( "Default_DHWSysReportObject_DHWSysParent", 1 )
																								else if (ParentComponentType() == "DwellUnit" .AND. LocalCompAssigned( DHWSysRef )) then  EvalRulelist( "Default_DHWSysReportObject_DwellUnitParent", 1 )
																								else  UNCHANGED  endif endif  }
END

;*************************************************************************
RULELIST "Default_DHWSysReportObject_DHWSysParent" 0 0 0 0
;*************************************************************************
	"Default DHWSysRpt:DHWSysName"				DHWSysRpt:DHWSysName		= {	Format( "%s - %g/%g", Parent(Name), DHWHeaterIdx, DHWHeaterCnt ) }
	"Default DHWSysRpt:DwellingUnit"				DHWSysRpt:DwellingUnit	= {	Format( "Dwelling Unit served by %s", DHWSysName )  }
	"Default DHWSysRpt:DHWSysRef"					DHWSysRpt:DHWSysRef		= {	Parent( Name )  }
	"Default DHWSysRpt:Status"						DHWSysRpt:Status			= {	Parent( Status )  }		; SAC 12/14/15
	"Set remaining DHWSysRpt properties"		DHWSysRpt:Action			= {	EvalRulelist( "Default_DHWSysReportObject", 1 )  }
END
;*************************************************************************
RULELIST "Default_DHWSysReportObject_DwellUnitParent" 0 0 0 0
;*************************************************************************
	"Default DHWSysRpt:DHWSysName"				DHWSysRpt:DHWSysName		= {	Format( "%s - %g/%g", DHWSysRef:Name, DHWHeaterIdx, DHWHeaterCnt )  }
	"Default DHWSysRpt:DwellingUnit"				DHWSysRpt:DwellingUnit	= {	Parent( Name )  }
	"Default DHWSysRpt:DwellUnitRef"				DHWSysRpt:DwellUnitRef	= {	Parent( Name )  }   ; SAC 10/23/19 (tic #1159)
	"Default DHWSysRpt:Status"						DHWSysRpt:Status			= {	Parent2( DHWSys1Status )  }		; SAC 12/14/15
	"Set remaining DHWSysRpt properties"		DHWSysRpt:Action			= {	EvalRulelist( "Default_DHWSysReportObject", 1 )  }
END

;*************************************************************************
RULELIST "Default_DHWSysReportObject" 0 0 0 0
;*************************************************************************

	"Default DHWSysRpt:DHWSysType"				DHWSysRpt:DHWSysType		= {	if (IfValidAnd( DHWSysRef:IsHydronic > 0.5 )) then "Combined Hydronic" else "DHW" endif  }
   "Set DHWSysRpt:IsCentralHPWH"             DHWSysRpt:IsCentralHPWH =        ; SAC 2/20/20 (tic #1197)
      {  if (IfValidAnd( DHWSysRef:CentralDHW > 0 ) .AND.
             IfValidAnd( DHWSysRef:CentralDHWType = 2 ))
         then  1  else  0  endif  }
   "Set DHWSysRpt:DwellUnitTypeRef"          DHWSysRpt:DwellUnitTypeRef  =    ; SAC 2/20/20 (tic #1197)
      {  if (LocalCompAssigned( DwellUnitRef )) then  DwellUnitRef:DwellUnitTypeRef
         else  UNDEFINED  endif  }

   "Set DHWSysRpt:NonCntrlDHWHeaterCnt"      DHWSysRpt:NonCntrlDHWHeaterCnt  =      ; SAC 6/14/20 (tic #1185)
      {  if (IfValidAnd( DHWSysRef:CentralDHW > 0 )) then  0
         else  DHWHeaterCnt  endif  }

	"Default DHWSysRpt:DwellUnitDistType"		DHWSysRpt:DwellUnitDistType 	= {	if (IfValidAnd( DHWSysRef:SystemType > 0.5 )) then
																												EnumString( DHWSysRef:SystemType ) 
																											else "none" endif	}

	"Default DHWSysRpt:MFamDistType"				DHWSysRpt:MFamDistType	= {	if (IfValidAnd( DHWSysRef:CentralDHW > 0.5 )) then EnumString( DHWSysRef:MFamDistType ) else "None" endif	}
  ; SAC 2/20/20 - updated all following rules for IsCentralHPWH (tic #1197)
	; SAC 4/15/16 - switch check on HeaterElementType from > 0.5 to >= 0 to ensure that 'Electric Resistance' (=0) works properly
	"Default DHWSysRpt:HeaterElementType"		DHWSysRpt:HeaterElementType 	= {	if (IsCentralHPWH) then  "Heat Pump"
	                                                                              else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "HVACSys" ))
																											then	if (IfValidAnd( DHWHeaterRef:DHWHeaterElementType >= 0 ))
																													then	EnumString( DHWHeaterRef:DHWHeaterElementType ) 
																													else	"none"  endif
																											else	if (IfValidAnd( DHWHeaterRef:HeaterElementType >= 0 ))
																													then	EnumString( DHWHeaterRef:HeaterElementType ) 
																													else	"none"  endif  endif  endif  }
   ; SAC 6/19/18 - switch TankType range checks from > 0.5 to >= 0 (tic #871)
	"Default DHWSysRpt:TankType"					DHWSysRpt:TankType 	= {	if (IsCentralHPWH) then  "NA"
	                                                                     else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "HVACSys" ))
																								then	if (IfValidAnd( DHWHeaterRef:DHWTankType >= 0 ))
																										then	EnumString( DHWHeaterRef:DHWTankType ) 
																										else	"none"  endif
																								else	if (IfValidAnd( DHWHeaterRef:HeaterElementType = 5 )) then  "NA"
																										else if (IfValidAnd( DHWHeaterRef:TankType >= 0 ))
																										then	EnumString( DHWHeaterRef:TankType ) 
																										else	"none"  endif  endif  endif  endif  }
	"Default DHWSysRpt:InputRating"				DHWSysRpt:InputRating			= {	if (IsCentralHPWH) then  12000
	                                                                              else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "HVACSys" ))
																											then	if ( LocalStatus(DHWHeaterRef:DHWInputRating) < 1 ) then UNDEFINED else DHWHeaterRef:DHWInputRating endif
																											else	if ( LocalStatus(DHWHeaterRef:InputRating   ) < 1 ) then UNDEFINED else DHWHeaterRef:InputRating    endif  endif  endif  }
	"Default DHWSysRpt:InputRatingUnits"		DHWSysRpt:InputRatingUnits		= {	if (IsCentralHPWH) then  "watts"
	                                                                              else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "HVACSys" ))
																											then	switch (DHWHeaterRef:DHWHeaterElementType)
																														case  0 :	"watts"   ; "Electric Resistance" 
																														case  1 :   "Btu/hr"  ; "Natural Gas"   
																														case  2 :   "Btu/hr"  ; "Propane"             
																														case  3 :   "watts"   ; "Air-Source Heat Pump"           
																														case  6 :   "watts"   ; "Ground-Source Heat Pump"           
																														case  4 :   "Btu/hr"  ; "Oil"   
																														default :	" "
																													endswitch
																											else	if ( LocalStatus(DHWHeaterRef:InputRatingUnits) < 1 ) then "  "
																													else DHWHeaterRef:InputRatingUnits
																													endif
																											endif endif  }
   ; SAC 6/13/18 - revised logic to prevent reporting of InputRating for heaters where InputRating not user defined (tic #940)
   ; SAC 6/27/18 - another round of mods to ensure InputRating size RANGES listed for reference (tic #940)
	"Default DHWSysRpt:InputRatingRpt"			DHWSysRpt:InputRatingRpt		= {
      if (IsCentralHPWH) then  "NA"
	   else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "HVACSys" ))
		then	"<= 12 kW"     ; AWHP doesn't allow input of DHWInputRating
		else
		switch (DHWHeaterRef:HeaterElementType)
			case  0 :	      	; (watts)   "Electric Resistance" 
                     switch (DHWHeaterRef:HeaterType)
               			case  2 :    "> 12 kW"		; "Large Instantaneous" 
               			case  3 :            		; "Large Storage" 
               			           if (IfValidAnd( InputRating > 0 )) then  Format( "%s %s", FltToStr( InputRating ), InputRatingUnits )
               			           else  "> 12 kW"  endif
               			case  5 :    "<= 12 kW"		; "Small Instantaneous" 
               			case  6 :    "<= 12 kW"		; "Small Storage" 
               			case 10 :    "<= 12 kW"		; "Consumer Instantaneous (UEF)"             
               			case 11 :     "> 12 kW"		; "Commercial Instantaneous (TE)"            
               			case 12 :    "<= 12 kW"		; "Consumer Storage (UEF)" 
               			case 13 :            		; "Commercial Storage (TE & SBL)"            
               			           if (IfValidAnd( InputRating > 0 )) then  Format( "%s %s", FltToStr( InputRating ), InputRatingUnits )
               			           else  "> 12 kW"  endif
                        case 15 :     "> 12 kW to <= 58.6 kW"      ; "Residential-Duty Commercial Instantaneous (UEF)"
							   default :	 "<= 12 kW" 
							endswitch
			case  1 :   			; (Btu/hr)  "Natural Gas"   
                     switch (DHWHeaterRef:HeaterType)
                        case  0 :   "NA"      ; "Boiler"  
                        case  1 :   "NA"      ; "Indirect"  
                        case  2 :    "> 200 kBtu/hr"      ; "Large Instantaneous"  
                        case  3 :                         ; "Large Storage"  
               			           if (IfValidAnd( InputRating > 0 )) then  Format( "%s %s", FltToStr( InputRating ), InputRatingUnits )
               			           else  "> 75 kBtu/hr"  endif
                        case  9 :   "<= 200 kBtu/hr"	   ; "UEF-rated Instantaneous"
							   case  5 :   "<= 200 kBtu/hr"		; "Small Tankless"
               			case 10 :   "<= 200 kBtu/hr"		; "Consumer Instantaneous (UEF)"             
               			case 11 :    "> 200 kBtu/hr"		; "Commercial Instantaneous (TE)"            
               			case 12 :   "<= 75 kBtu/hr"		; "Consumer Storage (UEF)"                   
               			case 13 :                  		; "Commercial Storage (TE & SBL)"            
               			           if (IfValidAnd( InputRating > 0 )) then  Format( "%s %s", FltToStr( InputRating ), InputRatingUnits )
               			           else  "> 75 kBtu/hr"  endif
               			case 14 :    "> 75 kBtu/hr to <= 105 kBtu/hr"		; "Residential-Duty Commercial Storage (UEF)"
                        case 16 :   ">= 300 kBtu/hr to <= 2.5 MBtu/hr"     ; "Commercial Packaged Boiler"      ; SAC 12/19/19 - to facilitate new central gas std design DHW system (tic #862)
							   default :	"<= 75 kBtu/hr"		; "Small Storage"
							endswitch
			case  2 :   			; (Btu/hr)  "Propane"             
							if (DHWHeaterRef:HeaterType == 5) then  "<= 200 kBtu/hr"		; "Small Tankless"
							else	"<= 75 kBtu/hr"  endif							; "Small Storage"
			case  3 :    "<= 12 kW"   ; (watts)   "Heat Pump"           
			case  4 :   			; (Btu/hr)  "Oil"   
							if (DHWHeaterRef:HeaterType == 5) then  "<= 200 kBtu/hr"		; "Small Tankless"
							else	"<= 75 kBtu/hr"  endif							; "Small Storage"
			case  5 :    	      ; (watts)  "Heat Pump"
			            if (IfValidAnd( DHWHeaterRef:IsNEEAHtPumpWtrHtr > 0 )) then  "NA"
			            else  "<= 12 kW"  endif
			default :	UNDEFINED
		endswitch  endif endif  }
   ; SAC 7/5/17 - disable Efficiency reporting for NEEA-rated HPWHs (tic #805)
	"Default DHWSysRpt:Efficiency"				DHWSysRpt:Efficiency				= {	if (IsCentralHPWH) then  UNDEFINED
	                                                                              else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "HVACSys" ))
																											then	if ( LocalStatus(DHWHeaterRef:DHWEnergyFactor) < 1 ) then UNDEFINED else DHWHeaterRef:DHWEnergyFactor endif
																											else	if ( IfValidAnd( DHWHeaterRef:IsNEEAHtPumpWtrHtr > 0 ) .OR.
																													     LocalStatus(DHWHeaterRef:EnergyFactor) < 1 ) then UNDEFINED else DHWHeaterRef:EnergyFactor endif endif endif  }
	"Default DHWSysRpt:EfficiencyUnits"			DHWSysRpt:EfficiencyUnits		= {	if (IsCentralHPWH) then  "EF"
	                                                                              else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "HVACSys" ))
																											then	"EF"
																											else
																												if ( LocalStatus(DHWHeaterRef:EfficiencyUnits) < 1 ) then " " else DHWHeaterRef:EfficiencyUnits endif endif endif  }
	"Reset DHWSysRpt:EfficiencyUnits to 'effic.'"	DHWSysRpt:EfficiencyUnits	= {
	      if (IfValidAnd( EfficiencyUnits = "frac" ))
	      then  "effic."  else  UNCHANGED  endif  }    ; SAC 4/13/18 - tic #871
   ; SAC 7/5/17 - set EfficiencyRpt for NEEA-rated HPWHs to 'NEEA Rated' (tic #805)
	"Default DHWSysRpt:EfficiencyRpt"			DHWSysRpt:EfficiencyRpt			= {	if (IsCentralHPWH) then  "NEEA Rated"
	                                                                              else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "HVACSys" ))
																											then	if (LocalStatus( Efficiency ) < 1) then  " "
																													else	Format( "%g %s", Efficiency, EfficiencyUnits )  endif
																											else	if (IfValidAnd( DHWHeaterRef:HeaterElementType = 5 ) .AND.
																														 IfValidAnd( DHWHeaterRef:HPWH_NEEARated > 0.5 )) then  "NEEA Rated"
																													else if (LocalStatus( Efficiency ) < 1) then  " "
																													else	Format( "%g %s", Efficiency, EfficiencyUnits )  endif endif
																											endif endif  }

;"debug"	DHWSysRpt:Action	= {
;   if (Proj:RunNumber < 1 .OR. LocalCompAssigned( DHWHeaterRef ) == ComponentType( "HVACSys" ) .OR.
;       IfValidAnd( DHWHeaterRef:IsNEEAHtPumpWtrHtr > 0 )==0) then  UNCHANGED
;   else  MessageBox( "performing HPWHData_NEEA:TankVolume look-up - RunID: '%s' - HPWHModel: %g", Proj:RunID, DHWHeaterRef:HPWHModel )  endif  }
   ; SAC 7/5/17 - added table look-up for TankVolume of NEEA-rated HPWHs (tic #805)
	"Default DHWSysRpt:TankVolume"				DHWSysRpt:TankVolume				= {	if (IsCentralHPWH) then  ValidOr( DHWSysRef:CHPWHTotTankVol, 0 )
	                                                                              else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "HVACSys" ))
																											then	if ( LocalStatus(DHWHeaterRef:DHWTankVolume) < 1 ) then UNDEFINED else DHWHeaterRef:DHWTankVolume endif
																											else	if ( IfValidAnd( DHWHeaterRef:IsNEEAHtPumpWtrHtr > 0 ) )
																											      then  HPWHData_NEEA:TankVolume( "Model", DHWHeaterRef:HPWHModel )
																											      else if ( LocalStatus(DHWHeaterRef:TankVolume) < 1 ) then UNDEFINED else DHWHeaterRef:TankVolume endif endif	endif endif  }
	"Default DHWSysRpt:TankVolumeRpt"			DHWSysRpt:TankVolumeRpt			= {   if (LocalStatus( TankVolume ) < 1) then  " "
                                                                                 else	FltToStr( TankVolume )  endif  }
                                                                              ; SAC 8/17/17 - revised logic to report TankVolume for NEEA-rated HPWHs (revised when reviewing reporting for Com)
	                                                                           ;	if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "HVACSys" ))
																										;	then	if (LocalStatus( TankVolume ) < 1) then  " "
																										;			else	FltToStr( TankVolume )  endif
																										;	else	if (IfValidAnd( DHWHeaterRef:HeaterElementType = 5 ) .AND.
																										;				 IfValidAnd( DHWHeaterRef:HPWH_NEEARated > 0.5 )) then  "NA"
																										;			else if (LocalStatus( TankVolume ) < 1) then  " "
																										;			else	FltToStr( TankVolume )  endif endif
																										;	endif  }
   ; SAC 7/5/17 - disable ExtInsulRVal reporting for NEEA-rated HPWHs (tic #805)
	"Default DHWSysRpt:ExtInsulRVal"				DHWSysRpt:ExtInsulRVal			= {	if (IsCentralHPWH) then  UNDEFINED
	                                                                              else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "HVACSys" ))
																											then	if ( LocalStatus(DHWHeaterRef:DHWExtInsulRVal) < 1 ) then UNDEFINED else DHWHeaterRef:DHWExtInsulRVal endif
																											else	if ( IfValidAnd( DHWHeaterRef:IsNEEAHtPumpWtrHtr > 0 ) .OR.
																													     LocalStatus(DHWHeaterRef:ExtInsulRVal) < 1 ) then UNDEFINED else DHWHeaterRef:ExtInsulRVal endif 	endif	endif  }
	"Default DHWSysRpt:ExtInsulRpt"				DHWSysRpt:ExtInsulRpt			= {	if (IsCentralHPWH) then  "NA"
	                                                                              else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "HVACSys" ))
																											then	if (LocalStatus( ExtInsulRVal ) < 1) then  " "
																													else	Format( "%g", ExtInsulRVal )  endif
																											else	if (IfValidAnd( DHWHeaterRef:HeaterElementType = 5 )) then  "NA"
																													else if (LocalStatus( ExtInsulRVal ) < 1) then  " "
																													else	Format( "%g", ExtInsulRVal )  endif endif
																											endif endif  }
	"Default DHWSysRpt:StandbyLossFrac"			DHWSysRpt:StandbyLossFrac		= {	if (IsCentralHPWH) then  UNDEFINED
	                                                                              else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "HVACSys" ))
																											then	if ( LocalStatus(DHWHeaterRef:DHWStandbyLossFrac) < 1 ) then UNDEFINED else DHWHeaterRef:DHWStandbyLossFrac endif
																											else	if ( LocalStatus(DHWHeaterRef:StandbyLossFrac) < 1 ) then UNDEFINED else DHWHeaterRef:StandbyLossFrac endif	endif endif  }
	"Default DHWSysRpt:StandbyLossRpt"			DHWSysRpt:StandbyLossRpt		= {	if (IsCentralHPWH) then  "NA"
	                                                                              else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "HVACSys" ))
																											then	if (LocalStatus( StandbyLossFrac ) < 1) then  " "
																													else	Format( "%g", StandbyLossFrac )  endif
																											else	if (IfValidAnd( DHWHeaterRef:HeaterElementType = 5 )) then  "NA"
																													else if (LocalStatus( StandbyLossFrac ) < 1) then  " "
																													else	Format( "%g", StandbyLossFrac )  endif endif
																											endif endif  }
	; SAC 4/29/16 - added new properties to handle reporting of latest HPWH (& elec reistance) equipment
	; SAC 4/24/17 - updated label w/ HPWH Brand/Model enums (tic #829)
	; SAC 6/1/20 - expand reporting for central HPWH compressor & NEEA types
   ; new mapping for NEEA brand = '(generic)' (new NEEA/AWHS tier 3 selections) - SAC 06/17/21
	"Default DHWSysRpt:MakeAndModel"				DHWSysRpt:MakeAndModel			= {
	      if (IsCentralHPWH)
	      then  if (IfValidAnd( DHWSysRef:CHPWHSysDescrip = 1 ))
	            then  EnumString( DHWSysRef:CHPWHNEEABrand ) + " / " +
	                  EnumString( DHWSysRef:CHPWHNEEAModel )
	            else  EnumString( DHWSysRef:CHPWHCompType )  endif
	      else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "HVACSys" ))
			then	"NA"
			else	if (IfValidAnd( DHWHeaterRef:HeaterElementType = 5 )==0) then  "NA"
					else if (IfValidAnd( DHWHeaterRef:HPWH_NEEARated < 0.5 ) .OR.
								IfValidAnd( DHWHeaterRef:ASHPType > 0 )==0) then  "NA"
					else	if (IfValidAnd( DHWHeaterRef:HPWHBrand > 2 ) .AND.
					          IfValidAnd( DHWHeaterRef:HPWHModel > 1 ))
					      then  EnumString( DHWHeaterRef:HPWHBrand ) + " / " +
					            EnumString( DHWHeaterRef:HPWHModel )
                     else if (IfValidAnd( DHWHeaterRef:HPWHBrand = 99 ))   ; generic
                     then  "AWHS " + EnumString( DHWHeaterRef:HPWHModel )
					      else  EnumString( DHWHeaterRef:ASHPType )
					      endif endif
					endif endif 
			endif endif  }
   "Set DHWSysRpt:SimulatedEquip - Description of simulated equipment (currently only HPWHs)"  ; SAC 7/5/17 - tic #805
      DHWSysRpt:SimulatedEquip  = {
	      if (IsCentralHPWH) then  MakeAndModel
	      else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "HVACSys" ))
			then	"NA"
			else	if (IfValidAnd( DHWHeaterRef:HeaterElementType = 5 )==0) then  "NA"
					else if (IfValidAnd( DHWHeaterRef:HPWH_NEEARated < 0.5 ) .OR.
								IfValidAnd( DHWHeaterRef:ASHPType > 0 )==0) then  "NA"
					else  EnumString( DHWHeaterRef:ASHPType )
					endif endif 
			endif endif  }

   ; SAC 7/19/17 - switched return values of ' ' to 'NA' and 'outside' to 'Outside or Exterior closet' (tic #866)
   ; SAC 7/20/17 - switched to using UI's ShowTankLocation flag to determine when tank location should be reported (tic #858)
   ;                 note: 'unknown' can still be reported, but this should only happen in an error situation, where a zone should be assigned but isn't
	"Default DHWSysRpt:TankLocation"				DHWSysRpt:TankLocation			= {
	      if (IsCentralHPWH) then  "Unconditioned"
	      else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "HVACSys" ))
			then	"NA"
			else	if (IfValidAnd( DHWHeaterRef:ShowTankLocation > 0 )==0) then  "NA"
			      else if (IfValidAnd( DHWHeaterRef:TankOutside > 0.5 )) then  "Outside or Exterior closet"
					else if (LocalCompAssigned( DHWHeaterRef:TankZone ) < 1) then  "unknown"
					else	DHWHeaterRef:TankZone:Name
					endif endif endif
			endif endif  }

   ; SAC 7/20/17 - added for reporting of UEF-rated equipment (tic #858)
   "Set DHWSysRpt:RecovEffRpt"         DHWSysRpt:RecovEffRpt  = {
      if (IsCentralHPWH) then  "NA"
	   else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "DHWHeater" ))
      then  switch ( DHWHeaterRef:HeaterElementType )
               case  1 :   switch ( DHWHeaterRef:TankType )    ; Gas
                              case 10 :  if (LocalStatus( DHWHeaterRef:RecovEff ) < 1) then  UNDEFINED  ; "Consumer Instantaneous (UEF)"
                                          else	Format( "%g %", DHWHeaterRef:RecovEff )  endif
                         ;     case 11 :    ; "Commercial Instantaneous (TE)"
                              case 12 :  if (LocalStatus( DHWHeaterRef:RecovEff ) < 1) then  UNDEFINED  ; "Consumer Storage (UEF)"
                                          else	Format( "%g %", DHWHeaterRef:RecovEff )  endif
                         ;     case 13 :    ; "Commercial Storage (TE & SBL)"
                              case 14 :  if (LocalStatus( DHWHeaterRef:RecovEff ) < 1) then  UNDEFINED  ; "Residential-Duty Commercial Storage (UEF)"
                                          else	Format( "%g %", DHWHeaterRef:RecovEff )  endif
                              default :  "NA"
                           endswitch
               case  0 :   switch ( DHWHeaterRef:TankType )    ; Electric Resistance
                              case 10 :  if (LocalStatus( DHWHeaterRef:RecovEff ) < 1) then  UNDEFINED  ; "Consumer Instantaneous (UEF)"
                                          else	Format( "%g %", DHWHeaterRef:RecovEff )  endif
                         ;     case 11 :    ; "Commercial Instantaneous (TE)"
                              case 12 :  if (LocalStatus( DHWHeaterRef:RecovEff ) < 1) then  UNDEFINED  ; "Consumer Storage (UEF)"
                                          else	Format( "%g %", DHWHeaterRef:RecovEff )  endif
                         ;     case 13 :    ; "Commercial Storage (TE & SBL)"
                         ;     case 15 :    ; "Residential-Duty Commercial Instantaneous (UEF)"
                              default :  "NA"
                           endswitch
               case  5 :   if (IfValidAnd( DHWHeaterRef:HPWH_NEEARated > 0 )==0 .AND.    ; Heat Pump
                               IfValidAnd( DHWHeaterRef:IsUEFHtPump > 0 ))
                           then  "NA"
                           else  "NA"  endif
               default :  "NA"
            endswitch
      else  "NA"  endif endif  }

   "Set DHWSysRpt:FirstHourRatingRpt"  DHWSysRpt:FirstHourRatingRpt  = {
      if (IsCentralHPWH) then  "NA"
	   else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "DHWHeater" ))
      then  switch ( DHWHeaterRef:HeaterElementType )
               case  1 :   switch ( DHWHeaterRef:TankType )    ; Gas
                         ;     case 10 :    ; "Consumer Instantaneous (UEF)"
                         ;     case 11 :    ; "Commercial Instantaneous (TE)"
                              case 12 :  if (LocalStatus( DHWHeaterRef:FirstHourRating ) < 1) then  UNDEFINED  ; "Consumer Storage (UEF)"
                                          else	Format( "%g gal", DHWHeaterRef:FirstHourRating )  endif
                         ;     case 13 :    ; "Commercial Storage (TE & SBL)"
                              case 14 :  if (LocalStatus( DHWHeaterRef:FirstHourRating ) < 1) then  UNDEFINED  ; "Residential-Duty Commercial Storage (UEF)"
                                          else	Format( "%g gal", DHWHeaterRef:FirstHourRating )  endif
                              default :  "NA"
                           endswitch
               case  0 :   switch ( DHWHeaterRef:TankType )    ; Electric Resistance
                         ;     case 10 :    ; "Consumer Instantaneous (UEF)"
                         ;     case 11 :    ; "Commercial Instantaneous (TE)"
                              case 12 :  if (LocalStatus( DHWHeaterRef:FirstHourRating ) < 1) then  UNDEFINED  ; "Consumer Storage (UEF)"
                                          else	Format( "%g gal", DHWHeaterRef:FirstHourRating )  endif
                         ;     case 13 :    ; "Commercial Storage (TE & SBL)"
                         ;     case 15 :    ; "Residential-Duty Commercial Instantaneous (UEF)"
                              default :  "NA"
                           endswitch
               case  5 :   if (IfValidAnd( DHWHeaterRef:HPWH_NEEARated > 0 )==0 .AND.    ; Heat Pump
                               IfValidAnd( DHWHeaterRef:IsUEFHtPump > 0 ))
                           then  if (LocalStatus( DHWHeaterRef:FirstHourRating ) < 1) then  UNDEFINED
                                 else  Format( "%g gal", DHWHeaterRef:FirstHourRating )  endif
                           else  "NA"  endif
               default :  "NA"
            endswitch
      else  "NA"  endif endif  }

   "Set DHWSysRpt:RatedFlowRpt"        DHWSysRpt:RatedFlowRpt  = {
      if (IsCentralHPWH) then  "NA"
	   else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "DHWHeater" ))
      then  switch ( DHWHeaterRef:HeaterElementType )
               case  1 :   switch ( DHWHeaterRef:TankType )    ; Gas
                              case 10 :  if (LocalStatus( DHWHeaterRef:RatedFlow ) < 1) then  UNDEFINED  ; "Consumer Instantaneous (UEF)"
                                          else	Format( "%g GPM", DHWHeaterRef:RatedFlow )  endif
                         ;     case 11 :    ; "Commercial Instantaneous (TE)"
                         ;     case 12 :    ; "Consumer Storage (UEF)"
                         ;     case 13 :    ; "Commercial Storage (TE & SBL)"
                         ;     case 14 :    ; "Residential-Duty Commercial Storage (UEF)"
                              default :  "NA"
                           endswitch
               case  0 :   switch ( DHWHeaterRef:TankType )    ; Electric Resistance
                              case 10 :  if (LocalStatus( DHWHeaterRef:RatedFlow ) < 1) then  UNDEFINED  ; "Consumer Instantaneous (UEF)"
                                          else	Format( "%g GPM", DHWHeaterRef:RatedFlow )  endif
                         ;     case 11 :    ; "Commercial Instantaneous (TE)"
                         ;     case 12 :    ; "Consumer Storage (UEF)"
                         ;     case 13 :    ; "Commercial Storage (TE & SBL)"
                              case 15 :  if (LocalStatus( DHWHeaterRef:RatedFlow ) < 1) then  UNDEFINED  ; "Residential-Duty Commercial Instantaneous (UEF)"
                                          else	Format( "%g GPM", DHWHeaterRef:RatedFlow )  endif
                              default :  "NA"
                           endswitch
               case  5 :   if (IfValidAnd( DHWHeaterRef:HPWH_NEEARated > 0 )==0 .AND.    ; Heat Pump
                               IfValidAnd( DHWHeaterRef:IsUEFHtPump > 0 ))
                           then  "NA"
                           else  "NA"  endif
               default :  "NA"
            endswitch
      else  "NA"  endif endif  }

   "Set DHWSysRpt:ShwrDrnWtrHtRecovRpt - Shower drain water heat recovery (for report)"   ; SAC 2/19/18 (tic #978)
      DHWSysRpt:ShwrDrnWtrHtRecovRpt  =
         {  if (LocalCompAssigned( DwellUnitTypeRef ))
            then  if ( IfValidAnd( DwellUnitTypeRef:DWHRSysDevicesSim[1] > 0 ) .OR.
                       IfValidAnd( DwellUnitTypeRef:DWHRSysDevicesSim[2] > 0 ) .OR.
                       IfValidAnd( DwellUnitTypeRef:DWHRSysDevicesSim[3] > 0 ) .OR.
                       IfValidAnd( DwellUnitTypeRef:DWHRSysDevicesSim[4] > 0 ) .OR.
                       IfValidAnd( DwellUnitTypeRef:DWHRSysDevicesSim[5] > 0 ) )
                  then  "Yes"  else  "NA"  endif
            else  DHWSysRef:ShwrDrnWtrHtRecovRpt  endif  }
      ;   "NA"  }
      ; SAC 4/29/19 - removed references to old ShwrDRAINHREFF input
      ;   if (IfValidAnd( Proj:HaveShwrDrnHtRecov > 0 ) .AND. IfValidAnd( Proj:ShwrDRAINHREFF > 0 ))
      ;   then  Format( "%g", Proj:ShwrDRAINHREFF )
      ;   else  "NA"  endif  }


	"Assign HERSAllPipesIns"						DHWSysRpt:HERSAllPipesIns 		= {	DHWSysRef:HERSCheck:AllPipesIns	}
	"Assign HERSPipeInsRptMsg"						DHWSysRpt:HERSPipeInsRptMsg 	= {	if (IfValidAnd( HERSAllPipesIns > 0.5 )) then
																												EnumString( DHWSysRef:HERSCheck:PipeInsRptMsg ) 
																											else "none" endif	}
	"Assign HERSParallelPipe"						DHWSysRpt:HERSParallelPipe		= {	DHWSysRef:HERSCheck:ParallelPipe	}
	"Assign HERSParaPipeRptMsg"					DHWSysRpt:HERSParaPipeRptMsg 	= {	if (IfValidAnd( HERSParallelPipe > 0.5 )) then
																												EnumString( DHWSysRef:HERSCheck:ParaPipeRptMsg ) 
																											else "none" endif	}
;	"Assign HERSBelowGrade"							DHWSysRpt:HERSBelowGrade		= {	DHWSysRef:HERSCheck:BelowGrade	}
;	"Assign HERSBelowGradeRptMsg"					DHWSysRpt:HERSBelowGradeRptMsg 	= {	if (IfValidAnd( HERSBelowGrade > 0.5 )) then
;																													EnumString( DHWSysRef:HERSCheck:BelowGradeRptMsg ) 
;																												else "none" endif	}
	"Assign HERSPushBtnRecirc"						DHWSysRpt:HERSPushBtnRecirc	= {	DHWSysRef:HERSCheck:PushBtnRecirc	}
	"Assign HERSPushBtnRptMsg"						DHWSysRpt:HERSPushBtnRptMsg 	= {	if (IfValidAnd( HERSPushBtnRecirc > 0.5 )) then
																												EnumString( DHWSysRef:HERSCheck:PushBtnRptMsg ) 
																											else "none" endif	}
	"Assign HERSOccRecirc"							DHWSysRpt:HERSOccRecirc			= {	DHWSysRef:HERSCheck:OccRecirc	}
	"Assign HERSOccRptMsg"							DHWSysRpt:HERSOccRptMsg 		= {	if (IfValidAnd( HERSOccRecirc > 0.5 )) then
																												EnumString( DHWSysRef:HERSCheck:OccRptMsg ) 
																											else "none" endif	}
	"Assign HERSPointOfUse"							DHWSysRpt:HERSPointOfUse		= {	DHWSysRef:HERSCheck:PointOfUse	}
	"Assign HERSPOURptMsg"							DHWSysRpt:HERSPOURptMsg 		= {	if (IfValidAnd( HERSPointOfUse > 0.5 )) then
																												EnumString( DHWSysRef:HERSCheck:POURptMsg ) 
																											else "none" endif	}

;"dbg" DHWSysRpt:Action = {
;   if (ParentCompAssigned( DwellUnitTypeRef ) < 1 .OR. Proj:EnergyCodeYearNum < 2019)
;   then  PostMessageToLog( "  DHWSysRpt '%s' DwellingUnit unattached or wrong code vintage", Name )
;   else if (IfValidAnd( DHWSysIdx > 0 )==0) then  PostMessageToLog( "  DHWSysRpt '%s' -error- DHWSysIdx invalid (%g)", Name, ValidOr( DHWSysIdx, -999 ) )
;   else  switch (DHWSysIdx)
;         case  1 :   PostMessageToLog( "  DHWSysRpt '%s' CD:  DHWSysIdx %g / CD %g / CFactor %g / CDCompatible[1] %g",
;                           Name, DHWSysIdx, ParentRef( DwellUnitTypeRef:CompactDistrib ), ParentRef( DwellUnitTypeRef:CompactFactor ), ParentRef( DwellUnitTypeRef:CDCompatible[1] ) )
;         case  2 :   PostMessageToLog( "  DHWSysRpt '%s' CD:  DHWSysIdx %g / CD %g / CFactor %g / CDCompatible[2] %g",
;                           Name, DHWSysIdx, ParentRef( DwellUnitTypeRef:CompactDistrib ), ParentRef( DwellUnitTypeRef:CompactFactor ), ParentRef( DwellUnitTypeRef:CDCompatible[2] ) )
;         default :   PostMessageToLog( "  DHWSysRpt '%s' DHWSysIdx (%g)", Name, DHWSysIdx )
;         endswitch
;   endif endif  }
   ; remove reference to SFamUserSpecCmpctDist - now valid for compliance analysis - SAC 09/29/21 (tic #1277)
   "Set DHWSysRpt:CompactDistribDescrip"     DHWSysRpt:CompactDistribDescrip  =     ; SAC 5/13/19 - to facilitate 2019 HERS reporting   
      {  if (ParentComponentType() == "DHWSys" .OR. Proj:EnergyCodeYearNum < 2019)
         then  if (Proj:EnergyCodeYearNum < 2019 .AND. IfValidAnd( DHWSysRef:HERSCheck:Compact > 0 ))
               then  "Basic"
               else if (Proj:EnergyCodeYearNum >= 2019)
               then  if (Proj:SFamCompactDistrib > 0 .AND.
                         IfValidAnd( Proj:SFamCompactFactor > 0 ) .AND. IfValidAnd( Proj:SFamCompactFactor < 1 ))
                     then  switch (Proj:SFamCompactDistrib)
                              case  1 :  "Basic"
                              case  2 :  "Expanded"
                              default :  UNDEFINED
                           endswitch
                     else  UNDEFINED  endif
               else  UNDEFINED  endif endif
         else  if (ParentComponentType() != "DwellUnit" .OR. IfValidAnd( DHWSysIdx > 0 )==0) then  UNDEFINED
               else if (ParentRef( DwellUnitTypeRef:CompactDistrib ) > 0 .AND.
                        ParentRef( DwellUnitTypeRef:CompactFactor ) > 0 .AND. ParentRef( DwellUnitTypeRef:CompactFactor ) < 1)
               then  switch (DHWSysIdx)
                        case  1 :   if (ParentRef( DwellUnitTypeRef:CDCompatible[1] ) < 1) then  UNDEFINED
                                    else if (ParentRef( DwellUnitTypeRef:CompactDistrib ) = 2) then  "Expanded"  else  "Basic"  endif endif
                        case  2 :   if (ParentRef( DwellUnitTypeRef:CDCompatible[2] ) < 1) then  UNDEFINED
                                    else if (ParentRef( DwellUnitTypeRef:CompactDistrib ) = 2) then  "Expanded"  else  "Basic"  endif endif
                        case  3 :   if (ParentRef( DwellUnitTypeRef:CDCompatible[3] ) < 1) then  UNDEFINED
                                    else if (ParentRef( DwellUnitTypeRef:CompactDistrib ) = 2) then  "Expanded"  else  "Basic"  endif endif
                        case  4 :   if (ParentRef( DwellUnitTypeRef:CDCompatible[4] ) < 1) then  UNDEFINED
                                    else if (ParentRef( DwellUnitTypeRef:CompactDistrib ) = 2) then  "Expanded"  else  "Basic"  endif endif
                        case  5 :   if (ParentRef( DwellUnitTypeRef:CDCompatible[5] ) < 1) then  UNDEFINED
                                    else if (ParentRef( DwellUnitTypeRef:CompactDistrib ) = 2) then  "Expanded"  else  "Basic"  endif endif
                        default :   UNDEFINED
                     endswitch
               else  UNDEFINED  endif endif
         endif  }
	"Assign HERSCompact"								DHWSysRpt:HERSCompact			=        ; SAC 5/13/19 - revisions for MFam DwellUnit models (HERS reporting of Compact Distrib)
      {  if (ParentComponentType() == "DHWSys" .OR. Proj:EnergyCodeYearNum < 2019)
         then  DHWSysRef:HERSCheck:Compact
         else  if (ParentComponentType() != "DwellUnit" .OR. IfValidAnd( DHWSysIdx > 0 )==0) then  0
               else if (ParentRef( DwellUnitTypeRef:CompactDistrib ) < 2) then  0
               else if (ParentRef( DwellUnitTypeRef:CompactFactor ) > 0 .AND. ParentRef( DwellUnitTypeRef:CompactFactor ) < 1)
               then  switch (DHWSysIdx)
                        case  1 :  if (ParentRef( DwellUnitTypeRef:CDCompatible[1] ) > 0) then  1  else  0  endif
                        case  2 :  if (ParentRef( DwellUnitTypeRef:CDCompatible[2] ) > 0) then  1  else  0  endif
                        case  3 :  if (ParentRef( DwellUnitTypeRef:CDCompatible[3] ) > 0) then  1  else  0  endif
                        case  4 :  if (ParentRef( DwellUnitTypeRef:CDCompatible[4] ) > 0) then  1  else  0  endif
                        case  5 :  if (ParentRef( DwellUnitTypeRef:CDCompatible[5] ) > 0) then  1  else  0  endif
                        default :  0
                     endswitch
               else  0  endif endif endif
         endif  }
	"Assign HERSCompactRptMsg"						DHWSysRpt:HERSCompactRptMsg 	=        ; SAC 5/13/19
      {  if (IfValidAnd( HERSCompact < 0.5 )) then  "none"
         else if (ParentComponentType() == "DHWSys" .OR. Proj:EnergyCodeYearNum < 2019)
         then  EnumString( DHWSysRef:HERSCheck:CompactRptMsg ) 
         else  "Compact Distribution System"
         endif endif	}
;8/25/16 - CG added following DHW report properties
	"Assign HERSMFCtrlRecircDualLp"								
	 DHWSysRpt:HERSMFCtrlRecircDualLp			= {	
	  DHWSysRef:HERSCheck:MFCtrlRecircDualLp	}
	"Assign HERSMFCtrlRecircDualLpRptMsg"						
	 DHWSysRpt:HERSMFCtrlRecircDualLpRptMsg 	= {	
	  if (IfValidAnd( HERSMFCtrlRecircDualLp > 0.5 )) 
	  then EnumString( DHWSysRef:HERSCheck:MFCtrlRecircDualLpRptMsg ) 
		else "none" 
		endif	}
		
;	"Assign HERSMFNoControl"						DHWSysRpt:HERSMFNoControl		= {	DHWSysRef:HERSCheck:MFNoControl	}
;	"Assign HERSMFNoCtrlRptMsg"					DHWSysRpt:HERSMFNoCtrlRptMsg 	= {	if (IfValidAnd( HERSMFNoControl > 0.5 )) then
;																												EnumString( DHWSysRef:HERSCheck:MFNoCtrlRptMsg ) 
;																											else "none" endif	}
;	"Assign HERSMFDemandControl"					DHWSysRpt:HERSMFDemandControl	= {	DHWSysRef:HERSCheck:MFDemandControl	}
;	"Assign HERSMFDCRptMsg"							DHWSysRpt:HERSMFDCRptMsg 		= {	if (IfValidAnd( HERSMFDemandControl > 0.5 )) then
;																												EnumString( DHWSysRef:HERSCheck:MFDCRptMsg ) 
;																											else "none" endif	}
;	"Assign HERSMFTempMod"							DHWSysRpt:HERSMFTempMod			= {	DHWSysRef:HERSCheck:MFTempMod	}
;	"Assign HERSMFTmpModRptMsg"					DHWSysRpt:HERSMFTmpModRptMsg 	= {	if (IfValidAnd( HERSMFTempMod > 0.5 )) then
;																												EnumString( DHWSysRef:HERSCheck:MFTmpModRptMsg ) 
;																											else "none" endif	}
;	"Assign HERSMFTempModMon"						DHWSysRpt:HERSMFTempModMon		= {	DHWSysRef:HERSCheck:MFTempModMon	}
;	"Assign HERSMFTmpModMonRptMsg"				DHWSysRpt:HERSMFTmpModMonRptMsg 	= {	if (IfValidAnd( HERSMFTempModMon > 0.5 )) then
;																													EnumString( DHWSysRef:HERSCheck:MFTmpModMonRptMsg ) 
;																												else "none" endif	}
END

; SAC 3/26/14 - added rulelists designed to setup and default IAQVentRpt objects
;*************************************************************************
RULELIST "Setup_IAQVentReportingObjects" 1 0 1 0
;*************************************************************************
	"Delete all IAQVentRpt objects currently in building description"										Proj:Action		= {	DeleteAllComps( IAQVentRpt )  }
	"Create new IAQVentRpt objects and populate w/ initial object references & indexes/counts"	Proj:Action		= {	CreateIAQRptObjects()  }
	"Default IAQVentRpt properties - general"		IAQVentRpt:Action	= {	EvalRulelist( "Default_IAQVentReportObject", 1 )  }
END

;*************************************************************************
RULELIST "Default_IAQVentReportObject" 0 0 0 0
;*************************************************************************
   ; SAC 12/17/19 - revised IAQVentRpt:IAQVentName & :IAQFanType for new MFam default balanced & min exhaust IAQ options
	"Default IAQVentRpt:IAQVentName"				IAQVentRpt:IAQVentName		= {	if ( LocalCompAssigned( IAQFanRef ) ) then
																											Format( "%s - %g/%g", IAQFanRef:Name, IAQFanIdx, IAQFanCnt )
																										else if (LocalCompAssigned( DwellUnitRef )) then
																											if (IfValidAnd( DwellUnitTypeRef:IAQOption = 4 ))
																										   then  Format( "Default Balanced IAQ Fan - %s", DwellUnitRef:Name )
																											else if (IfValidAnd( DwellUnitTypeRef:IAQOption = 5 ))
																										   then  Format( "Minimum Exhaust IAQ Fan - %s", DwellUnitRef:Name )
																										   else  Format( "Default IAQ Fan - %s", DwellUnitRef:Name )
																										   endif endif
																										else if (ValidOr( DwellingUnitIdx, -1 ) >= 0 .AND. ValidOr( DwellingUnitCnt, -1 ) >= 1) then
																											Format( "Default IAQ Fan - %g/%g", DwellingUnitIdx, DwellingUnitCnt )
																										else
																											Format( "Default IAQ Fan - %g", ComponentIndex() )
																										endif endif endif }
	"Default IAQVentRpt:DwellingUnit"			IAQVentRpt:DwellingUnit		= {	if (LocalCompAssigned( DwellUnitRef ))
																										then	DwellUnitRef:Name
																										else	Format( "Dwelling Unit %g/%g", DwellingUnitIdx, DwellingUnitCnt )  endif  }
	"Default IAQVentRpt:IAQFanType"				IAQVentRpt:IAQFanType		= {	if (IfValidAnd( IAQFanRef:IAQFanType > 0.5 )) then
																											EnumString( IAQFanRef:IAQFanType )
	                                                                           else if (IfValidAnd( DwellUnitTypeRef:IAQOption = 4 ))
																										then  "Balanced"
																										else if (IfValidAnd( DwellUnitTypeRef:IAQOption = 5 ))
																										then  "Exhaust"
																										else  "Default"  endif endif endif }
   ; SAC 4/24/19 - renumbered switch to run 0-15, consistent w/ DwellingUnitIdx set in source code (tic #1010)
	"Default IAQVentRpt:IAQCFM"					IAQVentRpt:IAQCFM				= {	if ( LocalCompAssigned( IAQFanRef ) ) then
																											if ( LocalStatus(IAQFanRef:IAQCFM	) < 1 ) then UNDEFINED else IAQFanRef:IAQCFM	 endif
																										else if (LocalCompAssigned( DwellUnitRef ))
																										then	if (ValidOr( DwellUnitRef:Count, 0 ) < 0.5) then  0
																												else	DwellUnitRef:MinIAQCFM / DwellUnitRef:Count  endif
																										else 
																											switch (Local( DwellingUnitIdx ))
																												case  0 : Proj:UnitMinIAQCFM[1]
																												case  1 : Proj:UnitMinIAQCFM[2]
																												case  2 : Proj:UnitMinIAQCFM[3]
																												case  3 : Proj:UnitMinIAQCFM[4]
																												case  4 : Proj:UnitMinIAQCFM[5]
																												case  5 : Proj:UnitMinIAQCFM[6]
																												case  6 : Proj:UnitMinIAQCFM[7]
																												case  7 : Proj:UnitMinIAQCFM[8]
																												case  8 : Proj:UnitMinIAQCFM[9]
																												case  9 : Proj:UnitMinIAQCFM[10]
																												case 10 : Proj:UnitMinIAQCFM[11]
																												case 11 : Proj:UnitMinIAQCFM[12]
																												case 12 : Proj:UnitMinIAQCFM[13]
																												case 13 : Proj:UnitMinIAQCFM[14]
																												case 14 : Proj:UnitMinIAQCFM[15]
																												case 15 : Proj:UnitMinIAQCFM[16]
																												default : Proj:UnitMinIAQCFM[1]
																											endswitch endif endif	}
   ; SAC 8/12/16 - added rule to round reported IAQCFM to nearest integer (tic #729)
   "Round IAQVentRpt:IAQCFM to nearest integer"    IAQVentRpt:IAQCFM    = {
      if (IfValidAnd( IAQCFM > 0 )) then  int( IAQCFM + 0.5 )  else  UNCHANGED  endif  }
   ; SAC 2/12/20 - added new std design IAQFan:WperCFMIAQ of 0.3 & 0.6 for SFam/MFam (tic #1174)      ; SAC 7/20/20 (tic #1174)
	"Default IAQVentRpt:WperCFMIAQ"				IAQVentRpt:WperCFMIAQ		=        ; revised DefaultIAQFanPwr unbal 0.3->0.35 & bal 0.6->0.7 - SAC 01/19/21 (tic #1243) 
      {  if (LocalCompAssigned( IAQFanRef ))
         then  if (LocalStatus(IAQFanRef:WperCFMIAQ) < 1) then  UNDEFINED
               else  IAQFanRef:WperCFMIAQ  endif
         else if (IfValidAnd( Proj:AnalysisVersion >= 190200 ))
		   then  if (IAQFanType == "Balanced")
		         then  0.7  else  0.35  endif
		   else  0.25     ; Stand Alone IAQ Fan (prior to 2019.2.0)
		   endif endif  }
	"Default IAQVentRpt:IAQRecovEffect"			IAQVentRpt:IAQRecovEffect	= {	if ( LocalCompAssigned( IAQFanRef ) ) then
																											if ( LocalStatus(IAQFanRef:IAQRecovEffect) < 1 ) then UNDEFINED else IAQFanRef:IAQRecovEffect endif
																										else 0 endif }

   "Default IAQVentRpt:SensRecovEff"               IAQVentRpt:SensRecovEff            =            ; SAC 2/10/20 (tic #1174)
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( IAQFanRef:IAQFanType = 3 )==0 .OR.
             IfValidAnd( IAQFanRef:IncludesRecov > 0 )==0 .OR. IfValidAnd( IAQFanRef:SensRecovEff > 0 )==0) then  UNDEFINED
         else  IAQFanRef:SensRecovEff  endif  }
   "Default IAQVentRpt:AdjSensRecovEff"            IAQVentRpt:AdjSensRecovEff         = 
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( IAQFanRef:IAQFanType = 3 )==0 .OR.
             IfValidAnd( IAQFanRef:IncludesRecov > 0 )==0 .OR. IfValidAnd( IAQFanRef:AdjSensRecovEff > 0 )==0) then  UNDEFINED
         else  IAQFanRef:AdjSensRecovEff  endif  }
   "Default IAQVentRpt:SetPerfByHVIInterp"         IAQVentRpt:SetPerfByHVIInterp      = 
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( IAQFanRef:IAQFanType = 3 )==0 .OR.
             IfValidAnd( IAQFanRef:IncludesRecov > 0 )==0 .OR. LocalStatus( IAQFanRef:SetPerfByHVIInterp ) < 1) then  UNDEFINED
         else  IAQFanRef:SetPerfByHVIInterp  endif  }
   "Default IAQVentRpt:HVIListedInterpCFM[1]-lo"   IAQVentRpt:HVIListedInterpCFM[1]   = 
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( IAQFanRef:IAQFanType = 3 )==0 .OR.
             IfValidAnd( IAQFanRef:IncludesRecov > 0 )==0 .OR. IfValidAnd( IAQFanRef:SetPerfByHVIInterp > 0 )==0 .OR.
             IfValidAnd( IAQFanRef:HVIListedInterpCFM[1] > 0 )==0) then  UNDEFINED
         else  IAQFanRef:HVIListedInterpCFM[1]  endif  }
   "Default IAQVentRpt:HVIListedInterpCFM[2]-hi"   IAQVentRpt:HVIListedInterpCFM[2]   = 
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( IAQFanRef:IAQFanType = 3 )==0 .OR.
             IfValidAnd( IAQFanRef:IncludesRecov > 0 )==0 .OR. IfValidAnd( IAQFanRef:SetPerfByHVIInterp > 0 )==0 .OR.
             IfValidAnd( IAQFanRef:HVIListedInterpCFM[2] > 0 )==0) then  UNDEFINED
         else  IAQFanRef:HVIListedInterpCFM[2]  endif  }
   "Default IAQVentRpt:HVIListedInterpSRE[1]-lo"   IAQVentRpt:HVIListedInterpSRE[1]   = 
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( IAQFanRef:IAQFanType = 3 )==0 .OR.
             IfValidAnd( IAQFanRef:IncludesRecov > 0 )==0 .OR. IfValidAnd( IAQFanRef:SetPerfByHVIInterp > 0 )==0 .OR.
             IfValidAnd( IAQFanRef:HVIListedInterpSRE[1] > 0 )==0) then  UNDEFINED
         else  IAQFanRef:HVIListedInterpSRE[1]  endif  }
   "Default IAQVentRpt:HVIListedInterpSRE[2]-hi"   IAQVentRpt:HVIListedInterpSRE[2]   = 
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( IAQFanRef:IAQFanType = 3 )==0 .OR.
             IfValidAnd( IAQFanRef:IncludesRecov > 0 )==0 .OR. IfValidAnd( IAQFanRef:SetPerfByHVIInterp > 0 )==0 .OR.
             IfValidAnd( IAQFanRef:HVIListedInterpSRE[2] > 0 )==0) then  UNDEFINED
         else  IAQFanRef:HVIListedInterpSRE[2]  endif  }
   "Default IAQVentRpt:HVIListedInterpASRE[1]-lo"  IAQVentRpt:HVIListedInterpASRE[1]  = 
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( IAQFanRef:IAQFanType = 3 )==0 .OR.
             IfValidAnd( IAQFanRef:IncludesRecov > 0 )==0 .OR. IfValidAnd( IAQFanRef:SetPerfByHVIInterp > 0 )==0 .OR.
             IfValidAnd( IAQFanRef:HVIListedInterpASRE[1] > 0 )==0) then  UNDEFINED
         else  IAQFanRef:HVIListedInterpASRE[1]  endif  }
   "Default IAQVentRpt:HVIListedInterpASRE[2]-hi"  IAQVentRpt:HVIListedInterpASRE[2]  = 
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( IAQFanRef:IAQFanType = 3 )==0 .OR.
             IfValidAnd( IAQFanRef:IncludesRecov > 0 )==0 .OR. IfValidAnd( IAQFanRef:SetPerfByHVIInterp > 0 )==0 .OR.
             IfValidAnd( IAQFanRef:HVIListedInterpASRE[2] > 0 )==0) then  UNDEFINED
         else  IAQFanRef:HVIListedInterpASRE[2]  endif  }
END
;*************************************************************************


;*************************************************************************
RULELIST "Default_Heat_CntrlFurnace" 0 0 0 1      ; defaulting for HVACHeat:Type = "CntrlFurnace - Fuel-fired central furnace"
;*************************************************************************
	"Default HVACHeat:TotalCapacity"   	HVACHeat:TotalCapacity  = {  UNDEFINED  }
	"Set HVACHeat:TypeDescrip"		HVACHeat:TypeDescrip	= { "RTF\Ht_CF.rtf" }
	"Default HVACHeat:AFUE"		HVACHeat:AFUE			= {
	      if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6) then  UNCHANGED
	      else  T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  endif  }
	"Default HVACHeat:AFUE (via ExEDR defaulting rules)"		HVACHeat:Action  = {
	      if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6)
	      then  EvalRulelist( "ExEDRDefault_HVACHeat_AFUE", 1 )  else  UNCHANGED  endif  }
   "Set DisplayAFUE flag"		HVACHeat:DisplayAFUE	= {	1  }
   "Set HVACHeat:MinAFUE"     HVACHeat:MinAFUE  =        ; SAC 08/24/20 (tic #1227)
      {  if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6) then  UNCHANGED
         else  T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  endif  }
END

;*************************************************************************
RULELIST "Default_Heat_WallFurnaceFan"         0 0 0 1      ; defaulting for HVACHeat:Type = "WallFurnaceFan - Ductless fan forced wall furnace"                      
;*************************************************************************
	"Default HVACHeat:TotalCapacity"   	HVACHeat:TotalCapacity  = {  UNDEFINED  }
	"Set HVACHeat:TypeDescrip"		HVACHeat:TypeDescrip	= { "RTF\Ht_WFF.rtf" }
	"Default HVACHeat:AFUE"		HVACHeat:AFUE			= {
	      if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6) then  UNCHANGED
	      else  T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  endif  }
	"Default HVACHeat:AFUE (via ExEDR defaulting rules)"		HVACHeat:Action  = {
	      if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6)
	      then  EvalRulelist( "ExEDRDefault_HVACHeat_AFUE", 1 )  else  UNCHANGED  endif  }
   "Set DisplayAFUE flag"		HVACHeat:DisplayAFUE	= {	1  }
;   "Set DisplayTotalCapacity flag"	HVACHeat:DisplayTotalCapacity	= {	1  }
   "Set HVACHeat:MinAFUE"     HVACHeat:MinAFUE  =        ; SAC 08/24/20 (tic #1227)
      {  if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6) then  UNCHANGED
         else  T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  endif  }
END

;*************************************************************************
RULELIST "Default_Heat_WallFurnaceGravity"         0 0 0 1      ; defaulting for HVACHeat:Type = "WallFurnaceGravity - Ductless gravity flowed wall furnace"       
;*************************************************************************
	"Default HVACHeat:TotalCapacity"   	HVACHeat:TotalCapacity  = {  UNDEFINED  }
	"Set HVACHeat:TypeDescrip"		HVACHeat:TypeDescrip	= { "RTF\Ht_WFG.rtf" }
	"Default HVACHeat:AFUE"		HVACHeat:AFUE			= {
	      if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6) then  UNCHANGED
	      else  T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  endif  }
	"Default HVACHeat:AFUE (via ExEDR defaulting rules)"		HVACHeat:Action  = {
	      if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6)
	      then  EvalRulelist( "ExEDRDefault_HVACHeat_AFUE", 1 )  else  UNCHANGED  endif  }
   "Set DisplayAFUE flag"		HVACHeat:DisplayAFUE	= {	1  }
;   "Set DisplayTotalCapacity flag"	HVACHeat:DisplayTotalCapacity	= {	1  }
   "Set HVACHeat:MinAFUE"     HVACHeat:MinAFUE  =        ; SAC 08/24/20 (tic #1227)
      {  if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6) then  UNCHANGED
         else  T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  endif  }
END

;*************************************************************************
RULELIST "Default_Heat_FloorFurnace"         0 0 0 1      ; defaulting for HVACHeat:Type = "FloorFurnace - Ductless floor heating system"                 
;*************************************************************************
	"Default HVACHeat:TotalCapacity"   	HVACHeat:TotalCapacity  = {  UNDEFINED  }
	"Set HVACHeat:TypeDescrip"		HVACHeat:TypeDescrip	= { "RTF\Ht_FF.rtf" }
	"Default HVACHeat:AFUE"		HVACHeat:AFUE			= {
	      if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6) then  UNCHANGED
	      else  T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  endif  }
	"Default HVACHeat:AFUE (via ExEDR defaulting rules)"		HVACHeat:Action  = {
	      if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6)
	      then  EvalRulelist( "ExEDRDefault_HVACHeat_AFUE", 1 )  else  UNCHANGED  endif  }
   "Set DisplayAFUE flag"		HVACHeat:DisplayAFUE	= {	1  }
;   "Set DisplayTotalCapacity flag"	HVACHeat:DisplayTotalCapacity	= {	1  }
   "Set HVACHeat:MinAFUE"     HVACHeat:MinAFUE  =        ; SAC 08/24/20 (tic #1227)
      {  if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6) then  UNCHANGED
         else  T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  endif  }
END

;*************************************************************************
RULELIST "Default_Heat_RoomHeater"         0 0 0 1      ; defaulting for HVACHeat:Type = "RoomHeater - Ductless non-central space heater"                      
;*************************************************************************
	"Default HVACHeat:TotalCapacity"   	HVACHeat:TotalCapacity  = {  UNDEFINED  }
	"Set HVACHeat:TypeDescrip"		HVACHeat:TypeDescrip	= { "RTF\Ht_RH.rtf" }
	"Default HVACHeat:AFUE"		HVACHeat:AFUE			= {
	      if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6) then  UNCHANGED
	      else  T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  endif  }
	"Default HVACHeat:AFUE (via ExEDR defaulting rules)"		HVACHeat:Action  = {
	      if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6)
	      then  EvalRulelist( "ExEDRDefault_HVACHeat_AFUE", 1 )  else  UNCHANGED  endif  }
   "Set DisplayAFUE flag"		HVACHeat:DisplayAFUE	= {	1  }
;   "Set DisplayTotalCapacity flag"	HVACHeat:DisplayTotalCapacity	= {	1  }
   "Set HVACHeat:MinAFUE"     HVACHeat:MinAFUE  =        ; SAC 08/24/20 (tic #1227)
      {  if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6) then  UNCHANGED
         else  T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  endif  }
END

;*************************************************************************
RULELIST "Default_Heat_Boiler"         0 0 0 1      ; defaulting for HVACHeat:Type = "Boiler - Gas or oil boiler"                                         
;*************************************************************************
	"Default HVACHeat:TotalCapacity"   	HVACHeat:TotalCapacity  = {  UNDEFINED  }
	"Set HVACHeat:TypeDescrip"		HVACHeat:TypeDescrip	= { "RTF\Ht_B.rtf" }
	; SAC 4/15/15 - toggled ON AFUE default and DisplayAFUE for Boiler systems
	"Default HVACHeat:AFUE"		HVACHeat:AFUE			= {
	      if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6) then  UNCHANGED
	      else  T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  endif  }
	"Default HVACHeat:AFUE (via ExEDR defaulting rules)"		HVACHeat:Action  = {
	      if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6)
	      then  EvalRulelist( "ExEDRDefault_HVACHeat_AFUE", 1 )  else  UNCHANGED  endif  }
   "Set DisplayAFUE flag"		HVACHeat:DisplayAFUE	= {	1  }
   "Set HVACHeat:MinAFUE"     HVACHeat:MinAFUE  =        ; SAC 08/24/20 (tic #1227)
      {  if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6) then  UNCHANGED
         else  T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  endif  }
END

;*************************************************************************
RULELIST "Default_Heat_WoodHeat"         0 0 0 1    ; defaulting for HVACHeat:Type = "WoodHeat - Wood heat meeting exceptional method criteria"                                        
;*************************************************************************
	"Default HVACHeat:TotalCapacity"   	HVACHeat:TotalCapacity  = {  UNDEFINED  }
	"Set HVACHeat:TypeDescrip"		HVACHeat:TypeDescrip	= { "RTF\Ht_WoodHeat.rtf" }
  "Set DisplayAFUE flag"		HVACHeat:DisplayAFUE	= {	 0 }
END

;*************************************************************************
RULELIST "Default_Heat_PkgGasFurnace"         0 0 0 1      ; defaulting for HVACHeat:Type = "PkgGasFurnace - Packaged gas furnace"           ; SAC 6/22/20 (tic #1227)
;*************************************************************************
	"Default HVACHeat:TotalCapacity"   	HVACHeat:TotalCapacity  = {  UNDEFINED  }
	"Set HVACHeat:TypeDescrip"		HVACHeat:TypeDescrip	= { "RTF\Ht_PkgGasFurnace.rtf" }
	"Default HVACHeat:AFUE"		HVACHeat:AFUE			= {
	      if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6) then  UNCHANGED
	      else  T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  endif  }
	"Default HVACHeat:AFUE (via ExEDR defaulting rules)"		HVACHeat:Action  = {
	      if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6)
	      then  EvalRulelist( "ExEDRDefault_HVACHeat_AFUE", 1 )  else  UNCHANGED  endif  }
   "Set DisplayAFUE flag"		HVACHeat:DisplayAFUE	= {	1  }
;   "Set DisplayTotalCapacity flag"	HVACHeat:DisplayTotalCapacity	= {	1  }
   "Set HVACHeat:MinAFUE"     HVACHeat:MinAFUE  =        ; SAC 08/24/20 (tic #1227)
      {  if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6) then  UNCHANGED
         else  T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  endif  }
END

;*************************************************************************
RULELIST "Default_Heat_Electric"       0 0 0 1     ; defaulting for HVACHeat:Type = "Electric - All electric heating systems other than heat pump" 
;*************************************************************************
	"Default HVACHeat:TotalCapacity"   	HVACHeat:TotalCapacity  = {  UNDEFINED  }
	"Set HVACHeat:TypeDescrip"		HVACHeat:TypeDescrip	= { "RTF\Ht_E.rtf" }
	"Default HVACHeat:AFUE"		HVACHeat:AFUE			= {  UNDEFINED  }
  "Set DisplayAFUE flag"		HVACHeat:DisplayAFUE	= {	0  }
END

;*************************************************************************
RULELIST "Default_Heat_CombHydro"      0 0 0 1      ; defaulting for HVACHeat:Type = "CombHydro - Water heating system can be storage gas/elec/ht pump"   
;*************************************************************************
	"Default HVACHeat:TotalCapacity"   	HVACHeat:TotalCapacity  = {  UNDEFINED  }
	"Set HVACHeat:TypeDescrip"		HVACHeat:TypeDescrip	= { "RTF\Ht_CH.rtf" }

;	"Default HVACHeat:AFUE"		HVACHeat:AFUE			= {  UNDEFINED  }
  "Set DisplayAFUE flag"		HVACHeat:DisplayAFUE	= {	0  }

; SAC 5/13/13 - properties for combined hydronic
;	"Default HVACHeat:HydronicWHType"	HVACHeat:HydronicWHType		= {	1     }		; Natural Gas
;	"Default HVACHeat:DisplayCHData"		HVACHeat:DisplayCHData		= {	HydronicWHType  }
	"Default HVACHeat:CHUCndPipeLength"	HVACHeat:CHUCndPipeLength	= {	10    }
; SAC 1/6/14 moved rule logic up from PostProposedInput rules here to incorporate into normal system efficiency defaulting (and fix GC issue #254)
;	"Default HVACHeat:CHRecoveryEff"		HVACHeat:CHRecoveryEff		= {	76    }   ; SAC 7/8/13 - switched default from fraction to % (0.76 -> 76)
	"Default HVACHeat:CHRecoveryEff"		HVACHeat:CHRecoveryEff		= {	if (HVACHeat:Type = 9 .AND. LocalCompAssigned( CHWHeater ))
																								then	if (LocalStatus( CHWHeater:RecovEff ) > 0) 
																										then  CHWHeater:RecovEff
																										else  70  endif
																								else  70  endif  }
	"Default HVACHeat:AFUE"		HVACHeat:AFUE			= {  CHRecoveryEff  }
	"Set HVACHeat:CombHydronicMsg"		HVACHeat:CombHydronicMsg	= {	if (CHUCndPipeLength > 10)
																								then  "Current pipe length limit is 10 ft."  else  " "  endif  }
END

; SAC 11/3/14 - added to ensure that AFUE left over from previous model edits don't impact future runs (GC issue 396)
RULELIST "ForceDefault_Heat_CombHydro_AFUE"  1 0 0 1      
	"Default HVACHeat:AFUE"		HVACHeat:AFUE			= {  CHRecoveryEff  }
END   

; SAC 6/14/17 - toggled OFF Precooling access for 2019.0.4 release
RULELIST "ForceDefault_UsePreCooling"  1 0 0 1      
   "Blast Proj:UsePreCooling"   Proj:UsePreCooling  = {  UNDEFINED  }
END


;*************************************************************************
RULELIST "Default_Heat_unknown" 0 0 0 1
;*************************************************************************
	"Default HVACHeat:TotalCapacity"   	HVACHeat:TotalCapacity  = {  UNDEFINED  }
	"Set HVACHeat:TypeDescrip"				HVACHeat:TypeDescrip		= { "RTF\blank.rtf" }
	"Default HVACHeat:AFUE"		HVACHeat:AFUE			= {  UNDEFINED  }
   "Set DisplayAFUE flag"		HVACHeat:DisplayAFUE	= {	0  }
   "Set HVACHeat:MinAFUE"     HVACHeat:MinAFUE     = {  UNDEFINED  }          ; SAC 08/24/20 (tic #1227)
END


;*************************************************************************
RULELIST "Default_HtPump_SplitHeatPump"  0 0 0 1      ; defaulting for HVACHtPump:Type = "SplitHeatPump - Heating side of central split heat pump"            
;*************************************************************************
	"Default HVACHtPump:TotalCapacity"   	HVACHtPump:TotalCapacity  = {  UNDEFINED  }
	"Set HVACHtPump:TypeDescrip"		HVACHtPump:TypeDescrip	= { "RTF\Ht_SHP.rtf" }
   "Default AutoSize"         HVACHtPump:AutoSize        = {  0  }
  "Default HSPF"				   HVACHtPump:HSPF				= {
	      if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF ) < 6) then  UNCHANGED
	      else  T24RHeatingEquipment:HSPF( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  endif  }
	"Default HVACHtPump:HSPF (via ExEDR defaulting rules)"		HVACHtPump:Action  = {
	      if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF ) < 6)
	      then  EvalRulelist( "ExEDRDefault_HVACHtPump_HSPF", 1 )  else  UNCHANGED  endif  }
;	"Default ConstHtgSetpt"		HVACHtPump:ConstHtgSetpt	= {	T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }   - already done above
  "Default Cap47"			   HVACHtPump:Cap47				= {	UNDEFINED  }
  "Default Cap35"			   HVACHtPump:Cap35				= {	UNDEFINED  }
  "Default Cap17"			   HVACHtPump:Cap17				= {	UNDEFINED  }
  "Default COP47"			   HVACHtPump:COP47				= {	UNDEFINED  }
  "Default COP35"			   HVACHtPump:COP35				= {	UNDEFINED  }
  "Default COP17"			   HVACHtPump:COP17				= {	UNDEFINED  }
  "Default AuxHtgCap"			HVACHtPump:AuxHtgCap			= {	if (LocalStatus( Cap47 ) < 2) then  UNDEFINED  else  (Cap47 * 10)  endif  }   ; SAC 8/29/13 - per Bruce e-mail

	"Default HVACHtPump:SEER"            		HVACHtPump:SEER             = {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }
	"Default HVACHtPump:EER (via rulelist)"	HVACHtPump:Action           = {		EvalRulelist( "Default_HtPump_CaliforniaSEERtoEERFormula", 1 )  }
	"Default HVACHtPump:UseEERinAnalysis"		HVACHtPump:UseEERinAnalysis = {	0  }
   "Default HVACHtPump:CEER"            	   HVACHtPump:CEER             = {  UNDEFINED  }      ; SAC 08/19/20 (tic #1003)
; mjb 1/30/15 - mods to lookup CFMperTon and ACCharge from T24RClimateZoneCodeBase
; SAC 1/5/16 - added logic to set default CFMperTon to 150 for CEC 2013/16 & IsZonal & NOT IsMultiSpeed (tic 140, comment 6/22/15) - same change to each Default_HtPump_* rulelist
	"Default HVACHtPump:CFMperTon"       		HVACHtPump:CFMperTon        = {	if ((Proj:StdDesignBase == 2013 .OR. Proj:StdDesignBase >= 2016) .AND. IfValidAnd( ShowMultiSpeed > 0 ) .AND. IsMultiSpeed < 0.5 .AND.
																													IfValidAnd( ShowIsZonal > 0 ) .AND. IsZonal > 0.5 ) then  150
																										else	T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif  }
	"Default HVACHtPump:ACCharge"        		HVACHtPump:ACCharge         = {  if ( T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 ) then "Verified" else "Not Verified" endif }    ; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	"Default HVACHtPump:RefrigerantType" 		HVACHtPump:RefrigerantType  = {  "R410A"         }
	"Default HVACHtPump:RefrigChgAdjFctr"		HVACHtPump:RefrigChgAdjFctr = {	switch (ACCharge)
																											case  2 :  0.96		; "Verified"
																											case  3 :  0.96		; 2013: "CID (charge indicator)"  2016: "FID (fault indicator)"
																											default :  0.90		; "Not Verified" (or any other setting)
																										endswitch    }
END

;*************************************************************************
RULELIST "Default_HtPump_PkgTermHeatPump"  0 0 0 1      ; defaulting for HVACHtPump:Type = "PkgTermHeatPump - Packaged terminal heat pump (PTHP)" -AND- "SglPkgVertHeatPump - Single package vertical heat pump"  ; SAC 6/22/20 (tic #1225 & #1226)
;*************************************************************************
	"Default HVACHtPump:TotalCapacity"   	HVACHtPump:TotalCapacity  = {  UNDEFINED  }
	"Set HVACHtPump:TypeDescrip"		HVACHtPump:TypeDescrip	= 
	   {  switch (Type)
	         case  26 :  "RTF\Ht_PTHP.rtf"             ; SAC 7/3/20 (tic #1225)
	         case  24 :  "RTF\Ht_SglPkgVertHP.rtf"     ; SAC 7/3/20 (tic #1226)
	         default  :  UNDEFINED  endswitch  }
   "Default AutoSize"         HVACHtPump:AutoSize        = {  0  }
  "Default HSPF"				   HVACHtPump:HSPF				= {  UNDEFINED  }
	"Default HVACHtPump:HSPF (via ExEDR defaulting rules)"		HVACHtPump:Action  = {
	      if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF ) < 6)
	      then  EvalRulelist( "ExEDRDefault_HVACHtPump_HSPF", 1 )  else  UNCHANGED  endif  }
;	"Default ConstHtgSetpt"		HVACHtPump:ConstHtgSetpt	= {	T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }   - already done above
  "Default Cap47"			   HVACHtPump:Cap47				= {	UNDEFINED  }
  "Default Cap35"			   HVACHtPump:Cap35				= {	UNDEFINED  }
  "Default Cap17"			   HVACHtPump:Cap17				= {	UNDEFINED  }
  "Default COP47"			   HVACHtPump:COP47				= {
	      if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( COP47 ) < 6) then  UNCHANGED
	      else  T24RHeatingEquipment:COP47( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  endif  }
  "Default COP35"			   HVACHtPump:COP35				= {	UNDEFINED  }
  "Default COP17"			   HVACHtPump:COP17				= {	UNDEFINED  }
  "Default AuxHtgCap"		HVACHtPump:AuxHtgCap			= {	UNDEFINED  }   ; if (LocalStatus( Cap47 ) < 2) then  UNDEFINED  else  (Cap47 * 10)  endif  }   ; SAC 8/29/13 - per Bruce e-mail

	"Default HVACHtPump:SEER"            		HVACHtPump:SEER             = {   UNDEFINED  }   ; T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }
	"Default HVACHtPump:EER"            		HVACHtPump:EER              = {   T24RCoolingEquipment:EER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }
	"Default HVACHtPump:UseEERinAnalysis"		HVACHtPump:UseEERinAnalysis = {	1  }
   "Default HVACHtPump:CEER"            	   HVACHtPump:CEER             = {  UNDEFINED  }      ; SAC 08/19/20 (tic #1003)
	"Default HVACHtPump:CFMperTon"       		HVACHtPump:CFMperTon        = {	T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  }
	"Default HVACHtPump:ACCharge"        		HVACHtPump:ACCharge         = {  if ( T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 ) then "Verified" else "Not Verified" endif } 
	"Default HVACHtPump:RefrigerantType" 		HVACHtPump:RefrigerantType  = {  "R410A"         }
	"Default HVACHtPump:RefrigChgAdjFctr"		HVACHtPump:RefrigChgAdjFctr = {  0.96  }         ; was: switch (ACCharge) -> 0.96 or 0.9 - SAC 08/21/20 (tic #1003)
END

;*************************************************************************
RULELIST "Default_HtPump_SDHVSplitHeatPump"  0 0 0 1      ; defaulting for HVACHtPump:Type = "SDHVSplitHeatPump - Small duct, high velocity, central split heat pump"            
;*************************************************************************
	"Default HVACHtPump:TotalCapacity"  HVACHtPump:TotalCapacity  = {  UNDEFINED  }
	"Set HVACHtPump:TypeDescrip"			HVACHtPump:TypeDescrip	= { "RTF\Ht_SDHVSHP.rtf" }
   "Default AutoSize"         HVACHtPump:AutoSize        = {  0  }
  "Default HSPF"				   HVACHtPump:HSPF				= {
	      if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF ) < 6) then  UNCHANGED
	      else  T24RHeatingEquipment:HSPF( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  endif  }
	"Default HVACHtPump:HSPF (via ExEDR defaulting rules)"		HVACHtPump:Action  = {
	      if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF ) < 6)
	      then  EvalRulelist( "ExEDRDefault_HVACHtPump_HSPF", 1 )  else  UNCHANGED  endif  }
;	"Default ConstHtgSetpt"		HVACHtPump:ConstHtgSetpt	= {	T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }   - already done above
  "Default Cap47"			   HVACHtPump:Cap47				= {	UNDEFINED  }
  "Default Cap35"			   HVACHtPump:Cap35				= {	UNDEFINED  }
  "Default Cap17"			   HVACHtPump:Cap17				= {	UNDEFINED  }
  "Default COP47"			   HVACHtPump:COP47				= {	UNDEFINED  }
  "Default COP35"			   HVACHtPump:COP35				= {	UNDEFINED  }
  "Default COP17"			   HVACHtPump:COP17				= {	UNDEFINED  }
  "Default AuxHtgCap"			HVACHtPump:AuxHtgCap			= {	if (LocalStatus( Cap47 ) < 2) then  UNDEFINED  else  (Cap47 * 10)  endif  }   ; SAC 8/29/13 - per Bruce e-mail

	"Default HVACHtPump:SEER"            		HVACHtPump:SEER             = {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }
	"Default HVACHtPump:EER (via rulelist)"	HVACHtPump:Action           = {		EvalRulelist( "Default_HtPump_CaliforniaSEERtoEERFormula", 1 )  }
	"Default HVACHtPump:UseEERinAnalysis"		HVACHtPump:UseEERinAnalysis = {	0  }
   "Default HVACHtPump:CEER"            	   HVACHtPump:CEER             = {  UNDEFINED  }      ; SAC 08/19/20 (tic #1003)
; mjb 1/30/15 - mods to lookup CFMperTon and ACCharge from T24RClimateZoneCodeBase
; SAC 1/5/16 - added logic to set default CFMperTon to 150 for CEC 2013/16 & IsZonal & NOT IsMultiSpeed (tic 140, comment 6/22/15) - same change to each Default_HtPump_* rulelist
	; SAC 8/19/19 - added logic to set SDHV default CFMperTon to 250 for 2019+ models (tic #1041)   - SAC 10/27/19 - added logic to ensure results for 2019.1.1 consistent w/ 2019.1.0
	"Default HVACHtPump:CFMperTon"       		HVACHtPump:CFMperTon        = {	if ((Proj:StdDesignBase == 2013 .OR. Proj:StdDesignBase >= 2016) .AND. IfValidAnd( ShowMultiSpeed > 0 ) .AND. IsMultiSpeed < 0.5 .AND.
																													IfValidAnd( ShowIsZonal > 0 ) .AND. IsZonal > 0.5 ) then  150
	                                                                           else if (Proj:StdDesignBase >= 2019 .AND. IfValidAnd( Proj:AnalysisVersion > 190101 )) then  250
																										else	T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif endif  }
	"Default HVACHtPump:ACCharge"        		HVACHtPump:ACCharge         = {  if ( T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 ) then "Verified" else "Not Verified" endif }    ; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	"Default HVACHtPump:RefrigerantType" 		HVACHtPump:RefrigerantType  = {  "R410A"         }
	"Default HVACHtPump:RefrigChgAdjFctr"		HVACHtPump:RefrigChgAdjFctr = {	switch (ACCharge)
																											case  2 :  0.96		; "Verified"
																											case  3 :  0.96		; 2013: "CID (charge indicator)"  2016: "FID (fault indicator)"
																											default :  0.90		; "Not Verified" (or any other setting)
																										endswitch    }
END

; SAC 6/22/20 - revised rulelist to handle prior DuctlessMultiSplitHeatPump and new types DuctedMiniSplitHeatPump, DuctedMultiSplitHeatPump & Ducted+DuctlessMultiSplitHeatPump (tic #1229)
;*************************************************************************
RULELIST "Default_HtPump_DuctlessMiniSplitHeatPump"  0 0 0 1      ; defaulting for HVACHtPump:Type = "DuctlessHeatPump - Heating side of ductless mini-split heat pump"
;*************************************************************************
	"Default HVACHtPump:TotalCapacity"   	HVACHtPump:TotalCapacity  = {  UNDEFINED  }
	"Set HVACHtPump:TypeDescrip"		HVACHtPump:TypeDescrip	=
	   {  switch (Type)
	         case  10 :  "RTF\Ht_DuctlessMiniSHP.rtf"
	         case  20 :  "RTF\Ht_DuctlessMultiSHP.rtf"
	         case  28 :  "RTF\Ht_DuctedMiniSHP.rtf"
	         case  30 :  "RTF\Ht_DuctedMultiSHP.rtf"
	         case  32 :  "RTF\Ht_DuctedDuctlessMultiSHP.rtf"
	         default  :  UNDEFINED  endswitch  }
   "Default AutoSize"         HVACHtPump:AutoSize        = {  0  }
   "Default HSPF"				   HVACHtPump:HSPF				= {
	      if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF ) < 6) then  UNCHANGED
	      else  T24RHeatingEquipment:HSPF( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  endif  }
	"Default HVACHtPump:HSPF (via ExEDR defaulting rules)"		HVACHtPump:Action  = {
	      if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF ) < 6)
	      then  EvalRulelist( "ExEDRDefault_HVACHtPump_HSPF", 1 )  else  UNCHANGED  endif  }
;	"Default ConstHtgSetpt"		HVACHtPump:ConstHtgSetpt	= {	T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }   - already done above
  "Default Cap47"			   HVACHtPump:Cap47				= {	UNDEFINED  }
  "Default Cap35"			   HVACHtPump:Cap35				= {	UNDEFINED  }
  "Default Cap17"			   HVACHtPump:Cap17				= {	UNDEFINED  }
  "Default COP47"			   HVACHtPump:COP47				= {	UNDEFINED  }
  "Default COP35"			   HVACHtPump:COP35				= {	UNDEFINED  }
  "Default COP17"			   HVACHtPump:COP17				= {	UNDEFINED  }
  "Default AuxHtgCap"			HVACHtPump:AuxHtgCap			= {	if (LocalStatus( Cap47 ) < 2) then  UNDEFINED  else  (Cap47 * 10)  endif  }   ; SAC 8/29/13 - per Bruce e-mail

	"Default HVACHtPump:SEER"            		HVACHtPump:SEER             = {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }
	"Default HVACHtPump:EER (via rulelist)"	HVACHtPump:Action           = {		EvalRulelist( "Default_HtPump_CaliforniaSEERtoEERFormula", 1 )  }
	"Default HVACHtPump:UseEERinAnalysis"		HVACHtPump:UseEERinAnalysis = {	0  }
   "Default HVACHtPump:CEER"            	   HVACHtPump:CEER             = {  UNDEFINED  }      ; SAC 08/19/20 (tic #1003)
	"Default HVACHtPump:CFMperTon"       		HVACHtPump:CFMperTon        = {  UNDEFINED  }	; mjb 8/26/14 - mini-splits don't include this in the user input spec
	"Default HVACHtPump:ACCharge"        		HVACHtPump:ACCharge         = {  UNDEFINED  }   ; mjb 8/26/14 - mini-splits don't include this in the user input spec
	"Default HVACHtPump:RefrigerantType" 		HVACHtPump:RefrigerantType  = {  "R410A"         }
	"Default HVACHtPump:RefrigChgAdjFctr"		HVACHtPump:RefrigChgAdjFctr = {	UNDEFINED  }
END

;*************************************************************************
RULELIST "Default_HtPump_DuctlessVRFHeatPump"  0 0 0 1    ; defaulting for HVACHtPump:Type = "DuctlessVRFHeatPump"
;*************************************************************************
	"Default HVACHtPump:TotalCapacity"   	HVACHtPump:TotalCapacity  = {  UNDEFINED  }
	"Set HVACHtPump:TypeDescrip"		      HVACHtPump:TypeDescrip	  = { "RTF\Ht_DuctlessVRFHP.rtf" }
   "Default AutoSize"         HVACHtPump:AutoSize        = {  0  }
  "Default HSPF"				 HVACHtPump:HSPF				= {
	      if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF ) < 6) then  UNCHANGED
	      else  T24RHeatingEquipment:HSPF( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  endif  }
	"Default HVACHtPump:HSPF (via ExEDR defaulting rules)"		HVACHtPump:Action  = {
	      if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF ) < 6)
	      then  EvalRulelist( "ExEDRDefault_HVACHtPump_HSPF", 1 )  else  UNCHANGED  endif  }
  "Default Cap47"			   HVACHtPump:Cap47				= {	UNDEFINED  }
  "Default Cap35"			   HVACHtPump:Cap35				= {	UNDEFINED  }
  "Default Cap17"			   HVACHtPump:Cap17				= {	UNDEFINED  }
  "Default COP47"			   HVACHtPump:COP47				= {	UNDEFINED  }
  "Default COP35"			   HVACHtPump:COP35				= {	UNDEFINED  }
  "Default COP17"			   HVACHtPump:COP17				= {	UNDEFINED  }
  "Default AuxHtgCap"		 HVACHtPump:AuxHtgCap			= {	if (LocalStatus( Cap47 ) < 2) then  UNDEFINED  else  (Cap47 * 10)  endif  }

	"Default HVACHtPump:SEER"            		HVACHtPump:SEER             = {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }
	"Default HVACHtPump:EER (via rulelist)"	HVACHtPump:Action           = {		EvalRulelist( "Default_HtPump_CaliforniaSEERtoEERFormula", 1 )  }
	"Default HVACHtPump:UseEERinAnalysis"		HVACHtPump:UseEERinAnalysis = {	0  }
   "Default HVACHtPump:CEER"            	   HVACHtPump:CEER             = {  UNDEFINED  }      ; SAC 08/19/20 (tic #1003)
	"Default HVACHtPump:CFMperTon"       		HVACHtPump:CFMperTon        = {  UNDEFINED  }
	"Default HVACHtPump:ACCharge"        		HVACHtPump:ACCharge         = {  UNDEFINED  }
	"Default HVACHtPump:RefrigerantType" 		HVACHtPump:RefrigerantType  = {  "R410A"         }
	"Default HVACHtPump:RefrigChgAdjFctr"		HVACHtPump:RefrigChgAdjFctr = {	UNDEFINED  }

END

;*************************************************************************
RULELIST "Default_HtPump_PkgHeatPump"    0 0 0 1    ; defaulting for HVACHtPump:Type = "PkgHeatPump - Heating side of central packaged heat pump"
;*************************************************************************
	"Default HVACHtPump:TotalCapacity"   	HVACHtPump:TotalCapacity  = {  UNDEFINED  }
	"Set HVACHtPump:TypeDescrip"		HVACHtPump:TypeDescrip	= { "RTF\Ht_PHP.rtf" }
   "Default AutoSize"         HVACHtPump:AutoSize        = {  0  }
  "Default HSPF"				   HVACHtPump:HSPF				= {
	      if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF ) < 6) then  UNCHANGED
	      else  T24RHeatingEquipment:HSPF( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  endif  }
	"Default HVACHtPump:HSPF (via ExEDR defaulting rules)"		HVACHtPump:Action  = {
	      if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF ) < 6)
	      then  EvalRulelist( "ExEDRDefault_HVACHtPump_HSPF", 1 )  else  UNCHANGED  endif  }
;	"Default ConstHtgSetpt"		HVACHtPump:ConstHtgSetpt	= {	T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }   - already done above

	"Default HVACHtPump:SEER"            		HVACHtPump:SEER             = {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }
	"Default HVACHtPump:EER (via rulelist)"	HVACHtPump:Action           = {		EvalRulelist( "Default_HtPump_CaliforniaSEERtoEERFormula", 1 )  }
	"Default HVACHtPump:UseEERinAnalysis"		HVACHtPump:UseEERinAnalysis = {	0  }
   "Default HVACHtPump:CEER"            	   HVACHtPump:CEER             = {  UNDEFINED  }      ; SAC 08/19/20 (tic #1003)
; mjb 1/30/15 - mods to lookup CFMperTon and ACCharge from T24RClimateZoneCodeBase
	"Default HVACHtPump:CFMperTon"       		HVACHtPump:CFMperTon        = {  if ((Proj:StdDesignBase == 2013 .OR. Proj:StdDesignBase >= 2016) .AND. IfValidAnd( ShowMultiSpeed > 0 ) .AND. IsMultiSpeed < 0.5 .AND.
																													IfValidAnd( ShowIsZonal > 0 ) .AND. IsZonal > 0.5 ) then  150
																										else	T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif  }
	"Default HVACHtPump:ACCharge"        		HVACHtPump:ACCharge         = {  if ( T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 ) then "Verified" else "Not Verified" endif }    ; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	"Default HVACHtPump:RefrigerantType" 		HVACHtPump:RefrigerantType  = {  "R410A"         }
	"Default HVACHtPump:RefrigChgAdjFctr"		HVACHtPump:RefrigChgAdjFctr	= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "Default_HtPump_LrgPkgHeatPump" 0 0 0 1      ; defaulting for HVACHtPump:Type = "LrgPkgHeatPump - Heating side of large (>= 65 kBtuh) packaged unit" 
;*************************************************************************
	"Default HVACHtPump:TotalCapacity"   	HVACHtPump:TotalCapacity  = {  UNDEFINED  }
	"Set HVACHtPump:TypeDescrip"		HVACHtPump:TypeDescrip	= { "RTF\Ht_LPHP.rtf" }
   "Default AutoSize"         HVACHtPump:AutoSize        = {  0  }

; DR: This system is not available, so rules have been commented until the system is made available
;	"Default HVACHtPump:SEER"            		HVACHtPump:SEER             = {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  };
;	"Default HVACHtPump:EER (via rulelist)"	HVACHtPump:Action           = {		EvalRulelist( "Default_HtPump_CaliforniaSEERtoEERFormula", 1 )  }
	"Default HVACHtPump:UseEERinAnalysis"		HVACHtPump:UseEERinAnalysis = {	0  }
   "Default HVACHtPump:CEER"            	   HVACHtPump:CEER             = {  UNDEFINED  }      ; SAC 08/19/20 (tic #1003)
; mjb 1/30/15 - mods to lookup CFMperTon and ACCharge from T24RClimateZoneCodeBase
;	"Default HVACHtPump:CFMperTon"       		HVACHtPump:CFMperTon        = {  if ((Proj:StdDesignBase == 2013 .OR. Proj:StdDesignBase >= 2016) .AND. IfValidAnd( ShowMultiSpeed > 0 ) .AND. IsMultiSpeed < 0.5 .AND.
;																													IfValidAnd( ShowIsZonal > 0 ) .AND. IsZonal > 0.5 ) then  150
;																										else	T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif  }
;	"Default HVACHtPump:ACCharge"        		HVACHtPump:ACCharge         = {  if ( T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 ) then "Verified" else "Not Verified" endif }    ; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
;	"Default HVACHtPump:RefrigerantType" 		HVACHtPump:RefrigerantType  = {  "R410A"         }
;	"Default HVACHtPump:RefrigChgAdjFctr"		HVACHtPump:RefrigChgAdjFctr = {	UNDEFINED  }
END
;*************************************************************************
RULELIST "Default_HtPump_RoomHeatPump"   0 0 0 1      ; defaulting for HVACHtPump:Type = "RoomHeatPump - Heating side of non-central room A/C system"         
;*************************************************************************
	"Default HVACHtPump:TotalCapacity"   	HVACHtPump:TotalCapacity  = {  UNDEFINED  }
	"Set HVACHtPump:TypeDescrip"		HVACHtPump:TypeDescrip	= { "RTF\Ht_RHP.rtf" }
   "Default AutoSize"         HVACHtPump:AutoSize        = {  0  }

;	"Default HVACHtPump:SEER"            		HVACHtPump:SEER             = {  T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }
;	"Default HVACHtPump:EER (via rulelist)"	HVACHtPump:Action           = {	EvalRulelist( "Default_HtPump_CaliforniaSEERtoEERFormula", 1 )  }
	"Default HVACHtPump:UseEERinAnalysis"		HVACHtPump:UseEERinAnalysis = {	0  }
   "Default HVACHtPump:CEER"            	   HVACHtPump:CEER             = {  T24RCoolingEquipment:CEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }     ; SAC 08/19/20 (tic #1003)
	"Default HVACHtPump:CFMperTon"       		HVACHtPump:CFMperTon        = {  350  }
	"Default HVACHtPump:ACCharge"        		HVACHtPump:ACCharge         = {  "Verified"  }   ; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	"Default HVACHtPump:RefrigerantType" 		HVACHtPump:RefrigerantType  = {  "R410A"         }
	"Default HVACHtPump:RefrigChgAdjFctr"		HVACHtPump:RefrigChgAdjFctr = {	UNDEFINED  }
END
;*************************************************************************
RULELIST "Default_HtPump_AirToWaterHeatPump"   0 0 0 1      ; defaulting for HVACHtPump:Type = "AirToWaterHeatPump - Air to water heat pump (able to heat DHW)"
;*************************************************************************
	"Default HVACHtPump:TotalCapacity"   	HVACHtPump:TotalCapacity  = {  UNDEFINED  }
	"Set HVACHtPump:TypeDescrip"		HVACHtPump:TypeDescrip	= { "RTF\Ht_AWHP.rtf" }
   "Default AutoSize"         HVACHtPump:AutoSize        = {  0  }
;	"Default HSPF"				   HVACHtPump:HSPF				= {	T24RHeatingEquipment:HSPF( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }
;	"Default ConstHtgSetpt"		HVACHtPump:ConstHtgSetpt	= {	T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }   - already done above

	"Default HVACHtPump:SEER"            		HVACHtPump:SEER             = {  UNDEFINED  }
	"Default HVACHtPump:EER"            		HVACHtPump:EER              = {   T24RCoolingEquipment:EER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }
	"Default HVACHtPump:UseEERinAnalysis"		HVACHtPump:UseEERinAnalysis = {	0  }
   "Default HVACHtPump:CEER"            	   HVACHtPump:CEER             = {  UNDEFINED  }      ; SAC 08/19/20 (tic #1003)
END

;*************************************************************************
RULELIST "Default_HtPump_GroundSourceHeatPump"  0 0 0 1
;*************************************************************************
	"Default HVACHtPump:TotalCapacity"   	HVACHtPump:TotalCapacity  = {  UNDEFINED  }
	"Set HVACHtPump:TypeDescrip"		HVACHtPump:TypeDescrip	= { "RTF\Ht_GSHP.rtf" }
   "Default AutoSize"         HVACHtPump:AutoSize        = {  0  }

   "Default HSPF"				   HVACHtPump:HSPF				= {
	      if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF ) < 6) then  UNCHANGED
	      else  T24RHeatingEquipment:HSPF( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  endif  }
	"Default HVACHtPump:HSPF (via ExEDR defaulting rules)"		HVACHtPump:Action  = {
	      if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF ) < 6)
	      then  EvalRulelist( "ExEDRDefault_HVACHtPump_HSPF", 1 )  else  UNCHANGED  endif  }
;	"Default ConstHtgSetpt"		HVACHtPump:ConstHtgSetpt	= {	T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }   - already done above
   "Default Cap47"			   HVACHtPump:Cap47				= {	UNDEFINED  }
   "Default Cap35"			   HVACHtPump:Cap35				= {	UNDEFINED  }
   "Default Cap17"			   HVACHtPump:Cap17				= {	UNDEFINED  }
   "Default COP47"			   HVACHtPump:COP47				= {	UNDEFINED  }
   "Default COP35"			   HVACHtPump:COP35				= {	UNDEFINED  }
   "Default COP17"			   HVACHtPump:COP17				= {	UNDEFINED  }
   "Default AuxHtgCap"			HVACHtPump:AuxHtgCap			= {	if (LocalStatus( Cap47 ) < 2) then  UNDEFINED  else  (Cap47 * 10)  endif  }   ; SAC 8/29/13 - per Bruce e-mail

	"Default HVACHtPump:SEER"            		HVACHtPump:SEER             = {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }
	"Default HVACHtPump:EER (via rulelist)"	HVACHtPump:Action           = {		EvalRulelist( "Default_HtPump_CaliforniaSEERtoEERFormula", 1 )  }
	"Default HVACHtPump:UseEERinAnalysis"		HVACHtPump:UseEERinAnalysis = {	0  }
   "Default HVACHtPump:CEER"            	   HVACHtPump:CEER             = {  UNDEFINED  }      ; SAC 08/19/20 (tic #1003)
; mjb 1/30/15 - mods to lookup CFMperTon and ACCharge from T24RClimateZoneCodeBase
	"Default HVACHtPump:CFMperTon"       		HVACHtPump:CFMperTon        = {	if ((Proj:StdDesignBase == 2013 .OR. Proj:StdDesignBase >= 2016) .AND. IfValidAnd( ShowMultiSpeed > 0 ) .AND. IsMultiSpeed < 0.5 .AND.
																													IfValidAnd( ShowIsZonal > 0 ) .AND. IsZonal > 0.5 ) then  150
																										else	T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif  }
	"Default HVACHtPump:ACCharge"        		HVACHtPump:ACCharge         = {  if ( T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 ) then "Verified" else "Not Verified" endif }    ; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	"Default HVACHtPump:RefrigerantType" 		HVACHtPump:RefrigerantType  = {  "R410A"         }
	"Default HVACHtPump:RefrigChgAdjFctr"		HVACHtPump:RefrigChgAdjFctr = {	switch (ACCharge)
																											case  2 :  0.96		; "Verified"
																											case  3 :  0.96		; 2013: "CID (charge indicator)"  2016: "FID (fault indicator)"
																											default :  0.90		; "Not Verified" (or any other setting)
																										endswitch    }
END
;*************************************************************************    ; SAC 11/2/18 - VCHP
RULELIST "Default_HtPump_VariableCapHeatPump" 0 0 0 1
;*************************************************************************
	"Default HVACHtPump:TotalCapacity"   	HVACHtPump:TotalCapacity  = {  UNDEFINED  }
	"Set HVACHtPump:TypeDescrip"			HVACHtPump:TypeDescrip	= { "RTF\Ht_VCHP.rtf" }
   "Default AutoSize"         HVACHtPump:AutoSize        = {  0  }

   "Default HSPF"				   HVACHtPump:HSPF				= {  8.2  }
;	"Default HVACHtPump:HSPF (via ExEDR defaulting rules)"		HVACHtPump:Action  = {
;	      if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF ) < 6)
;	      then  EvalRulelist( "ExEDRDefault_HVACHtPump_HSPF", 1 )  else  UNCHANGED  endif  }
;	"Default ConstHtgSetpt"		HVACHtPump:ConstHtgSetpt	= {	T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }   - already done above
   "Default Cap47"			   HVACHtPump:Cap47				= {	UNDEFINED  }
   "Default Cap35"			   HVACHtPump:Cap35				= {	UNDEFINED  }
   "Default Cap17"			   HVACHtPump:Cap17				= {	UNDEFINED  }
   "Default COP47"			   HVACHtPump:COP47				= {	UNDEFINED  }
   "Default COP35"			   HVACHtPump:COP35				= {	UNDEFINED  }
   "Default COP17"			   HVACHtPump:COP17				= {	UNDEFINED  }
   "Reset AuxHtgCap"			   HVACHtPump:AuxHtgCap			= {	UNDEFINED  }
;   "Default AuxHtgCap"			HVACHtPump:AuxHtgCap			= {	if (LocalStatus( Cap47 ) < 2) then  UNDEFINED  else  (Cap47 * 10)  endif  }   ; SAC 8/29/13 - per Bruce e-mail

	"Default HVACHtPump:SEER"            		HVACHtPump:SEER             = {  14  }  ; SAC 11/4/18 - based on inputs specified in e-mail from CB 11/2/18
;	"Default HVACHtPump:EER (via rulelist)"	HVACHtPump:Action           = {		EvalRulelist( "Default_HtPump_CaliforniaSEERtoEERFormula", 1 )  }
	"Default HVACHtPump:EER"            		HVACHtPump:EER              = {  11.6  }
	"Default HVACHtPump:UseEERinAnalysis"		HVACHtPump:UseEERinAnalysis = {	1  }     ; SAC 11/13/18 - toggled to 1 to allow edits in UI
   "Default HVACHtPump:CEER"            	   HVACHtPump:CEER             = {  UNDEFINED  }      ; SAC 08/19/20 (tic #1003)
; mjb 1/30/15 - mods to lookup CFMperTon and ACCharge from T24RClimateZoneCodeBase
	"Default HVACHtPump:CFMperTon"       		HVACHtPump:CFMperTon        = {	if ((Proj:StdDesignBase == 2013 .OR. Proj:StdDesignBase >= 2016) .AND. IfValidAnd( ShowMultiSpeed > 0 ) .AND. IsMultiSpeed < 0.5 .AND.
																													IfValidAnd( ShowIsZonal > 0 ) .AND. IsZonal > 0.5 ) then  150
																										else	T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif  }
	"Default HVACHtPump:ACCharge"        		HVACHtPump:ACCharge         = {  "Verified"  }    ; SAC 11/13/18 - always verified for VCHP
;	"Default HVACHtPump:ACCharge"        		HVACHtPump:ACCharge         = {  if ( T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 ) then "Verified" else "Not Verified" endif }    ; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	"Default HVACHtPump:RefrigerantType" 		HVACHtPump:RefrigerantType  = {  "R410A"         }
	"Default HVACHtPump:RefrigChgAdjFctr"		HVACHtPump:RefrigChgAdjFctr = {	0.96	}

; SAC 11/4/18 - added for VCHP
   ; defaulted via enums: HVACHtPump:VCHPDucts =  0: Unducted / 1: Ducted / 2: Partially Ducted
   "Default HVACHtPump:VCHPCertAutoFan"      HVACHtPump:VCHPCertAutoFan  = {  0  }
   "Set HVACHtPump:VCHPFanPower"    HVACHtPump:VCHPFanPower = {
         if (IfValidAnd( Cap47 > 0 )==0 .OR. VCHPCertAutoFan > 0) then  0
         else  switch (VCHPDucts)
                  case  1 :  50 * Cap47 / 12000  ; ducted
                  case  2 :  25 * Cap47 / 12000  ; partially ducted
                  default :  0
               endswitch endif  }
; RJH 2/13/20 tic #1176
   "Set HVACHtPump:SpeclFeatrs_ComplianceOptionVCHP"    HVACHtPump:SpeclFeatrs_ComplianceOptionVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then 1
           else UNCHANGED
           endif  }
   "Set HVACHtPump:HERS_LowLeakageDuctsInConditionedSpace"    HVACHtPump:HERS_LowLeakageDuctsInConditionedSpace = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set HVACHtPump:HERS_DuctsInConditionedSpaceTested"    HVACHtPump:HERS_DuctsInConditionedSpaceTested = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set HVACHtPump:HERS_LowStaticVCHP"    HVACHtPump:HERS_LowStaticVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set HVACHtPump:HERS_AirToHabitableRoomsVCHP"    HVACHtPump:HERS_AirToHabitableRoomsVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 1
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set HVACHtPump:HERS_MinimumAirflowVCHP"    HVACHtPump:HERS_MinimumAirflowVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set HVACHtPump:HERS_WallThermostatVCHP"    HVACHtPump:HERS_WallThermostatVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 1
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set HVACHtPump:HERS_DuctlessInConditionedSpaceVCHP"    HVACHtPump:HERS_DuctlessInConditionedSpaceVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 1
                     case "Ducted"            : 0
                     case "Partially Ducted"  : 0
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set HVACHtPump:HERS_FilterSizeVCHP"    HVACHtPump:HERS_FilterSizeVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set HVACHtPump:HERS_FilterPressureDropVCHP"    HVACHtPump:HERS_FilterPressureDropVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set HVACHtPump:HERS_CertifiedNonContinuousFanVCHP"    HVACHtPump:HERS_CertifiedNonContinuousFanVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : if ( VCHPCertAutoFan > 0 )
					                            then 1
												else 0 endif
                     case "Partially Ducted"  : if ( VCHPCertAutoFan > 0 )
					                            then 1
												else 0 endif
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set HVACHtPump:HERS_LowLeakageDuctsInConditionedSpace"    HVACHtPump:HERS_LowLeakageDuctsInConditionedSpace = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set HVACHtPump:HERS_CertifiedNonContinuousFanVCHP"    HVACHtPump:HERS_CertifiedNonContinuousFanVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : if ( VCHPCertAutoFan > 0 )
					                            then 1
												else 0 endif
                     case "Partially Ducted"  : if ( VCHPCertAutoFan > 0 )
					                            then 1
												else 0 endif
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
END
;*************************************************************************    ; VCHP2 - SAC 11/01/20
RULELIST "Default_HtPump_VariableCapHeatPump2" 0 0 0 1
;*************************************************************************
	"Default HVACHtPump:TotalCapacity"   	HVACHtPump:TotalCapacity  = {  UNDEFINED  }
	"Set HVACHtPump:TypeDescrip"			HVACHtPump:TypeDescrip	= { "RTF\Ht_VCHPdetailed.rtf" }     ; SAC 09/22/21
   "Default AutoSize"         HVACHtPump:AutoSize        = {  if (IfValidAnd( Proj:EnableHPAutosize > 0 )) then  1  else  0  endif  }     ; VCHP2 - SAC 11/10/20

   "Default HSPF"				   HVACHtPump:HSPF				= {  8.2  }
;	"Default HVACHtPump:HSPF (via ExEDR defaulting rules)"		HVACHtPump:Action  = {
;	      if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF ) < 6)
;	      then  EvalRulelist( "ExEDRDefault_HVACHtPump_HSPF", 1 )  else  UNCHANGED  endif  }
;	"Default ConstHtgSetpt"		HVACHtPump:ConstHtgSetpt	= {	T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }   - already done above
   "Default Cap47"			   HVACHtPump:Cap47				= {	UNDEFINED  }
   "Default Cap35"			   HVACHtPump:Cap35				= {	UNDEFINED  }
   "Default Cap17"			   HVACHtPump:Cap17				= {	UNDEFINED  }
   "Default COP47"			   HVACHtPump:COP47				= {	UNDEFINED  }
   "Default COP35"			   HVACHtPump:COP35				= {	UNDEFINED  }
   "Default COP17"			   HVACHtPump:COP17				= {	UNDEFINED  }
   "Reset AuxHtgCap"			   HVACHtPump:AuxHtgCap			= {	UNDEFINED  }
;   "Default AuxHtgCap"			HVACHtPump:AuxHtgCap			= {	if (LocalStatus( Cap47 ) < 2) then  UNDEFINED  else  (Cap47 * 10)  endif  }   ; SAC 8/29/13 - per Bruce e-mail

	"Default HVACHtPump:SEER"            		HVACHtPump:SEER             = {  14  }  ; SAC 11/4/18 - based on inputs specified in e-mail from CB 11/2/18
;	"Default HVACHtPump:EER (via rulelist)"	HVACHtPump:Action           = {		EvalRulelist( "Default_HtPump_CaliforniaSEERtoEERFormula", 1 )  }
	"Default HVACHtPump:EER"            		HVACHtPump:EER              = {  11.6  }
	"Default HVACHtPump:UseEERinAnalysis"		HVACHtPump:UseEERinAnalysis = {	1  }     ; SAC 11/13/18 - toggled to 1 to allow edits in UI
   "Default HVACHtPump:CEER"            	   HVACHtPump:CEER             = {  UNDEFINED  }      ; SAC 08/19/20 (tic #1003)
; mjb 1/30/15 - mods to lookup CFMperTon and ACCharge from T24RClimateZoneCodeBase
	"Default HVACHtPump:CFMperTon"       		HVACHtPump:CFMperTon        = {	if ((Proj:StdDesignBase == 2013 .OR. Proj:StdDesignBase >= 2016) .AND. IfValidAnd( ShowMultiSpeed > 0 ) .AND. IsMultiSpeed < 0.5 .AND.
																													IfValidAnd( ShowIsZonal > 0 ) .AND. IsZonal > 0.5 ) then  150
																										else	T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif  }
	"Default HVACHtPump:ACCharge"        		HVACHtPump:ACCharge         = {  "Verified"  }    ; SAC 11/13/18 - always verified for VCHP
;	"Default HVACHtPump:ACCharge"        		HVACHtPump:ACCharge         = {  if ( T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 ) then "Verified" else "Not Verified" endif }    ; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	"Default HVACHtPump:RefrigerantType" 		HVACHtPump:RefrigerantType  = {  "R410A"         }
	"Default HVACHtPump:RefrigChgAdjFctr"		HVACHtPump:RefrigChgAdjFctr = {	switch (ACCharge)
																											case  2 :  0.96		; "Verified"
																											case  3 :  0.96		; 2013: "CID (charge indicator)"  2016: "FID (fault indicator)"
																											default :  0.90		; "Not Verified" (or any other setting)
																										endswitch    }

; removed for VCHP2 - SAC 08/02/21
;; SAC 11/4/18 - added for VCHP
;   ; defaulted via enums: HVACHtPump:VCHPDucts =  0: Unducted / 1: Ducted / 2: Partially Ducted
;   "Default HVACHtPump:VCHPCertAutoFan"      HVACHtPump:VCHPCertAutoFan  = {  0  }
;   "Set HVACHtPump:VCHPFanPower"    HVACHtPump:VCHPFanPower = {
;         if (IfValidAnd( Cap47 > 0 )==0 .OR. VCHPCertAutoFan > 0) then  0
;         else  switch (VCHPDucts)
;                  case  1 :  50 * Cap47 / 12000  ; ducted
;                  case  2 :  25 * Cap47 / 12000  ; partially ducted
;                  default :  0
;               endswitch endif }

         ; VCHP2 additions - SAC 11/10/20
;   "Default HVACHtPump:VCHPTurndnRat"        HVACHtPump:VCHPTurndnRat   = {   0.3  }
   "Default HVACHtPump:CapMin47"             HVACHtPump:CapMin47        = {   UNDEFINED  }   ; SAC 07/24/21
   "Default HVACHtPump:CapMin17"             HVACHtPump:CapMin17        = {   UNDEFINED  }
   "Default HVACHtPump:CapMin05"             HVACHtPump:CapMin05        = {   UNDEFINED  }

   "Default HVACHtPump:COPMin47"             HVACHtPump:COPMin47        = {   UNDEFINED  }
   "Default HVACHtPump:COPMin17"             HVACHtPump:COPMin17        = {   UNDEFINED  }
   "Default HVACHtPump:COPMin05"             HVACHtPump:COPMin05        = {   UNDEFINED  }   ; SAC 07/24/21
   "Default HVACHtPump:Cap1747Ratio"         HVACHtPump:Cap1747Ratio    =
      {  if (IfValidAnd( Cap47 > 0 ) .AND. IfValidAnd( Cap17 > 0 ))
         then  Cap17 / Cap47
         else  UNDEFINED  endif  }
   "Default HVACHtPump:Cap0547Ratio"         HVACHtPump:Cap0547Ratio    =     ; SAC 07/24/21
      {  if (IfValidAnd( Cap47 > 0 ) .AND. IfValidAnd( Cap05 > 0 ))
         then  Cap05 / Cap47
         else  UNDEFINED  endif  }

   "FORCE all 115deg VCHP2 inputs to be defaulted by rules"    HVACHtPump:Action =     ; SAC 03/22/22
      {  if (LocalStatus( CapMin115 ) > 5 .OR. LocalStatus( Cap115 ) > 5 .OR.
             LocalStatus( COPMin115 ) > 5 .OR. LocalStatus( COP115 ) > 5)
         then  EvalRulelist( "ForceDefaults_HVACHtPump_VCHP2_115DegreeInputs", 1 )
         else  UNCHANGED  endif  }

   "Default HVACHtPump:Cap82"           HVACHtPump:Cap82          = {  UNDEFINED  }    ; SAC 09/22/21
   "Default HVACHtPump:Cap95"           HVACHtPump:Cap95          = {  UNDEFINED  }
   ; 115 deg defaults from CB, noting 33 = (115 - 82), 13 = (95 - 82) - SAC 09/22/21
   "Default HVACHtPump:Cap115"          HVACHtPump:Cap115         =     ; modified Cap115 to never exceed Cap95 (fix from CB) - SAC 03/22/22
      {  if (IfValidAnd( Cap82 > 0 )==0 .OR. IfValidAnd( Cap95 > 0 )==0) then  UNDEFINED
         else  min( (Cap82 + ((33/13) * (Cap95 - Cap82))), Cap95 )
         endif  }
   "Default HVACHtPump:COP82"           HVACHtPump:COP82          = {  UNDEFINED  }
   "Default HVACHtPump:COP95"           HVACHtPump:COP95          = {  UNDEFINED  }
   "Default HVACHtPump:COP115"          HVACHtPump:COP115         =     ; modified COP115 to never exceed COP95 (fix from CB) - SAC 03/22/22
      {  if (IfValidAnd( Cap82 > 0 )==0 .OR. IfValidAnd( Cap95 > 0 )==0 .OR.
             IfValidAnd( COP82 > 0 )==0 .OR. IfValidAnd( COP95 > 0 )==0) then  UNDEFINED
         else  min( (Cap115 /
                     ((Cap82 / COP82) + ((33/13) * ((Cap95 / COP95) -
                                                    (Cap82 / COP82))))), COP95 )
         endif  }

   "Default HVACHtPump:CapMin82"        HVACHtPump:CapMin82       = {  UNDEFINED  }
   "Default HVACHtPump:CapMin95"        HVACHtPump:CapMin95       = {  UNDEFINED  }
   "Default HVACHtPump:CapMin115"       HVACHtPump:CapMin115      =                    ; SAC 09/23/21
      {  if (IfValidAnd( CapMin95 < Cap95 ) .AND. IfValidAnd( Cap115 > 0 ))
         then  Cap115 * CapMin95 / Cap95
         else if (IfValidAnd( CapMin82 > 0 ) .AND. IfValidAnd( CapMin95 > 0 ))
         then  CapMin82 + ((33/13) * (CapMin95 - CapMin82))
         else  UNDEFINED  endif endif  }
   "Default HVACHtPump:COPMin82"        HVACHtPump:COPMin82       = {  UNDEFINED  }
   "Default HVACHtPump:COPMin95"        HVACHtPump:COPMin95       = {  UNDEFINED  }
   "Default HVACHtPump:COPMin115"       HVACHtPump:COPMin115      =
      {  if (IfValidAnd( CapMin82 > 0 )==0 .OR. IfValidAnd( CapMin95 > 0 )==0 .OR.
             IfValidAnd( COPMin82 > 0 )==0 .OR. IfValidAnd( COPMin95 > 0 )==0) then  UNDEFINED
         else  CapMin115 /
               ((CapMin82 / COPMin82) + ((33/13) * ((CapMin95 / COPMin95) -
                                                    (CapMin82 / COPMin82))))
         endif  }

   "Default HVACHtPump:Cap8295Ratio"    HVACHtPump:Cap8295Ratio   = 
      {  if (IfValidAnd( Cap95 > 0 ) .AND. IfValidAnd( Cap82  > 0 ))
         then  Cap82  / Cap95
         else  UNDEFINED  endif  }
   "Default HVACHtPump:Cap11595Ratio"   HVACHtPump:Cap11595Ratio  = 
      {  if (IfValidAnd( Cap95 > 0 ) .AND. IfValidAnd( Cap115 > 0 ))
         then  Cap115 / Cap95
         else  UNDEFINED  endif  }

   "Default HVACHtPump:VCHPFanPwrHC[1]-h"    HVACHtPump:VCHPFanPwrHC[1] = {   0.1  }
   "Default HVACHtPump:VCHPFanPwrHC[2]-c"    HVACHtPump:VCHPFanPwrHC[2] = {   0.1  }
   "Default HVACHtPump:HtgSizingFactor"      HVACHtPump:HtgSizingFactor = {   1.2  }      ; updated from 1.2 to 1.1 - SAC 02/11/22 (VCHP2)  ; roll BACK to 1.2 - SAC 02/25/22 (VCHP2)
   "Default HVACHtPump:HtgAuxSizingFactor"   HVACHtPump:HtgAuxSizingFactor = {   1.2  }      ; SAC 03/03/22 (VCHP2)
   "Default HVACHtPump:ParElecExprs"         HVACHtPump:ParElecExprs    = {   "($tdboHrAv < 50) * 40"  }

   "Override HVACHtPump:TempLabels[1]"     HVACHtPump:TempLabels[1] = {  "@   47F:"  }    ; SAC 07/24/21
   "Override HVACHtPump:TempLabels[2]"     HVACHtPump:TempLabels[2] = {  "@   17F:"  }
   "Override HVACHtPump:TempLabels[3]"     HVACHtPump:TempLabels[3] = {  "@     5F:"  }
   "Set HVACHtPump:TempLabels[4]"          HVACHtPump:TempLabels[4] = {  "@   82F:"  }    ; SAC 09/22/21
   "Set HVACHtPump:TempLabels[5]"          HVACHtPump:TempLabels[5] = {  "@   95F:"  }
   "Set HVACHtPump:TempLabels[6]"          HVACHtPump:TempLabels[6] = {  "@ 115F:"  }

   "Set HVACHtPump:PerfDetailsErrMsg"     HVACHtPump:PerfDetailsErrMsg =         ; catch errors for display on screen - SAC 09/23/21
      {  if (IfValidAnd( Cap47 > 0 )==0 .OR. IfValidAnd( CapMin47 > 0 )==0 .OR.
             IfValidAnd( Cap17 > 0 )==0 .OR. IfValidAnd( CapMin17 > 0 )==0 .OR.
             IfValidAnd( Cap05 > 0 )==0 .OR. IfValidAnd( CapMin05 > 0 )==0 .OR.
             IfValidAnd( Cap82 > 0 )==0 .OR. IfValidAnd( CapMin82 > 0 )==0 .OR.
             IfValidAnd( Cap95 > 0 )==0 .OR. IfValidAnd( CapMin95 > 0 )==0 .OR.
             IfValidAnd( Cap115> 0 )==0 .OR. IfValidAnd( CapMin115> 0 )==0)
         then  if (IfValidAnd( AutoSize > 0 ))
               then  "Valid capacities must be entered for each combination of outdoor dry bulb and Min/Max speed (even w/ autosizing activated)"
               else  "Valid capacities must be entered for each combination of outdoor dry bulb and Min/Max speed"
               endif
         else if (IfValidAnd( COP47 > 0 )==0 .OR. IfValidAnd( COPMin47 > 0 )==0 .OR.
                  IfValidAnd( COP17 > 0 )==0 .OR. IfValidAnd( COPMin17 > 0 )==0 .OR.
                  IfValidAnd( COP05 > 0 )==0 .OR. IfValidAnd( COPMin05 > 0 )==0 .OR.
                  IfValidAnd( COP82 > 0 )==0 .OR. IfValidAnd( COPMin82 > 0 )==0 .OR.
                  IfValidAnd( COP95 > 0 )==0 .OR. IfValidAnd( COPMin95 > 0 )==0 .OR.
                  IfValidAnd( COP115> 0 )==0 .OR. IfValidAnd( COPMin115> 0 )==0)
         then  "Valid COPs must be entered for each combination of outdoor dry bulb and Min/Max speed"
         else if (IfValidAnd( CapMin05  > Cap05  )) then  "Capacity at 5F and Min speed must be less than capacity @ Max speed"
         else if (IfValidAnd( CapMin17  > Cap17  )) then  "Capacity at 17F and Min speed must be less than capacity @ Max speed"
         else if (IfValidAnd( CapMin47  > Cap47  )) then  "Capacity at 47F and Min speed must be less than capacity @ Max speed"
         else if (IfValidAnd( CapMin82  > Cap82  )) then  "Capacity at 82F and Min speed must be less than capacity @ Max speed"
         else if (IfValidAnd( CapMin95  > Cap95  )) then  "Capacity at 95F and Min speed must be less than capacity @ Max speed"
         else if (IfValidAnd( CapMin115 > Cap115 )) then  "Capacity at 115F and Min speed must be less than capacity @ Max speed"
         else  UNDEFINED  endif endif endif endif endif endif endif endif  }
   "Set HVACHtPump:PerfDetailsError - flag indicating 'Performance Details' error"     HVACHtPump:PerfDetailsError =    ; SAC 09/23/21
      {  if (LocalStatus( PerfDetailsErrMsg ) < 1) then  UNDEFINED
         else if (strlen( PerfDetailsErrMsg ) < 1) then  UNDEFINED
         else  1  endif endif  }

; RJH 2/13/20 tic #1176
   "Set HVACHtPump:SpeclFeatrs_ComplianceOptionVCHP"    HVACHtPump:SpeclFeatrs_ComplianceOptionVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then 1
           else UNCHANGED
           endif  }
   "Set HVACHtPump:HERS_LowLeakageDuctsInConditionedSpace"    HVACHtPump:HERS_LowLeakageDuctsInConditionedSpace = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set HVACHtPump:HERS_DuctsInConditionedSpaceTested"    HVACHtPump:HERS_DuctsInConditionedSpaceTested = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set HVACHtPump:HERS_LowStaticVCHP"    HVACHtPump:HERS_LowStaticVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set HVACHtPump:HERS_AirToHabitableRoomsVCHP"    HVACHtPump:HERS_AirToHabitableRoomsVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 1
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set HVACHtPump:HERS_MinimumAirflowVCHP"    HVACHtPump:HERS_MinimumAirflowVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set HVACHtPump:HERS_WallThermostatVCHP"    HVACHtPump:HERS_WallThermostatVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 1
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set HVACHtPump:HERS_DuctlessInConditionedSpaceVCHP"    HVACHtPump:HERS_DuctlessInConditionedSpaceVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 1
                     case "Ducted"            : 0
                     case "Partially Ducted"  : 0
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set HVACHtPump:HERS_FilterSizeVCHP"    HVACHtPump:HERS_FilterSizeVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set HVACHtPump:HERS_FilterPressureDropVCHP"    HVACHtPump:HERS_FilterPressureDropVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set HVACHtPump:HERS_CertifiedNonContinuousFanVCHP"    HVACHtPump:HERS_CertifiedNonContinuousFanVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : if ( VCHPCertAutoFan > 0 )
					                            then 1
												else 0 endif
                     case "Partially Ducted"  : if ( VCHPCertAutoFan > 0 )
					                            then 1
												else 0 endif
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set HVACHtPump:HERS_LowLeakageDuctsInConditionedSpace"    HVACHtPump:HERS_LowLeakageDuctsInConditionedSpace = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set HVACHtPump:HERS_CertifiedNonContinuousFanVCHP"    HVACHtPump:HERS_CertifiedNonContinuousFanVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : if ( VCHPCertAutoFan > 0 )
					                            then 1
												else 0 endif
                     case "Partially Ducted"  : if ( VCHPCertAutoFan > 0 )
					                            then 1
												else 0 endif
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
END
;*************************************************************************
RULELIST "Default_HtPump_unknown" 0 0 0 1
;*************************************************************************
	"Default HVACHtPump:TotalCapacity"   	HVACHtPump:TotalCapacity  = {  UNDEFINED  }
	"Set HVACHtPump:TypeDescrip"				HVACHtPump:TypeDescrip		= { "RTF\blank.rtf" }
   "Default HVACHtPump:AutoSize"          HVACHtPump:AutoSize        = {  0  }
	"Default HVACHtPump:SEER"            	HVACHtPump:SEER             = {  UNDEFINED  }
	"Default HVACHtPump:EER"             	HVACHtPump:EER              = {  UNDEFINED  }
	"Default HVACHtPump:CEER"             	HVACHtPump:CEER             = {  UNDEFINED  }
	"Default HVACHtPump:CFMperTon"       	HVACHtPump:CFMperTon        = {  UNDEFINED  }
	"Default HVACHtPump:ACCharge"        	HVACHtPump:ACCharge         = {  UNDEFINED  }
	"Default HVACHtPump:RefrigerantType" 	HVACHtPump:RefrigerantType  = {  UNDEFINED  }
	"Default HVACHtPump:RefrigChgAdjFctr"	HVACHtPump:RefrigChgAdjFctr = {  UNDEFINED  }
	"Default HVACHtPump:UseEERinAnalysis"	HVACHtPump:UseEERinAnalysis = {	0  }
END

;*************************************************************************
RULELIST "Default_HtPump_CaliforniaSEERtoEERFormula" 0 0 0 1      ; defaulting for HVACHtPump:EER
;*************************************************************************
	"Default HVACHtPump:EER"		HVACHtPump:EER	= {
			if (LocalStatus( SEER ) < 1) then  UNCHANGED
			else if (	T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) > 0 .AND.
				 SEER == T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ))
			then			T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )
			else if (SEER >= 16) then  13
			else if (SEER >= 13)	then  11.3 + (0.57 * (SEER - 13  ))
			else								10   + (0.84 * (SEER - 11.5))
			endif endif endif endif  }
END
;*************************************************************************


;*************************************************************************
RULELIST "Default_Cool_CaliforniaSEERtoEERFormula" 0 0 0 1      ; defaulting for HVACCool:EER
;*************************************************************************
	"Default HVACCool:EER"		HVACCool:EER	= {
			if (LocalStatus( SEER ) < 1) then  UNCHANGED
			else if (	T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) > 0 .AND.
				 SEER == T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ))
			then			T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )
			else if (SEER >= 16) then  13
			else if (SEER >= 13)	then  11.3 + (0.57 * (SEER - 13  ))
			else								10   + (0.84 * (SEER - 11.5))
			endif endif endif endif  }
END
;*************************************************************************
RULELIST "Default_Cool_CaliforniaEERtoSEERFormula" 0 0 0 1      ; defaulting for HVACCool:EER
;*************************************************************************
	"Default HVACCool:SEER"		HVACCool:SEER	= {
			if (LocalStatus( EER ) < 1) then  UNCHANGED
			else if (	T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) > 0 .AND.
				 EER == T24RCoolingEquipment:EER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ))
			then	1.07 * EER 
			else UNCHANGED
			endif  endif}
END

; SAC 12/26/14 -  lists similar to above but designed to set new HVACSys:StdSysSEER & EER
;*************************************************************************
RULELIST "Default_HVACSys_StdCoolViaCaliforniaSEERtoEERFormula" 1 0 0 1
	"Default HVACSys:StdSysSEER"		HVACSys:StdSysSEER	= {	T24RCoolingEquipment:SEER(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev )  }
	"Default HVACSys:StdSysEER"		HVACSys:StdSysEER	= {
			if (LocalStatus( StdSysSEER ) < 1) then  UNDEFINED
			else if (			T24RCoolingEquipment:EERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev ) > 0 .AND.
				 StdSysSEER == T24RCoolingEquipment:SEER(     "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev ))
			then					T24RCoolingEquipment:EER(      "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev )
			else if (StdSysSEER >= 16) then  13
			else if (StdSysSEER >= 13)	then  11.3 + (0.57 * (StdSysSEER - 13  ))
			else										10   + (0.84 * (StdSysSEER - 11.5))
			endif endif endif endif  }
END
;*************************************************************************
RULELIST "Default_HVACSys_StdCoolViaCaliforniaEERtoSEERFormula" 1 0 0 1
	"Default HVACSys:StdSysEER"		HVACSys:StdSysEER		= {	T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev )  }
	"Default HVACSys:StdSysSEER"		HVACSys:StdSysSEER	= {
			if (LocalStatus( StdSysEER ) < 1) then  UNDEFINED
			else if (			T24RCoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev ) > 0 .AND.
				  StdSysEER == T24RCoolingEquipment:EER(       "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev ))
			then  				T24RCoolingEquipment:SEER(      "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev )
			else	1.07 * StdSysEER 
			endif  endif}
END
;*************************************************************************
RULELIST "Default_HVACSys_StdHtPumpCoolViaCaliforniaSEERtoEERFormula" 1 0 0 1
	"Default HVACSys:StdSysSEER"		HVACSys:StdSysSEER	= {	T24RCoolingEquipment:SEER(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev )  }
	"Default HVACSys:StdSysEER"		HVACSys:StdSysEER	= {
			if (LocalStatus( StdSysSEER ) < 1) then  UNDEFINED
			else if (			T24RCoolingEquipment:EERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) > 0 .AND.
				 StdSysSEER == T24RCoolingEquipment:SEER(     "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ))
			then					T24RCoolingEquipment:EER(      "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev )
			else if (StdSysSEER >= 16) then  13
			else if (StdSysSEER >= 13)	then  11.3 + (0.57 * (StdSysSEER - 13  ))
			else										10   + (0.84 * (StdSysSEER - 11.5))
			endif endif endif endif  }
END
;*************************************************************************
RULELIST "Default_HVACSys_StdHtPumpCoolViaCaliforniaEERtoSEERFormula" 1 0 0 1
	"Default HVACSys:StdSysEER"		HVACSys:StdSysEER		= {	T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev )  }
	"Default HVACSys:StdSysSEER"		HVACSys:StdSysSEER	= {
			if (LocalStatus( StdSysEER ) < 1) then  UNDEFINED
			else if (			T24RCoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) > 0 .AND.
				  StdSysEER == T24RCoolingEquipment:EER(       "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ))
			then  				T24RCoolingEquipment:SEER(      "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev )
			else	1.07 * StdSysEER 
			endif  endif}
END
;*************************************************************************
RULELIST "Default_HVACSys_StdCool_Undefined" 1 0 0 1
	"Default HVACSys:StdSysEER"		HVACSys:StdSysEER		= {	UNDEFINED  }
	"Default HVACSys:StdSysSEER"		HVACSys:StdSysSEER	= {	UNDEFINED  }
END
;*************************************************************************

;*************************************************************************
RULELIST "Default_Cool_None" 0 0 0 1    
;*************************************************************************
	"Default HVACCool:ACCharge"        		HVACCool:ACCharge         = {  "Not Verified"  }		; mjb 10/30/14 - switched default enum to 'Not Verified' (issue #403)
END
;*************************************************************************
RULELIST "Default_Cool_SplitAirCond" 0 0 0 1      ; defaulting for HVACCool:Type = "SplitAirCond - Split air conditioning system"
;*************************************************************************
	"Default HVACCool:TotalCapacity"   		HVACCool:TotalCapacity    = {   UNDEFINED  }
	"Default HVACCool:SEER"            		HVACCool:SEER             = {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }
	"Default HVACCool:EER (via rulelist)"	HVACCool:Action           = {		EvalRulelist( "Default_Cool_CaliforniaSEERtoEERFormula", 1 )  }
   "Default HVACCool:CEER"                HVACCool:CEER             = {  UNDEFINED  }     ; SAC 08/19/20 (tic #1003)
; mjb 1/30/15 - mods to lookup CFMperTon and ACCharge from T24RClimateZoneCodeBase
;	"Default HVACCool:CFMperTon"       		HVACCool:CFMperTon        = {  350  }
;	"Default HVACCool:ACCharge"        		HVACCool:ACCharge         = {  "Verified"  }		; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	; SAC 2/21/15 - fixed bug in following rules where obejct being set were HVACHtPump but should have been HVACCool ! (during debugging of GC issue 473)
	; SAC 1/5/16 - added logic to set default CFMperTon to 150 for CEC 2013/16 & IsZonal & NOT IsMultiSpeed (tic 140, comment 6/22/15) - same change to each Default_Cool_* rulelist
	"Default HVACCool:CFMperTon"       		HVACCool:CFMperTon        = {	if ((Proj:StdDesignBase == 2013 .OR. Proj:StdDesignBase >= 2016) .AND. IfValidAnd( ShowMultiSpeed > 0 ) .AND. IsMultiSpeed < 0.5 .AND.
																											IfValidAnd( ShowIsZonal > 0 ) .AND. IsZonal > 0.5 ) then  150
																								else	T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif  }
	"Default HVACCool:ACCharge"        		HVACCool:ACCharge         = {  if ( T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 ) then "Verified" else "Not Verified" endif }    ; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	"Default HVACCool:RefrigerantType" 		HVACCool:RefrigerantType  = {  "R410A"     }
  ; SAC 3/4/13 - based on e-mail from BAW 3/1/13
	"Default HVACCool:RefrigChgAdjFctr"		HVACCool:RefrigChgAdjFctr	= {	switch (ACCharge)
																										case  2 :  0.96		; "Verified"
																										case  3 :  0.96		; 2013: "CID (charge indicator)"  2016: "FID (fault indicator)"
																										default :  0.90		; "Not Verified" (or any other setting)
																									endswitch    }
;	"Default HVACCool:EvapCondEff" 			HVACCool:EvapCondEff  		= {  UNDEFINED   }
	"Default HVACCool:UseEERinAnalysis"		HVACCool:UseEERinAnalysis	= {	0  }
END

;*************************************************************************
RULELIST "Default_Cool_PkgTermAirCond" 0 0 0 1      ; defaulting for HVACCool:Type = "PkgTermAirCond - Packaged terminal air conditioner (PTAC)" & "SglPkgVertAirCond - Single package vertical A/C system"      ; SAC 6/20/20 (tic #1225)
;*************************************************************************
	"Default HVACCool:TotalCapacity"   		HVACCool:TotalCapacity    = {   UNDEFINED  }
	"Default HVACCool:SEER"            		HVACCool:SEER             = {   UNDEFINED  }
	"Default HVACCool:EER"            		HVACCool:EER              = {   T24RCoolingEquipment:EER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }
   "Default HVACCool:CEER"                HVACCool:CEER             = {  UNDEFINED  }     ; SAC 08/19/20 (tic #1003)
	"Default HVACCool:CFMperTon"       		HVACCool:CFMperTon        = {	if (IfValidAnd( ShowMultiSpeed > 0 ) .AND. IsMultiSpeed < 0.5 .AND. IfValidAnd( ShowIsZonal > 0 ) .AND. IsZonal > 0.5 ) then  150
																								else	T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif  }
	"Default HVACCool:ACCharge"        		HVACCool:ACCharge         = {  if ( T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 ) then "Verified" else "Not Verified" endif }    ; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	"Default HVACCool:RefrigerantType" 		HVACCool:RefrigerantType  = {  "R410A"     }
	"Default HVACCool:RefrigChgAdjFctr"		HVACCool:RefrigChgAdjFctr	= {  0.96  }         ; was: switch (ACCharge) -> 0.96 or 0.9 - SAC 08/21/20 (tic #1003)
	"Default HVACCool:UseEERinAnalysis"		HVACCool:UseEERinAnalysis	= {	1  }
END

;*************************************************************************
RULELIST "Default_Cool_SDHVSplitAirCond" 0 0 0 1      ; defaulting for HVACCool:Type = "SDHVSplitAirCond - Small duct, high velocity, split A/C system"
;*************************************************************************
	"Default HVACCool:TotalCapacity"   		HVACCool:TotalCapacity    = {   UNDEFINED  }
	"Default HVACCool:SEER"            		HVACCool:SEER             = {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }
	"Default HVACCool:EER (via rulelist)"	HVACCool:Action           = {		EvalRulelist( "Default_Cool_CaliforniaSEERtoEERFormula", 1 )  }
   "Default HVACCool:CEER"                HVACCool:CEER             = {  UNDEFINED  }     ; SAC 08/19/20 (tic #1003)
; mjb 1/30/15 - mods to lookup CFMperTon and ACCharge from T24RClimateZoneCodeBase
;	"Default HVACCool:CFMperTon"       		HVACCool:CFMperTon        = {  350  }
;	"Default HVACCool:ACCharge"        		HVACCool:ACCharge         = {  "Verified"  }		; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	; SAC 2/21/15 - fixed bug in following rules where obejct being set were HVACHtPump but should have been HVACCool ! (during debugging of GC issue 473)
	; SAC 1/5/16 - added logic to set default CFMperTon to 150 for CEC 2013/16 & IsZonal & NOT IsMultiSpeed (tic 140, comment 6/22/15) - same change to each Default_Cool_* rulelist
	; SAC 8/18/19 - added logic to set SDHV default CFMperTon to 250 for 2019+ models (tic #1041)
	"Default HVACCool:CFMperTon"       		HVACCool:CFMperTon        = {	if ((Proj:StdDesignBase == 2013 .OR. Proj:StdDesignBase >= 2016) .AND. IfValidAnd( ShowMultiSpeed > 0 ) .AND. IsMultiSpeed < 0.5 .AND.
																											IfValidAnd( ShowIsZonal > 0 ) .AND. IsZonal > 0.5 ) then  150
	                                                                     else if (Proj:StdDesignBase >= 2019) then  250
																								else	T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif endif  }
	"Default HVACCool:ACCharge"        		HVACCool:ACCharge         = {  if ( T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 ) then "Verified" else "Not Verified" endif }    ; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	"Default HVACCool:RefrigerantType" 		HVACCool:RefrigerantType  = {  "R410A"     }
  ; SAC 3/4/13 - based on e-mail from BAW 3/1/13
	"Default HVACCool:RefrigChgAdjFctr"		HVACCool:RefrigChgAdjFctr	= {	switch (ACCharge)
																										case  2 :  0.96		; "Verified"
																										case  3 :  0.96		; 2013: "CID (charge indicator)"  2016: "FID (fault indicator)"
																										default :  0.90		; "Not Verified" (or any other setting)
																									endswitch    }
;	"Default HVACCool:EvapCondEff" 			HVACCool:EvapCondEff  		= {  UNDEFINED   }
	"Default HVACCool:UseEERinAnalysis"		HVACCool:UseEERinAnalysis	= {	0  }
END

;*************************************************************************
RULELIST "Default_Cool_PkgAirCond" 0 0 0 1      ; defaulting for HVACCool:Type "PkgAirCond - Central packaged A/C system (< 65 kBtuh)"
;*************************************************************************
	"Default HVACCool:TotalCapacity"   		HVACCool:TotalCapacity    = {   UNDEFINED  }
	"Default HVACCool:SEER"            		HVACCool:SEER             = {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }
	"Default HVACCool:EER (via rulelist)"	HVACCool:Action           = {		EvalRulelist( "Default_Cool_CaliforniaSEERtoEERFormula", 1 )  }
   "Default HVACCool:CEER"                HVACCool:CEER             = {  UNDEFINED  }     ; SAC 08/19/20 (tic #1003)
; mjb 1/30/15 - mods to lookup CFMperTon and ACCharge from T24RClimateZoneCodeBase
;	"Default HVACCool:CFMperTon"       		HVACCool:CFMperTon        = {  350  }
;	"Default HVACCool:ACCharge"        		HVACCool:ACCharge         = {  "Verified"  }		; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	; SAC 2/21/15 - fixed bug in following rules where obejct being set were HVACHtPump but should have been HVACCool ! (during debugging of GC issue 473)
	"Default HVACCool:CFMperTon"       		HVACCool:CFMperTon        = {	if ((Proj:StdDesignBase == 2013 .OR. Proj:StdDesignBase >= 2016) .AND. IfValidAnd( ShowMultiSpeed > 0 ) .AND. IsMultiSpeed < 0.5 .AND.
																											IfValidAnd( ShowIsZonal > 0 ) .AND. IsZonal > 0.5 ) then  150
																								else	T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif  }
	"Default HVACCool:ACCharge"        		HVACCool:ACCharge         = {  if ( T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 ) then "Verified" else "Not Verified" endif }    ; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	"Default HVACCool:RefrigerantType" 		HVACCool:RefrigerantType  = {  "R410A"         }
  ; SAC 3/4/13
	"Default HVACCool:RefrigChgAdjFctr"		HVACCool:RefrigChgAdjFctr	= {	UNDEFINED  }
;	"Default HVACCool:EvapCondEff" 			HVACCool:EvapCondEff  		= {  UNDEFINED   }
	"Default HVACCool:UseEERinAnalysis"		HVACCool:UseEERinAnalysis	= {	0  }
END

;*************************************************************************
RULELIST "Default_Cool_LrgPkgAirCond" 0 0 0 1      ; defaulting for HVACCool:Type = "LrgPkgAirCond - Large packaged A/C system (>= 65 kBtuh)"
;*************************************************************************
; DR: This system is not available, so commenting out rules
	"Default HVACCool:TotalCapacity"   		HVACCool:TotalCapacity    = {   UNDEFINED  }
;	"Default HVACCool:SEER"            		HVACCool:SEER             = {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }
;	"Default HVACCool:EER (via rulelist)"	HVACCool:Action           = {		EvalRulelist( "Default_Cool_CaliforniaSEERtoEERFormula", 1 )  }
; mjb 1/30/15 - mods to lookup CFMperTon and ACCharge from T24RClimateZoneCodeBase
;	"Default HVACCool:CFMperTon"       		HVACCool:CFMperTon        = {  350  }
;	"Default HVACCool:ACCharge"        		HVACCool:ACCharge         = {  "Verified"  }		; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	; SAC 2/21/15 - fixed bug in following rules where obejct being set were HVACHtPump but should have been HVACCool ! (during debugging of GC issue 473)
;	"Default HVACCool:CFMperTon"       		HVACCool:CFMperTon        = {	if ((Proj:StdDesignBase == 2013 .OR. Proj:StdDesignBase >= 2016) .AND. IfValidAnd( ShowMultiSpeed > 0 ) .AND. IsMultiSpeed < 0.5 .AND.
;																											IfValidAnd( ShowIsZonal > 0 ) .AND. IsZonal > 0.5 ) then  150
;																								else	T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif  }
;	"Default HVACCool:ACCharge"        		HVACCool:ACCharge         = {  if ( T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 ) then "Verified" else "Not Verified" endif }    ; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
;	"Default HVACCool:RefrigerantType" 		HVACCool:RefrigerantType  = {  "R410A"         }
  ; SAC 3/4/13
;	"Default HVACCool:RefrigChgAdjFctr"		HVACCool:RefrigChgAdjFctr	= {	UNDEFINED  }
;	"Default HVACCool:EvapCondEff" 			HVACCool:EvapCondEff  		= {  UNDEFINED   }
	"Default HVACCool:UseEERinAnalysis"		HVACCool:UseEERinAnalysis	= {	0  }
END

; SAC 6/22/20 - revised to ALSO handle DuctlessMultiSplitAirCond as well as DuctedMiniSplitAirCond, DuctedMultiSplitAirCond and Ducted+DuctlessMultiSplitAirCond (tic #1229)
;*************************************************************************
RULELIST "Default_Cool_DuctlessMiniSplitAirCond" 0 0 0 1      ; defaulting for HVACCool:Type = "DuctlessSplitAirCond - Ductless mini-split and multi-split heat A/C"
;*************************************************************************
	"Default HVACCool:TotalCapacity"   		HVACCool:TotalCapacity    = {   UNDEFINED  }
	"Default HVACCool:SEER"            		HVACCool:SEER             = {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }
	"Default HVACCool:EER (via rulelist)"	HVACCool:Action           = {		EvalRulelist( "Default_Cool_CaliforniaSEERtoEERFormula", 1 )  }
   "Default HVACCool:CEER"                HVACCool:CEER             = {  UNDEFINED  }     ; SAC 08/19/20 (tic #1003)
	"Default HVACCool:CFMperTon"       		HVACCool:CFMperTon        = {  UNDEFINED  }		
	"Default HVACCool:ACCharge"        		HVACCool:ACCharge         = {  UNDEFINED  }   
	"Default HVACCool:RefrigerantType" 		HVACCool:RefrigerantType  = {  "R410A"         }
  ; SAC 3/4/13
	"Default HVACCool:RefrigChgAdjFctr"		HVACCool:RefrigChgAdjFctr	= {	UNDEFINED  }
	"Default HVACCool:UseEERinAnalysis"		HVACCool:UseEERinAnalysis	= {	0  }
END

;*************************************************************************
RULELIST "Default_Cool_DuctlessVRFAirCond" 0 0 0 1      ; defaulting for HVACCool:Type = "DuctlessVRFAirCond - variable refrigerant flow A/C, ductless"
;*************************************************************************
	"Default HVACCool:TotalCapacity"   		HVACCool:TotalCapacity    = {  UNDEFINED  }
	"Default HVACCool:SEER"            		HVACCool:SEER             = {  T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }
	"Default HVACCool:EER (via rulelist)"	HVACCool:Action           = {	EvalRulelist( "Default_Cool_CaliforniaSEERtoEERFormula", 1 )  }
   "Default HVACCool:CEER"                HVACCool:CEER             = {  UNDEFINED  }     ; SAC 08/19/20 (tic #1003)
	"Default HVACCool:CFMperTon"       		HVACCool:CFMperTon        = {  UNDEFINED  }
	"Default HVACCool:ACCharge"        		HVACCool:ACCharge         = {  UNDEFINED  }
	"Default HVACCool:RefrigerantType" 		HVACCool:RefrigerantType  = {  "R410A"    }
	"Default HVACCool:RefrigChgAdjFctr"		HVACCool:RefrigChgAdjFctr	= {	 UNDEFINED  }
	"Default HVACCool:UseEERinAnalysis"		HVACCool:UseEERinAnalysis	= {	 0  }
END

;*************************************************************************
RULELIST "Default_Cool_RoomAirCond" 0 0 0 1      ; defaulting for HVACCool:Type = "RoomAirCond - Non-central room A/C system"
;*************************************************************************
	"Default HVACCool:TotalCapacity"   		HVACCool:TotalCapacity    = {   UNDEFINED  }
;	"Default HVACCool:SEER"            		HVACCool:SEER             = {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }
;	"Default HVACCool:EER"					HVACCool:Action           = {   T24RCoolingEquipment:EER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }
;	"Default HVACCool:EER"					HVACCool:EER           = {   T24RCoolingEquipment:EER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }
;	"Default HVACCool:SEER (via rulelist)"  HVACCool:Action             = {		EvalRulelist( "Default_Cool_CaliforniaEERtoSEERFormula", 1 )  } ;SEER is not available for Room A/C 11/2/14 TC
	"Default HVACCool:SEER"            		HVACCool:SEER             = {  UNDEFINED  }     ; SAC 08/19/20 (tic #1003)
	"Default HVACCool:EER"            		HVACCool:EER              = {  UNDEFINED  }     ; SAC 08/19/20 (tic #1003)
   "Default HVACCool:CEER"                HVACCool:CEER             = {  T24RCoolingEquipment:CEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  }     ; SAC 08/19/20 (tic #1003)
;	"Default HVACCool:CFMperTon"       		HVACCool:CFMperTon        = {  350  }
	"Default HVACCool:CFMperTon"       		HVACCool:CFMperTon        = {  UNDEFINED  }		; mjb	8/26/14 - shouldn't be a default for the user model
;	"Default HVACCool:ACCharge"        		HVACCool:ACCharge         = {  "Verified"  }    ; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	"Default HVACCool:ACCharge"        		HVACCool:ACCharge         = {  UNDEFINED  }     ; mjb	8/26/14 - shouldn't be a default for the user model
	"Default HVACCool:RefrigerantType" 		HVACCool:RefrigerantType  = {  "R410A"         }
  ; SAC 3/4/13
	"Default HVACCool:RefrigChgAdjFctr"		HVACCool:RefrigChgAdjFctr	= {	UNDEFINED  }
;	"Default HVACCool:EvapCondEff" 			HVACCool:EvapCondEff  		= {  UNDEFINED   }
	"Default HVACCool:UseEERinAnalysis"		HVACCool:UseEERinAnalysis	= {	0  }
END

;*************************************************************************
RULELIST "Default_Cool_EvapCondenser" 0 0 0 1      ; defaulting for HVACCool:Type = "EvapCondenser - Evaporatively-cooled condenser for split AC systems"
;*************************************************************************
	"Default HVACCool:TotalCapacity"   		HVACCool:TotalCapacity		= {   UNDEFINED  }
	"Default HVACCool:EERb"            		HVACCool:EERb					= {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) 	}
	"Default HVACCool:EERa"            		HVACCool:EERa					= {   T24RCoolingEquipment:EER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) 	}
; mjb 1/30/15 - mods to lookup CFMperTon and ACCharge from T24RClimateZoneCodeBase
;	"Default HVACCool:CFMperTon"       		HVACCool:CFMperTon        = {  350  }
;	"Default HVACCool:ACCharge"        		HVACCool:ACCharge         = {  "Verified"  }		; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	; SAC 2/21/15 - fixed bug in following rules where obejct being set were HVACHtPump but should have been HVACCool ! (during debugging of GC issue 473)
	"Default HVACCool:CFMperTon"       		HVACCool:CFMperTon        = {	if ((Proj:StdDesignBase == 2013 .OR. Proj:StdDesignBase >= 2016) .AND. IfValidAnd( ShowMultiSpeed > 0 ) .AND. IsMultiSpeed < 0.5 .AND.
																											IfValidAnd( ShowIsZonal > 0 ) .AND. IsZonal > 0.5 ) then  150
																								else	T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif  }
	"Default HVACCool:ACCharge"        		HVACCool:ACCharge         = {  if ( T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 ) then "Verified" else "Not Verified" endif }    ; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	"Default HVACCool:RefrigerantType" 		HVACCool:RefrigerantType	= {  "R410A"     }
  ; SAC 3/4/13 - based on e-mail from BAW 3/1/13
	"Default HVACCool:RefrigChgAdjFctr"		HVACCool:RefrigChgAdjFctr	= {	switch (ACCharge)
																										case  2 :  0.96		; "Verified"
																										case  3 :  0.96		; 2013: "CID (charge indicator)"  2016: "FID (fault indicator)"
																										default :  0.90		; "Not Verified" (or any other setting)
																									endswitch    }
;	"Default HVACCool:EvapCondEff" 			HVACCool:EvapCondEff  		= {  0.60     }
	"Default HVACCool:EvapCondEff"			HVACCool:Action	= {	EvalRulelist( "ForceDefaults_HVACCool_EvapCondenser", 1 )	}
	"Default HVACCool:UseEERinAnalysis"		HVACCool:UseEERinAnalysis	= {	1  }
END

;*************************************************************************
RULELIST "ForceDefaults_HVACCool_EvapCondenser" 1 0 0 0    
;*************************************************************************
	"Force Default of EERaAdjust"							HVACCool:EERaAdjust		=	{ 1 }
	"Force Default of EERbAdjust"							HVACCool:EERbAdjust		=	{ 1 }
	"Force Default of HVACCool:SEER"            		HVACCool:SEER             = {   if ( IfValidAnd(EERaAdjust > 0) ) then EERb * EERbAdjust else EERb endif }
	"Force Default of HVACCool:EER"            		HVACCool:EER              = {   if ( IfValidAnd(EERbAdjust > 0) ) then EERa * EERaAdjust else EERa endif }
END

;************************************************************************* SAC 03/22/22
RULELIST "ForceDefaults_HVACHtPump_VCHP2_115DegreeInputs" 1 0 0 0    
;*************************************************************************
   "Blast HVACHtPump:CapMin115"     HVACHtPump:CapMin115  = {  UNDEFINED  }
   "Blast HVACHtPump:COPMin115"     HVACHtPump:COPMin115  = {  UNDEFINED  }
   "Blast HVACHtPump:Cap115"        HVACHtPump:Cap115     = {  UNDEFINED  }
   "Blast HVACHtPump:COP115"        HVACHtPump:COP115     = {  UNDEFINED  }
END

;*************************************************************************
RULELIST "Default_Cool_unknown" 0 0 0 1
;*************************************************************************
	"Default HVACCool:TotalCapacity"   		HVACCool:TotalCapacity    = {  UNDEFINED  }
	"Default HVACCool:SEER"            		HVACCool:SEER             = {  UNDEFINED  }
	"Default HVACCool:EER"             		HVACCool:EER              = {  UNDEFINED  }
   "Default HVACCool:CEER"                HVACCool:CEER             = {  UNDEFINED  }     ; SAC 08/19/20 (tic #1003)
	"Default HVACCool:CFMperTon"       		HVACCool:CFMperTon        = {  UNDEFINED  }
	"Default HVACCool:ACCharge"        		HVACCool:ACCharge         = {  UNDEFINED  }
	"Default HVACCool:RefrigerantType" 		HVACCool:RefrigerantType  = {  UNDEFINED  }
  ; SAC 3/4/13
	"Default HVACCool:RefrigChgAdjFctr"		HVACCool:RefrigChgAdjFctr	= {	UNDEFINED  }
	"Default HVACCool:UseEERinAnalysis"		HVACCool:UseEERinAnalysis	= {	0  }
END
;*************************************************************************

;*************************************************************************
RULELIST "Default_Fan_PSCFurnace" 0 0 0 1      ; "Single Speed PSC Furnace Fan"
;*************************************************************************
; mjb 1/29/15 - mods to lookup WperCFM from T24RClimateZoneCodeBase table
   "Default HVACFan:DefaultSystem"     HVACFan:DefaultSystem  = {  0     }
;   "Default HVACFan:WperCFMCool"			HVACFan:WperCFMCool    = {  0.58  }
   ; SAC 5/16/19 - added logic to default HVACFan:WperCFMCool based on assigned system area (tic #1074)
   ; SAC 8/19/19 - added logic to default HVACFan:WperCFMCool for SDHV (small duct high velocity) systems (tic #1041, #1130)   - SAC 10/27/19 & SAC 10/28/19 - added logic to ensure results for 2019.1.1 consistent w/ 2019.1.0
   "Default HVACFan:WperCFMCool"			HVACFan:WperCFMCool    = {
         if (IfValidAnd( Proj:AnalysisVersion > 190101 ))
         then  if (FloorAreaServed < 1 .OR. SDHVAreaServed = FloorAreaServed) 
               then  T24RClimateZoneCodeBase:SDHVWperCFM( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
               else if (FloorAreaServed < 1 .OR. GasFurnAreaServed = FloorAreaServed)
               then  T24RClimateZoneCodeBase:GFurnWperCFM(      "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
               else  T24RClimateZoneCodeBase:WperCFM( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
               endif endif
         else  ; 2019.1.0 and earlier logic
               if (FloorAreaServed < 1 .OR. HtPumpAreaServed = FloorAreaServed)
               then  T24RClimateZoneCodeBase:WperCFM(      "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
               else  T24RClimateZoneCodeBase:GFurnWperCFM( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
               endif
         endif  }
;   "Set HVACFan:MinIAQCFM"					HVACFan:MinIAQCFM      = {  0  }
END

;*************************************************************************
RULELIST "Default_Fan_unknown" 0 0 0 1
;*************************************************************************
   "Default HVACFan:DefaultSystem"     HVACFan:DefaultSystem  = {  1  }
  ; SAC 1/28/13 - added check and rulelist call to ensure system defaults ARE in fact all defaulted if/when DefaultSystem selected
	"Ensure HVACFan:DefaultSystem valid"		HVACFan:Action	= {
						if (DefaultSystem > 0.5)
						then	if (	LocalStatus( WperCFMCool ) > 4 )
				;		then	if (	LocalStatus( WperCFMCool ) > 4  .OR.  LocalStatus( CoolingVent ) > 4  .OR.  LocalStatus( IAQCFM         ) > 4  .OR.
				;						LocalStatus( WperCFMIAQ  ) > 4  .OR.  LocalStatus( IAQFanType  ) > 4  .OR.  LocalStatus( IAQRecovEffect ) > 4 )
								then	EvalRulelist( "ForceDefaults_HVACFan", 1 )
								else	UNCHANGED  endif
						else	UNCHANGED  endif  }

;   "Set HVACFan:MinIAQCFM"					HVACFan:MinIAQCFM      = {  0  }
   "Default HVACFan:WperCFMCool"			HVACFan:WperCFMCool    = {  UNDEFINED  }
;   "Default HVACFan:CoolingVent"			HVACFan:CoolingVent    = {  UNDEFINED  }
;   "Default HVACFan:IAQCFM"				HVACFan:IAQCFM         = {  UNDEFINED  }
;   "Default HVACFan:WperCFMIAQ"			HVACFan:WperCFMIAQ     = {  UNDEFINED  }
;   "Default HVACFan:IAQFanType"			HVACFan:IAQFanType     = {  UNDEFINED  }
;   "Default HVACFan:IAQRecovEffect"		HVACFan:IAQRecovEffect = {  UNDEFINED  }
END

;*************************************************************************
RULELIST "ForceDefaults_HVACFan" 1 0 0 0
;*************************************************************************
	"Force Default of HVACFan:WperCFMCool"   		HVACFan:WperCFMCool      = {	if (LocalStatus( WperCFMCool    ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
;	"Force Default of HVACFan:CoolingVent"   		HVACFan:CoolingVent      = {  if (LocalStatus( CoolingVent    ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
;	"Force Default of HVACFan:IAQCFM"        		HVACFan:IAQCFM           = {  if (LocalStatus( IAQCFM         ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
;	"Force Default of HVACFan:WperCFMIAQ"    		HVACFan:WperCFMIAQ       = {  if (LocalStatus( WperCFMIAQ     ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
;	"Force Default of HVACFan:IAQFanType"    		HVACFan:IAQFanType       = {  if (LocalStatus( IAQFanType     ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
;	"Force Default of HVACFan:IAQRecovEffect"		HVACFan:IAQRecovEffect   = {  if (LocalStatus( IAQRecovEffect ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
END

;*************************************************************************
RULELIST "ForceDefaults_ClVentFan" 1 0 0 0
;*************************************************************************
	"Force Default of ClVentFan:WperCFMCool"   	ClVentFan:WperCFMCool	= {	if (LocalStatus( WperCFMCool    ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Default of ClVentFan:CoolingVent"   	ClVentFan:CoolingVent	= {	if (LocalStatus( CoolingVent    ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
END
;*************************************************************************


; SAC 5/27/14 - added to facilitate CF1R reporting (particularly where No Cooling inputs are replaced by cooling systems for proposed simulation)
;*************************************************************************
RULELIST "SetupHVACCoolCF1RReportVariables" 1 0 0 0
; start by setting all reporting properties to the input HVACCool properties
	"Default HVACCool:TypeRpt"		HVACCool:TypeRpt	= {	Type  }
	"Default HVACCool:SEERRpt"		HVACCool:SEERRpt	= {	if (IfValidAnd( Type > 0 )==0 .OR. IfValidAnd( SEER > 0 )==0) then  "N/A"
																			else if (T24RCoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ))  then  FltToStr( SEER, 11 )	; '11' causes decimal precision defined by value in database
																			else  "N/A"  endif endif }
	"Default HVACCool:EERRpt"		HVACCool:EERRpt	= {	if (IfValidAnd( Type > 0 )==0 .OR. IfValidAnd(  EER > 0 )==0) then  "N/A"
																			else if (T24RCoolingEquipment:EERValid(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ))  then  FltToStr(  EER, 11 )	; '11' causes decimal precision defined by value in database
																			else  "N/A"  endif endif }

; then revise settings for specific HVACCool objects created to simulate no-cooling proposed systems
	"Override HVACSys:CoolSystem[1]:TypeRpt (if needed)"		HVACSys:CoolSystem[1]:TypeRpt	= {	if (IfValidAnd( CoolSysPropCr8 > 0.1 )) then      1      else  UNCHANGED  endif  }
	"Override HVACSys:CoolSystem[1]:SEERRpt (if needed)"		HVACSys:CoolSystem[1]:SEERRpt	= {	if (IfValidAnd( CoolSysPropCr8 > 0.1 )) then  UNDEFINED  else  UNCHANGED  endif  }
	"Override HVACSys:CoolSystem[1]:EERRpt (if needed)"		HVACSys:CoolSystem[1]:EERRpt	= {	if (IfValidAnd( CoolSysPropCr8 > 0.1 )) then  UNDEFINED  else  UNCHANGED  endif  }

; SAC 11/18/14 - added rules to do same reporting for HVACHtPump SEER & EER as with HVACCool...
	"Default HVACHtPump:SEERRpt"	HVACHtPump:SEERRpt	= {	if (IfValidAnd( Type > 0 )==0 .OR. IfValidAnd( SEER > 0 )==0) then  "N/A"
																				else if (T24RCoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ))  then  FltToStr( SEER, 11 )	; '11' causes decimal precision defined by value in database
																				else  "N/A"  endif endif }
	"Default HVACHtPump:EERRpt"	HVACHtPump:EERRpt		= {	if (IfValidAnd( Type > 0 )==0 .OR. IfValidAnd(  EER > 0 )==0) then  "N/A"
																				else if (T24RCoolingEquipment:EERValid(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ))  then  FltToStr(  EER, 11 )	; '11' causes decimal precision defined by value in database
																				else  "N/A"  endif endif }
END
;*************************************************************************


;*************************************************************************
RULELIST "PostProposedInput_HVAC" 1 0 0 1
;*************************************************************************
	; SAC 9/24/14 - extracted HVAC rules from PostProposedInput rulelist

   ;--------------------------------------------------------------------
   ; Override certain Proposed Heat/Cool/HtPump systems w/ Std Design performance 		- SAC 4/22/14
   ;--------------------------------------------------------------------
   "Set HVACSys:PropEqStd flag (1-htg) indicating system type change for all analysis simulations"      HVACSys:PropEqStd =     ; SAC 04/29/21
      {  if (FloorAreaServed[1] < 0.1) then  0
         else if (Type == 2 .AND. LocalStatus( HtPumpSysTypeAbbrev ) > 0)
         then  T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev )
         else if (Type != 2 .AND. LocalStatus( HeatSysTypeAbbrev   ) > 0)
         then  T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HeatSysTypeAbbrev )
         else  0  endif endif endif  }
   "Set HVACSys:PropEqStd flag (2-clg)"      HVACSys:PropEqStd =
      {  if (PropEqStd > 0 .OR. FloorAreaServed[1] < 0.1) then  UNCHANGED
         else if (Type == 2 .AND. LocalStatus( HtPumpSysTypeAbbrev ) > 0)
         then  T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev )
         else if (Type != 2 .AND. LocalStatus( CoolSysTypeAbbrev   ) > 0)
         then  T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev )
         else  UNCHANGED  endif endif endif  }

;	"store BEMProc details"		HVACSys:Action = {  StoreBEMProc( "b4 Dist-Fan for Prop-Std sys", 0 )  }
  ; SAC 5/6/14 - START by creating HVACDist and/or HVACFan if they are required to model the proposed (like standard) system (GC #312)
  ; SAC 8/7/14 - added logic to create & assign HVACDist if Dist required but currently assigned HVACDist:Type = 8 (NoDucts) - GC #352
	"Create HVACSys:DistribSystem when required to model standard-like heating system"
			HVACSys:DistribSystem	= {	if (Type == 2 .OR. (LocalCompAssigned( DistribSystem ) > 0.5 .AND. IfValidAnd( DistribSystem:Type != 8 )) .OR. FloorAreaServed[1] < 0.1 .OR.
															LocalStatus( HeatSysTypeAbbrev ) < 1 .OR. LocalStatus( StdHeatingType ) < 1) then  UNCHANGED
													else if (T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HeatSysTypeAbbrev ) < 0.5) then  UNCHANGED
													else if (T24RHeatingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdHeatingType ) ) > 0.5)
													then	CreateComp( HVACDist, Local( Name ) + "-dist", "Setup_HVACDist" )
													else  UNCHANGED  endif endif endif  }
	"Create HVACSys:DistribSystem when required to model standard-like cooling system"
			HVACSys:DistribSystem	= {	if (Type == 2 .OR. (LocalCompAssigned( DistribSystem ) > 0.5 .AND. IfValidAnd( DistribSystem:Type != 8 )) .OR. FloorAreaServed[1] < 0.1 .OR.
															LocalStatus( CoolSysTypeAbbrev ) < 1 .OR. LocalStatus( StdCoolingType ) < 1) then  UNCHANGED
													else if (T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev ) < 0.5) then  UNCHANGED
													else if (T24RCoolingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) ) > 0.5)
													then	CreateComp( HVACDist, Local( Name ) + "-dist", "Setup_HVACDist" )
													else  UNCHANGED  endif endif endif  }
	"Create HVACSys:DistribSystem when required to model standard-like heat pump system"
			HVACSys:DistribSystem	= {	if (Type != 2 .OR. (LocalCompAssigned( DistribSystem ) > 0.5 .AND. IfValidAnd( DistribSystem:Type != 8 )) .OR. FloorAreaServed[1] < 0.1 .OR.
															LocalStatus( HtPumpSysTypeAbbrev ) < 1 .OR. LocalStatus( StdCoolingType ) < 1 .OR. LocalStatus( StdHeatingType ) < 1) then  UNCHANGED
													else if (T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) > 0.5 .AND.
																T24RHeatingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdHeatingType ) ) > 0.5)
													then	CreateComp( HVACDist, Local( Name ) + "-dist", "Default_HVACDist_ForceTypeDefault" )
													else if (T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) > 0.5 .AND.
																T24RCoolingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) ) > 0.5)
													then	CreateComp( HVACDist, Local( Name ) + "-dist", "Setup_HVACDist" )
													else  UNCHANGED  endif endif endif  }

	"Create HVACSys:Fan when required to model standard-like heating system"
			HVACSys:Fan	= {	if (Type == 2 .OR. LocalCompAssigned( Fan ) > 0.5 .OR. FloorAreaServed[1] < 0.1 .OR.
											LocalStatus( HeatSysTypeAbbrev ) < 1 .OR. LocalStatus( StdHeatingType ) < 1) then  UNCHANGED
									else if (T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HeatSysTypeAbbrev ) < 0.5) then  UNCHANGED
									else if (T24RHeatingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdHeatingType ) ) > 0.5)
									then	CreateComp( HVACFan, Local( Name ) + "-fan", "Setup_HVACDistFan" )
									else  UNCHANGED  endif endif endif  }
	"Create HVACSys:Fan when required to model standard-like cooling system"
			HVACSys:Fan	= {	if (Type == 2 .OR. LocalCompAssigned( Fan ) > 0.5 .OR. FloorAreaServed[1] < 0.1 .OR.
											LocalStatus( CoolSysTypeAbbrev ) < 1 .OR. LocalStatus( StdCoolingType ) < 1) then  UNCHANGED
									else if (T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev ) < 0.5) then  UNCHANGED
									else if (T24RCoolingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) ) > 0.5)
									then	CreateComp( HVACFan, Local( Name ) + "-fan", "Setup_HVACDistFan" )
									else  UNCHANGED  endif endif endif  }
	"Create HVACSys:Fan when required to model standard-like heat pump system"
			HVACSys:Fan	= {	if (Type != 2 .OR. LocalCompAssigned( Fan ) > 0.5 .OR. FloorAreaServed[1] < 0.1 .OR.
											LocalStatus( HtPumpSysTypeAbbrev ) < 1 .OR. LocalStatus( StdCoolingType ) < 1 .OR. LocalStatus( StdHeatingType ) < 1) then  UNCHANGED
									else if (T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) > 0.5 .AND.
												T24RHeatingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdHeatingType ) ) > 0.5)
									then	CreateComp( HVACFan, Local( Name ) + "-fan", "Setup_HVACDistFan" )
									else if (T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) > 0.5 .AND.
												T24RCoolingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) ) > 0.5)
									then	CreateComp( HVACFan, Local( Name ) + "-fan", "Setup_HVACDistFan" )
									else  UNCHANGED  endif endif endif  }

  ; SAC 5/6/14 - reset HVACSys:HtOrClDucted flag when modeling proposed (like standard) system (GC #312)
	"Adjust HVACSys:HtOrClDucted - heat-Htg"	HVACSys:HtOrClDucted		= {	if (HtOrClDucted == 1 .OR. HtOrClDucted == 3 .OR. Type == 2 .OR. FloorAreaServed[1] < 0.1 .OR.
																											LocalCompAssigned( HVACSys:DistribSystem ) < 0.5 .OR. LocalCompAssigned( HVACSys:Fan ) < 0.5 .OR.
																											LocalStatus( HeatSysTypeAbbrev ) < 1 .OR. LocalStatus( StdHeatingType ) < 1) then  UNCHANGED
																									else if (T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HeatSysTypeAbbrev ) < 0.5) then  UNCHANGED
																									else if (T24RHeatingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdHeatingType ) ) > 0.5)
																									then	HtOrClDucted + 1		else  0  endif endif endif  }
	"Adjust HVACSys:HtOrClDucted - heat-HP"	HVACSys:HtOrClDucted		= {	if (HtOrClDucted == 1 .OR. HtOrClDucted == 3 .OR. Type != 2 .OR. FloorAreaServed[1] < 0.1 .OR.
																											LocalCompAssigned( HVACSys:DistribSystem ) < 0.5 .OR. LocalCompAssigned( HVACSys:Fan ) < 0.5 .OR.
																											LocalStatus( HtPumpSysTypeAbbrev ) < 1 .OR. LocalStatus( StdHeatingType ) < 1) then  UNCHANGED
																									else if (T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) < 0.5) then  UNCHANGED
																									else if (T24RHeatingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdHeatingType ) ) > 0.5)
																									then	HtOrClDucted + 1		else  0  endif endif endif  }

	"Adjust HVACSys:HtOrClDucted - cool-Clg"	HVACSys:HtOrClDucted		= {	if (HtOrClDucted == 2 .OR. HtOrClDucted == 3 .OR. Type == 2 .OR. FloorAreaServed[1] < 0.1 .OR.
																											LocalCompAssigned( HVACSys:DistribSystem ) < 0.5 .OR. LocalCompAssigned( HVACSys:Fan ) < 0.5 .OR.
																											LocalStatus( CoolSysTypeAbbrev ) < 1 .OR. LocalStatus( StdCoolingType ) < 1) then  UNCHANGED
																									else if (T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev ) < 0.5) then  UNCHANGED
																									else if (T24RCoolingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) ) > 0.5)
																									then	HtOrClDucted + 2		else  0  endif endif endif  }
	"Adjust HVACSys:HtOrClDucted - cool-HP"	HVACSys:HtOrClDucted		= {	if (HtOrClDucted == 2 .OR. HtOrClDucted == 3 .OR. Type != 2 .OR. FloorAreaServed[1] < 0.1 .OR.
																											LocalCompAssigned( HVACSys:DistribSystem ) < 0.5 .OR. LocalCompAssigned( HVACSys:Fan ) < 0.5 .OR.
																											LocalStatus( HtPumpSysTypeAbbrev ) < 1 .OR. LocalStatus( StdCoolingType ) < 1) then  UNCHANGED
																									else if (T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) < 0.5) then  UNCHANGED
																									else if (T24RCoolingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) ) > 0.5)
																									then	HtOrClDucted + 2		else  0  endif endif endif  }

	"Setup Standard heating system properties - HVACHeat"
			HVACSys:Action		= {	if (FloorAreaServed < 0.1 .OR. LocalStatus( HeatSysTypeAbbrev ) < 1) then  UNCHANGED
											else if (T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HeatSysTypeAbbrev ) == 0) then  UNCHANGED
											else	switch (StdHeatingType)
														case  1 :	EvalRulelist( "Setup_HVACSys_Heat_CntrlFurnace" , 1 )
														case  2 :	EvalRulelist( "Setup_HVACSys_Heat_WallFurnaceFan"      , 1 )
														case  3 :	EvalRulelist( "Setup_HVACSys_Heat_Boiler"       , 1 )
														case 14 :	EvalRulelist( "Setup_HVACSys_Heat_WallFurnaceGravity", 1 )		; SAC 11/25/14 - value 4->14
														case 15 :	EvalRulelist( "Setup_HVACSys_Heat_FloorFurnace"      , 1 )		; SAC 11/25/14 - value 5->15
														case 16 :	EvalRulelist( "Setup_HVACSys_Heat_RoomHeater"      , 1 )			; SAC 11/25/14 - value 6->16													
														case  8 :	EvalRulelist( "Setup_HVACSys_Heat_Electric"     , 1 )
														case  9 :	EvalRulelist( "Setup_HVACSys_Heat_CombHydro"    , 1 )
														default :	PostError( "Unexpected standard design heating system type (%g) encountered", StdHeatingType )
													endswitch  endif endif  }
	"Setup Standard heating system properties - HVACHtPump"
			HVACSys:Action		= {	if (FloorAreaServed < 0.1 .OR. LocalStatus( HtPumpSysTypeAbbrev ) < 1) then  UNCHANGED
											else if (T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) == 0) then  UNCHANGED
											else	switch (StdHeatingType)
														case  1 :	UNCHANGED		; CntrlFurnace
														case  2 :	UNCHANGED		; Heater
														case  3 :	UNCHANGED		; Boiler
		  											case  4 :	EvalRulelist( "Setup_HVACSys_HtPump_SplitHeatPump", 1 )
														case 19 :	EvalRulelist( "Setup_HVACSys_HtPump_SDHVSplitHeatPump", 1 )
														case 10 :	EvalRulelist( "Setup_HVACSys_HtPump_DuctlessMiniSplitHeatPump", 1 )
														case  7 :	EvalRulelist( "Setup_HVACSys_HtPump_RoomHeatPump" , 1 )
														case  8 :	UNCHANGED		; Electric
														case  9 :	UNCHANGED		; CombHydro
														default :	PostError( "Unexpected standard design heat pump (heating) system type (%g) encountered", StdHeatingType )
													endswitch  endif endif  }
	"Setup Standard cooling system properties - HVACCool"
			HVACSys:Action		= {	if (FloorAreaServed < 0.1 .OR. LocalStatus( CoolSysTypeAbbrev ) < 1) then  UNCHANGED
											else if (T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev ) == 0) then  UNCHANGED
											else	switch (StdCoolingType)
														case  2 :	Evalrulelist( "Setup_HVACSys_Cool_SplitAirCond" , 1 )
														case  5 :	Evalrulelist( "Setup_HVACSys_Cool_RoomAirCond"  , 1 )
														case  6 :	UNCHANGED		; SplitHeatPump
														case 10 :	UNCHANGED		; RoomHeatPump
														default :	PostError( "Unexpected standard design cooling system type (%g) encountered", StdCoolingType )
													endswitch  endif endif  }
	"Setup Standard cooling system properties - HVACHtPump"
			HVACSys:Action		= {	if (FloorAreaServed < 0.1 .OR. LocalStatus( HtPumpSysTypeAbbrev ) < 1) then  UNCHANGED
											else if (T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) == 0) then  UNCHANGED
											else	switch (StdCoolingType)
														case  2 :	UNCHANGED		; SplitAirCond
														case  5 :	UNCHANGED		; RoomAirCond
														case  6 :	Evalrulelist( "Setup_HVACSys_Cool_SplitHeatPump", 1 )
														case 10 :	Evalrulelist( "Setup_HVACSys_Cool_RoomHeatPump" , 1 )
														default :	PostError( "Unexpected standard design heat pump (cooling) system type (%g) encountered", StdCoolingType )
													endswitch  endif endif  }
   ; SAC 8/16/19 - added rule to force Proposed model VCHP performance to Std design levels (tic #1148)
	"Force Proposed VCHP heat/cool efficiencies to std design levels"
			HVACSys:Action		= {	if (FloorAreaServed < 0.1 .OR. LocalStatus( HtPumpSysTypeAbbrev ) < 1 .OR. Status == 1) then  UNCHANGED
			                        else if (IfValidAnd( HtPumpSysTypeAbbrev = "VCHP" ))
			                        then  Evalrulelist( "Setup_HVACSys_ProposedVCHP", 1 )
			                        else  UNCHANGED  endif endif  }
;	"debug HVAC"			HVACSys:Action = { if (FloorAreaServed > 0.5) then PostWarning( "PostProposedInput  HVACSys: '%s'  StdHeatingType: %g   StdCoolingType: %g",  Name, StdHeatingType, StdCoolingType ) else UNCHANGED endif  }

   "Reset HVACSys:GasFurnAreaServed - area served iff heating type is Gas Furnace"     HVACSys:GasFurnAreaServed =      ; SAC 04/29/21
      {  if (PropEqStd > 0 .AND. Type != 2 .AND. (StdHeatingType == 1 .OR. StdHeatingType == 18)) then  FloorAreaServed[1]    ; CntrlFurnace or PkgGasFurnace
         else  UNCHANGED  endif  }
   "RE-default all HVACfans iff PropEqStd changes made above"     Proj:Action	=        ; SAC 04/29/21
      {	if (SumAll( HVACSys:PropEqStd ) < 1) then  UNCHANGED  else  EvalRulelist( "Default_Fan" )  endif  }


   ;--------------------------------------------------------------------
   ; Assign SimDHWSys to send to DHWDLL 	mjb-12/18/13
   ;--------------------------------------------------------------------

   "Assign SimDHWSys"          DHWSys:SimDHWSys  =       ; SAC 10/2/19 - revised to handle central laundry (MFamProto)
      {  if ( FloorAreaServed > 0 ) then  1
         else if (Proj:IsMultiFamily > 0.5 .AND.
                  SumRevRef( OtherZone:ozDHWSys, OtherZone:WasherDwellUnits ) > 0) then  1
         else  0  endif endif  }


   ;--------------------------------------------------------------------
   ; Building Summary setup
   ;--------------------------------------------------------------------
;	"Evaluate rules to summarize building model for reporting purposes"		Proj:Action	= {	EvalRulelist( "Reporting_SummarizeModel" )  }
;	mjb	6/13/14	make sure Fan and Dist TypeRpt assigned
	"Set HVACFan TypeRpt"		HVACFan:TypeRpt	=	{	if ( TypeRpt == 0 ) then UNCHANGED else 1 endif	}
;	"Set HVACDist TypeRpt"		HVACDist:TypeRpt	=	{	if ( TypeRpt == 0 ) then UNCHANGED else 1 endif	}
;	"DBG msg" HVACDist:Action = { MessageBox( "Post Proposed -- HVACDist '%s' TypeRpt = %g", Name, TypeRpt ) }
END
;*************************************************************************


; rulelist designed to be evaluated immediately before generic (numeric range...) checks, to ensure those checks are performed ony on valid/analyzed model components - SAC 5/18/20 (tic #1187)
;*************************************************************************
RULELIST "ModelErrorCheckPrep" 1 0 0 0
;*************************************************************************

   "Blast DHWHeater:EFRangeChkID for unreferenced heaters"     DHWHeater:EFRangeChkID  =     ; SAC 5/18/20 (tic #1187)
      {  if (IfValidAnd( EFRangeChkID > 0 ) .AND. IfValidAnd( FloorAreaServed > 0.1 )==0) then  0
         else  UNCHANGED  endif  }

END
;*************************************************************************


; SAC 6/28/14 - rulelist designed to prepare Multifamily models for analysis
;*************************************************************************
RULELIST "MultiFamilyAnalysisPrep" 1 0 0 0
;*************************************************************************

;"store BEMProc details"		Proj:Action = {  StoreBEMProc( "Before HVAC re-gen", 0 )  }

	;"Blast all HVACSys objects"														Proj:Action	= {	DeleteAllComps( HVACSys )  }
	; SAC 9/23/19 - replaced above w/ following to prevent deletion of HVACSys objects that are refefenced by OtherZone objects (MFamProto)
   "Blast all HVACSys objects (not assigned by OtherZones)"	   HVACSys:Action	=
      {  if (SumRevRef( OtherZone:ozHVACSystem, OtherZone:CondFloorArea ) > 0) then   UNCHANGED
         else  DeleteComp()  endif  }

	"Generate HVACSys objects based on DwellUnit equipment assignments"	Proj:Action	= {	CreateDwellUnitHVACSysObjects()  }

;"store BEMProc details"		Proj:Action = {  StoreBEMProc( "After HVAC re-gen", 0 )  }
;"debug"		Proj:Action	= {	MessageBox( "Multifamily HVACSys RE-generation complete" )  }
	
END
;*************************************************************************


; rulelist designed to be evaluated only once per round of analysis (even for All Orientation runs)  - SAC 9/10/13 added
; This rulelist is evaluated BEFORE CF1RPRF proposed model reporting, whereas PostProposedInput is evaluated AFTER CF1RPRF prop
;*************************************************************************
RULELIST "OneTimeAnalysisPrep" 1 0 0 0
;*************************************************************************

   ; SAC 4/10/17 - setup Target Design Rating if entered and allowed
   ; SAC 12/12/17 - added check to ensure PV system size (PVWDCSysTotal) > 0 in order to calc TDR (tic #888)
   ; SAC 6/8/19 - added logic to prevent Target Design Rating for 2022 code (until calcs updated to handle it)
;   ; RE-enable TargetDesignRtg for 2022 (and later) code vintages - SAC 02-24-22
;   "Set Proj:TargetDesignRtg - Target Design Rating (100 * Prop / DesignRtg TDV)"
;      Proj:TargetDesignRtg  = {
;         if (IfValidAnd( EnergyCodeYearNum >= 2016 ) .AND.    ; IfValidAnd( EnergyCodeYearNum < 2022 ) .AND. 
   "Set Proj:TargetDesignRtg - Target Design Rating (100 * Prop / DesignRtg TDV)"
      Proj:TargetDesignRtg  = {
         if (IfValidAnd( EnergyCodeYearNum >= 2016 ) .AND. IfValidAnd( EnergyCodeYearNum < 2022 ) .AND. 
             IfValidAnd( AllowDesignRating  > 0.5 ) .AND. IfValidAnd( DesignRatingCalcs  > 0.5 ) .AND.
             IfValidAnd( SpecifyTargetDRtg  > 0.5 ) .AND. LocalStatus( TargetDesignRtgInp ) > 0 .AND.
             IfValidAnd( PVWDCSysTotal > 0 ))
         then  TargetDesignRtgInp
         else  UNDEFINED  endif  }

   ; SAC 1/27/18 - Proj:CondFloorArea-dependent CO2 emissions unit conversion multipliers
   "Set Proj:CO2FuelUnitLabel - text label for CO2 emissions by fuel type"
       Proj:CO2FuelUnitLabel   = {  "kg"  }
   "Set Proj:CO2FuelUnitMult - conversion factor from EnergyUse units (tonne/ft2-yr) to CO2FuelUnitLabel"
       Proj:CO2FuelUnitMult    = {  CondFloorArea * 1000  }
   "Set Proj:CO2TotalUnitLabel - text label for total (summary) CO2 emissions"
       Proj:CO2TotalUnitLabel  = {  "kg"  }
;       Proj:CO2TotalUnitLabel  = {  "g/ft2-yr"  }
   "Set Proj:CO2TotalUnitMult - conversion factor from EnergyUse units (tonne/ft2-yr) units to CO2TotalUnitLabel"
       Proj:CO2TotalUnitMult   = {  CondFloorArea * 1000  }
;       Proj:CO2TotalUnitMult   = {  1000000  }

  ; LDH 07/28/2016 - Rules to Blast Dwelling Units for Single Family
  "Blast Dwelling Units for Single Family"  DwellUnit:Action = {
    if( Proj:IsMultiFamily = 0 )
    then EvalRulelist( "BlastDwellingUnit", 1 )
    else UNCHANGED
    endif }

  ; LDH 07/29/16 - Rulelists to Reset Status Properties based on Compliance Type (tic 602)

; ---------- Call Rulelist to Reset Zone:Status and Attic:Status for 'Newly Constructed' --------------------
  "Reset Zone:Status based on Proj:RunType"  Proj:Action = {
    if( Proj:RunScope = 1 ) then EvalRulelist( "ResetZoneStatus_New", 0 ) else UNCHANGED endif }

; ---------- Call Rulelist to Reset Env:Status based on Zone:Status -----------------------------------------  SAC 9/20/19 - revised rule to set Proj:Action vs. Zone: since rules not restricted to a single Zone: properties
  "Reset Envelope:Status based on Zone:Status"  Proj:Action = { 
    EvalRulelist( "ResetEnvelopeObjectStatus_New", 0 ) }

; ---------- Call Rulelist to Reset Mechanical Status properties for 'Newly Constructed' + NOT Addition/Alteration
  "Reset Mechanical Status Properties based on Proj:RunType"  Proj:Action = {
    if( Proj:RunScope = 1 .AND. Proj:IsAddAlone = 0 )
    then EvalRulelist( "ResetMechStatus_New", 0 ) 
    else UNCHANGED 
    endif }

   ;--------------------------------------------------------------------
   ; Ensure no invalid ADU data present in analysis or report
   ;--------------------------------------------------------------------
   "Remove any old/invalid ADU data"      Proj:Action  =          ; SAC 5/15/20 (tic #1199)
      {  if (IsMultiFamily > 0 .OR. SFamADUType > 0) then  UNCHANGED
         else  EvalRulelist( "OneTimeAnalysisPrep_RemoveADUInputs" )  endif  }

; SAC 12/23/15 - MOVED from PostProposedInput to get it done BEFORE it is used to set final people heat gains
  ; SAC 8/20/14 - rule to force reset of Proj:NumBedrooms for MFam models (GC #354 note#1)
	"Set Proj:NumBedrooms"		Proj:NumBedrooms		= {	if (IfValidAnd( IsMultiFamily > 0.5 )) then  SumAll( DwellUnit:TotalNumBedrooms )
																			else  UNCHANGED  endif  }
	"Set Proj:NumAddBedrooms"	Proj:NumAddBedrooms	= {	if (IfValidAnd( IsMultiFamily > 0.5 )) then  0		; SAC 12/28/15 - added - will need updates to properly handle MFam Addition Alone
																			else  UNCHANGED  endif  }

  ; SAC 12/30/15 - added to ensure HVACDist not assigned to both heat+cool & heat-only systems (tic 544)
  ; SAC 5/14/19 - replaced use of HVACSys:HaveHeating/Cooling with ServesHeating/Cooling to ignore presences of assignments to systems w/ no served floor area
	"Set HVACDist:ServesHeating"		HVACDist:ServesHeating	= {	SumRevRef( HVACSys:DistribSystem, HVACSys:ServesHeating )  }
	"Set HVACDist:ServesCooling"		HVACDist:ServesCooling	= {	SumRevRef( HVACSys:DistribSystem, HVACSys:ServesCooling )  }

  ; SAC 1/4/16 - for SFam models, if any zone assigns DHW system, then make sure ALL zones are modeled w/ DHW
  ; SAC 2/29/16 - extended assignment of DHWSys1/2, AltDHWSys1/2 & exDHWSys1/2 to include EAA models (tic #607)
	"Set Zone:DHWSys1 (if SFam w/ DHW when not already assigned)"
			Zone:DHWSys1	= {	if (Proj:IsMultiFamily > 0.5 .OR. GlobalCompAssigned( Proj:MaxDHWSysByCateg[1] ) < 1 .OR. DHWSys1Status != 3 .OR. LocalCompAssigned( DHWSys1 ) > 0) then  UNCHANGED
										else if ((DHWSys2Status == 3 .AND. LocalCompAssigned( DHWSys2 ) > 0) .OR.
													((Proj:RunScope == 2 .OR. Proj:IsAddAlone > 0) .AND.
															((DHWSys1Status == 2 .AND. LocalCompAssigned( AltDHWSys1 ) > 0) .OR. (DHWSys2Status == 2 .AND. LocalCompAssigned( AltDHWSys2 ) > 0))) .OR.
													((Proj:RunScope == 2 .OR. Proj:IsAddAlone > 0) .AND.
															((DHWSys1Status == 1 .AND. LocalCompAssigned(  exDHWSys1 ) > 0) .OR. (DHWSys2Status == 1 .AND. LocalCompAssigned(  exDHWSys2 ) > 0))) )
										then  UNCHANGED
										else	Proj:MaxDHWSysByCateg[1]  endif endif  }
	"Set Zone:AltDHWSys1 (if SFam & altered DHW not already assigned)"
			Zone:AltDHWSys1	= {	if ((Proj:RunScope == 1 .AND. Proj:IsAddAlone < 1) .OR. Proj:IsMultiFamily > 0.5 .OR. GlobalCompAssigned( Proj:MaxDHWSysByCateg[2] ) < 1 .OR.
													DHWSys1Status != 2 .OR. LocalCompAssigned( AltDHWSys1 ) > 0)
											then  UNCHANGED
											else if ((DHWSys1Status == 3 .AND. LocalCompAssigned(    DHWSys1 ) > 0) .OR. (DHWSys2Status == 3 .AND. LocalCompAssigned(    DHWSys2 ) > 0) .OR.
																																				  (DHWSys2Status == 2 .AND. LocalCompAssigned( AltDHWSys2 ) > 0) .OR.
														(DHWSys1Status == 1 .AND. LocalCompAssigned(  exDHWSys1 ) > 0) .OR. (DHWSys2Status == 1 .AND. LocalCompAssigned(  exDHWSys2 ) > 0) )
											then  UNCHANGED
											else	Proj:MaxDHWSysByCateg[2]  endif endif  }
	"Set Zone:exDHWSys1 (if SFam & existing DHW not already assigned)"
			Zone:exDHWSys1		= {	if ((Proj:RunScope == 1 .AND. Proj:IsAddAlone < 1) .OR. Proj:IsMultiFamily > 0.5 .OR. GlobalCompAssigned( Proj:MaxDHWSysByCateg[3] ) < 1 .OR.
													DHWSys1Status != 1 .OR. LocalCompAssigned( exDHWSys1 ) > 0)
											then  UNCHANGED
											else if ((DHWSys1Status == 3 .AND. LocalCompAssigned(    DHWSys1 ) > 0) .OR. (DHWSys2Status == 3 .AND. LocalCompAssigned(    DHWSys2 ) > 0) .OR.
														(DHWSys1Status == 2 .AND. LocalCompAssigned( AltDHWSys1 ) > 0) .OR. (DHWSys2Status == 2 .AND. LocalCompAssigned( AltDHWSys2 ) > 0) .OR.
																																				  (DHWSys2Status == 1 .AND. LocalCompAssigned(  exDHWSys2 ) > 0) )
											then  UNCHANGED
											else	Proj:MaxDHWSysByCateg[3]  endif endif  }

	; SAC 9/3/15 - added new rules to prep model for DHW - DwellUnitType objects that have HVAC htg equip serving as DHW heaters
	"Special prep for DwellUnitType objects that have HVAC htg equip serving as DHW heaters"
			Proj:Action		= {	if (IsMultiFamily < 0.5) then  UNCHANGED
										else if (SumAcrossIf( DwellUnitType:HtEqpUsedAsDHWHtr, DwellUnitType:AssignedDUFlrArea > 1 ) < 0.5) then  UNCHANGED
										else	EvalRulelist( "OneTimeAnalysisPrep_DwellUnitDHW" )  endif endif  }

   "Call subordinate rulelist to ensure 20 gal tank volume cap for small home elec res systems taking exception"  Proj:Action =     ; SAC 05/23/22 (tic #1332)
      {  if (SumAll( DHWSys:ShowNewSmConsInstElecExcept ) < 1 .OR.
             SumAll( DHWSys:NewSmConsInstElecExcept     ) < 1) then  UNCHANGED
         else  EvalRulelist( "OneTimeAnalysisPrep_SmallHomeElecResDHWException" )  endif  }

   ; SAC 6/27/18 - ensure valid DHW InputRating data for use by HERS providers (tic #940)
   ; SAC 6/28/18 - further mods to leave InputRating UNCHANGED in scenarios where user input accepted (so that status not changed to Rule-defined) (tic #940)
   "Ensure proper reporting value for DHWHeater:InputRating"   DHWHeater:InputRating  = {
		switch (HeaterElementType)
			case  0 :	      	; (watts)   "Electric Resistance" 
                     switch (HeaterType)
               			case  2 :    12001		; "Large Instantaneous" 
               			case  3 :         		; "Large Storage" 
               			           if (IfValidAnd( InputRating > 0 )) then  UNCHANGED
               			           else  12001  endif
               			case  5 :    12000		; "Small Instantaneous" 
               			case  6 :    12000		; "Small Storage" 
               			case 10 :    12000		; "Consumer Instantaneous (UEF)"             
               			case 11 :    12001		; "Commercial Instantaneous (TE)"            
               			case 12 :    12000		; "Consumer Storage (UEF)" 
               			case 13 :         		; "Commercial Storage (TE & SBL)"            
               			           if (IfValidAnd( InputRating > 0 )) then  UNCHANGED
               			           else  12001  endif
                        case 15 :    36000      ; "Residential-Duty Commercial Instantaneous (UEF)"
							   default :	 12000  
							endswitch
			case  1 :   			; (Btu/hr)  "Natural Gas"   
                     switch (HeaterType)
                        case  0 :   200000      ; "Boiler"  
                        case  1 :   200000      ; "Indirect"  
                        case  2 :   200001      ; "Large Instantaneous"  
                        case  3 :               ; "Large Storage"  
               			           if (IfValidAnd( InputRating > 0 )) then  UNCHANGED
               			           else  75001  endif
                        case  9 :   200000	   ; "UEF-rated Instantaneous"
							   case  5 :   200000		; "Small Tankless"
               			case 10 :   200000		; "Consumer Instantaneous (UEF)"             
               			case 11 :   200001		; "Commercial Instantaneous (TE)"            
               			case 12 :    75000		; "Consumer Storage (UEF)"                   
               			case 13 :         		; "Commercial Storage (TE & SBL)"            
               			           if (IfValidAnd( InputRating > 0 )) then  UNCHANGED
               			           else  75001  endif
               			case 14 :    76000		; "Residential-Duty Commercial Storage (UEF)"
                        case 16 :   300000      ; "Commercial Packaged Boiler"      ; SAC 12/19/19 - to facilitate new central gas std design DHW system (tic #862)
							   default :	 75000		; "Small Storage"
							endswitch
			case  2 :   			; (Btu/hr)  "Propane"             
							if (HeaterType == 5) then  200000		; "Small Tankless"
							else	75000  endif							; "Small Storage"
			case  3 :    12000   ; (watts)   "Heat Pump"           
			case  4 :   			; (Btu/hr)  "Oil"   
							if (HeaterType == 5) then  200000		; "Small Tankless"
							else	75000  endif							; "Small Storage"
			case  5 :    12000	; (watts)  "Heat Pump"              
			default :	UNCHANGED
		endswitch  }

	; SAC 10/23/14 - moved evaluation of  rulelist out of source code and into this spot to solve other reporting issues
	"Eval ProposedReportPrep rules"	Proj:Action	= {	EvalRulelist( "ProposedReportPrep" )  }

; SAC 10/23/14 - moved these rules from PostProposedInput_HVAC to OneTimeAnalysisPrep rulelist to be set prior to Proposed model reporting export
   ;--------------------------------------------------------------------
   ; Adjust DuctInsRValue if E+A+A and Ducts are Status = 4 (Existing + New)
   ;--------------------------------------------------------------------
	"Set HVACDist:exDuctInsRvalue"			HVACDist:exDuctInsRvalue		= {	if (Proj:RunScope == 2 .AND. Status == 4) then
																											exDuctInsRvalOpt / 100
																										else  UNDEFINED  endif	 }
; mjb 7/10/14 - only execute this rule for Ducts used in Project (FloorAreaServed > 0)
	"Set HVACDist:DuctInsRvalue"				HVACDist:DuctInsRvalue	= {	if ( Proj:RunScope == 2 .AND. Status == 4 .AND. LocalStatus( exDuctInsRvalue ) > 0 .AND. FloorAreaServed > 0) then
																									((DuctInsRvalOpt/100 * (FloorAreaServed - exFloorAreaServed)) + (exDuctInsRvalue * exFloorAreaServed))/FloorAreaServed
																								else  UNCHANGED endif  }

   ;--------------------------------------------------------------------
   ; IAQFan - NumAssignments setting		SAC 9/10/13
   ;--------------------------------------------------------------------
; SAC 2/5/20 - moved IAQFan:NumAssignments up into defaulting rules in order to take into account for backward compatibility (tic #1174)
;	"Init all IAQFan:NumAssignments"							IAQFan:NumAssignments	= {	0  }
;  ; SAC 1/14/15 - updated rules for latest DwellUnitType structure and eliminate references to old (proj-based) MFam inputs
;	"Incrament Proj:UnitIAQFan1[1]:NumAssignments"		Proj:UnitIAQFan1[1]:NumAssignments	= {	if (IsMultiFamily < 0.5 .AND. UnitIAQOption[1] == 2 .AND. UnitIAQFanCnt1[1] > 0.5 .AND. IAQDisabled < 0.5) then  UnitIAQFan1[1]:NumAssignments + 1  else  UNCHANGED  endif  }
;	"Incrament Proj:UnitIAQFan2[1]:NumAssignments"		Proj:UnitIAQFan2[1]:NumAssignments	= {	if (IsMultiFamily < 0.5 .AND. UnitIAQOption[1] == 2 .AND. UnitIAQFanCnt2[1] > 0.5 .AND. IAQDisabled < 0.5) then  UnitIAQFan2[1]:NumAssignments + 1  else  UNCHANGED  endif  }
;	"Incrament Proj:UnitIAQFan3[1]:NumAssignments"		Proj:UnitIAQFan3[1]:NumAssignments	= {	if (IsMultiFamily < 0.5 .AND. UnitIAQOption[1] == 2 .AND. UnitIAQFanCnt3[1] > 0.5 .AND. IAQDisabled < 0.5) then  UnitIAQFan3[1]:NumAssignments + 1  else  UNCHANGED  endif  }
;	"Incrament Proj:UnitIAQFan4[1]:NumAssignments"		Proj:UnitIAQFan4[1]:NumAssignments	= {	if (IsMultiFamily < 0.5 .AND. UnitIAQOption[1] == 2 .AND. UnitIAQFanCnt4[1] > 0.5 .AND. IAQDisabled < 0.5) then  UnitIAQFan4[1]:NumAssignments + 1  else  UNCHANGED  endif  }
;
;	"Incrament DwellUnitType:IAQFanRef[1]:NumAssignments"		DwellUnitType:IAQFanRef[1]:NumAssignments	= {	if (Proj:IsMultiFamily > 0.5 .AND. IAQOption == 2 .AND. AssignedDUFlrArea > 0.5) then  IAQFanRef[1]:NumAssignments + 1  else  UNCHANGED  endif  }
;	"Incrament DwellUnitType:IAQFanRef[2]:NumAssignments"		DwellUnitType:IAQFanRef[2]:NumAssignments	= {	if (Proj:IsMultiFamily > 0.5 .AND. IAQOption == 2 .AND. AssignedDUFlrArea > 0.5) then  IAQFanRef[2]:NumAssignments + 1  else  UNCHANGED  endif  }
;	"Incrament DwellUnitType:IAQFanRef[3]:NumAssignments"		DwellUnitType:IAQFanRef[3]:NumAssignments	= {	if (Proj:IsMultiFamily > 0.5 .AND. IAQOption == 2 .AND. AssignedDUFlrArea > 0.5) then  IAQFanRef[3]:NumAssignments + 1  else  UNCHANGED  endif  }
;	"Incrament DwellUnitType:IAQFanRef[4]:NumAssignments"		DwellUnitType:IAQFanRef[4]:NumAssignments	= {	if (Proj:IsMultiFamily > 0.5 .AND. IAQOption == 2 .AND. AssignedDUFlrArea > 0.5) then  IAQFanRef[4]:NumAssignments + 1  else  UNCHANGED  endif  }

	; GENERATE NEW IAQFan objects when default minimum CFM selections are active (for reporting purposes)
	"Create SFam Proj:UnitIAQFan1[1] (when necessary)"			Proj:UnitIAQFan1[1]	= {	if (IsMultiFamily < 0.5 .AND. UnitIAQOption[1]  == 1 .AND. IAQDisabled < 0.5) then  CreateComp( IAQFan, "IAQ Fan", "SetupDefaultIAQFan_1"  )   else  UNCHANGED  endif  }
; SAC 6/25/14 - TO DO ?? create default IAQ fans for each DwellUnit ??
;		"Create MFam-1 Proj:UnitIAQFan1[1] (when necessary)"		Proj:UnitIAQFan1[1]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[1]  > 0.5 .AND. UnitIAQOption[1]  == 1) then  CreateComp( IAQFan, "Dwelling Unit #1 IAQ Fan",  "SetupDefaultIAQFan_1"  )   else  UNCHANGED  endif  }
;		"Create MFam-2 Proj:UnitIAQFan1[2] (when necessary)"		Proj:UnitIAQFan1[2]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[2]  > 0.5 .AND. UnitIAQOption[2]  == 1) then  CreateComp( IAQFan, "Dwelling Unit #2 IAQ Fan",  "SetupDefaultIAQFan_2"  )   else  UNCHANGED  endif  }
;		"Create MFam-3 Proj:UnitIAQFan1[3] (when necessary)"		Proj:UnitIAQFan1[3]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[3]  > 0.5 .AND. UnitIAQOption[3]  == 1) then  CreateComp( IAQFan, "Dwelling Unit #3 IAQ Fan",  "SetupDefaultIAQFan_3"  )   else  UNCHANGED  endif  }
;		"Create MFam-4 Proj:UnitIAQFan1[4] (when necessary)"		Proj:UnitIAQFan1[4]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[4]  > 0.5 .AND. UnitIAQOption[4]  == 1) then  CreateComp( IAQFan, "Dwelling Unit #4 IAQ Fan",  "SetupDefaultIAQFan_4"  )   else  UNCHANGED  endif  }
;		"Create MFam-5 Proj:UnitIAQFan1[5] (when necessary)"		Proj:UnitIAQFan1[5]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[5]  > 0.5 .AND. UnitIAQOption[5]  == 1) then  CreateComp( IAQFan, "Dwelling Unit #5 IAQ Fan",  "SetupDefaultIAQFan_5"  )   else  UNCHANGED  endif  }
;		"Create MFam-6 Proj:UnitIAQFan1[6] (when necessary)"		Proj:UnitIAQFan1[6]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[6]  > 0.5 .AND. UnitIAQOption[6]  == 1) then  CreateComp( IAQFan, "Dwelling Unit #6 IAQ Fan",  "SetupDefaultIAQFan_6"  )   else  UNCHANGED  endif  }
;		"Create MFam-7 Proj:UnitIAQFan1[7] (when necessary)"		Proj:UnitIAQFan1[7]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[7]  > 0.5 .AND. UnitIAQOption[7]  == 1) then  CreateComp( IAQFan, "Dwelling Unit #7 IAQ Fan",  "SetupDefaultIAQFan_7"  )   else  UNCHANGED  endif  }
;		"Create MFam-8 Proj:UnitIAQFan1[8] (when necessary)"		Proj:UnitIAQFan1[8]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[8]  > 0.5 .AND. UnitIAQOption[8]  == 1) then  CreateComp( IAQFan, "Dwelling Unit #8 IAQ Fan",  "SetupDefaultIAQFan_8"  )   else  UNCHANGED  endif  }
;		"Create MFam-9 Proj:UnitIAQFan1[9] (when necessary)"		Proj:UnitIAQFan1[9]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[9]  > 0.5 .AND. UnitIAQOption[9]  == 1) then  CreateComp( IAQFan, "Dwelling Unit #9 IAQ Fan",  "SetupDefaultIAQFan_9"  )   else  UNCHANGED  endif  }
;		"Create MFam-10 Proj:UnitIAQFan1[10] (when necessary)"	Proj:UnitIAQFan1[10]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[10] > 0.5 .AND. UnitIAQOption[10] == 1) then  CreateComp( IAQFan, "Dwelling Unit #10 IAQ Fan", "SetupDefaultIAQFan_10" )   else  UNCHANGED  endif  }
;		"Create MFam-11 Proj:UnitIAQFan1[11] (when necessary)"	Proj:UnitIAQFan1[11]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[11] > 0.5 .AND. UnitIAQOption[11] == 1) then  CreateComp( IAQFan, "Dwelling Unit #11 IAQ Fan", "SetupDefaultIAQFan_11" )   else  UNCHANGED  endif  }
;		"Create MFam-12 Proj:UnitIAQFan1[12] (when necessary)"	Proj:UnitIAQFan1[12]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[12] > 0.5 .AND. UnitIAQOption[12] == 1) then  CreateComp( IAQFan, "Dwelling Unit #12 IAQ Fan", "SetupDefaultIAQFan_12" )   else  UNCHANGED  endif  }
;		"Create MFam-13 Proj:UnitIAQFan1[13] (when necessary)"	Proj:UnitIAQFan1[13]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[13] > 0.5 .AND. UnitIAQOption[13] == 1) then  CreateComp( IAQFan, "Dwelling Unit #13 IAQ Fan", "SetupDefaultIAQFan_13" )   else  UNCHANGED  endif  }
;		"Create MFam-14 Proj:UnitIAQFan1[14] (when necessary)"	Proj:UnitIAQFan1[14]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[14] > 0.5 .AND. UnitIAQOption[14] == 1) then  CreateComp( IAQFan, "Dwelling Unit #14 IAQ Fan", "SetupDefaultIAQFan_14" )   else  UNCHANGED  endif  }
;		"Create MFam-15 Proj:UnitIAQFan1[15] (when necessary)"	Proj:UnitIAQFan1[15]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[15] > 0.5 .AND. UnitIAQOption[15] == 1) then  CreateComp( IAQFan, "Dwelling Unit #15 IAQ Fan", "SetupDefaultIAQFan_15" )   else  UNCHANGED  endif  }
;		"Create MFam-16 Proj:UnitIAQFan1[16] (when necessary)"	Proj:UnitIAQFan1[16]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[16] > 0.5 .AND. UnitIAQOption[16] == 1) then  CreateComp( IAQFan, "Dwelling Unit #16 IAQ Fan", "SetupDefaultIAQFan_16" )   else  UNCHANGED  endif  }

   ;--------------------------------------------------------------------
   ; ClVentFan - NumAssignments setting		SAC 9/11/13
   ;--------------------------------------------------------------------
	"Init all ClVentFan:NumAssignments"							ClVentFan:NumAssignments	= {	0  }
	; SAC 5/9/19 - added logic that accounts for ability to specify ClVent fans to Outside even when no cool-ventable attic exists (tic #1040)
	"Incrament Proj:UnitClVentFan[1]:NumAssignments"		Proj:UnitClVentFan[1]:NumAssignments	= {	if ((EnableClVent .OR. LimitedClVent) .AND. UnitClVentOption == 2) then  UnitClVentFan[1]:NumAssignments + 1  else  UNCHANGED  endif  }
	"Incrament Proj:UnitClVentFan[2]:NumAssignments"		Proj:UnitClVentFan[2]:NumAssignments	= {	if ((EnableClVent .OR. LimitedClVent) .AND. UnitClVentOption == 2) then  UnitClVentFan[2]:NumAssignments + 1  else  UNCHANGED  endif  }
	"Incrament Proj:UnitClVentFan[3]:NumAssignments"		Proj:UnitClVentFan[3]:NumAssignments	= {	if ((EnableClVent .OR. LimitedClVent) .AND. UnitClVentOption == 2) then  UnitClVentFan[3]:NumAssignments + 1  else  UNCHANGED  endif  }
	"Incrament Proj:UnitClVentFan[4]:NumAssignments"		Proj:UnitClVentFan[4]:NumAssignments	= {	if ((EnableClVent .OR. LimitedClVent) .AND. UnitClVentOption == 2) then  UnitClVentFan[4]:NumAssignments + 1  else  UNCHANGED  endif  }
	"Incrament Proj:UnitClVentFan[5]:NumAssignments"		Proj:UnitClVentFan[5]:NumAssignments	= {	if ((EnableClVent .OR. LimitedClVent) .AND. UnitClVentOption == 2) then  UnitClVentFan[5]:NumAssignments + 1  else  UNCHANGED  endif  }
	"Incrament Proj:UnitClVentFan[6]:NumAssignments"		Proj:UnitClVentFan[6]:NumAssignments	= {	if ((EnableClVent .OR. LimitedClVent) .AND. UnitClVentOption == 2) then  UnitClVentFan[6]:NumAssignments + 1  else  UNCHANGED  endif  }

   "Init all ClVentFan:AssignedArea"                     ClVentFan:AssignedArea   = {   0  }
   ; SAC 5/1/19 - rules similar to NumAssignments above but that tally assigned area in order to report CFM/ft2 in CF1R
   "Incrament Proj:UnitClVentFan[1]:AssignedArea"      Proj:UnitClVentFan[1]:AssignedArea   = {   if ((EnableClVent .OR. LimitedClVent) .AND. UnitClVentOption == 2 .AND. LocalCompAssigned( UnitClVentZone[1] )) then  UnitClVentFan[1]:AssignedArea + ValidOr( UnitClVentZone[1]:CondFloorArea, 0 )  else  UNCHANGED  endif  }
   "Incrament Proj:UnitClVentFan[2]:AssignedArea"      Proj:UnitClVentFan[2]:AssignedArea   = {   if ((EnableClVent .OR. LimitedClVent) .AND. UnitClVentOption == 2 .AND. LocalCompAssigned( UnitClVentZone[2] )) then  UnitClVentFan[2]:AssignedArea + ValidOr( UnitClVentZone[2]:CondFloorArea, 0 )  else  UNCHANGED  endif  }
   "Incrament Proj:UnitClVentFan[3]:AssignedArea"      Proj:UnitClVentFan[3]:AssignedArea   = {   if ((EnableClVent .OR. LimitedClVent) .AND. UnitClVentOption == 2 .AND. LocalCompAssigned( UnitClVentZone[3] )) then  UnitClVentFan[3]:AssignedArea + ValidOr( UnitClVentZone[3]:CondFloorArea, 0 )  else  UNCHANGED  endif  }
   "Incrament Proj:UnitClVentFan[4]:AssignedArea"      Proj:UnitClVentFan[4]:AssignedArea   = {   if ((EnableClVent .OR. LimitedClVent) .AND. UnitClVentOption == 2 .AND. LocalCompAssigned( UnitClVentZone[4] )) then  UnitClVentFan[4]:AssignedArea + ValidOr( UnitClVentZone[4]:CondFloorArea, 0 )  else  UNCHANGED  endif  }
   "Incrament Proj:UnitClVentFan[5]:AssignedArea"      Proj:UnitClVentFan[5]:AssignedArea   = {   if ((EnableClVent .OR. LimitedClVent) .AND. UnitClVentOption == 2 .AND. LocalCompAssigned( UnitClVentZone[5] )) then  UnitClVentFan[5]:AssignedArea + ValidOr( UnitClVentZone[5]:CondFloorArea, 0 )  else  UNCHANGED  endif  }
   "Incrament Proj:UnitClVentFan[6]:AssignedArea"      Proj:UnitClVentFan[6]:AssignedArea   = {   if ((EnableClVent .OR. LimitedClVent) .AND. UnitClVentOption == 2 .AND. LocalCompAssigned( UnitClVentZone[6] )) then  UnitClVentFan[6]:AssignedArea + ValidOr( UnitClVentZone[6]:CondFloorArea, 0 )  else  UNCHANGED  endif  }

	; GENERATE NEW ClVentFan objects when default minimum CFM selections are active (for reporting purposes)
	; SAC 8/17/19 - added logic to ensure WHF CFM > 0 for default prescrip. fan (tic #880)
	"Create new Proj:UnitClVentFan[1] (when necessary)"	Proj:UnitClVentFan[1]	=           ; SAC 5/9/19 - added logic that accounts for ability to specify ClVent fans to Outside even when no cool-ventable attic exists (tic #1040)
      {  if ( ( (EnableClVent .AND. UnitClVentOption == 1) .OR. ((EnableClVent .OR. LimitedClVent) .AND. UnitClVentOption == 5) ) .AND.
               T24RClimateZoneCodeBase:WHFcfmpersf( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0 ); JP 7/30/19 - added logic that prevent the creation of ClVent when using default fan and DefCFM = 0 (tic #1091)
         then  CreateComp( ClVentFan, "Whole House Fan", "SetupDefaultClVentFan" )
         else  UNCHANGED  endif  }

	; GENERATE NEW ClVentFan objects associated w/ individual 'CFI' HVACSys objects (for reporting purposes)
	"Create new HVACSys:CFIClVentFan (when necessary)"		HVACSys:CFIClVentFan		= {	if (Proj:EnableClVent > 0.5 .AND. Proj:UnitClVentOption == 3 .AND.
																															(Type == 3 .OR. ((Type == 1 .OR. Type == 2) .AND. CFIClVentOption > 0.5)))
																													then  CreateComp( ClVentFan, Name + " - CFI", "SetupCFIHVACSysClVentFan" )   else  UNCHANGED  endif  }
   "Set HVACSys:CFIClVentFan:AssignedArea"   HVACSys:CFIClVentFan:AssignedArea   = {   ValidOr( FloorAreaServed[1], 0 )  }    ; SAC 5/1/19

	"Specify HVACSys:CFIClVentFan:* properties (when necessary)"	Proj:Action		= {	if (Proj:EnableClVent > 0.5 .AND. Proj:UnitClVentOption == 3) then  EvalRulelist( "SetupCFIHVACSysClVentFan_UserInputs" )  else  UNCHANGED  endif  }

   ; SAC 2/22/18 - added ClVentFan:HERSVerification to facilitate CF1R population (tic #977)
   "Set ClVentFan:HERSVerification"    ClVentFan:HERSVerification = {
         if (Proj:EnergyCodeYearNum >= 2019 .AND. NumAssignments > 0 .AND.
             (IfValidAnd( Proj:ClVentVerified > 0 ) .OR. Proj:UnitClVentOption == 3 .OR.
              Proj:UnitClVentOption == 2))  ; SAC 4/23/19 - force verification when specifying indiv fans (tic #1023)
         then  1  else  0  endif  }

	; SAC 6/4/14 - per instruction from BAW - setup GSHP DHWHeater as a standard design electric htr
	"Setup Standard DHW Heater properties for GSHP HVAC system used as DWHtr"
			HVACSys:Action		= {	if (	TypeOK < 0.5 .OR. HtEqpCanBeDHWHtr < 0.5 .OR. ServesAsDHWHtr < 0.5 .OR. 
													IfValidAnd( Type = 2 )==0 .OR. IfValidAnd( HtPumpSysType = 12 )==0 ) then  UNCHANGED
											else	Evalrulelist( "SetupHVACSysDWHeater_GSHP", 1 )  endif  }

   ; SAC 1/19/18 - moved deletion of EUseSummary & EnergyUse objects from results processing rulelists to HERE (tic #966)
   "Blast all EUseSummary components prior to analysis"  Proj:Action  = {  DeleteAllComps( EUseSummary )  }
   "Blast all EnergyUse components prior to analysis"    Proj:Action  = {  DeleteAllComps( EnergyUse   )  }

END
;*************************************************************************


;************************************************************************* ; SAC 05/23/22 (tic #1332)
RULELIST "OneTimeAnalysisPrep_SmallHomeElecResDHWException" 1 0 1 0
;*************************************************************************
   "Limit tank volume to 20 gal for small home elec res systems taking exception"      
      for:#Htr=(1to6)  DHWSys:DHWHeater[#Htr]:TankVolume = 
         {  if (IfValidAnd( ShowNewSmConsInstElecExcept > 0 ) .AND. IfValidAnd( NewSmConsInstElecExcept > 0 ) .AND.
                IfValidAnd( DHWHeater[#Htr]:HeaterElementType = 0 ) .AND. IfValidAnd( DHWHeater[#Htr]:TankType = 12 ) .AND.
                IfValidAnd( DHWHeater[#Htr]:TankVolume > 20 ))
            then  20
            else  UNCHANGED  endif  }
END
;*************************************************************************


; SAC 9/3/15 - added new rules to prep model for DHW - DwellUnitType objects that have HVAC htg equip serving as DHW heaters
;*************************************************************************
RULELIST "OneTimeAnalysisPrep_DwellUnitDHW" 1 0 0 0
;*************************************************************************
	"Initiate creation of DHWSys & DHWHeater for DwellUnitType objects that have HVAC heating-based DHW"
			DwellUnitType:Action		= {	if (HtEqpUsedAsDHWHtr < 0.5 .OR. AssignedDUFlrArea < 1) then  UNCHANGED
													else	EvalRulelist( "OneTimeAnalysisPrep_CreateDwellUnitDHW", 1 )  endif  }

	"Eval ProposedInput rules to re-default all DHWSys & DwellUnit properties effected by the above DHWSys/Heater creation/assignment"
			Proj:Action	= {	EvalRulelist( "ProposedInput" )  }
END

; SAC 9/3/15 - added new rules to prep model for DHW - DwellUnitType objects that have HVAC htg equip serving as DHW heaters
;*************************************************************************
RULELIST "OneTimeAnalysisPrep_CreateDwellUnitDHW" 1 0 1 0
;*************************************************************************
	"Set DwellUnitType:NumDHWSysTypes to 1"		DwellUnitType:NumDHWSysTypes	= {	1  }
	"Create new DHWSys to serve this DUT"			DwellUnitType:DHWSysRef[1]		= {	CreateComp( DHWSys, Name + "-dhwsys" )  }

	"Set new DUT DHWSys:SystemType"			DwellUnitType:DHWSysRef[1]:SystemType		= {	DHWSystemType  }
	"Set new DUT DHWSys:SolFracType"			DwellUnitType:DHWSysRef[1]:SolFracType		= {	DHWSolFracType  }
	"Set new DUT DHWSys:SolFracAnn"			DwellUnitType:DHWSysRef[1]:SolFracAnn		= {	DHWSolFracAnn   }
	"Set new DUT DHWSys:SolFracMon[1]"		DwellUnitType:DHWSysRef[1]:SolFracMon[1]	= {	DHWSolFracMon[1]   }
	"Set new DUT DHWSys:SolFracMon[2]"		DwellUnitType:DHWSysRef[1]:SolFracMon[2]	= {	DHWSolFracMon[2]   }
	"Set new DUT DHWSys:SolFracMon[3]"		DwellUnitType:DHWSysRef[1]:SolFracMon[3]	= {	DHWSolFracMon[3]   }
	"Set new DUT DHWSys:SolFracMon[4]"		DwellUnitType:DHWSysRef[1]:SolFracMon[4]	= {	DHWSolFracMon[4]   }
	"Set new DUT DHWSys:SolFracMon[5]"		DwellUnitType:DHWSysRef[1]:SolFracMon[5]	= {	DHWSolFracMon[5]   }
	"Set new DUT DHWSys:SolFracMon[6]"		DwellUnitType:DHWSysRef[1]:SolFracMon[6]	= {	DHWSolFracMon[6]   }
	"Set new DUT DHWSys:SolFracMon[7]"		DwellUnitType:DHWSysRef[1]:SolFracMon[7]	= {	DHWSolFracMon[7]   }
	"Set new DUT DHWSys:SolFracMon[8]"		DwellUnitType:DHWSysRef[1]:SolFracMon[8]	= {	DHWSolFracMon[8]   }
	"Set new DUT DHWSys:SolFracMon[9]"		DwellUnitType:DHWSysRef[1]:SolFracMon[9]	= {	DHWSolFracMon[9]   }
	"Set new DUT DHWSys:SolFracMon[10]"		DwellUnitType:DHWSysRef[1]:SolFracMon[10]	= {	DHWSolFracMon[10]  }
	"Set new DUT DHWSys:SolFracMon[11]"		DwellUnitType:DHWSysRef[1]:SolFracMon[11]	= {	DHWSolFracMon[11]  }
	"Set new DUT DHWSys:SolFracMon[12]"		DwellUnitType:DHWSysRef[1]:SolFracMon[12]	= {	DHWSolFracMon[12]  }

	"Create new DHWHeater to serve this DUT"		DwellUnitType:DHWSysRef[1]:DHWHeater[1]	= {	CreateComp( DHWHeater, Name + "-dhwhtr" )  }

   ; SAC 1/13/16 - separated out DHWHeater settings to handle air to water heat pump (AWHP) source DHW for MFam models (tic 560)
   ; SAC 7/29/18 - removed all logic pertaining to DHWCalcMethod (related to transition from T24DHW DLLs to CSE)
	"Set DHWHeater properties for this DwellUnitType"	DwellUnitType:Action		= {	if (IfValidAnd( HVACSysType == 2 ) .AND. IfValidAnd( HVACHtPumpRef[1]:Type == 11 ) .AND.
																													 IfValidAnd( ServesAsDHWHtr > 0.5 ) )
																												then	EvalRulelist( "OneTimeAnalysisPrep_CreateDwellUnitDHW_AWHP",   1 )
																												else	EvalRulelist( "OneTimeAnalysisPrep_CreateDwellUnitDHW_Normal", 1 )  endif  }
END

; SAC 1/13/16 - separated out DHWHeater settings to handle air to water heat pump (AWHP) source DHW for MFam models (tic 560)
;*************************************************************************
RULELIST "OneTimeAnalysisPrep_CreateDwellUnitDHW_AWHP" 1 0 1 0
	"Set new DUT DHWHeater:HeaterElementType"		DwellUnitType:DHWSysRef[1]:DHWHeater[1]:HeaterElementType		= {	5  }	; "Heat Pump"     ; SAC 10/29/19 - switch AWHP sim type from 3 (old) to 5 (new model) (tic #1134)
	"Set new DUT DHWHeater:HPWH_NEEARated flag"	DwellUnitType:DHWSysRef[1]:DHWHeater[1]:HPWH_NEEARated			= {	0  }	; fixes problem where NEEA Brand & Model required - SAC 6/14/20 (tic #1185)
	"Set new DUT DHWHeater:IsHydronic flag"		DwellUnitType:DHWSysRef[1]:DHWHeater[1]:IsHydronic					= {	1  }	; setting this flag should cause proper setup of CSE input for AWHP DHW
	"Set new DUT DHWHeater:TankType"					DwellUnitType:DHWSysRef[1]:DHWHeater[1]:TankType					= {	1  }	; "Indirect"
;	"Set new DUT DHWHeater:InputRating"				DwellUnitType:DHWSysRef[1]:DHWHeater[1]:InputRating				= {	DHWInputRating  }
;;	"Set new DUT DHWHeater:InputRatingUnits"		DwellUnitType:DHWSysRef[1]:DHWHeater[1]:InputRatingUnits			= {	DHWInputRatingUnits  }
;	"Set new DUT DHWHeater:EnergyFactor"			DwellUnitType:DHWSysRef[1]:DHWHeater[1]:EnergyFactor				= {	DHWEnergyFactor  }
	"Set new DUT DHWHeater:TankVolume"				DwellUnitType:DHWSysRef[1]:DHWHeater[1]:TankVolume					= {	DHWTankVolume  }
	"Set new DUT DHWHeater:IntInsulRVal"			DwellUnitType:DHWSysRef[1]:DHWHeater[1]:IntInsulRVal				= {	DHWIntInsulRVal  }
	"Set new DUT DHWHeater:ExtInsulRVal"			DwellUnitType:DHWSysRef[1]:DHWHeater[1]:ExtInsulRVal				= {	DHWExtInsulRVal  }
	"Set new DUT DHWHeater:AmbientCond"				DwellUnitType:DHWSysRef[1]:DHWHeater[1]:AmbientCond				= {	DHWAmbientCond  }
;	"Set new DUT DHWHeater:StandbyLossFrac"		DwellUnitType:DHWSysRef[1]:DHWHeater[1]:StandbyLossFrac			= {	DHWStandbyLossFrac  }
END
;*************************************************************************
RULELIST "OneTimeAnalysisPrep_CreateDwellUnitDHW_Normal" 1 0 1 0
	"Set new DUT DHWHeater:HeaterElementType"		DwellUnitType:DHWSysRef[1]:DHWHeater[1]:HeaterElementType		= {	DHWHeaterElementType  }
	"Set new DUT DHWHeater:TankType"					DwellUnitType:DHWSysRef[1]:DHWHeater[1]:TankType					= {	DHWTankType  }
	"Set new DUT DHWHeater:InputRating"				DwellUnitType:DHWSysRef[1]:DHWHeater[1]:InputRating				= {	DHWInputRating  }
;	"Set new DUT DHWHeater:InputRatingUnits"		DwellUnitType:DHWSysRef[1]:DHWHeater[1]:InputRatingUnits			= {	DHWInputRatingUnits  }
	"Set new DUT DHWHeater:EnergyFactor"			DwellUnitType:DHWSysRef[1]:DHWHeater[1]:EnergyFactor				= {	DHWEnergyFactor  }
	"Set new DUT DHWHeater:TankVolume"				DwellUnitType:DHWSysRef[1]:DHWHeater[1]:TankVolume					= {	DHWTankVolume  }
	"Set new DUT DHWHeater:IntInsulRVal"			DwellUnitType:DHWSysRef[1]:DHWHeater[1]:IntInsulRVal				= {	DHWIntInsulRVal  }
	"Set new DUT DHWHeater:ExtInsulRVal"			DwellUnitType:DHWSysRef[1]:DHWHeater[1]:ExtInsulRVal				= {	DHWExtInsulRVal  }
	"Set new DUT DHWHeater:AmbientCond"				DwellUnitType:DHWSysRef[1]:DHWHeater[1]:AmbientCond				= {	DHWAmbientCond  }
	"Set new DUT DHWHeater:StandbyLossFrac"		DwellUnitType:DHWSysRef[1]:DHWHeater[1]:StandbyLossFrac			= {	DHWStandbyLossFrac  }
		;	0,  "DHWHeater",  "Water Heater",  "Water Heater <i>",      0,  0,  0, "",        "", "", "", "", "", "", "", "", "", "", "", "", "", "",  -1,  1,  0,  0,  0,  0,   8000
		;	1,           "Status",             BEMP_Sym,  1,  0,  0, "",             0,  0,                        3008, "Status"                                      
		;	1,           "EfficiencyUnits",    BEMP_Str,  1,  0,  0, "",             0,  0,                        1003, "DHW heater energy factor or efficiency units"   
		;	1,           "AltEnergyFactor",    BEMP_Flt,  1,  0,  0, "",             0,  0,                        1003, "Altered reqs. for DHW system energy factor or efficiency"   
END

;*************************************************************************
RULELIST "SetupHVACSysDWHeater_GSHP" 1 0 1 1
;*************************************************************************
;	"Set HVACSys:DHWHeaterElementType"		HVACSys:DHWHeaterElementType	= {      0  }			; Electric Resistance
;	"Set HVACSys:DHWEnergyFactor"				HVACSys:DHWEnergyFactor			= {  0.97	}			; "Small Storage" 
; SAC 4/24/15 - revised GSHP DHW inputs to reflect performance based on HPWH inputs supplied in GC 514 issue
	"Set HVACSys:DHWHeaterElementType"		HVACSys:DHWHeaterElementType	= {      3  }			; Air-Source Heat Pump
	"Set HVACSys:DHWEnergyFactor"				HVACSys:DHWEnergyFactor			= {	if (Proj:Fuel_HaveNatGas > 0.5) then  2.8  else  1.85  endif	}		; EF 		; SAC 11/10/15

;	"Set HVACSys:DHWEfficiencyUnits"			HVACSys:DHWEfficiencyUnits		= {   "EF"  }			; "Small Storage" 
	"Set HVACSys:DHWInputRating"				HVACSys:DHWInputRating			= {	8000  }			; (watts)
	"Set HVACSys:DHWInputRatingUnits"		HVACSys:DHWInputRatingUnits	= {  "watts"  }
	"Set HVACSys:DHWTankType"					HVACSys:DHWTankType				= {  "Small Storage"  }		; %WHTYPE_SSTOR = 6
	"Set HVACSys:DHWTankVolume"				HVACSys:DHWTankVolume			= {	  50  }			; "Small Storage" 
	"Set HVACSys:DHWIntInsulRVal"				HVACSys:DHWIntInsulRVal			= {	   0  }
	"Set HVACSys:DHWExtInsulRVal"				HVACSys:DHWExtInsulRVal			= {	   0  }
	"Set HVACSys:DHWStandbyLossFrac"			HVACSys:DHWStandbyLossFrac		= {	   0  }
END
;*************************************************************************

;*************************************************************************
RULELIST "SetupDefaultClVentFan" 1 0 1 1
   "Set ClVentFan:DefaultSystem"			ClVentFan:DefaultSystem		= {	1     }
   ; SAC 2/12/18 - replaced 'hard-coded' 0.1 W/CFM default WHF power value w/ look-up table entry to accommodate 2019 update (tic #977)
   ;"Set ClVentFan:WperCFMCool"			ClVentFan:WperCFMCool		= {	0.10  }
   "Set ClVentFan:WperCFMCool"			ClVentFan:WperCFMCool		= {	T24RClimateZoneCodeBase:WHFWperCFM( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  }
   "Set ClVentFan:CoolingVent"			ClVentFan:CoolingVent		= {	Proj:UnitClVentCFMTot  }
   "Set ClVentFan:NumAssignments"		ClVentFan:NumAssignments	= {	1  }
   "Set ClVentFan:AssignedArea"		   ClVentFan:AssignedArea	   = {	ValidOr( Proj:CondFloorArea, 0 )  }    ; SAC 5/1/19
END
;*************************************************************************
RULELIST "SetupCFIHVACSysClVentFan" 1 0 1 1
   "Set ClVentFan:DefaultSystem"			ClVentFan:DefaultSystem		= {	0  }
   "Set ClVentFan:NumAssignments"		ClVentFan:NumAssignments	= {	1  }
END
;*************************************************************************
RULELIST "SetupCFIHVACSysClVentFan_UserInputs" 1 0 1 1
	"Specify HVACSys:CFIClVentFan:CoolingVent"	HVACSys:CFIClVentFan:CoolingVent	= {	if (Proj:EnableClVent > 0.5 .AND. Proj:UnitClVentOption == 3 .AND.
																															(Type == 3 .OR. ((Type == 1 .OR. Type == 2) .AND. CFIClVentOption > 0.5)))
																													then  CFIClVentFlow  else  UNCHANGED  endif  }
	"Specify HVACSys:CFIClVentFan:WperCFMCool"	HVACSys:CFIClVentFan:WperCFMCool	= {	if (Proj:EnableClVent > 0.5 .AND. Proj:UnitClVentOption == 3 .AND.
																															(Type == 3 .OR. ((Type == 1 .OR. Type == 2) .AND. CFIClVentOption > 0.5)))
																													then  CFIClVentPwr  else  UNCHANGED  endif  }
END
;*************************************************************************

;*************************************************************************
RULELIST "SetupDefaultIAQFan_1" 1 0 1 1
   "Set #1 IAQFan:IAQCFM"			IAQFan:IAQCFM		= {	Proj:UnitMinIAQCFM[1]  }
   "Set #1 IAQFan:*"					IAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_2" 1 0 1 1
   "Set #2 IAQFan:IAQCFM"			IAQFan:IAQCFM		= {	Proj:UnitMinIAQCFM[2]  }
   "Set #2 IAQFan:*"					IAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_3" 1 0 1 1
   "Set #3 IAQFan:IAQCFM"			IAQFan:IAQCFM		= {	Proj:UnitMinIAQCFM[3]  }
   "Set #3 IAQFan:*"					IAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_4" 1 0 1 1
   "Set #4 IAQFan:IAQCFM"			IAQFan:IAQCFM		= {	Proj:UnitMinIAQCFM[4]  }
   "Set #4 IAQFan:*"					IAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_5" 1 0 1 1
   "Set #5 IAQFan:IAQCFM"			IAQFan:IAQCFM		= {	Proj:UnitMinIAQCFM[5]  }
   "Set #5 IAQFan:*"					IAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_6" 1 0 1 1
   "Set #6 IAQFan:IAQCFM"			IAQFan:IAQCFM		= {	Proj:UnitMinIAQCFM[6]  }
   "Set #6 IAQFan:*"					IAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_7" 1 0 1 1
   "Set #7 IAQFan:IAQCFM"			IAQFan:IAQCFM		= {	Proj:UnitMinIAQCFM[7]  }
   "Set #7 IAQFan:*"					IAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_8" 1 0 1 1
   "Set #8 IAQFan:IAQCFM"			IAQFan:IAQCFM		= {	Proj:UnitMinIAQCFM[8]  }
   "Set #8 IAQFan:*"					IAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_9" 1 0 1 1
   "Set #9 IAQFan:IAQCFM"			IAQFan:IAQCFM		= {	Proj:UnitMinIAQCFM[9]  }
   "Set #9 IAQFan:*"					IAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_10" 1 0 1 1
   "Set #10 IAQFan:IAQCFM"			IAQFan:IAQCFM		= {	Proj:UnitMinIAQCFM[10]  }
   "Set #10 IAQFan:*"				IAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_11" 1 0 1 1
   "Set #11 IAQFan:IAQCFM"			IAQFan:IAQCFM		= {	Proj:UnitMinIAQCFM[11]  }
   "Set #11 IAQFan:*"				IAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_12" 1 0 1 1
   "Set #12 IAQFan:IAQCFM"			IAQFan:IAQCFM		= {	Proj:UnitMinIAQCFM[12]  }
   "Set #12 IAQFan:*"				IAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_13" 1 0 1 1
   "Set #13 IAQFan:IAQCFM"			IAQFan:IAQCFM		= {	Proj:UnitMinIAQCFM[13]  }
   "Set #13 IAQFan:*"				IAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_14" 1 0 1 1
   "Set #14 IAQFan:IAQCFM"			IAQFan:IAQCFM		= {	Proj:UnitMinIAQCFM[14]  }
   "Set #14 IAQFan:*"				IAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_15" 1 0 1 1
   "Set #15 IAQFan:IAQCFM"			IAQFan:IAQCFM		= {	Proj:UnitMinIAQCFM[15]  }
   "Set #15 IAQFan:*"				IAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_16" 1 0 1 1
   "Set #16 IAQFan:IAQCFM"			IAQFan:IAQCFM		= {	Proj:UnitMinIAQCFM[16]  }
   "Set #16 IAQFan:*"				IAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_ALL" 1 0 1 1
   ; revised 2019.2.0+ IAQFan:WperCFMIAQ to be based on other vs. balanced rather than SFam vs. MFam - SAC 7/20/20 (tic #1174)
   ; SAC 2/12/20 - installed new std design IAQFan:WperCFMIAQ of 0.3 & 0.6 for SFam/MFam as new defaults (tic #1174)
   "Set SFam IAQFan:WperCFMIAQ"			IAQFan:WperCFMIAQ     =       ; revised DefaultIAQFanPwr unbal 0.3->0.35 - SAC 01/19/21 (tic #1243) 
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 ))
		   then  0.35
		   else  0.25     ; Stand Alone IAQ Fan (prior to 2019.2.0)
		   endif  }
   "Set SFam IAQFan:IAQFanType"			IAQFan:IAQFanType     = {  1  }    ; "Exhaust"
   "Set SFam IAQFan:IAQRecovEffect"		IAQFan:IAQRecovEffect = {  0  }    ; No Heat Recovery ...MJB 4/22/13	
   "Set SFam IAQFan:IncludesRecov"     IAQFan:IncludesRecov  = {  0  }    ; SAC 2/5/20 (tic #1174)
   "Set SFam IAQFan:IAQFanTypeStr"		IAQFan:IAQFanTypeStr  = {  EnumString( IAQFanType )  }
   "Set SFam IAQFan:NumAssignments"		IAQFan:NumAssignments = {	1  }
   "Default IAQFan:HERSVerified"       IAQFan:HERSVerified     = {  0  }   ; SAC 7/21/20 (tic #1174)
   "Set IAQFan:FanPowerMult"           IAQFan:FanPowerMult     = {  1  }   ; not used for SFam
   "Set IAQFan:FanHeatRecovMult"       IAQFan:FanHeatRecovMult = {  1  }   ; not used for SFam
END
;*************************************************************************


; SAC 12/5/13 - replaced individual equipment-based HVACHeat budget conversion mechanism w/ following that sets data directly to the HVACSys object(s)
;*************************************************************************
RULELIST "Setup_HVACSys_Heat_CntrlFurnace" 1 0 1 0
	"Set HVACSys:AutoSizeHeat[1]"		HVACSys:AutoSizeHeat[1]		= {	1  }
   "Set HVACSys:HtSysSizingFactor"	HVACSys:HtSysSizingFactor	= {	2  }   ; BAW changed from 1.5 to 2 130508
	"Set HVACSys:HtSysCapacity"		HVACSys:HtSysCapacity		= {	UNDEFINED  }
; SAC 12/26/14 - replaced logic triggering use of existing/verified properties to reflect OVERALL heating equipment beter/equal/worse status (rather than only a comparison of AFUE or HSPF)
	"Set HVACSys:HtSysAFUE"				HVACSys:HtSysAFUE				= {	if (Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																									HeatEqpVsStandard >= 0 .AND.		; => equal or better than standard
																									MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingAFUE ) > 10)
																							then	MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingAFUE )
																							else	
																								if (Proj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																								else
																									T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdHeatingType ) )  
																								endif  endif }
; "DBG msg" HVACSys:Action = { MessageBox( "Setup_HVACSys_Heat_CntrlFurnace -> HVACSys:HtSysAFUE = %g  (status = %g)", HtSysAFUE, LocalStatus( HtSysAFUE ) ) }
END
;*************************************************************************
RULELIST "Setup_HVACSys_Heat_WallFurnaceFan"       1 0 1 0
	"Set HVACSys:AutoSizeHeat[1]"		HVACSys:AutoSizeHeat[1]		= {	1  }
  "Set HVACSys:HtSysSizingFactor"	HVACSys:HtSysSizingFactor	= {	2  }   ; BAW changed from 1.5 to 2 130508
	"Set HVACSys:HtSysCapacity"		HVACSys:HtSysCapacity		= {	UNDEFINED  }
; SAC 12/26/14 - replaced logic triggering use of existing/verified properties to reflect OVERALL heating equipment beter/equal/worse status (rather than only a comparison of AFUE or HSPF)
	"Set HVACSys:HtSysAFUE"				HVACSys:HtSysAFUE				= {	if (Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																									HeatEqpVsStandard >= 0 .AND.		; => equal or better than standard
																									MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingAFUE ) > 10)
																							then	MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingAFUE )
																							else	
																								if (Proj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																								else
																									T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdHeatingType ) )  
																								endif  endif }
END
;*************************************************************************
RULELIST "Setup_HVACSys_Heat_Boiler"       1 0 1 0
	"Set HVACSys:AutoSizeHeat[1]"		  HVACSys:AutoSizeHeat[1]		= {	1  }
  "Set HVACSys:HtSysSizingFactor" 	HVACSys:HtSysSizingFactor	= {	2  }   ; BAW changed from 1.5 to 2 130508
	"Set HVACSys:HtSysCapacity"		    HVACSys:HtSysCapacity		= {	UNDEFINED  }
	"Set HVACSys:HtSysAFUE"				    HVACSys:HtSysAFUE				= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "Setup_HVACSys_Heat_WoodHeat"       1 0 1 0
	"Set HVACSys:AutoSizeHeat[1]"		  HVACSys:AutoSizeHeat[1]		= {	1  }
  "Set HVACSys:HtSysSizingFactor"   HVACSys:HtSysSizingFactor	= {	2  }   
	"Set HVACSys:HtSysCapacity"		    HVACSys:HtSysCapacity		= {	UNDEFINED  }
	"Set HVACSys:HtSysAFUE"				    HVACSys:HtSysAFUE				= {	78  } ; See tic 632, wood heat 
END
;*************************************************************************
RULELIST "Setup_HVACSys_Heat_WallFurnaceGravity"       1 0 1 0
	"Set HVACSys:AutoSizeHeat[1]"		HVACSys:AutoSizeHeat[1]		= {	1  }
  "Set HVACSys:HtSysSizingFactor"	HVACSys:HtSysSizingFactor	= {	2  }   ; BAW changed from 1.5 to 2 130508
	"Set HVACSys:HtSysCapacity"		HVACSys:HtSysCapacity		= {	UNDEFINED  }
; SAC 12/26/14 - replaced logic triggering use of existing/verified properties to reflect OVERALL heating equipment beter/equal/worse status (rather than only a comparison of AFUE or HSPF)
	"Set HVACSys:HtSysAFUE"				HVACSys:HtSysAFUE				= {	if (Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																									HeatEqpVsStandard >= 0 .AND.		; => equal or better than standard
																									MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingAFUE ) > 10)
																							then	MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingAFUE )
																							else	
																								if (Proj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																								else
																									T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdHeatingType ) )  
																								endif  endif }
END
;*************************************************************************
RULELIST "Setup_HVACSys_Heat_FloorFurnace"       1 0 1 0
	"Set HVACSys:AutoSizeHeat[1]"		HVACSys:AutoSizeHeat[1]		= {	1  }
  "Set HVACSys:HtSysSizingFactor"	HVACSys:HtSysSizingFactor	= {	2  }   ; BAW changed from 1.5 to 2 130508
	"Set HVACSys:HtSysCapacity"		HVACSys:HtSysCapacity		= {	UNDEFINED  }
; SAC 12/26/14 - replaced logic triggering use of existing/verified properties to reflect OVERALL heating equipment beter/equal/worse status (rather than only a comparison of AFUE or HSPF)
	"Set HVACSys:HtSysAFUE"				HVACSys:HtSysAFUE				= {	if (Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																									HeatEqpVsStandard >= 0 .AND.		; => equal or better than standard
																									MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingAFUE ) > 10)
																							then	MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingAFUE )
																							else	
																								if (Proj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																								else
																									T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdHeatingType ) )  
																								endif  endif }
END
;*************************************************************************
RULELIST "Setup_HVACSys_Heat_RoomHeater"       1 0 1 0
	"Set HVACSys:AutoSizeHeat[1]"		HVACSys:AutoSizeHeat[1]		= {	1  }
  "Set HVACSys:HtSysSizingFactor"	HVACSys:HtSysSizingFactor	= {	2  }   ; BAW changed from 1.5 to 2 130508
	"Set HVACSys:HtSysCapacity"		HVACSys:HtSysCapacity		= {	UNDEFINED  }
; SAC 12/26/14 - replaced logic triggering use of existing/verified properties to reflect OVERALL heating equipment beter/equal/worse status (rather than only a comparison of AFUE or HSPF)
	"Set HVACSys:HtSysAFUE"				HVACSys:HtSysAFUE				= {	if (Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																									HeatEqpVsStandard >= 0 .AND.		; => equal or better than standard
																									MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingAFUE ) > 10)
																							then	MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingAFUE )
																							else	
																								if (Proj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																								else
																									T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdHeatingType ) )  
																								endif  endif }
END
;*************************************************************************
RULELIST "Setup_HVACSys_Heat_Electric"     1 0 1 0
	"Set HVACSys:AutoSizeHeat[1]"		HVACSys:AutoSizeHeat[1]		= {	1  }
  "Set HVACSys:HtSysSizingFactor"	HVACSys:HtSysSizingFactor	= {	2  }   ; BAW changed from 1.5 to 2 130508
	"Set HVACSys:HtSysCapacity"		HVACSys:HtSysCapacity		= {	UNDEFINED  }
	"Set HVACSys:HtSysAFUE"				HVACSys:HtSysAFUE				= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "Setup_HVACSys_Heat_CombHydro"    1 0 1 0
	"Set HVACSys:AutoSizeHeat[1]"		HVACSys:AutoSizeHeat[1]		= {	1  }
  "Set HVACSys:HtSysSizingFactor"	HVACSys:HtSysSizingFactor	= {	2  }   ; BAW changed from 1.5 to 2 130508
	"Set HVACSys:HtSysCapacity"		HVACSys:HtSysCapacity		= {	UNDEFINED  }
; SAC 12/26/14 - replaced logic triggering use of existing/verified properties to reflect OVERALL heating equipment beter/equal/worse status (rather than only a comparison of AFUE or HSPF)
	"Set HVACSys:HtSysAFUE"				HVACSys:HtSysAFUE				= {	if (Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																									HeatEqpVsStandard >= 0 .AND.		; => equal or better than standard
																									MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingAFUE ) > 10)
																							then	MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingAFUE )
																							else	
																								if (Proj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																								else
																									T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdHeatingType ) )  
																								endif endif  }
END
;*************************************************************************

;*************************************************************************
RULELIST "Setup_HVACHeat_CntrlFurnace" 1 0 1 0
  "Set HVACHeat:Type to CntrlFurnace" 	HVACHeat:Type	= {	1  }	; "CntrlFurnace"
	"Call subordinate rulelist to default generic heating system data"			HVACHeat:Action = {	EvalRulelist( "Default_HVACHeat", 1 )  }
  "Call subordinate rulelist to default type-specific heating system data"	HVACHeat:Action = {	EvalRulelist( "Default_Heat_CntrlFurnace"  , 1 )  }
END
;*************************************************************************
RULELIST "Setup_HVACHeat_WallFurnaceFan"       1 0 1 0
  "Set HVACHeat:Type to WallFurnaceFan"       	HVACHeat:Type	= {	2  }	; "WallFurnaceFan"
	"Call subordinate rulelist to default generic heating system data"	      HVACHeat:Action = {	EvalRulelist( "Default_HVACHeat", 1 )  }
  "Call subordinate rulelist to default type-specific heating system data"	HVACHeat:Action = {	EvalRulelist( "Default_Heat_WallFurnaceFan"        , 1 )  }
END
;*************************************************************************
RULELIST "Setup_HVACHeat_Boiler"       1 0 1 0
  "Set HVACHeat:Type to Boiler"       	HVACHeat:Type	= {	3  }	; "Boiler"
	"Call subordinate rulelist to default generic heating system data"	      HVACHeat:Action = {	EvalRulelist( "Default_HVACHeat", 1 )  }
  "Call subordinate rulelist to default type-specific heating system data"	HVACHeat:Action = {	EvalRulelist( "Default_Heat_Boiler"        , 1 )  }
END
;*************************************************************************
RULELIST "Setup_HVACHeat_WallFurnaceGravity"       1 0 1 0
   "Set HVACHeat:Type to Heater"       	HVACHeat:Type	= {	14  }	; "WallFurnaceGravity"		- SAC 11/25/14 - value 4->14
	"Call subordinate rulelist to default generic heating system data"	      HVACHeat:Action = {	EvalRulelist( "Default_HVACHeat", 1 )  }
   "Call subordinate rulelist to default type-specific heating system data"	HVACHeat:Action = {	EvalRulelist( "Default_Heat_WallFurnaceGravity"        , 1 )  }
END
;*************************************************************************
RULELIST "Setup_HVACHeat_FloorFurnace"       1 0 1 0
   "Set HVACHeat:Type to Heater"       	HVACHeat:Type	= {	15  }	; "FloorFurnace"		- SAC 11/25/14 - value 5->15
	"Call subordinate rulelist to default generic heating system data"	      HVACHeat:Action = {	EvalRulelist( "Default_HVACHeat", 1 )  }
   "Call subordinate rulelist to default type-specific heating system data"	HVACHeat:Action = {	EvalRulelist( "Default_Heat_FloorFurnace"        , 1 )  }
END
;*************************************************************************
RULELIST "Setup_HVACHeat_RoomHeater"       1 0 1 0
   "Set HVACHeat:Type to Heater"       	HVACHeat:Type	= {	16  }	; "RoomHeater"			- SAC 11/25/14 - value 6->16
	"Call subordinate rulelist to default generic heating system data"	      HVACHeat:Action = {	EvalRulelist( "Default_HVACHeat", 1 )  }
   "Call subordinate rulelist to default type-specific heating system data"	HVACHeat:Action = {	EvalRulelist( "Default_Heat_RoomHeater"        , 1 )  }
END
;*************************************************************************
RULELIST "Setup_HVACHeat_Electric"     1 0 1 0
   "Set HVACHeat:Type to Electric"     	HVACHeat:Type	= {	8  }	; "Electric"
	"Call subordinate rulelist to default generic heating system data"	      HVACHeat:Action = {	EvalRulelist( "Default_HVACHeat", 1 )  }
   "Call subordinate rulelist to default type-specific heating system data"	HVACHeat:Action = {	EvalRulelist( "Default_Heat_Electric"      , 1 )  }
END
;*************************************************************************
RULELIST "Setup_HVACHeat_CombHydro"    1 0 1 0
   "Set HVACHeat:Type to CombHydro"    	HVACHeat:Type	= {	9  }	; "CombHydro"
	"Call subordinate rulelist to default generic heating system data"	      HVACHeat:Action = {	EvalRulelist( "Default_HVACHeat", 1 )  }
   "Call subordinate rulelist to default type-specific heating system data"	HVACHeat:Action = {	EvalRulelist( "Default_Heat_CombHydro"     , 1 )  }
END
;*************************************************************************


; SAC 1/13/14 - sdded rulelsit to facilitate change of overall HVACSys:Type from Other to HtPump (for GC #265)
;*************************************************************************
RULELIST "SwitchSystemToHeatPump"		1 0 1 1   ; prevent Resets so that HtPumpSystem assignment(s) do not get blown away

	"Set HVACSys:Type"		HVACSys:Type	= {	2  }	; "Heat Pump Heating and Cooling System"
; MANUALLY RESET certain HVACSys properties based on change of HVACSys:Type to Heat Pump
	"Blast HVACSys:CFIClVentOption     "		HVACSys:CFIClVentOption     	= {	UNDEFINED  }
	"Blast HVACSys:CFIClVentFan        "		HVACSys:CFIClVentFan        	= {	UNDEFINED  }
	"Blast HVACSys:AutoSizeHeatInp     "		HVACSys:AutoSizeHeatInp     	= {	UNDEFINED  }
	"Blast HVACSys:HeatSysTypeSetup    "		HVACSys:HeatSysTypeSetup    	= {	UNDEFINED  }
	"Blast HVACSys:ConstHtgSetpt       "		HVACSys:ConstHtgSetpt       	= {	UNDEFINED  }
	"Blast HVACSys:AutoSizeCoolInp     "		HVACSys:AutoSizeCoolInp     	= {	UNDEFINED  }
	"Blast HVACSys:CoolSysTypeSetup    "		HVACSys:CoolSysTypeSetup    	= {	UNDEFINED  }
	"Blast HVACSys:ConstClgSetpt       "		HVACSys:ConstClgSetpt       	= {	UNDEFINED  }
	"Blast HVACSys:HeatSystem[1]       "		HVACSys:HeatSystem[1]       	= {	UNDEFINED  }
	"Blast HVACSys:HeatSystem[2]       "		HVACSys:HeatSystem[2]       	= {	UNDEFINED  }
	"Blast HVACSys:HeatSystem[3]       "		HVACSys:HeatSystem[3]       	= {	UNDEFINED  }
	"Blast HVACSys:HeatSystem[4]       "		HVACSys:HeatSystem[4]       	= {	UNDEFINED  }
	"Blast HVACSys:HeatSystem[5]       "		HVACSys:HeatSystem[5]       	= {	UNDEFINED  }
	"Blast HVACSys:HeatSystem[6]       "		HVACSys:HeatSystem[6]       	= {	UNDEFINED  }
	"Blast HVACSys:HeatSystem[7]       "		HVACSys:HeatSystem[7]       	= {	UNDEFINED  }
	"Blast HVACSys:HeatSystem[8]       "		HVACSys:HeatSystem[8]       	= {	UNDEFINED  }
	"Blast HVACSys:HeatSystem[9]       "		HVACSys:HeatSystem[9]       	= {	UNDEFINED  }
	"Blast HVACSys:HeatSystem[10]      "		HVACSys:HeatSystem[10]      	= {	UNDEFINED  }
	"Blast HVACSys:CoolSystem[1]       "		HVACSys:CoolSystem[1]       	= {	UNDEFINED  }
	"Blast HVACSys:CoolSystem[2]       "		HVACSys:CoolSystem[2]       	= {	UNDEFINED  }
	"Blast HVACSys:CoolSystem[3]       "		HVACSys:CoolSystem[3]       	= {	UNDEFINED  }
	"Blast HVACSys:CoolSystem[4]       "		HVACSys:CoolSystem[4]       	= {	UNDEFINED  }
	"Blast HVACSys:CoolSystem[5]       "		HVACSys:CoolSystem[5]       	= {	UNDEFINED  }
	"Blast HVACSys:CoolSystem[6]       "		HVACSys:CoolSystem[6]       	= {	UNDEFINED  }
	"Blast HVACSys:CoolSystem[7]       "		HVACSys:CoolSystem[7]       	= {	UNDEFINED  }
	"Blast HVACSys:CoolSystem[8]       "		HVACSys:CoolSystem[8]       	= {	UNDEFINED  }
	"Blast HVACSys:CoolSystem[9]       "		HVACSys:CoolSystem[9]       	= {	UNDEFINED  }
	"Blast HVACSys:CoolSystem[10]      "		HVACSys:CoolSystem[10]      	= {	UNDEFINED  }
	"Blast HVACSys:HeatDucted          "		HVACSys:HeatDucted         	= {	UNDEFINED  }
	"Blast HVACSys:CoolDucted          "		HVACSys:CoolDucted         	= {	UNDEFINED  }
	"Blast HVACSys:HtPumpDucted        "		HVACSys:HtPumpDucted       	= {	UNDEFINED  }
	"Blast HVACSys:NumHeatSystemTypes  "		HVACSys:NumHeatSystemTypes  	= {	UNDEFINED  }
	"Blast HVACSys:NumHtPumpSystemTypes"		HVACSys:NumHtPumpSystemTypes	= {	UNDEFINED  }
	"Blast HVACSys:NumCoolSystemTypes  "		HVACSys:NumCoolSystemTypes  	= {	UNDEFINED  }
	; NOT defaulted above:
   ;	 HVACSys:HtPumpSystem[ALL]

	"Default HVACSys:NumHtPumpSystemTypes"	HVACSys:NumHtPumpSystemTypes	= {	if (IfValidAnd( Type == 2 )==0) then  0		; Type invalid or NOT = 2
																										else if (LocalCompAssigned( HtPumpSystem[10] )) then  10
																										else if (LocalCompAssigned( HtPumpSystem[9]  )) then   9
																										else if (LocalCompAssigned( HtPumpSystem[8]  )) then   8
																										else if (LocalCompAssigned( HtPumpSystem[7]  )) then   7
																										else if (LocalCompAssigned( HtPumpSystem[6]  )) then   6
																										else if (LocalCompAssigned( HtPumpSystem[5]  )) then   5
																										else if (LocalCompAssigned( HtPumpSystem[4]  )) then   4
																										else if (LocalCompAssigned( HtPumpSystem[3]  )) then   3
																										else if (LocalCompAssigned( HtPumpSystem[2]  )) then   2  else  1  endif endif endif endif endif endif endif endif endif endif  }

	"Initialize HVACSys HtPump properties"		HVACSys:Action		= {	EvalRulelist( "SetupHVACSys_Round1_HeatPump", 1 )  }
	"Call subordinate rulelist to default generic heat pump system data"
		HVACHtPump:Action = {	EvalRulelist( "Default_HVACHeatPump", 1 )  }
	"Call subordinate rulelist to default type-specific heat pump system data"
		HVACHtPump:Action = {	switch (Local( Type ))
											case  4 :  EvalRulelist( "Default_HtPump_SplitHeatPump"   , 1 )   ; "SplitHeatPump - Heating side of central split heat pump"
											case 10 :  EvalRulelist( "Default_HtPump_DuctlessMiniSplitHeatPump", 1 )   ; "DuctlessHeatPump - Heating side of ductless mini-split heat pump"
											case  5 :  EvalRulelist( "Default_HtPump_PkgHeatPump"     , 1 )   ; "PkgHeatPump - Heating side of central packaged heat pump"
											case  6 :  EvalRulelist( "Default_HtPump_LrgPkgHeatPump"  , 1 )   ; "LrgPkgHeatPump - Heating side of large (>= 65 kBtuh) packaged unit"
											case  7 :  EvalRulelist( "Default_HtPump_RoomHeatPump"    , 1 )   ; "RoomHeatPump - Heating side of non-central room A/C system"
											default :  EvalRulelist( "Default_HtPump_unknown", 1 )
										endswitch  }
	"Round2 of HVACSys HtPump property init"		HVACSys:Action		= {	EvalRulelist( "SetupHVACSys_Round2_HeatPump", 1 )  }
END

; SAC 12/5/13 - replaced individual equipment-based HVACHtPump budget conversion mechanism (above) w/ following that sets data directly to the HVACSys object(s)
;*************************************************************************
RULELIST "Setup_HVACSys_HtPump_SplitHeatPump"       1 0 1 0
; SAC 1/13/14 - added rule to switch system type to HtPump (if it isn't already set)
	"Ensure HVACSys:Type set to HtPump"		HVACSys:Action	= {	if (Type != 2 && LocalCompAssigned( HtPumpSystem[1] ) > 0)
																					then  EvalRulelist( "SwitchSystemToHeatPump", 1 )  else  UNCHANGED  endif  }

; mjb	12/9/13 - added logic for E+A+A
   "Set HVACSys:ClSysSizingFactor"			HVACSys:ClSysSizingFactor		= {	1.2  }      ; SAC 02/25/22

; SAC 12/26/14 - replaced logic triggering use of existing/verified properties to reflect OVERALL heating equipment beter/equal/worse status (rather than only a comparison of AFUE or HSPF)
	"Set HVACSys:HPSysHSPF"						HVACSys:HPSysHSPF			= {	if (Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																										HeatEqpVsStandard >= 0 .AND.		; => equal or better than standard
																										MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingHSPF	 ) > 5)	; SAC 12/23/14 - updated limit from 10 to 5 per mjb advice
																								then	MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingHSPF	 )
																								else	
																									if (Proj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																									else
																										T24RHeatingEquipment:HSPF	( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdHeatingType ) )  
																									endif endif  }
																									
   "Set HVACSys:HPSysAutoSize"            HVACSys:HPSysAutoSize         = {  0  }
   "Set HVACSys:HPSysCap47"					HVACSys:HPSysCap47				= {	0  }  ; UNDEFINED  }
   "Set HVACSys:HPSysMinCap47"				HVACSys:HPSysMinCap47			= {	0  }     ; SAC 03/11/21
   "Set HVACSys:HPSysCap35"					HVACSys:HPSysCap35				= {	0  }  ; UNDEFINED  }
   "Set HVACSys:HPSysCap17"					HVACSys:HPSysCap17				= {	0  }  ; UNDEFINED  }
   "Set HVACSys:HPSysCOP47"					HVACSys:HPSysCOP47				= {	0  }  ; UNDEFINED  }
   "Set HVACSys:HPSysCOP35"					HVACSys:HPSysCOP35				= {	0  }  ; UNDEFINED  }
   "Set HVACSys:HPSysCOP17"					HVACSys:HPSysCOP17				= {	0  }  ; UNDEFINED  }
   "Set HVACSys:HPSysAuxHtgCap"				HVACSys:HPSysAuxHtgCap			= {	0  }  ; if (LocalStatus( HPSysCap47 ) < 2) then  UNDEFINED  else  (HPSysCap47 * 10)  endif  }
   "Set HVACSys:HPModelDualFuel"			   HVACSys:HPModelDualFuel		   = {	0  }     ; SAC 12/08/20
;	"debug Setup Split HP"	HVACSys:Action	=	{ if (FloorAreaServed > 0.5) then PostWarning( "Setup_HVACSys_HtPump_SplitHeatPump -> HVACSys:HPSysHSPF = %g", HPSysHSPF ) else UNCHANGED endif }
END
; SAC 1/7/16 - added SDHVSplitHeatPump (small duct, high velocity) heating type (tic 598)
;*************************************************************************
RULELIST "Setup_HVACSys_HtPump_SDHVSplitHeatPump"       1 0 1 0
	"Ensure HVACSys:Type set to HtPump"		HVACSys:Action	= {	if (Type != 2 && LocalCompAssigned( HtPumpSystem[1] ) > 0)
																					then  EvalRulelist( "SwitchSystemToHeatPump", 1 )  else  UNCHANGED  endif  }

   "Set HVACSys:ClSysSizingFactor"			HVACSys:ClSysSizingFactor		= {	1.2  }      ; SAC 02/25/22

	"Set HVACSys:HPSysHSPF"						HVACSys:HPSysHSPF			= {	if (Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																										HeatEqpVsStandard >= 0 .AND.		; => equal or better than standard
																										MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingHSPF	 ) > 5)	; SAC 12/23/14 - updated limit from 10 to 5 per mjb advice
																								then	MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingHSPF	 )
																								else	
																									if (Proj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																									else
																										T24RHeatingEquipment:HSPF	( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdHeatingType ) )  
																									endif endif  }
																									
   "Set HVACSys:HPSysAutoSize"            HVACSys:HPSysAutoSize         = {  0  }
   "Set HVACSys:HPSysCap47"					HVACSys:HPSysCap47				= {	0  }  ; UNDEFINED  }
   "Set HVACSys:HPSysMinCap47"				HVACSys:HPSysMinCap47			= {	0  }     ; SAC 03/11/21
   "Set HVACSys:HPSysCap35"					HVACSys:HPSysCap35				= {	0  }  ; UNDEFINED  }
   "Set HVACSys:HPSysCap17"					HVACSys:HPSysCap17				= {	0  }  ; UNDEFINED  }
   "Set HVACSys:HPSysCOP47"					HVACSys:HPSysCOP47				= {	0  }  ; UNDEFINED  }
   "Set HVACSys:HPSysCOP35"					HVACSys:HPSysCOP35				= {	0  }  ; UNDEFINED  }
   "Set HVACSys:HPSysCOP17"					HVACSys:HPSysCOP17				= {	0  }  ; UNDEFINED  }
   "Set HVACSys:HPSysAuxHtgCap"				HVACSys:HPSysAuxHtgCap			= {	0  }  ; if (LocalStatus( HPSysCap47 ) < 2) then  UNDEFINED  else  (HPSysCap47 * 10)  endif  }
   "Set HVACSys:HPModelDualFuel"			   HVACSys:HPModelDualFuel		   = {	0  }     ; SAC 12/08/20
;	"debug Setup Split HP"	HVACSys:Action	=	{ if (FloorAreaServed > 0.5) then PostWarning( "Setup_HVACSys_HtPump_SplitHeatPump -> HVACSys:HPSysHSPF = %g", HPSysHSPF ) else UNCHANGED endif }
END
;*************************************************************************
RULELIST "Setup_HVACSys_HtPump_DuctlessMiniSplitHeatPump"       1 0 1 0
   "Set HVACSys:ClSysSizingFactor"			HVACSys:ClSysSizingFactor		= {	1.2  }      ; SAC 02/25/22

   "Set HVACSys:HPSysHSPF"					HVACSys:HPSysHSPF					= {	T24RHeatingEquipment:HSPF( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdHeatingType ) )  }
   "Set HVACSys:HPSysAutoSize"         HVACSys:HPSysAutoSize         = {  0  }
   "Set HVACSys:HPSysCap47"					HVACSys:HPSysCap47				= {	0  }  
   "Set HVACSys:HPSysMinCap47"				HVACSys:HPSysMinCap47			= {	0  }     ; SAC 03/11/21
   "Set HVACSys:HPSysCap35"					HVACSys:HPSysCap35				= {	0  }  
   "Set HVACSys:HPSysCap17"					HVACSys:HPSysCap17				= {	0  }  
   "Set HVACSys:HPSysCOP47"					HVACSys:HPSysCOP47				= {	0  }  
   "Set HVACSys:HPSysCOP35"					HVACSys:HPSysCOP35				= {	0  }  
   "Set HVACSys:HPSysCOP17"					HVACSys:HPSysCOP17				= {	0  }  
   "Set HVACSys:HPSysAuxHtgCap"			HVACSys:HPSysAuxHtgCap		= {	0  }  
   "Set HVACSys:HPModelDualFuel"			HVACSys:HPModelDualFuel		= {	0  }     ; SAC 12/08/20

	"Set HVACSys:ClSysSEER"           HVACSys:ClSysSEER             = {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) )  }
	"Set HVACSys:ClSysEER"						HVACSys:ClSysEER					= {
											if (LocalStatus( ClSysSEER ) < 1) then  UNDEFINED
											else if (			T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) ) > 0 .AND.
												  ClSysSEER == T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) ))
											then					T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) )
											else if (ClSysSEER >= 16) then	13
											else if (ClSysSEER >= 13) then	11.3 + (0.57 * (ClSysSEER - 13  ))
											else										10   + (0.84 * (ClSysSEER - 11.5))
											endif endif endif endif  }
	"Set HVACSys:ClSysCFMperTon"       		HVACSys:ClSysCFMperTon        = {	T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  }
	"Set HVACSys:ClSysRefrigChgAdjFctr"		HVACSys:ClSysRefrigChgAdjFctr = {	UNDEFINED  }
END
;*************************************************************************
RULELIST "Setup_HVACSys_HtPump_RoomHeatPump" 1 0 1 0
	"Set HVACSys:ClSysRefrigChgAdjFctr"		HVACSys:ClSysRefrigChgAdjFctr	= {	UNDEFINED  }
   "Set HVACSys:ClSysSizingFactor"			HVACSys:ClSysSizingFactor		= {	1.2  }      ; SAC 02/25/22
;	"Set HVACSys:HtPump:IsMultiSpeed"		HVACHtPump:IsMultiSpeed			= {	0  }
;	"Set HVACSys:HtPump:IsZonal"				HVACHtPump:IsZonal				= {	0  }
; no setting of HSPF, Cap47, ... ??
END
;*************************************************************************

;*************************************************************************
RULELIST "Setup_HVACHtPump_SplitHeatPump"       1 0 1 0
   "Set HVACHtPump:Type to SplitHeatPump"       	HVACHtPump:Type	= {	4  }	; "SplitHeatPump"
	"Call subordinate rulelist to default generic heat pump system data"	      HVACHtPump:Action = {	EvalRulelist( "Default_HVACHeatPump", 1 )  }
   "Call subordinate rulelist to default type-specific heat pump system data"	HVACHtPump:Action = {	EvalRulelist( "Default_HtPump_SplitHeatPump" , 1 )  }
END
;*************************************************************************
RULELIST "Setup_HVACHtPump_DuctlessMiniSplitHeatPump"       1 0 1 0
   "Set HVACHtPump:Type to DuctlessHeatPump"     	HVACHtPump:Type	= {	10  }	; "DuctlessHeatPump"
	"Call subordinate rulelist to default generic heat pump system data"	      HVACHtPump:Action = {	EvalRulelist( "Default_HVACHeatPump", 1 )  }
  "Call subordinate rulelist to default type-specific heat pump system data"	HVACHtPump:Action = {	EvalRulelist( "Default_HtPump_DuctlessMiniSplitHeatPump" , 1 )  }
END
;*************************************************************************
RULELIST "Setup_HVACHtPump_RoomHeatPump" 1 0 1 0
   "Set HVACHtPump:Type to RoomHeatPump" 	HVACHtPump:Type	= {	7  }	; "RoomHeatPump"
	"Call subordinate rulelist to default generic heat pump system data"	      HVACHtPump:Action = {	EvalRulelist( "Default_HVACHeatPump", 1 )  }
  "Call subordinate rulelist to default type-specific heat pump system data"	HVACHtPump:Action = {	EvalRulelist( "Default_HtPump_RoomHeatPump"  , 1 )  }
END
;*************************************************************************

; SAC 12/5/13 - replaced individual equipment-based HVACCool budget conversion mechanism (above) w/ following that sets data directly to the HVACSys object(s)
;*************************************************************************
RULELIST "Setup_HVACSys_Cool_SplitAirCond" 1 0 1 0
; mjb	12/9/13 - added logic for E+A+A
;				  - for E+A+A, do NOT Verify EER, just SEER
	"Set HVACSys:AutoSizeCool[1]"				HVACSys:AutoSizeCool[1]			= {	1  }
	"Set HVACSys:ClSysSizingFactor"			HVACSys:ClSysSizingFactor		= {	1.2  }      ; SAC 02/25/22
;	"Set HVACCool:IsMultiSpeed"				HVACCool:IsMultiSpeed		= {	0  }
;	"Set HVACCool:IsZonal"						HVACCool:IsZonal				= {	0  }

; SAC 12/26/14 - added logic to set based on existing/verified value - and do this BEFORE resetting ClSysSEER or use of an existing SEER value can screw up the logic
; SAC 12/26/14 - replaced logic triggering use of existing/verified properties to reflect OVERALL cooling equipment beter/equal/worse status (rather than only a comparison of SEER)
; KN 02/24/2015 to support use of codebase for setting verified charge. Concerned about how many different places this same variable is set
; KN 02/24/2015 old version of test replaced by codebase call	;else if (Proj:ClimateZone == 2 .OR. (Proj:ClimateZone >= 8 .AND. Proj:ClimateZone <= 15))
	"Set HVACSys:ClSysRefrigChgAdjFctr"		HVACSys:ClSysRefrigChgAdjFctr	= {	if (Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																												CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
																												MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingFChg ) > 0.0001)
																										then	MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingFChg )
																										else if (Proj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																										else if (T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 )
																										then	0.96 ; verified, CID
																										else	0.90 ; not verified
																										endif endif endif  }

   ; moved up from below to set iff existing equipment where ClSysCFMperTon & ClSysSEER invalid but SEERValid for StdCoolingType - SAC 09/13/21 (user/CEC support)
   "Set HVACSys:ClSysCFMperTon"        HVACSys:ClSysCFMperTon  =
      {  if (Proj:RunScope != 2 .OR. Status != 1 .OR.
             ( IfValidAnd( ClSysSEER > 0 )==0 .AND. IfValidAnd( ClSysCFMperTon > 0 )==0 .AND.
               T24RCoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) ) ))
         then  T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
         else  UNCHANGED  endif  }

; SAC 12/26/14 - replaced logic triggering use of existing/verified properties to reflect OVERALL cooling equipment beter/equal/worse status (rather than only a comparison of SEER)
	"Set HVACSys:ClSysSEER"						HVACSys:ClSysSEER			=     ; added logic to ensure SEER lookup for existing equipment where ClSysSEER invalid but SEERValid for StdCoolingType - SAC 09/13/21 (user/CEC support)
      {  if (Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
             CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
             MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingSEER ) > 5)
         then	MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingSEER )
         else
            if (Proj:RunScope != 2 .OR. Status != 1 .OR.
                ( IfValidAnd( ClSysSEER > 0 )==0 .AND.
                  T24RCoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) ) ))
            then  T24RCoolingEquipment:SEER(      "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) )
            else  UNCHANGED
            endif endif  }

	"Set HVACSys:ClSysEER"						HVACSys:ClSysEER				= {
											if (Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
													CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
													MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingEER ) > 5)
											then	MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingEER )
											else if (LocalStatus( ClSysSEER ) < 1) then  UNCHANGED
											else if (			T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) ) > 0 .AND.
												  ClSysSEER == T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) ))
											then					T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) )
											else if (ClSysSEER >= 16) then	13
											else if (ClSysSEER >= 13)then		11.3 + (0.57 * (ClSysSEER - 13  ))
											else										10   + (0.84 * (ClSysSEER - 11.5))
											endif endif endif endif endif  }
;	"Set HVACSys:ClSysCFMperTon"       		HVACSys:ClSysCFMperTon        = {	350  }
; mjb	12/9/13	E+A+A - consider what correct min existing airflow per ton should be?  right now its 100
;	mjb	8/21/14	E+A+A - do NOT allow tradeoffs with existing CFMperTon (CEC direction)
;	"Set HVACSys:ClSysCFMperTon"				HVACSys:ClSysCFMperTon		= {	if (Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
;																										ClSysCFMperTon >= 350 .AND. MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingCFMperTon ) > 100)
;																								then	MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingCFMperTon )
;																								else	
;																									if (Proj:RunScope == 2 .AND. Status == 1) then UNCHANGED
;																									else
;																										350  
;																									endif endif  }
; mjb 1/30/15 - mods to look up std. CFMperTon from T24RClimateZoneCodeBase
;	"Set HVACSys:ClSysCFMperTon"				HVACSys:ClSysCFMperTon		= {	if (Proj:RunScope == 2 .AND. Status == 1) then UNCHANGED else 350 endif  }
;	"Set HVACSys:ClSysCFMperTon"				HVACSys:ClSysCFMperTon		= {	if (Proj:RunScope == 2 .AND. Status == 1) then UNCHANGED else T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) endif  }

;	"debug HVAC"			HVACSys:Action = { PostWarning( "Setup_HVACSys_Cool_SplitAirCond  HVACSys: '%s'  ClSysSEER: %g   ClSysEER: %g",  Name, ClSysSEER, ClSysEER )  }
END
;*************************************************************************
RULELIST "Setup_HVACSys_Cool_RoomAirCond" 1 0 1 0
; mjb	12/9/13 - added logic for E+A+A
;				  - for E+A+A, do NOT Verify EER, just SEER
	"Set HVACSys:AutoSizeCool[1]"				HVACSys:AutoSizeCool[1]			= {	1  }
	"Set HVACSys:ClSysSizingFactor"			HVACSys:ClSysSizingFactor		= {	1.2  }      ; SAC 02/25/22
	"Set HVACSys:ClSysRefrigChgAdjFctr"		HVACSys:ClSysRefrigChgAdjFctr = {	UNDEFINED  }
;	"Set HVACCool:IsMultiSpeed"				HVACCool:IsMultiSpeed		= {	0  }
;	"Set HVACCool:IsZonal"						HVACCool:IsZonal				= {	0  }

;	"Set HVACSys:ClSysSEER"            		HVACSys:ClSysSEER				= {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) )  }

	"Set HVACSys:ClSysEER"						HVACSys:ClSysEER				= {
											if (Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
													CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
													MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingEER ) > 5)
											then	MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingEER )
											else if (LocalStatus( ClSysSEER ) < 1) then  UNCHANGED
											else if (			T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) ) > 0 .AND.
												  ClSysSEER == T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) ))
											then					T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) )
											else UNCHANGED
											endif endif endif }

; SAC 12/26/14 - replaced logic triggering use of existing/verified properties to reflect OVERALL cooling equipment beter/equal/worse status (rather than only a comparison of SEER)
	"Set HVACSys:ClSysSEER"						HVACSys:ClSysSEER			= {	if (Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																										CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
																										MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingSEER ) > 5)
																								then	MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingSEER )
																								else	
																									if (Proj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																									else	1.07 * ClSysEER
																									endif endif }
	;"Set HVACSys:ClSysSEER"						HVACSys:ClSysSEER			= {	if (Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
	;																									ClSysSEER >= T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) ) .AND.
	;																									MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingSEER ) > 5)
	;																							then	MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingSEER )
	;																							else	
	;																								if (Proj:RunScope == 2 .AND. Status == 1) then UNCHANGED
	;																								else
	;																									T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) )  
	;																								endif endif  }

	;"Set HVACSys:ClSysEER"						HVACSys:ClSysEER				= {
	;										if (LocalStatus( ClSysSEER ) < 1) then  UNCHANGED
	;										else if (			T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) ) > 0 .AND.
	;											  ClSysSEER == T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) ))
	;										then					T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) )
	;										else if (ClSysSEER >= 16) then	13
	;										else if (ClSysSEER >= 13)then		11.3 + (0.57 * (ClSysSEER - 13  ))
	;										else										10   + (0.84 * (ClSysSEER - 11.5))
	;										endif endif endif endif  }
    ;
;	"Set HVACSys:ClSysCFMperTon"       		HVACSys:ClSysCFMperTon        = {  350  }
; mjb	12/9/13	E+A+A - consider what correct min existing airflow per ton should be?  right now its 100
; mjb 1/30/15 - mods to lookup std. CFMperTon from T24RClimateZoneCodeBase
	"Set HVACSys:ClSysCFMperTon"				HVACSys:ClSysCFMperTon		= {	if (Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																										CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
																										MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingCFMperTon ) > 100)
																								then	MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingCFMperTon )
																								else	
																									if (Proj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																									else
;																										350  
																										T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
																									endif endif  }

	"Set HVACSys:ClSysRefrigChgAdjFctr"		HVACSys:ClSysRefrigChgAdjFctr	= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "Setup_HVACSys_Cool_SplitHeatPump" 1 0 1 0
; mjb	12/9/13 - added logic for E+A+A
;				  - for E+A+A, do NOT Verify EER, just SEER
	"Set HVACSys:AutoSizeCool[1]"				HVACSys:AutoSizeCool[1]			= {	1  }
	"Set HVACSys:ClSysSizingFactor"			HVACSys:ClSysSizingFactor		= {	1.2  }      ; SAC 02/25/22
;	"Set HVACCool:IsMultiSpeed"				HVACCool:IsMultiSpeed		= {	0  }
;	"Set HVACCool:IsZonal"						HVACCool:IsZonal				= {	0  }

; SAC 12/26/14 - added logic to set based on existing/verified value - and do this BEFORE resetting ClSysSEER or use of an existing SEER value can screw up the logic
; SAC 12/26/14 - replaced logic triggering use of existing/verified properties to reflect OVERALL cooling equipment beter/equal/worse status (rather than only a comparison of SEER)
; KN 02/24/2015 to support use of codebase for setting verified charge. Concerned about how many different places this same variable is set
; KN 02/24/2015 old version of test replaced by codebase call	;else	if (Proj:ClimateZone == 2 .OR. (Proj:ClimateZone >= 8 .AND. Proj:ClimateZone <= 15))
	"Set HVACSys:ClSysRefrigChgAdjFctr"		HVACSys:ClSysRefrigChgAdjFctr = {	if (Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																												CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
																												MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingFChg ) > 0.0001)
																										then	MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingFChg )
																										else	if (T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 )
																												then	0.96 ; verified,CID
																												else	0.90 ; not verified
																												endif endif  }

; SAC 12/26/14 - replaced logic triggering use of existing/verified properties to reflect OVERALL cooling equipment beter/equal/worse status (rather than only a comparison of SEER)
	"Set HVACSys:ClSysSEER"						HVACSys:ClSysSEER			= {	if (Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																										CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
																										MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingSEER ) > 5)
																								then	MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingSEER )
																								else	
																									if (Proj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																									else
																										T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) )  
																									endif endif  }

	"Set HVACSys:ClSysEER"						HVACSys:ClSysEER					= {
											if (Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
													CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
													MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingEER ) > 5)
											then	MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingEER )
											else if (LocalStatus( ClSysSEER ) < 1) then  UNDEFINED
											else if (			T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) ) > 0 .AND.
												  ClSysSEER == T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) ))
											then					T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) )
											else if (ClSysSEER >= 16) then	13
											else if (ClSysSEER >= 13) then	11.3 + (0.57 * (ClSysSEER - 13  ))
											else										10   + (0.84 * (ClSysSEER - 11.5))
											endif endif endif endif endif  }

;	"Set HVACSys:ClSysCFMperTon"       		HVACSys:ClSysCFMperTon        = {	350  }
; mjb	12/9/13	E+A+A - consider what correct min existing airflow per ton should be?  right now its 100
; mjb 1/30/15 - mods to lookup std. CFMperTon from T24RClimateZoneCodeBase
	"Set HVACSys:ClSysCFMperTon"				HVACSys:ClSysCFMperTon		= {	if (Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																										CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
																										MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingCFMperTon ) > 100)
																								then	MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingCFMperTon )
																								else	
																									if (Proj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																									else
;																										350  
																										T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
																									endif endif  }
END
;*************************************************************************
RULELIST "Setup_HVACSys_Cool_RoomHeatPump" 1 0 1 0
; mjb	12/9/13 - added logic for E+A+A
;				  - for E+A+A, do NOT Verify EER, just SEER
	"Set HVACSys:AutoSizeCool[1]"				HVACSys:AutoSizeCool[1]			= {	1  }
	"Set HVACSys:ClSysSizingFactor"			HVACSys:ClSysSizingFactor		= {	1.2  }      ; SAC 02/25/22
	"Set HVACSys:ClSysRefrigChgAdjFctr"		HVACSys:ClSysRefrigChgAdjFctr = {	UNDEFINED  }
;	"Set HVACCool:IsMultiSpeed"				HVACCool:IsMultiSpeed		= {	0  }
;	"Set HVACCool:IsZonal"						HVACCool:IsZonal				= {	0  }

; SAC 12/26/14 - replaced logic triggering use of existing/verified properties to reflect OVERALL cooling equipment beter/equal/worse status (rather than only a comparison of SEER)
	"Set HVACSys:ClSysSEER"						HVACSys:ClSysSEER			= {	if (Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																										CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
																										MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingSEER ) > 5)
																								then	MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingSEER )
																								else	
																									if (Proj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																									else
																										T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) )  
																									endif endif  }

	"Set HVACSys:ClSysEER"						HVACSys:ClSysEER					= {
											if (Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
													CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
													MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingEER ) > 5)
											then	MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingEER )
											else if (LocalStatus( ClSysSEER ) < 1) then  UNDEFINED
											else if (			T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) ) > 0 .AND.
												  ClSysSEER == T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) ))
											then					T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", EnumString( StdCoolingType ) )
											else if (ClSysSEER >= 16) then	13
											else if (ClSysSEER >= 13) then	11.3 + (0.57 * (ClSysSEER - 13  ))
											else										10   + (0.84 * (ClSysSEER - 11.5))
											endif endif endif endif endif  }

;	"Set HVACSys:ClSysCFMperTon"       		HVACSys:ClSysCFMperTon        = {	350  }
; mjb	12/9/13	E+A+A - consider what correct min existing airflow per ton should be?  right now its 100
; mjb 1/30/15 - mods to lookup std. CFMperTon from T24RClimateZoneCodeBase
	"Set HVACSys:ClSysCFMperTon"				HVACSys:ClSysCFMperTon		= {	if (Proj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																										CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
																										MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingCFMperTon ) > 100)
																								then	MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingCFMperTon )
																								else	
																									if (Proj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																									else
;																										350  
																										T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
																									endif endif  }

	"Set HVACSys:ClSysRefrigChgAdjFctr"		HVACSys:ClSysRefrigChgAdjFctr = {	UNDEFINED  }
END
;*************************************************************************

; SAC 8/16/19 - rulelist to force Proposed model VCHP performance to Std design levels (tic #1148)
;************************************************************************* ; replaced 'EnumString( StdHeatingType )' in table look-ups w/ 'HtPumpSysTypeAbbrev' - SAC 04/07/21
RULELIST "Setup_HVACSys_ProposedVCHP" 1 0 1 0
   "Set HVACSys:HPSysHSPF"    HVACSys:HPSysHSPF  = {  T24RHeatingEquipment:HSPF( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev )  }
   "Set HVACSys:ClSysSEER"    HVACSys:ClSysSEER  = {  T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev )  }
   "Set HVACSys:ClSysEER"     HVACSys:ClSysEER   = {  T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev )  }
END
;*************************************************************************

;*************************************************************************
RULELIST "Setup_HVACCool_SplitAirCond" 1 0 1 0
   "Set HVACCool:Type to SplitAirCond" 	HVACCool:Type	= {	2  }	; "SplitAirCond"
	"Call subordinate rulelist to default generic cooling system data"			HVACCool:Action = {	EvalRulelist( "Default_HVACCool", 1 )  }
   "Call subordinate rulelist to default type-specific cooling system data"	HVACCool:Action = {	EvalRulelist( "Default_Cool_SplitAirCond", 1 )  }
  ; SAC 3/4/13 - based on e-mail from BAW 3/1/13
;	"Set HVACCool:RefrigChgAdjFctr"		HVACCool:RefrigChgAdjFctr	= {	if (Proj:ClimateZone == 2 .OR. (Proj:ClimateZone >= 8 .AND. Proj:ClimateZone <= 15))
;																								then	0.96  ; verified
;																								else	0.90  ; not verified
;																								endif  }
; KN 03/24/2015 to use codebase to determine ACCharge
	"Set HVACCool:RefrigChgAdjFctr"		HVACCool:RefrigChgAdjFctr	= {	if (T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 )
																								then	0.96  ; verified
																								else	0.90  ; not verified
																								endif  }

END
;*************************************************************************
RULELIST "Setup_HVACCool_RoomAirCond" 1 0 1 0
   "Set HVACCool:Type to RoomAirCond" 		HVACCool:Type	= {	5  }	; "RoomAirCond"
	"Call subordinate rulelist to default generic cooling system data"			HVACCool:Action = {	EvalRulelist( "Default_HVACCool", 1 )  }
   "Call subordinate rulelist to default type-specific cooling system data"	HVACCool:Action = {	EvalRulelist( "Default_Cool_RoomAirCond", 1 )  }
END
;*************************************************************************
RULELIST "Setup_HVACCool_SplitHeatPump" 1 0 1 0
   "Set HVACCool:Type to SplitHeatPump" 	HVACCool:Type	= {	6  }	; "SplitHeatPump"
	"Call subordinate rulelist to default generic cooling system data"			HVACCool:Action = {	EvalRulelist( "Default_HVACCool", 1 )  }
   "Call subordinate rulelist to default type-specific cooling system data"	HVACCool:Action = {	EvalRulelist( "Default_Cool_SplitHeatPump", 1 )  }
  ; SAC 3/4/13 - based on e-mail from BAW 3/1/13
;	"Set HVACCool:RefrigChgAdjFctr"		HVACCool:RefrigChgAdjFctr	= {	if (Proj:ClimateZone == 2 .OR. (Proj:ClimateZone >= 8 .AND. Proj:ClimateZone <= 15))
;																								then	0.96
;																								else	0.90  endif  }
; KN 03/24/2015 to use codebase to determine ACCharge
	"Set HVACCool:RefrigChgAdjFctr"		HVACCool:RefrigChgAdjFctr	= {	if (T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 )
																								then	0.96  ; verified
																								else	0.90  ; not verified
																								endif  }

END
;*************************************************************************
RULELIST "Setup_HVACCool_RoomHeatPump" 1 0 1 0
   "Set HVACCool:Type to RoomHeatPump" 	HVACCool:Type	= {	10  }	; "RoomHeatPump"
	"Call subordinate rulelist to default generic cooling system data"			HVACCool:Action = {	EvalRulelist( "Default_HVACCool", 1 )  }
   "Call subordinate rulelist to default type-specific cooling system data"	HVACCool:Action = {	EvalRulelist( "Default_Cool_RoomHeatPump", 1 )  }
END
;*************************************************************************


;;*************************************************************************
;RULELIST "Setup_HVACSys_CoolVent" 1 0 1 1
;	"Set CoolVent system type"		HVACSys:Type	= {	10  }		; "Cooling Ventilation System"
;END
;;*************************************************************************
;RULELIST "Setup_HVACFan_CoolVent" 1 0 1 1
;	"Set CoolVent fan type"			HVACFan:Type	= {	2  }		; "Whole House Fan"
;END
;;*************************************************************************


;	mjb	8/1/14	- added rulelist to force default of EER based on UseEERinAnalysis
;*************************************************************************
RULELIST "ForceDefault_HVACCool_EER" 1 0 0 0
;*************************************************************************

	"Reset EER if UseEERinAnalysis not checked"		
	HVACCool:EER	= {	
		if (LocalStatus( SEER ) < 1) then UNCHANGED
		else if (	T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) > 0 .AND.
							SEER == T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ))
		then T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )
		else if (SEER >= 16) then  13
		else if (SEER >= 13)	then  11.3 + (0.57 * (SEER - 13  ))
		else 10   + (0.84 * (SEER - 11.5))
		endif endif endif endif  }
	"Reset HVACCool:EERRpt"		HVACCool:EERRpt	= {	if (IfValidAnd( EER > 0 )) then  FltToStr( EER, 11 )  else  "N/A"  endif   }
;	"debug HVAC"			HVACCool:Action = { if (FloorAreaServed > 0.5) then PostWarning( "ForceDefault_HVACCool_EER  HVACCool: '%s'  EER: %g   EERRpt: %g",  Name, EER, EERRpt ) else UNCHANGED endif  }
END


; SAC 1/13/14 - added rulelists to FORCE Window Height/Width to be UNDEFINED when Win:SpecMethod = "Overall Window Area" and Area to be defaulted when Win:SpecMethod = "...Dimensions..."

;	em	10/30/14	- added rulelist to force default of EER based on UseEERinAnalysis
;*************************************************************************
RULELIST "ForceDefault_HVACHtPump_EER" 1 0 0 0
;*************************************************************************

	"Reset EER if UseEERinAnalysis not checked"
	HVACHtPump:EER	= {	
		if (LocalStatus( SEER ) < 1) then UNCHANGED
		else if (	T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) > 0 .AND.
					SEER == T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ))
		then			T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )
		else if (SEER >= 16) then  13
		else if (SEER >= 13)	then  11.3 + (0.57 * (SEER - 13  ))
		else 10 + (0.84 * (SEER - 11.5))
 		endif endif endif endif  }
	;"Reset HVACHtPump:EERRpt"		HVACHtPump:EERRpt	= {	EER   }
END


;*************************************************************************
RULELIST "ForceDefault_Proj_ACH50" 1 0 0 0
;*************************************************************************
	"Redefault Proj:ACH50"		Proj:ACH50	= {	UNDEFINED  }
END


;*************************************************************************
RULELIST "ForceDefault_Zone_HVAC" 1 0 0 0
;*************************************************************************
;	mjb	10/14/14	assign HVACSystem from ActiveHVACSystem for IsAddAlone
	"Set HVACSystem to ActiveHVACSystem"	Zone:HVACSystem			=	{	ActiveHVACSystem	}
   "Force HVACSys Status to Existing"		Zone:HVACSystem:Status	=  {  1 }
   ; SAC 4/10/15 - modified rule to allow selection of New or Existing+New for New Cons Addition Alone
   "Force HVACDist Status to Existing (in some cases)"
   		Zone:HVACSystem:DistribSystem:Status	= {	if (Proj:RunScope == 2) then  UNCHANGED	; need to keep Status as is for EAA
   																	else if (Proj:IsAddAlone > 0.5 .AND. IfValidAnd( HVACSystem:DistribSystem:Status = 2)) then  1
   																	else if (Proj:IsAddAlone < 0.5) then  1
   																	else  UNCHANGED  endif endif endif  }
END
;*************************************************************************


;*************************************************************************  ; added to ensure *:CFMperTon is defaulted for equipment where it is not editable - SAC 08/20/20 (tic #1003)
RULELIST "Blast_HVACHtPump_CFMperTon" 1 0 0 0
   "Blast HVACHtPump:CFMperTon"  HVACHtPump:CFMperTon = {  UNDEFINED  }
END
;*************************************************************************
RULELIST "Blast_HVACCool_CFMperTon" 1 0 0 0
   "Blast HVACCool:CFMperTon"    HVACCool:CFMperTon   = {  UNDEFINED  }
END
;*************************************************************************


; SAC 11/20/14 - rules to FORCE reset of array elements beyond those valid based on NumHeatSystemTypes (same for Cool & HtPump)
;*************************************************************************
RULELIST "ForceReset_HeatSystem_1" 1 0 0 0
	"Force reset of HVACSys:HeatSystem[1]"				HVACSys:HeatSystem[1]			= {	UNDEFINED  }
	"Force reset of HVACSys:HeatSystemCount[1]"		HVACSys:HeatSystemCount[1]		= {	UNDEFINED  }
END
RULELIST "ForceReset_HeatSystem_2" 1 0 0 0
	"Force reset of HVACSys:HeatSystem[2]"				HVACSys:HeatSystem[2]			= {	UNDEFINED  }
	"Force reset of HVACSys:HeatSystemCount[2]"		HVACSys:HeatSystemCount[2]		= {	UNDEFINED  }
END
RULELIST "ForceReset_HeatSystem_3" 1 0 0 0
	"Force reset of HVACSys:HeatSystem[3]"				HVACSys:HeatSystem[3]			= {	UNDEFINED  }
	"Force reset of HVACSys:HeatSystemCount[3]"		HVACSys:HeatSystemCount[3]		= {	UNDEFINED  }
END
RULELIST "ForceReset_HeatSystem_4" 1 0 0 0
	"Force reset of HVACSys:HeatSystem[4]"				HVACSys:HeatSystem[4]			= {	UNDEFINED  }
	"Force reset of HVACSys:HeatSystemCount[4]"		HVACSys:HeatSystemCount[4]		= {	UNDEFINED  }
END
RULELIST "ForceReset_HeatSystem_5" 1 0 0 0
	"Force reset of HVACSys:HeatSystem[5]"				HVACSys:HeatSystem[5]			= {	UNDEFINED  }
	"Force reset of HVACSys:HeatSystemCount[5]"		HVACSys:HeatSystemCount[5]		= {	UNDEFINED  }
END
RULELIST "ForceReset_HeatSystem_6" 1 0 0 0
	"Force reset of HVACSys:HeatSystem[6]"				HVACSys:HeatSystem[6]			= {	UNDEFINED  }
	"Force reset of HVACSys:HeatSystemCount[6]"		HVACSys:HeatSystemCount[6]		= {	UNDEFINED  }
END
RULELIST "ForceReset_HeatSystem_7" 1 0 0 0
	"Force reset of HVACSys:HeatSystem[7]"				HVACSys:HeatSystem[7]			= {	UNDEFINED  }
	"Force reset of HVACSys:HeatSystemCount[7]"		HVACSys:HeatSystemCount[7]		= {	UNDEFINED  }
END
RULELIST "ForceReset_HeatSystem_8" 1 0 0 0
	"Force reset of HVACSys:HeatSystem[8]"				HVACSys:HeatSystem[8]			= {	UNDEFINED  }
	"Force reset of HVACSys:HeatSystemCount[8]"		HVACSys:HeatSystemCount[8]		= {	UNDEFINED  }
END
RULELIST "ForceReset_HeatSystem_9" 1 0 0 0
	"Force reset of HVACSys:HeatSystem[9]"				HVACSys:HeatSystem[9]			= {	UNDEFINED  }
	"Force reset of HVACSys:HeatSystemCount[9]"		HVACSys:HeatSystemCount[9]		= {	UNDEFINED  }
END
RULELIST "ForceReset_HeatSystem_10" 1 0 0 0
	"Force reset of HVACSys:HeatSystem[10]"			HVACSys:HeatSystem[10]			= {	UNDEFINED  }
	"Force reset of HVACSys:HeatSystemCount[10]"		HVACSys:HeatSystemCount[10]	= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "ForceReset_CoolSystem_1" 1 0 0 0
	"Force reset of HVACSys:CoolSystem[1]"				HVACSys:CoolSystem[1]			= {	UNDEFINED  }
	"Force reset of HVACSys:CoolSystemCount[1]"		HVACSys:CoolSystemCount[1]		= {	UNDEFINED  }
END
RULELIST "ForceReset_CoolSystem_2" 1 0 0 0
	"Force reset of HVACSys:CoolSystem[2]"				HVACSys:CoolSystem[2]			= {	UNDEFINED  }
	"Force reset of HVACSys:CoolSystemCount[2]"		HVACSys:CoolSystemCount[2]		= {	UNDEFINED  }
END
RULELIST "ForceReset_CoolSystem_3" 1 0 0 0
	"Force reset of HVACSys:CoolSystem[3]"				HVACSys:CoolSystem[3]			= {	UNDEFINED  }
	"Force reset of HVACSys:CoolSystemCount[3]"		HVACSys:CoolSystemCount[3]		= {	UNDEFINED  }
END
RULELIST "ForceReset_CoolSystem_4" 1 0 0 0
	"Force reset of HVACSys:CoolSystem[4]"				HVACSys:CoolSystem[4]			= {	UNDEFINED  }
	"Force reset of HVACSys:CoolSystemCount[4]"		HVACSys:CoolSystemCount[4]		= {	UNDEFINED  }
END
RULELIST "ForceReset_CoolSystem_5" 1 0 0 0
	"Force reset of HVACSys:CoolSystem[5]"				HVACSys:CoolSystem[5]			= {	UNDEFINED  }
	"Force reset of HVACSys:CoolSystemCount[5]"		HVACSys:CoolSystemCount[5]		= {	UNDEFINED  }
END
RULELIST "ForceReset_CoolSystem_6" 1 0 0 0
	"Force reset of HVACSys:CoolSystem[6]"				HVACSys:CoolSystem[6]			= {	UNDEFINED  }
	"Force reset of HVACSys:CoolSystemCount[6]"		HVACSys:CoolSystemCount[6]		= {	UNDEFINED  }
END
RULELIST "ForceReset_CoolSystem_7" 1 0 0 0
	"Force reset of HVACSys:CoolSystem[7]"				HVACSys:CoolSystem[7]			= {	UNDEFINED  }
	"Force reset of HVACSys:CoolSystemCount[7]"		HVACSys:CoolSystemCount[7]		= {	UNDEFINED  }
END
RULELIST "ForceReset_CoolSystem_8" 1 0 0 0
	"Force reset of HVACSys:CoolSystem[8]"				HVACSys:CoolSystem[8]			= {	UNDEFINED  }
	"Force reset of HVACSys:CoolSystemCount[8]"		HVACSys:CoolSystemCount[8]		= {	UNDEFINED  }
END
RULELIST "ForceReset_CoolSystem_9" 1 0 0 0
	"Force reset of HVACSys:CoolSystem[9]"				HVACSys:CoolSystem[9]			= {	UNDEFINED  }
	"Force reset of HVACSys:CoolSystemCount[9]"		HVACSys:CoolSystemCount[9]		= {	UNDEFINED  }
END
RULELIST "ForceReset_CoolSystem_10" 1 0 0 0
	"Force reset of HVACSys:CoolSystem[10]"			HVACSys:CoolSystem[10]			= {	UNDEFINED  }
	"Force reset of HVACSys:CoolSystemCount[10]"		HVACSys:CoolSystemCount[10]	= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "ForceReset_HtPumpSystem_1" 1 0 0 0
	"Force reset of HVACSys:HtPumpSystem[1]"				HVACSys:HtPumpSystem[1]			= {	UNDEFINED  }
	"Force reset of HVACSys:HtPumpSystemCount[1]"		HVACSys:HtPumpSystemCount[1]	= {	UNDEFINED  }
END
RULELIST "ForceReset_HtPumpSystem_2" 1 0 0 0
	"Force reset of HVACSys:HtPumpSystem[2]"				HVACSys:HtPumpSystem[2]			= {	UNDEFINED  }
	"Force reset of HVACSys:HtPumpSystemCount[2]"		HVACSys:HtPumpSystemCount[2]	= {	UNDEFINED  }
END
RULELIST "ForceReset_HtPumpSystem_3" 1 0 0 0
	"Force reset of HVACSys:HtPumpSystem[3]"				HVACSys:HtPumpSystem[3]			= {	UNDEFINED  }
	"Force reset of HVACSys:HtPumpSystemCount[3]"		HVACSys:HtPumpSystemCount[3]	= {	UNDEFINED  }
END
RULELIST "ForceReset_HtPumpSystem_4" 1 0 0 0
	"Force reset of HVACSys:HtPumpSystem[4]"				HVACSys:HtPumpSystem[4]			= {	UNDEFINED  }
	"Force reset of HVACSys:HtPumpSystemCount[4]"		HVACSys:HtPumpSystemCount[4]	= {	UNDEFINED  }
END
RULELIST "ForceReset_HtPumpSystem_5" 1 0 0 0
	"Force reset of HVACSys:HtPumpSystem[5]"				HVACSys:HtPumpSystem[5]			= {	UNDEFINED  }
	"Force reset of HVACSys:HtPumpSystemCount[5]"		HVACSys:HtPumpSystemCount[5]	= {	UNDEFINED  }
END
RULELIST "ForceReset_HtPumpSystem_6" 1 0 0 0
	"Force reset of HVACSys:HtPumpSystem[6]"				HVACSys:HtPumpSystem[6]			= {	UNDEFINED  }
	"Force reset of HVACSys:HtPumpSystemCount[6]"		HVACSys:HtPumpSystemCount[6]	= {	UNDEFINED  }
END
RULELIST "ForceReset_HtPumpSystem_7" 1 0 0 0
	"Force reset of HVACSys:HtPumpSystem[7]"				HVACSys:HtPumpSystem[7]			= {	UNDEFINED  }
	"Force reset of HVACSys:HtPumpSystemCount[7]"		HVACSys:HtPumpSystemCount[7]	= {	UNDEFINED  }
END
RULELIST "ForceReset_HtPumpSystem_8" 1 0 0 0
	"Force reset of HVACSys:HtPumpSystem[8]"				HVACSys:HtPumpSystem[8]			= {	UNDEFINED  }
	"Force reset of HVACSys:HtPumpSystemCount[8]"		HVACSys:HtPumpSystemCount[8]	= {	UNDEFINED  }
END
RULELIST "ForceReset_HtPumpSystem_9" 1 0 0 0
	"Force reset of HVACSys:HtPumpSystem[9]"				HVACSys:HtPumpSystem[9]			= {	UNDEFINED  }
	"Force reset of HVACSys:HtPumpSystemCount[9]"		HVACSys:HtPumpSystemCount[9]	= {	UNDEFINED  }
END
RULELIST "ForceReset_HtPumpSystem_10" 1 0 0 0
	"Force reset of HVACSys:HtPumpSystem[10]"				HVACSys:HtPumpSystem[10]		= {	UNDEFINED  }
	"Force reset of HVACSys:HtPumpSystemCount[10]"		HVACSys:HtPumpSystemCount[10]	= {	UNDEFINED  }
END
;*************************************************************************

; SAC 11/20/14 - rules to FORCE reset of array elements beyond those valid based on DwellUnitType:NumHeatEquipTypes (same for Cool & HtPump)
;*************************************************************************
RULELIST "ForceReset_DwellUnitType_HeatEquip_1" 1 0 0 0
	"Force reset of DwellUnitType:HVACHeatRef[1]"			DwellUnitType:HVACHeatRef[1]			= {	UNDEFINED  }
	"Force reset of DwellUnitType:HeatEquipCount[1]"		DwellUnitType:HeatEquipCount[1]		= {	UNDEFINED  }
END
RULELIST "ForceReset_DwellUnitType_HeatEquip_2" 1 0 0 0
	"Force reset of DwellUnitType:HVACHeatRef[2]"			DwellUnitType:HVACHeatRef[2]			= {	UNDEFINED  }
	"Force reset of DwellUnitType:HeatEquipCount[2]"		DwellUnitType:HeatEquipCount[2]		= {	UNDEFINED  }
END
RULELIST "ForceReset_DwellUnitType_HeatEquip_3" 1 0 0 0
	"Force reset of DwellUnitType:HVACHeatRef[3]"			DwellUnitType:HVACHeatRef[3]			= {	UNDEFINED  }
	"Force reset of DwellUnitType:HeatEquipCount[3]"		DwellUnitType:HeatEquipCount[3]		= {	UNDEFINED  }
END
RULELIST "ForceReset_DwellUnitType_HeatEquip_4" 1 0 0 0
	"Force reset of DwellUnitType:HVACHeatRef[4]"			DwellUnitType:HVACHeatRef[4]			= {	UNDEFINED  }
	"Force reset of DwellUnitType:HeatEquipCount[4]"		DwellUnitType:HeatEquipCount[4]		= {	UNDEFINED  }
END
RULELIST "ForceReset_DwellUnitType_HeatEquip_5" 1 0 0 0
	"Force reset of DwellUnitType:HVACHeatRef[5]"			DwellUnitType:HVACHeatRef[5]			= {	UNDEFINED  }
	"Force reset of DwellUnitType:HeatEquipCount[5]"		DwellUnitType:HeatEquipCount[5]		= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "ForceReset_DwellUnitType_CoolEquip_1" 1 0 0 0
	"Force reset of DwellUnitType:HVACCoolRef[1]"			DwellUnitType:HVACCoolRef[1]			= {	UNDEFINED  }
	"Force reset of DwellUnitType:CoolEquipCount[1]"		DwellUnitType:CoolEquipCount[1]		= {	UNDEFINED  }
END
RULELIST "ForceReset_DwellUnitType_CoolEquip_2" 1 0 0 0
	"Force reset of DwellUnitType:HVACCoolRef[2]"			DwellUnitType:HVACCoolRef[2]			= {	UNDEFINED  }
	"Force reset of DwellUnitType:CoolEquipCount[2]"		DwellUnitType:CoolEquipCount[2]		= {	UNDEFINED  }
END
RULELIST "ForceReset_DwellUnitType_CoolEquip_3" 1 0 0 0
	"Force reset of DwellUnitType:HVACCoolRef[3]"			DwellUnitType:HVACCoolRef[3]			= {	UNDEFINED  }
	"Force reset of DwellUnitType:CoolEquipCount[3]"		DwellUnitType:CoolEquipCount[3]		= {	UNDEFINED  }
END
RULELIST "ForceReset_DwellUnitType_CoolEquip_4" 1 0 0 0
	"Force reset of DwellUnitType:HVACCoolRef[4]"			DwellUnitType:HVACCoolRef[4]			= {	UNDEFINED  }
	"Force reset of DwellUnitType:CoolEquipCount[4]"		DwellUnitType:CoolEquipCount[4]		= {	UNDEFINED  }
END
RULELIST "ForceReset_DwellUnitType_CoolEquip_5" 1 0 0 0
	"Force reset of DwellUnitType:HVACCoolRef[5]"			DwellUnitType:HVACCoolRef[5]			= {	UNDEFINED  }
	"Force reset of DwellUnitType:CoolEquipCount[5]"		DwellUnitType:CoolEquipCount[5]		= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "ForceReset_DwellUnitType_HtPumpEquip_1" 1 0 0 0
	"Force reset of DwellUnitType:HVACHtPumpRef[1]"			DwellUnitType:HVACHtPumpRef[1]		= {	UNDEFINED  }
	"Force reset of DwellUnitType:HtPumpEquipCount[1]"		DwellUnitType:HtPumpEquipCount[1]	= {	UNDEFINED  }
END
RULELIST "ForceReset_DwellUnitType_HtPumpEquip_2" 1 0 0 0
	"Force reset of DwellUnitType:HVACHtPumpRef[2]"			DwellUnitType:HVACHtPumpRef[2]		= {	UNDEFINED  }
	"Force reset of DwellUnitType:HtPumpEquipCount[2]"		DwellUnitType:HtPumpEquipCount[2]	= {	UNDEFINED  }
END
RULELIST "ForceReset_DwellUnitType_HtPumpEquip_3" 1 0 0 0
	"Force reset of DwellUnitType:HVACHtPumpRef[3]"			DwellUnitType:HVACHtPumpRef[3]		= {	UNDEFINED  }
	"Force reset of DwellUnitType:HtPumpEquipCount[3]"		DwellUnitType:HtPumpEquipCount[3]	= {	UNDEFINED  }
END
RULELIST "ForceReset_DwellUnitType_HtPumpEquip_4" 1 0 0 0
	"Force reset of DwellUnitType:HVACHtPumpRef[4]"			DwellUnitType:HVACHtPumpRef[4]		= {	UNDEFINED  }
	"Force reset of DwellUnitType:HtPumpEquipCount[4]"		DwellUnitType:HtPumpEquipCount[4]	= {	UNDEFINED  }
END
RULELIST "ForceReset_DwellUnitType_HtPumpEquip_5" 1 0 0 0
	"Force reset of DwellUnitType:HVACHtPumpRef[5]"			DwellUnitType:HVACHtPumpRef[5]		= {	UNDEFINED  }
	"Force reset of DwellUnitType:HtPumpEquipCount[5]"		DwellUnitType:HtPumpEquipCount[5]	= {	UNDEFINED  }
END
;*************************************************************************

;*************************************************************************    ; SAC 10/21/19
RULELIST "ForceReset_IAQFan_SensRecovEff" 1 0 0 0
	"Force reset of IAQFan:SensRecovEff"			IAQFan:SensRecovEff		= {	UNDEFINED  }
	"Force reset of IAQFan:AdjSensRecovEff"		IAQFan:AdjSensRecovEff	= {	UNDEFINED  }
END
;*************************************************************************

;*************************************************************************    ; SAC 2/5/20 (tic #1174)
RULELIST "ForceOn_IAQFan_IncludesRecov" 1 0 1 1
   "Force IAQFan:IncludesRecov ON"           IAQFan:IncludesRecov  = {  1  }
   "post warning re: new SRE/ASRE inputs"    IAQFan:Action  = {
      if (NumAssignments < 1) then  UNCHANGED
      else  PostWarning( "IAQ fan '%s' was modeled with heat recovery using out of date inputs. New inputs for SRE & ASRE must be specified before analysis can be performed.", Name )  endif  }
END
;*************************************************************************
RULELIST "ForceReset_IAQFan_IAQRecovEffect" 1 0 0 0
   "Force reset of IAQFan:IAQRecovEffect"    IAQFan:IAQRecovEffect  = {  UNDEFINED  }
END
;*************************************************************************

;*************************************************************************    ; SAC 2/7/20 (tic #1174)
RULELIST "Interpolate_IAQFan_SRE_ASRE" 1 0 0 0
   "Set IAQFan:HVIListedInterpFrac"       IAQFan:HVIListedInterpFrac  =
      {  (IAQCFM - HVIListedInterpCFM[1]) / (HVIListedInterpCFM[2] - HVIListedInterpCFM[1])  }
   "Interpolate IAQFan:SensRecovEff"      IAQFan:SensRecovEff  =
      {  int( HVIListedInterpSRE[1]  + ( (HVIListedInterpSRE[2]  - HVIListedInterpSRE[1] ) * HVIListedInterpFrac ) + 0.5 )  }
   "Interpolate IAQFan:AdjSensRecovEff"   IAQFan:AdjSensRecovEff  =
      {  int( HVIListedInterpASRE[1] + ( (HVIListedInterpASRE[2] - HVIListedInterpASRE[1]) * HVIListedInterpFrac ) + 0.5 )  }
END
;*************************************************************************


  ; LDH - Rulelist to Blast DwellUnit Objects for Single Family Projects
;*************************************************************************
RULELIST "BlastDwellingUnit" 1 0 0 0
  "Post Warning Message for Dwelling Unit Purge"  DwellUnit:Action = {
    PostWarning( "Specification of Dwelling Units in not valid for single family projects.  Dwelling Unit 
                  '%s' will be purged.", 
                  Name ) }

  "Blast Dwelling Unit"  DwellUnit:Action = { DeleteComp() }  
END

  ; LDH - Rulelist to Reset Zone Status Properties for 'Newly Constructed' Projects
;*************************************************************************
RULELIST "ResetZoneStatus_New" 1 0 0 1

; ---------- Reset Zone Status ------------------------------------------------------------------------------
  "Post Warning Regarding Zone:Status Reset"    Zone:Action = {
    if( Status != 3 )
    then PostWarning ( "For 'Newly Constructed' projects, all zones must have Status 'New'.  Zone '%s' Status
                        will be reset to 'New'.", Name )
    else UNCHANGED
    endif }

  "Reset Zone:Status based on Proj:RunScope"  Zone:Status = {
    if( Status != 3 )
    then "New"
    else UNCHANGED
    endif }

; ---------- Reset Attic Status -----------------------------------------------------------------------------
  "Post Warning Regarding Attic:Status Reset"    Attic:Action = {
    if( Status != 3 )
    then PostWarning ( "For 'Newly Constructed' projects, all Attics must have Status 'New'.  Attic '%s' Status
                        will be reset to 'New'.", Name )
    else UNCHANGED
    endif }

  "Reset Attic:Status based on Proj:RunScope"  Attic:Status = {
    if( Status != 3 )   
    then "New"
    else UNCHANGED
    endif }
END


  ; LDH - Rulelist to Reset Envelope Status Properties for Zones with Status = New
;*************************************************************************
RULELIST "ResetEnvelopeObjectStatus_New" 1 0 0 1

   ; SAC 7/19/17 - revised all rules to first confirm that surface is child of Zone (as opposed to Garage) before reporting or changing Status (tic #768)
; ---------- Reset ExtWall Status ---------------------------------------------------------------------------
  "Post Warning Regarding ExtWall:Status Reset"    ExtWall:Action = {
    if (ParentComponentType() != "Zone") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then PostWarning ( "'%s' Status will be reset to 'New' due to it's assignment to a zone with status
                             = 'New'", Name )
    else UNCHANGED
    endif endif }
  
"Reset ExtWall:Status to New"    ExtWall:Status = {
    if (ParentComponentType() != "Zone") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then "New"
    else UNCHANGED
    endif endif }

; ---------- Reset ExteriorFloor Status ---------------------------------------------------------------------
  "Post Warning Regarding ExteriorFloor:Status Reset"    ExteriorFloor:Action = {
    if (ParentComponentType() != "Zone") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then PostWarning ( "'%s' Status will be reset to 'New' due to it's assignment to a zone with status
                             = 'New'", Name )
    else UNCHANGED
    endif endif }
  
"Reset ExteriorFloor:Status to New"    ExteriorFloor:Status = {
    if (ParentComponentType() != "Zone") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then "New"
    else UNCHANGED
    endif endif }

; ---------- Reset CathedralCeiling Status ------------------------------------------------------------------
  "Post Warning Regarding CathedralCeiling:Status Reset"    CathedralCeiling:Action = {
    if (ParentComponentType() != "Zone") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then PostWarning ( "'%s' Status will be reset to 'New' due to it's assignment to a zone with status
                             = 'New'", Name )
    else UNCHANGED
    endif endif }
  
"Reset CathedralCeiling:Status to New"    CathedralCeiling:Status = {
    if (ParentComponentType() != "Zone") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then "New"
    else UNCHANGED
    endif endif }

; ---------- Reset CeilingBelowAttic Status -----------------------------------------------------------------
  "Post Warning Regarding CeilingBelowAttic:Status Reset"    CeilingBelowAttic:Action = {
    if (ParentComponentType() != "Zone") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then PostWarning ( "'%s' Status will be reset to 'New' due to it's assignment to a zone with status
                             = 'New'", Name )
    else UNCHANGED
    endif endif }
  
"Reset CeilingBelowAttic:Status to New"    CeilingBelowAttic:Status = {
    if (ParentComponentType() != "Zone") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then "New"
    else UNCHANGED
    endif endif }

; ---------- Reset FloorOverCrawl Status --------------------------------------------------------------------
  "Post Warning Regarding FloorOverCrawl:Status Reset"    FloorOverCrawl:Action = {
    if (ParentComponentType() != "Zone") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then PostWarning ( "'%s' Status will be reset to 'New' due to it's assignment to a zone with status
                             = 'New'", Name )
    else UNCHANGED
    endif endif }
  
"Reset FloorOverCrawl:Status to New"    FloorOverCrawl:Status = {
    if (ParentComponentType() != "Zone") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then "New"
    else UNCHANGED
    endif endif }

; ---------- Reset IntWall Status ---------------------------------------------------------------------------
  "Post Warning Regarding IntWall:Status Reset"    IntWall:Action = {
    if (ParentComponentType() != "Zone") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then PostWarning ( "'%s' Status will be reset to 'New' due to it's assignment to a zone with status
                             = 'New'", Name )
    else UNCHANGED
    endif endif }
  
"Reset IntWall:Status to New"    IntWall:Status = {
    if (ParentComponentType() != "Zone") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then "New"
    else UNCHANGED
    endif endif }

; ---------- Reset UndWall Status ---------------------------------------------------------------------------
  "Post Warning Regarding UndWall:Status Reset"    UndWall:Action = {
    if (ParentComponentType() != "Zone") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then PostWarning ( "'%s' Status will be reset to 'New' due to it's assignment to a zone with status
                             = 'New'", Name )
    else UNCHANGED
    endif endif }
  
"Reset UndWall:Status to New"    UndWall:Status = {
    if (ParentComponentType() != "Zone") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then "New"
    else UNCHANGED
    endif endif }

; ---------- Reset UndFloor Status --------------------------------------------------------------------------
  "Post Warning Regarding UndFloor:Status Reset"    UndFloor:Action = {
    if (ParentComponentType() != "Zone") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then PostWarning ( "'%s' Status will be reset to 'New' due to it's assignment to a zone with status
                             = 'New'", Name )
    else UNCHANGED
    endif endif }
  
"Reset UndFloor:Status to New"    UndFloor:Status = {
    if (ParentComponentType() != "Zone") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then "New"
    else UNCHANGED
    endif endif }

; ---------- Reset SlabFloor Status -------------------------------------------------------------------------
  "Post Warning Regarding SlabFloor:Status Reset"    SlabFloor:Action = {
    if (ParentComponentType() != "Zone") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then PostWarning ( "'%s' Status will be reset to 'New' due to it's assignment to a zone with status
                             = 'New'", Name )
    else UNCHANGED
    endif endif }
  
"Reset SlabFloor:Status to New"    SlabFloor:Status = {
    if (ParentComponentType() != "Zone") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then "New"
    else UNCHANGED
    endif endif }

; ---------- Reset InteriorFloor ----------------------------------------------------------------------------
  "Post Warning Regarding InteriorFloor:Status Reset"    InteriorFloor:Action = {
    if (ParentComponentType() != "Zone") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then PostWarning ( "'%s' Status will be reset to 'New' due to it's assignment to a zone with status
                             = 'New'", Name )
    else UNCHANGED
    endif endif }
  
"Reset InteriorFloor:Status to New"    InteriorFloor:Status = {
    if (ParentComponentType() != "Zone") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then "New"
    else UNCHANGED
    endif endif }

; ---------- Reset InteriorCeiling Status -------------------------------------------------------------------
  "Post Warning Regarding InteriorCeiling:Status Reset"    InteriorCeiling:Action = {
    if (ParentComponentType() != "Zone") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then PostWarning ( "'%s' Status will be reset to 'New' due to it's assignment to a zone with status
                             = 'New'", Name )
    else UNCHANGED
    endif endif }
  
"Reset InteriorCeiling:Status to New"    InteriorCeiling:Status = {
    if (ParentComponentType() != "Zone") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then "New"
    else UNCHANGED
    endif endif }

   ; SAC 7/19/17 - switch granparent Status checks to parent since Parent2( Status ) for Garage is invalid (tic #768)
; ---------- Reset Window Status ----------------------------------------------------------------------------
  "Post Warning Regarding Window:Status Reset"    Window:Action = {
    if( Parent( Status ) = 3 .AND. Status != 3 )
    then PostWarning ( "'%s' Status will be reset to 'New' due to it's assignment to a zone with status
                             = 'New'", Name )
    else UNCHANGED
    endif }
  
"Reset Window:Status to New"    Window:Status = {
    if( Parent( Status ) = 3 .AND. Status != 3 )
    then "New"
    else UNCHANGED
    endif }

; ---------- Reset Door Status ------------------------------------------------------------------------------
  "Post Warning Regarding Door:Status Reset"    Door:Action = {
    if( Parent( Status ) = 3 .AND. Status != 3 )
    then PostWarning ( "'%s' Status will be reset to 'New' due to it's assignment to a zone with status
                             = 'New'", Name )
    else UNCHANGED
    endif }
  
"Reset Door:Status to New"    Door:Status = {
    if( Parent( Status ) = 3 .AND. Status != 3 )
    then "New"
    else UNCHANGED
    endif }

; ---------- Reset Skylt Status -----------------------------------------------------------------------------
  "Post Warning Regarding Skylt:Status Reset"    Skylt:Action = {
    if( Parent( Status ) = 3 .AND. Status != 3 )
    then PostWarning ( "'%s' Status will be reset to 'New' due to it's assignment to a zone with status
                             = 'New'", Name )
    else UNCHANGED
    endif }
  
"Reset Skylt:Status to New"    Skylt:Status = {
    if( Parent( Status ) = 3 .AND. Status != 3 )
    then "New"
    else UNCHANGED
    endif }
END


  ; LDH - Rulelist to Reset Envelope Status Properties for Zones with Status = New
;*************************************************************************
RULELIST "ResetMechStatus_New" 1 0 0 1

; ---------- Reset Zone:HVACSysStatus -----------------------------------------------------------------------
  "Post Warning Regarding Zone:HVACSysStatus Reset"    Zone:Action = {
    if( HVACSysStatus != 3 )
    then PostWarning ( "For 'Newly Constructed' projects which ARE NOT Additions/Alterations, all objects
                        must have Status 'New'.  HVACSysStatus for '%s' will be reset to 'New'.", Name )
    else UNCHANGED
    endif }
  
"Reset Zone:HVACSysStatus to New"    Zone:HVACSysStatus = {
    if( HVACSysStatus != 3 )
    then "New"
    else UNCHANGED
    endif }

; ---------- Reset HVACSys Status ---------------------------------------------------------------------------
  "Post Warning Regarding HVACSys:Status Reset"    HVACSys:Action = {
    if( Status != 3 )
    then PostWarning ( "For 'Newly Constructed' projects which ARE NOT Additions/Alterations, all objects
                        must have Status 'New'.  '%s' Status will be reset to 'New'.", Name )
    else UNCHANGED
    endif }
  
"Reset HVACSys:Status to New"    HVACSys:Status = {
    if( Status != 3 )
    then "New"
    else UNCHANGED
    endif }

; ---------- Reset HVACDist Status ---------------------------------------------------------------------------
  "Post Warning Regarding HVACSys:Status Reset"    HVACDist:Action = {
    if( Status != 3 )
    then PostWarning ( "For 'Newly Constructed' projects which ARE NOT Additions/Alterations, all objects
                        must have Status 'New'.  '%s' Status will be reset to 'New'.", Name )
    else UNCHANGED
    endif }
  
"Reset HVACSys:Status to New"    HVACDist:Status = {
    if( Status != 3 )
    then "New"
    else UNCHANGED
    endif }

; ---------- Reset Zone:DHWSys1Status -----------------------------------------------------------------------
  "Post Warning Regarding Zone:DHWSys1Status Reset"    Zone:Action = {
    if( DHWSys1Status != 3 )
    then PostWarning ( "For 'Newly Constructed' projects which ARE NOT Additions/Alterations, all objects
                        must have Status 'New'.  DHWSys1Status for '%s' will be reset to 'New'.", Name )
    else UNCHANGED
    endif }
  
"Reset Zone:DHWSys1Status to New"    Zone:DHWSys1Status = {
    if( DHWSys1Status != 3 )
    then "New"
    else UNCHANGED
    endif }

; ---------- Reset Zone:DHWSys2Status -----------------------------------------------------------------------
  "Post Warning Regarding Zone:DHWSys2Status Reset"    Zone:Action = {
    if( DHWSys2Status != 3 )
    then PostWarning ( "For 'Newly Constructed' projects which ARE NOT Additions/Alterations, all objects
                        must have Status 'New'.  DHWSys2Status for '%s' will be reset to 'New'.", Name )
    else UNCHANGED
    endif }
  
"Reset Zone:DHWSys2Status to New"    Zone:DHWSys2Status = {
    if( DHWSys2Status != 3 )
    then "New"
    else UNCHANGED
    endif }
; ---------- Reset DHWSys Status ---------------------------------------------------------------------------
  "Post Warning Regarding DHWSys:Status Reset"    DHWSys:Action = {
    if( Status != 3 )
    then PostWarning ( "For 'Newly Constructed' projects which ARE NOT Additions/Alterations, all objects
                        must have Status 'New'.  '%s' Status will be reset to 'New'.", Name )
    else UNCHANGED
    endif }
  
"Reset DHWSys:Status to New"    DHWSys:Status = {
    if( Status != 3 )
    then "New"
    else UNCHANGED
    endif }

END
;*************************************************************************


;************************************************************************* SAC 04/08/21
RULELIST "SetupDwellUnitType_AreaServed" 1 0 0 1
   "Set DwellUnitType:DUFloorAreaServed"     DwellUnitType:DUFloorAreaServed =
      {  SumRevRef( DwellUnit:DwellUnitTypeRef, DwellUnit:TotalCondFlrArea )  }
   "Set DwellUnitType:DUClFlrAreaServed iff this DUT has valid HVACCool assignments"            DwellUnitType:DUClFlrAreaServed =
      {  if (HVACSysType == 1 .AND. IfValidAnd( NumCoolEquipTypes > 0 ) .AND.
             IfValidAnd( HVACCoolRef[1]:Type > 1 ) .AND. IfValidAnd( CoolEquipCount[1] > 0 ))
         then  DUFloorAreaServed  else  0  endif  }
   "Set DwellUnitType:DUHtFlrAreaServed iff this DUT has valid HVACHeat assignments"            DwellUnitType:DUHtFlrAreaServed =
      {  if (HVACSysType ==1 .AND. IfValidAnd( NumHeatEquipTypes > 0 ) .AND.
             IfValidAnd( HVACHeatRef[1]:Type > 0 ) .AND. IfValidAnd( HeatEquipCount[1] > 0 ))
         then  DUFloorAreaServed  else  0  endif  }
   "Set DwellUnitType:DUHtPmpFlrAreaServed iff this DUT has valid HVACHtPump assignments"       DwellUnitType:DUHtPmpFlrAreaServed =
      {  if (HVACSysType == 2 .AND. IfValidAnd( NumHtPumpEquipTypes > 0 ) .AND.
             IfValidAnd( HVACHtPumpRef[1]:Type > 0 ) .AND. IfValidAnd( HtPumpEquipCount[1] > 0 ))
         then  DUFloorAreaServed  else  0  endif  }
   "Set DwellUnitType:DUGasFurnAreaServed iff served by a gas furnace air handler"              DwellUnitType:DUGasFurnAreaServed =
      {  if (DUHtFlrAreaServed > 0 .AND. (HeatEqpType == 1 .OR. HeatEqpType == 18))
         then  DUFloorAreaServed  else  0  endif  }
   "Set DwellUnitType:DUSDHVFlrAreaServed iff served by a SDHV (small duct high velocity) sys"  DwellUnitType:DUSDHVFlrAreaServed =
      {  if (DUClFlrAreaServed > 0 .AND. CoolEqpType == 18)
         then  DUFloorAreaServed  else  0  endif  }
END
;*************************************************************************


;************************************************************************* rulelist to UN-assign HVACSys objects from Zones in MFam models - SAC 04/09/21
RULELIST "Blast_Zone_HVACSys_Assignments" 1 0 0 1
   "Blast Zone:HVACSystem"        Zone:HVACSystem        = {  UNDEFINED  } 
   "Blast Zone:AltHVACSystem"     Zone:AltHVACSystem     = {  UNDEFINED  }
   "Blast Zone:exHVACSystem"      Zone:exHVACSystem      = {  UNDEFINED  }
   "Blast Zone:ActiveHVACSystem"  Zone:ActiveHVACSystem  = {  UNDEFINED  }
END
;*************************************************************************


;*************************************************************************
;*************************************************************************

ENDFILE
