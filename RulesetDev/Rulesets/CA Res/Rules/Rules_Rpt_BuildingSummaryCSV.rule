; -------------------------------------------------------------------------
; Rules pertaining to:   Population of Building Summary CSV export
; CEC Title-24 Residential Energy Code
; -------------------------------------------------------------------------
; Copyright (c) 2012-2014, California Energy Commission
; Copyright (c) 2012-2014, Wrightsoft Corporation
; All rights reserved.
; Redistribution and use in source and binary forms, with or without modification,
; are permitted provided that the following conditions are met:
; - Redistributions of source code must retain the above copyright notice, this
;   list of conditions and the following disclaimer.
; - Redistributions in binary form must reproduce the above copyright notice, this
;   list of conditions, the following disclaimer in the documentation and/or other
;   materials provided with the distribution.
; - Neither the name of the California Energy Commission nor the names of its
;   contributors may be used to endorse or promote products derived from this
;   software without specific prior written permission.
; DISCLAIMER: THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
; "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
; THE IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
; NON-INFRINGEMENT ARE DISCLAIMED. IN NO EVENT SHALL CALIFORNIA ENERGY COMMISSION,
; WRIGHTSOFT CORPORATION, ITRON, INC. OR ANY OTHER AUTHOR OR COPYRIGHT HOLDER OF
; THIS SOFTWARE (COLLECTIVELY, THE "AUTHORS") BE LIABLE FOR ANY DIRECT, INDIRECT,
; INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
; LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
; OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
; LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
; OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
; ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.  EACH LICENSEE AND SUBLICENSEE OF THE
; SOFTWARE AGREES NOT TO ASSERT ANY CLAIM AGAINST ANY OF THE AUTHORS RELATING TO
; THIS SOFTWARE, WHETHER DUE TO PERFORMANCE ISSUES, TITLE OR INFRINGEMENT ISSUES,
; STRICT LIABILITY OR OTHERWISE.
; -------------------------------------------------------------------------


;*************************************************************************
RULELIST  "Reporting_SummarizeModel" 1 0 0 0
;*************************************************************************
;--------------------------------------------------------------------
; Building-wide window area multiplier rules - related to Res ACM section 2.3.5.5
;--------------------------------------------------------------------
;MJB 12/19/13 - update to match E+A+A rules
; mjb	2/19/14 - add SkyLt area into WinArea totals; add area-weighted window U-factor pre-calc
; SAC 2/20/15 - modified to REMOVE E+A+A Additions window/skylight area from New (item 2) and added separate Additions array element
	"Re-calculate Win:TotAreaInclMult[1] - total"								Win:TotAreaInclMult[1]		= {	Area * Multiplier  }
	"Re-calculate Win:TotAreaInclMult[3] - existing"							Win:TotAreaInclMult[3]		= {	if (Proj:RunScope == 2 .AND. Status == 1) then  TotAreaInclMult[1]  else  0  endif  }
	"Re-calculate Win:TotAreaInclMult[2] - new (not add)"						Win:TotAreaInclMult[2]		= {	if (Status == 3 .AND. IsEAAAddZoneGChild == 0) then  TotAreaInclMult[1]  else  0  endif  }
	"Re-calculate Win:TotAreaInclMult[4] - additions"							Win:TotAreaInclMult[4]		= {	if (IsEAAAddZoneGChild) then  TotAreaInclMult[1]  else  0  endif  }
	"Calculate Win:AreaUfactorMult"													Win:AreaUfactorMult			=     ; SAC 5/19/20 - add check to set only for SkyLts of Conditioned Zones (tic #1221)
      {  if (Status != 1 .AND. IfValidAnd( ParentIsCond > 0 )) then  Area * Multiplier * NFRCUfactor  else  0  endif   }
	"Calculate SkyLt:TotAreaInclMult[1] - total"									SkyLt:TotAreaInclMult[1]		= {	Area * Multiplier  }
	"Calculate SkyLt:TotAreaInclMult[3] - existing"								SkyLt:TotAreaInclMult[3]		= {	if (Proj:RunScope == 2 .AND. Status == 1) then  TotAreaInclMult[1]  else  0  endif  }
	"Calculate SkyLt:TotAreaInclMult[2] - new (not add)"						SkyLt:TotAreaInclMult[2]		= {	if (Status == 3 .AND. IsEAAAddZoneGChild == 0) then  TotAreaInclMult[1]  else  0  endif  }
	"Calculate SkyLt:TotAreaInclMult[4] - additions"							SkyLt:TotAreaInclMult[4]		= {	if (IsEAAAddZoneGChild) then  TotAreaInclMult[1]  else  0  endif  }
	"Calculate SkyLt:AreaUfactorMult"												SkyLt:AreaUfactorMult			=     ; SAC 5/19/20 - add check to set only for SkyLts of Conditioned Zones (tic #1221)
      {  if (Status != 1 .AND. IfValidAnd( ParentIsCond > 0 )) then  Area * Multiplier * NFRCUfactor  else  0  endif   }
	"Sum window area into parent ExtWall objects[1] - total" 	     		ExtWall:TotWinArea[1]		= {	SumChildren( Win:TotAreaInclMult[1] )  }
	"Sum window area into parent ExtWall objects[3] - existing" 	  		ExtWall:TotWinArea[3]		= {	SumChildren( Win:TotAreaInclMult[3] )  }
	"Sum window area into parent ExtWall objects[2] - new (not add)"		ExtWall:TotWinArea[2]		= {	SumChildren( Win:TotAreaInclMult[2] )  }
	"Sum window area into parent ExtWall objects[4] - additions"			ExtWall:TotWinArea[4]		= {	SumChildren( Win:TotAreaInclMult[4] )  }
	"Sum skylight area into parent CCeiling objects[1] - total"				CathedralCeiling:ChildAreaSum[1]		= {	SumChildren( Skylt:TotAreaInclMult[1] )  }
	"Sum skylight area into parent CCeiling objects[3] - existing"			CathedralCeiling:ChildAreaSum[3]		= {	SumChildren( Skylt:TotAreaInclMult[3] )  }
	"Sum skylight area into parent CCeiling objects[2] - new (not add)"	CathedralCeiling:ChildAreaSum[2]		= {	SumChildren( Skylt:TotAreaInclMult[2] )  }
	"Sum skylight area into parent CCeiling objects[4] - additions"		CathedralCeiling:ChildAreaSum[4]		= {	SumChildren( Skylt:TotAreaInclMult[4] )  }
	"Sum window area into parent Zone objects[1] - total"						Zone:TotCondZoneWinArea[1]	= {	if (Type < 10) then  SumChildren( ExtWall:TotWinArea[1] ) + SumChildren( CathedralCeiling:ChildAreaSum[1] ) else  0  endif  }
	"Sum window area into parent Zone objects[3] - existing"    			Zone:TotCondZoneWinArea[3]	= {	if (Type < 10) then  SumChildren( ExtWall:TotWinArea[3] ) + SumChildren( CathedralCeiling:ChildAreaSum[3] ) else  0  endif  }
	"Sum window area into parent Zone objects[2] - new (not add)"			Zone:TotCondZoneWinArea[2]	= {	if (Type < 10) then  SumChildren( ExtWall:TotWinArea[2] ) + SumChildren( CathedralCeiling:ChildAreaSum[2] ) else  0  endif  }
	"Sum window area into parent Zone objects[4] - additions"				Zone:TotCondZoneWinArea[4]	= {	if (Type < 10) then  SumChildren( ExtWall:TotWinArea[4] ) + SumChildren( CathedralCeiling:ChildAreaSum[4] ) else  0  endif  }
	"Sum window area into parent OtherZone objects[1] - total"				OtherZone:TotCondZoneWinArea[1]	= {	if (Type < 10) then  SumChildren( ExtWall:TotWinArea[1] ) + SumChildren( CathedralCeiling:ChildAreaSum[1] ) else  0  endif  }    ; SAC 9/20/19 - OtherZone (MFamProto)
	"Sum window area into parent OtherZone objects[3] - existing"    		OtherZone:TotCondZoneWinArea[3]	= {	if (Type < 10) then  SumChildren( ExtWall:TotWinArea[3] ) + SumChildren( CathedralCeiling:ChildAreaSum[3] ) else  0  endif  }
	"Sum window area into parent OtherZone objects[2] - new (not add)"	OtherZone:TotCondZoneWinArea[2]	= {	if (Type < 10) then  SumChildren( ExtWall:TotWinArea[2] ) + SumChildren( CathedralCeiling:ChildAreaSum[2] ) else  0  endif  }
	"Sum window area into parent OtherZone objects[4] - additions"			OtherZone:TotCondZoneWinArea[4]	= {	if (Type < 10) then  SumChildren( ExtWall:TotWinArea[4] ) + SumChildren( CathedralCeiling:ChildAreaSum[4] ) else  0  endif  }
	"Sum cond zone window across entire model[1] - total"						Proj:TotCondZoneWinArea[1]	= {	SumAll( Zone:TotCondZoneWinArea[1] ) + SumAll( OtherZone:TotCondZoneWinArea[1] )  }
	"Sum cond zone window across entire model[3] - existing"					Proj:TotCondZoneWinArea[3]	= {	SumAll( Zone:TotCondZoneWinArea[3] ) + SumAll( OtherZone:TotCondZoneWinArea[3] )  }
	"Sum cond zone window across entire model[2] - new (not add)"			Proj:TotCondZoneWinArea[2]	= {	SumAll( Zone:TotCondZoneWinArea[2] ) + SumAll( OtherZone:TotCondZoneWinArea[2] )  }
	"Sum cond zone window across entire model[4] - additions"				Proj:TotCondZoneWinArea[4]	= {	SumAll( Zone:TotCondZoneWinArea[4] ) + SumAll( OtherZone:TotCondZoneWinArea[4] )  }
	"Set model's TOTAL win area / cond floor area ratio"		Proj:CondWinAreaCFARat	= {	if (CondFloorArea > 0) then  TotCondZoneWinArea[1] / CondFloorArea  else  0  endif  }

	; SAC 2/20/15 - new rules to set addition window area ratios based on prescriptive additions table
	"Set Proj:CondAddWinAreaCFARat"		Proj:CondAddWinAreaCFARat	= {	if (CondAdditionSize < 0.1) then  0  else  TotCondZoneWinArea[4] / CondAdditionSize  endif  }
	"Set Proj:MaxAddWinAreaCFARat"		Proj:MaxAddWinAreaCFARat	= {	if (CondAdditionSize < 0.1) then  0
																								else  max(	PrescripAdditions_MaxGlazingArea:MaxWinArea(     "AdditionSize", AdditionSize ) / CondAdditionSize,
																												PrescripAdditions_MaxGlazingArea:MaxFracWinArea( "AdditionSize", AdditionSize ) )		endif  }

;	"Set model's cond zone Existing win area multiplier"		Proj:CondExWinAreaMult	= {	if (CondWinAreaCFARat <= 0.2 .OR. CondFloorArea <= 0 .OR. TotCondZoneWinArea[3] <= 0) then  1.0
;																														else if (TotCondZoneWinArea[3] / CondFloorArea <= 0.2) then  1.0
;																														else  0.2 / (TotCondZoneWinArea[3] / CondFloorArea)  endif endif  }
;	"Set model's cond zone New/Altered win area multiplier"	Proj:CondNewWinAreaMult	= {	if (CondWinAreaCFARat <= 0.2 .OR. CondFloorArea <= 0 .OR. TotCondZoneWinArea[2] <= 0) then  1.0
;																														else if (TotCondZoneWinArea[3] > 0 .AND. CondExWinAreaMult < 1.0) then  0.0
;																														else  ((0.2 * CondFloorArea) - (TotCondZoneWinArea[3] / (TotCondZoneWinArea[1] - TotCondZoneWinArea[3]))) endif endif  }
; SAC 7/14/14 - apply same fix to above rules as was applied in BudgetConversion rules 12/31/13 - fixing bug where CondNewWinAreaMult invalid when New win area exceeds limit of 0.2 Win/CFA
; SAC 2/20/15 - revised logic to use floor and window areas that exclude AdditionSize
	"Set model's cond zone Existing win area multiplier"		Proj:CondExWinAreaMult	= {	1.0	}
	"Set model's cond zone New/Altered win area multiplier"	Proj:CondNewWinAreaMult	= {	if (AdditionSize < 0.1)
																														then  if (CondWinAreaCFARat <= 0.2 .OR. (CondFloorArea - CondAdditionSize) <= 0 .OR. TotCondZoneWinArea[2] <= 0) then  1.0
																																else  (0.2 * (CondFloorArea - CondAdditionSize)) / TotCondZoneWinArea[2]  endif
																														else	if (CondAddWinAreaCFARat <= MaxAddWinAreaCFARat .OR. CondAdditionSize <= 0 .OR. TotCondZoneWinArea[4] <= 0) then  1.0
																																else  (MaxAddWinAreaCFARat * CondAdditionSize) / TotCondZoneWinArea[4]  endif
																														endif  }

	"Set Win:WinAreaMult"	Win:WinAreaMult	= {	if (IsNew .OR. IsAltered) then  Proj:CondNewWinAreaMult  else  Proj:CondExWinAreaMult  endif  }

; 	"Debug log message - ExtWall Window Area in Report Sum"			ExtWall:Action		= {	PostMessageToLog( "ExtWall '%s' TotWinArea = %g", Name, TotWinArea[1] )  }

	"Sum window area into parent ExtWall objects"	ExtWall:RptTotWinArea		= {	TotWinArea[1]  }
	"Sum window area into parent Zone objects"		Zone:RptTotCondZoneWinArea	= {	TotCondZoneWinArea[1] }
	"Sum window area into parent OtherZone objects"		OtherZone:RptTotCondZoneWinArea	= {	TotCondZoneWinArea[1] }
	"Sum cond zone window across entire model"		Proj:RptTotCondZoneWinArea	= {	TotCondZoneWinArea[1]  }
	"Set model's win area / cond floor area ratio"	Proj:RptCondWinAreaCFARat	= {	CondWinAreaCFARat  }

; mjb	2/19/14	calculate area-weighted Window U-factor
; SAC 2/24 14 - mod to prevent division by zero (triggered by TDS run T12R02)
	"Calc area-weighted window Ufactor across entire model"			Proj:RptWinAreaWgtUfactor = {
																if (TotCondZoneWinArea[1] <= TotCondZoneWinArea[3]) then  0
																else  ( SumAll( Win:AreaUfactorMult ) + SumAll( Skylt:AreaUfactorMult ) ) / ( TotCondZoneWinArea[1] - TotCondZoneWinArea[3] )  endif  }

; 	"Debug log message - ExtWall Rpt Window Area in Report Sum"			ExtWall:Action		= {	PostMessageToLog( "ExtWall '%s' RptTotWinArea = %g", Name, RptTotWinArea )  }

;--------------------------------------------------------------------
; Building-wide window vent area sums for reporting
;--------------------------------------------------------------------									
	"Set ExtWall:WinVentArea"	ExtWall:WinVentArea	= {	SumChildren( Win:VentArea )  }
	"Set Zone:WinVentArea"		Zone:WinVentArea	= {	SumChildren( ExtWall:WinVentArea )  }
	"Set OtherZone:WinVentArea"	OtherZone:WinVentArea	= {	SumChildren( ExtWall:WinVentArea )  }     ; SAC 9/20/19 - OtherZone (MFamProto)
;--------------------------------------------------------------------
; Building-wide surface area sums for reporting
;--------------------------------------------------------------------									
	"Setup Wall/Window/Door Area Totals"		Proj:Action	= {	EvalRulelist( "SetupWallWindowDoorAreaTotals" )  }
; SAC 2/27/14 - moved following rules into above rulelist so that reporting rules can use the exact same logic
;		"Set ExtWall:AreaByWallType[1] - wood framed"	ExtWall:AreaByWallType[1] = {	if (LocalCompAssigned( Construction ) == 0) then  0	else if (Construction:Type == 0) then  Area  else  0  endif endif  }
;		"Set ExtWall:AreaByWallType[2] - steel framed"	ExtWall:AreaByWallType[2] = {	if (LocalCompAssigned( Construction ) == 0) then  0	else if (Construction:Type == 1) then  Area  else  0  endif endif  }
;		"Set ExtWall:AreaByWallType[3] - concrete/CMU"	ExtWall:AreaByWallType[3] = {	if (LocalCompAssigned( Construction ) == 0) then  0	else if (Construction:Type == 9) then  Area  else  0  endif endif  }
;		"Set ExtWall:WinAreaByWallType[1] - wood framed"	ExtWall:WinAreaByWallType[1]	= {	if (AreaByWallType[1] > 0) then  TotWinArea[1]  else  0  endif  }
;		"Set ExtWall:WinAreaByWallType[2] - steel framed"	ExtWall:WinAreaByWallType[2]	= {	if (AreaByWallType[2] > 0) then  TotWinArea[1]  else  0  endif  }
;		"Set ExtWall:WinAreaByWallType[3] - concrete/CMU"	ExtWall:WinAreaByWallType[3]	= {	if (AreaByWallType[3] > 0) then  TotWinArea[1]  else  0  endif  }
;		"Set ExtWall:TotDoorArea"	ExtWall:TotDoorArea	= {	SumChildren( Door:Area )  }
;		"Set ExtWall:DoorAreaByWallType[1] - wood framed"	ExtWall:DoorAreaByWallType[1]	= {	if (AreaByWallType[1] > 0) then  TotDoorArea  else  0  endif  }
;		"Set ExtWall:DoorAreaByWallType[2] - steel framed"	ExtWall:DoorAreaByWallType[2]	= {	if (AreaByWallType[2] > 0) then  TotDoorArea  else  0  endif  }
;		"Set ExtWall:DoorAreaByWallType[3] - concrete/CMU"	ExtWall:DoorAreaByWallType[3]	= {	if (AreaByWallType[3] > 0) then  TotDoorArea  else  0  endif  }
;	
;	  ; SAC 2/26/14 - added 4th array element rules for all Zone & Garage ExtWall*AreaByWallType[] properties to track TOTALS across all wall types
;		"Set Zone:ExtWallAreaByWallType[1] - wood framed"	Zone:ExtWallAreaByWallType[1]	= {	SumChildren( ExtWall:AreaByWallType[1]    )  }
;		"Set Zone:ExtWallAreaByWallType[2] - steel framed"	Zone:ExtWallAreaByWallType[2]	= {   SumChildren( ExtWall:AreaByWallType[2]    )  }
;		"Set Zone:ExtWallAreaByWallType[3] - concrete/CMU"	Zone:ExtWallAreaByWallType[3]	= {   SumChildren( ExtWall:AreaByWallType[3]    )  }
;		"Set Zone:ExtWallAreaByWallType[4] - total"			Zone:ExtWallAreaByWallType[4] = {   ExtWallAreaByWallType[1] + ExtWallAreaByWallType[2] + ExtWallAreaByWallType[3]  }
;		"Set Zone:ExtWallWinAreaByWallType[1] - wood framed"	Zone:ExtWallWinAreaByWallType[1] = {   SumChildren( ExtWall:WinAreaByWallType[1] )  }
;		"Set Zone:ExtWallWinAreaByWallType[2] - steel framed" Zone:ExtWallWinAreaByWallType[2] = {   SumChildren( ExtWall:WinAreaByWallType[2] )  }
;		"Set Zone:ExtWallWinAreaByWallType[3] - concrete/CMU" Zone:ExtWallWinAreaByWallType[3] = {   SumChildren( ExtWall:WinAreaByWallType[3] )  }
;		"Set Zone:ExtWallWinAreaByWallType[4] - total"			Zone:ExtWallWinAreaByWallType[4] = {   ExtWallWinAreaByWallType[1] + ExtWallWinAreaByWallType[2] + ExtWallWinAreaByWallType[3]  }
;		"Set Zone:ExtWallDoorArea"	Zone:ExtWallDoorArea	= {   SumChildren( ExtWall:TotDoorArea )  }
;	
;		"Set Garage:ExtWallAreaByWallType[1] - wood framed"		Garage:ExtWallAreaByWallType[1]     = {   SumChildren( ExtWall:AreaByWallType[1]    )  }
;		"Set Garage:ExtWallAreaByWallType[2] - steel framed"		Garage:ExtWallAreaByWallType[2]     = {   SumChildren( ExtWall:AreaByWallType[2]    )  }
;		"Set Garage:ExtWallAreaByWallType[3] - concrete/CMU"		Garage:ExtWallAreaByWallType[3]     = {   SumChildren( ExtWall:AreaByWallType[3]    )  }
;		"Set Garage:ExtWallAreaByWallType[4] - total"				Garage:ExtWallAreaByWallType[4]     = {   ExtWallAreaByWallType[1] + ExtWallAreaByWallType[2] + ExtWallAreaByWallType[3]  }
;	;	"Set Garage:ExtWallWinAreaByWallType[1] - wood framed"	Garage:ExtWallWinAreaByWallType[1]  = {   SumChildren( ;ExtWall:WinAreaByWallType[1] )  }
;	;	"Set Garage:ExtWallWinAreaByWallType[2] - steel framed"	Garage:ExtWallWinAreaByWallType[2]  = {   SumChildren( ;ExtWall:WinAreaByWallType[2] )  }
;	;	"Set Garage:ExtWallWinAreaByWallType[3] - concrete/CMU"	Garage:ExtWallWinAreaByWallType[3]  = {   SumChildren( ;ExtWall:WinAreaByWallType[3] )  }
;		"Set Garage:ExtWallDoorAreaByWallType[1] - wood framed"	Garage:ExtWallDoorAreaByWallType[1] = {   SumChildren( ExtWall:DoorAreaByWallType[1] )  }
;		"Set Garage:ExtWallDoorAreaByWallType[2] - steel framed"	Garage:ExtWallDoorAreaByWallType[2] = {   SumChildren( ExtWall:DoorAreaByWallType[2] )  }
;		"Set Garage:ExtWallDoorAreaByWallType[3] - concrete/CMU"	Garage:ExtWallDoorAreaByWallType[3] = {   SumChildren( ExtWall:DoorAreaByWallType[3] )  }
;		"Set Garage:ExtWallDoorAreaByWallType[4] - total"			Garage:ExtWallDoorAreaByWallType[4] = {   ExtWallDoorAreaByWallType[1] + ExtWallDoorAreaByWallType[2] + ExtWallDoorAreaByWallType[3]  }

	"Set Zone:ExtWallArea"				Zone:ExtWallArea				= {	SumChildren( ExtWall:Area )  }
	"Set Zone:UndWallArea"				Zone:UndWallArea				= {	SumChildren( UndWall:Area )  }
	"Set Zone:ClgBlwAtticArea"			Zone:ClgBlwAtticArea			= {	SumChildren( CeilingBelowAttic:Area )  }
	"Set Zone:CathCeilingArea"			Zone:CathCeilingArea			= {	SumChildren( CathedralCeiling:Area )  }
	"Set Zone:CondClgBlwAtticArea"	Zone:CondClgBlwAtticArea	= {	if (Type < 10) then  ClgBlwAtticArea  else  0  endif  }
	"Set Zone:SlabFloorArea"			Zone:SlabFloorArea			= {	SumChildren( SlabFloor:Area )  }
	"Set Zone:UndFloorArea"				Zone:UndFloorArea				= {	SumChildren( UndFloor:Area )  }
	"Set Zone:ExtFloorArea"				Zone:ExtFloorArea 			= {	SumChildren( ExteriorFloor:Area ) + SumChildren( FloorOverCrawl:Area )  }
	"Set Zone:FlrOverUncondZnArea"	Zone:FlrOverUncondZnArea	= {	SumChildren( InteriorFloor:ParCndZnAdjUZnArea )  }
	"Set Zone:AdjUncondZnWallArea"	Zone:AdjUncondZnWallArea	= {	SumChildren( IntWall:ParCndZnAdjUZnArea ) + SumRevRef( IntWall:Outside, IntWall:ParUZnAdjCndZnArea )	}
	"Set Zone:AdjUncondZnArea"		   Zone:AdjUncondZnArea		   = {	AdjUncondZnWallArea + SumChildren( InteriorFloor:ParCndZnAdjUZnArea ) +
                                                                     SumRevRef( InteriorCeiling:Outside, InteriorCeiling:ParUZnAdjCndZnArea ) +
                                                                     SumRevRef( InteriorFloor:Outside,   InteriorFloor:ParUZnAdjCndZnArea )	}

	"Set OtherZone:ExtWallArea"			OtherZone:ExtWallArea			= {	SumChildren( ExtWall:Area )  }            ; SAC 9/20/19 - OtherZone (MFamProto)
	"Set OtherZone:UndWallArea"			OtherZone:UndWallArea			= {	SumChildren( UndWall:Area )  }
	"Set OtherZone:ClgBlwAtticArea"		OtherZone:ClgBlwAtticArea		= {	SumChildren( CeilingBelowAttic:Area )  }
	"Set OtherZone:CathCeilingArea"		OtherZone:CathCeilingArea		= {	SumChildren( CathedralCeiling:Area  )  }
	"Set OtherZone:CondClgBlwAtticArea"	OtherZone:CondClgBlwAtticArea	= {	if (Type < 10) then  ClgBlwAtticArea  else  0  endif  }
	"Set OtherZone:SlabFloorArea"			OtherZone:SlabFloorArea			= {	SumChildren( SlabFloor:Area )  }
	"Set OtherZone:UndFloorArea"			OtherZone:UndFloorArea			= {	SumChildren( UndFloor:Area )  }
	"Set OtherZone:ExtFloorArea"			OtherZone:ExtFloorArea 			= {	SumChildren( ExteriorFloor:Area ) + SumChildren( FloorOverCrawl:Area )  }
	"Set OtherZone:AdjUncondZnWallArea"	OtherZone:AdjUncondZnWallArea	= {	SumChildren( IntWall:ParCndOZnAdjUZnArea) + SumRevRef( IntWall:Outside, IntWall:ParUZnAdjCndOZnArea )	}
	"Set OtherZone:AdjUncondZnArea"	   OtherZone:AdjUncondZnArea	   = {	AdjUncondZnWallArea + SumChildren( InteriorFloor:ParCndOZnAdjUZnArea ) +
                                                                           SumRevRef( InteriorCeiling:Outside, InteriorCeiling:ParUZnAdjCndOZnArea ) +
                                                                           SumRevRef( InteriorFloor:Outside,   InteriorFloor:ParUZnAdjCndOZnArea )	}

	"Set Proj:BldgExtWallArea"			Proj:BldgExtWallArea			= {	SumAll( Zone:ExtWallArea     )  }
	"Set Proj:BldgClgBlwAtticArea"	Proj:BldgClgBlwAtticArea	= {	SumAll( Zone:ClgBlwAtticArea )  }
	"Set Proj:BldgCathCeilingArea"	Proj:BldgCathCeilingArea	= {	SumAll( Zone:CathCeilingArea )  }
	"Set Proj:BldgExtFloorArea"		Proj:BldgExtFloorArea		= {	SumAll( Zone:ExtFloorArea    )  }
;	"Set Proj:BldgSlabFloorArea"		Proj:BldgSlabFloorArea		= {	SumAll( Zone:SlabFloorArea   )  }
;	"Set Proj:CptSlabFloorArea"		Proj:CptSlabFloorArea		= {	SumAll( SlabFloor:CarpetedArea )  }
;	"Set Proj:ExpSlabFloorArea"		Proj:ExpSlabFloorArea		= {	SumAll( SlabFloor:ExposedArea  )  }
	"Set Proj:BldgUndWallArea"			Proj:BldgUndWallArea			= {	SumAll( Zone:UndWallArea     ) + SumAll( OtherZone:UndWallArea )  }   ; SAC 7/11/20 - only used here for reporting, so no need to store separate 'OZ' version
	"Set Proj:BldgZnAdjUZnArea"		Proj:BldgZnAdjUZnArea	   = {   SumAll( Zone:AdjUncondZnArea )  }     ; SAC 11/30/20
	"Set Proj:BldgOZExtWallArea"			Proj:BldgOZExtWallArea			= {	SumAll( OtherZone:ExtWallArea     )  }    ; SAC 7/10/20
	"Set Proj:BldgOZClgBlwAtticArea" 	Proj:BldgOZClgBlwAtticArea 	= {	SumAll( OtherZone:ClgBlwAtticArea )  }
	"Set Proj:BldgOZCathCeilingArea" 	Proj:BldgOZCathCeilingArea 	= {	SumAll( OtherZone:CathCeilingArea )  }
	"Set Proj:BldgOZExtFloorArea" 		Proj:BldgOZExtFloorArea 		= {	SumAll( OtherZone:ExtFloorArea    )  }
	"Set Proj:BldgOZSlabFloorArea"		Proj:BldgOZSlabFloorArea		= {	SumAll( OtherZone:SlabFloorArea   )  }
	"Set Proj:BldgOZCondZnSlabFlrArea"	Proj:BldgOZCondZnSlabFlrArea	= {   SumAcrossif( OtherZone:SlabFloorArea, OtherZone:Type < 10 )  }
	"Set Proj:BldgOZAdjUZnArea"		   Proj:BldgOZAdjUZnArea	      = {   SumAll( OtherZone:AdjUncondZnArea )  }      ; SAC 11/30/20

   ; moved over to defaulting rules - SAC 7/12/20
	;"Set ExtWall:Azimuth"		ExtWall:Azimuth	= {	ExtWall:OrientationValue + Proj:FrontOrientation  }
	;"Correct Azimuth for radial deg"			ExtWall:Azimuth	= {	if ( ExtWall:Azimuth >= 360 ) then ExtWall:Azimuth - 360
	;														else UNCHANGED endif  }
;	mjb-10/9/13	added azimuth calc for underfloor walls and cathedral ceilings
;	"Set UndWall:Azimuth"		UndWall:Azimuth	= {	UndWall:OrientationValue + Proj:FrontOrientation  }
;	"Correct Azimuth for radial deg"	UndWall:Azimuth	= {	if ( Azimuth >= 360 ) then Azimuth - 360
;										else UNCHANGED endif  }
	"Set CathedralCeiling:Azimuth"		CathedralCeiling:Azimuth	= {	CathedralCeiling:OrientationValue + Proj:FrontOrientation  }
	"Correct Azimuth for radial deg"	CathedralCeiling:Azimuth	= {	if ( Azimuth >= 360 ) then Azimuth - 360
												else UNCHANGED endif  }

;	mjb	2/19/14 added fenestration level Azimuth for CF1R reporting only
	"Set Win:Azimuth"		Win:Azimuth		=	{	Parent( Azimuth )	}
	"Set SkyLt:Azimuth"	Skylt:Azimuth	=	{	Parent( Azimuth )	}

;--------------------------------------------------------------------
; rules below this were picked out of HERS/Special features to perform misc model summarization
;--------------------------------------------------------------------

; SAC 9/10/13 - moved setting of Cons:AssignedCondZoneArea up here from below to define BEFORE first reference
;	mjb	8/21/14	- used ZoneArea/FloorAreaOverCond to keep track of surface areas only in conditioned zones
	"Sum Cons Surface Areas"			Cons:AssignedCondZoneArea = { switch ( CanAssignTo )
											case  0: SumRevRef( ExtWall:Construction, ExtWall:ZoneArea )
											case 20: SumRevRef( UndWall:Construction, UndWall:ZoneArea )
											case  1: SumRevRef( Attic:Construction, Attic:FloorAreaOverCond )
											case  2: SumRevRef( CathedralCeiling:Construction, CathedralCeiling:ZoneArea )
											case  3: SumRevRef( CeilingBelowAttic:Construction, CeilingBelowAttic:ZoneArea )
											case  6: SumRevRef( InteriorCeiling:Construction, InteriorCeiling:ZoneArea )
											case  4: SumRevRef( InteriorFloor:Construction, InteriorFloor:ZoneArea )
											case  5: SumRevRef( ExteriorFloor:Construction, ExteriorFloor:ZoneArea )
											case  9: SumRevRef( FloorOverCrawl:Construction, FloorOverCrawl:ZoneArea )
											default: 0
										     endswitch }
	"Sum Cons Demising Areas"			Cons:AssignedDemisingArea = { switch ( CanAssignTo )
											case  4: SumRevRef( InteriorFloor:Construction, InteriorFloor:DemisingArea )
											case 10: SumRevRef( IntWall:Construction, IntWall:DemisingArea )
											case  6: SumRevRef( InteriorCeiling:Construction, InteriorCeiling:DemisingArea )		; SAC 11/21/14
											default: 0
										     endswitch }

	"Set Proj:BldgSlabFloorArea"			Proj:BldgSlabFloorArea	= { SumAll( Zone:SlabFloorArea   )  }
	"Set Proj:BldgCondZnSlabFlrArea"		Proj:BldgCondZnSlabFlrArea	= { SumAcrossif( Zone:SlabFloorArea, Zone:Type < 10 ) + SumAcrossif( OtherZone:SlabFloorArea, OtherZone:Type < 10 )  }		; SAC 9/10/13
	"Set Proj:BldgCondZnUndFlrArea"		Proj:BldgCondZnUndFlrArea	= { SumAcrossif( Zone:UndFloorArea,  Zone:Type < 10 ) + SumAcrossif( OtherZone:UndFloorArea,  OtherZone:Type < 10 )  }		; SAC 11/20/14 - 
	"Set Proj:CptSlabFloorArea"			Proj:CptSlabFloorArea	= { SumAll( SlabFloor:CarpetedArea )  }
; revise ExpSlabFloorArea to report only conditioned zone exposed slab area - SAC 9/10/13
;	"Set Proj:ExpSlabFloorArea"			Proj:ExpSlabFloorArea	= { SumAll( SlabFloor:ExposedArea  )  }
	"Set Proj:ExpSlabFloorArea"			Proj:ExpSlabFloorArea	= { SumAll( SlabFloor:CondZnExposedArea  )  }

	"Set Proj:CptUndFloorArea"			Proj:CptUndFloorArea			= {	SumAll( UndFloor:CarpetedArea )  }		; SAC 11/20/14 - 
	"Set Proj:ExpUndFloorArea"			Proj:ExpUndFloorArea			= {	SumAll( UndFloor:ExposedArea  )  }

	; SAC 6/21/16 - set SCSysRptDUCount[*] to ensure proper SCSysRpt:ReferenceCount setting (tic #688)
	"Set DwellUnitType:SCSysRptDUCount[1]"		DwellUnitType:SCSysRptDUCount[1]		= {	if (LocalStatus( SCSysRptCount[1] ) < 1) then  UNDEFINED
																													else    ValidOr( SCSysRptCount[1], 0 ) * ValidOr( NumAssigningDUs, 0 )  endif  }
	"Set DwellUnitType:SCSysRptDUCount[2]"		DwellUnitType:SCSysRptDUCount[2]		= {	if (LocalStatus( SCSysRptCount[2] ) < 1) then  UNDEFINED
																													else    ValidOr( SCSysRptCount[2], 0 ) * ValidOr( NumAssigningDUs, 0 )  endif  }
	"Set DwellUnitType:SCSysRptDUCount[3]"		DwellUnitType:SCSysRptDUCount[3]		= {	if (LocalStatus( SCSysRptCount[3] ) < 1) then  UNDEFINED
																													else    ValidOr( SCSysRptCount[3], 0 ) * ValidOr( NumAssigningDUs, 0 )  endif  }
	"Set DwellUnitType:SCSysRptDUCount[4]"		DwellUnitType:SCSysRptDUCount[4]		= {	if (LocalStatus( SCSysRptCount[4] ) < 1) then  UNDEFINED
																													else    ValidOr( SCSysRptCount[4], 0 ) * ValidOr( NumAssigningDUs, 0 )  endif  }
	"Set DwellUnitType:SCSysRptDUCount[5]"		DwellUnitType:SCSysRptDUCount[5]		= {	if (LocalStatus( SCSysRptCount[5] ) < 1) then  UNDEFINED
																													else    ValidOr( SCSysRptCount[5], 0 ) * ValidOr( NumAssigningDUs, 0 )  endif  }
	"Set DwellUnitType:SCSysRptDUCount[6]"		DwellUnitType:SCSysRptDUCount[6]		= {	if (LocalStatus( SCSysRptCount[6] ) < 1) then  UNDEFINED
																													else    ValidOr( SCSysRptCount[6], 0 ) * ValidOr( NumAssigningDUs, 0 )  endif  }
	"Set DwellUnitType:SCSysRptDUCount[7]"		DwellUnitType:SCSysRptDUCount[7]		= {	if (LocalStatus( SCSysRptCount[7] ) < 1) then  UNDEFINED
																													else    ValidOr( SCSysRptCount[7], 0 ) * ValidOr( NumAssigningDUs, 0 )  endif  }
	"Set DwellUnitType:SCSysRptDUCount[8]"		DwellUnitType:SCSysRptDUCount[8]		= {	if (LocalStatus( SCSysRptCount[8] ) < 1) then  UNDEFINED
																													else    ValidOr( SCSysRptCount[8], 0 ) * ValidOr( NumAssigningDUs, 0 )  endif  }
	"Set DwellUnitType:SCSysRptDUCount[9]"		DwellUnitType:SCSysRptDUCount[9]		= {	if (LocalStatus( SCSysRptCount[9] ) < 1) then  UNDEFINED
																													else    ValidOr( SCSysRptCount[9], 0 ) * ValidOr( NumAssigningDUs, 0 )  endif  }
	"Set DwellUnitType:SCSysRptDUCount[10]"	DwellUnitType:SCSysRptDUCount[10]	= {	if (LocalStatus( SCSysRptCount[10] ) < 1) then  UNDEFINED
																													else    ValidOr( SCSysRptCount[10], 0 ) * ValidOr( NumAssigningDUs, 0 )  endif  }
;	; SAC 6/21/16 - set SCSysRptDUCount[*] to ensure proper SCSysRpt:ReferenceCount setting (tic #688)
;	"Setup HVAC equipment counts"		Proj:Action		= {	if (IsMultiFamily > 0.5)
;																			then	EvalRulelist( "Reporting_SummarizeModel_HVACEquip_MFam" )
;																			else	EvalRulelist( "Reporting_SummarizeModel_HVACEquip_SFam" )  endif  }
END
;*************************************************************************


; SAC 10/22/14 - split out HERS/Special features rules out of 'Reporting_SummarizeModel' and into this new rulelist 'Reporting_HERS_SpecialFeaturesSummary'
;*************************************************************************
RULELIST  "Reporting_HERS_SpecialFeaturesSummary" 1 0 0 0
;*************************************************************************

;--------------------------------------------------------------------
; Create lists of Special Features and HERS Verification measures for reporting
;	mjb	2/20/14	populate HERSSummary array of messages
;--------------------------------------------------------------------
;
; some Project level HERS Verifications
;
	"Ensure Proj:HERSProj exists"		Proj:Action	= {	if (LocalCompAssigned( HERSProj )) then  UNCHANGED
												else  EvalRulelist( "CreateAndAssignAsUserDefined_Proj_HERSOther", 1 )  endif  }

	"Check for Exist. Conditions Verification" 	Proj:HERSProj:VerifyExistCond = { if ( ExistingCondVerif > 0.5 ) then 1 else 0 endif }
	"Populate Ex. Conditions Verification msg"	Proj:HERSProj:ExCondRptMsg = { if ( HERSProj:VerifyExistCond > 0.5 ) then 1 else 0 endif }

	"Check for QII" 				Proj:HERSProj:QII = { if ( Project:InsulConsQuality > 1.5 ) then 1 else 0 endif }
	"Populate QII msg"				Proj:HERSProj:QIIRptMsg = { if ( HERSProj:QII > 0.5 ) then 1 else 0 endif }

; SAC 9/4/13 - added logic to fix ACH50 defaulting bug (GC issue 169)
;	"Check for Low Bldg Leakage" 			Proj:HERSProj:LowBldgLkg = { if ( Project:ACH50 < 5.0 ) then 1 else 0 endif }
;  mjb   9/15/14  - no bldg leakage verifications for multi-family
;	"Check for Low Bldg Leakage" 			Proj:HERSProj:LowBldgLkg = { if ( ( Proj:IsMultiFamily > 0.5 .AND. Project:ACH50 < 7.0 ) .OR.
;																								 ( Proj:IsMultiFamily < 0.5 .AND. Project:ACH50 < 5.0 ) ) then 1 else 0 endif }

; mjb 1/30/15 - mod to lookup std. ACH50 from T24RClimateZoneCodeBase
;	"Check for Low Bldg Leakage" 			Proj:HERSProj:LowBldgLkg = { if ( Proj:IsMultiFamily < 0.5 .AND. Project:ACH50 < 5.0 ) then 1 else 0 endif }
; SAC 4/15/15 - adjust for MFam duplex/townhomes options (based on Proj:IsMFamDupOrTownhm)
; SAC 5/3/16 - revised to check ACH50 vs. default that takes into account presence of VLLDCS (low-lkg ducts) (tic #627)
	"Check for Low Bldg Leakage" 			Proj:HERSProj:LowBldgLkg = { if ( (Proj:IsMultiFamily < 0.5 .OR. Proj:IsMFamDupOrTownhm > 0.5) .AND.
																								  Project:ACH50 < Proj:DefaultACH50 ) then 1 else 0 endif }
																						;		  Project:ACH50 < T24RClimateZoneCodeBase:ACH50( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ) then 1 else 0 endif }
	"Write Low Bldg Leakage Msg" 			Proj:HERSProj:LowBldgLkgRptMsg = { if ( HERSProj:LowBldgLkg > 0.5 ) then FltToStr( Proj:CFM50, 1, 0, 3 ) else UNCHANGED endif }

;	mjb	 mod to always set HERS IAQ flag to 1	9/12/13
;	mjb	mode to conditionally set HERS IAQ flag	6/17/14
	; SAC 12/29/14 - mod to ensure IAQFanRptMsg & IAQFan are set for case where RunScope = 'Addition and/or Alteration' (2) & AdditionCFA >= 1000
	; SAC 4/30/19 - modify logic to ensure that HERS IAQ fan message is triggered for all 2019+ models including an (SFam) ADU (tic #1071)
	"Populate IAQ Fan msg"							Proj:HERSProj:IAQFanRptMsg  = {
	         if (EnergyCodeYearNum >= 2019 .AND. IfValidAnd( SFamADUIAQUI > 0 )) then  1
	         else if ( Proj:RunScope == 1 ) then 
					if ( IsAddAlone == 0 ) then  1 
					else if ( AdditionCFA > 1000 ) then  1  else  0  endif endif
				else if (RunScope == 2 .AND. IfValidAnd( AdditionCFA > 1000 )) then  1
				else  0  endif endif endif   }
	"IAQ Fan - flag set same as msg" 		   Proj:HERSProj:IAQFan = {  HERSProj:IAQFanRptMsg  	}	
	"Check for Centrally Integrated IAQ" 		Proj:HERSProj:CentralIAQ = { if (IfValidAnd( IsMultiFamily < 0.5 ) .AND. Project:UnitIAQOption[1] == 3 ) then 1 else 0 endif }

	"Populate Central IAQ msg"			Proj:HERSProj:CIAQRptMsg = { if (IfValidAnd( HERSProj:CentralIAQ > 0.5 )) then 1 else 0 endif }

   "Populate KitRangeHood flag"     Proj:HERSProj:KitRangeHood =        ; SAC 10/29/19 - removed logic causing ALL New-NonAdditionAlone model from being flagged as having Kitchen (tic #1162)
      {  if (IfValidAnd( ProjInclKitchen > 0 )) then  1  else  0  endif  }     ; SAC 3/8/19 (tic #1085)
	"Populate KitRangeHood msg"      Proj:HERSProj:KitRangeHoodMsg = { if (IfValidAnd( HERSProj:KitRangeHood > 0.5 )) then 1 else 0 endif }

	"Check for Fan Efficacy if CI-IAQ"		Proj:HERSFan:AHUFanEff = { if (IfValidAnd( HERSProj:CentralIAQ > 0.5 )) then 1 else 0 endif }
;	"Check for Cool Vent System"			Proj:HERSProj:CoolVent = { if (IfValidAnd( UnitClVentNumFans[1] > 0.5 )) then 1 else 0 endif }
;	"Check for Cool Vent System"			Proj:HERSProj:CoolVent = { if (IfValidAnd( UnitClVentNumFans[2] > 0.5 )) then 1 else UNCHANGED endif }
;	"Check for Cool Vent System"			Proj:HERSProj:CoolVent = { if (IfValidAnd( UnitClVentNumFans[3] > 0.5 )) then 1 else UNCHANGED endif }
;	"Check for Cool Vent System"			Proj:HERSProj:CoolVent = { if (IfValidAnd( UnitClVentNumFans[4] > 0.5 )) then 1 else UNCHANGED endif }
;	"Check for Cool Vent System"			Proj:HERSProj:CoolVent = { if (IfValidAnd( UnitClVentNumFans[5] > 0.5 )) then 1 else UNCHANGED endif }
;	"Check for Cool Vent System"			Proj:HERSProj:CoolVent = { if (IfValidAnd( UnitClVentNumFans[6] > 0.5 )) then 1 else UNCHANGED endif }
;	"Populate Cool Vent msg"			Proj:HERSProj:CoolVentRptMsg = { if (IfValidAnd( HERSProj:CoolVent > 0.5 )) then 1 else 0 endif }

   ; SAC 11/5/17 - added VerifyClVent & VerifyClVentRptMsg for 2019 analysis (tic #920)
   ; SAC 2/14/18 - revised to always report new HERS message for CFI ClVent (tic #977)
   ; SAC 4/30/19 - added logic to force HERS verif on for 'Specify Individual Whole House Fans' (tic #1023)
   ; JP  7/29/19 - added logic to prevent HERS verif on ClVentVerified = 1 AND UnitClVentOption = 0 condition (tic #1091)
	"Check for Verified ClVent"		Proj:HERSProj:VerifyClVent       = {
         if (EnergyCodeYearNum < 2019 .OR. IsMultiFamily > 0.5) then  0
         else if (UnitClVentOption = 3 .OR. UnitClVentOption = 2) then  1
         else if (ClVentVerified = 0 .OR. UnitClVentOption = 0 .OR. IfValidAnd( UnitClVentCFM[1] <0.5))
         then  0  else  1  endif endif endif  }
   ; SAC 7/24/19 - added logic to expand 2019+ HERS messages to include Fixed vs. Variable CFI coolvent (tic #1104)
	"Populate Verified ClVent Msg"	Proj:HERSProj:VerifyClVentRptMsg = {
         if (IfValidAnd( HERSProj:VerifyClVent > 0.5 ))
         then  if (UnitClVentOption = 3)
               then  if (SumAll( HVACSys:IsVariableCFIClVent ) > 0)
                     then  3
                     else  2  endif
               else  1  endif  
         else  0  endif }

	"Check for Zonal Cooling"			Proj:HERSProj:ZonalCoolSys = { if ( Maxall( HVACSys:CoolSystem:IsZonal ) > 0.5 ) then 1 else 0 endif }
	"Populate Zonal Cooling"			Proj:HERSProj:ZonalRptMsg = { if (IfValidAnd( HERSProj:ZonalCoolSys > 0.5 )) then 1 else 0 endif }
	; SAC 5/3/16 - added project-wide HERS ZonalSysBypassDuct (tic #634)
	"Check for Zonal systems w/ Bypass Ducts within Proj"		Proj:HERSProj:ZonalSysBypassDuct = { if ( MaxAll( HVACSys:ZonalSysBypassDuct ) > 0.5 ) then 1 else 0 endif }
	"Write Proj Zonal systems w/ Bypass Ducts msg" 				Proj:HERSProj:ZonalSysBypassDuctRptMsg = { if (MaxAll( HVACSys:ZonalSysBypassDuct ) > 0.5) then "Bypass duct conditions in zonal system(s)" else UNDEFINED endif }

	"Check for non-std Spray Foam Ins" 		Cons:RptNonStd = { if (IfValidAnd( AssignedCondZoneArea > 0.5 ) .AND. IfValidAnd( NonStdSprayFoam > 0.5 )) then 1 else 0 endif }
	"Check for High Spray Foam R-values"		Proj:HERSProj:SprayFoamHighR = { if ( SumAll( Cons:RptNonStd ) > 0.5 ) then 1 else 0 endif }
	"Populate High Spray Foam msg"			Proj:HERSProj:SprayFoamRptMsg = { if (IfValidAnd( HERSProj:SprayFoamHighR > 0.5 )) then 1 else 0 endif }

; SAC 3/9/17 - property to help ensure that HERS is triggered project-wide for certain combinations of HVACCool & HVACDist Status settings (tic #764)
   "Set HVACSys:IsAltSrvdDucted - whether this system is altered and ducted (and assigned to floor area)"
      HVACSys:IsAltSrvdDucted  = {
         if (IfValidAnd( FloorAreaServed > 0.5 )==0 .OR. Status != 2 .OR.
             IfValidAnd( HtOrClDucted > 0 )==0 .OR. LocalCompAssigned( DistribSystem )==0)
         then  0  else  1  endif  }
   ; added logic to check 40' for <2022 codes and 25' for 2022+ - SAC 09/23/22 (tic #1296)
   "Set HVACSys:TriggerHERS"        HVACSys:TriggerHERS  = {
         if (IsAltSrvdDucted > 0 .AND.
             ( DistribSystem:Status == 1 .OR.
              (DistribSystem:Status == 4 .AND. 
               ( (Proj:StdDesignBase <  2022 .AND. IfValidAnd( DistribSystem:IsLessThanFortyFt > 0 )) .OR.
                 (Proj:StdDesignBase >= 2022 .AND. IfValidAnd( DistribSystem:IsLessThan25Ft    > 0 )) )) ))
         then  1  ; ensure HERS is triggered for Altered systems w/ Existing or Exist+New < 40 combos
         else  0  endif  }
   ; added logic to check 40' for <2022 codes and 25' for 2022+ - SAC 09/23/22 (tic #1296)
   "Set HVACSys:DuctStatusFlag[1]"     HVACSys:DuctStatusFlag[1]  = {
         if (IfValidAnd( FloorAreaServed > 0.5 )==0 .OR. 
             IfValidAnd( HtOrClDucted > 0 )==0 .OR. LocalCompAssigned( DistribSystem )==0) then  0
         else if (DistribSystem:Status == 4)  ; "Existing + New"
         then  if ( (Proj:StdDesignBase <  2022 .AND. DistribSystem:IsLessThanFortyFt) .OR.
                    (Proj:StdDesignBase >= 2022 .AND. DistribSystem:IsLessThan25Ft   ) ) then  4  else  5  endif
         else  DistribSystem:Status
         endif endif  }
   "Set HVACSys:DuctStatusFlag[2]"   HVACSys:DuctStatusFlag[2]  = {  DuctStatusFlag[1]  }
   "Set HVACSys:DuctStatusFlag[3]"   HVACSys:DuctStatusFlag[3]  = {  DuctStatusFlag[1]  }
   "Set HVACSys:DuctStatusFlag[4]"   HVACSys:DuctStatusFlag[4]  = {  DuctStatusFlag[1]  }
   "Set HVACSys:DuctStatusFlag[5]"   HVACSys:DuctStatusFlag[5]  = {  DuctStatusFlag[1]  }
   "Set HVACSys:DuctStatusFlag[6]"   HVACSys:DuctStatusFlag[6]  = {  DuctStatusFlag[1]  }
   "Set HVACSys:DuctStatusFlag[7]"   HVACSys:DuctStatusFlag[7]  = {  DuctStatusFlag[1]  }
   "Set HVACSys:DuctStatusFlag[8]"   HVACSys:DuctStatusFlag[8]  = {  DuctStatusFlag[1]  }
   "Set HVACSys:DuctStatusFlag[9]"   HVACSys:DuctStatusFlag[9]  = {  DuctStatusFlag[1]  }
   "Set HVACSys:DuctStatusFlag[10]"  HVACSys:DuctStatusFlag[10] = {  DuctStatusFlag[1]  }

;
; HVAC HERS Verification measures
;	mjb	mods needed to make work with HERSCool, HERSDist and HERSFan	9/1/13
;	mjb	add HERS flags to HVACHtPump objects	9/1/13
;  mjb	do not produce HVAC Cooling verification requirements when there is no cooling or no ducts	2/19/14
;	mjb	do not produce HVAC verification reqs. when equipment does not match what was modeled for Prop. Design	4/17/14
;
	"Ensure HVACCool:HERSCheck exists"			HVACCool:Action	= {	if (LocalCompAssigned( HERSCheck )) then  UNCHANGED
																							else if (FloorAreaServed > 0.5) then 
																										EvalRulelist( "CreateAndAssignAsUserDefined_HVACCool_HERSCool", 1 )
																									else UNCHANGED endif
																							endif  }
   ; SAC 5/10/19 - added logic to create and populate HERSHtPump object for 2019 models
	"Ensure HVACHtPump:HERSCheck exists"		HVACHtPump:Action = {	if (LocalCompAssigned( HERSCheck ) .OR. LocalCompAssigned( HERSHtPumpRef )) then  UNCHANGED
																							else if (FloorAreaServed > 0.5)
																							then  if (Proj:EnergyCodeYearNum < 2019)
																							      then  EvalRulelist( "CreateAndAssignAsUserDefined_HVACHtPump_HERSCool", 1 )
																							      else  EvalRulelist( "CreateAndAssignAsUserDefined_HVACHtPump_HERSHtPump", 1 )  endif
																							else UNCHANGED endif
																							endif  }
	"Ensure HVACHtPump:HERSHeatRef exists"		HVACHtPump:Action = {	if (LocalCompAssigned( HERSHeatRef )) then  UNCHANGED
																							else if (FloorAreaServed > 0.5 .AND. Proj:EnergyCodeYearNum < 2019)
																					      then  EvalRulelist( "CreateAndAssignAsUserDefined_HVACHtPump_HERSHeatRef", 1 )
																							else UNCHANGED endif
																							endif  }    ; SAC 3/18/19
	"Ensure HVACDist:HERSCheck exists"			HVACDist:Action	= {	if (LocalCompAssigned( HERSCheck )) then  UNCHANGED
																							else if (FloorAreaServed > 0.5) then 
																										EvalRulelist( "CreateAndAssignAsUserDefined_HVACDist_HERSDist", 1 )
																									else UNCHANGED endif
																							endif  }
	; SAC 12/22/14 - revised logic to reference new HVACFan:ClFlrAreaServed property instead of FloorAreaServed since this flag only pertains to Fans for Cooling (GC issue 450)
	"Ensure HVACFan:HERSCheck exists"			HVACFan:Action	= {	if (LocalCompAssigned( HERSCheck )) then  UNCHANGED
																						else if (IfValidAnd( ClFlrAreaServed > 0.5 )) then 
																									EvalRulelist( "CreateAndAssignAsUserDefined_HVACFan_HERSFan", 1 )
																								else UNCHANGED endif
																						endif  }
;	"debug"		HVACSys:Action	= {	MessageBox( "reporting -- HVACFan '%s':  Fan:TypeRpt = %g", Name, Fan:TypeRpt )  }
; mjb	6/2/14	- add checks for No Cooling within HERSCool parameter assignments
;	mjb	7/17/14	modify Fan watt check to set flag only for ducted systems, and set flag regardless of No Cooling system selection
;	mjb	10/30/14	- mods to make all reporting rules work without special reporting parameters that are no longer needed because of improved project model reporting
;	"Check for Watts per CFM" 						HVACFan:HERSCheck:AHUFanEff = { if ( FloorAreaServed > 0.5 .AND. MaxRevRef( HVACSys:Fan, HVACSys:NoCoolingRpt ) < 0.5 .AND. IfValidAnd(TypeRpt > 0.5) .AND. Status != 1 ) then 1 else 0 endif }
;	"Check for Watts per CFM" 						HVACFan:HERSCheck:AHUFanEff = { if ( FloorAreaServed > 0.5 .AND. MaxRevRef( HVACSys:Fan, HVACSys:CoolDuctedRpt ) > 0.5 .AND. Status != 1 ) then 1 else 0 endif }
;	"Check for Watts per CFM" 						HVACFan:HERSCheck:AHUFanEff = { if ( FloorAreaServed > 0.5 .AND. Status != 1 ) then 1 else 0 endif }
; SAC 8/28/16 - revised again to ensure flag NOT set for Altered systems where WperCFMCool >= Mandatory Level (0.58 for 2013-16) (tic #728)
; SAC 3/7/17 - RESTORED mod fixing #728 above, removing -> SAC 2/13/17 - reversed mod listed above to ensure that Altered systems where WperCFMCool >= Mandatory Level ARE in fact flagged for HERs reporting (tic #764)
; SAC 3/14/17 - added logic to ensure AHUFanEff IS set for fans of Alt or Exist HVACSys combined w/ Alt or New Ducts (tic #764, runs 4,5,10,11)
; SAC 3/14/17 - added logic to ensure AHUFanEff NOT set for fans of New HVACSys combined w/ Existing Ducts (tic #764, run #6)
; SAC 7/31/17 - replaced static 0.58 value w/ reference to look-up table for precrip. WperCFM value (tic #882)
; SAC 6/12/18 - added logic to ensure AHUFanEff NOT set for fans of New HVACSys combined w/ Existing+New Ducts (tic #1022, DAR comment 6/7/18)
   "Check for Watts per CFM"                 HVACFan:HERSCheck:AHUFanEff = {
      if ( FloorAreaServed < 0.5) then  0
      else if ( MaxRevRef( HVACSys:Fan, HVACSys:CoolDuctedRpt  ) > 0.5 .AND.
                MaxRevRef( HVACSys:Fan, HVACSys:StatusArray    ) < 2.5 .AND.
                MaxRevRef( HVACSys:Fan, HVACSys:DuctStatusFlag ) < 3.5 .AND.
                MinRevRef( HVACSys:Fan, HVACSys:DuctStatusFlag ) > 1.5 )
      then  1     ; report for fans of Alt or Exist Sys w/ Alt or New Ducts
      else if (Status = 2 .AND. IfValidAnd( WperCFMCool >=        ; 0.58 ))
               T24RClimateZoneCodeBase:WperCFM( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ))
      then  0
      else if (Status == 3 .AND. ( MaxRevRef( HVACSys:Fan, HVACSys:DuctStatusFlag ) < 1.5 .OR.
                                   MaxRevRef( HVACSys:Fan, HVACSys:DuctStatusFlag ) > 3.5 ))
      then  0     ; don't report for fans of New HVACSys combined w/ Existing OR Existing+New Ducts
      else if (Status != 1)
      then  1
      else  0  endif endif endif endif endif  }
	"Write Watts per CFM Msg" 						HVACFan:HERSCheck:FanEffRptMsg = { if ( HERSCheck:AHUFanEff > 0.5 ) then FltToStr( WperCFMCool, 2, 0, 4 ) else UNDEFINED endif }

;	mjb	7/17/14	modify HVACCool airflow check to set flag only for ducted systems, and set flag regardless of No Cooling system selection
;	"Check for CFM per Ton" 						HVACCool:HERSCheck:AHUAirFlow = { 	if ( FloorAreaServed > 0.5 .AND. TypeRpt > 1 .AND. IfValidAnd(IsClSysCFMperTon > 0.5) ) then
;																												if ( Type > 1 .AND. Type < 16 ) then 1 else 0 endif 
;																										  	else 0 endif }
;	"Check for CFM per Ton" 						HVACCool:HERSCheck:AHUAirFlow = { 	if ( FloorAreaServed > 0.5 .AND. IfValidAnd(IsClSysCFMperTon > 0.5) .AND. MaxRevRef( HVACSys:CoolSystem, HVACSys:CoolDuctedRpt ) > 0.5 .AND. MaxRevRef( HVACSys:CoolSystem, HVACSys:Status ) > 1.5 )
;																												then 1 else 0 endif	}
; SAC 11/20/14 - modified logic to prevent setting of airflow flag for system types NoCooling & RoomAirCond (per DAR request to fix problem w/ EnergyPro runs which come through w/ CFMperTon even for NoCooling systems)
; SAC 4/23/15 - added check to ensure that CoolDuctedRpt is set for at least one system that references this equipment
; SAC 8/28/16 - added check to prevent setting HERS air flow for Altered systems where CFMperTon <= 350
; SAC 3/7/17 - RESTORED mod from above, removing -> SAC 2/13/17 - reversed mod listed above to ensure that Altered systems where CFMperTon <= 350 ARE in fact flagged for HERs reporting (tic #764)
; SAC 3/14/17 - added logic to ensure AHUAirFlow IS set for Cool of Alt or Exist HVACSys combined w/ Alt or New Ducts (tic #764, runs 4,5,10,11)
; SAC 3/14/17 - added logic to ensure AHUAirFlow NOT set for Cool of New HVACSys combined w/ Existing Ducts (tic #764, run #6)
; SAC 6/12/18 - added logic to ensure AHUAirFlow NOT set for Cool of New HVACSys combined w/ Existing+New Ducts (tic #1022, DAR comment 6/7/18)
   "Check for CFM per Ton"                   HVACCool:HERSCheck:AHUAirFlow = {
      if ( FloorAreaServed > 0.5 .AND. Type != 1 .AND. Type != 5 .AND.
           MaxRevRef( HVACSys:CoolSystem, HVACSys:CoolDuctedRpt ) > 0.5 .AND.
           ( IfValidAnd( IsClSysCFMperTon > 0.5 ) .OR. 
             ( MaxRevRef( HVACSys:CoolSystem, HVACSys:DuctStatusFlag ) < 3.5 .AND.
               MinRevRef( HVACSys:CoolSystem, HVACSys:DuctStatusFlag ) > 1.5 ) ) )
      then  if ( MaxRevRef( HVACSys:CoolSystem, HVACSys:StatusArray ) < 2.5 .AND.
                 MaxRevRef( HVACSys:CoolSystem, HVACSys:DuctStatusFlag ) < 3.5 .AND.
                 MinRevRef( HVACSys:CoolSystem, HVACSys:DuctStatusFlag ) > 1.5 )
            then  1     ; set reporting flag for Alt or Exist Sys w/ Alt or New Ducts
            else if (MaxRevRef( HVACSys:CoolSystem, HVACSys:StatusArray ) > 1.5)
            then  if (IsAltered > 0 .AND. IsNew < 1 .AND. IsExisting < 1 .AND. IfValidAnd( CFMperTon <= 350 ))
;                      T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ))
                  then  0
                  else if ( MaxRevRef( HVACSys:CoolSystem, HVACSys:StatusArray ) = 3 .AND.
                            ( MaxRevRef( HVACSys:CoolSystem, HVACSys:DuctStatusFlag ) = 1 .OR.
                              MaxRevRef( HVACSys:CoolSystem, HVACSys:DuctStatusFlag ) > 3 ) )
                  then  0     ; not set for New HVACSys combined w/ Existing OR Existing+New Ducts
                  else  1  endif endif
            else  0  endif endif
      else  0  endif   }
   "Write CFM per Ton Msg"                   HVACCool:HERSCheck:AirFlowRptMsg = { if ( HERSCheck:AHUAirFlow > 0.5 ) then FltToStr( CFMperTon, 0, 0, 1 ) else UNDEFINED endif }

  ; SAC 12/6/13 - fix for GC issue #242 - lookup table error when retrieving SEER & EER for certain system types
;	"Check for SEER above Std" 				HVACCool:HERSCheck:SEER = { 	if ( FloorAreaServed  > 0.5 .AND. T24RCoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) .AND. IfValidAnd(IsClSysSEER > 0.5) .AND. TypeRpt > 1 ) then
;																									if (SEER > T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr   ) ) then 1 else 0 endif
;																						 		else  0  endif  }
; SAC 4/23/15 - added logic to NOT flag SEER in HERSCheck if this equipment is not modeled as the user entered it (look-up table PropEqStd = 1)
   ; revised for SEER2 - SAC 09/16/22 (tic #1331)
	"Check for SEER above Std" 				HVACCool:HERSCheck:SEER = { 	if ( FloorAreaServed  > 0.5 .AND. T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) < 0.5 )
                                                                        then  if ( EffMetric < 2 .AND. IfValidAnd(IsClSysSEER > 0.5) .AND.
                                                                                   T24RCoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) )
                                                                              then  if (SEER > ( T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) + 0.005 ) )
                                                                                    then 1 else 0 endif
                                                                              else  0  endif
																						 		else  0  endif  }
	"Write SEER above Std Msg" 				HVACCool:HERSCheck:SEERRptMsg = { if ( HERSCheck:SEER > 0.5 ) then FltToStr( SEER, 1, 0, 4 ) else UNDEFINED endif }
   ; added separate properties & rules for SEER2 (vs. SEER) - SAC 09/22/22 (tic #1286)
	"Check for SEER2 above Std" 				HVACCool:HERSCheck:SEER2 = { 	if ( FloorAreaServed  > 0.5 .AND. T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) < 0.5 )
                                                                        then  if ( EffMetric = 2 .AND. IfValidAnd(IsClSysSEER > 0.5) .AND.
                                                                                        T24RCoolingEquipment:SEER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) )
                                                                              then  if (SEER2 > ( T24RCoolingEquipment:SEER2( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) + 0.005 ) )
                                                                                    then 1 else 0 endif
                                                                              else  0  endif
																						 		else  0  endif  }
	"Write SEER2 above Std Msg" 				HVACCool:HERSCheck:SEER2RptMsg = { if ( HERSCheck:SEER2 > 0.5 ) then FltToStr( SEER2, 1, 0, 4 ) else UNDEFINED endif }

;	mjb	4/14/14	do not set HERS flag if EER is not user-defined
;	mjb	8/1/14	added new flag UseEERinAnalysis, and checking it here
;	"debug"		HVACCool:Action	= {	if (FloorAreaServed > 0.5) then PostWarning( "reporting -- HVACCool '%s':  TypeRpt = %g  IsClSysEER = %g  EER Status = %g", Name, TypeRpt, IsClSysEER, LocalStatus(EER) ) else UNCHANGED endif  }
;	"Check for EER above Std" 					HVACCool:HERSCheck:EER = {  	if ( FloorAreaServed > 0.5 .AND. T24RCoolingEquipment:EERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) .AND. UseEERinAnalysis > 0.5 .AND. IfValidAnd(IsClSysEER > 0.5) .AND. TypeRpt > 1 ) then
;																									if (EER > T24RCoolingEquipment:EER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr   ) ) then 1 else 0 endif
;																					 			else  0  endif  }
; SAC 4/23/15 - added logic to NOT flag EER in HERSCheck is this equipment is not modeled as the user entered it (look-up table PropEqStd = 1)
	"Check for EER above Std" 					HVACCool:HERSCheck:EER = {  	if ( FloorAreaServed > 0.5 .AND. T24RCoolingEquipment:EERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) .AND. IfValidAnd(UseEERinAnalysis > 0.5 ) .AND.
																									  IfValidAnd(IsClSysEER > 0.5) .AND. T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) < 0.5 .AND.
                                                                             EffMetric < 2 ) then
																									if (EER > ( T24RCoolingEquipment:EER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) + 0.005 ) ) then 1 else 0 endif
																					 			else  0  endif  }
	"Write EER above Std Msg" 					HVACCool:HERSCheck:EERRptMsg = { if ( HERSCheck:EER > 0.5 ) then FltToStr( EER, 1, 0, 4 ) else UNDEFINED endif }
   ; added separate properties & rules for EER2 (vs. EER) - SAC 09/22/22 (tic #1286)
	"Check for EER2 above Std" 				HVACCool:HERSCheck:EER2 = {  	if ( FloorAreaServed > 0.5 .AND. T24RCoolingEquipment:EER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) .AND. IfValidAnd(UseEERinAnalysis > 0.5 ) .AND.
																									  IfValidAnd(IsClSysEER > 0.5) .AND. T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) < 0.5 .AND.
                                                                             EffMetric == 2 ) then
																									if (EER2 > ( T24RCoolingEquipment:EER2( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) + 0.005 ) ) then 1 else 0 endif
																					 			else  0  endif  }
	"Write EER2 above Std Msg" 				HVACCool:HERSCheck:EER2RptMsg = { if ( HERSCheck:EER2 > 0.5 ) then FltToStr( EER2, 1, 0, 4 ) else UNDEFINED endif }

;	"Check for AC Charge"						HVACCool:HERSCheck:ACCharg = { if ( FloorAreaServed > 0.5 .AND. TypeRpt > 1 .AND. ACCharge > 1.5 ) then 1 else 0 endif }
; SAC 4/23/15 - added logic to NOT flag Refrig Charge in HERSCheck is this equipment is not modeled as the user entered it (look-up table PropEqStd = 1)
; SAC 5/4/15 - removed check of T24RCoolingEquipment:PropEqStd() as that no longer effects whether the system requires refrigerant charge reporting (issue 502)
; SAC 10/25/17 - added check (from HtPump rule) to ensure that refernced HVACSys objects are not all Existing (tic #909)
; SAC 6/18/18 - ROLL BACK this mod which broke some tic #764 runs - SAC 6/15/18 - restrict cases where this msg occurs to ONLY NEW HVACSys objects (HVACSys:StatusArray ) > 1.5 -->> = 3) (tic #981)
; added logic to prevent systems of specific (packaged & room) types from being flagged - SAC 09/04/20 (tic #1003)
	"Check for AC Charge"						HVACCool:HERSCheck:ACCharg = {
         if ( FloorAreaServed > 0.5 .AND. ACCharge > 1.5 .AND.
              MaxRevRef( HVACSys:CoolSystem, HVACSys:StatusArray ) > 1.5 .AND.
              Type != 25 .AND. Type != 23 .AND. Type != 5 )    ; NOT PkgTermAirCond, SglPkgVertAirCond or RoomAirCond
         then 1 else 0 endif }
																						;				.AND. T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) < 0.5 ) then 1 else 0 endif }
	"Write AC Charge Msg" 			   		HVACCool:HERSCheck:ACChargRptMsg = { if ( HERSCheck:ACCharg > 0.5 ) then ACCharge else 0 endif }

   ; SAC 5/10/19 - split out rules that populate HERSCool & HERSHeat for 2016 & earlier code vints vs. HERSHtPump for 2019+ models
	"Populate HVACHtPump HERS object(s)"		HVACHtPump:Action = {
         if (Proj:EnergyCodeYearNum < 2019 .AND. LocalCompAssigned( HERSCheck ) .AND. FloorAreaServed > 0.5)
         then  EvalRulelist( "CreateAndAssignAsUserDefined_HVACHtPump_HERSCoolHeat_Populate", 1 )
         else if (Proj:EnergyCodeYearNum >= 2019 .AND. LocalCompAssigned( HERSHtPumpRef ) .AND. FloorAreaServed > 0.5)
         then  EvalRulelist( "CreateAndAssignAsUserDefined_HVACHtPump_HERSHtPump_Populate", 1 )
         else  UNCHANGED  endif endif  }

; mjb 7/9/14 - avoid setting HERS report flag for existing ducts
;	mjb	7/29/14 - use IsLessThanForty flag to keep short additions of ducts from triggering HERS check; also make sure to include Status = 4 (existing + new)
; SAC 5/28/19 - split logic into before & after 2019 & added new logic for 2019+
   ; added logic to check 40' for <2022 codes and 25' for 2022+ - SAC 09/23/22 (tic #1296)
	"Check for Duct Leakage"					HVACDist:HERSCheck:DuctLeakage = 
      {  if ( FloorAreaServed < 0.5 .OR. IsExisting ) then  0
         else if (Proj:EnergyCodeYearNum < 2019)
         then  ; 2016 and prior
                  if ( Type == 8 .OR. IfValidAnd(IsLessThanFortyFt > 0.5) ) then 0 else 1 endif 
         else  ; 2019+
                  if ( Type = 8 ) then  0
                  else if ( IsNew .OR. IsAltered ) then  1
                  else if ( Status = 4 .AND. 
                            ( (Proj:EnergyCodeYearNum <  2022 .AND. IsLessThanFortyFt = 0) .OR.
                              (Proj:EnergyCodeYearNum >= 2022 .AND. IsLessThan25Ft    = 0) ) ) then  1
                  else  0  endif endif endif
         endif endif  }
;	mjb	7/17/14 - need to set duct leakage flag even if NoCooling; using DuctsCreatedForAnalysis instead of TypeRpt
;	"2nd Check for Duct Leakage"				HVACDist:HERSCheck:DuctLeakage = { if ( MaxRevRef( HVACSys:DistribSystem, HVACSys:NoCoolingRpt ) > 0.5 .OR. IfValidAnd(TypeRpt < 0.5) ) then 0 else UNCHANGED endif  }
;	"2nd Check for Duct Leakage"				HVACDist:HERSCheck:DuctLeakage = { if ( IfValidAnd(DuctsCreatedForAnalysis > 0.5) ) then 0 else UNCHANGED endif  }

;	mjb	mod to account for default duct leakage value	9/10/13
;	mjb	fixed reporting of duct leakage	9/23/13
;	mjb-10/10/13	REALLY fixed reporting of duct leakage
; mjb-10/21/13 REALLY REALLY fixed reporting of duct leakage
; SAC 4/15/15 - adjust for MFam duplex/townhomes options
; SAC 5/9/16 - revised rule to reference DuctLeakageValRpt (sensitive to code vintage) in place of a static '6.0' value
; SAC 6/28/16 - added logic to set DuctLkgRptMsg to "See RA3.1.4.3.8" for HVACDist:Type = LowLlCod... (=12) (tic #627)
	"Write Duct Leakage Msg" 						HVACDist:HERSCheck:DuctLkgRptMsg = { if ( HERSCheck:DuctLeakage > 0.5 ) then 
																											   if (Type == 12)
																											   then  "See RA3.1.4.3.8"
																												else if ( DefaultSystem > 0.5 .OR. LowLkgAH < 0.5 ) then 
																													if ( Proj:IsMultiFamily > 0.5 .AND. Proj:IsMFamDupOrTownhm < 0.5 )
																													then	Format( "total leakage <= 12.0 or leakage to outdoors <= %s", FltToStr( DuctLeakageValRpt, 1, 0, 3 ) )
																													else	Format( "%s", FltToStr( DuctLeakageValRpt, 1, 0, 3 ) )  endif
																												else if ( LowLkgAH > 0.5 .AND. DuctLeakage > 100 ) then 
																													if ( Proj:IsMultiFamily > 0.5 .AND. Proj:IsMFamDupOrTownhm < 0.5 )
																													then	Format( "total leakage <= 12.0 or leakage to outdoors <= %s", FltToStr( DuctLeakageValRpt, 1, 0, 3 ) )
																													else	Format( "%s", FltToStr( DuctLeakageValRpt, 1, 0, 3 ) )  endif	
																												else FltToStr( DuctLeakageValRpt, 1, 0, 3 ) endif endif endif												
																											 else UNDEFINED endif }
;	mjb	8/1/14	- reset HVACDist:DuctLeakage enumeration for CF1R reporting of Existing Ducts
   ; added logic to check 40' for <2022 codes and 25' for 2022+ - SAC 09/23/22 (tic #1296)
	"Reset DuctLeakage enumeration if Existing"		HVACDist:Action	= {	if ( FloorAreaServed  > 0 .AND.
                                                                                ( Status == 1 .OR.
                                                                                  (Proj:StdDesignBase <  2022 .AND. Status == 4 .AND. IfValidAnd(IsLessThanFortyFt > 0.5)) .OR.
                                                                                  (Proj:StdDesignBase >= 2022 .AND. Status == 4 .AND. IfValidAnd(IsLessThan25Ft    > 0.5)) ) )
                                                                           then EvalRulelist( "Force_Existing_HVACDist_DuctLeakage", 1 ) else UNCHANGED endif	}

;	mjb	8/5/14	- added check for proposed duct location before setting HERS flag
;  mjb   9/10/14  - changed > to < for proper checking of DuctsCreatedForAnalysis flag
; SAC 12/31/15 - added logic to prevent flagging HERS DuctLocation for Existing ducts (tic 498)
; SAC 1/4/16 - added more logic to prevent HERS DuctLocation flag for Existing+New status where IsLessThanFortyFt is checked (tic 498)
   ; added logic to check 40' for <2022 codes and 25' for 2022+ - SAC 09/23/22 (tic #1296)
	"Check for HERS Req'd Duct Location"		HVACDist:HERSCheck:DuctLocation = { if ( FloorAreaServed  > 0 .AND. IfValidAnd(DuctsCreatedForAnalysis < 0.5) .AND.
																												  ( IsNew .OR. IsAltered .OR.
                                                                                        (Proj:StdDesignBase <  2022 .AND. Status == 4 .AND. IfValidAnd( IsLessThanFortyFt > 0 )==0) .OR.
                                                                                        (Proj:StdDesignBase >= 2022 .AND. Status == 4 .AND. IfValidAnd( IsLessThan25Ft    > 0 )==0) ) ) then
																												if ( Type == 6 .OR. Type == 7 .OR. Type == 12 ) then 1 else 0 endif
											      														else 0 endif  }
	"Write Duct Location Msg" 						HVACDist:HERSCheck:DuctLocRptMsg = { if ( HERSCheck:DuctLocation > 0.5 ) then Type else UNDEFINED endif }

	"Check for Return Duct Design"				HVACDist:HERSCheck:RetDuctDesign = { if ( FloorAreaServed  > 0.5 ) then
																												if (IfValidAnd( DuctDesign > 0.5 )) then 1 else 0 endif
											      													 	 else 0 endif  }
	"Write Return Duct Surface Area" 			HVACDist:HERSCheck:RetDuctRptMsg = { if (IfValidAnd( HERSCheck:RetDuctDesign > 0.5 )) then FltToStr( ReturnDuctArea, 0, 0, 1 ) else UNDEFINED endif }

	"Check for Supply Duct Design"				HVACDist:HERSCheck:SupDuctDesign = { if ( FloorAreaServed  > 0.5 ) then
																												if (IfValidAnd( DuctDesign > 0.5 )) then 1 else 0 endif
											      													 	 else 0 endif  }
	"Write Supply Duct Surface Area" 			HVACDist:HERSCheck:SupDuctRptMsg = { if (IfValidAnd( HERSCheck:SupDuctDesign > 0.5 )) then FltToStr( SupplyDuctArea, 0, 0, 1 ) else UNDEFINED endif }

	"Check for Buried Ducts"						HVACDist:HERSCheck:BuriedDucts = { 	if ( FloorAreaServed  > 0.5 ) then
																												if (IfValidAnd( AreBuried > 0.5 )) then 1 else 0 endif
											      													 	else 0 endif  }
; SAC 5/3/16 - restored *BuriedDuctsRptMsg (tic #634)
	"Write Buried Ducts msg" 						HVACDist:HERSCheck:BuriedDuctsRptMsg = { if (IfValidAnd( HERSCheck:BuriedDucts > 0.5 )) then "Buried Ducts" else UNDEFINED endif }

	"Check for Deeply Buried Ducts"				HVACDist:HERSCheck:DeeplyBuriedDucts = { 	if ( FloorAreaServed  > 0.5 ) then
																														if (IfValidAnd( AreDeeplyBuried > 0.5 )) then 1 else 0 endif
											      													 			else 0 endif  }
	"Write Deeply Buried Ducts msg" 				HVACDist:HERSCheck:DeeplyBuriedDuctsRptMsg = { if (IfValidAnd( HERSCheck:DeeplyBuriedDucts > 0.5 )) then "Deeply Buried Ducts" else UNDEFINED endif }

   ; SAC 3/6/19 - added new flag indicating that this individual HERSDist object requires CF1R reporting
   "Set HERSDist:Report flag"    HVACDist:HERSCheck:Report  = {
         if (IfValidAnd( HERSCheck:DuctLeakage > 0 ) .OR. IfValidAnd( HERSCheck:AltDuctLeakage > 0 ) .OR.
             IfValidAnd( HERSCheck:DuctLocation > 0 ) .OR. IfValidAnd( HERSCheck:RetDuctDesign > 0 ) .OR.
             IfValidAnd( HERSCheck:SupDuctDesign > 0 ) .OR. IfValidAnd( HERSCheck:BuriedDucts > 0 ) .OR.
             IfValidAnd( HERSCheck:DeeplyBuriedDucts > 0 ))
         then  1  else  0  endif  }
   ; SAC 7/1/19 - added flag to facilitate Bb08_LowLeakageAirHandlingUnitVerificationRequired true iff user specifies "Low Leakage Air Handler" (tic #1127)
   "Set HERSDist:cf1rLowLeakageAH flag"      HVACDist:HERSCheck:cf1rLowLeakageAH  = 
      {  if (IfValidAnd( HERSCheck:Report > 0 ) .AND. IfValidAnd( DefaultSystem > 0 )==0 .AND. IfValidAnd( LowLkgAH > 0 ))
         then  1  else  UNDEFINED  endif  }

;mjb still figuring these out:
;	"Check for Air Filter Design"			HVACDist:HERSCheck:AirFilterDesign = {  }
;AirFltrRptMsg
;
; Project level HERS HVAC Verifications
;
;	mjb	mods to move from HERSHVACSys to HERSCool and HERSDist	9/1/13
;	mjb	add Proj checks for HtPumps	9/1/13

	"Ensure Proj:HERSCool exists"			Proj:HERSCool	= {	if (LocalCompAssigned( HERSCool )) then  UNCHANGED
																				else  CreateComp( HERSCool, Local( Name ) + "-hers-cool-proj" )  endif  }
	"Ensure Proj:HERSHeatRef exists"		Proj:HERSHeatRef = {	if (LocalCompAssigned( HERSHeatRef )) then  UNCHANGED
																				else  CreateComp( HERSHeat, Local( Name ) + "-hers-heat-proj" )  endif  }  ; SAC 3/18/19
   ; SAC 5/10/19 - bail on Proj:HERSHtPumpRef - since project-wide messages are not specific to HtPump objects (just cool vs. heat)
	"Ensure Proj:HERSDist exists"			Proj:Action	= {	if (LocalCompAssigned( HERSDist )) then  UNCHANGED
																			else  EvalRulelist( "CreateAndAssignAsUserDefined_Proj_HERSDist", 1 )  endif  }
	"Ensure Proj:HERSFan exists"			Proj:Action	= {	if (LocalCompAssigned( HERSFan )) then  UNCHANGED
																			else  EvalRulelist( "CreateAndAssignAsUserDefined_Proj_HERSFan", 1 )  endif  }
	; SAC 5/10/19 - revised HERS Cool & Heat rules to reference new 2019 HVACHtPump:HERSHtPumpRef properties
	"Check for SEER above Std within Proj" 			Proj:HERSCool:SEER = { if ( MaxAll( HVACCool:HERSCheck:SEER ) > 0.5 .OR.
	                                                                            MaxAll( HVACHtPump:HERSCheck:SEER ) > 0.5 .OR.
	                                                                            MaxAll( HVACHtPump:HERSHtPumpRef:SEER ) > 0.5  ) then 1 else 0 endif }
	"Check for EER above Std within Proj" 				Proj:HERSCool:EER = { if ( MaxAll( HVACCool:HERSCheck:EER ) > 0.5 .OR.
	                                                                           MaxAll( HVACHtPump:HERSCheck:EER ) > 0.5 .OR.
	                                                                           MaxAll( HVACHtPump:HERSHtPumpRef:EER ) > 0.5 ) then 1 else 0 endif }
	"Check for SEER2 above Std within Proj" 			Proj:HERSCool:SEER2 ={ if ( MaxAll( HVACCool:HERSCheck:SEER2 ) > 0.5 .OR.
	                                                                            MaxAll( HVACHtPump:HERSCheck:SEER2 ) > 0.5 .OR.
	                                                                            MaxAll( HVACHtPump:HERSHtPumpRef:SEER2 ) > 0.5  ) then 1 else 0 endif }      ; SAC 09/22/22 (tic #1286)
	"Check for EER2 above Std within Proj" 			Proj:HERSCool:EER2 = { if ( MaxAll( HVACCool:HERSCheck:EER2 ) > 0.5 .OR.
	                                                                           MaxAll( HVACHtPump:HERSCheck:EER2 ) > 0.5 .OR.
	                                                                           MaxAll( HVACHtPump:HERSHtPumpRef:EER2 ) > 0.5 ) then 1 else 0 endif }         ; SAC 09/22/22 (tic #1286)
	"Check for Duct Leakage within Proj"				Proj:HERSDist:DuctLeakage = { if ( MaxAll( HVACDist:HERSCheck:DuctLeakage ) > 0.5   ) then 1 else 0 endif }
	"Check for HERS Duct Types within Proj"			Proj:HERSDist:DuctLocation = { if ( MaxAll( HVACDist:HERSCheck:DuctLocation ) > 0.5 ) then 1 else 0 endif }
	"Check for AC Charge within Proj"					Proj:HERSCool:ACCharg = { if ( MaxAll( HVACCool:HERSCheck:ACCharg ) > 0.5 .OR.
                                                                                  MaxAll( HVACHtPump:HERSCheck:ACCharg ) > 0.5 .OR.
                                                                                  MaxAll( HVACHtPump:HERSHtPumpRef:ACCharg ) > 0.5 ) then 1 else 0 endif }
	"Check for AirFlow within Proj"						Proj:HERSCool:AHUAirFlow = { if ( MaxAll( HVACCool:HERSCheck:AHUAirFlow ) > 0.5 .OR.
                                                                                     MaxAll( HVACHtPump:HERSCheck:AHUAirFlow ) > 0.5 .OR.
                                                                                     MaxAll( HVACHtPump:HERSHtPumpRef:AHUAirFlow ) > 0.5 ) then 1 else 0 endif }

   "Check for Pkg or Split HtPump HSPF above Std within Proj"  Proj:HERSHeatRef:HSPF     = { if ( MaxAll( HVACHtPump:HERSHeatRef:HSPF       ) > 0.5 .OR.
                                                                                                  MaxAll( HVACHtPump:HERSHtPumpRef:HSPF     ) > 0.5 ) then 1 else 0 endif }  ; SAC 3/18/19
   "Check for Pkg or Split HtPump HSPF2 above Std within Proj" Proj:HERSHeatRef:HSPF2    = { if ( MaxAll( HVACHtPump:HERSHeatRef:HSPF2      ) > 0.5 .OR.
                                                                                                  MaxAll( HVACHtPump:HERSHtPumpRef:HSPF2    ) > 0.5 ) then 1 else 0 endif }  ; SAC 09/22/22 (tic #1286)
   "Check for Pkg or Split HtPump Htg Capacity within Proj"    Proj:HERSHeatRef:Capacity = { if ( MaxAll( HVACHtPump:HERSHeatRef:Capacity   ) > 0.5 .OR.
                                                                                                  MaxAll( HVACHtPump:HERSHtPumpRef:Capacity ) > 0.5 ) then 1 else 0 endif }

	"Check for Return Duct Design within Proj"		Proj:HERSDist:RetDuctDesign = { if ( MaxAll( HVACDist:HERSCheck:RetDuctDesign ) > 0.5 ) then 1 else 0 endif }
	"Check for Supply Duct Design within Proj"		Proj:HERSDist:SupDuctDesign = { if ( MaxAll( HVACDist:HERSCheck:SupDuctDesign ) > 0.5 ) then 1 else 0 endif }

	"Check for Fan W/cfm within Proj"					Proj:HERSFan:AHUFanEff = { if ( MaxAll( HVACFan:HERSCheck:AHUFanEff ) > 0.5   ) then 1 else 0 endif }
;	"Check for Air Filter Design within Proj"			Proj:HERSDist:AirFilterDesign = { if ( MaxAll( HVACDist:HERSCheck:AirFilterDesign ) > 0.5 ) then 1 else 0 endif }
	; SAC 5/3/16 - added project-wide HERS *BuriedDucts (tic #634)
	"Check for Buried Ducts within Proj"				Proj:HERSDist:BuriedDucts = { if ( MaxAll( HVACDist:HERSCheck:BuriedDucts ) > 0.5 ) then 1 else 0 endif }
	"Check for Deeply Buried Ducts within Proj"		Proj:HERSDist:DeeplyBuriedDucts = { if ( MaxAll( HVACDist:HERSCheck:DeeplyBuriedDucts ) > 0.5 ) then 1 else 0 endif }
	"Write Proj Buried Ducts msg" 						Proj:HERSDist:BuriedDuctsRptMsg = { if (MaxAll( HVACDist:HERSCheck:BuriedDucts ) > 0.5) then "Buried Ducts" else UNDEFINED endif }
	"Write Proj Deeply Buried Ducts msg" 				Proj:HERSDist:DeeplyBuriedDuctsRptMsg = { if (MaxAll( HVACDist:HERSCheck:DeeplyBuriedDucts ) > 0.5) then "Deeply Buried Ducts" else UNDEFINED endif }

; DHW HERS Verification measures
;  mjb   7/9/14 do not generate HERS reporting for existing DHW systems
;
	"Ensure DHWSys:HERSCheck exists"				DHWSys:Action	= {	if (LocalCompAssigned( HERSCheck )) then  UNCHANGED
																						else  EvalRulelist( "CreateAndAssignAsUserDefined_DHWSys_HERSDHWSys", 1 )  endif  }
	;"Check for Compact Distribution"				DHWSys:HERSCheck:Compact = { if ( DHWSys:SystemType == 8394496 .AND. DHWSys:CentralDHW < 0.5 .AND. Status != 1 ) then 1 else 0 endif }
	;"Write Compact Dist Msg" 						DHWSys:HERSCheck:CompactRptMsg = { if ( HERSCheck:Compact > 0.5 ) then DHWSys:SystemType else UNDEFINED endif }
	; SAC 5/23/19 - updated for new Compact Distribution options specified outside DHWSys:SystemType
	; SAC 7/18/19 - restored OLD logic (above) to retain for 2016 analysis and revised 2019 logic to flag HERS only for Expanded CD (tic #1140)
	"Check for Compact Distribution"				DHWSys:HERSCheck:Compact =
	   {  if ( ( Proj:EnergyCodeYearNum <= 2016 .AND. SystemType == 8394496 .AND. CentralDHW < 0.5 .AND. Status != 1 ) .OR.
	           ( Proj:EnergyCodeYearNum >= 2019 .AND. CentralDHW < 0.5 .AND. Status != 1 .AND. IfValidAnd( CmpctDistAllowed > 0 ) .AND.
                IfValidAnd( CDModelCredit > 0 ) .AND. Proj:SFamCompactDistrib > 1 .AND. IfValidAnd( Proj:SFamCompactFactor < 1.0 ) ))  then  1  else  0  endif  }
	"Write Compact Dist Msg" 						DHWSys:HERSCheck:CompactRptMsg = { if ( HERSCheck:Compact > 0.5 ) then 8394496 else UNDEFINED endif }

;       08/25/16 - CG Updated based on changes to address (tic #707)
; SAC 8/28/16 - effectively removed HERS MFCtrlRecircDualLp flag (tic #670)
	"Check for Multi-family Central Recirculating Dual Loop Design"	
   DHWSys:HERSCheck:MFCtrlRecircDualLp = { 0 }
;    if ( Status != 1 .AND. 
;         DHWSys:CentralDHW > 0.5 .AND. 
;         IfValidAnd( NRecircLoops > 1 ) .AND. 
;         DHWSys:MFamDistType == 5051 ) ; Corect dual loop HERS check 
;    then 1 
;    else 0 
;    endif }

   ;       08/25/16 - CG Updated based on changes to address (tic #707)    
   ; SAC 7/29/19 - added checks in all following rules to ensure HERS flags not triggered for systems not assigned to zones (tic #1033)
	"Write Multi-family Central Recirculating Dual Loop Design Msg" 	
   DHWSys:HERSCheck:MFCtrlRecircDualLpRptMsg = { 
    if ( HERSCheck:MFCtrlRecircDualLp > 0.5 .AND. IfValidAnd( FloorAreaServed[1] > 0 ) ) 
    then DHWSys:MFamDistType ; Correct dual loop HERS message output
    else UNDEFINED 
    endif }

	"Check for Parallel Piping"					DHWSys:HERSCheck:ParallelPipe = { if ( DHWSys:SystemType == 8393216 .AND. DHWSys:CentralDHW < 0.5 .AND. Status != 1 .AND. IfValidAnd( FloorAreaServed[1] > 0 ) ) then 1 else 0 endif }
	"Write Parallel Piping Msg" 						DHWSys:HERSCheck:ParaPipeRptMsg = { if ( HERSCheck:ParallelPipe > 0.5 .AND. IfValidAnd( FloorAreaServed[1] > 0 ) ) then DHWSys:SystemType else UNDEFINED endif }
	"Check for All Pipes Insulated"					DHWSys:HERSCheck:AllPipesIns = { if ( DHWSys:SystemType == 8392704 .AND. Status != 1 .AND. IfValidAnd( FloorAreaServed[1] > 0 ) ) then 1 else 0 endif }
	"Write AllPipesIns Msg" 						DHWSys:HERSCheck:PipeInsRptMsg = { if ( HERSCheck:AllPipesIns > 0.5 .AND. IfValidAnd( FloorAreaServed[1] > 0 ) ) then DHWSys:SystemType else UNDEFINED endif }
	"Check for Point of Use"					DHWSys:HERSCheck:PointOfUse = { if ( DHWSys:SystemType == 8394240 .AND. DHWSys:CentralDHW < 0.5 .AND. Status != 1 .AND. IfValidAnd( FloorAreaServed[1] > 0 ) ) then 1 else 0 endif }
	"Write Point of Use Msg" 						DHWSys:HERSCheck:POURptMsg = { if ( HERSCheck:PointOfUse > 0.5 .AND. IfValidAnd( FloorAreaServed[1] > 0 ) ) then DHWSys:SystemType else UNDEFINED endif }
	"Check for Recirc, Occupancy DC"				DHWSys:HERSCheck:OccRecirc = { if ( DHWSys:SystemType == 8394112 .AND. DHWSys:CentralDHW < 0.5 .AND. Status != 1 .AND. IfValidAnd( FloorAreaServed[1] > 0 ) ) then 1 else 0 endif }
	"Write Recirc, Occ Msg" 						DHWSys:HERSCheck:OccRptMsg = { if ( HERSCheck:OccRecirc > 0.5 .AND. IfValidAnd( FloorAreaServed[1] > 0 ) ) then DHWSys:SystemType else UNDEFINED endif }
	"Check for Recirc, Push Button DC"				DHWSys:HERSCheck:PushBtnRecirc = { if ( DHWSys:SystemType == 8393856 .AND. DHWSys:CentralDHW < 0.5 .AND. Status != 1 .AND. IfValidAnd( FloorAreaServed[1] > 0 ) ) then 1 else 0 endif }
	"Write Recirc, Push Button Msg" 					DHWSys:HERSCheck:PushBtnRptMsg = { if ( HERSCheck:PushBtnRecirc > 0.5 .AND. IfValidAnd( FloorAreaServed[1] > 0 ) ) then DHWSys:SystemType else UNDEFINED endif }
   ; SAC 2/19/18 - HERS Drain water heat recovery message (tic #978)
   ; SAC 4/29/19 - updated DWHR HERS reporting logic for latest DWHR implementation (tic #1056)
   "Set DHWSys:HERSCheck:ShwrDrnWtrHtRecov"     DHWSys:HERSCheck:ShwrDrnWtrHtRecov     =
   ;   {  if (Proj:HaveShwrDrnHtRecov > 0 .AND. IfValidAnd( Proj:ShwrDRAINHREFF > 0 ))
      {  if ( (IsNew .OR. IsAltered) .AND. FloorAreaServed[1] > 0 .AND.
              ( (Proj:IsMultiFamily < 0.5 .AND. IfValidAnd( NumDWHRSysDevices > 0 )) .OR.
                (Proj:IsMultiFamily > 0.5 .AND. ( SumRevRef( DwellUnitType:DHWSysRef[1], DwellUnitType:DWHRSysDevicesSim[1] ) > 0 .OR.
                                                  SumRevRef( DwellUnitType:DHWSysRef[2], DwellUnitType:DWHRSysDevicesSim[2] ) > 0 .OR.
                                                  SumRevRef( DwellUnitType:DHWSysRef[3], DwellUnitType:DWHRSysDevicesSim[3] ) > 0 .OR.
                                                  SumRevRef( DwellUnitType:DHWSysRef[4], DwellUnitType:DWHRSysDevicesSim[4] ) > 0 .OR.
                                                  SumRevRef( DwellUnitType:DHWSysRef[5], DwellUnitType:DWHRSysDevicesSim[5] ) > 0 )) ) )
         then  1  else  0  endif  }
   "Set DHWSys:HERSCheck:ShwrDrnWtrHtRecovMsg"  DHWSys:HERSCheck:ShwrDrnWtrHtRecovMsg  = {  HERSCheck:ShwrDrnWtrHtRecov  }
;	"Check for Ins and Protected Below Grade"			DHWSys:HERSCheck:BelowGrade = { if ( DHWSys:SystemType == 8392960 .AND. Status != 1 ) then 1 else 0 endif }
;	"Write Below Grade Msg" 						DHWSys:HERSCheck:BelowGradeRptMsg = { if ( HERSCheck:BelowGrade > 0.5 ) then DHWSys:SystemType else UNDEFINED endif }
;	"Check for MF Recirc, No Control"				DHWSys:HERSCheck:MFNoControl = { if ( DHWSys:MFamDistType == 8393664 .AND. Status != 1 ) then 1 else 0 endif }
;	"Write MF Recirc, NC Msg" 						DHWSys:HERSCheck:MFNoCtrlRptMsg = { if ( HERSCheck:MFNoControl > 0.5 ) then DHWSys:MFamDistType else UNDEFINED endif }
;	"Check for MF Recirc, Demand Control"				DHWSys:HERSCheck:MFDemandControl = { if ( DHWSys:MFamDistType == 8394944 .AND. Status != 1 ) then 1 else 0 endif }
;	"Write MF Recirc, DC Msg" 						DHWSys:HERSCheck:MFDCRptMsg = { if ( HERSCheck:MFDemandControl > 0.5 ) then DHWSys:MFamDistType else UNDEFINED endif }
;	"Check for MF Recirc, Temp Modulation"				DHWSys:HERSCheck:MFTempMod = { if ( DHWSys:MFamDistType == 8395200 .AND. Status != 1 ) then 1 else 0 endif }
;	"Write MF Recirc, Temp Mod Msg" 					DHWSys:HERSCheck:MFTmpModRptMsg = { if ( HERSCheck:MFTempMod > 0.5 ) then DHWSys:MFamDistType else UNDEFINED endif }
;	"Check for MF Recirc, Temp Mod & Monitor"			DHWSys:HERSCheck:MFTempModMon = { if ( DHWSys:MFamDistType == 8395456 .AND. Status != 1 ) then 1 else 0 endif }
;	"Write MF Recirc, Temp, Mod, Mon Msg" 					DHWSys:HERSCheck:MFTmpModMonRptMsg = { if ( HERSCheck:MFTempModMon > 0.5 ) then DHWSys:MFamDistType else UNDEFINED endif }
; SAC 11/10/15 - replace above w/ below to account for MFamDistType options which no longer include HERSVerif options
; SDS 07/28/16 - Below are MFamDistType options thats do not require HERSVerif and have been commented out
;	"Check for MF Recirc, No Control"				DHWSys:HERSCheck:MFNoControl 			= { if ( DHWSys:MFamDistType == 5056 .AND. IfValidAnd( NRecircLoops > 1 ) .AND. Status != 1 ) then 1 else 0 endif }
;	"Write MF Recirc, NC Msg" 						DHWSys:HERSCheck:MFNoCtrlRptMsg 		= { if ( HERSCheck:MFNoControl > 0.5 ) then DHWSys:MFamDistType else UNDEFINED endif }
;	"Check for MF Recirc, Demand Control"				DHWSys:HERSCheck:MFDemandControl 	= { if ( DHWSys:MFamDistType == 6336 .AND. IfValidAnd( NRecircLoops > 1 ) .AND. Status != 1 ) then 1 else 0 endif }
;	"Write MF Recirc, DC Msg" 						DHWSys:HERSCheck:MFDCRptMsg 			= { if ( HERSCheck:MFDemandControl > 0.5 ) then DHWSys:MFamDistType else UNDEFINED endif }
;	"Check for MF Recirc, Temp Modulation"				DHWSys:HERSCheck:MFTempMod 			= { if ( DHWSys:MFamDistType == 6592 .AND. IfValidAnd( NRecircLoops > 1 ) .AND. Status != 1 ) then 1 else 0 endif }
;	"Write MF Recirc, Temp Mod Msg" 					DHWSys:HERSCheck:MFTmpModRptMsg 		= { if ( HERSCheck:MFTempMod > 0.5 ) then DHWSys:MFamDistType else UNDEFINED endif }
;	"Check for MF Recirc, Temp Mod & Monitor"			DHWSys:HERSCheck:MFTempModMon 		= { if ( DHWSys:MFamDistType == 6848 .AND. IfValidAnd( NRecircLoops > 1 ) .AND. Status != 1 ) then 1 else 0 endif }
;	"Write MF Recirc, Temp, Mod, Mon Msg" 					DHWSys:HERSCheck:MFTmpModMonRptMsg	= { if ( HERSCheck:MFTempModMon > 0.5 ) then DHWSys:MFamDistType else UNDEFINED endif }

; Project level HERS DHW Verifications
;
	"Ensure Proj:HERSDHW exists"					Proj:Action	= {	if (LocalCompAssigned( HERSDHW )) then  UNCHANGED
																					else  EvalRulelist( "CreateAndAssignAsUserDefined_Proj_HERSDHWSys", 1 )  endif  }
   ; SAC 3/12/19 - revised all following to set Proj-level enumerations so that CF1R XML output consistent (tic #1080)
	;"Check for Compact Distribution"			Proj:HERSDHW:Compact = { if ( MaxAll( DHWSys:HERSCheck:Compact ) > 0.5 ) then 1 else 0 endif }
	; SAC 4/13/19 - updated for latest Compact Distrib 
	; SAC 7/18/19 - restored OLD logic (above) to retain for 2016 analysis and revised 2019 logic to flag HERS only for Expanded CD (tic #1140)
	"Check for Compact Distribution"			Proj:HERSDHW:Compact = { 
         if ( ( Proj:EnergyCodeYearNum <= 2016 .AND. MaxAll( DHWSys:HERSCheck:Compact ) > 0.5 ) .OR.
              ( Proj:EnergyCodeYearNum >= 2019 .AND. ((IsMultiFamily < 0.5 .AND. SFamCompactDistrib > 1 .AND. SumAcrossIf( DHWSys:CDModelCredit, DHWSys:FloorAreaServed[1] > 0 ) > 0) .OR.
                                                      (IsMultiFamily > 0.5 .AND. MaxAll( DwellUnitType:ReportCompactDist ) > 1)) ) )
         then  1  else  0  endif  }

	"Proj Compact Distribution Msg"			Proj:HERSDHW:CompactRptMsg = { if ( HERSDHW:Compact ) then 8394496 else 0 endif }
	"Check for MFam Central Recirc..."	   Proj:HERSDHW:MFCtrlRecircDualLp = { if ( MaxAll( DHWSys:HERSCheck:MFCtrlRecircDualLp ) > 0.5 ) then 1 else 0 endif }
	"Proj MFam Central Recirc... Msg"	   Proj:HERSDHW:MFCtrlRecircDualLpRptMsg = { if ( HERSDHW:MFCtrlRecircDualLp ) then 5051 else 0 endif }
	"Check for Parallel Piping"				Proj:HERSDHW:ParallelPipe = { if ( MaxAll( DHWSys:HERSCheck:ParallelPipe ) > 0.5 ) then 1 else 0 endif }
	"Proj Parallel Piping Msg"				   Proj:HERSDHW:ParaPipeRptMsg = { if ( HERSDHW:ParallelPipe ) then 8393216 else 0 endif }
	"Check for All Pipes Insulated"			Proj:HERSDHW:AllPipesIns = { if ( MaxAll( DHWSys:HERSCheck:AllPipesIns ) > 0.5 ) then 1 else 0 endif }
	"Proj All Pipes Insulated Msg"			Proj:HERSDHW:PipeInsRptMsg = { if ( HERSDHW:AllPipesIns ) then 8392704 else 0 endif }
	"Check for Point of Use"					Proj:HERSDHW:PointOfUse = { if ( MaxAll( DHWSys:HERSCheck:PointOfUse ) > 0.5 ) then 1 else 0 endif }
	"Proj Point of Use Msg"					   Proj:HERSDHW:POURptMsg = { if ( HERSDHW:PointOfUse ) then 8394240 else 0 endif }
	"Check for Recirc, Occupancy DC"			Proj:HERSDHW:OccRecirc = { if ( MaxAll( DHWSys:HERSCheck:OccRecirc ) > 0.5 ) then 1 else 0 endif }
	"Proj Recirc, Occupancy DC Msg"			Proj:HERSDHW:OccRptMsg = { if ( HERSDHW:OccRecirc ) then 8394112 else 0 endif }
	"Check for Recirc, Push Button DC"		Proj:HERSDHW:PushBtnRecirc = { if ( MaxAll( DHWSys:HERSCheck:PushBtnRecirc ) > 0.5 ) then 1 else 0 endif }
	"ProjRecirc, Push Button Msg"				Proj:HERSDHW:PushBtnRptMsg = { if ( HERSDHW:PushBtnRecirc ) then 8393856 else 0 endif }
;	"Check for Below Grade"						Proj:HERSDHW:BelowGrade = { if ( MaxAll( DHWSys:HERSCheck:BelowGrade ) > 0.5) then 1 else 0 endif }
;	"Check for MF Recirc, No Control"				Proj:HERSDHW:MFNoControl = { if ( MaxAll( DHWSys:HERSCheck:MFNoControl ) > 0.5 ) then 1 else 0 endif }
;	"Check for MF Recirc, Demand Control"				Proj:HERSDHW:MFDemandControl = { if ( MaxAll( DHWSys:HERSCheck:MFDemandControl ) > 0.5 ) then 1 else 0 endif }
;	"Check for MF Recirc, Temp Modulation"				Proj:HERSDHW:MFTempMod = { if ( MaxAll( DHWSys:HERSCheck:MFTempMod ) > 0.5 ) then 1 else 0 endif }
;	"Check for MF Recirc, Temp Mod & Monitor"			Proj:HERSDHW:MFTempModMon = { if ( MaxAll( DHWSys:HERSCheck:MFTempModMon ) > 0.5 ) then 1 else 0 endif }
   ; SAC 2/19/18 - HERS Drain water heat recovery message (tic #978)
   "Set Proj:HERSDHW:ShwrDrnWtrHtRecov"      Proj:HERSDHW:ShwrDrnWtrHtRecov     = {
         if ( MaxAll( DHWSys:HERSCheck:ShwrDrnWtrHtRecov ) > 0.5 ) then 1 else 0 endif }
   "Set Proj:HERSDHW:ShwrDrnWtrHtRecovMsg"   Proj:HERSDHW:ShwrDrnWtrHtRecovMsg  = {  HERSDHW:ShwrDrnWtrHtRecov  }

	"Set Proj:ShowNotRegWatermark - Whether or not the 'not registered' watermark should appear on the compliance report - 1: DHW"
;		Proj:ShowNotRegWatermark = {	if ( HERSDHW:MFTempModMon .OR. HERSDHW:MFTempMod .OR. HERSDHW:MFDemandControl .OR. HERSDHW:MFNoControl .OR. HERSDHW:Compact .OR. HERSDHW:PointOfUse .OR. HERSDHW:OccRecirc
;								.OR. HERSDHW:PushBtnRecirc .OR. HERSDHW:BelowGrade .OR. HERSDHW:ParallelPipe .OR. HERSDHW:AllPipesIns ) then 1 else 0 endif	}; SDS 07/28/16 removed checks which were no longer relevant (tic #707)
		Proj:ShowNotRegWatermark = {	if ( HERSDHW:Compact .OR. HERSDHW:PointOfUse .OR. HERSDHW:OccRecirc .OR. HERSDHW:PushBtnRecirc .OR. HERSDHW:ParallelPipe .OR. HERSDHW:AllPipesIns ) then 1 else 0 endif	}

	"Set Proj:ShowNotRegWatermark - Whether or not the 'not registered' watermark should appear on the compliance report - 2: Cooling"
		Proj:ShowNotRegWatermark = {	if ( LocalRef( HERSCool:SEER ) .OR. LocalRef( HERSCool:EER ) .OR. LocalRef( HERSCool:SEER2 ) .OR. LocalRef( HERSCool:EER2 ) .OR. LocalRef( HERSCool:ACCharg ) .OR. LocalRef( HERSCool:AHUAirFlow ) .OR. LocalRef( HERSDist:DuctLeakage ) 
													.OR. LocalRef( HERSDist:DuctLocation ) .OR. LocalRef( HERSDist:RetDuctDesign ) .OR. LocalRef( HERSDist:SupDuctDesign ) .OR. LocalRef( HERSFan:AHUFanEff ) ) then 1 else UNCHANGED endif	}
	"Set Proj:ShowNotRegWatermark - Whether or not the 'not registered' watermark should appear on the compliance report - 3: Project"
		Proj:ShowNotRegWatermark = {	if ( HERSProj:QII .OR. HERSProj:LowBldgLkg .OR. HERSProj:IAQFan .OR. HERSProj:CentralIAQ .OR. HERSProj:ZonalCoolSys .OR. HERSProj:SprayFoamHighR .OR. HERSProj:VerifyExistCond ) then 1 else UNCHANGED endif	}
  ; SAC 3/9/17 - reference new property to ensure that HERS is triggered project-wide for certain combinations of HVACCool & HVACDist Status settings (tic #764)
	"Set Proj:ShowNotRegWatermark - Whether or not the 'not registered' watermark should appear on the compliance report - 4: Altered HVACSys"
		Proj:ShowNotRegWatermark = {	if ( MaxAll( HVACSys:TriggerHERS ) > 0 ) then 1 else UNCHANGED endif	}


  ; SAC 3/14/17 - added alteration flag for HVACSys refrigerant charge - partially dependent on Proj:ShowNotRegWatermark (tic #764, runs 7-11)
  ; SAC 6/15/18 - expand cases where this msg occurs to include Exist & Exist+New HVACSys objects (HVACSys:StatusArray ) > 1.5 -->> = 3) (tic #981)
  ; SAC 6/19/18 - revise logic again to prevent spawning this message for Altered HVACSys objects (tic #764)
   "Check for HVACCool Alteration AC Charge"       HVACCool:HERSCheck:AltACCharg  = {
         if ( HERSCheck:ACCharg > 0 .OR. MaxRevRef( HVACSys:CoolSystem, HVACSys:CoolDuctedRpt ) < 0.5 .OR.
              ( MinRevRef( HVACSys:CoolSystem, HVACSys:StatusArray ) = 3 .OR.
				    MinRevRef( HVACSys:CoolSystem, HVACSys:StatusArray ) = 2 ) ) then  0
         else if ( Proj:ClimateZone == 2 .OR.
                  (Proj:ClimateZone >= 8 .AND. Proj:ClimateZone <= 15))
         then  if (Proj:ShowNotRegWatermark > 0)
               then  1
               else if ( ( MaxRevRef( HVACSys:CoolSystem, HVACSys:DuctStatusFlag ) < 3.5 .AND.
                           MinRevRef( HVACSys:CoolSystem, HVACSys:DuctStatusFlag ) > 1.5 ) .OR.
                           MaxRevRef( HVACSys:CoolSystem, HVACSys:DuctStatusFlag ) == 5 )
               then  1
               else  0  endif endif
         else  0  endif endif  }
   "Set HERS HVACCool Alteration AC Charge Msg"    HVACCool:HERSCheck:AltACChargRptMsg  = { 
         if (IfValidAnd( HERSCheck:AltACCharg > 0.5 )==0) then  UNDEFINED
         else  "Refrigerant Charge verification required if a refrigerant containing component is altered"  endif  }

   ; SAC 10/23/17 - flipped lt/gt sign to fix bug in HtPump logic (was: ...HVACSys:StatusArray ) < 1.5) - tic #908
  ; SAC 6/15/18 - expand cases where this msg occurs to include Exist & Exist+New HVACSys objects (HVACSys:StatusArray ) > 1.5 -->> = 3) (tic #981)
  ; SAC 6/19/18 - revise logic again to prevent spawning this message for Altered HVACSys objects (tic #764)
   "Check for HVACHtPump Alteration AC Charge"       HVACHtPump:HERSCheck:AltACCharg  = {
         if ( HERSCheck:ACCharg > 0 .OR. MaxRevRef( HVACSys:HtPumpSystem, HVACSys:CoolDuctedRpt ) < 0.5 .OR.
              ( MaxRevRef( HVACSys:HtPumpSystem, HVACSys:StatusArray ) = 3 .OR.
				    MinRevRef( HVACSys:HtPumpSystem, HVACSys:StatusArray ) = 2 ) ) then  0
         else if ( Proj:ClimateZone == 2 .OR.
                  (Proj:ClimateZone >= 8 .AND. Proj:ClimateZone <= 15))
         then  if (Proj:ShowNotRegWatermark > 0)
               then  1
               else if ( ( MaxRevRef( HVACSys:HtPumpSystem, HVACSys:DuctStatusFlag ) < 3.5 .AND.
                           MinRevRef( HVACSys:HtPumpSystem, HVACSys:DuctStatusFlag ) > 1.5 ) .OR.
                           MaxRevRef( HVACSys:HtPumpSystem, HVACSys:DuctStatusFlag ) == 5 )
               then  1
               else  0  endif endif
         else  0  endif endif  }
   "Set HERS HVACHtPump Alteration AC Charge Msg"    HVACHtPump:HERSCheck:AltACChargRptMsg  = { 
         if (IfValidAnd( HERSCheck:AltACCharg > 0.5 )==0) then  UNDEFINED
         else  "Refrigerant Charge verification required if a refrigerant containing component is altered"  endif  }
 ; DUPLICATE ABOVE for new 2019 HERSHtPumpRef objects - SAC 5/10/19
   "Check for HVACHtPump Alteration AC Charge"       HVACHtPump:HERSHtPumpRef:AltACCharg  = {
         if ( HERSHtPumpRef:ACCharg > 0 .OR. MaxRevRef( HVACSys:HtPumpSystem, HVACSys:CoolDuctedRpt ) < 0.5 .OR.
              ( MaxRevRef( HVACSys:HtPumpSystem, HVACSys:StatusArray ) = 3 .OR.
				    MinRevRef( HVACSys:HtPumpSystem, HVACSys:StatusArray ) = 2 ) ) then  0
         else if ( Proj:ClimateZone == 2 .OR.
                  (Proj:ClimateZone >= 8 .AND. Proj:ClimateZone <= 15))
         then  if (Proj:ShowNotRegWatermark > 0)
               then  1
               else if ( ( MaxRevRef( HVACSys:HtPumpSystem, HVACSys:DuctStatusFlag ) < 3.5 .AND.
                           MinRevRef( HVACSys:HtPumpSystem, HVACSys:DuctStatusFlag ) > 1.5 ) .OR.
                           MaxRevRef( HVACSys:HtPumpSystem, HVACSys:DuctStatusFlag ) == 5 )
               then  1
               else  0  endif endif
         else  0  endif endif  }
   "Set HERS HVACHtPump Alteration AC Charge Msg"    HVACHtPump:HERSHtPumpRef:AltACChargRptMsg  = { 
         if (IfValidAnd( HERSHtPumpRef:AltACCharg > 0.5 )==0) then  UNDEFINED
         else  "Refrigerant Charge verification required if a refrigerant containing component is altered"  endif  }


   "Check for Alteration AC Charge within Proj"    Proj:HERSCool:AltACCharg = {
         if ( MaxAll(       HVACCool:HERSCheck:AltACCharg ) > 0.5 .OR.
              MaxAll(     HVACHtPump:HERSCheck:AltACCharg ) > 0.5 .OR.
              MaxAll( HVACHtPump:HERSHtPumpRef:AltACCharg ) > 0.5 )
         then  1
         else  0  endif  }
;         if (LocalRef( HERSCool:ACCharg ) > 0) then  0  else     - add this @ beginning of above rule to prevent combinations of ACCharge messages
   "Set HERS Alteration AC Charge Msg for Proj"    Proj:HERSCool:AltACChargRptMsg  = { 
         if (LocalRef( HERSCool:AltACCharg ) < 1) then  UNDEFINED
         else  "Refrigerant Charge verification required if a refrigerant containing component is altered"  endif  }

  ; SAC 3/9/17 - logic for new Altered Duct Leakage HERS message (tic #764)
   ; added logic to check 40' for <2022 codes and 25' for 2022+ - SAC 09/23/22 (tic #1296)
   "Set HERS flag for Altered Ducts"      HVACDist:HERSCheck:AltDuctLeakage  = {
	      if ( IfValidAnd( HERSCheck:DuctLeakage = 0 ) .AND.
              ( Status == 1 .OR.
               (Proj:StdDesignBase <  2022 .AND. Status == 4 .AND. IfValidAnd( IsLessThanFortyFt > 0 )) .OR.
               (Proj:StdDesignBase >= 2022 .AND. Status == 4 .AND. IfValidAnd( IsLessThan25Ft    > 0 )) ) )
	      then  if ( Proj:ShowNotRegWatermark > 0 .AND. 
	                 SumRevRef( HVACSys:DistribSystem, HVACSys:HtOrClDucted ) > 0 .AND.
	                 SumRevRef( HVACSys:DistribSystem, HVACSys:IsExisting   ) > 0 )
	            then  1
	            else if ( SumRevRef( HVACSys:DistribSystem, HVACSys:IsAltSrvdDucted ) > 0 .OR.
                         SumRevRef( HVACSys:DistribSystem, HVACSys:IsNew ) > 0 )
	            then  1
	            else  0  endif endif
	      else        0  endif  }
   "Set HERS Alt Duct Leakage Msg"        HVACDist:HERSCheck:AltDuctLkgRptMsg  = { 
         if (IfValidAnd( HERSCheck:AltDuctLeakage > 0.5 )==0) then  UNDEFINED
         else  "Duct Sealing required if a duct system component, plenum, or air handling unit is altered"  endif  }

	"Check for Alt Duct Leakage within Proj"			Proj:HERSDist:AltDuctLeakage = {  
	      if ( MaxAll( HVACDist:HERSCheck:AltDuctLeakage ) > 0.5   ) then 1 else 0 endif }   ; SAC 3/9/17
	"Set Proj-wide HERS Alt Duct Leakage Msg"			Proj:HERSDist:AltDuctLkgRptMsg = { 
	      if (LocalRef( HERSDist:AltDuctLeakage ) < 0.5) then  UNDEFINED
	      else  "Duct Sealing required if a duct system component, plenum, or air handling unit is altered"  endif  }   ; SAC 3/9/17


; Project level Special Features
;
;mjb doesn't see why to set Special Feature flags for these, since they are already HERS measures:
;VentCool
;DuctLocation      
;NoDucts               

	"Ensure Proj:SpeclFeatrs exists"		Proj:Action = {	if (LocalCompAssigned( SpeclFeatrs )) then  UNCHANGED
											else  EvalRulelist( "CreateAndAssignAsUserDefined_Proj_SpeclFtr", 1 )  endif  }

; removed AllOrientation flag - SAC 9/10/13
;	"Check for AllOrientations" 			Proj:SpeclFeatrs:AllOrientations = { if ( Project:AllOrientations > 0.5 ) then 1 else 0 endif }
;	"Check for AllOrientations" 			Proj:SpeclFeatrs:AllOrientations = { 0 }
	"Check for ZonalControl" 			Proj:SpeclFeatrs:ZonalControl = { if ( Project:ZonalControl > 0.5 ) then 1 else 0 endif }
; mjb-10/11/13 added special feature messages for reporting
	"Write ZonalControl Msg" 			Proj:SpeclFeatrs:ZonalControlMsg = { if ( SpeclFeatrs:ZonalControl > 0.5 ) then 1 else 0 endif }

; SAC 10/14/13 - updated rule to properly reflect PV inputs and limits
; SAC 3/24/16 - revised rule again to acount for PVCompCredit checkbox and EDR inputs and to prevent logging credit for EAA, AddAlone or locations where PV doesn't allow credit
; SAC 10/6/16 - set PVSysCredit regardless of PVCompCredit or *DesignRating* for 2019 analysis
; SAC 7/20/17 - added logic to log special PV feature regardless of activation of PV compliance credit for 2016 analysis (LF e-mail today)
; SAC 4/22/19 - added logic to prevent PVSysCredit when PVWDCSysTotal = 0
; SAC 1/29/20 - added logic to prevent 2019+ PVSysCredit when ReducedPVReqValue = 0 (tic #1193)
  "Check for PVCredit"         Proj:SpeclFeatrs:PVSysCredit = { 
    if ( EnergyCodeYearNum >= 2019 ) 
    then  if (IfValidAnd( PVWDCSysTotal >= PVMinRatedPwrRpt ) .AND. IfValidAnd( PVWDCSysTotal > 0 ) .AND.
              IfValidAnd( ReducedPVReqValue == 0 )==0)
          then  1  else  0  endif
    else if ( EnergyCodeYearNum = 2016 .AND. IfValidAnd( AllowDesignRating > 0.5 ) .AND.
              IfValidAnd( DesignRatingCalcs > 0.5 ) .AND. IfValidAnd( PVWDCSysTotal > 0 ))
    then  1
    else if ( PVGenCredit < 0.1 .OR. StandardsVersion <= 2014 .OR. PVCompCredit < 0.5 ) 
    then  0
    else if (Proj:RunScope != 1 .OR. Proj:IsAddAlone > 0 .OR. IfValidAnd(MaxPVPrelimCredit < 0.01)) 
    then  0
    else if ( IfValidAnd( AllowDesignRating > 0.5 ) .AND. 
              IfValidAnd( DesignRatingCalcs > 0.5 ) .AND. 
              IfValidAnd( PVWDCSysTotal >= PVMinRatedPwrRpt )==0) 
    then  0
    else  1  
    endif endif endif endif endif }
;	"Check for PVCredit" 				Proj:SpeclFeatrs:PVSysCredit = { if ( Project:PVCredit > 0.1 ) then 1 else 0 endif }
; mjb-10/14/13	changed ELSE msg so that message would show up in XML even when blank
; SAC 3/24/16 - revised logic to report credit value resulting from changes from having user enter PVRatedPower to simply checking the PVCompCredit checkbox
; SAC 7/20/17 - altered logic to report PVWDCSysTotal here if it is > 0, regardless of what PVMinRatedPwrRpt is (LF e-mail today)
; SAC 2/20/18 - revised PV capacity decimal precision from 1->2 (tic #921) - SAC 2/26/18 - revised again to reference new PVWDCSysScldTotRnd
; SAC 10/12/18 - added separate PVSysCreditVal property to carry reported PV system capacity separately from message (to facilitate XML schema CF1R rules)
   "Set rounded & scaled PV size"   Proj:Action  = {  EvalRulelist( "Set_Proj_PVWDCSysScldTotRnd" )  }
	"Set PV Capacity Value" 			Proj:SpeclFeatrs:PVSysCreditVal = {
	   if ( SpeclFeatrs:PVSysCredit > 0.5 ) 
		then	if (IfValidAnd( AllowDesignRating > 0.5 ) .AND. IfValidAnd( DesignRatingCalcs > 0.5 ) .AND.
		          (IfValidAnd( PVWDCSysTotal >= PVMinRatedPwrRpt ) .OR. IfValidAnd( PVWDCSysTotal > 0 )))
				then	if (IfValidAnd( PVWDCSysScldTotRnd > 0 ))
				      then  PVWDCSysScldTotRnd
				      else  PVWDCSysTotal        endif
				else if (IfValidAnd( PVMinRatedPwrRpt > 0 ))
				then	PVMinRatedPwrRpt
				else if (IfValidAnd( PVRatedPower > 0 ))
				then	PVRatedPower
				else	UNDEFINED  endif endif endif 
		else UNDEFINED endif }
	"Write PV Capacity Msg" 			Proj:SpeclFeatrs:PVSysCreditMsg = {
	   if ( SpeclFeatrs:PVSysCredit > 0.5 .AND. IfValidAnd( SpeclFeatrs:PVSysCreditVal > 0 ) ) 
      then  "PV System: " + FltToStr( SpeclFeatrs:PVSysCreditVal, 2, 0, 0, 1 ) + " kWdc"
      else " " endif }

  ; SAC 10/15/14 - added to facilitate multiple attics
	"Set Attic:AboveDeckRoofIns"		Attic:AboveDeckRoofIns		= {	if (FloorAreaOverCond > 0.5 .AND. IfValidAnd( Construction:AbvDeckInsulLayer > 0.5 ) .AND.
	                                                                      (IfValidAnd( Construction:AbvDeckInsulLayer != 99000 ) .OR. IfValidAnd( Construction:AbvDeckInsulLayerRVal > 0 ))) then  1  else  0  endif  }
	"Set Attic:BelowDeckRoofIns"		Attic:BelowDeckRoofIns		= {	if (FloorAreaOverCond > 0.5 .AND. IfValidAnd( Construction:CavityLayer       > 0.5 )) then  1  else  0  endif  }
;	mjb	8/21/14	- mod from FloorArea to FloorAreaOverCond to eliminate reporting Special Features for Garage
	"Check for Above Deck Attic Insulation" 	Proj:SpeclFeatrs:AboveDeckRoofIns		= {	SumAll( Attic:AboveDeckRoofIns )  }
																													;	if (ComponentCount( Attic ) < 0.5) then  0 
																													;	else if ( Attic:FloorAreaOverCond > 0.5 .AND. Attic:Construction:AbvDeckInsulLayer > 0.5 ) then 1 else 0 endif endif }
	"Write Above RDI Msg" 							Proj:SpeclFeatrs:AboveDeckRoofInsMsg	= {	if ( SpeclFeatrs:AboveDeckRoofIns > 0.5 ) then 1 else 0 endif }

	"Check for Below Deck Attic Insulation" 	Proj:SpeclFeatrs:BelowDeckRoofIns		= {	SumAll( Attic:BelowDeckRoofIns )  }
																													;	if (ComponentCount( Attic ) < 0.5) then  0
																													;	else if ( Attic:FloorAreaOverCond > 0.5 .AND. Attic:Construction:CavityLayer > 0.5 ) then 1 else 0 endif endif }
	"Write Below RDI Msg" 							Proj:SpeclFeatrs:BelowDeckRoofInsMsg	= {	if ( SpeclFeatrs:BelowDeckRoofIns > 0.5 ) then 1 else 0 endif }

; SAC 10/20/14 - added flag that accommodates multiple Attics in setting the global flag Proj:SpeclFeatrs:CoolRoof
	"Set Attic:SolReflSpclFtrs flag"		Attic:SolReflSpclFtrs	= {	if (FloorAreaOverCond < 0.5 .OR. RoofSolReflect <= 0.1) then  0
																							else if (RoofSolReflect >= 0.2) then  2  else  1  endif endif  }
	"Set CathedralCeiling:SolReflSpclFtrs flag"  ; SAC 4/14/18 - tic #960
	   CathedralCeiling:SolReflSpclFtrs	= {
	      if ((ParentComponentType() != "Zone" .AND. ParentComponentType() != "OtherZone") .OR.
	          RoofSolReflect <= 0.1) then  0
	      else if (Parent( CondFloorArea ) < 0.5) then  0
			else if (RoofSolReflect >= 0.2) then  2
			else  1  endif endif endif  }

;	mjb	corrected reflectance condition for cool roofs	9/20/13
;	mjb-10/14/13	added reporting for non-standard roofs as well as cool roofs
;	mjb	changed > to >=	7/2/14
;	mjb	changed >= to >	8/4/14
;	mjb	changed > to >= for COOL roofs	8/21/14	
;	mjb	8/21/14	- mod from FloorArea to FloorAreaOverCond to eliminate reporting Special Features for Garage
	"Check for Cool Roof" 				Proj:SpeclFeatrs:CoolRoof = {  max( MaxAll( Attic:SolReflSpclFtrs ), MaxAll( CathedralCeiling:SolReflSpclFtrs ) )  }
	"Check for Cool Roof-2" 			Proj:SpeclFeatrs:CoolRoof = {  if (LocalStatus( SpeclFeatrs:CoolRoof ) < 0.5) then  0  else  UNCHANGED  endif  }
									; previous logic when only a single Attic could exist
									;			if (ComponentCount( Attic ) < 0.5) then  0 else 
									;			if (SumAll( Attic:FloorAreaOverCond ) > 0.5 ) then
									;				if (Attic:RoofSolReflect >= 0.2 ) then 2 else  
									;					if (Attic:RoofSolReflect > 0.1 ) then 1 else 0 endif 
									;				endif
									;			else 0 endif endif }

	"Write Cool Roof Msg" 				Proj:SpeclFeatrs:CoolRoofMsg = { if ( SpeclFeatrs:CoolRoof > 1.5 ) then 2 else 
												if ( SpeclFeatrs:CoolRoof > 0.5 ) then 1 else 0 endif endif }
;	mjb	8/21/14	- mod to exclude Garage from Special Feature reporting
	"Check for Window Exterior Shading in Zones" 		Zone:ExtShade = { if ( MaxChild( Win:ExteriorShade ) > 1.5 ) then 1 else 0 endif }
	"Check for Window Exterior Shading in OtherZones" 	OtherZone:ExtShade = { if ( MaxChild( Win:ExteriorShade ) > 1.5 ) then 1 else 0 endif }      ; SAC 9/20/19 - OtherZone (MFamProto)
;	"Check for Window Exterior Shading in Garage" 		Garage:ExtShade = { if ( MaxChild( Win:ExteriorShade ) > 1.5 ) then 1 else 0 endif }
	"Check for Window Exterior Shading in Garage" 		Garage:ExtShade = {  0  }
	"Check for Window Exterior Shading in Project" 		Proj:SpeclFeatrs:ExtShade = { if ( MaxAll( Zone:ExtShade ) > 0.5 .OR. MaxAll( OtherZone:ExtShade ) > 0.5 .OR.
                                                                                         MaxAll( Garage:ExtShade ) > 0.5 ) then 1 else 0 endif }
	"Write Exterior Shading Msg" 				Proj:SpeclFeatrs:ExtShadeMsg = { if ( SpeclFeatrs:ExtShade > 0.5 ) then 1 else 0 endif }

; mjb-10/14/13	corrected rule logic for reporting overhangs and fins
;	mjb	8/21/14	- mod to exclude Garage from Special Feature reporting
	"Check for Window Overhangs and Fins in Zones" 		Zone:OvrHangsFins = { if ( MaxChild( Win:ModelFinsOverhang ) > 0.5 ) then 1 else 0 endif }
	"Check for Window Overhangs and Fins in OtherZones" 	OtherZone:OvrHangsFins = { if ( MaxChild( Win:ModelFinsOverhang ) > 0.5 ) then 1 else 0 endif }       ; SAC 9/20/19 - OtherZone (MFamProto)
;	"Check for Window Overhangs and Fins in Garage" 	Garage:OvrHangsFins = { if ( MaxChild( Win:ModelFinsOverhang ) > 0.5 ) then 1 else 0 endif }
	"Check for Window Overhangs and Fins in Garage" 	Garage:OvrHangsFins = {  0  }
	"Check for Window Overhangs and Fins in Project" 	Proj:SpeclFeatrs:WinOVerHngFin = { if ( MaxAll( Zone:OvrHangsFins ) > 0.5 .OR. MaxAll( OtherZone:OvrHangsFins ) > 0.5 .OR.
	                                                                                           MaxAll( Garage:OvrHangsFins ) > 0.5 ) then 1 else 0 endif }
	"Write Overhangs and Fins Msg" 				Proj:SpeclFeatrs:WinOVerHngFinMsg = { if ( SpeclFeatrs:WinOVerHngFin > 0.5 ) then 1 else 0 endif }

	"Check for Exposed Slab Fraction" 		Proj:SpeclFeatrs:ExposedSlab = { if (Proj:BldgCondZnSlabFlrArea < 1 ) then 0 else
												if ( ( Proj:ExpSlabFloorArea / Proj:BldgCondZnSlabFlrArea ) > 0.25 ) then 1 else 0 endif 
											    endif }
	"Write Exposed Slab Msg" 			Proj:SpeclFeatrs:ExposedSlabMsg = { if ( SpeclFeatrs:ExposedSlab > 0.5 ) then 1 else 0 endif }

	; SAC 6/2/16 - added reporting of SlabEdgeInsul & HeatedSlab (tic #678)
	"Check for SpeclFtr:SlabEdgeInsul" 		Proj:SpeclFeatrs:SlabEdgeInsul		= {	if (SumAcrossIf( SlabFloor:HasEdgeInsul, SlabFloor:CondZnArea > 0.1 )) then  1  else  0  endif  }
	"Write SpeclFtr:SlabEdgeInsul Msg" 		Proj:SpeclFeatrs:SlabEdgeInsulMsg	= {	if ( SpeclFeatrs:SlabEdgeInsul > 0.5 ) then  1  else  0  endif  }
	"Check for SpeclFtr:HeatedSlab" 			Proj:SpeclFeatrs:HeatedSlab			= {	if (SumAcrossIf( SlabFloor:HeatedSlab, SlabFloor:CondZnArea > 0.1 )) then  1  else  0  endif  }
	"Write SpeclFtr:HeatedSlab Msg" 			Proj:SpeclFeatrs:HeatedSlabMsg		= {	if ( SpeclFeatrs:HeatedSlab > 0.5 ) then  1  else  0  endif  }

	; SAC 5/2/16 - added reporting of AWF ExtWall area
	"Set ExtWall:AWFWallsArea"		ExtWall:AWFWallsArea	= {	if (ZoneArea < 0.1) then  0		; if no ZoneArea, then this is not a ExtWall child of a conditioned Zone
																				else if (LocalCompAssigned( Construction ) < 1) then  0		; no construction assigned
																				else if (IfValidAnd( Construction:FrameLayer = 425 ) .OR.	; "2x4 AWF"
																							IfValidAnd( Construction:FrameLayer = 625 ) )		; "2x6 AWF"
																				then	Area
																				else	0  endif endif endif  }
				; add logic pertaining to Status or Verified or exConstruction ??
	"Check for AWFWalls"		Proj:SpeclFeatrs:AWFWalls		= {	if (SumAll( ExtWall:AWFWallsArea ) > 0.1) then  1  else  0  endif  }
	"Write AWFWalls Msg" 	Proj:SpeclFeatrs:AWFWallsMsg	= {	if (SpeclFeatrs:AWFWalls > 0.5 ) then  1  else  0  endif }

	; SAC 6/2/16 - added reporting of Metal ExtWall area (tic #678)
	"Set ExtWall:MetalFrmArea"		ExtWall:MetalFrmArea	= {	if (ZoneArea < 0.1) then  0		; if no ZoneArea, then this is not a ExtWall child of a conditioned Zone
																				else if (LocalCompAssigned( Construction ) < 1) then  0		; no construction assigned
																				else if (IfValidAnd( Construction:Type == 1 ))		; "Steel Framed Wall"
																				then	Area
																				else	0  endif endif endif  }
				; add logic pertaining to Status or Verified or exConstruction ??
	"Check for MetalFramedWalls"	Proj:SpeclFeatrs:MetalFramedWalls		= {	if (SumAll( ExtWall:MetalFrmArea ) > 0.1) then  1  else  0  endif  }
	"Write MetalFramedWalls Msg" 	Proj:SpeclFeatrs:MetalFramedWallsMsg	= {	if (SpeclFeatrs:MetalFramedWalls > 0.5 ) then  1  else  0  endif }

	; SAC 6/2/16 - added reporting of SIP wall/floor/roof area (tic #678)
	"Set ExtWall:SIPArea"		ExtWall:SIPArea	= {	if (ZoneArea < 0.1) then  0		; if no ZoneArea, then this is not a child of a conditioned Zone
																		else if (LocalCompAssigned( Construction ) < 1) then  0		; no construction assigned
																		else if (IfValidAnd( Construction:Type == 5 ))		; "SIPS Wall"
																		then	Area
																		else	0  endif endif endif  }
	"Set Attic:SIPArea"			Attic:SIPArea		= {	if (FloorAreaOverCond < 0.1) then  0		; if no ZoneArea, then this is not a child of a conditioned Zone
																		else if (LocalCompAssigned( Construction ) < 1) then  0		; no construction assigned
																		else if (IfValidAnd( Construction:Type == 13 ))		; "SIPS Ceiling"
																		then	FloorAreaOverCond
																		else	0  endif endif endif  }
	"Set CathedralCeiling:SIPArea"	CathedralCeiling:SIPArea	= {	if (ZoneArea < 0.1) then  0		; if no ZoneArea, then this is not a child of a conditioned Zone
																							else if (LocalCompAssigned( Construction ) < 1) then  0		; no construction assigned
																							else if (IfValidAnd( Construction:Type == 13 ))		; "SIPS Ceiling"
																							then	Area
																							else	0  endif endif endif  }
	"Set ExteriorFloor:SIPArea"	ExteriorFloor:SIPArea	= {	if (ZoneArea < 0.1) then  0		; if no ZoneArea, then this is not a child of a conditioned Zone
																					else if (LocalCompAssigned( Construction ) < 1) then  0		; no construction assigned
																					else if (IfValidAnd( Construction:Type == 24 ))		; "SIPS Floor"
																					then	Area
																					else	0  endif endif endif  }
	"Set FloorOverCrawl:SIPArea"	FloorOverCrawl:SIPArea	= {	if (ZoneArea < 0.1) then  0		; if no ZoneArea, then this is not a child of a conditioned Zone
																					else if (LocalCompAssigned( Construction ) < 1) then  0		; no construction assigned
																					else if (IfValidAnd( Construction:Type == 24 ))		; "SIPS Floor"
																					then	Area
																					else	0  endif endif endif  }
	"Check for SIPAssembly"		Proj:SpeclFeatrs:SIPAssembly		= {	     if (SumAll( ExtWall:SIPArea          ) > 0.1) then  1
																							else if (SumAll( Attic:SIPArea            ) > 0.1) then  1
																							else if (SumAll( CathedralCeiling:SIPArea ) > 0.1) then  1
																							else if (SumAll( ExteriorFloor:SIPArea    ) > 0.1) then  1
																							else if (SumAll( FloorOverCrawl:SIPArea   ) > 0.1) then  1
																							else  0  endif endif endif endif endif  }
	"Write SIPAssembly Msg" 	Proj:SpeclFeatrs:SIPAssemblyMsg	= {	if (SpeclFeatrs:SIPAssembly > 0.5 ) then  1  else  0  endif }

; mjb	5/6/14 - add other assemblies
;  mjb   11/18/14 - modified rule to only set flag to 1 if Cathedral Ceiling is in conditioned zone
	"Check for Cathedral Ceiling in Assigned Cons" 		Cons:RptNonStd = { if ( CanAssignTo == 2 .AND. SumRevRef( CathedralCeiling:Construction, CathedralCeiling:ZoneArea) > 0.5 ) then 1 else 0 endif }
  ; SAC 12/31/15 - toggled OFF reporting of CathedralCeiling special feature flag - ticket #577 related to Cath Clg reported for Skylights (when no cath clg specified by user)
	"Check for Cathedral Ceiling flag" 						Proj:SpeclFeatrs:CathedralCeiling = { 0 }  ; if ( SumAll( Cons:RptNonStd ) > 0.5 ) then 1 else 0 endif }
	"Write Cathedral Ceiling Msg" 							Proj:SpeclFeatrs:CathedralCeilingMsg = { if ( SpeclFeatrs:CathedralCeiling > 0.5 ) then 1 else 0 endif }

;em 11/5/14 add R value limits for special feature mesages for raised floor and ceiling below attic
;	mjb	11/14/14 mods to make sure only reported for Conditioned zones and looks for both types of floor insulation reqs. (Raised and Concrete Raised)
; mjb 1/12/15 - changed to new lookup table for code levels
;	"Check for non-standard CBA in Assigned Cons" 		Cons:RptNonStd = { if ( CanAssignTo == 3 .AND. Type > 0 .AND. AssignedCondZoneArea > 0.5 .AND. CavityLayer > ClimateZoneTable( Global( Proj:ClimateZone ), 7 )) then 1 else 0 endif }
;	"Check for HighRvalIns in CeilBelowAttic" 				CeilingBelowAttic:HighRvalIns 			= { if ( Construction:CavityLayer > T24RClimateZoneDesignDay:CeilIns( "WeatherFileSet", Proj:WeatherFileSet, "ClimateZone", Proj:ClimateZone ) .AND. IfValidAnd( AreaOverCond > 0.5 ) ) then 1 else 0 endif }
   ; SAC 8/22/18 - switched reference of Construction:CavityLayer to Construction:CavityLayerRVal since CavityLayer no longer a true R-value (due to compressed insul items) (tic #1036)  (repeat of mod below for HighRvalIns Floors - tic #914)
	"Check for HighRvalIns in CeilBelowAttic" 				CeilingBelowAttic:HighRvalIns 			= {
         if ( Construction:CavityLayerRVal > T24RClimateZoneCodeBase:CeilIns( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) .AND. IfValidAnd( AreaOverCond > 0.5 ) )
         then 1 else 0 endif }
	"Check for HighRvalCeilIns in Zone"							Zone:HighRvalCeilIns							= { if ( ClgBlwAtticArea > 0.5 .AND. MaxChild( CeilingBelowAttic:HighRvalIns ) > 0.5 ) then 1 else 0 endif  }
	"Check for HighRvalCeilIns in OtherZone"					OtherZone:HighRvalCeilIns					= { if ( ClgBlwAtticArea > 0.5 .AND. MaxChild( CeilingBelowAttic:HighRvalIns ) > 0.5 ) then 1 else 0 endif  }     ; SAC 9/20/19 - OtherZone (MFamProto)
;	"Check for non-standard Ceiling Below Attic" 		Proj:SpeclFeatrs:NonStdCeilBelowAttic = { if ( SumAll( Cons:RptNonStd ) > 0.5 ) then 1 else 0 endif }
	"Check for HighRvalCeilIns in Project" 					Proj:SpeclFeatrs:NonStdCeilBelowAttic 		= { if ( SumAcrossif( Zone:HighRvalCeilIns, Zone:Type < 10 ) > 0.5 .OR.
                                                                                                            SumAcrossif( OtherZone:HighRvalCeilIns, OtherZone:Type < 10 ) > 0.5 ) then 1 else 0 endif }
	"Write non-standard Ceiling Below Attic Msg" 			Proj:SpeclFeatrs:NonStdCeilBelowAtticMsg = { if ( SpeclFeatrs:NonStdCeilBelowAttic > 0.5 ) then 1 else 0 endif }

;	"Check for non-standard Floor in Assigned Cons" 	Cons:RptNonStd = { if ( (CanAssignTo == 5 .OR. CanAssignTo == 8 .OR. CanAssignTo == 9) .AND. Type > 0 .AND. AssignedCondZoneArea > 0.5 .AND. CavityLayer > 19 ) then 1 else 0 endif }
   ; SAC 4/13/18 - switched reference of Construction:CavityLayer to Construction:CavityLayerRVal since CavityLayer no longer a true R-value (due to compressed insul items) (tic #914)
	"Check for HighRvalIns in FloorOverCrawl" 				FloorOverCrawl:HighRvalIns  = { 
         if ( Construction:Type < 25 ) then 
            if( Construction:CavityLayerRVal > T24RClimateZoneCodeBase:FloorIns( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) .AND. IfValidAnd( Area > 0.5 ) )
            then 1 else 0 endif
         else
            if( Construction:CavityLayerRVal > T24RClimateZoneCodeBase:ConcFloorIns( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) .AND. IfValidAnd( Area > 0.5 ) )
            then 1 else 0 endif
         endif }
	"Check for HighRvalIns in ExtFloor" 				      ExteriorFloor:HighRvalIns  = {
         if ( Construction:Type < 25 ) then 
            if( Construction:CavityLayerRVal > T24RClimateZoneCodeBase:FloorIns( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) .AND. IfValidAnd( Area > 0.5 ) )
            then 1 else 0 endif
         else
            if( Construction:CavityLayerRVal > T24RClimateZoneCodeBase:ConcFloorIns( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) .AND. IfValidAnd( Area > 0.5 ) )
            then 1 else 0 endif
         endif }
	"Check for HighRvalCeilIns in Zone"							Zone:HighRvalFloorIns						= { if ( MaxChild( ExteriorFloor:HighRvalIns ) > 0.5 .OR. MaxChild( FloorOverCrawl:HighRvalIns ) > 0.5 ) then 1 else 0 endif  }
	"Check for HighRvalCeilIns in OtherZone"					OtherZone:HighRvalFloorIns					= { if ( MaxChild( ExteriorFloor:HighRvalIns ) > 0.5 .OR. MaxChild( FloorOverCrawl:HighRvalIns ) > 0.5 ) then 1 else 0 endif  }     ; SAC 9/20/19 - OtherZone (MFamProto)
;	"Check for non-standard Floor" 							Proj:SpeclFeatrs:NonStdFloor = { if ( SumAll( Cons:RptNonStd ) > 0.5 ) then 1 else 0 endif }
	"Check for HighRvalCeilIns in Project" 					Proj:SpeclFeatrs:NonStdFloor 		= { if ( SumAcrossif( Zone:HighRvalFloorIns, Zone:Type < 10 ) > 0.5 .OR.
                                                                                                   SumAcrossif( OtherZone:HighRvalFloorIns, OtherZone:Type < 10 ) > 0.5 ) then 1 else 0 endif }
	"Write non-standard Floor Msg" 								Proj:SpeclFeatrs:NonStdFloorMsg = { if ( SpeclFeatrs:NonStdFloor > 0.5 ) then 1 else 0 endif }


;	mjb	remove Radiant Barrier as Special Feature	9/10/13
;	"Check for Radiant Barrier in Assigned Cons" 		Cons:RptNonStd = { if (IfValidAnd( Cons:RadiantBarrier > 0.5 ) .AND. IfValidAnd( AssignedCondZoneArea > 0.5 )) then 1 else 0 endif }
;	"Check for Radiant Barrier" 				Proj:SpeclFeatrs:RadiantBarrier = { if ( SumAll( Cons:RptNonStd ) > 0.5 ) then 1 else 0 endif }
;	"Set Radiant Barrier flag to zero" 			Proj:SpeclFeatrs:RadiantBarrier = {  0  }
	"Check for Raised Heel Truss in Assigned Cons" 		Cons:RptNonStd = { if (IfValidAnd( Cons:RaisedHeelTruss > 0.5 ) .AND. IfValidAnd( AssignedCondZoneArea > 0.5 )) then 1 else 0 endif }
	"Check for Raised Heel Truss" 				Proj:SpeclFeatrs:RHTruss = { if ( SumAll( Cons:RptNonStd ) > 0.5 ) then 1 else 0 endif }
	"Write Raised Heel Truss Msg" 				Proj:SpeclFeatrs:RHTrussMsg = { if (IfValidAnd( SpeclFeatrs:RHTruss > 0.5 )) then 1 else 0 endif }

; mjb 1/12/15 - changed to new lookup table for code levels
	"Check for High R-value Duct Ins" 			HVACSys:HiRvalDuctIns = {
         if (IfValidAnd( DistribSystem:FloorAreaServed > 0.5 ) .AND. 
             IfValidAnd( DistribSystem:DuctInsRvalue > T24RClimateZoneCodeBase:DuctRval( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ))
         then 1 else 0 endif }
	"Check for High R-value Duct Ins" 			Proj:SpeclFeatrs:DuctInsul = { if ( MaxAll( HVACSys:HiRvalDuctIns ) > 0.5 ) then 1 else 0 endif }
	"Write High R-value Duct Ins Msg" 			Proj:SpeclFeatrs:DuctInsulMsg = { if (IfValidAnd( SpeclFeatrs:DuctInsul > 0.5 )) then 1 else 0 endif }

	; SAC 6/2/16 - added reporting of NonStdDuctLoc (tic #678)
	"Check for HVACSys:NonStdDuctLoc[1] - Crawl" 	HVACSys:NonStdDuctLoc[1] 	= {	if (IfValidAnd( DistribSystem:FloorAreaServed > 0.5 ) .AND. 
																													 IfValidAnd( DistribSystem:Type =  2 ) ) then 1 else 0 endif }
	"Check for HVACSys:NonStdDuctLoc[2] - Other" 	HVACSys:NonStdDuctLoc[2] 	= {	if (IfValidAnd( DistribSystem:FloorAreaServed > 0.5 ) .AND. 
																													 IfValidAnd( DistribSystem:Type =  1 )==0 .AND.
																													 IfValidAnd( DistribSystem:Type =  2 )==0 .AND.
																													 IfValidAnd( DistribSystem:Type =  8 )==0 ) then 1 else 0 endif }
	"Check for SpeclFtr:DuctsInCrawlSpc" 	Proj:SpeclFeatrs:DuctsInCrawlSpc	 	= {	if ( SumAll( HVACSys:NonStdDuctLoc[1] ) > 0.5 ) then 1 else 0 endif }
	"Write SpeclFtr:DuctsInCrawlSpcMsg" 	Proj:SpeclFeatrs:DuctsInCrawlSpcMsg = {	if (IfValidAnd( SpeclFeatrs:DuctsInCrawlSpc > 0.5 )) then 1 else 0 endif }
	"Check for SpeclFtr:NonStdDuctLoc" 		Proj:SpeclFeatrs:NonStdDuctLoc		= {	if ( SumAll( HVACSys:NonStdDuctLoc[2] ) > 0.5 ) then 1 else 0 endif }
	"Write SpeclFtr:NonStdDuctLocMsg" 		Proj:SpeclFeatrs:NonStdDuctLocMsg 	= {	if (IfValidAnd( SpeclFeatrs:NonStdDuctLoc   > 0.5 )) then 1 else 0 endif }

	; SAC 6/14/16 - revised logic to take into account EnableClVent and to register TRUE when UnitClVentOption = 'Default Prescriptive Whole House Fan' (tic #678)
	; SAC 5/9/19 - added logic that accounts for ability to specify ClVent fans to Outside even when no cool-ventable attic exists (tic #1040)
	; SAC 8/17/19 - added logic to ensure WHF CFM > 0 for default prescrip. fan and  prevent 0 CFM default fan shown in the Special Features table (tic #880, #1091)
	"Check for Cool Vent System"			Proj:SpeclFeatrs:CoolVent = { if (IfValidAnd( EnableClVent > 0.5 )==0 .AND. IfValidAnd( LimitedClVent > 0.5 )==0) then  0
																							else if ((UnitClVentOption == 1 .OR. UnitClVentOption == 5) .AND.
																							         IfValidAnd( UnitClVentCFMTot > 0 )) then  1
																							else if (IfValidAnd( UnitClVentNumFans[1] > 0.5 ) .AND. IfValidAnd( UnitClVentCFM[1] > 0.5 )) then 1 else 0 endif endif endif }
	"Check for Cool Vent System"			Proj:SpeclFeatrs:CoolVent = { if (IfValidAnd( EnableClVent > 0.5 ) .AND. IfValidAnd( UnitClVentNumFans[2] > 0.5 ) .AND. IfValidAnd( UnitClVentCFM[2] > 0.5 )) then 1 else UNCHANGED endif }
	"Check for Cool Vent System"			Proj:SpeclFeatrs:CoolVent = { if (IfValidAnd( EnableClVent > 0.5 ) .AND. IfValidAnd( UnitClVentNumFans[3] > 0.5 ) .AND. IfValidAnd( UnitClVentCFM[3] > 0.5 )) then 1 else UNCHANGED endif }
	"Check for Cool Vent System"			Proj:SpeclFeatrs:CoolVent = { if (IfValidAnd( EnableClVent > 0.5 ) .AND. IfValidAnd( UnitClVentNumFans[4] > 0.5 ) .AND. IfValidAnd( UnitClVentCFM[4] > 0.5 )) then 1 else UNCHANGED endif }
	"Check for Cool Vent System"			Proj:SpeclFeatrs:CoolVent = { if (IfValidAnd( EnableClVent > 0.5 ) .AND. IfValidAnd( UnitClVentNumFans[5] > 0.5 ) .AND. IfValidAnd( UnitClVentCFM[5] > 0.5 )) then 1 else UNCHANGED endif }
	"Check for Cool Vent System"			Proj:SpeclFeatrs:CoolVent = { if (IfValidAnd( EnableClVent > 0.5 ) .AND. IfValidAnd( UnitClVentNumFans[6] > 0.5 ) .AND. IfValidAnd( UnitClVentCFM[6] > 0.5 )) then 1 else UNCHANGED endif }
	"Populate Cool Vent msg"				Proj:SpeclFeatrs:CoolVentRptMsg = { if (IfValidAnd( SpeclFeatrs:CoolVent > 0.5 )) then 1 else 0 endif }

; EM 1/20/15 - set variable and fixed CFI properties as integers
   ; SAC 7/24/19 - turn off CFI coolvent special feture messages for 2019+ projects (now both HERS features) (tic #1104)
	"Check for varaible CFI vent"				Proj:SpeclFeatrs:VarCFIClVent			= { if (EnergyCodeYearNum <= 2016 .AND. SumAll( HVACSys:IsVariableCFIClVent ) > 0) then 1 else 0 endif }		; SAC 2/17/15 - fixed bugs in if statements / SumAll() function calls
	"Check for fixed CFI vent"					Proj:SpeclFeatrs:FixCFIClVent			= { if (EnergyCodeYearNum <= 2016 .AND.  SumAll( HVACSys:IsFixedCFIClVent ) > 0) then 1 else 0 endif }
	"Check for varaible CFI vent report"	Proj:SpeclFeatrs:VarCFIClVentRptMsg = { if (EnergyCodeYearNum <= 2016 .AND. IfValidAnd( SpeclFeatrs:VarCFIClVent > 0.5 )) then 1 else 0 endif }
	"Check for fixed CFI vent report"		Proj:SpeclFeatrs:FixCFIClVentRptMsg = { if (EnergyCodeYearNum <= 2016 .AND. IfValidAnd( SpeclFeatrs:FixCFIClVent > 0.5 )) then 1 else 0 endif }

;	mjb	8/22/14	- needs to work for HtPumps too...
;	mjb	10/30/14	- mods to make all reporting rules work without special reporting parameters that are no longer needed
;	"Check for No Cooling in HVACSys" 							HVACSys:NoCoolingRpt 			= { if ( IfValidAnd( CoolSystem:TypeRpt < 2 ) .AND. IfValidAnd( NumHtPumpSystemTypes < 1 ) .AND. IfValidAnd( FloorAreaServed > 0.5 ) ) then 1 else 0 endif }
	"Check for No Cooling in HVACSys" 							HVACSys:NoCoolingRpt 			= { if ( IfValidAnd( CoolSystem:Type < 2 ) .AND. IfValidAnd( NumHtPumpSystemTypes < 1 ) .AND. IfValidAnd( FloorAreaServed > 0.5 ) ) then 1 else 0 endif }
	"Check for No Cooling in Project" 							Proj:SpeclFeatrs:NoCooling 	= { if ( MaxAll(HVACSys:NoCoolingRpt) > 0.5 ) then 1 else 0 endif }
	"Write No Cooling Msg" 											Proj:SpeclFeatrs:NoCoolingMsg = { if ( SpeclFeatrs:NoCooling > 0.5 ) then 1 else 0 endif }
;	"debug"		HVACSys:Action	= {	MessageBox( "reporting -- HVACSys '%s':  CoolSystem:TypeRpt = %g  NoCoolingRpt = %g", Name, CoolSystem:TypeRpt, NoCoolingRpt )  }
;	mjb	7/29/14	added Special Feature message for les than 40ft of added duct
   ; added logic to check 40' for <2022 codes and 25' for 2022+ - SAC 09/23/22 (tic #1296)
	"Check for Short Ducts in Project" 							Proj:SpeclFeatrs:AddedShortDuct 		= { if ( (EnergyCodeYearNum <  2022 .AND. SumAcrossIf(HVACDist:IsLessThanFortyFt, HVACDist:FloorAreaServed > 0 ) > 0.5) .OR.
                                                                                                      (EnergyCodeYearNum >= 2022 .AND. SumAcrossIf(HVACDist:IsLessThan25Ft,    HVACDist:FloorAreaServed > 0 ) > 0.5) ) then 1 else 0 endif }
	"Write Short Duct Msg" 											Proj:SpeclFeatrs:AddedShortDuctMsg 	= { if ( SpeclFeatrs:AddedShortDuct > 0.5 ) then 1 else 0 endif }

   "Set Proj:SpeclFeatrs:RptElecSpcHtgExcpt[1] - AlteredElecResistanceSpaceHeatingNonDucted"          Proj:SpeclFeatrs:RptElecSpcHtgExcpt[1] =     ; SAC 10/02/22 (tic #1301)
      {  if (EnergyCodeYearNum >= 2022 .AND. SumAcrossIf( HVACHeat:FloorAreaServed,  HVACHeat:ApplyElecSpcHtgExcpt = 1 ) > 0.5) then  1  else  0  endif  }
   "Set Proj:SpeclFeatrs:RptElecSpcHtgExcpt[2] - AlteredElecResistanceSpaceHeatingNoDuctedCooling"    Proj:SpeclFeatrs:RptElecSpcHtgExcpt[2] =
      {  if (EnergyCodeYearNum >= 2022 .AND. SumAcrossIf( HVACHeat:FloorAreaServed,  HVACHeat:ApplyElecSpcHtgExcpt = 2 ) > 0.5) then  1  else  0  endif  }
   "Set Proj:SpeclFeatrs:RptElecSpcHtgExcpt[3] - AlteredElecResistanceSpaceHeatingClimateZones7or15"  Proj:SpeclFeatrs:RptElecSpcHtgExcpt[3] =
      {  if (EnergyCodeYearNum >= 2022 .AND. SumAcrossIf( HVACHeat:FloorAreaServed,  HVACHeat:ApplyElecSpcHtgExcpt = 3 ) > 0.5) then  1  else  0  endif  }

;       Updated based on changes to address (tic #707)
	; SAC 6/2/16 - added reporting of Recird DHW scenarios (tic #678)
;	"Check for DHWSys:SpeclFeatrsFlags[1] - Pipe Insulation, All Lines" 
;					DHWSys:SpeclFeatrsFlags[1]		= { if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. (SystemType == 4096 .OR. SystemType == 8392704) ) then 1 else 0 endif }
;																	;     4096, "Pipe Insulation, All Lines"  	;  8392704, "(HERS req'd) Pipe Insulation, All Lines" 
;	"Check for DHWSys:SpeclFeatrsFlags[2] - Parallel Piping - Non-Central" 
;					DHWSys:SpeclFeatrsFlags[2]		= { if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. (SystemType == 4608 .OR. SystemType == 8393216) .AND. IfValidAnd( CentralDHW > 0.5 )==0 ) then 1 else 0 endif }
;																	;     4608, "Parallel Piping"  	;  8393216, "(HERS req'd) Parallel Piping"    - Non-Central
;	"Check for DHWSys:SpeclFeatrsFlags[3] - Parallel Piping - Central" 
;					DHWSys:SpeclFeatrsFlags[3]		= { if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. (SystemType == 4608 .OR. SystemType == 8393216) .AND. IfValidAnd( CentralDHW > 0.5 ) ) then 1 else 0 endif }
;																	;     4608, "Parallel Piping"  	;  8393216, "(HERS req'd) Parallel Piping"    - Central
;	"Check for DHWSys:SpeclFeatrsFlags[4] - Recirculation, Non-Demand Control" 
;					DHWSys:SpeclFeatrsFlags[4]		= { if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND.  SystemType == 4992 ) then 1 else 0 endif }
;																	;     4992, "Recirculation, Non-Demand Control"  
;	"Check for DHWSys:SpeclFeatrsFlags[5] - Recirculation, Demand Control Push Button" 
;					DHWSys:SpeclFeatrsFlags[5]		= { if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. (SystemType == 5248 .OR. SystemType == 8393856) ) then 1 else 0 endif }
;																	;     5248, "Recirculation, Demand Control Push Button"  	;  8393856, "(HERS req'd) Recirculation, Demand Control Push Button" 
;	"Check for DHWSys:SpeclFeatrsFlags[6] - Recirculation, Demand Control Occupancy/Motion" 
;					DHWSys:SpeclFeatrsFlags[6]		= { if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. (SystemType == 5504 .OR. SystemType == 8394112) ) then 1 else 0 endif }
;																	;     5504, "Recirculation, Demand Control Occupancy/Motion"  	;  8394112, "(HERS req'd) Recirculation, Demand Control Occupancy/Motion" 

;       08/24/16 - CG Updated based on changes to address (tic #707)
 	"Check for DHWSys:SpeclFtrMFRecircDemCtrl - Multi-family: Recirculation demand control" 
   DHWSys:SpeclFtrMFRecircDemCtrl		= { 
    if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. 
         IfValidAnd( CentralDHW > 0.5 ) .AND. 
         IfValidAnd( MFamDistType == 6336) ) ;Special Feture "Multi-family: Recirculation demand control" is fixed
    then 1 
    else 0 
    endif }


 	"Check for DHWSys:SpeclFtrMFNLpNRecirc - Multi-family: No loops or recirc pump"  
   DHWSys:SpeclFtrMFNLpNRecirc		= { 
    if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. 
         IfValidAnd( CentralDHW > 0.5 ) .AND. 
         IfValidAnd( MFamDistType == 0 ) ) 
    then 1 
    else 0 
    endif }

;       08/25/16 - CG Updated based on changes to address (tic #707)
 	"Check for DHWSys:SpeclFtrMFRecircNDemCtrl - Multi-family: Recirculating with no control (continuous pumping)" 
   DHWSys:SpeclFtrMFRecircNDemCtrl		= { 
    if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. 
         IfValidAnd( CentralDHW > 0.5 ) .AND. 
         IfValidAnd(MFamDistType == 5056) ) 
    then 1 
    else 0 
    endif }

;	08/24/16 - CG updated based on changes to address (tic #707)
 	"Check for DHWSys:SpeclFtrMFRecircTempMod - Multi-family: Recirculating with temperature modulation" 
   DHWSys:SpeclFtrMFRecircTempMod	= { 
    if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. 
         IfValidAnd( CentralDHW > 0.5 ) .AND. 
         IfValidAnd( MFamDistType == 6592) ) 
    then 1 
    else 0 
    endif }

;	08/24/16 - CG updated based on changes to address (tic #707)
 	"Check for DHWSys:SpeclFtrMFRecircTempModMon - Multi-family: Recirculating with temperature modulation and monitoring" 
   DHWSys:SpeclFtrMFRecircTempModMon	= { 
    if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. 
         IfValidAnd( CentralDHW > 0.5 ) .AND. 
         IfValidAnd( MFamDistType == 6848) ) 
    then 1 
    else 0 
    endif }
 	"Check for DHWSys:SpeclFtrParaPipeCntrl - Central parallel piping"
 					DHWSys:SpeclFtrParaPipeCntrl		= { if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. (SystemType == 4608) .AND. IfValidAnd( CentralDHW < 0.5 ) ) then 1 else 0 endif }

;	08/25/16 - CG updated based on changes to address (tic #707)
 	"Check for DHWSys:SpeclFtrPipeInsul - Pipe insulation, all lines"
   DHWSys:SpeclFtrPipeInsul		= { 
    if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. 
         IfValidAnd(SystemType == 4096)) ; 08/26/16 - CG updates to logic
    then 1 
    else 0 
    endif }
 					
;	08/25/16 - CG updated based on changes to address (tic #707)
 	"Check for DHWSys:SpeclFtrPointOfUse - Point Of Use"
   DHWSys:SpeclFtrPointOfUse		= { 
    if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. 
         IfValidAnd( CentralDHW < 0.5 ) .AND. 
         IfValidAnd(SystemType == 4609) ) ; Correct System Type ID# for "Point of Use"
    then 1 
    else 0 
    endif }
    
 	"Check for DHWSys:SpeclFtrRecircDemOcc - Recirculating with demand control, occupancy/motion sensor"
 					DHWSys:SpeclFtrRecircDemOcc		= { if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. (SystemType == 5504) .AND. IfValidAnd( CentralDHW < 0.5 ) ) then 1 else 0 endif }
 	"Check for DHWSys:SpeclFtrRecircDemPBtn - Recirculating with demand control, push button"
 					DHWSys:SpeclFtrRecircDemPBtn		= { if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. (SystemType == 5248) .AND. IfValidAnd( CentralDHW < 0.5 ) ) then 1 else 0 endif }
 	"Check for DHWSys:SpeclFtrRecircNDemCtrl - Recirculating with non-demand control (continuous pumping)"
 					DHWSys:SpeclFtrRecircNDemCtrl		= { if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. (SystemType == 4992) .AND. IfValidAnd( CentralDHW < 0.5 ) ) then 1 else 0 endif }
					
; Delete two lines below SDS ( being used as a reference)
;        "Check for All Pipes Insulated"				DHWSys:HERSCheck:AllPipesIns = { if ( DHWSys:SystemType == 8392704 .AND. Status != 1 ) then 1 else 0 endif }
;	"Write AllPipesIns Msg" 						DHWSys:HERSCheck:PipeInsRptMsg = { if ( HERSCheck:AllPipesIns > 0.5 ) then DHWSys:SystemType else UNDEFINED endif }

	"Check for SpeclFtr:DHWMFRecircDemCtrl" 	Proj:SpeclFeatrs:DHWMFRecircDemCtrl   	= {	if ( SumAll( DHWSys:SpeclFtrMFRecircDemCtrl ) > 0.5 ) then 1 else 0 endif }
	"Check for SpeclFtr:DHWMFNLpNRecirc"    	Proj:SpeclFeatrs:DHWMFNLpNRecirc   	= {	if ( SumAll( DHWSys:SpeclFtrMFNLpNRecirc ) > 0.5 ) then 1 else 0 endif }
	"Check for SpeclFtr:DHWMFRecircNDemCtrl"	Proj:SpeclFeatrs:DHWMFRecircNDemCtrl   	= {	if ( SumAll( DHWSys:SpeclFtrMFRecircNDemCtrl ) > 0.5 ) then 1 else 0 endif }
	"Check for SpeclFtr:DHWMFRecircTempMod" 	Proj:SpeclFeatrs:DHWMFRecircTempMod     = {	if ( SumAll( DHWSys:SpeclFtrMFRecircTempMod ) > 0.5 ) then 1 else 0 endif }
	"Check for SpeclFtr:DHWMFRecircTempModMon"  	Proj:SpeclFeatrs:DHWMFRecircTempModMon 	= {	if ( SumAll( DHWSys:SpeclFtrMFRecircTempModMon ) > 0.5 ) then 1 else 0 endif }
	"Check for SpeclFtr:DHWParaPipeCntrl"   	Proj:SpeclFeatrs:DHWParaPipeCntrl   	= {	if ( SumAll( DHWSys:SpeclFtrParaPipeCntrl ) > 0.5 ) then 1 else 0 endif }
	"Check for SpeclFtr:DHWPipeInsul"       	Proj:SpeclFeatrs:DHWPipeInsul       	= {	if ( SumAll( DHWSys:SpeclFtrPipeInsul ) > 0.5 ) then 1 else 0 endif }
	"Check for SpeclFtr:DHWPointOfUse"       	Proj:SpeclFeatrs:DHWPointOfUse       	= {	if ( SumAll( DHWSys:SpeclFtrPointOfUse ) > 0.5 ) then 1 else 0 endif }
	"Check for SpeclFtr:DHWRecircDemOcc"    	Proj:SpeclFeatrs:DHWRecircDemOcc    	= {	if ( SumAll( DHWSys:SpeclFtrRecircDemOcc ) > 0.5 ) then 1 else 0 endif }
	"Check for SpeclFtr:DHWRecircDemPBtn"   	Proj:SpeclFeatrs:DHWRecircDemPBtn   	= {	if ( SumAll( DHWSys:SpeclFtrRecircDemPBtn ) > 0.5 ) then 1 else 0 endif }
	"Check for SpeclFtr:DHWRecircNDemCtrl"  	Proj:SpeclFeatrs:DHWRecircNDemCtrl  	= {	if ( SumAll( DHWSys:SpeclFtrRecircNDemCtrl ) > 0.5 ) then 1 else 0 endif }

	"Write SpeclFtr:DHWMFRecircDemCtrlMsg"        	Proj:SpeclFeatrs:DHWMFRecircDemCtrlMsg  = {	if ( SpeclFeatrs:DHWMFRecircDemCtrl 	> 0.5 ) then 1 else 0 endif }
	"Write SpeclFtr:DHWMFNLpNRecircMsg"        	Proj:SpeclFeatrs:DHWMFNLpNRecircMsg     = {	if ( SpeclFeatrs:DHWMFNLpNRecirc	> 0.5 ) then 1 else 0 endif }
	"Write SpeclFtr:DHWMFRecircNDemCtrlMsg"        	Proj:SpeclFeatrs:DHWMFRecircNDemCtrlMsg = {	if ( SpeclFeatrs:DHWMFRecircNDemCtrl    > 0.5 ) then 1 else 0 endif }
	"Write SpeclFtr:DHWMFRecircTempModMsg"        	Proj:SpeclFeatrs:DHWMFRecircTempModMsg  = {	if ( SpeclFeatrs:DHWMFRecircTempMod      > 0.5 ) then 1 else 0 endif }
	"Write SpeclFtr:DHWMFRecircTempModMonMsg"       Proj:SpeclFeatrs:DHWMFRecircTempModMonMsg	= {	if ( SpeclFeatrs:DHWMFRecircTempModMon      > 0.5 ) then 1 else 0 endif }
	"Write SpeclFtr:DHWParaPipeCntrlMsg"    	Proj:SpeclFeatrs:DHWParaPipeCntrlMsg  	= {	if ( SpeclFeatrs:DHWParaPipeCntrl  	> 0.5 ) then 1 else 0 endif }
	"Write SpeclFtr:DHWPipeInsulMsg"        	Proj:SpeclFeatrs:DHWPipeInsulMsg      	= {	if ( SpeclFeatrs:DHWPipeInsul      > 0.5 ) then 1 else 0 endif }
	"Write SpeclFtr:DHWPointOfUse"        		Proj:SpeclFeatrs:DHWPointOfUseMsg      	= {	if ( SpeclFeatrs:DHWPointOfUse      > 0.5 ) then 1 else 0 endif }
	"Write SpeclFtr:DHWRecircDemOccMsg"     	Proj:SpeclFeatrs:DHWRecircDemOccMsg   	= {	if ( SpeclFeatrs:DHWRecircDemOcc   > 0.5 ) then 1 else 0 endif }
	"Write SpeclFtr:DHWRecircDemPBtnMsg"    	Proj:SpeclFeatrs:DHWRecircDemPBtnMsg  	= {	if ( SpeclFeatrs:DHWRecircDemPBtn  > 0.5 ) then 1 else 0 endif }
	"Write SpeclFtr:DHWRecircNDemCtrlMsg"   	Proj:SpeclFeatrs:DHWRecircNDemCtrlMsg 	= {	if ( SpeclFeatrs:DHWRecircNDemCtrl > 0.5 ) then 1 else 0 endif }
; 	"Check for SpeclFtr:DHWParaPipeNCntrl"  	Proj:SpeclFeatrs:DHWParaPipeNCntrl  	= {	if ( SumAll( DHWSys:SpeclFeatrsFlags[3] ) > 0.5 ) then 1 else 0 endif }
; 	"Write SpeclFtr:DHWParaPipeNCntrlMsg"   	Proj:SpeclFeatrs:DHWParaPipeNCntrlMsg 	= {	if ( SpeclFeatrs:DHWParaPipeNCntrl > 0.5 ) then 1 else 0 endif }

	; SAC 6/2/16 - added reporting of SFamSolarWH (tic #678)   - SAC 2/19/20 - revised logic for new DHWSolarSys assignment (tic #1198)
	"Check for DHWSys:SFamSolarWH" 			DHWSys:SFamSolarWH					=
	   {  if ( IfValidAnd( Proj:IsMultiFamily < 0.5 ) .AND. IfValidAnd( FloorAreaServed[1] > 0.1 ) )
         then  if (     IfValidAnd( Proj:AnalysisVersion >= 190102 )    .AND. IfValidAnd( DHWSolarSysRef:ErrID = 0 )) then  2
               else if (IfValidAnd( Proj:AnalysisVersion >= 190102 )==0 .AND. IfValidAnd( SolFracAnnRpt > 0 ) ) then  1
               else  0  endif endif
         else  0  endif }
	"Check for SpeclFtr:SFamSolarWH" 		Proj:SpeclFeatrs:SFamSolarWH 		= { if ( SumAll( DHWSys:SFamSolarWH ) > 0.5 ) then 1 else 0 endif }
	"Write SpeclFtr:SFamSolarWH Msg" 		Proj:SpeclFeatrs:SFamSolarWHMsg 	= { if ( SpeclFeatrs:SFamSolarWH > 0.5 ) then MaxAll( DHWSys:SFamSolarWH ) else 0 endif }

	; SDS 8/2/16 - added reporting of MFamSolarWH (tic #707)   - SAC 2/19/20 - revised logic for new DHWSolarSys assignment (tic #1198)
	"Check for DHWSys:MFamSolarWH" 			DHWSys:MFamSolarWH					=
	   {  if ( IfValidAnd( Proj:IsMultiFamily > 0.5 ) .AND. IfValidAnd( FloorAreaServed[1] > 0.1 ) )
         then  if (     IfValidAnd( Proj:AnalysisVersion >= 190102 )    .AND. IfValidAnd( DHWSolarSysRef:ErrID = 0 )) then  2
               else if (IfValidAnd( Proj:AnalysisVersion >= 190102 )==0 .AND. IfValidAnd( SolFracAnnRpt > 0 ) ) then  1
               else  0  endif endif
         else  0  endif }
	"Check for SpeclFtr:MFamSolarWH" 		Proj:SpeclFeatrs:MFamSolarWH 		= { if ( SumAll( DHWSys:MFamSolarWH ) > 0.5 ) then 1 else 0 endif }
	"Write SpeclFtr:MFamSolarWH Msg" 		Proj:SpeclFeatrs:MFamSolarWHMsg 	= { if ( SpeclFeatrs:MFamSolarWH > 0.5 ) then MaxAll( DHWSys:MFamSolarWH ) else 0 endif }

	"Check for SpeclFtr:NEEAHtPumpWtrHtr"  Proj:SpeclFeatrs:NEEAHtPumpWtrHtr     	= {	if ( SumAll( DHWHeater:IsNEEAHtPumpWtrHtr ) > 0.5 ) then 1 else 0 endif }	; SAC 7/5/17 - tic #805
	"Write SpeclFtr:NEEAHtPumpWtrHtrMsg"  	Proj:SpeclFeatrs:NEEAHtPumpWtrHtrMsg  	= {	if ( SpeclFeatrs:NEEAHtPumpWtrHtr > 0.5 ) then 1 else 0 endif }	; SAC 7/5/17 - tic #805

	"Check for SpeclFtr:BatterySystem"  Proj:SpeclFeatrs:BatterySystem     	= {	if (IfValidAnd( SimulateBattery > 0.5 ) .AND. IfValidAnd( BattGridHarmCredit > 0.5 )==0) then 1 else 0 endif }	; SAC 7/12/17 - tic #863
   ; SAC 2/20/18 - revised battery capacity decimal precision from (input)->2 (tic #921)
	"Write SpeclFtr:BatterySystemMsg"  	Proj:SpeclFeatrs:BatterySystemMsg  	= {	if ( SpeclFeatrs:BatterySystem < 0.5 ) then UNDEFINED
	                                                                              else  Format( "Battery System: %s kWh", FltToStr( BattMaxCap, 2, 0, 0, 1 ) )  endif }	; SAC 7/12/17 - tic #863

	"Check for SpeclFtr:SelfUtilCredit" Proj:SpeclFeatrs:SelfUtilCredit   	= {	if (IfValidAnd( SimulateBattery > 0.5 ) .AND. IfValidAnd( BattGridHarmCredit > 0.5 )) then 1 else 0 endif }	   ; SAC 5/23/19 / SAC 5/24/19
	"Write SpeclFtr:SelfUtilCreditMsg"  Proj:SpeclFeatrs:SelfUtilCreditMsg 	= {	if ( SpeclFeatrs:SelfUtilCredit < 0.5 ) then UNDEFINED
	                                                                              else  Format( "Battery System: %s kWh (Self Utilization Credit taken)", FltToStr( BattMaxCap, 2, 0, 0, 1 ) )  endif }
END
;*************************************************************************


;*************************************************************************
RULELIST "Force_Existing_HVACDist_DuctLeakage" 1 0 0 0
;*************************************************************************
	"Reset DuctLeakage enumeration for Existing"		HVACDist:DuctLeakage	= { 900	}
;	"debug"		HVACDist:Action	= {	MessageBox( "reporting -- HVACDist '%s':  DuctLeakage = %s", Name, LocalSymbolString(DuctLeakage) )  }
END

; SAC 8/12/13 - rulelists that create HERS objects in a manner where their assignment to existing objects in the model are 'user-defined', and therefore persist in project files
; mjb 9/1/13 - mods to delete HERSHVACSys and add HERSCool, HERSDist and HERSFan
;*************************************************************************
RULELIST  "CreateAndAssignAsUserDefined_Proj_HERSOther" 1 0 1 0
	"Create Proj:HERSProj object & assign as user-defined"		Proj:HERSProj	= {	CreateComp( HERSOther, Local( Name ) + "-hers-proj" )  }
END
;*************************************************************************
RULELIST  "CreateAndAssignAsUserDefined_HVACCool_HERSCool" 1 0 1 0
	"Create HVACCool:HERSCheck object & assign as user-defined"		HVACCool:HERSCheck	= {	CreateComp( HERSCool, Local( Name ) + "-hers-cool" )  }
END
;*************************************************************************
RULELIST  "CreateAndAssignAsUserDefined_HVACHtPump_HERSCool" 1 0 1 0
	"Create HVACHtPump:HERSCheck object & assign as user-defined"		HVACHtPump:HERSCheck	= {	CreateComp( HERSCool, Local( Name ) + "-hers-cool" )  }
END
;************************************************************************* - SAC 3/18/19
RULELIST  "CreateAndAssignAsUserDefined_HVACHtPump_HERSHeatRef" 1 0 1 0
	"Create HVACHtPump:HERSHeatRef object & assign as user-defined"	HVACHtPump:HERSHeatRef	= {	CreateComp( HERSHeat, Local( Name ) + "-hers-heat" )  }
END
;*************************************************************************
RULELIST  "CreateAndAssignAsUserDefined_HVACHtPump_HERSHtPump" 1 0 1 0
	"Create HVACHtPump:HERSHtPumpRef object & assign as user-defined"		HVACHtPump:HERSHtPumpRef	= {	CreateComp( HERSHtPump, Local( Name ) + "-hers-htpump" )  }
END
;*************************************************************************
RULELIST  "CreateAndAssignAsUserDefined_HVACDist_HERSDist" 1 0 1 0
	"Create HVACDist:HERSCheck object & assign as user-defined"		HVACDist:HERSCheck	= {	CreateComp( HERSDist, Local( Name ) + "-hers-dist" )  }
END
;*************************************************************************
RULELIST  "CreateAndAssignAsUserDefined_HVACFan_HERSFan" 1 0 1 0
	"Create HVACFan:HERSCheck object & assign as user-defined"		HVACFan:HERSCheck	= {	CreateComp( HERSFan, Local( Name ) + "-hers-fan" )  }
END
;*************************************************************************
;RULELIST  "CreateAndAssignAsUserDefined_Proj_HERSCool" 1 0 1 0
;	"Create Proj:HERSCool object & assign as user-defined"		Proj:HERSCool	= {	CreateComp( HERSCool, Local( Name ) + "-hers-cool-proj" )  }
;END
;*************************************************************************
RULELIST  "CreateAndAssignAsUserDefined_Proj_HERSDist" 1 0 1 0
	"Create Proj:HERSDist object & assign as user-defined"		Proj:HERSDist	= {	CreateComp( HERSDist, Local( Name ) + "-hers-dist-proj" )  }
END
;*************************************************************************
RULELIST  "CreateAndAssignAsUserDefined_Proj_HERSFan" 1 0 1 0
	"Create Proj:HERSFan object & assign as user-defined"		Proj:HERSFan	= {	CreateComp( HERSFan, Local( Name ) + "-hers-fan-proj" )  }
END
;*************************************************************************
RULELIST  "CreateAndAssignAsUserDefined_DHWSys_HERSDHWSys" 1 0 1 0
	"Create DHWSys:HERSCheck object & assign as user-defined"		DHWSys:HERSCheck	= {	CreateComp( HERSDHWSys, Local( Name ) + "-hers-dhw" )  }
END
;*************************************************************************
RULELIST  "CreateAndAssignAsUserDefined_Proj_HERSDHWSys" 1 0 1 0
	"Create Proj:HERSDHW object & assign as user-defined"		Proj:HERSDHW	= {	CreateComp( HERSDHWSys, Local( Name ) + "-hers-dhw-proj" )  }
END
;*************************************************************************
RULELIST  "CreateAndAssignAsUserDefined_Proj_SpeclFtr" 1 0 1 0
	"Create Proj:SpeclFeatrs object & assign as user-defined"		Proj:SpeclFeatrs	= {	CreateComp( SpeclFtr, Local( Name ) + "-specl-featrs" )  }
END
;*************************************************************************

;*************************************************************************  SAC 5/10/19 - split out rules that populate HERSCool & HERSHeat for 2016 & earlier code vints vs. HERSHtPump for 2019+ models
RULELIST  "CreateAndAssignAsUserDefined_HVACHtPump_HERSCoolHeat_Populate" 1 0 0 0

;	mjb	7/17/14	modify HVACHtPump airflow check to set flag only for ducted systems, and set flag regardless of No Cooling system selection
;	"HtPump - Check for CFM per Ton" 		HVACHtPump:HERSCheck:AHUAirFlow = { if ( FloorAreaServed > 0.5 .AND. IfValidAnd(IsClSysCFMperTon > 0.5) ) then
;																											if ( Type > 1 .AND. Type < 16 ) then 1 else 0 endif 
;											     														else 0 endif }
;	"Check for CFM per Ton" 					HVACHtPump:HERSCheck:AHUAirFlow = { 	if ( FloorAreaServed > 0.5 .AND. IfValidAnd(IsClSysCFMperTon > 0.5) .AND. MaxRevRef( HVACSys:HtPumpSystem, HVACSys:CoolDuctedRpt ) > 0.5 .AND. MaxRevRef( HVACSys:HtPumpSystem, HVACSys:Status ) > 1.5 )
;																												then 1 else 0 endif	}
;	mjb	11/5/14	modify HtPump HERS rules so that ALL HtPump performance info is reported  issue #377
;	"Check for CFM per Ton" 					HVACHtPump:HERSCheck:AHUAirFlow = { 	if ( FloorAreaServed > 0.5 .AND. IfValidAnd(IsClSysCFMperTon > 0.5) .AND. MaxRevRef( HVACSys:HtPumpSystem, HVACSys:Status ) > 1.5 )
;																												then 1 else 0 endif	}
; SAC 4/21/15 - added check for IsClSysCFMperTon > 0.5 before setting AHUAirFlow
; SAC 4/23/15 - added check to ensure that CoolDuctedRpt is set for at least one system that references this equipment
; SAC 3/14/17 - applied same mod here as done for HVACCool on 8/28/16: added check to prevent setting HERS air flow for Altered systems where CFMperTon <= 350
; SAC 3/14/17 - added logic to ensure AHUAirFlow IS set for HtPump of Alt or Exist HVACSys combined w/ Alt or New Ducts (tic #764, runs 4,5,10,11)
; SAC 3/14/17 - added logic to ensure AHUAirFlow NOT set for HtPumps of New HVACSys combined w/ Existing Ducts (tic #764, run #6)
; SAC 6/12/18 - added logic to ensure AHUAirFlow NOT set for Cool of New HVACSys combined w/ Existing+New Ducts (tic #1022, DAR comment 6/7/18)
	"Check for CFM per Ton" 	HVACHtPump:HERSCheck:AHUAirFlow = {
	      if ( MaxRevRef( HVACSys:HtPumpSystem, HVACSys:HtPmpFlrAreaServed ) > 0.5 .AND.
			     MaxRevRef( HVACSys:HtPumpSystem, HVACSys:CoolDuctedRpt ) > 0.5 .AND.
              ( IfValidAnd( IsClSysCFMperTon > 0.5 ) .OR. 
                ( MaxRevRef( HVACSys:HtPumpSystem, HVACSys:DuctStatusFlag ) < 3.5 .AND.
                  MinRevRef( HVACSys:HtPumpSystem, HVACSys:DuctStatusFlag ) > 1.5 ) ) )
         then  if ( MaxRevRef( HVACSys:HtPumpSystem, HVACSys:StatusArray ) < 2.5 .AND.
                    MaxRevRef( HVACSys:HtPumpSystem, HVACSys:DuctStatusFlag ) < 3.5 .AND.
                    MinRevRef( HVACSys:HtPumpSystem, HVACSys:DuctStatusFlag ) > 1.5 )
               then  1     ; set reporting flag for Alt or Exist Sys w/ Alt or New Ducts
               else if (MaxRevRef( HVACSys:HtPumpSystem, HVACSys:StatusArray ) > 1.5)
               then  if (IsAltered > 0 .AND. IsNew < 1 .AND. IsExisting < 1 .AND. IfValidAnd( CFMperTon <= 350 ))
                     then  0
                     else if ( MaxRevRef( HVACSys:HtPumpSystem, HVACSys:StatusArray ) = 3 .AND.
                               ( MaxRevRef( HVACSys:HtPumpSystem, HVACSys:DuctStatusFlag ) = 1 .OR.
                                 MaxRevRef( HVACSys:HtPumpSystem, HVACSys:DuctStatusFlag ) > 3 ) )
                     then  0     ; not set for New HVACSys combined w/ Existing Ducts
                     else  1  endif endif
			      else  0  endif endif
			else  0  endif  }
	"HtPump - Write CFM per Ton Msg" 		HVACHtPump:HERSCheck:AirFlowRptMsg = { if (IfValidAnd( HERSCheck:AHUAirFlow > 0.5 )) then FltToStr( CFMperTon, 0, 0, 1 ) else UNDEFINED endif }

;	"HtPump - Check for SEER above Std" 	HVACHtPump:HERSCheck:SEER = { if ( FloorAreaServed  > 0.5 .AND. T24RCoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) .AND. IfValidAnd(IsClSysSEER > 0.5) .AND. IfValidAnd(SEER > 0) ) then
;																									if (SEER > T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr   ) ) then 1 else 0 endif
;											 													else  0  endif  }
; SAC 4/23/15 - added logic to NOT flag SEER in HERSCheck is this equipment is not modeled as the user entered it (look-up table PropEqStd = 1)
	"HtPump - Check for SEER above Std" 	HVACHtPump:HERSCheck:SEER = { if ( MaxRevRef( HVACSys:HtPumpSystem, HVACSys:HtPmpFlrAreaServed )  > 0.5 .AND. T24RCoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) .AND.
																									  IfValidAnd(SEER > 0) .AND. MaxRevRef( HVACSys:HtPumpSystem, HVACSys:StatusArray ) > 1.5 .AND. EffMetric < 2 .AND.
																									  T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) < 0.5 ) then
																									if (SEER > ( T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) + 0.005 ) ) then 1 else 0 endif
											 													else  0  endif  }
	"HtPump - Write SEER above Std Msg" 	HVACHtPump:HERSCheck:SEERRptMsg = { if (IfValidAnd( HERSCheck:SEER > 0.5 )) then FltToStr( SEER, 1, 0, 4 ) else UNDEFINED endif }

;	"HtPump - Check for EER above Std" 		HVACHtPump:HERSCheck:EER = {  if ( FloorAreaServed > 0.5 .AND. T24RCoolingEquipment:EERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) .AND. LocalStatus(EER) < 7 .AND. IfValidAnd(IsClSysEER > 0.5) .AND. IfValidAnd(EER > 0) ) then
;																									if (EER > T24RCoolingEquipment:EER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr   ) ) then 1 else 0 endif
;											 													else  0  endif  }
; SAC 4/23/15 - added logic to NOT flag EER in HERSCheck is this equipment is not modeled as the user entered it (look-up table PropEqStd = 1)
	"HtPump - Check for EER above Std" 		HVACHtPump:HERSCheck:EER = {  if ( MaxRevRef( HVACSys:HtPumpSystem, HVACSys:HtPmpFlrAreaServed ) > 0.5 .AND. T24RCoolingEquipment:EERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  .AND. 
																									  UseEERinAnalysis > 0.5 .AND. IfValidAnd(EER > 0) .AND. MaxRevRef( HVACSys:HtPumpSystem, HVACSys:StatusArray ) > 1.5 .AND. EffMetric < 2 .AND.
																									  T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) < 0.5 ) then
																									if (EER > ( T24RCoolingEquipment:EER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) + 0.005 ) ) then 1 else 0 endif
											 													else  0  endif  }
	"HtPump - Write EER above Std Msg" 		HVACHtPump:HERSCheck:EERRptMsg = { if (IfValidAnd( HERSCheck:EER > 0.5 )) then FltToStr( EER, 1, 0, 4 ) else UNDEFINED endif }
   ; SAC 09/22/22 (tic #1286)
	"HtPump - Check for SEER2 above Std" 	HVACHtPump:HERSCheck:SEER2 = { if ( MaxRevRef( HVACSys:HtPumpSystem, HVACSys:HtPmpFlrAreaServed )  > 0.5 .AND. T24RCoolingEquipment:SEER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) .AND.
																									  IfValidAnd(SEER2 > 0) .AND. MaxRevRef( HVACSys:HtPumpSystem, HVACSys:StatusArray ) > 1.5 .AND. EffMetric == 2 .AND.
																									  T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) < 0.5 ) then
																									if (SEER2 > ( T24RCoolingEquipment:SEER2( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) + 0.005 ) ) then 1 else 0 endif
											 													else  0  endif  }
	"HtPump - Write SEER2 above Std Msg" 	HVACHtPump:HERSCheck:SEER2RptMsg = { if (IfValidAnd( HERSCheck:SEER2 > 0.5 )) then FltToStr( SEER2, 1, 0, 4 ) else UNDEFINED endif }
	"HtPump - Check for EER2 above Std" 	HVACHtPump:HERSCheck:EER2 = {  if ( MaxRevRef( HVACSys:HtPumpSystem, HVACSys:HtPmpFlrAreaServed ) > 0.5 .AND. T24RCoolingEquipment:EER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  .AND. 
																									  UseEERinAnalysis > 0.5 .AND. IfValidAnd(EER2 > 0) .AND. MaxRevRef( HVACSys:HtPumpSystem, HVACSys:StatusArray ) > 1.5 .AND. EffMetric == 2 .AND.
																									  T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) < 0.5 ) then
																									if (EER2 > ( T24RCoolingEquipment:EER2( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) + 0.005 ) ) then 1 else 0 endif
											 													else  0  endif  }
	"HtPump - Write EER2 above Std Msg" 	HVACHtPump:HERSCheck:EER2RptMsg = { if (IfValidAnd( HERSCheck:EER2 > 0.5 )) then FltToStr( EER2, 1, 0, 4 ) else UNDEFINED endif }
; SAC 4/23/15 - added logic to NOT flag Refrig Charge in HERSCheck is this equipment is not modeled as the user entered it (look-up table PropEqStd = 1)
; SAC 5/4/15 - replaced check of T24RCoolingEquipment:PropEqStd() w/ simple check for GSHP system type, since that is the only system type that refrigerant charge reporting is disabled for (issue 502)
; SAC 6/18/18 - ROLL BACK this mod which broke some tic #764 runs - SAC 6/15/18 - restrict cases where this msg occurs to ONLY NEW HVACSys objects (HVACSys:StatusArray ) > 1.5 -->> = 3) (tic #981)
; added logic to prevent systems of specific (packaged & room) types from being flagged - SAC 09/04/20 (tic #1003)
	"HtPump - Check for AC Charge"			HVACHtPump:HERSCheck:ACCharg = {
         if ( MaxRevRef( HVACSys:HtPumpSystem, HVACSys:HtPmpFlrAreaServed ) > 0 .AND. ACCharge > 1.5 .AND.
              MaxRevRef( HVACSys:HtPumpSystem, HVACSys:StatusArray ) > 1.5 .AND.
              Type != 26 .AND. Type != 24 .AND. Type != 7 .AND. Type != 12 )     ; NOT PkgTermHeatPump, SglPkgVertHeatPump, RoomHeatPump or GroundSourceHeatPump
         then  1  else  0  endif }
	"HtPump - Write AC Charge Msg" 			HVACHtPump:HERSCheck:ACChargRptMsg = { if (IfValidAnd( HERSCheck:ACCharg > 0.5 )) then ACCharge else 0 endif }

   ; SAC 3/18/19 - added setting of HVACHtPump:HERSHeatRef properties for new 2019 HERS messaging
   "Check for Pkg or Split HSPF above Std - HVACHtPump:HERSHeatRef:HSPF"   HVACHtPump:HERSHeatRef:HSPF = {
         if ( FloorAreaServed > 0.5 .AND. (IfValidAnd(IsNew > 0) .OR. IfValidAnd(IsAltered > 0)) .AND. (Type == 4 .OR. Type == 5) .AND.  ; "SplitHeatPump - Central split heat pump" -or- "PkgHeatPump - Central packaged heat pump"
              T24RHeatingEquipment:HSPFValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) > 0 )
         then  if (ValidOr( HSPF, 0 ) > T24RHeatingEquipment:HSPF( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ))
               then  1
               else  0  endif
         else  0  endif  }
   "Write HSPF above Std Msg - HVACHtPump:HERSHeatRef:HSPFRptMsg"          HVACHtPump:HERSHeatRef:HSPFRptMsg = {
         if ( IfValidAnd( HERSHeatRef:HSPF > 0.5 ) ) then  "Verified HSPF"
         else  UNDEFINED  endif }
   ; original version sets flag only for "SplitHeatPump - Central split heat pump" -or- "PkgHeatPump - Central packaged heat pump"
   "Check for Pkg or Split heating capacity - HVACHtPump:HERSHeatRef:Capacity"   HVACHtPump:HERSHeatRef:Capacity = {
         if ( FloorAreaServed > 0.5 .AND. (IfValidAnd(IsNew > 0) .OR. IfValidAnd(IsAltered > 0)) .AND. 
              (Type == 4 .OR. Type == 5) .AND. IfValidAnd( AutoSize > 0 )==0 )
         then  1  else  0  endif  }
   "Write heating capacity Msg - HVACHtPump:HERSHeatRef:CapacityRptMsg"          HVACHtPump:HERSHeatRef:CapacityRptMsg = {
         if ( IfValidAnd( HERSHeatRef:Capacity > 0.5 ) ) then  "Verified heat pump rated heating capacity"
         else  UNDEFINED  endif }

END
;*************************************************************************  SAC 5/10/19 - split out rules that populate HERSCool & HERSHeat for 2016 & earlier code vints vs. HERSHtPump for 2019+ models
RULELIST  "CreateAndAssignAsUserDefined_HVACHtPump_HERSHtPump_Populate" 1 0 0 0

; DUPLICATED FROM HERSCool/Heat RULELIST ABOVE

	"Check for CFM per Ton" 	HVACHtPump:HERSHtPumpRef:AHUAirFlow = {
	      if ( MaxRevRef( HVACSys:HtPumpSystem, HVACSys:HtPmpFlrAreaServed ) > 0.5 .AND.
			     MaxRevRef( HVACSys:HtPumpSystem, HVACSys:CoolDuctedRpt ) > 0.5 .AND.
              ( IfValidAnd( IsClSysCFMperTon > 0.5 ) .OR. 
                ( MaxRevRef( HVACSys:HtPumpSystem, HVACSys:DuctStatusFlag ) < 3.5 .AND.
                  MinRevRef( HVACSys:HtPumpSystem, HVACSys:DuctStatusFlag ) > 1.5 ) ) )
         then  if ( MaxRevRef( HVACSys:HtPumpSystem, HVACSys:StatusArray ) < 2.5 .AND.
                    MaxRevRef( HVACSys:HtPumpSystem, HVACSys:DuctStatusFlag ) < 3.5 .AND.
                    MinRevRef( HVACSys:HtPumpSystem, HVACSys:DuctStatusFlag ) > 1.5 )
               then  1     ; set reporting flag for Alt or Exist Sys w/ Alt or New Ducts
               else if (MaxRevRef( HVACSys:HtPumpSystem, HVACSys:StatusArray ) > 1.5)
               then  if (IsAltered > 0 .AND. IsNew < 1 .AND. IsExisting < 1 .AND. IfValidAnd( CFMperTon <= 350 ))
                     then  0
                     else if ( MaxRevRef( HVACSys:HtPumpSystem, HVACSys:StatusArray ) = 3 .AND.
                               ( MaxRevRef( HVACSys:HtPumpSystem, HVACSys:DuctStatusFlag ) = 1 .OR.
                                 MaxRevRef( HVACSys:HtPumpSystem, HVACSys:DuctStatusFlag ) > 3 ) )
                     then  0     ; not set for New HVACSys combined w/ Existing Ducts
                     else  1  endif endif
			      else  0  endif endif
			else  0  endif  }
	"HtPump - Write CFM per Ton Msg" 		HVACHtPump:HERSHtPumpRef:AirFlowRptMsg = { if (IfValidAnd( HERSHtPumpRef:AHUAirFlow > 0.5 )) then FltToStr( CFMperTon, 0, 0, 1 ) else UNDEFINED endif }

	"HtPump - Check for SEER above Std" 	HVACHtPump:HERSHtPumpRef:SEER = { if ( MaxRevRef( HVACSys:HtPumpSystem, HVACSys:HtPmpFlrAreaServed )  > 0.5 .AND. T24RCoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) .AND.
																									  IfValidAnd(SEER > 0) .AND. MaxRevRef( HVACSys:HtPumpSystem, HVACSys:StatusArray ) > 1.5 .AND. EffMetric < 2 .AND.
																									  T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) < 0.5 ) then
																									if (SEER > ( T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) + 0.005 ) ) then 1 else 0 endif
											 													else  0  endif  }
	"HtPump - Write SEER above Std Msg" 	HVACHtPump:HERSHtPumpRef:SEERRptMsg = { if (IfValidAnd( HERSHtPumpRef:SEER > 0.5 )) then FltToStr( SEER, 1, 0, 4 ) else UNDEFINED endif }
   ; added separate properties & rules for SEER2 (vs. SEER) - SAC 09/22/22 (tic #1286)
	"HtPump - Check for SEER2 above Std" 	HVACHtPump:HERSHtPumpRef:SEER2 = { 	if ( MaxRevRef( HVACSys:HtPumpSystem, HVACSys:HtPmpFlrAreaServed )  > 0.5 .AND. T24RCoolingEquipment:SEER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) .AND.
																									  IfValidAnd(SEER2 > 0) .AND. MaxRevRef( HVACSys:HtPumpSystem, HVACSys:StatusArray ) > 1.5 .AND. EffMetric == 2 .AND.
																									  T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) < 0.5 ) then
																									if (SEER2 > ( T24RCoolingEquipment:SEER2( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) + 0.005 ) ) then 1 else 0 endif
											 													else  0  endif  }
	"HtPump - Write SEER2 above Std Msg" 	HVACHtPump:HERSHtPumpRef:SEER2RptMsg = { if (IfValidAnd( HERSHtPumpRef:SEER > 0.5 )) then FltToStr( SEER, 1, 0, 4 ) else UNDEFINED endif }

	"HtPump - Check for EER above Std" 		HVACHtPump:HERSHtPumpRef:EER = {  if ( MaxRevRef( HVACSys:HtPumpSystem, HVACSys:HtPmpFlrAreaServed ) > 0.5 .AND. T24RCoolingEquipment:EERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  .AND. 
																									  UseEERinAnalysis > 0.5 .AND. IfValidAnd(EER > 0) .AND. MaxRevRef( HVACSys:HtPumpSystem, HVACSys:StatusArray ) > 1.5 .AND. EffMetric < 2 .AND.
																									  T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) < 0.5 ) then
																									if (EER > ( T24RCoolingEquipment:EER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) + 0.005 ) ) then 1 else 0 endif
											 													else  0  endif  }
	"HtPump - Write EER above Std Msg" 		HVACHtPump:HERSHtPumpRef:EERRptMsg = { if (IfValidAnd( HERSHtPumpRef:EER > 0.5 )) then FltToStr( EER, 1, 0, 4 ) else UNDEFINED endif }
   ; added separate properties & rules for EER2 (vs. EER) - SAC 09/22/22 (tic #1286)
	"HtPump - Check for EER2 above Std" 		HVACHtPump:HERSHtPumpRef:EER2 = {  if ( MaxRevRef( HVACSys:HtPumpSystem, HVACSys:HtPmpFlrAreaServed ) > 0.5 .AND. T24RCoolingEquipment:EER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  .AND. 
																									  UseEERinAnalysis > 0.5 .AND. IfValidAnd(EER2 > 0) .AND. MaxRevRef( HVACSys:HtPumpSystem, HVACSys:StatusArray ) > 1.5 .AND. EffMetric == 2 .AND.
																									  T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) < 0.5 ) then
																									if (EER2 > ( T24RCoolingEquipment:EER2( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) + 0.005 ) ) then 1 else 0 endif
											 													else  0  endif  }
	"HtPump - Write EER2 above Std Msg" 		HVACHtPump:HERSHtPumpRef:EER2RptMsg = { if (IfValidAnd( HERSHtPumpRef:EER2 > 0.5 )) then FltToStr( EER2, 1, 0, 4 ) else UNDEFINED endif }

   ; added logic to prevent systems of specific (packaged & room) types from being flagged - SAC 09/04/20 (tic #1003)
	"HtPump - Check for AC Charge"			HVACHtPump:HERSHtPumpRef:ACCharg = {
         if ( MaxRevRef( HVACSys:HtPumpSystem, HVACSys:HtPmpFlrAreaServed ) > 0 .AND. ACCharge > 1.5 .AND.
              MaxRevRef( HVACSys:HtPumpSystem, HVACSys:StatusArray ) > 1.5 .AND.
              Type != 26 .AND. Type != 24 .AND. Type != 7 .AND. Type != 12 )     ; NOT PkgTermHeatPump, SglPkgVertHeatPump, RoomHeatPump or GroundSourceHeatPump
         then  1  else  0  endif }
	"HtPump - Write AC Charge Msg" 			HVACHtPump:HERSHtPumpRef:ACChargRptMsg = { if (IfValidAnd( HERSHtPumpRef:ACCharg > 0.5 )) then ACCharge else 0 endif }

   ; SAC 5/10/19 - revised 2019 logic to trigger HtPump HSPF nad/or Capacity verif for any HP where PopEqStd = 0
   "Check for Pkg or Split HSPF above Std - HVACHtPump:HERSHtPumpRef:HSPF"   HVACHtPump:HERSHtPumpRef:HSPF = {
         if ( FloorAreaServed > 0.5 .AND. (IfValidAnd(IsNew > 0) .OR. IfValidAnd(IsAltered > 0)) .AND. EffMetric < 2 .AND.
              T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) == 0 .AND.
              T24RHeatingEquipment:HSPFValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) > 0 )
         then  if (ValidOr( HSPF, 0 ) > T24RHeatingEquipment:HSPF( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ))
               then  1
               else  0  endif
         else  0  endif  }
   "Write HSPF above Std Msg - HVACHtPump:HERSHtPumpRef:HSPFRptMsg"          HVACHtPump:HERSHtPumpRef:HSPFRptMsg = {
         if ( IfValidAnd( HERSHtPumpRef:HSPF > 0.5 ) ) then  "Verified HSPF"
         else  UNDEFINED  endif }
   ; added separate properties & rules for EER2 (vs. EER) - SAC 09/22/22 (tic #1286)
   "Check for Pkg or Split HSPF2 above Std - HVACHtPump:HERSHtPumpRef:HSPF2"   HVACHtPump:HERSHtPumpRef:HSPF2 = {
         if ( FloorAreaServed > 0.5 .AND. (IfValidAnd(IsNew > 0) .OR. IfValidAnd(IsAltered > 0)) .AND. EffMetric == 2 .AND.
              T24RHeatingEquipment:PropEqStd(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) == 0 .AND.
              T24RHeatingEquipment:HSPF2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) > 0 )
         then  if (ValidOr( HSPF2, 0 ) > T24RHeatingEquipment:HSPF2( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ))
               then  1
               else  0  endif
         else  0  endif  }
   "Write HSPF2 above Std Msg - HVACHtPump:HERSHtPumpRef:HSPF2RptMsg"          HVACHtPump:HERSHtPumpRef:HSPF2RptMsg = {
         if ( IfValidAnd( HERSHtPumpRef:HSPF2 > 0.5 ) ) then  "Verified HSPF2"
         else  UNDEFINED  endif }

   ; switched logic for 2019.2.0+ to trigger flag for ALL HP types, not just those explicitly simulated - SAC 02/09/21 (tic #1254)
   "Check for Pkg or Split heating capacity - HVACHtPump:HERSHtPumpRef:Capacity"   HVACHtPump:HERSHtPumpRef:Capacity = {
         if ( FloorAreaServed > 0.5 .AND. (IfValidAnd(IsNew > 0) .OR. IfValidAnd(IsAltered > 0)) .AND. 
              ( (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .AND. T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) == 0) .OR.
                (IfValidAnd( Proj:AnalysisVersion >= 190200 )    .AND. Type > 0) )  .AND.
              IfValidAnd( AutoSize > 0 )==0 )
         then  1  else  0  endif  }
   ; added logic to prevent systems of specific (packaged & room) types from being flagged for Capacity17 verification - SAC 09/04/20 (tic #1003)
   "Check for Pkg or Split heating capacity - HVACHtPump:HERSHtPumpRef:Capacity17"  HVACHtPump:HERSHtPumpRef:Capacity17 =
      {  if ( HERSHtPumpRef:Capacity > 0 .AND.
              Type != 26 .AND. Type != 24 .AND. Type != 7 .AND. Type != 12 .AND. Type != 34 )     ; NOT PkgTermHeatPump, SglPkgVertHeatPump, RoomHeatPump or GroundSourceHeatPump or AirToWaterHeatPump
         then  1  else  0  endif  }
   "Write heating capacity Msg - HVACHtPump:HERSHtPumpRef:CapacityRptMsg"          HVACHtPump:HERSHtPumpRef:CapacityRptMsg = {
         if ( IfValidAnd( HERSHtPumpRef:Capacity > 0.5 ) ) then  "Verified heat pump rated heating capacity"
         else  UNDEFINED  endif }
END
;*************************************************************************


;*************************************************************************
RULELIST  "ProposedReportPrep" 1 0 0 0
;*************************************************************************

	"Force reset of DHWSys:MFamDistType when DHWSys:CentralDHW is toggled OFF"		; SAC 11/19/14 - 
		DHWSys:MFamDistType	= {	if (LocalStatus( MFamDistType ) < 7 .OR. IfValidAnd( CentralDHW > 0.5 )) then  UNCHANGED		; don't reset if value is not user-defined or if CentralDHW toggled on
											else  0  endif  }

;	mjb	E+A+A additions to summary reports	12/6/13
   "Evaluate rules to summarize building model for reporting purposes"		Proj:Action = {	EvalRulelist( "Reporting_SummarizeModel" )  }

   "Evaluate rules to summarize building model for reporting purposes"		Proj:Action = {	EvalRulelist( "Reporting_HERS_SpecialFeaturesSummary" )  }

; SAC 10/23/14 - copied this rule UP from PostProposedInput...  to ensure it is set prior to export of Proposed reporting model
;	mjb	6/13/14	make sure Fan and Dist TypeRpt assigned
	"Set HVACFan TypeRpt"		HVACFan:TypeRpt	=	{	if ( TypeRpt == 0 ) then UNCHANGED else 1 endif	}

; SAC/mjb 10/22/14 - relocated from 'ProcessResults' rulelist
; mjb relocated from PostProposed rulelist on 8/26/14
   ;--------------------------------------------------------------------
   ; Setup SCSysRpt reporting object properties (if none exist yet)
   ;--------------------------------------------------------------------
	"Setup SCSysRpt objects (if needed)"		Proj:Action	= {	;  if (ComponentCount( SCSysRpt ) > 0 .OR. Proj:NumSCSysEquipUnits < 1) then  UNCHANGED
																					if (Proj:NumSCSysEquipUnits < 1) then  UNCHANGED
																					else	EvalRulelist( "Setup_SCSysReportingObjects" )  endif  }

   ;--------------------------------------------------------------------
   ; Setup DHWSysRpt reporting object properties (if none exist yet)
   ;--------------------------------------------------------------------
	"Setup DHWSysRpt objects (if needed)"		Proj:Action	= {	;  if (ComponentCount( DHWSysRpt ) > 0 .OR. Proj:NumDHWEquipUnits < 1) then  UNCHANGED
																					if (Proj:NumDHWEquipUnits < 0.001) then  UNCHANGED
																					else	EvalRulelist( "Setup_DHWSysReportingObjects" )  endif  }

   ;--------------------------------------------------------------------
   ; Setup IAQVentRpt reporting object properties (if none exist yet)
   ;--------------------------------------------------------------------
	"Setup IAQVentRpt objects (if needed)"		Proj:Action	= {	;  if (ComponentCount( IAQVentRpt ) > 0) then  UNCHANGED
																					;  else	EvalRulelist( "Setup_IAQVentReportingObjects" )  endif  }
																					EvalRulelist( "Setup_IAQVentReportingObjects" )  }

   ;--------------------------------------------------------------------
   ; Setup DwellUnitRpt reporting object properties (if none exist yet)
   ;--------------------------------------------------------------------
	"Delete all DwellUnitRpt objects currently in building description"		Proj:Action		= {	DeleteAllComps( DwellUnitRpt )  }
	"Setup DwellUnitRpt objects (if needed)"	Proj:Action	= {	if (Proj:IsMultiFamily < 0.5) then  UNCHANGED
																					else	EvalRulelist( "Setup_DwellUnitReportingObjects" )  endif  }

END


; SAC 11/15/14 - rulelist to setup and default DwellUnitRpt objects
;*************************************************************************
RULELIST "Setup_DwellUnitReportingObjects" 1 0 1 0
;*************************************************************************
	"Create new DwellUnitRpt objects and populate w/ initial object references & indexes/counts"		Proj:Action		= {	CreateDwellUnitRptObjects()  }
	"Default DwellUnitRpt properties - general"		DwellUnitRpt:Action	= {	EvalRulelist( "Default_DwellUnitReportObject", 1 )  }
END

;*************************************************************************
RULELIST "Default_DwellUnitReportObject" 0 0 0 0
;*************************************************************************
	"Set DwellUnitRpt:DwellUnitRef"			DwellUnitRpt:DwellUnitRef		= {	Parent( Name )  }
	"Set DwellUnitRpt:DwellUnitTypeRef"		DwellUnitRpt:DwellUnitTypeRef	= {	Parent( DwellUnitTypeRef )  }
	"Set DwellUnitRpt:ZoneRef"					DwellUnitRpt:ZoneRef				= {	Parent2( Name )  }
END
;*************************************************************************


;*************************************************************************
RULELIST  "ReportMaster_Building_Summary_csv" 1 0 0 0
;*************************************************************************
;	mjb	E+A+A additions to summary reports	12/6/13
   "Evaluate rules to summarize building model for reporting purposes"		Proj:Action = {	EvalRulelist( "Reporting_SummarizeModel" )  }

   "Write report title-1"		Proj:Action = {	if (strlen( BldgSmryCSVHeader ) > 0)
																then	WriteToFile( BldgSmryCSVHeader )
																else	WriteToFile( "2013 Building Energy Efficiency Standards\n" )  endif  }
   "Write report title-2"		Proj:Action = {	WriteToFile( "Performance-based Compliance\n\n" )  }

   "Write Report For..."		Proj:Action = {   
                        switch (RunAbbrev)
                           case  "u"     : WriteToFile( "Detailed Report For:,User Input,\n" )
                           case  "pp"    : WriteToFile( "Detailed Report For:,PrelimProposed Design,\n" )
                           case  "pp-N"  : WriteToFile( "Detailed Report For:,PrelimProposed-North Design,\n" )
                           case  "pp-E"  : WriteToFile( "Detailed Report For:,PrelimProposed-East Design,\n" ) 
                           case  "pp-S"  : WriteToFile( "Detailed Report For:,PrelimProposed-South Design,\n" )
                           case  "pp-W"  : WriteToFile( "Detailed Report For:,PrelimProposed-West Design,\n" ) 
                           case  "p"     : WriteToFile( "Detailed Report For:,Proposed Design,\n" )
                           case  "p-N"   : WriteToFile( "Detailed Report For:,Proposed-North Design,\n" )
                           case  "p-E"   : WriteToFile( "Detailed Report For:,Proposed-East Design,\n" ) 
                           case  "p-S"   : WriteToFile( "Detailed Report For:,Proposed-South Design,\n" )
                           case  "p-W"   : WriteToFile( "Detailed Report For:,Proposed-West Design,\n" ) 
                           case  "s"     : WriteToFile( "Detailed Report For:,Standard Design,\n" )
                           case  "pfx"   : WriteToFile( "Detailed Report For:,PropFlexibility Design,\n" )
                           case  "pfx-N" : WriteToFile( "Detailed Report For:,PropFlexibility-North Design,\n" )
                           case  "pfx-E" : WriteToFile( "Detailed Report For:,PropFlexibility-East Design,\n" ) 
                           case  "pfx-S" : WriteToFile( "Detailed Report For:,PropFlexibility-South Design,\n" )
                           case  "pfx-W" : WriteToFile( "Detailed Report For:,PropFlexibility-West Design,\n" ) 
                           case  "smf"   : WriteToFile( "Detailed Report For:,StdMixedFuel Design,\n" )
                           case  "dr"    : WriteToFile( "Detailed Report For:,Design Rating Reference Run,\n" ) 
                           default       : WriteToFile( "Detailed Report For:,unknown design,\n" ) 
								endswitch  }

   "Write 'Project' header"		Proj:Action = {	WriteToFile( "\nProject\n" )  }
   "Write Proj:RunID"			Proj:Action = {   WriteToFile( ",Run ID,%c%s%c,\n", 34, RunID, 34 )  }
   "Write Proj:RunTitle"		Proj:Action = {   WriteToFile( ",Run Title,%c%s%c,\n", 34, RunTitle, 34 )  }
   "Write Proj:RunNumber"		Proj:Action = {   WriteToFile( ",Run Number,%.0f,\n", RunNumber )  }
   "Write Proj:RunScope"		Proj:Action = {   WriteToFile( ",Run Scope,%s,\n\n", EnumString( RunScope ) )  }

   "Write Address"			Proj:Action = {   WriteToFile( ",Address,%c%s%c,\n",	34, Address  , 34 )  }
   "Write City"				Proj:Action = {   WriteToFile( ",City,%c%s%c,\n",	34, City     , 34 )  }
;   "Write Zip Code"			Proj:Action = {   WriteToFile( ",Zip Code,%.0f,\n",	ZipCode       )  }
; SAC 12/30/13 - switch CZ echo to be just the number as opposed to the entire enumeration (which includes the default CZ city name)
;  "Write Climate Zone"		Proj:Action = {   WriteToFile( ",Climate Zone,%c%s%c,\n\n",	34, EnumString( ClimateZone ), 34 )  }
   "Write Climate Zone"		Proj:Action = {   WriteToFile( ",Climate Zone,%.0f,\n\n", ClimateZone )  }
 
   "Write Standards Version"		Proj:Action = {   WriteToFile( ",Standards Version,%c%s%c,\n", 34, StandardsVerLabel  , 34 )  }                                                          
;  "Write Compliance Type"		Proj:Action = {   WriteToFile( ",Compliance Type,%c%s%c,\n",	34, CompType  , 34 )  }  
   "Write All Orientations"		Proj:Action = {   if (AllOrientations > 0.5) then  
								  	WriteToFile( ",All Orientations,%c%s%c,\n",	34, "Yes"  , 34 )
								  else  WriteToFile( ",All Orientations,%c%s%c,\n",	34, "No"  , 34 )  
								  endif  }                                                
   ;"Write Natural Gas Available"	Proj:Action = {   if (NatGasAvailable > 0.5) then  
	;							  	WriteToFile( ",Natural Gas Available,%c%s%c,\n\n",	34, "Yes"  , 34 )	else  WriteToFile( ",Natural Gas Available,%c%s%c,\n\n",	34, "No"  , 34 )  endif  }                                                
   ; SAC 2/28/18 - replaced echo of NatGasAvailable flag above w/ new Proj:GasTypeRpt (tic #992)
   "Write Proj:GasTypeRpt"	Proj:Action = {   if (LocalStatus( GasTypeRpt ) > 0.5) then  
								  	WriteToFile( ",Gas Type,%c%s%c,\n\n",	34, GasTypeRpt, 34 )	else  UNCHANGED  endif  }

  "Write House Type"			Proj:Action = {   WriteToFile( ",House Type,%c%s%c,\n",	34, Proj:BuildingTypeRpt, 34 )  }		; SAC 4/15/15
								; if (IsMultiFamily > 0.5) then  
								;   WriteToFile( ",House Type,%c%s%c,\n",	34, "Multi-family"  , 34 )
								; else  WriteToFile( ",House Type,%c%s%c,\n",	34, "Single Family"  , 34 )  
								; endif  }                                                
   "Write Dwelling Units"		Proj:Action = {   WriteToFile( ",Dwelling Units,%.0f,\n",	NumDwellingUnits       )  }
   "Write Stories"				Proj:Action = {   WriteToFile( ",Stories,%.0f,\n",	NumStories       )  }
   "Write Bedrooms"				Proj:Action = {   WriteToFile( ",Bedrooms,%.0f,\n",	NumBedrooms       )  }
   "Write Addition Bedrooms"	Proj:Action = {   if (RunScope == 1 .AND. IsAddAlone > 0.5)
   															then	WriteToFile( ",Addition Bedrooms,%.0f,\n", NumAddBedrooms )
   															else	UNCHANGED  endif  }
   "Write Attached Garage"		Proj:Action = {   if (HasGarage > 0.5) then  
								  	WriteToFile( ",Attached Garage,%c%s%c,\n\n",	34, "Yes"  , 34 )
								  else  WriteToFile( ",Attached Garage,%c%s%c,\n\n",	34, "No"  , 34 )  
								  endif  }                                                
   "Write Front Orientation"		Proj:Action = {   WriteToFile( ",Front Orientation,%.0f,deg,\n\n",	FrontOrientation       )  }
                                                                                                                                         
   "Write CondFloorArea"		Proj:Action = {   WriteToFile( ",Conditioned Floor Area,%0.1f,ft2,\n", CondFloorArea )  }   
   "Write RptTotCondZoneWinArea"	Proj:Action = {   WriteToFile( ",Total Conditioned Zone Window Area,%0.1f,ft2,\n", RptTotCondZoneWinArea )  }
   "Write CondWinAreaCFARat"		Proj:Action = {   WriteToFile( ",Window to Floor Area Ratio,%0.3f,\n", RptCondWinAreaCFARat  )  }
;	mjb	2/19/14	include reporting of Area-Weighted Fenestration Ufactor
   "Write RptWinAreaWgtUfactor"	Proj:Action = {   WriteToFile( ",Area-Weighted Fenestration Ufactor,%0.3f,Btuh/ft2-F,\n", RptWinAreaWgtUfactor  )  }
   "Write BldgExtWallArea"			Proj:Action = {   WriteToFile( ",Exterior Wall Area,%0.1f,ft2,\n",    (BldgExtWallArea + BldgOZExtWallArea)  )  }       ; added OZ data - SAC 09/23/20 (MFamProto)
   "Write BldgUndWallArea"			Proj:Action = {   WriteToFile( ",Underground Wall Area,%0.1f,ft2,\n",    BldgUndWallArea  )  }		; SAC 11/20/14 - 
   "Write BldgSlabFloorArea"		Proj:Action = {   WriteToFile( ",Conditioned Zone Slab Floor Area,%0.1f,ft2,\n",    BldgCondZnSlabFlrArea  )  }
   "Write ExpSlabFloorArea"		Proj:Action = {   WriteToFile( ",Exposed Slab Floor Area,%0.1f,ft2,\n",    ExpSlabFloorArea  )  }
   "Write BldgCondZnUndFlrArea"	Proj:Action = {   WriteToFile( ",Conditioned Zone Below Grade Floor Area,%0.1f,ft2,\n",    BldgCondZnUndFlrArea  )  }		; SAC 11/20/14 - 
   "Write ExpUndFloorArea"			Proj:Action = {   WriteToFile( ",Exposed Below Grade Floor Area,%0.1f,ft2,\n\n",    ExpUndFloorArea  )  }		; SAC 11/20/14 - 

;	mjb	2/18/14	E+A+A include reporting of Addition CFA
   "Write AdditionCFA"				Proj:Action = {   WriteToFile( ",Addition Conditioned Floor Area,%0.1f,ft2,\n\n", AdditionCFA )  }   

   "Write PV Credit Available"	Proj:Action = {   if (PVGenerationRate > 0.5 .AND. StandardsVersion > 2014 ) then  
								  										WriteToFile( ",PV Credit Available,%c%s%c,\n",	34, "Yes"  , 34 )
								  									else  WriteToFile( ",PV Credit Available,%c%s%c,\n",34, "No"  , 34 )  
								  									endif  } 
   ; revisions for new SLCC units - SAC 12/02/22                                               
  "Write PVGenCredit"			Proj:Action = {   if (StandardsVersion > 2024 )
                                                then  WriteToFile( ",PV Generation - Maximum Credit,%0.1f,SLCC $,\n",  PVGenCredit  )
                                                else  WriteToFile( ",PV Generation - Maximum Credit,%0.1f,kTDV,\n",    PVGenCredit  )  endif  }
  "Write PVPrelimCredit"		Proj:Action = {   if (StandardsVersion > 2024 )
                                                then  WriteToFile( ",Credit Available for PV,%0.1f,SLCC $,\n",  PVPrelimCredit  )
                                                else  WriteToFile( ",Credit Available for PV,%0.1f,kTDV,\n",    PVPrelimCredit  )  endif  }		; SAC 4/2/15 - no longer document cooling vs. total credit available - or could split out by code vintage
  "Write PVCredit"				Proj:Action = {   if (StandardsVersion > 2024 )
                                                then  WriteToFile( ",Final PV Credit,%0.1f,SLCC $/ft2-yr,\n\n",  PVCredit[1]  )
                                                else  WriteToFile( ",Final PV Credit,%0.1f,kTDV/ft2-yr,\n\n",    PVCredit[1]  )  endif  }

  "Write ZonalControl"			Proj:Action = {   if ( ZonalControl > 0.5 ) then  
								  	WriteToFile( ",Zonal Control,%c%s%c,\n",	34, "Yes"  , 34 )
								  else  WriteToFile( ",Zonal Control,%c%s%c,\n",	34, "No"  , 34 )  
								  endif  }                                                
  "Write ACH50"				Proj:Action = {   WriteToFile( ",Envelope Infiltration (ACH @ 50 Pa),%0.3f,\n",    ACH50  )  }
  "Write CFM50"				Proj:Action = {   WriteToFile( ",Envelope Infiltration (CFM @ 50 Pa),%0.3f,\n",    CFM50  )  }
  "Write InsulConsQuality"		Proj:Action = {   if ( InsulConsQuality > 1.5 ) then  
									WriteToFile( ",Quality Insulation Installation,%c%s%c,\n\n",	34, "Yes"  , 34 )
								  else  WriteToFile( ",Quality Insulation Installation,%c%s%c,\n\n",	34, "No"  , 34 )  
								  endif  }                                                

;	
;Report Project Envelope Data	
;
;	mjb	mods to check Assigned SurfaceArea of Cons before reporting	9/13/13

   "Write column headings for ExtWall data"	Proj:Action = {  if ( Local( BldgExtWallArea ) > 0.5  ) then WriteToFile( ",Exterior Walls:, Name, Zone, Status, Type, Orientation (deg), Area (ft2), Window Area (ft2),Door Area (ft2), Tilt (deg), Framing Factor, \n" )
									else UNCHANGED endif  }								
   "Write ExtWall data"				ExtWall:Action = {  if ( Local( Area ) > 0.5 ) then EvalRulelist( "ExtWall_Data_Report", 1 )
									else UNCHANGED endif  }								

   "Write column headings for Window data"	Proj:Action = { if ( Local( RptTotCondZoneWinArea ) > 0.5  ) then  WriteToFile( "\n,Windows:, Name, Wall, Status, Azimuth (deg), Height (ft), Width (ft), Multiplier, Area (ft2),U-factor, SHGC, Ext. Shade, \n" )
									else UNCHANGED endif  }								
   "Write Win data"				Win:Action = {  if ( Local( Area ) > 0.5  ) then EvalRulelist( "Win_Data_Report", 1 )
									else UNCHANGED endif  }								

   "Write column headings for Cons data"	Proj:Action = {  if ( Local( BldgExtWallArea ) > 0.5  ) then	WriteToFile( "\n,Ext. Wall Constructions:, Name, Type, Total Cavity Rvalue, Total Thickness, Winter Design Uvalue, Layers:, \n" )	; SAC 11/20/14 - Frame Layers:, Cavity Layers:, \n" )
									else UNCHANGED endif  }								
   "Write Cons data"	  			Cons:Action = {  if ( Proj:BldgExtWallArea > 0.5 .AND. Local( CanAssignTo ) == 0  .AND. AssignedCondZoneArea > 0.5) then EvalRulelist( "Cons_Data_Report", 1 )
									else UNCHANGED endif  }								


   "Write column headings for UndWall data"	Proj:Action = {  if (IfValidAnd( BldgUndWallArea > 0.5 )) then WriteToFile( "\n,Underground Walls:, Name, Zone, Status, Type, Depth Below Grade (ft), Area (ft2), Framing Factor, \n" )
									else UNCHANGED endif  }								
   "Write UndWall data"				UndWall:Action = {  if ( Local( Area ) > 0.5 ) then EvalRulelist( "UndWall_Data_Report", 1 )
									else UNCHANGED endif  }								

   "Write column headings for Cons data"	Proj:Action = {  if ( Local( BldgUndWallArea ) > 0.5  ) then	WriteToFile( "\n,Underground Wall Constructions:, Name, Type, Total Cavity Rvalue, Total Thickness, Winter Design Uvalue, Layers:, \n" )	; SAC 11/20/14 - Frame Layers:, Cavity Layers:, \n" )
									else UNCHANGED endif  }								
   "Write Cons data"	  			Cons:Action = {  if ( Proj:BldgUndWallArea > 0.5 .AND. Local( CanAssignTo ) == 20  .AND. AssignedCondZoneArea > 0.5) then EvalRulelist( "Cons_Data_Report", 1 )
									else UNCHANGED endif  }								

   "Write column headings for CathedralCeiling data"	Proj:Action = {  if ( ComponentCount( CathedralCeiling ) > 0.5  ) then WriteToFile( "\n,Cathedral Ceilings:, Name, Zone, Status, Type, Orientation, Area (ft2), Roof Rise (x in 12), Roof Pitch, Roof Tilt (deg), Roof Reflectance, Roof Emittance, Framing Factor, \n" )
									else UNCHANGED endif  }								
   "Write CathedralCeiling data"			CathedralCeiling:Action = {  if ( Local( Area ) > 0.5  ) then EvalRulelist( "CathedralCeiling_Data_Report", 1 )
											else UNCHANGED endif  }								
;   "Write CathedralCeiling data for Garages"		CathedralCeiling:Action = {  if ( Local( Area ) > 0.5 .AND. Local( ParentType ) == 2) then EvalRulelist( "CathedralCeiling_Data_Report", 1 )
;											else UNCHANGED endif  }								

   "Write column headings for Skylight data"	Skylt:Action = {  if ( Local( Area ) > 0.5  ) then WriteToFile( "\n,Skylights:, Name, Ceiling, Status, Azimuth (deg), Multiplier, Area (ft2),U-factor, SHGC,  \n" )
									else UNCHANGED endif  }								
   "Write Skylt data"				Skylt:Action = {  if ( Local( Area ) > 0.5  ) then EvalRulelist( "Skylt_Data_Report", 1 )
									else UNCHANGED endif  }								


   "Write column headings for Attic data"	Attic:Action = {  if ( SumAll( Attic:FloorArea ) > 0.5  ) then WriteToFile( "\n,Attic:, Name, Status, Type, Floor Area (ft2), Roof Rise, Roof Reflectance, Roof Emittance, Roof Framing Factor, \n" )
									else UNCHANGED endif  }								
   "Write Attic data"				Attic:Action = {  if ( Local( FloorArea ) > 0.5  ) then EvalRulelist( "Attic_Data_Report", 1 )
									else UNCHANGED endif  }								
   "Write column headings for Cons data"	Attic:Action = {  if ( SumAll( Attic:FloorArea ) > 0.5  ) then	WriteToFile( "\n,Attic Constructions:, Name, Type, Total Cavity Rvalue, Total Thickness, Winter Design Uvalue, Radiant Barrier, Layers:, \n" )	; SAC 11/20/14 - Frame Layers:, Cavity Layers:, \n" )
									else UNCHANGED endif  }								
   "Write Cons data"	  			Cons:Action = {  if ( Local( CanAssignTo ) == 1 .AND. AssignedCondZoneArea > 0.5  ) then EvalRulelist( "Cons_Data_Report", 1 )
									else UNCHANGED endif  }								

   "Write column headings for Cons data"	Proj:Action = {  if ( Local( BldgCathCeilingArea ) > 0.5  ) then	WriteToFile( "\n,Cathedral Ceiling Constructions:, Name, Type, Total Cavity Rvalue, Total Thickness, Winter Design Uvalue,  Layers:, \n" )	; SAC 11/20/14 - Frame Layers:, Cavity Layers:,\n" )
									else UNCHANGED endif  }								
   "Write Cons data"	  			Cons:Action = {  if ( Proj:BldgCathCeilingArea > 0.5 .AND. Local( CanAssignTo ) == 2  .AND. AssignedCondZoneArea > 0.5 ) then EvalRulelist( "Cons_Data_Report", 1 )
									else UNCHANGED endif  }								


   "Write column headings for CeilingBelowAttic data"	Proj:Action = {  if ( Local( BldgClgBlwAtticArea ) > 0.5  ) then WriteToFile( "\n,Ceiling Below Attic:, Name, Zone, Status, Type, Area (ft2), Attic Edge Length (ft), Attic Edge Area (ft2), \n" )
									else UNCHANGED endif  }								
   "Write CeilingBelowAttic data"		CeilingBelowAttic:Action = {  if ( Local( Area ) > 0.5  ) then EvalRulelist( "CeilingBelowAttic_Data_Report", 1 )
											else UNCHANGED endif  }								
	
   "Write column headings for Cons data"	Proj:Action = {  if ( Local( BldgClgBlwAtticArea ) > 0.5  ) then	WriteToFile( "\n,Ceiling Below Attic Constructions:, Name, Type, Total Cavity Rvalue, Total Thickness, Winter Design Uvalue, Layers:, \n" )	; SAC 11/20/14 - Frame Layers:, Cavity Layers:, \n" )
									else UNCHANGED endif  }								
   "Write Cons data"	  			Cons:Action = {  if ( Proj:BldgClgBlwAtticArea > 0.5 .AND. Local( CanAssignTo ) == 3 .AND. AssignedCondZoneArea > 0.5 ) then EvalRulelist( "Cons_Data_Report", 1 )
									else UNCHANGED endif  }								


   "Write column headings for SlabFloor data"	Proj:Action = {  if ( Local( BldgSlabFloorArea ) > 0.5  ) then WriteToFile( "\n,Slab Floors:, Name, Zone, Status, Area (ft2), Perimeter (ft),Edge Insul. Rvalue, Carpeted Fraction, Heated, \n" )
									else UNCHANGED endif  }								
   "Write SlabFloor data"			SlabFloor:Action = {  if ( Local( Area ) > 0.5  ) then EvalRulelist( "SlabFloor_Data_Report", 1 )
									else UNCHANGED endif  }								


; SAC 6/9/14 - remove ExteriorFloor:Type
;   "Write column headings for ExtFloor data"		Proj:Action = {  if ( Local( BldgExtFloorArea ) > 0.5  ) then WriteToFile( "\n,Exterior Floors:, Name, Zone, Status, Class, Type, Area (ft2),Edge Insul. Rvalue, Framing Factor, \n" )
   "Write column headings for ExtFloor data"		Proj:Action = {  if ( Local( BldgExtFloorArea ) > 0.5  ) then WriteToFile( "\n,Exterior Floors:, Name, Zone, Status, Type, Area (ft2),Edge Insul. Rvalue, Framing Factor, \n" )
									else UNCHANGED endif  }								
   "Write ExteriorFloor data"				ExteriorFloor:Action = {  if ( Local( Area ) > 0.5  ) then EvalRulelist( "ExteriorFloor_Data_Report", 1 )
									else UNCHANGED endif  }								

   "Write column headings for Cons data"	Proj:Action = {  if ( Local( BldgExtFloorArea ) > 0.5  ) then	WriteToFile( "\n,Ext. Floor Constructions:, Name, Type, Total Cavity Rvalue, Total Thickness, Winter Design Uvalue, Layers:, \n" )	; SAC 11/20/14 - Frame Layers:, Cavity Layers:,\n" )
									else UNCHANGED endif  }								
   "Write Cons data"	  			Cons:Action = {  if ( Proj:BldgExtFloorArea > 0.5 .AND. Local( CanAssignTo ) == 5  .AND. AssignedCondZoneArea > 0.5 ) then EvalRulelist( "Cons_Data_Report", 1 )
									else UNCHANGED endif  }								


   "Write column headings for FloorOverCrawl data"	FloorOverCrawl:Action = {  if ( Local( Area ) > 0.5  ) then WriteToFile( "\n,Floors Over Crawlspace:, Name, Zone, Status, Type, Area (ft2), Framing Factor, \n" )
									else UNCHANGED endif  }								
   "Write FloorOverCrawl data"				FloorOverCrawl:Action = {  if ( Local( Area ) > 0.5  ) then EvalRulelist( "FloorOverCrawl_Data_Report", 1 )
									else UNCHANGED endif  }								


   "Write column headings for Cons data"	FloorOverCrawl:Action = {  if ( Local( Area ) > 0.5  ) then	WriteToFile( "\n,Floor Over Crawlspace Constructions:, Name, Type, Total Cavity Rvalue, Total Thickness, Winter Design Uvalue, Layers:, \n" )	; SAC 11/20/14 - Frame Layers:, Cavity Layers:, \n" )
									else UNCHANGED endif  }								
   "Write Cons data"	  			Cons:Action = {  if ( Local( CanAssignTo ) == 9 .AND. AssignedCondZoneArea > 0.5  ) then EvalRulelist( "Cons_Data_Report", 1 )
									else UNCHANGED endif  }								


   "Write column headings for UndFloor data"	UndFloor:Action = {  if ( Local( Area ) > 0.5  ) then WriteToFile( "\n,Underground Floors:, Name, Zone, Status, Area (ft2), Framing Factor, \n" )
									else UNCHANGED endif  }								
   "Write UndFloor data"			UndFloor:Action = {  if ( Local( Area ) > 0.5  ) then EvalRulelist( "UndFloor_Data_Report", 1 )
									else UNCHANGED endif  }								


   "Write column headings for CrawlSpace data"	CrawlSpace:Action = {  if ( Local( Area ) > 0.5  ) then WriteToFile( "\n,CrawlSpace:, Name, Status, Type, Area (ft2), Perimeter (ft), Avg. Height (ft), \n" )
									else UNCHANGED endif  }								
   "Write CrawlSpace data"			CrawlSpace:Action = {  if ( Local( Area ) > 0.5  ) then EvalRulelist( "CrawlSpace_Data_Report", 1 )
									else UNCHANGED endif  }								

;	
;Report Zone data
;								
   "Write Zone Data"			Zone:Action = {  EvalRulelist( "Zone_Data_Report", 1 )  }

;Report Dwelling Unit data for Multi-Family	- updated to match new MF data model	mjb	8/18/14
;							
	"Write Dwelling Unit Header"		Proj:Action = {  if ( Proj:IsMultiFamily > 0.5 ) then WriteToFile( "\n\n,Dwelling Units:, Zone, Name, Count, Floor Area, Bedrooms, Refrigerator (kWh/yr), Dishwasher (kWh/yr), Elec Cooking (Btu/day), Gas Cooking (Btu/day), Clothes Washer (kWh/day), Clothes Dryer Elec (kWh/day), Clothes Dryer Gas (Btu/day), Lighting (kWh/day), Miscellaneous (kWh/day), IAQ Ventilation:," )
																				else UNCHANGED endif  }
	"Write DU IAQ Fan data header"	Proj:Action = {   if ( Proj:IsMultiFamily > 0.5 ) then WriteToFile( "CFM, Watts/CFM, Type,\n" )
								 										else UNCHANGED endif	}
	"Write Dwelling Unit Data"			DwellUnit:Action = {  if ( Proj:IsMultiFamily > 0.5 ) then EvalRulelist( "DwellingUnit_Data_Report", 1 ) 
																				else UNCHANGED endif  }
;  ;	
;  ;Report Garage data 	
;  ;								
;     "Write Garage Name"			Garage:Action = {   if ( Proj:HasGarage > 0.5 ) then WriteToFile( "\n,Garage Name,%c%s%c,\n", 34, Garage:Name, 34 )
;  								else UNCHANGED endif  } 
;     "Write Garage Area"			Garage:Action = {    if ( Proj:HasGarage > 0.5 ) then WriteToFile( ",Garage Floor Area,%0.2f,ft2,\n", Garage:Area ) 
;  								else UNCHANGED endif }   
;     "Write Garage Volume"		Garage:Action = {    if ( Proj:HasGarage > 0.5 ) then WriteToFile( ",Garage Volume,%0.2f,ft3,\n", Garage:Volume ) 
;  								else UNCHANGED endif }   

;	
;Report HVAC Data	not already reported via Zone Data rulelist
;
;	mjb	4/26/14	fix reporting of WHFs
   "Write column headings for HVACSystem Data"	HVACSys:Action = {  if ( HVACSys:FloorAreaServed[1] > 0.5 ) then WriteToFile( "\n,HVAC System Data:,  Status, Type,\n" )
									else UNCHANGED endif  }
   "Write HVACSys data"				HVACSys:Action = {  if ( FloorAreaServed[1] > 0.5  ) then EvalRulelist( "HVACSys_Data_Report", 1 )
									else UNCHANGED endif  }

   "Write column headings for Cool Vent Fan data"	Proj:Action = {   if (IfValidAnd( UnitClVentCFMTot > 0.1 )==0) then  UNCHANGED
						 		else  WriteToFile( ",Cooling Ventilation Fans:, Name, Zone, CFM, Watts/CFM, \n" ) endif  }

   ; SAC 7/1/19 - added logic to prevent accessing UnitClVentZone[*]:Name before verifying that the zone is actually assigned (tic #1115)
   "Write UnitClVentFan[1]"		Proj:Action = {   if (IfValidAnd( UnitClVentCFMTot > 0.1 )==0 .OR. IfValidAnd( UnitClVentNumFans[1] < 0.5 )) then  UNCHANGED
						 		else  WriteToFile( ",,%c%s%c", 34, UnitClVentFan[1]:Name, 34 )  endif  }
   "Write UnitClVentZone[1]"		Proj:Action = {   if (IfValidAnd( UnitClVentCFMTot > 0.1 )==0 .OR. IfValidAnd( UnitClVentNumFans[1] < 0.5 ) .OR. LocalCompAssigned( UnitClVentZone[1] ) < 1) then  UNCHANGED
						 		else  WriteToFile( ",%c%s%c", 34, UnitClVentZone[1]:Name, 34  )  endif  }
   "Write UnitClVentCFM[1]"		Proj:Action = {   if (IfValidAnd( UnitClVentCFMTot > 0.1 )==0 .OR. IfValidAnd( UnitClVentNumFans[1] < 0.5 )) then  UNCHANGED
						 		else  WriteToFile( ",%0.3f",  UnitClVentCFM[1]  )  endif  }
   "Write UnitClVentFan[1]:WperCFMCool"		Proj:Action = {   if (IfValidAnd( UnitClVentCFMTot > 0.1 )==0 .OR. IfValidAnd( UnitClVentNumFans[1] < 0.5 )) then  UNCHANGED
						 		else  WriteToFile( ",%0.3f",  UnitClVentFan[1]:WperCFMCool  )  endif  }

   "Write UnitClVentFan[2]"		Proj:Action = {   if (IfValidAnd( UnitClVentCFMTot > 0.1 )==0 .OR. IfValidAnd( UnitClVentNumFans[1] < 1.5 )) then  UNCHANGED
						 		else  WriteToFile( "\n,,%c%s%c", 34, UnitClVentFan[2]:Name, 34 )  endif  }
   "Write UnitClVentZone[2]"		Proj:Action = {   if (IfValidAnd( UnitClVentCFMTot > 0.1 )==0 .OR. IfValidAnd( UnitClVentNumFans[1] < 1.5 ) .OR. LocalCompAssigned( UnitClVentZone[2] ) < 1) then  UNCHANGED
						 		else  WriteToFile( ",%c%s%c", 34, UnitClVentZone[2]:Name, 34  )  endif  }
   "Write UnitClVentCFM[2]"		Proj:Action = {   if (IfValidAnd( UnitClVentCFMTot > 0.1 )==0 .OR. IfValidAnd( UnitClVentNumFans[1] < 1.5 )) then  UNCHANGED
						 		else  WriteToFile( ",%0.3f",  UnitClVentCFM[2]  )  endif  }
   "Write UnitClVentFan[2]:WperCFMCool"		Proj:Action = {   if (IfValidAnd( UnitClVentCFMTot > 0.1 )==0 .OR. IfValidAnd( UnitClVentNumFans[1] < 1.5 )) then  UNCHANGED
						 		else  WriteToFile( ",%0.3f",  UnitClVentFan[2]:WperCFMCool  )  endif  }

   "Write UnitClVentFan[3]"		Proj:Action = {   if (IfValidAnd( UnitClVentCFMTot > 0.1 )==0 .OR. IfValidAnd( UnitClVentNumFans[1] < 2.5 )) then  UNCHANGED
						 		else  WriteToFile( "\n,,%c%s%c", 34, UnitClVentFan[3]:Name, 34 )  endif  }
   "Write UnitClVentZone[3]"		Proj:Action = {   if (IfValidAnd( UnitClVentCFMTot > 0.1 )==0 .OR. IfValidAnd( UnitClVentNumFans[1] < 2.5 ) .OR. LocalCompAssigned( UnitClVentZone[3] ) < 1) then  UNCHANGED
						 		else  WriteToFile( ",%c%s%c", 34, UnitClVentZone[3]:Name, 34  )  endif  }
   "Write UnitClVentCFM[3]"		Proj:Action = {   if (IfValidAnd( UnitClVentCFMTot > 0.1 )==0 .OR. IfValidAnd( UnitClVentNumFans[1] < 2.5 )) then  UNCHANGED
						 		else  WriteToFile( ",%0.3f",  UnitClVentCFM[3]  )  endif  }
   "Write UnitClVentFan[3]:WperCFMCool"		Proj:Action = {   if (IfValidAnd( UnitClVentCFMTot > 0.1 )==0 .OR. IfValidAnd( UnitClVentNumFans[1] < 2.5 )) then  UNCHANGED
						 		else  WriteToFile( ",%0.3f",  UnitClVentFan[3]:WperCFMCool  )  endif  }

   "Write UnitClVentFan[4]"		Proj:Action = {   if (IfValidAnd( UnitClVentCFMTot > 0.1 )==0 .OR. IfValidAnd( UnitClVentNumFans[1] < 3.5 )) then  UNCHANGED
						 		else  WriteToFile( "\n,,%c%s%c", 34, UnitClVentFan[4]:Name, 34 )  endif  }
   "Write UnitClVentZone[4]"		Proj:Action = {   if (IfValidAnd( UnitClVentCFMTot > 0.1 )==0 .OR. IfValidAnd( UnitClVentNumFans[1] < 3.5 ) .OR. LocalCompAssigned( UnitClVentZone[4] ) < 1) then  UNCHANGED
						 		else  WriteToFile( ",%c%s%c", 34, UnitClVentZone[4]:Name, 34  )  endif  }
   "Write UnitClVentCFM[4]"		Proj:Action = {   if (IfValidAnd( UnitClVentCFMTot > 0.1 )==0 .OR. IfValidAnd( UnitClVentNumFans[1] < 3.5 )) then  UNCHANGED
						 		else  WriteToFile( ",%0.3f",  UnitClVentCFM[4]  )  endif  }
   "Write UnitClVentFan[4]:WperCFMCool"		Proj:Action = {   if (IfValidAnd( UnitClVentCFMTot > 0.1 )==0 .OR. IfValidAnd( UnitClVentNumFans[1] < 3.5 )) then  UNCHANGED
						 		else  WriteToFile( ",%0.3f",  UnitClVentFan[4]:WperCFMCool  )  endif  }

   "Write UnitClVentFan[5]"		Proj:Action = {   if (IfValidAnd( UnitClVentCFMTot > 0.1 )==0 .OR. IfValidAnd( UnitClVentNumFans[1] < 4.5 )) then  UNCHANGED
						 		else  WriteToFile( "\n,,%c%s%c", 34, UnitClVentFan[5]:Name, 34 )  endif  }
   "Write UnitClVentZone[5]"		Proj:Action = {   if (IfValidAnd( UnitClVentCFMTot > 0.1 )==0 .OR. IfValidAnd( UnitClVentNumFans[1] < 4.5 ) .OR. LocalCompAssigned( UnitClVentZone[5] ) < 1) then  UNCHANGED
						 		else  WriteToFile( ",%c%s%c", 34, UnitClVentZone[5]:Name, 34  )  endif  }
   "Write UnitClVentCFM[5]"		Proj:Action = {   if (IfValidAnd( UnitClVentCFMTot > 0.1 )==0 .OR. IfValidAnd( UnitClVentNumFans[1] < 4.5 )) then  UNCHANGED
						 		else  WriteToFile( ",%0.3f",  UnitClVentCFM[5]  )  endif  }
   "Write UnitClVentFan[5]:WperCFMCool"		Proj:Action = {   if (IfValidAnd( UnitClVentCFMTot > 0.1 )==0 .OR. IfValidAnd( UnitClVentNumFans[1] < 4.5 )) then  UNCHANGED
						 		else  WriteToFile( ",%0.3f",  UnitClVentFan[5]:WperCFMCool  )  endif  }

   "Write UnitClVentFan[6]"		Proj:Action = {   if (IfValidAnd( UnitClVentCFMTot > 0.1 )==0 .OR. IfValidAnd( UnitClVentNumFans[1] < 5.5 )) then  UNCHANGED
						 		else  WriteToFile( "\n,,%c%s%c", 34, UnitClVentFan[6]:Name, 34 )  endif  }
   "Write UnitClVentZone[6]"		Proj:Action = {   if (IfValidAnd( UnitClVentCFMTot > 0.1 )==0 .OR. IfValidAnd( UnitClVentNumFans[1] < 5.5 ) .OR. LocalCompAssigned( UnitClVentZone[6] ) < 1) then  UNCHANGED
						 		else  WriteToFile( ",%c%s%c", 34, UnitClVentZone[6]:Name, 34  )  endif  }
   "Write UnitClVentCFM[6]"		Proj:Action = {   if (IfValidAnd( UnitClVentCFMTot > 0.1 )==0 .OR. IfValidAnd( UnitClVentNumFans[1] < 5.5 )) then  UNCHANGED
						 		else  WriteToFile( ",%0.3f",  UnitClVentCFM[6]  )  endif  }
   "Write UnitClVentFan[6]:WperCFMCool"		Proj:Action = {   if (IfValidAnd( UnitClVentCFMTot > 0.1 )==0 .OR. IfValidAnd( UnitClVentNumFans[1] < 5.5 )) then  UNCHANGED
						 		else  WriteToFile( ",%0.3f",  UnitClVentFan[6]:WperCFMCool  )  endif  }

   "Write UnitClVentCFMTot"		Proj:Action = {   if (IfValidAnd( UnitClVentCFMTot > 0.1 )==0) then  UNCHANGED
						 		else  WriteToFile( "\n\n,,Total Cooling Ventilation CFM:,,%0.1f,\n", UnitClVentCFMTot )  endif  }

;	
;Provide summary of HERS measures	
;
   "Write two blank lines"						Proj:Action = {   WriteToFile( "\n\n" )  }
   "Write header for HERS Summary"			Proj:Action = {   if ( LocalCompAssigned( HERSProj) ) then WriteToFile( "Summary of Required HERS Verifications: \n" ) else UNCHANGED endif  }
   "Write column headings for HERSProj"	Proj:Action = {	if ( LocalCompAssigned( HERSProj) ) then WriteToFile( ",Project level: \n" ) else UNCHANGED endif  }
   "Write HERSProj:QII"							HERSOther:Action = {	if ( LocalStatus(QII) < 1 ) then UNCHANGED else WriteToFile( ",QII:, %s\n", EnumString( QIIRptMsg ) ) endif  }

;	
;Report Software Versions	
;

   "Write several blank lines"	Proj:Action = {   WriteToFile( "\n\n\n\n" )  }
   "Write CompMgrVersion"	Proj:Action = {   if (LocalStatus( CompMgrVersion ) < 1) then  UNCHANGED
							else  WriteToFile( "Compliance Manager Version:,,%c%s%c,\n", 34, CompMgrVersion, 34 )  endif  }
   "Write SoftwareVersion"	Proj:Action = {   if (LocalStatus( SoftwareVersion ) < 1) then  UNCHANGED
							else  WriteToFile( "Software Version:,,%c%s%c,\n",	34, SoftwareVersion , 34 )  endif  }
   "Write PrimSimEngingVer"	Proj:Action = {   if (LocalStatus( PrimSimEngingVer ) < 1) then  UNCHANGED
							else  WriteToFile( "%s Version:,,%c%s%c,\n",		CSEName, 34, PrimSimEngingVer, 34 )  endif  }
   "Write SecSimEngingVer"	Proj:Action = {   if (LocalStatus( SecSimEngingVer ) < 1) then  UNCHANGED
							else  WriteToFile( "DHW Version:,,%c%s%c,\n",		34, SecSimEngingVer , 34 )  endif  }
   "Write RulesetVersion"	Proj:Action = {   if (LocalStatus( RulesetVersion ) < 1) then  UNCHANGED
							else  WriteToFile( "Ruleset Version:,,%c%s%c,\n",	34, RulesetVersion  , 34 )  endif  }

END


;*************************************************************************
RULELIST  "ExtWall_Data_Report" 0 0 0 1
;*************************************************************************
;	mjb-10/9/13	report azimuth instead of orientation

   "Write ExtWall Name"			ExtWall:Action = {   WriteToFile( ",,%c%s%c,", 34, ExtWall:Name, 34 )  }
   "Write ExtWall Zone"			ExtWall:Action = {   WriteToFile( "%c%s%c,", 34, Parent(Name), 34 )  }
   "Write ExtWall Status"		ExtWall:Action = {   WriteToFile( "%s,", EnumString( ExtWall:Status ) )  }
   "Write ExtWall Type"			ExtWall:Action = {   WriteToFile( "%s,", ExtWall:Construction )  }
   "Write ExtWall Azimuth"		ExtWall:Action = {   WriteToFile( "%0.3f,", ExtWall:Azimuth )  }
   "Write ExtWall Area"			ExtWall:Action = {   WriteToFile( "%0.3f,", ExtWall:Area )  }
   "Write ExtWall Window Area"		ExtWall:Action = {   WriteToFile( "%0.3f,", ExtWall:RptTotWinArea )  }
   "Write ExtWall Door Area"		ExtWall:Action = {   WriteToFile( "%0.3f,", ExtWall:TotDoorArea )  }
   "Write ExtWall Tilt"			ExtWall:Action = {   WriteToFile( "%0.3f,", ExtWall:Tilt )  }
   "Write ExtWall Framing Factor"	ExtWall:Action = {   WriteToFile( "%0.3f,\n", ExtWall:FramingFactor )  }

END

;*************************************************************************
RULELIST  "UndWall_Data_Report" 0 0 0 1
;*************************************************************************
;	mjb-10/9/13	report azimuth instead of orientation

   "Write UndWall Name"					UndWall:Action	= {   WriteToFile( ",,%c%s%c,", 34, UndWall:Name, 34 )  }
   "Write UndWall Zone"					UndWall:Action = {   WriteToFile( "%c%s%c,", 34, Parent(Name), 34 )  }
   "Write ExtWall Status"				UndWall:Action = {   WriteToFile( "%s,", EnumString( UndWall:Status ) )  }
   "Write UndWall Type"					UndWall:Action = {   WriteToFile( "%s,", UndWall:Construction )  }
;   "Write UndWall Azimuth"			UndWall:Action = {   WriteToFile( "%0.3f,", UndWall:Azimuth )  }
   "Write UndWall DepthBelowGrade"	UndWall:Action = {   WriteToFile( "%0.3f,", UndWall:DepthBelowGrade )  }
   "Write UndWall Area"					UndWall:Action = {   WriteToFile( "%0.3f,", UndWall:Area )  }
 ;  "Write UndWall Tilt"				UndWall:Action = {   WriteToFile( "%0.3f,", UndWall:Tilt )  }
   "Write UndWall Framing Factor"	UndWall:Action = {   WriteToFile( "%0.3f,\n", UndWall:FramingFactor )  }

END

;*************************************************************************
RULELIST  "CathedralCeiling_Data_Report" 0 0 0 1
;*************************************************************************
;	mjb-10/9/13	report azimuth instead of orientation

   "Write CathedralCeiling Name"					CathedralCeiling:Action = {   WriteToFile( ",,%c%s%c,", 34, CathedralCeiling:Name, 34 )  }
   "Write CathedralCeiling Zone"					CathedralCeiling:Action = {   WriteToFile( "%c%s%c,", 34, Parent(Name), 34 )  }
   "Write CathedralCeiling Status"				CathedralCeiling:Action = {   WriteToFile( "%s,", EnumString( CathedralCeiling:Status ) )  }
   "Write CathedralCeiling Type"					CathedralCeiling:Action = {   WriteToFile( "%s,", CathedralCeiling:Construction )  }
   "Write CathedralCeiling Azimuth"				CathedralCeiling:Action = {   WriteToFile( "%0.3f,", CathedralCeiling:Azimuth )  }
   "Write CathedralCeiling Area"					CathedralCeiling:Action = {   WriteToFile( "%0.2f,", CathedralCeiling:Area )  }
   "Write CathedralCeiling RoofRise"			CathedralCeiling:Action = {   WriteToFile( "%0.3f,", CathedralCeiling:RoofRise )  }
   "Write CathedralCeiling RoofPitch"			CathedralCeiling:Action = {   WriteToFile( "%0.3f,", CathedralCeiling:RoofPitch )  }
   "Write CathedralCeiling RoofTilt"			CathedralCeiling:Action = {   WriteToFile( "%0.3f,", CathedralCeiling:RoofTilt )  }
   "Write CathedralCeiling RoofSolReflect"	CathedralCeiling:Action = {   WriteToFile( "%0.3f,", CathedralCeiling:RoofSolReflect )  }
   "Write CathedralCeiling RoofEmiss"			CathedralCeiling:Action = {   WriteToFile( "%0.3f,", CathedralCeiling:RoofEmiss )  }
   "Write CathedralCeiling Framing Factor"	CathedralCeiling:Action = {   WriteToFile( "%0.3f,\n", CathedralCeiling:FramingFactor )  }

END

;*************************************************************************
RULELIST  "CeilingBelowAttic_Data_Report" 0 0 0 1
;*************************************************************************

   "Write CeilingBelowAttic Name"				CeilingBelowAttic:Action = {   WriteToFile( ",,%c%s%c,", 34, CeilingBelowAttic:Name, 34 )  }
   "Write CeilingBelowAttic Zone"				CeilingBelowAttic:Action = {   WriteToFile( "%c%s%c,", 34, Parent(Name), 34 )  }
;   "Write CeilingBelowAttic AtticZone"		CeilingBelowAttic:Action = {   WriteToFile( "%c%s%c,", 34, CeilingBelowAttic:AtticZone, 34 )  }
   "Write CeilingBelowAttic Status"				CeilingBelowAttic:Action = {   WriteToFile( "%s,", EnumString( CeilingBelowAttic:Status ) )  }
   "Write CeilingBelowAttic Type"				CeilingBelowAttic:Action = {   WriteToFile( "%s,", CeilingBelowAttic:Construction )  }
   "Write CeilingBelowAttic Area"				CeilingBelowAttic:Action = {   WriteToFile( "%0.2f,", CeilingBelowAttic:Area )  }
   "Write CeilingBelowAttic AtcEdg_Length"	CeilingBelowAttic:Action = {   WriteToFile( "%0.2f,", CeilingBelowAttic:AtcEdg_Length )  }
   "Write CeilingBelowAttic AtcEdg_TotArea"	CeilingBelowAttic:Action = {   WriteToFile( "%0.2f,\n", CeilingBelowAttic:AtcEdg_TotArea )  }

END

;*************************************************************************
RULELIST  "SlabFloor_Data_Report" 0 0 0 1
;*************************************************************************

   "Write SlabFloor Name"					SlabFloor:Action = {   WriteToFile( ",,%c%s%c,", 34, SlabFloor:Name, 34 )  }
   "Write SlabFloor Zone"					SlabFloor:Action = {   WriteToFile( "%c%s%c,", 34, Parent(Name), 34 )  }
   "Write SlabFloor Status"				SlabFloor:Action = {   WriteToFile( "%s,", EnumString( SlabFloor:Status ) )  }
   "Write SlabFloor Area"					SlabFloor:Action = {   WriteToFile( "%0.2f,", SlabFloor:Area )  }
   "Write SlabFloor Perimeter"			SlabFloor:Action = {   WriteToFile( "%0.3f,", SlabFloor:Perimeter )  }
   "Write SlabFloor EdgeInsulRValue"	SlabFloor:Action = {   WriteToFile( "%0.3f,", SlabFloor:EdgeInsulRValue )  }
   "Write SlabFloor CarpetedFrac"		SlabFloor:Action = {   WriteToFile( "%0.3f,", SlabFloor:CarpetedFrac )  }
   "Write SlabFloor HeatedSlab flag"	SlabFloor:Action = {   if ( SlabFloor:HeatedSlab > 0.5  ) then  WriteToFile( "%c%s%c,\n",	34, "Yes" , 34  )
								  														else  WriteToFile( "%c%s%c,\n",	34, "No" , 34 )  endif  }                                                
END

;*************************************************************************
RULELIST  "ExteriorFloor_Data_Report" 0 0 0 1
;*************************************************************************

   "Write ExteriorFloor Name"						ExteriorFloor:Action = {   WriteToFile( ",,%c%s%c,", 34, ExteriorFloor:Name, 34 )  }
   "Write ExteriorFloor Zone"						ExteriorFloor:Action = {   WriteToFile( "%c%s%c,", 34, Parent(Name), 34 )  }
   "Write ExteriorFloor Status"					ExteriorFloor:Action = {   WriteToFile( "%s,", EnumString( ExteriorFloor:Status ) )  }
; SAC 6/9/14 - remove ExteriorFloor:Type
;   "Write ExteriorFloor Type"						ExteriorFloor:Action = {   WriteToFile( "%c%s%c,", 34, ExteriorFloor:Type, 34 )  }
   "Write ExteriorFloor Construction Type"	ExteriorFloor:Action = {   WriteToFile( "%s,", ExteriorFloor:Construction )  }
   "Write ExteriorFloor Area"						ExteriorFloor:Action = {   WriteToFile( "%0.2f,", ExteriorFloor:Area )  }
   "Write ExteriorFloor Framing Factor"		ExteriorFloor:Action = {   WriteToFile( "%0.3f,\n", ExteriorFloor:FramingFactor )  }

END

;*************************************************************************
RULELIST  "FloorOverCrawl_Data_Report" 0 0 0 1
;*************************************************************************

   "Write FloorOverCrawl Name"			FloorOverCrawl:Action = {   WriteToFile( ",,%c%s%c,", 34, FloorOverCrawl:Name, 34 )  }
   "Write FloorOverCrawl Zone"			FloorOverCrawl:Action = {   WriteToFile( "%c%s%c,", 34, Parent(Name), 34 )  }
   "Write FloorOverCrawl Status"			FloorOverCrawl:Action = {   WriteToFile( "%s,", EnumString( FloorOverCrawl:Status ) )  }
   "Write FloorOverCrawl Type"			FloorOverCrawl:Action = {   WriteToFile( "%s,", FloorOverCrawl:Construction )  }
   "Write FloorOverCrawl Area"			FloorOverCrawl:Action = {   WriteToFile( "%0.2f,", FloorOverCrawl:Area )  }
   "Write FloorOverCrawl Framing Factor"	FloorOverCrawl:Action = {   WriteToFile( "%0.3f,\n", FloorOverCrawl:FramingFactor )  }

END

;*************************************************************************
RULELIST  "UndFloor_Data_Report" 0 0 0 1
;*************************************************************************

   "Write UndFloor Name"			UndFloor:Action = {   WriteToFile( ",,%c%s%c,", 34, UndFloor:Name, 34 )  }
   "Write UndFloor Zone"			UndFloor:Action = {   WriteToFile( "%c%s%c,", 34, Parent(Name), 34 )  }
   "Write UndFloor Status"			UndFloor:Action = {   WriteToFile( "%s,", EnumString( UndFloor:Status ) )  }
;   "Write UndFloor Type"			UndFloor:Action = {   WriteToFile( "%s,", UndFloor:Construction )  }
   "Write UndFloor Area"			UndFloor:Action = {   WriteToFile( "%0.3f,", UndFloor:Area )  }
   "Write UndFloor Framing Factor"		UndFloor:Action = {   WriteToFile( "%0.3f,\n", UndFloor:FramingFactor )  }

END

;*************************************************************************
RULELIST  "Win_Data_Report" 0 0 0 1
;*************************************************************************

   "Write Window Name"			Win:Action = {   WriteToFile( ",,%c%s%c,", 34, Win:Name, 34 )  }
   "Write Window Zone"			Win:Action = {   WriteToFile( "%c%s%c,", 34, Parent(Name), 34 )  }
   "Write Window Status"		Win:Action = {   WriteToFile( "%s,", EnumString( Win:Status ) )  }
; SAC 1/13/14 - revise rules to output blank for windows w/ undefined height or width
; mjb	2/19/14	added fenestration Azimuth
   "Write Window Azimuth"		Win:Action = {   WriteToFile( "%0.3f,", Win:Azimuth )  }
   "Write Window Height"		Win:Action = {		if (LocalStatus( Height ) < 1) then  WriteToFile( "," )
																else  WriteToFile( "%0.2f,", Win:Height )  endif  }
   "Write Window Width"			Win:Action = {		if (LocalStatus( Width ) < 1) then  WriteToFile( "," )
																else  WriteToFile( "%0.2f,", Win:Width )  endif  }
   "Write Window Multiplier"	Win:Action = {   WriteToFile( "%0.3f,", Win:Multiplier )  }
   "Write Window Area"			Win:Action = {   WriteToFile( "%0.2f,", Win:Area )  }
   "Write Window Ufactor"		Win:Action = {   WriteToFile( "%0.3f,", Win:NFRCUfactor )  }
   "Write Window SHGC"			Win:Action = {   WriteToFile( "%0.3f,", Win:NFRCSHGC )  }
   "Write Window Ext Shade"	Win:Action = {   WriteToFile( "%s,\n", EnumString( Win:ExteriorShade ) ) }

END

;*************************************************************************
RULELIST  "Attic_Data_Report" 0 0 0 1
;*************************************************************************

   "Write Attic Name"					Attic:Action = {   WriteToFile( ",,%c%s%c,", 34, Attic:Name, 34 )  }
   "Write Attic Status"					Attic:Action = {   WriteToFile( "%s,", EnumString( Attic:Status ) )  }
   "Write Attic Type"					Attic:Action = {   WriteToFile( "%s,", Attic:Construction )  }
   "Write Attic FloorArea"				Attic:Action = {   WriteToFile( "%0.2f,", Attic:FloorArea )  }
   "Write Attic RoofRise"				Attic:Action = {   WriteToFile( "%0.1f,", Attic:RoofRise )  }
   "Write Attic RoofSolReflect"		Attic:Action = {   WriteToFile( "%0.3f,", Attic:RoofSolReflect )  }
   "Write Attic RoofEmiss"				Attic:Action = {   WriteToFile( "%0.3f,", Attic:RoofEmiss )  }
   "Write Attic RoofFramingFactor"	Attic:Action = {   WriteToFile( "%0.2f,\n", Attic:RoofFramingFactor )  }

END

;*************************************************************************
RULELIST  "CrawlSpace_Data_Report" 0 0 0 1
;*************************************************************************

   "Write CrawlSpace Name"		CrawlSpace:Action = {   WriteToFile( ",,%c%s%c,", 34, CrawlSpace:Name, 34 )  }
   "Write CrawlSpace Type"		CrawlSpace:Action = {   WriteToFile( "%c%s%c,", 34, EnumString( Type ), 34 )  }
   "Write CrawlSpace Area"		CrawlSpace:Action = {   WriteToFile( "%0.2f,", CrawlSpace:Area )  }
   "Write CrawlSpace Perimeter"		CrawlSpace:Action = {   WriteToFile( "%0.2f,", CrawlSpace:Perimeter )  }
   "Write CrawlSpace AvgWallHeight"	CrawlSpace:Action = {   WriteToFile( "%0.2f,\n", CrawlSpace:AvgWallHeight )  }

END

;*************************************************************************
RULELIST  "Skylt_Data_Report" 0 0 0 1
;*************************************************************************

   "Write Skylight Name"			Skylt:Action = {   WriteToFile( ",,%c%s%c,", 34, Skylt:Name, 34 )  }
   "Write Skylight Zone"			Skylt:Action = {   WriteToFile( "%c%s%c,", 34, Parent(Name), 34 )  }
   "Write Skylight Status"			Skylt:Action = {   WriteToFile( "%s,", EnumString( Skylt:Status ) )  }
; mjb	2/19/14	added fenestration Azimuth
   "Write Skylight Azimuth"		Skylt:Action = {   WriteToFile( "%0.3f,", Skylt:Azimuth )  }
   "Write Skylight Multiplier"	Skylt:Action = {   WriteToFile( "%0.3f,", Skylt:Multiplier )  }
   "Write Skylight Area"			Skylt:Action = {   WriteToFile( "%0.2f,", Skylt:Area )  }
   "Write Skylight Ufactor"		Skylt:Action = {   WriteToFile( "%0.3f,", Skylt:NFRCUfactor )  }
   "Write Skylight SHGC"			Skylt:Action = {   WriteToFile( "%0.3f,\n", Skylt:NFRCSHGC )  }

END

;*************************************************************************
RULELIST  "Cons_Data_Report" 0 0 0 1
;*************************************************************************

   "Write Cons Name"						Cons:Action = {   WriteToFile( ",,%c%s%c,", 34, Cons:Name, 34 )  }
   "Write Cons Type"						Cons:Action = {   WriteToFile( "%c%s%c,", 34, EnumString( Cons:Type ), 34 )  }
   "Write Cons CavityLayer"			Cons:Action = {   if (CavityLayer == 100401) then  WriteToFile( "0," )
																		else  WriteToFile( "%0.3f,", Cons:CavityLayer )  endif  }
   "Write Cons OverallThickness"		Cons:Action = {   WriteToFile( "%0.3f,", Cons:OverallThickness )  }
   "Write Cons WinterDesUValue"		Cons:Action = {   WriteToFile( "%0.3f,", Cons:WinterDesUValue )  }
   "Write Cons Radiant Barrier"		Cons:Action = {   if ( Local( CanAssignTo ) == 1 ) then
   																		if ( RadiantBarrier > 0.5  ) then  WriteToFile( "%c%s%c,",	34, "Yes" , 34  )
								  											else  WriteToFile( "%c%s%c,",	34, "No" , 34 )  endif
								  										else UNCHANGED endif  } 

   "Write Cons AssemblyLayersRpt[1]"	Cons:Action = {   if ( NumLayersRpt > 0.5 ) then  WriteToFile( "%c%s%c,\n", 34, AssemblyLayersRpt[1], 34 )   else UNCHANGED endif  }
   "Write Cons AssemblyLayersRpt[2]"	Cons:Action = {   if ( NumLayersRpt > 1.5 .AND. CanAssignTo == 1 ) then 	WriteToFile( ",,,,,,,,%c%s%c,\n", 34, AssemblyLayersRpt[2], 34 ) 
																			else if ( NumLayersRpt > 1.5 ) then								WriteToFile(  ",,,,,,,%c%s%c,\n", 34, AssemblyLayersRpt[2], 34 )   else UNCHANGED endif endif	}
   "Write Cons AssemblyLayersRpt[3]"	Cons:Action = {   if ( NumLayersRpt > 2.5 .AND. CanAssignTo == 1 ) then 	WriteToFile( ",,,,,,,,%c%s%c,\n", 34, AssemblyLayersRpt[3], 34 ) 
																			else if ( NumLayersRpt > 2.5 ) then								WriteToFile(  ",,,,,,,%c%s%c,\n", 34, AssemblyLayersRpt[3], 34 )   else UNCHANGED endif endif	}
   "Write Cons AssemblyLayersRpt[4]"	Cons:Action = {   if ( NumLayersRpt > 3.5 .AND. CanAssignTo == 1 ) then 	WriteToFile( ",,,,,,,,%c%s%c,\n", 34, AssemblyLayersRpt[4], 34 ) 
																			else if ( NumLayersRpt > 3.5 ) then								WriteToFile(  ",,,,,,,%c%s%c,\n", 34, AssemblyLayersRpt[4], 34 )   else UNCHANGED endif endif	}
   "Write Cons AssemblyLayersRpt[5]"	Cons:Action = {   if ( NumLayersRpt > 4.5 .AND. CanAssignTo == 1 ) then 	WriteToFile( ",,,,,,,,%c%s%c,\n", 34, AssemblyLayersRpt[5], 34 ) 
																			else if ( NumLayersRpt > 4.5 ) then								WriteToFile(  ",,,,,,,%c%s%c,\n", 34, AssemblyLayersRpt[5], 34 )   else UNCHANGED endif endif	}
   "Write Cons AssemblyLayersRpt[6]"	Cons:Action = {   if ( NumLayersRpt > 5.5 .AND. CanAssignTo == 1 ) then 	WriteToFile( ",,,,,,,,%c%s%c,\n", 34, AssemblyLayersRpt[6], 34 ) 
																			else if ( NumLayersRpt > 5.5 ) then								WriteToFile(  ",,,,,,,%c%s%c,\n", 34, AssemblyLayersRpt[6], 34 )   else UNCHANGED endif endif	}
   "Write Cons AssemblyLayersRpt[7]"	Cons:Action = {   if ( NumLayersRpt > 6.5 .AND. CanAssignTo == 1 ) then 	WriteToFile( ",,,,,,,,%c%s%c,\n", 34, AssemblyLayersRpt[7], 34 ) 
																			else if ( NumLayersRpt > 6.5 ) then								WriteToFile(  ",,,,,,,%c%s%c,\n", 34, AssemblyLayersRpt[7], 34 )   else UNCHANGED endif endif	}
   "Write Cons AssemblyLayersRpt[8]"	Cons:Action = {   if ( NumLayersRpt > 7.5 .AND. CanAssignTo == 1 ) then 	WriteToFile( ",,,,,,,,%c%s%c,\n", 34, AssemblyLayersRpt[8], 34 ) 
																			else if ( NumLayersRpt > 7.5 ) then								WriteToFile(  ",,,,,,,%c%s%c,\n", 34, AssemblyLayersRpt[8], 34 )   else UNCHANGED endif endif	}
   "Write Cons AssemblyLayersRpt[9]"	Cons:Action = {   if ( NumLayersRpt > 8.5 .AND. CanAssignTo == 1 ) then 	WriteToFile( ",,,,,,,,%c%s%c,\n", 34, AssemblyLayersRpt[9], 34 ) 
																			else if ( NumLayersRpt > 8.5 ) then								WriteToFile(  ",,,,,,,%c%s%c,\n", 34, AssemblyLayersRpt[9], 34 )   else UNCHANGED endif endif	}
   "Write Cons AssemblyLayersRpt[10]"	Cons:Action = {   if ( NumLayersRpt > 9.5 .AND. CanAssignTo == 1 ) then 	WriteToFile( ",,,,,,,,%c%s%c,\n", 34, AssemblyLayersRpt[10], 34 ) 
																			else if ( NumLayersRpt > 9.5 ) then								WriteToFile(  ",,,,,,,%c%s%c,\n", 34, AssemblyLayersRpt[10], 34 )   else UNCHANGED endif endif	}
; SAC 11/20/14 - revised cons layer output (below) to use NumLayersRpt & AssemblyLayersRpt (above) to get around issues related to 2-path frame cons objects vs. concrete/furring - plus more descriptive...
;   "Write Cons FramePathMats"			Cons:Action = {   if ( NumPaths < 2 ) then  WriteToFile( "," )
;   																	else if ( NumLayerMats > 0.5 ) then WriteToFile( "%c%s%c,", 34, FramePathMats[1]:Name, 34 ) 
;																		else UNCHANGED endif endif  }
;   "Write Cons CavityPathMats"		Cons:Action = {   if ( NumLayerMats > 0.5 ) then WriteToFile( "%c%s%c,\n", 34, CavityPathMats[1]:Name, 34 ) 
;																		else UNCHANGED endif  }
;   "Write Cons FramePathMats"			Cons:Action = {   if ( NumLayerMats > 1.5 .AND. NumPaths < 2 ) then  if (CanAssignTo == 1) then  WriteToFile( ",,,,,,,,," )  else  WriteToFile( ",,,,,,,," )  endif
;   																	else if ( Local( CanAssignTo ) == 1 ) then
;   																		if ( NumLayerMats > 1.5 ) then WriteToFile( ",,,,,,,,%c%s%c,", 34, FramePathMats[2]:Name, 34 ) 
;																			else UNCHANGED endif
;																		else if ( NumLayerMats > 1.5 ) then WriteToFile( ",,,,,,,%c%s%c,", 34, FramePathMats[2]:Name, 34 ) 
;																			else UNCHANGED endif endif endif	}
;   "Write Cons CavityPathMats"		Cons:Action = {   if ( NumLayerMats > 1.5 ) then WriteToFile( "%c%s%c,\n", 34, CavityPathMats[2]:Name, 34 ) 
;																		else UNCHANGED endif  }
;   "Write Cons FramePathMats"			Cons:Action = {   if ( NumLayerMats > 2.5 .AND. NumPaths < 2 ) then  if (CanAssignTo == 1) then  WriteToFile( ",,,,,,,,," )  else  WriteToFile( ",,,,,,,," )  endif
;   																	else if ( Local( CanAssignTo ) == 1 ) then
;   																		if ( NumLayerMats > 2.5 ) then WriteToFile( ",,,,,,,,%c%s%c,", 34, FramePathMats[3]:Name, 34 ) 
;																			else UNCHANGED endif
;																		else if ( NumLayerMats > 2.5 ) then WriteToFile( ",,,,,,,%c%s%c,", 34, FramePathMats[3]:Name, 34 ) 
;																			else UNCHANGED endif endif endif	}
;   "Write Cons CavityPathMats"		Cons:Action = {   if ( NumLayerMats > 2.5 ) then WriteToFile( "%c%s%c,\n", 34, CavityPathMats[3]:Name, 34 ) 
;																		else UNCHANGED endif  }
;   "Write Cons FramePathMats"			Cons:Action = {   if ( NumLayerMats > 3.5 .AND. NumPaths < 2 ) then  if (CanAssignTo == 1) then  WriteToFile( ",,,,,,,,," )  else  WriteToFile( ",,,,,,,," )  endif
;   																	else if ( Local( CanAssignTo ) == 1 ) then
;   																		if ( NumLayerMats > 3.5 ) then WriteToFile( ",,,,,,,,%c%s%c,", 34, FramePathMats[4]:Name, 34 ) 
;																			else UNCHANGED endif
;																		else if ( NumLayerMats > 3.5 ) then WriteToFile( ",,,,,,,%c%s%c,", 34, FramePathMats[4]:Name, 34 ) 
;																			else UNCHANGED endif endif endif	}
;   "Write Cons CavityPathMats"		Cons:Action = {   if ( NumLayerMats > 3.5 ) then WriteToFile( "%c%s%c,\n", 34, CavityPathMats[4]:Name, 34 ) 
;																		else UNCHANGED endif  }
;   "Write Cons FramePathMats"			Cons:Action = {   if ( NumLayerMats > 4.5 .AND. NumPaths < 2 ) then  if (CanAssignTo == 1) then  WriteToFile( ",,,,,,,,," )  else  WriteToFile( ",,,,,,,," )  endif
;   																	else if ( Local( CanAssignTo ) == 1 ) then
;   																		if ( NumLayerMats > 4.5 ) then WriteToFile( ",,,,,,,,%c%s%c,", 34, FramePathMats[5]:Name, 34 ) 
;																			else UNCHANGED endif
;																		else if ( NumLayerMats > 4.5 ) then WriteToFile( ",,,,,,,%c%s%c,", 34, FramePathMats[5]:Name, 34 ) 
;																			else UNCHANGED endif endif endif	}
;   "Write Cons CavityPathMats"		Cons:Action = {   if ( NumLayerMats > 4.5 ) then WriteToFile( "%c%s%c,\n", 34, CavityPathMats[5]:Name, 34 ) 
;																		else UNCHANGED endif  }
;   "Write Cons FramePathMats"			Cons:Action = {   if ( NumLayerMats > 5.5 .AND. NumPaths < 2 ) then  if (CanAssignTo == 1) then  WriteToFile( ",,,,,,,,," )  else  WriteToFile( ",,,,,,,," )  endif
;   																	else if ( Local( CanAssignTo ) == 1 ) then
;   																		if ( NumLayerMats > 5.5 ) then WriteToFile( ",,,,,,,,%c%s%c,", 34, FramePathMats[6]:Name, 34 ) 
;																			else UNCHANGED endif
;																		else if ( NumLayerMats > 5.5 ) then WriteToFile( ",,,,,,,%c%s%c,", 34, FramePathMats[6]:Name, 34 ) 
;																			else UNCHANGED endif endif endif	}
;   "Write Cons CavityPathMats"		Cons:Action = {   if ( NumLayerMats > 5.5 ) then WriteToFile( "%c%s%c,\n", 34, CavityPathMats[6]:Name, 34 ) 
;																		else UNCHANGED endif  }
;   "Write Cons FramePathMats"			Cons:Action = {   if ( NumLayerMats > 6.5 .AND. NumPaths < 2 ) then  if (CanAssignTo == 1) then  WriteToFile( ",,,,,,,,," )  else  WriteToFile( ",,,,,,,," )  endif
;   																	else if ( Local( CanAssignTo ) == 1 ) then
;   																		if ( NumLayerMats > 6.5 ) then WriteToFile( ",,,,,,,,%c%s%c,", 34, FramePathMats[7]:Name, 34 ) 
;																			else UNCHANGED endif
;																		else if ( NumLayerMats > 6.5 ) then WriteToFile( ",,,,,,,%c%s%c,", 34, FramePathMats[7]:Name, 34 ) 
;																			else UNCHANGED endif endif endif	}
;   "Write Cons CavityPathMats"		Cons:Action = {   if ( NumLayerMats > 6.5 ) then WriteToFile( "%c%s%c,\n", 34, CavityPathMats[7]:Name, 34 ) 
;																		else UNCHANGED endif  }
;   "Write Cons FramePathMats"			Cons:Action = {   if ( NumLayerMats > 7.5 .AND. NumPaths < 2 ) then  if (CanAssignTo == 1) then  WriteToFile( ",,,,,,,,," )  else  WriteToFile( ",,,,,,,," )  endif
;   																	else if ( Local( CanAssignTo ) == 1 ) then
;   																		if ( NumLayerMats > 7.5 ) then WriteToFile( ",,,,,,,,%c%s%c,", 34, FramePathMats[8]:Name, 34 ) 
;																			else UNCHANGED endif
;																		else if ( NumLayerMats > 7.5 ) then WriteToFile( ",,,,,,,%c%s%c,", 34, FramePathMats[8]:Name, 34 ) 
;																			else UNCHANGED endif endif endif	}
;   "Write Cons CavityPathMats"		Cons:Action = {   if ( NumLayerMats > 7.5 ) then WriteToFile( "%c%s%c,\n", 34, CavityPathMats[8]:Name, 34 ) 
;																		else UNCHANGED endif  }
;   "Write Cons FramePathMats"			Cons:Action = {   if ( NumLayerMats > 8.5 .AND. NumPaths < 2 ) then  if (CanAssignTo == 1) then  WriteToFile( ",,,,,,,,," )  else  WriteToFile( ",,,,,,,," )  endif
;   																	else if ( Local( CanAssignTo ) == 1 ) then
;   																		if ( NumLayerMats > 8.5 ) then WriteToFile( ",,,,,,,,%c%s%c,", 34, FramePathMats[9]:Name, 34 ) 
;																			else UNCHANGED endif
;																		else if ( NumLayerMats > 8.5 ) then WriteToFile( ",,,,,,,%c%s%c,", 34, FramePathMats[9]:Name, 34 ) 
;																			else UNCHANGED endif endif endif	}
;   "Write Cons CavityPathMats"		Cons:Action = {   if ( NumLayerMats > 8.5 ) then WriteToFile( "%c%s%c,\n", 34, CavityPathMats[9]:Name, 34 ) 
;																		else UNCHANGED endif  }
;   "Write Cons FramePathMats"			Cons:Action = {   if ( NumLayerMats > 9.5 .AND. NumPaths < 2 ) then  if (CanAssignTo == 1) then  WriteToFile( ",,,,,,,,," )  else  WriteToFile( ",,,,,,,," )  endif
;   																	else if ( Local( CanAssignTo ) == 1 ) then
;   																		if ( NumLayerMats > 9.5 ) then WriteToFile( ",,,,,,,,%c%s%c,", 34, FramePathMats[10]:Name, 34 ) 
;																			else UNCHANGED endif
;																		else if ( NumLayerMats > 9.5 ) then WriteToFile( ",,,,,,,%c%s%c,", 34, FramePathMats[10]:Name, 34 ) 
;																			else UNCHANGED endif endif endif	}
;   "Write Cons CavityPathMats"		Cons:Action = {   if ( NumLayerMats > 9.5 ) then WriteToFile( "%c%s%c,\n", 34, CavityPathMats[10]:Name, 34 ) 
;																		else UNCHANGED endif  }

END

;*************************************************************************
RULELIST  "DwellingUnit_Data_Report" 0 0 0 1
;*************************************************************************
   "Write DwellingUnit Zone"				DwellUnit:Action = {   WriteToFile( ",,%s,", Parent(Name) )  }
   "Write DwellingUnit Name"				DwellUnit:Action = {   WriteToFile( "%s,", Name )  }
   "Write DwellingUnit Count"				DwellUnit:Action = {   WriteToFile( "%0.1f,", Count )  }
   "Write DwellingUnit Floor Area"		DwellUnit:Action = {   WriteToFile( "%0.1f,", CondFlrArea )  }
   "Write DwellingUnit Bedrooms"			DwellUnit:Action = {   WriteToFile( "%0.1f,", DwellUnitTypeRef:NumBedrooms )  }
   "Write DwellingUnit Refrig"			DwellUnit:Action = {   WriteToFile( "%0.1f,", DwellUnitTypeRef:RefrigElecUsage )  }
   "Write DwellingUnit Dish"				DwellUnit:Action = {   WriteToFile( "%0.1f,", DwellUnitTypeRef:DishElecUsage )  }
   "Write DwellingUnit Elec Cook"		DwellUnit:Action = {   WriteToFile( "%0.1f,", UnitCookElecGain )  }
   "Write DwellingUnit Gas Cook"			DwellUnit:Action = {   WriteToFile( "%0.1f,", UnitCookGasGain )  }
;   "Write DwellingUnit Cook Fuel"		DwellUnit:Action = {   WriteToFile( "%s,", DwellUnitTypeRef:CookFuel )  }
   "Write DwellingUnit Wash"				DwellUnit:Action = {   WriteToFile( "%0.1f,", UnitClthWashGain )  }
   "Write DwellingUnit Elec Dry"			DwellUnit:Action = {   WriteToFile( "%0.1f,", UnitClthDryElecGain )  }
   "Write DwellingUnit Gas Dry"			DwellUnit:Action = {   WriteToFile( "%0.1f,", UnitClthDryGasGain )  }
;   "Write DwellingUnit Dry Fuel"			DwellUnit:Action = {   WriteToFile( "%s,", DwellUnitTypeRef:DryerFuel )  }
   "Write DwellingUnit Ltg"				DwellUnit:Action = {   WriteToFile( "%0.1f,", UnitLtgGain )  }
   "Write DwellingUnit Misc"				DwellUnit:Action = {   WriteToFile( "%0.1f,", UnitMscElecGain )  }

	"Write Default IAQ Fan"								DwellUnit:Action = {   if (DwellUnitTypeRef:IAQOption >= 4) then  WriteToFile( "%s,", EnumString(DwellUnitTypeRef:IAQOption) ) else  UNCHANGED  endif  }    ; SAC 12/16/19
	"Write Default IAQ Fan CFM"						DwellUnit:Action = {   if (DwellUnitTypeRef:IAQOption >= 4) then  WriteToFile( "%0.1f,\n", TotalIAQCFM ) else  UNCHANGED  endif  }
;	"Write CFM string"									DwellUnit:Action = {   if (DwellUnitTypeRef:IAQOption == 1) then  WriteToFile( "%s,\n", "CFM" ) else  UNCHANGED  endif  }

; IAQ Fan 1
	"Write IAQFanRef[1]"									DwellUnit:Action = {   if (DwellUnitTypeRef:IAQNumFanRefs < 0.5) then  UNCHANGED
								 																	else  WriteToFile( "%s", DwellUnitTypeRef:IAQFanRef[1] )  endif  }
	"Write IAQCFM[1]"										DwellUnit:Action = {   if (DwellUnitTypeRef:IAQNumFanRefs < 0.5) then  UNCHANGED
								 																	else  WriteToFile( ",%0.3f", DwellUnitTypeRef:IAQCFM[1]  )  endif  }
	"Write IAQ Fan 1 W/CFM"								DwellUnit:Action = {   if (DwellUnitTypeRef:IAQNumFanRefs < 0.5) then  UNCHANGED
		  																							else  WriteToFile( ",%0.3f", ValidOr( DwellUnitTypeRef:IAQFanRef[1]:WperCFMIAQ, 0 )  )  endif  }
	"Write IAQ Fan 1 Type"								DwellUnit:Action = {   if (DwellUnitTypeRef:IAQNumFanRefs < 0.5) then  UNCHANGED
		  																							else  WriteToFile( ",%s", DwellUnitTypeRef:IAQFanRef[1]:IAQFanTypeStr  )  endif  }
;	"Write IAQFanCnt[1]"									DwellUnit:Action = {   if (DwellUnitTypeRef:IAQNumFanRefs < 0.5) then  UNCHANGED
;								 																	else  WriteToFile( ",%0.1f,\n", DwellUnitTypeRef:IAQFanCnt[1]  )  endif  }
; IAQ Fan 2
	"Write IAQFanRef[2]"									DwellUnit:Action = {   if (DwellUnitTypeRef:IAQNumFanRefs < 1.5) then  UNCHANGED
								 																	else  WriteToFile( ",,,,,,,,,,,,,,%s", DwellUnitTypeRef:IAQFanRef[2] )  endif  }
	"Write IAQCFM[2]"										DwellUnit:Action = {   if (DwellUnitTypeRef:IAQNumFanRefs < 1.5) then  UNCHANGED
								 																	else  WriteToFile( ",%0.3f", DwellUnitTypeRef:IAQCFM[2]  )  endif  }
	"Write IAQ Fan 2 W/CFM"								DwellUnit:Action = {   if (DwellUnitTypeRef:IAQNumFanRefs < 1.5) then  UNCHANGED
		  																							else  WriteToFile( ",%0.3f", ValidOr( DwellUnitTypeRef:IAQFanRef[2]:WperCFMIAQ, 0 )  )  endif  }
	"Write IAQ Fan 2 Type"								DwellUnit:Action = {   if (DwellUnitTypeRef:IAQNumFanRefs < 1.5) then  UNCHANGED
		  																							else  WriteToFile( ",%s", DwellUnitTypeRef:IAQFanRef[2]:IAQFanTypeStr  )  endif  }
;	"Write IAQFanCnt[2]"									DwellUnit:Action = {   if (DwellUnitTypeRef:IAQNumFanRefs < 1.5) then  UNCHANGED
;								 																	else  WriteToFile( ",%0.1f,\n", DwellUnitTypeRef:IAQFanCnt[2]  )  endif  }
; IAQ Fan 3
	"Write IAQFanRef[3]"									DwellUnit:Action = {   if (DwellUnitTypeRef:IAQNumFanRefs < 2.5) then  UNCHANGED
								 																	else  WriteToFile( ",,,,,,,,,,,,,,%s", DwellUnitTypeRef:IAQFanRef[3] )  endif  }
	"Write IAQCFM[3]"										DwellUnit:Action = {   if (DwellUnitTypeRef:IAQNumFanRefs < 2.5) then  UNCHANGED
								 																	else  WriteToFile( ",%0.3f", DwellUnitTypeRef:IAQCFM[3]  )  endif  }
	"Write IAQ Fan 3 W/CFM"								DwellUnit:Action = {   if (DwellUnitTypeRef:IAQNumFanRefs < 2.5) then  UNCHANGED
		  																							else  WriteToFile( ",%0.3f", ValidOr( DwellUnitTypeRef:IAQFanRef[3]:WperCFMIAQ, 0 )  )  endif  }
	"Write IAQ Fan 3 Type"								DwellUnit:Action = {   if (DwellUnitTypeRef:IAQNumFanRefs < 2.5) then  UNCHANGED
		  																							else  WriteToFile( ",%s", DwellUnitTypeRef:IAQFanRef[3]:IAQFanTypeStr  )  endif  }
;	"Write IAQFanCnt[3]"									DwellUnit:Action = {   if (DwellUnitTypeRef:IAQNumFanRefs < 2.5) then  UNCHANGED
;								 																	else  WriteToFile( ",%0.1f,\n", DwellUnitTypeRef:IAQFanCnt[3]  )  endif  }
; IAQ Fan 4
	"Write IAQFanRef[4]"									DwellUnit:Action = {   if (DwellUnitTypeRef:IAQNumFanRefs < 3.5) then  UNCHANGED
								 																	else  WriteToFile( ",,,,,,,,,,,,,,%s", DwellUnitTypeRef:IAQFanRef[4] )  endif  }
	"Write IAQCFM[4]"										DwellUnit:Action = {   if (DwellUnitTypeRef:IAQNumFanRefs < 3.5) then  UNCHANGED
								 																	else  WriteToFile( ",%0.3f", DwellUnitTypeRef:IAQCFM[4]  )  endif  }
	"Write IAQ Fan 4 W/CFM"								DwellUnit:Action = {   if (DwellUnitTypeRef:IAQNumFanRefs < 3.5) then  UNCHANGED
		  																							else  WriteToFile( ",%0.3f", ValidOr( DwellUnitTypeRef:IAQFanRef[4]:WperCFMIAQ, 0 )  )  endif  }
	"Write IAQ Fan 4 Type"								DwellUnit:Action = {   if (DwellUnitTypeRef:IAQNumFanRefs < 3.5) then  UNCHANGED
		  																							else  WriteToFile( ",%s", DwellUnitTypeRef:IAQFanRef[4]:IAQFanTypeStr  )  endif  }
;	"Write IAQFanCnt[4]"									DwellUnit:Action = {   if (DwellUnitTypeRef:IAQNumFanRefs < 3.5) then  UNCHANGED
;								 																	else  WriteToFile( ",%0.1f,\n", DwellUnitTypeRef:IAQFanCnt[4]  )  endif  }

	"Write Total Unit IAQ Fan Air Flow"				DwellUnit:Action = {   if (DwellUnitTypeRef:IAQNumFanRefs < 0.5) then  UNCHANGED
								 																	else  WriteToFile( ",,,,,,,,,,,,,,Total Dwelling Unit IAQ Fan Air Flow,%0.3f,\n", DwellUnitTypeRef:TotalIAQCFM  )  endif  }

END

;*************************************************************************
RULELIST  "Zone_Data_Report" 0 0 0 1
;*************************************************************************

   "Write Name"			Zone:Action = {   WriteToFile( "\n,Zone Name,%c%s%c,\n", 34, Zone:Name, 34 )  }
   "Write Type"			Zone:Action = {   WriteToFile( ",Zone Type,%c%s%c,\n", 34, EnumString( Zone:Type ), 34 )  }
   "Write Status"			Zone:Action = {   WriteToFile( ",Zone Status,%c%s%c,\n", 34, EnumString( Zone:Status ), 34 )  }
   "Write FloorArea"		Zone:Action = {   WriteToFile( ",Zone Floor Area,%0.2f,ft2,\n", Zone:FloorArea )  }   
   "Write CeilingHeight"	Zone:Action = {   WriteToFile( ",Zone Ceiling Height,%0.2f,ft,\n", Zone:CeilingHeight )  }   
   "Write NumStoreis"		Zone:Action = {   WriteToFile( ",Zone Stories,%0.1f,\n", Zone:NumStories )  }   
   "Write Volume"		Zone:Action = {   WriteToFile( ",Zone Volume,%0.2f,ft3,\n", Zone:Volume )  }   
   "Write ExtWallArea"		Zone:Action = {   WriteToFile( ",Zone Exterior Wall Area,%0.3f,ft2,\n", Zone:ExtWallArea )  }   
   "Write ExtWallDoorArea"	Zone:Action = {   WriteToFile( ",Zone Exterior Wall Door Area,%0.3f,ft2,\n", Zone:ExtWallDoorArea )  }   
;   "Write AdjUncondZnWallArea"	Zone:Action = {   WriteToFile( ",Zone Adjacent UncondZone Wall Area,%0.3f,ft2,\n", Zone:AdjUncondZnWallArea )  }   
   "Write ClgBlwAtticArea"	Zone:Action = {   WriteToFile( ",Zone Ceiling Below Attic Area,%0.3f,ft2,\n", Zone:ClgBlwAtticArea )  }   
   "Write CathCeilingArea"	Zone:Action = {   WriteToFile( ",Zone Cathedral Ceiling Area,%0.3f,ft2,\n", Zone:CathCeilingArea )  }   
   "Write SlabFloorArea"	Zone:Action = {   WriteToFile( ",Zone Slab Floor Area,%0.3f,ft2,\n", Zone:SlabFloorArea )  }   
   "Write ExtFloorArea	"	Zone:Action = {   WriteToFile( ",Zone Exterior Floor Area,%0.3f,ft2,\n", Zone:ExtFloorArea )  }   
;   "Write FlrOverUncondZnArea"	Zone:Action = {   WriteToFile( ",Zone Floor Over Uncond Zone Area,%0.3f,ft2,\n", Zone:FlrOverUncondZnArea )  }   

;   "Write column headings for Ext Wall Data"	Zone:Action = {   WriteToFile( ",Wall and Window Area By Wall Type:, Type, Wall Area, Window Area,\n" )   }
;
;   "Write Wood Framed Wall Type"		Zone:Action = {   if ( Zone:ExtWallAreaByWallType[1] < 1 ) then  UNCHANGED
;  								  	else  WriteToFile(  ",,%c%s%c,",	34, "Wood Framed"  , 34   )  endif  }   
;   "Write ExtWallArea for Wood Framed"		Zone:Action = {   if ( Zone:ExtWallAreaByWallType[1] < 1 ) then  UNCHANGED
;  								  	else  WriteToFile( "%0.3f", Zone:ExtWallAreaByWallType[1]  )  endif  }
;   "Write ExtWallWinArea for Wood Framed"	Zone:Action = {   if ( Zone:ExtWallAreaByWallType[1] < 1 ) then  UNCHANGED
;  								  	else  WriteToFile( ",%0.3f,\n", Zone:ExtWallWinAreaByWallType[1]  )  endif  }
;   "Write Steel Framed Wall Type"		Zone:Action = {   if ( Zone:ExtWallAreaByWallType[2] < 1 ) then  UNCHANGED
;  								  	else  WriteToFile(  ",,%c%s%c,",	34, "Steel Framed"  , 34   )  endif  }   
;   "Write ExtWallArea for Steel Framed"		Zone:Action = {   if ( Zone:ExtWallAreaByWallType[2] < 1 ) then  UNCHANGED
;  								  	else  WriteToFile( "%0.3f", Zone:ExtWallAreaByWallType[2]  )  endif  }
;   "Write ExtWallWinArea for Steel Framed"	Zone:Action = {   if ( Zone:ExtWallAreaByWallType[2] < 1 ) then  UNCHANGED
;  								  	else  WriteToFile( ",%0.3f,\n", Zone:ExtWallWinAreaByWallType[2]  )  endif  }
;   "Write Concrete/CMU Wall Type"		Zone:Action = {   if ( Zone:ExtWallAreaByWallType[3] < 1 ) then  UNCHANGED
;  								  	else  WriteToFile(  ",,%c%s%c,",	34, "Concrete/CMU"  , 34   )  endif  }   
;   "Write ExtWallArea for Concrete/CMU"		Zone:Action = {   if ( Zone:ExtWallAreaByWallType[3] < 1 ) then  UNCHANGED
;  								  	else  WriteToFile( "%0.3f", Zone:ExtWallAreaByWallType[3]  )  endif  }
;   "Write ExtWallWinArea for Concrete/CMU"	Zone:Action = {   if ( Zone:ExtWallAreaByWallType[3] < 1 ) then  UNCHANGED
;  								  	else  WriteToFile( ",%0.3f,\n", Zone:ExtWallWinAreaByWallType[3]  )  endif  }
 
  "Write column headings for DHWSystem Data"	Zone:Action = {  if ( DHWSys1:FloorAreaServed > 0.5 .OR. AltDHWSys1:FloorAreaServed > 0.5 .OR. ExDHWSys1:FloorAreaServed > 0.5 ) then
									if ( Proj:IsMultiFamily > 0.5 ) then 
											WriteToFile( "\n,Water Heating System Data:, Status, Type, MF Dist. Type, Water Heaters:, Fuel, Tank, Volume (gal), Energy Factor, Input Rating,, Int. Insul. RValue, Ext. Insul. Rvalue, Standby Loss,Make & Model,Tank Location,Rated Flow,First Hour Rating,Recovery Efficiency, \n" ) 
								  		else 	WriteToFile( "\n,Water Heating System Data:, Status, Type, Water Heaters:, Fuel, Tank, Volume (gal), Energy Factor, Input Rating,, Int. Insul. RValue, Ext. Insul. Rvalue, Standby Loss,Make & Model,Tank Location,Rated Flow,First Hour Rating,Recovery Efficiency, \n" ) 	
										endif
									else UNCHANGED	endif	}
   "Write DHWSys1 Name"				Zone:Action = {   if ( IfValidAnd( DHWSys1:FloorAreaServed > 0.5 ) ) then 
																		WriteToFile( ",%c%s%c,", 34, DHWSys1:Name, 34 )
								  									else 
																		if ( IfValidAnd( AltDHWSys1:FloorAreaServed > 0.5 ) ) then 
																			WriteToFile( ",%c%s%c,", 34, AltDHWSys1:Name, 34 )
																		else	
																			if ( IfValidAnd( ExDHWSys1:FloorAreaServed > 0.5 ) ) then 
																				WriteToFile( ",%c%s%c,", 34, ExDHWSys1:Name, 34 )
																			else	UNCHANGED endif endif endif	}
								  																	  									
   "Write DHWSys1 Status"			Zone:Action = {   if ( IfValidAnd( DHWSys1:FloorAreaServed > 0.5 ) ) then 
																		WriteToFile( "%s,", EnumString(DHWSys1Status) )
								  									else 
																		if ( IfValidAnd( AltDHWSys1:FloorAreaServed > 0.5 ) ) then 
																			WriteToFile( "%s,", EnumString(DHWSys1Status) )
																		else	
																			if ( IfValidAnd( ExDHWSys1:FloorAreaServed > 0.5 ) ) then 
																				WriteToFile( "%s,", EnumString(DHWSys1Status) )
																			else	UNCHANGED endif endif endif	}
; mjb	1/13/14 removed one HERS distribution type for another - Non-Demand Control is out, Below Grade Pipes is in								  																	  									
   "Write DHWSys1 Type"				Zone:Action = {	if ( IfValidAnd( DHWSys1:FloorAreaServed > 0.5 ) ) then
                                                      WriteToFile( "%c%s%c,", 34, EnumString(    DHWSys1:SystemType ), 34 )
																	else if ( IfValidAnd( AltDHWSys1:FloorAreaServed > 0.5 ) ) then 
                                                      WriteToFile( "%c%s%c,", 34, EnumString( AltDHWSys1:SystemType ), 34 )
																	else if ( IfValidAnd( ExDHWSys1:FloorAreaServed > 0.5 ) ) then 
                                                      WriteToFile( "%c%s%c,", 34, EnumString(  ExDHWSys1:SystemType ), 34 )
																	else	UNCHANGED endif endif endif	}
                              ; SAC 2/15/18 - replaced following w/ above to avoid unnecessary maintenance whenever enum wording is changed (tic #983)
                              ;                     if ( IfValidAnd( DHWSys1:FloorAreaServed > 0.5 ) ) then
										;								switch (DHWSys1:SystemType)
										;									case  3840 :	WriteToFile( "Standard," )
										;									case  4096 :	WriteToFile( "Pipe Insulation - All Lines," )
										;									case  4352 :	WriteToFile( "Insulated and Protected Pipe Below Grade," )
										;									case  4608 :	WriteToFile( "Parallel Piping," )
										;									case  4992 :	WriteToFile( "Recirculation - Non-Demand Control," )
										;									case  5248 :	WriteToFile( "Recirculation - Demand Control Push Button," )
										;									case  5504 :	WriteToFile( "Recirculation - Demand Control Occupancy/Motion," )
										;									case  8392704 :	WriteToFile( "(HERS req'd) Pipe Insulation - All Lines," )
										;									case  8393216 :	WriteToFile( "(HERS req'd) Parallel Piping," )
										;									case  8392960 :	WriteToFile( "(HERS req'd) Insulated and Protected Pipe Below Grade," )
										;									case  8393856 :	WriteToFile( "(HERS req'd) Recirculation - Demand Control Push Button," )
										;									case  8394112 :	WriteToFile( "(HERS req'd) Recirculation - Demand Control Occupancy/Motion," )
										;									case  8394240 :	WriteToFile( "(HERS req'd) Point of Use," )
										;									case  8394496 :	WriteToFile( "(HERS req'd) Compact Distribution System," )
										;									default :	WriteToFile( "Standard," )
										;								endswitch
										;							else
										;								if ( IfValidAnd( AltDHWSys1:FloorAreaServed > 0.5 ) ) then 
										;									switch (AltDHWSys1:SystemType)
										;										case  3840 :	WriteToFile( "Standard," )
										;										case  4096 :	WriteToFile( "Pipe Insulation - All Lines," )
										;										case  4352 :	WriteToFile( "Insulated and Protected Pipe Below Grade," )
										;										case  4608 :	WriteToFile( "Parallel Piping," )
										;										case  4992 :	WriteToFile( "Recirculation - Non-Demand Control," )
										;										case  5248 :	WriteToFile( "Recirculation - Demand Control Push Button," )
										;										case  5504 :	WriteToFile( "Recirculation - Demand Control Occupancy/Motion," )
										;										case  8392704 :	WriteToFile( "(HERS req'd) Pipe Insulation - All Lines," )
										;										case  8393216 :	WriteToFile( "(HERS req'd) Parallel Piping," )
										;										case  8392960 :	WriteToFile( "(HERS req'd) Insulated and Protected Pipe Below Grade," )
										;										case  8393856 :	WriteToFile( "(HERS req'd) Recirculation - Demand Control Push Button," )
										;										case  8394112 :	WriteToFile( "(HERS req'd) Recirculation - Demand Control Occupancy/Motion," )
										;										case  8394240 :	WriteToFile( "(HERS req'd) Point of Use," )
										;										case  8394496 :	WriteToFile( "(HERS req'd) Compact Distribution System," )
										;										default :	WriteToFile( "Standard," )
										;									endswitch
										;								else
										;									if ( IfValidAnd( ExDHWSys1:FloorAreaServed > 0.5 ) ) then 
										;										switch (ExDHWSys1:SystemType)
										;											case  3840 :	WriteToFile( "Standard," )
										;											case  4096 :	WriteToFile( "Pipe Insulation - All Lines," )
										;											case  4352 :	WriteToFile( "Insulated and Protected Pipe Below Grade," )
										;											case  4608 :	WriteToFile( "Parallel Piping," )
										;											case  4992 :	WriteToFile( "Recirculation - Non-Demand Control," )
										;											case  5248 :	WriteToFile( "Recirculation - Demand Control Push Button," )
										;											case  5504 :	WriteToFile( "Recirculation - Demand Control Occupancy/Motion," )
										;											case  8392704 :	WriteToFile( "(HERS req'd) Pipe Insulation - All Lines," )
										;											case  8393216 :	WriteToFile( "(HERS req'd) Parallel Piping," )
										;											case  8392960 :	WriteToFile( "(HERS req'd) Insulated and Protected Pipe Below Grade," )
										;											case  8393856 :	WriteToFile( "(HERS req'd) Recirculation - Demand Control Push Button," )
										;											case  8394112 :	WriteToFile( "(HERS req'd) Recirculation - Demand Control Occupancy/Motion," )
										;											case  8394240 :	WriteToFile( "(HERS req'd) Point of Use," )
										;											case  8394496 :	WriteToFile( "(HERS req'd) Compact Distribution System," )
										;											default :	WriteToFile( "Standard," )
										;										endswitch
										;									else	UNCHANGED endif endif endif	}
											

   "Write DHWSys1 MFamDistType"			
   	Zone:Action = {   if ( IfValidAnd( DHWSys1:FloorAreaServed > 0.5 ) .AND. IfValidAnd( DHWSys1:MFamDistType > -0.5 ) .AND. Proj:IsMultiFamily > 0.5 ) then 
   								WriteToFile( "%c%s%c,", 34, EnumString( DHWSys1:MFamDistType ), 34 )
						;			switch (DHWSys1:MFamDistType)
						;				case  0 :	WriteToFile( "None," )
						;				case  5056 :	WriteToFile( "No Control," )
						;				case  6336 :	WriteToFile( "Demand Control (Standard Design for new construction)," )
						;				case  6592 :	WriteToFile( "Temperature modulation," )
						;				case  6848 :	WriteToFile( "Temperature modulation & monitoring," )
						;				case  8393664 :	WriteToFile( "No Control with HERS verification," )
						;				case  8394944 :	WriteToFile( "Demand Control with HERS verification," )
						;				case  8395200 :	WriteToFile( "Temperature modulation with HERS verification," )
						;				case  8395456 :	WriteToFile( "Temperature modulation & monitoring with HERS verification," )
						;				default :	WriteToFile( "None," )
						;			endswitch
								else if ( AltDHWSys1:FloorAreaServed > 0.5 .AND. AltDHWSys1:MFamDistType > -0.5 .AND. Proj:IsMultiFamily > 0.5 ) then
   								WriteToFile( "%c%s%c,", 34, EnumString( AltDHWSys1:MFamDistType ), 34 )
						;			switch (AltDHWSys1:MFamDistType)
						;				case  0 :	WriteToFile( "None," )
						;				case  5056 :	WriteToFile( "No Control," )
						;				case  6336 :	WriteToFile( "Demand Control (Standard Design for new construction)," )
						;				case  6592 :	WriteToFile( "Temperature modulation," )
						;				case  6848 :	WriteToFile( "Temperature modulation & monitoring," )
						;				case  8393664 :	WriteToFile( "No Control with HERS verification," )
						;				case  8394944 :	WriteToFile( "Demand Control with HERS verification," )
						;				case  8395200 :	WriteToFile( "Temperature modulation with HERS verification," )
						;				case  8395456 :	WriteToFile( "Temperature modulation & monitoring with HERS verification," )
						;				default :	WriteToFile( "None," )
						;			endswitch
								else if ( IfValidAnd( ExDHWSys1:FloorAreaServed > 0.5 ) .AND. IfValidAnd( ExDHWSys1:MFamDistType > -0.5 ) .AND. Proj:IsMultiFamily > 0.5 ) then
   								WriteToFile( "%c%s%c,", 34, EnumString( ExDHWSys1:MFamDistType ), 34 )
						;			switch (ExDHWSys1:MFamDistType)
						;				case  0 :	WriteToFile( "None," )
						;				case  5056 :	WriteToFile( "No Control," )
						;				case  6336 :	WriteToFile( "Demand Control (Standard Design for new construction)," )
						;				case  6592 :	WriteToFile( "Temperature modulation," )
						;				case  6848 :	WriteToFile( "Temperature modulation & monitoring," )
						;				case  8393664 :	WriteToFile( "No Control with HERS verification," )
						;				case  8394944 :	WriteToFile( "Demand Control with HERS verification," )
						;				case  8395200 :	WriteToFile( "Temperature modulation with HERS verification," )
						;				case  8395456 :	WriteToFile( "Temperature modulation & monitoring with HERS verification," )
						;				default :	WriteToFile( "None," )
						;			endswitch
								else UNCHANGED	endif	endif endif	}

   "Write DHWSys1 Water Heater 1"		Zone:Action = {   if ( IfValidAnd( DHWSys1:HeaterMultFlt[1] > 0.001 ) ) then
																				if ( Proj:IsMultiFamily > 0.5 ) then  
									  												WriteToFile( "%c%s%c,", 34, DHWSys1:DHWHeater[1]:Name , 34  )
																				else  WriteToFile( "%c%s%c,", 34, DHWSys1:DHWHeater[1]:Name , 34  )
																				endif
																			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[1] > 0.001 ) ) then 
																				if ( Proj:IsMultiFamily > 0.5 ) then  
									  												WriteToFile( "%c%s%c,", 34, AltDHWSys1:DHWHeater[1]:Name , 34  )
																				else  WriteToFile( "%c%s%c,", 34, AltDHWSys1:DHWHeater[1]:Name , 34  )
																				endif
																			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[1] > 0.001 ) ) then 
																				if ( Proj:IsMultiFamily > 0.5 ) then  
									  												WriteToFile( "%c%s%c,", 34, ExDHWSys1:DHWHeater[1]:Name , 34  )
																				else  WriteToFile( "%c%s%c,", 34, ExDHWSys1:DHWHeater[1]:Name , 34  )
																				endif
								  											else UNCHANGED	endif	endif endif	}

	; SAC 4/24/15 - added logic to many rules below to handle DHW reporting when DHWheater is actually an HVACSys (where HVACSys:CanBeDHWHtr = 1)
   ; SAC 7/6/17 - mods to properly report NEEA-rated HPWHs (tic #841)
    "Write DHWSys1 DHW1 Fuel Type"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[1] > 0.001 )  ) then  
   			if (LocalCompAssigned( DHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( DHWSys1:DHWHeater[1]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( DHWSys1:DHWHeater[1] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( DHWSys1:DHWHeater[1]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[1] > 0.001 ) ) then 
   			if (LocalCompAssigned( AltDHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( AltDHWSys1:DHWHeater[1]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( AltDHWSys1:DHWHeater[1] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( AltDHWSys1:DHWHeater[1]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[1] > 0.001 ) ) then 
   			if (LocalCompAssigned( ExDHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( ExDHWSys1:DHWHeater[1]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( ExDHWSys1:DHWHeater[1] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( ExDHWSys1:DHWHeater[1]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else UNCHANGED	endif	endif endif	}

   "Write DHWSys1 DHW1 Tank Type"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[1] > 0.001 )  ) then  
   			if (LocalCompAssigned( DHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( DHWSys1:DHWHeater[1]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( DHWSys1:DHWHeater[1]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( DHWSys1:DHWHeater[1] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( DHWSys1:DHWHeater[1]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[1] > 0.001 ) ) then 
   			if (LocalCompAssigned( AltDHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( AltDHWSys1:DHWHeater[1]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( AltDHWSys1:DHWHeater[1]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( AltDHWSys1:DHWHeater[1] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( AltDHWSys1:DHWHeater[1]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[1] > 0.001 ) ) then 
   			if (LocalCompAssigned( ExDHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( ExDHWSys1:DHWHeater[1]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( ExDHWSys1:DHWHeater[1]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( ExDHWSys1:DHWHeater[1] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( ExDHWSys1:DHWHeater[1]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else UNCHANGED	endif	endif endif	}

   "Write DHWSys1 DHW1 Tank Volume"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[1] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", DHWSys1:DHWHeater[1]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[1]:TankVolume  )
				      endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[1]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", AltDHWSys1:DHWHeater[1]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[1]:TankVolume  )
				      endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[1]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", ExDHWSys1:DHWHeater[1]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[1]:TankVolume  )
				      endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[1]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW1 Energy Factor"	Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[1] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[1]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[1]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[1]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[1]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[1]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[1]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   ; SAC 6/13/18 - updated InputRating property name to InputRatingSim to accommodate InputRating being ignored for most heater types (tic #940)
   "Write DHWSys1 DHW1 Input Rating"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[1] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( DHWSys1:DHWHeater[1]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[1]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[1]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( AltDHWSys1:DHWHeater[1]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[1]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[1]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( ExDHWSys1:DHWHeater[1]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[1]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[1]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW1 Input Rating units"	Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[1] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, DHWSys1:DHWHeater[1]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( DHWSys1:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, DHWSys1:DHWHeater[1]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, AltDHWSys1:DHWHeater[1]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, AltDHWSys1:DHWHeater[1]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, ExDHWSys1:DHWHeater[1]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, ExDHWSys1:DHWHeater[1]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW1 IntInsulRVal"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[1] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[1]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[1]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[1]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[1]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[1]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[1]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW1 ExtInsulRVal"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[1] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[1]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[1]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[1]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[1]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[1]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[1]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW1 Standby Loss Frac"	Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[1] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( DHWSys1:DHWHeater[1]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[1]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[1]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( AltDHWSys1:DHWHeater[1]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[1]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[1]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( ExDHWSys1:DHWHeater[1]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[1]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[1]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW1 HPWH Make & Model"	   Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[1] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( DHWSys1:DHWHeater[1]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( DHWSys1:DHWHeater[1]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( DHWSys1:DHWHeater[1]:HPWHBrand ),
				                                     EnumString( DHWSys1:DHWHeater[1]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( AltDHWSys1:DHWHeater[1]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( AltDHWSys1:DHWHeater[1]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( AltDHWSys1:DHWHeater[1]:HPWHBrand ),
				                                     EnumString( AltDHWSys1:DHWHeater[1]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( ExDHWSys1:DHWHeater[1]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( ExDHWSys1:DHWHeater[1]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( ExDHWSys1:DHWHeater[1]:HPWHBrand ),
				                                     EnumString( ExDHWSys1:DHWHeater[1]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW1 Tank Location"	   Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[1] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[1]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( DHWSys1:DHWHeater[1]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( DHWSys1:DHWHeater[1]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", DHWSys1:DHWHeater[1]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[1]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( AltDHWSys1:DHWHeater[1]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( AltDHWSys1:DHWHeater[1]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", AltDHWSys1:DHWHeater[1]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[1]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( ExDHWSys1:DHWHeater[1]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( ExDHWSys1:DHWHeater[1]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", ExDHWSys1:DHWHeater[1]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW1 Rated Flow"	   Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[1] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[1]:HeaterType = 10 ) .OR.
				          IfValidAnd( DHWSys1:DHWHeater[1]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", DHWSys1:DHWHeater[1]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[1]:HeaterType = 10 ) .OR.
				          IfValidAnd( AltDHWSys1:DHWHeater[1]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", AltDHWSys1:DHWHeater[1]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[1]:HeaterType = 10 ) .OR.
				          IfValidAnd( ExDHWSys1:DHWHeater[1]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", ExDHWSys1:DHWHeater[1]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW1 First Hour Rating & Recovery Efficiency"	   Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[1] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[1]:HeaterType = 12 ) .OR.
				          IfValidAnd( DHWSys1:DHWHeater[1]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( DHWSys1:DHWHeater[1]:FirstHourRating, -1 ),
				                                   ValidOr( DHWSys1:DHWHeater[1]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else 	WriteToFile( ",," )  endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[1]:HeaterType = 12 ) .OR.
				          IfValidAnd( AltDHWSys1:DHWHeater[1]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( AltDHWSys1:DHWHeater[1]:FirstHourRating, -1 ),
				                                   ValidOr( AltDHWSys1:DHWHeater[1]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else	WriteToFile( ",," )  endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[1]:HeaterType = 12 ) .OR.
				          IfValidAnd( ExDHWSys1:DHWHeater[1]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( ExDHWSys1:DHWHeater[1]:FirstHourRating, -1 ),
				                                   ValidOr( ExDHWSys1:DHWHeater[1]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else	WriteToFile( ",," )  endif
			else UNCHANGED endif endif endif }


   "Write DHWSys1 Water Heater 2"		Zone:Action = {   if ( IfValidAnd( DHWSys1:HeaterMultFlt[2] > 0.001 ) .AND. LocalCompAssigned( DHWSys1:DHWHeater[2] )) then
																				if ( Proj:IsMultiFamily > 0.5 ) then  
								  													   WriteToFile( "\n,,,,,%c%s%c,", 34, DHWSys1:DHWHeater[2]:Name , 34  )
																				else  WriteToFile(  "\n,,,,%c%s%c,", 34, DHWSys1:DHWHeater[2]:Name , 34  )
																				endif
																			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[2] > 0.001 ) .AND. LocalCompAssigned( AltDHWSys1:DHWHeater[2] )) then 
																				if ( Proj:IsMultiFamily > 0.5 ) then  
								  													   WriteToFile( "\n,,,,,%c%s%c,", 34, AltDHWSys1:DHWHeater[2]:Name , 34  )
																				else  WriteToFile(  "\n,,,,%c%s%c,", 34, AltDHWSys1:DHWHeater[2]:Name , 34  )
																				endif
																			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[2] > 0.001 ) .AND. LocalCompAssigned( ExDHWSys1:DHWHeater[2] )) then 
																				if ( Proj:IsMultiFamily > 0.5 ) then  
								  													   WriteToFile( "\n,,,,,%c%s%c,", 34, ExDHWSys1:DHWHeater[2]:Name , 34  )
																				else  WriteToFile(  "\n,,,,%c%s%c,", 34, ExDHWSys1:DHWHeater[2]:Name , 34  )
																				endif
								  											else UNCHANGED	endif	endif endif	}

    "Write DHWSys1 DHW2 Fuel Type"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[2] > 0.001 )  ) then  
   			if (LocalCompAssigned( DHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( DHWSys1:DHWHeater[2]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( DHWSys1:DHWHeater[2] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( DHWSys1:DHWHeater[2]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[2] > 0.001 ) ) then 
   			if (LocalCompAssigned( AltDHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( AltDHWSys1:DHWHeater[2]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( AltDHWSys1:DHWHeater[2] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( AltDHWSys1:DHWHeater[2]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[2] > 0.001 ) ) then 
   			if (LocalCompAssigned( ExDHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( ExDHWSys1:DHWHeater[2]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( ExDHWSys1:DHWHeater[2] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( ExDHWSys1:DHWHeater[2]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else UNCHANGED	endif	endif endif	}

   "Write DHWSys1 DHW2 Tank Type"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[2] > 0.001 )  ) then  
   			if (LocalCompAssigned( DHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( DHWSys1:DHWHeater[2]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( DHWSys1:DHWHeater[2]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( DHWSys1:DHWHeater[2] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( DHWSys1:DHWHeater[2]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[2] > 0.001 ) ) then 
   			if (LocalCompAssigned( AltDHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( AltDHWSys1:DHWHeater[2]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( AltDHWSys1:DHWHeater[2]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( AltDHWSys1:DHWHeater[2] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( AltDHWSys1:DHWHeater[2]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[2] > 0.001 ) ) then 
   			if (LocalCompAssigned( ExDHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( ExDHWSys1:DHWHeater[2]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( ExDHWSys1:DHWHeater[2]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( ExDHWSys1:DHWHeater[2] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( ExDHWSys1:DHWHeater[2]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else UNCHANGED	endif	endif endif	}

   "Write DHWSys1 DHW2 Tank Volume"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[2] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", DHWSys1:DHWHeater[2]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[2]:TankVolume  )
				      endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[2]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", AltDHWSys1:DHWHeater[2]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[2]:TankVolume  )
				      endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[2]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", ExDHWSys1:DHWHeater[2]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[2]:TankVolume  )
				      endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[2]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW2 Energy Factor"	Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[2] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[2]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[2]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[2]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[2]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[2]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[2]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW2 Input Rating"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[2] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( DHWSys1:DHWHeater[2]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[2]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[2]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( AltDHWSys1:DHWHeater[2]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[2]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[2]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( ExDHWSys1:DHWHeater[2]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[2]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[2]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW2 Input Rating units"	Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[2] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, DHWSys1:DHWHeater[2]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( DHWSys1:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, DHWSys1:DHWHeater[2]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, AltDHWSys1:DHWHeater[2]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, AltDHWSys1:DHWHeater[2]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, ExDHWSys1:DHWHeater[2]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, ExDHWSys1:DHWHeater[2]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW2 IntInsulRVal"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[2] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[2]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[2]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[2]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[2]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[2]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[2]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW2 ExtInsulRVal"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[2] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[2]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[2]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[2]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[2]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[2]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[2]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW2 Standby Loss Frac"	Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[2] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( DHWSys1:DHWHeater[2]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[2]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[2]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( AltDHWSys1:DHWHeater[2]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[2]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[2]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( ExDHWSys1:DHWHeater[2]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[2]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[2]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW2 HPWH Make & Model"	   Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[2] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( DHWSys1:DHWHeater[2]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( DHWSys1:DHWHeater[2]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( DHWSys1:DHWHeater[2]:HPWHBrand ),
				                                     EnumString( DHWSys1:DHWHeater[2]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( AltDHWSys1:DHWHeater[2]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( AltDHWSys1:DHWHeater[2]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( AltDHWSys1:DHWHeater[2]:HPWHBrand ),
				                                     EnumString( AltDHWSys1:DHWHeater[2]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( ExDHWSys1:DHWHeater[2]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( ExDHWSys1:DHWHeater[2]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( ExDHWSys1:DHWHeater[2]:HPWHBrand ),
				                                     EnumString( ExDHWSys1:DHWHeater[2]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW2 Tank Location"	   Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[2] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[2]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( DHWSys1:DHWHeater[2]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( DHWSys1:DHWHeater[2]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", DHWSys1:DHWHeater[2]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[2]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( AltDHWSys1:DHWHeater[2]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( AltDHWSys1:DHWHeater[2]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", AltDHWSys1:DHWHeater[2]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[2]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( ExDHWSys1:DHWHeater[2]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( ExDHWSys1:DHWHeater[2]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", ExDHWSys1:DHWHeater[2]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW2 Rated Flow"	   Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[2] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[2]:HeaterType = 10 ) .OR.
				          IfValidAnd( DHWSys1:DHWHeater[2]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", DHWSys1:DHWHeater[2]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[2]:HeaterType = 10 ) .OR.
				          IfValidAnd( AltDHWSys1:DHWHeater[2]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", AltDHWSys1:DHWHeater[2]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[2]:HeaterType = 10 ) .OR.
				          IfValidAnd( ExDHWSys1:DHWHeater[2]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", ExDHWSys1:DHWHeater[2]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW2 First Hour Rating & Recovery Efficiency"	   Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[2] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[2]:HeaterType = 12 ) .OR.
				          IfValidAnd( DHWSys1:DHWHeater[2]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( DHWSys1:DHWHeater[2]:FirstHourRating, -1 ),
				                                   ValidOr( DHWSys1:DHWHeater[2]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else 	WriteToFile( ",," )  endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[2]:HeaterType = 12 ) .OR.
				          IfValidAnd( AltDHWSys1:DHWHeater[2]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( AltDHWSys1:DHWHeater[2]:FirstHourRating, -1 ),
				                                   ValidOr( AltDHWSys1:DHWHeater[2]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else	WriteToFile( ",," )  endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[2]:HeaterType = 12 ) .OR.
				          IfValidAnd( ExDHWSys1:DHWHeater[2]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( ExDHWSys1:DHWHeater[2]:FirstHourRating, -1 ),
				                                   ValidOr( ExDHWSys1:DHWHeater[2]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else	WriteToFile( ",," )  endif
			else UNCHANGED endif endif endif }


   "Write DHWSys1 Water Heater 3"		Zone:Action = {   if ( IfValidAnd( DHWSys1:HeaterMultFlt[3] > 0.001 ) .AND. LocalCompAssigned( DHWSys1:DHWHeater[3] )) then
																				if ( Proj:IsMultiFamily > 0.5 ) then  
								  													WriteToFile( "\n,,,,,%c%s%c,", 34, DHWSys1:DHWHeater[3]:Name , 34  )
																				else  	WriteToFile( "\n,,,,%c%s%c,", 34, DHWSys1:DHWHeater[3]:Name , 34  )
																				endif
																			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[3] > 0.001 ) .AND. LocalCompAssigned( AltDHWSys1:DHWHeater[3] )) then 
																				if ( Proj:IsMultiFamily > 0.5 ) then  
								  													WriteToFile( "\n,,,,,%c%s%c,", 34, AltDHWSys1:DHWHeater[3]:Name , 34  )
																				else  	WriteToFile( "\n,,,,%c%s%c,", 34, AltDHWSys1:DHWHeater[3]:Name , 34  )
																				endif
																			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[3] > 0.001 ) .AND. LocalCompAssigned( ExDHWSys1:DHWHeater[3] )) then 
																				if ( Proj:IsMultiFamily > 0.5 ) then  
								  													WriteToFile( "\n,,,,,%c%s%c,", 34, ExDHWSys1:DHWHeater[3]:Name , 34  )
																				else  	WriteToFile( "\n,,,,%c%s%c,", 34, ExDHWSys1:DHWHeater[3]:Name , 34  )
																				endif
								  											else UNCHANGED	endif	endif endif	}

    "Write DHWSys1 DHW3 Fuel Type"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[3] > 0.001 )  ) then  
   			if (LocalCompAssigned( DHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( DHWSys1:DHWHeater[3]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( DHWSys1:DHWHeater[3] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( DHWSys1:DHWHeater[3]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[3] > 0.001 ) ) then 
   			if (LocalCompAssigned( AltDHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( AltDHWSys1:DHWHeater[3]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( AltDHWSys1:DHWHeater[3] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( AltDHWSys1:DHWHeater[3]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[3] > 0.001 ) ) then 
   			if (LocalCompAssigned( ExDHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( ExDHWSys1:DHWHeater[3]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( ExDHWSys1:DHWHeater[3] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( ExDHWSys1:DHWHeater[3]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else UNCHANGED	endif	endif endif	}

   "Write DHWSys1 DHW3 Tank Type"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[3] > 0.001 )  ) then  
   			if (LocalCompAssigned( DHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( DHWSys1:DHWHeater[3]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( DHWSys1:DHWHeater[3]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( DHWSys1:DHWHeater[3] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( DHWSys1:DHWHeater[3]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[3] > 0.001 ) ) then 
   			if (LocalCompAssigned( AltDHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( AltDHWSys1:DHWHeater[3]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( AltDHWSys1:DHWHeater[3]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( AltDHWSys1:DHWHeater[3] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( AltDHWSys1:DHWHeater[3]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[3] > 0.001 ) ) then 
   			if (LocalCompAssigned( ExDHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( ExDHWSys1:DHWHeater[3]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( ExDHWSys1:DHWHeater[3]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( ExDHWSys1:DHWHeater[3] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( ExDHWSys1:DHWHeater[3]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else UNCHANGED	endif	endif endif	}

   "Write DHWSys1 DHW3 Tank Volume"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[3] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", DHWSys1:DHWHeater[3]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[3]:TankVolume  )
				      endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[3]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", AltDHWSys1:DHWHeater[3]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[3]:TankVolume  )
				      endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[3]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", ExDHWSys1:DHWHeater[3]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[3]:TankVolume  )
				      endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[3]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW3 Energy Factor"	Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[3] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[3]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[3]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[3]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[3]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[3]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[3]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW3 Input Rating"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[3] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( DHWSys1:DHWHeater[3]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[3]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[3]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( AltDHWSys1:DHWHeater[3]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[3]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[3]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( ExDHWSys1:DHWHeater[3]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[3]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[3]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW3 Input Rating units"	Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[3] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, DHWSys1:DHWHeater[3]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( DHWSys1:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, DHWSys1:DHWHeater[3]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, AltDHWSys1:DHWHeater[3]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, AltDHWSys1:DHWHeater[3]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, ExDHWSys1:DHWHeater[3]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, ExDHWSys1:DHWHeater[3]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW3 IntInsulRVal"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[3] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[3]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[3]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[3]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[3]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[3]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[3]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW3 ExtInsulRVal"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[3] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[3]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[3]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[3]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[3]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[3]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[3]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW3 Standby Loss Frac"	Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[3] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( DHWSys1:DHWHeater[3]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[3]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[3]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( AltDHWSys1:DHWHeater[3]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[3]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[3]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( ExDHWSys1:DHWHeater[3]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[3]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[3]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW3 HPWH Make & Model"	   Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[3] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( DHWSys1:DHWHeater[3]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( DHWSys1:DHWHeater[3]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( DHWSys1:DHWHeater[3]:HPWHBrand ),
				                                     EnumString( DHWSys1:DHWHeater[3]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( AltDHWSys1:DHWHeater[3]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( AltDHWSys1:DHWHeater[3]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( AltDHWSys1:DHWHeater[3]:HPWHBrand ),
				                                     EnumString( AltDHWSys1:DHWHeater[3]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( ExDHWSys1:DHWHeater[3]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( ExDHWSys1:DHWHeater[3]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( ExDHWSys1:DHWHeater[3]:HPWHBrand ),
				                                     EnumString( ExDHWSys1:DHWHeater[3]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW3 Tank Location"	   Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[3] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[3]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( DHWSys1:DHWHeater[3]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( DHWSys1:DHWHeater[3]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", DHWSys1:DHWHeater[3]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[3]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( AltDHWSys1:DHWHeater[3]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( AltDHWSys1:DHWHeater[3]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", AltDHWSys1:DHWHeater[3]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[3]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( ExDHWSys1:DHWHeater[3]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( ExDHWSys1:DHWHeater[3]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", ExDHWSys1:DHWHeater[3]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW3 Rated Flow"	   Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[3] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[3]:HeaterType = 10 ) .OR.
				          IfValidAnd( DHWSys1:DHWHeater[3]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", DHWSys1:DHWHeater[3]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[3]:HeaterType = 10 ) .OR.
				          IfValidAnd( AltDHWSys1:DHWHeater[3]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", AltDHWSys1:DHWHeater[3]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[3]:HeaterType = 10 ) .OR.
				          IfValidAnd( ExDHWSys1:DHWHeater[3]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", ExDHWSys1:DHWHeater[3]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW3 First Hour Rating & Recovery Efficiency"	   Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[3] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[3]:HeaterType = 12 ) .OR.
				          IfValidAnd( DHWSys1:DHWHeater[3]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( DHWSys1:DHWHeater[3]:FirstHourRating, -1 ),
				                                   ValidOr( DHWSys1:DHWHeater[3]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else 	WriteToFile( ",," )  endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[3]:HeaterType = 12 ) .OR.
				          IfValidAnd( AltDHWSys1:DHWHeater[3]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( AltDHWSys1:DHWHeater[3]:FirstHourRating, -1 ),
				                                   ValidOr( AltDHWSys1:DHWHeater[3]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else	WriteToFile( ",," )  endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[3]:HeaterType = 12 ) .OR.
				          IfValidAnd( ExDHWSys1:DHWHeater[3]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( ExDHWSys1:DHWHeater[3]:FirstHourRating, -1 ),
				                                   ValidOr( ExDHWSys1:DHWHeater[3]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else	WriteToFile( ",," )  endif
			else UNCHANGED endif endif endif }


   "Write DHWSys1 Water Heater 4"		Zone:Action = {   if ( IfValidAnd( DHWSys1:HeaterMultFlt[4] > 0.001 ) .AND. LocalCompAssigned( DHWSys1:DHWHeater[4] )) then
																				if ( Proj:IsMultiFamily > 0.5 ) then  
								  													WriteToFile( "\n,,,,,%c%s%c,", 34, DHWSys1:DHWHeater[4]:Name , 34  )
																				else  	WriteToFile( "\n,,,,%c%s%c,", 34, DHWSys1:DHWHeater[4]:Name , 34  )
																				endif
																			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[4] > 0.001 ) .AND. LocalCompAssigned( AltDHWSys1:DHWHeater[4] )) then 
																				if ( Proj:IsMultiFamily > 0.5 ) then  
								  													WriteToFile( "\n,,,,,%c%s%c,", 34, AltDHWSys1:DHWHeater[4]:Name , 34  )
																				else  	WriteToFile( "\n,,,,%c%s%c,", 34, AltDHWSys1:DHWHeater[4]:Name , 34  )
																				endif
																			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[4] > 0.001 ) .AND. LocalCompAssigned( ExDHWSys1:DHWHeater[4] )) then 
																				if ( Proj:IsMultiFamily > 0.5 ) then  
								  													WriteToFile( "\n,,,,,%c%s%c,", 34, ExDHWSys1:DHWHeater[4]:Name , 34  )
																				else  	WriteToFile( "\n,,,,%c%s%c,", 34, ExDHWSys1:DHWHeater[4]:Name , 34  )
																				endif
								  											else UNCHANGED	endif	endif endif	}

    "Write DHWSys1 DHW4 Fuel Type"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[4] > 0.001 )  ) then  
   			if (LocalCompAssigned( DHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( DHWSys1:DHWHeater[4]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( DHWSys1:DHWHeater[4] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( DHWSys1:DHWHeater[4]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[4] > 0.001 ) ) then 
   			if (LocalCompAssigned( AltDHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( AltDHWSys1:DHWHeater[4]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( AltDHWSys1:DHWHeater[4] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( AltDHWSys1:DHWHeater[4]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[4] > 0.001 ) ) then 
   			if (LocalCompAssigned( ExDHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( ExDHWSys1:DHWHeater[4]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( ExDHWSys1:DHWHeater[4] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( ExDHWSys1:DHWHeater[4]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else UNCHANGED	endif	endif endif	}

   "Write DHWSys1 DHW4 Tank Type"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[4] > 0.001 )  ) then  
   			if (LocalCompAssigned( DHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( DHWSys1:DHWHeater[4]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( DHWSys1:DHWHeater[4]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( DHWSys1:DHWHeater[4] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( DHWSys1:DHWHeater[4]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[4] > 0.001 ) ) then 
   			if (LocalCompAssigned( AltDHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( AltDHWSys1:DHWHeater[4]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( AltDHWSys1:DHWHeater[4]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( AltDHWSys1:DHWHeater[4] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( AltDHWSys1:DHWHeater[4]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[4] > 0.001 ) ) then 
   			if (LocalCompAssigned( ExDHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( ExDHWSys1:DHWHeater[4]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( ExDHWSys1:DHWHeater[4]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( ExDHWSys1:DHWHeater[4] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( ExDHWSys1:DHWHeater[4]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else UNCHANGED	endif	endif endif	}

   "Write DHWSys1 DHW4 Tank Volume"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[4] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", DHWSys1:DHWHeater[4]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[4]:TankVolume  )
				      endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[4]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", AltDHWSys1:DHWHeater[4]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[4]:TankVolume  )
				      endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[4]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", ExDHWSys1:DHWHeater[4]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[4]:TankVolume  )
				      endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[4]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW4 Energy Factor"	Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[4] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[4]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[4]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[4]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[4]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[4]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[4]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW4 Input Rating"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[4] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( DHWSys1:DHWHeater[4]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[4]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[4]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( AltDHWSys1:DHWHeater[4]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[4]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[4]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( ExDHWSys1:DHWHeater[4]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[4]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[4]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW4 Input Rating units"	Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[4] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, DHWSys1:DHWHeater[4]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( DHWSys1:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, DHWSys1:DHWHeater[4]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, AltDHWSys1:DHWHeater[4]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, AltDHWSys1:DHWHeater[4]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, ExDHWSys1:DHWHeater[4]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, ExDHWSys1:DHWHeater[4]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW4 IntInsulRVal"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[4] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[4]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[4]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[4]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[4]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[4]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[4]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW4 ExtInsulRVal"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[4] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[4]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[4]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[4]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[4]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[4]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[4]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW4 Standby Loss Frac"	Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[4] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( DHWSys1:DHWHeater[4]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[4]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[4]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( AltDHWSys1:DHWHeater[4]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[4]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[4]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( ExDHWSys1:DHWHeater[4]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[4]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[4]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW4 HPWH Make & Model"	   Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[4] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( DHWSys1:DHWHeater[4]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( DHWSys1:DHWHeater[4]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( DHWSys1:DHWHeater[4]:HPWHBrand ),
				                                     EnumString( DHWSys1:DHWHeater[4]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( AltDHWSys1:DHWHeater[4]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( AltDHWSys1:DHWHeater[4]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( AltDHWSys1:DHWHeater[4]:HPWHBrand ),
				                                     EnumString( AltDHWSys1:DHWHeater[4]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( ExDHWSys1:DHWHeater[4]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( ExDHWSys1:DHWHeater[4]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( ExDHWSys1:DHWHeater[4]:HPWHBrand ),
				                                     EnumString( ExDHWSys1:DHWHeater[4]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW4 Tank Location"	   Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[4] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[4]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( DHWSys1:DHWHeater[4]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( DHWSys1:DHWHeater[4]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", DHWSys1:DHWHeater[4]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[4]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( AltDHWSys1:DHWHeater[4]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( AltDHWSys1:DHWHeater[4]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", AltDHWSys1:DHWHeater[4]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[4]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( ExDHWSys1:DHWHeater[4]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( ExDHWSys1:DHWHeater[4]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", ExDHWSys1:DHWHeater[4]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW4 Rated Flow"	   Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[4] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[4]:HeaterType = 10 ) .OR.
				          IfValidAnd( DHWSys1:DHWHeater[4]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", DHWSys1:DHWHeater[4]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[4]:HeaterType = 10 ) .OR.
				          IfValidAnd( AltDHWSys1:DHWHeater[4]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", AltDHWSys1:DHWHeater[4]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[4]:HeaterType = 10 ) .OR.
				          IfValidAnd( ExDHWSys1:DHWHeater[4]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", ExDHWSys1:DHWHeater[4]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW4 First Hour Rating & Recovery Efficiency"	   Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[4] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[4]:HeaterType = 12 ) .OR.
				          IfValidAnd( DHWSys1:DHWHeater[4]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( DHWSys1:DHWHeater[4]:FirstHourRating, -1 ),
				                                   ValidOr( DHWSys1:DHWHeater[4]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else 	WriteToFile( ",," )  endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[4]:HeaterType = 12 ) .OR.
				          IfValidAnd( AltDHWSys1:DHWHeater[4]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( AltDHWSys1:DHWHeater[4]:FirstHourRating, -1 ),
				                                   ValidOr( AltDHWSys1:DHWHeater[4]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else	WriteToFile( ",," )  endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[4]:HeaterType = 12 ) .OR.
				          IfValidAnd( ExDHWSys1:DHWHeater[4]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( ExDHWSys1:DHWHeater[4]:FirstHourRating, -1 ),
				                                   ValidOr( ExDHWSys1:DHWHeater[4]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else	WriteToFile( ",," )  endif
			else UNCHANGED endif endif endif }


   "Write DHWSys1 Water Heater 5"		Zone:Action = {   if ( IfValidAnd( DHWSys1:HeaterMultFlt[5] > 0.001 ) .AND. LocalCompAssigned( DHWSys1:DHWHeater[5] )) then
																				if ( Proj:IsMultiFamily > 0.5 ) then  
								  													WriteToFile( "\n,,,,,%c%s%c,", 34, DHWSys1:DHWHeater[5]:Name , 34  )
																				else  	WriteToFile( "\n,,,,%c%s%c,", 34, DHWSys1:DHWHeater[5]:Name , 34  )
																				endif
																			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[5] > 0.001 ) .AND. LocalCompAssigned( AltDHWSys1:DHWHeater[5] )) then 
																				if ( Proj:IsMultiFamily > 0.5 ) then  
								  													WriteToFile( "\n,,,,,%c%s%c,", 34, AltDHWSys1:DHWHeater[5]:Name , 34  )
																				else  	WriteToFile( "\n,,,,%c%s%c,", 34, AltDHWSys1:DHWHeater[5]:Name , 34  )
																				endif
																			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[5] > 0.001 ) .AND. LocalCompAssigned( ExDHWSys1:DHWHeater[5] )) then 
																				if ( Proj:IsMultiFamily > 0.5 ) then  
								  													WriteToFile( "\n,,,,,%c%s%c,", 34, ExDHWSys1:DHWHeater[5]:Name , 34  )
																				else  	WriteToFile( "\n,,,,%c%s%c,", 34, ExDHWSys1:DHWHeater[5]:Name , 34  )
																				endif
								  											else UNCHANGED	endif	endif endif	}

    "Write DHWSys1 DHW5 Fuel Type"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[5] > 0.001 )  ) then  
   			if (LocalCompAssigned( DHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( DHWSys1:DHWHeater[5]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( DHWSys1:DHWHeater[5] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( DHWSys1:DHWHeater[5]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[5] > 0.001 ) ) then 
   			if (LocalCompAssigned( AltDHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( AltDHWSys1:DHWHeater[5]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( AltDHWSys1:DHWHeater[5] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( AltDHWSys1:DHWHeater[5]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[5] > 0.001 ) ) then 
   			if (LocalCompAssigned( ExDHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( ExDHWSys1:DHWHeater[5]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( ExDHWSys1:DHWHeater[5] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( ExDHWSys1:DHWHeater[5]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else UNCHANGED	endif	endif endif	}

   "Write DHWSys1 DHW5 Tank Type"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[5] > 0.001 )  ) then  
   			if (LocalCompAssigned( DHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( DHWSys1:DHWHeater[5]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( DHWSys1:DHWHeater[5]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( DHWSys1:DHWHeater[5] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( DHWSys1:DHWHeater[5]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[5] > 0.001 ) ) then 
   			if (LocalCompAssigned( AltDHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( AltDHWSys1:DHWHeater[5]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( AltDHWSys1:DHWHeater[5]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( AltDHWSys1:DHWHeater[5] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( AltDHWSys1:DHWHeater[5]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[5] > 0.001 ) ) then 
   			if (LocalCompAssigned( ExDHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( ExDHWSys1:DHWHeater[5]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( ExDHWSys1:DHWHeater[5]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( ExDHWSys1:DHWHeater[5] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( ExDHWSys1:DHWHeater[5]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else UNCHANGED	endif	endif endif	}

   "Write DHWSys1 DHW5 Tank Volume"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[5] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", DHWSys1:DHWHeater[5]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[5]:TankVolume  )
				      endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[5]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", AltDHWSys1:DHWHeater[5]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[5]:TankVolume  )
				      endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[5]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", ExDHWSys1:DHWHeater[5]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[5]:TankVolume  )
				      endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[5]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW5 Energy Factor"	Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[5] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[5]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[5]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[5]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[5]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[5]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[5]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW5 Input Rating"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[5] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( DHWSys1:DHWHeater[5]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[5]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[5]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( AltDHWSys1:DHWHeater[5]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[5]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[5]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( ExDHWSys1:DHWHeater[5]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[5]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[5]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW5 Input Rating units"	Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[5] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, DHWSys1:DHWHeater[5]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( DHWSys1:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, DHWSys1:DHWHeater[5]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, AltDHWSys1:DHWHeater[5]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, AltDHWSys1:DHWHeater[5]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, ExDHWSys1:DHWHeater[5]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, ExDHWSys1:DHWHeater[5]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW5 IntInsulRVal"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[5] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[5]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[5]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[5]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[5]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[5]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[5]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW5 ExtInsulRVal"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[5] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[5]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[5]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[5]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[5]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[5]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[5]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW5 Standby Loss Frac"	Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[5] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( DHWSys1:DHWHeater[5]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[5]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[5]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( AltDHWSys1:DHWHeater[5]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[5]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[5]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( ExDHWSys1:DHWHeater[5]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[5]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[5]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW5 HPWH Make & Model"	   Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[5] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( DHWSys1:DHWHeater[5]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( DHWSys1:DHWHeater[5]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( DHWSys1:DHWHeater[5]:HPWHBrand ),
				                                     EnumString( DHWSys1:DHWHeater[5]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( AltDHWSys1:DHWHeater[5]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( AltDHWSys1:DHWHeater[5]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( AltDHWSys1:DHWHeater[5]:HPWHBrand ),
				                                     EnumString( AltDHWSys1:DHWHeater[5]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( ExDHWSys1:DHWHeater[5]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( ExDHWSys1:DHWHeater[5]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( ExDHWSys1:DHWHeater[5]:HPWHBrand ),
				                                     EnumString( ExDHWSys1:DHWHeater[5]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW5 Tank Location"	   Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[5] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[5]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( DHWSys1:DHWHeater[5]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( DHWSys1:DHWHeater[5]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", DHWSys1:DHWHeater[5]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[5]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( AltDHWSys1:DHWHeater[5]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( AltDHWSys1:DHWHeater[5]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", AltDHWSys1:DHWHeater[5]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[5]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( ExDHWSys1:DHWHeater[5]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( ExDHWSys1:DHWHeater[5]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", ExDHWSys1:DHWHeater[5]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW5 Rated Flow"	   Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[5] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[5]:HeaterType = 10 ) .OR.
				          IfValidAnd( DHWSys1:DHWHeater[5]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", DHWSys1:DHWHeater[5]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[5]:HeaterType = 10 ) .OR.
				          IfValidAnd( AltDHWSys1:DHWHeater[5]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", AltDHWSys1:DHWHeater[5]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[5]:HeaterType = 10 ) .OR.
				          IfValidAnd( ExDHWSys1:DHWHeater[5]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", ExDHWSys1:DHWHeater[5]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW5 First Hour Rating & Recovery Efficiency"	   Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[5] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[5]:HeaterType = 12 ) .OR.
				          IfValidAnd( DHWSys1:DHWHeater[5]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( DHWSys1:DHWHeater[5]:FirstHourRating, -1 ),
				                                   ValidOr( DHWSys1:DHWHeater[5]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else 	WriteToFile( ",," )  endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[5]:HeaterType = 12 ) .OR.
				          IfValidAnd( AltDHWSys1:DHWHeater[5]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( AltDHWSys1:DHWHeater[5]:FirstHourRating, -1 ),
				                                   ValidOr( AltDHWSys1:DHWHeater[5]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else	WriteToFile( ",," )  endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[5]:HeaterType = 12 ) .OR.
				          IfValidAnd( ExDHWSys1:DHWHeater[5]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( ExDHWSys1:DHWHeater[5]:FirstHourRating, -1 ),
				                                   ValidOr( ExDHWSys1:DHWHeater[5]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else	WriteToFile( ",," )  endif
			else UNCHANGED endif endif endif }


   "Write DHWSys1 Water Heater 6"		Zone:Action = {   if ( IfValidAnd( DHWSys1:HeaterMultFlt[6] > 0.001 ) .AND. LocalCompAssigned( DHWSys1:DHWHeater[6] )) then
																				if ( Proj:IsMultiFamily > 0.5 ) then  
								  													WriteToFile( "\n,,,,,%c%s%c,", 34, DHWSys1:DHWHeater[6]:Name , 34  )
																				else  	WriteToFile( "\n,,,,%c%s%c,", 34, DHWSys1:DHWHeater[6]:Name , 34  )
																				endif
																			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[6] > 0.001 ) .AND. LocalCompAssigned( AltDHWSys1:DHWHeater[6] )) then 
																				if ( Proj:IsMultiFamily > 0.5 ) then  
								  													WriteToFile( "\n,,,,,%c%s%c,", 34, AltDHWSys1:DHWHeater[6]:Name , 34  )
																				else  	WriteToFile( "\n,,,,%c%s%c,", 34, AltDHWSys1:DHWHeater[6]:Name , 34  )
																				endif
																			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[6] > 0.001 ) .AND. LocalCompAssigned( ExDHWSys1:DHWHeater[6] )) then 
																				if ( Proj:IsMultiFamily > 0.5 ) then  
								  													WriteToFile( "\n,,,,,%c%s%c,", 34, ExDHWSys1:DHWHeater[6]:Name , 34  )
																				else  	WriteToFile( "\n,,,,%c%s%c,", 34, ExDHWSys1:DHWHeater[6]:Name , 34  )
																				endif
								  											else UNCHANGED	endif	endif endif	}

    "Write DHWSys1 DHW6 Fuel Type"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[6] > 0.001 )  ) then  
   			if (LocalCompAssigned( DHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( DHWSys1:DHWHeater[6]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( DHWSys1:DHWHeater[6] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( DHWSys1:DHWHeater[6]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[6] > 0.001 ) ) then 
   			if (LocalCompAssigned( AltDHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( AltDHWSys1:DHWHeater[6]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( AltDHWSys1:DHWHeater[6] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( AltDHWSys1:DHWHeater[6]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[6] > 0.001 ) ) then 
   			if (LocalCompAssigned( ExDHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( ExDHWSys1:DHWHeater[6]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( ExDHWSys1:DHWHeater[6] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( ExDHWSys1:DHWHeater[6]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else UNCHANGED	endif	endif endif	}

   "Write DHWSys1 DHW6 Tank Type"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[6] > 0.001 )  ) then  
   			if (LocalCompAssigned( DHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( DHWSys1:DHWHeater[6]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( DHWSys1:DHWHeater[6]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( DHWSys1:DHWHeater[6] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( DHWSys1:DHWHeater[6]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[6] > 0.001 ) ) then 
   			if (LocalCompAssigned( AltDHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( AltDHWSys1:DHWHeater[6]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( AltDHWSys1:DHWHeater[6]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( AltDHWSys1:DHWHeater[6] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( AltDHWSys1:DHWHeater[6]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[6] > 0.001 ) ) then 
   			if (LocalCompAssigned( ExDHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( ExDHWSys1:DHWHeater[6]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( ExDHWSys1:DHWHeater[6]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( ExDHWSys1:DHWHeater[6] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( ExDHWSys1:DHWHeater[6]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else UNCHANGED	endif	endif endif	}

   "Write DHWSys1 DHW6 Tank Volume"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[6] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", DHWSys1:DHWHeater[6]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[6]:TankVolume  )
				      endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[6]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", AltDHWSys1:DHWHeater[6]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[6]:TankVolume  )
				      endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[6]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", ExDHWSys1:DHWHeater[6]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[6]:TankVolume  )
				      endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[6]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW6 Energy Factor"	Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[6] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[6]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[6]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[6]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[6]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[6]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[6]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW6 Input Rating"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[6] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( DHWSys1:DHWHeater[6]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[6]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[6]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( AltDHWSys1:DHWHeater[6]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[6]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[6]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( ExDHWSys1:DHWHeater[6]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[6]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[6]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW6 Input Rating units"	Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[6] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, DHWSys1:DHWHeater[6]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( DHWSys1:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, DHWSys1:DHWHeater[6]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, AltDHWSys1:DHWHeater[6]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, AltDHWSys1:DHWHeater[6]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, ExDHWSys1:DHWHeater[6]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, ExDHWSys1:DHWHeater[6]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW6 IntInsulRVal"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[6] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[6]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[6]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[6]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[6]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[6]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[6]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW6 ExtInsulRVal"		Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[6] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[6]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[6]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[6]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[6]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[6]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[6]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW6 Standby Loss Frac"	Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[6] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( DHWSys1:DHWHeater[6]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", DHWSys1:DHWHeater[6]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( DHWSys1:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys1:DHWHeater[6]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( AltDHWSys1:DHWHeater[6]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[6]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( AltDHWSys1:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys1:DHWHeater[6]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( ExDHWSys1:DHWHeater[6]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[6]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( ExDHWSys1:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys1:DHWHeater[6]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW6 HPWH Make & Model"	   Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[6] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( DHWSys1:DHWHeater[6]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( DHWSys1:DHWHeater[6]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( DHWSys1:DHWHeater[6]:HPWHBrand ),
				                                     EnumString( DHWSys1:DHWHeater[6]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( AltDHWSys1:DHWHeater[6]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( AltDHWSys1:DHWHeater[6]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( AltDHWSys1:DHWHeater[6]:HPWHBrand ),
				                                     EnumString( AltDHWSys1:DHWHeater[6]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( ExDHWSys1:DHWHeater[6]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( ExDHWSys1:DHWHeater[6]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( ExDHWSys1:DHWHeater[6]:HPWHBrand ),
				                                     EnumString( ExDHWSys1:DHWHeater[6]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW6 Tank Location"	   Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[6] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[6]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( DHWSys1:DHWHeater[6]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( DHWSys1:DHWHeater[6]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", DHWSys1:DHWHeater[6]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[6]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( AltDHWSys1:DHWHeater[6]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( AltDHWSys1:DHWHeater[6]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", AltDHWSys1:DHWHeater[6]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[6]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( ExDHWSys1:DHWHeater[6]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( ExDHWSys1:DHWHeater[6]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", ExDHWSys1:DHWHeater[6]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW6 Rated Flow"	   Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[6] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[6]:HeaterType = 10 ) .OR.
				          IfValidAnd( DHWSys1:DHWHeater[6]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", DHWSys1:DHWHeater[6]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[6]:HeaterType = 10 ) .OR.
				          IfValidAnd( AltDHWSys1:DHWHeater[6]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", AltDHWSys1:DHWHeater[6]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[6]:HeaterType = 10 ) .OR.
				          IfValidAnd( ExDHWSys1:DHWHeater[6]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", ExDHWSys1:DHWHeater[6]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys1 DHW6 First Hour Rating & Recovery Efficiency"	   Zone:Action = {
         if ( IfValidAnd( DHWSys1:HeaterMultFlt[6] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys1:DHWHeater[6]:HeaterType = 12 ) .OR.
				          IfValidAnd( DHWSys1:DHWHeater[6]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( DHWSys1:DHWHeater[6]:FirstHourRating, -1 ),
				                                   ValidOr( DHWSys1:DHWHeater[6]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else 	WriteToFile( ",," )  endif
			else if ( IfValidAnd( AltDHWSys1:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys1:DHWHeater[6]:HeaterType = 12 ) .OR.
				          IfValidAnd( AltDHWSys1:DHWHeater[6]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( AltDHWSys1:DHWHeater[6]:FirstHourRating, -1 ),
				                                   ValidOr( AltDHWSys1:DHWHeater[6]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else	WriteToFile( ",," )  endif
			else if ( IfValidAnd( ExDHWSys1:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys1:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys1:DHWHeater[6]:HeaterType = 12 ) .OR.
				          IfValidAnd( ExDHWSys1:DHWHeater[6]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( ExDHWSys1:DHWHeater[6]:FirstHourRating, -1 ),
				                                   ValidOr( ExDHWSys1:DHWHeater[6]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else	WriteToFile( ",," )  endif
			else UNCHANGED endif endif endif }



   "Write DHWSys2 Name"				Zone:Action = {   if ( IfValidAnd( DHWSys2:FloorAreaServed > 0.5 )) then 
																		WriteToFile( "\n,%c%s%c,", 34, DHWSys2:Name, 34 )
								  									else 
																		if ( IfValidAnd( AltDHWSys2:FloorAreaServed > 0.5 )) then 
																			WriteToFile( "\n,%c%s%c,", 34, AltDHWSys2:Name, 34 )
																		else	
																			if ( IfValidAnd( ExDHWSys2:FloorAreaServed > 0.5 )) then 
																				WriteToFile( "\n,%c%s%c,", 34, ExDHWSys2:Name, 34 )
																			else	UNCHANGED endif endif endif	}
								  																	  									
   "Write DHWSys2 Status"			Zone:Action = {   if ( IfValidAnd( DHWSys2:FloorAreaServed > 0.5 )) then 
																		WriteToFile( "%s,", EnumString(DHWSys2Status) )
								  									else 
																		if ( IfValidAnd( AltDHWSys2:FloorAreaServed > 0.5 )) then 
																			WriteToFile( "%s,", EnumString(DHWSys2Status) )
																		else	
																			if ( IfValidAnd( ExDHWSys2:FloorAreaServed > 0.5 )) then 
																				WriteToFile( "%s,", EnumString(DHWSys2Status) )
																			else	UNCHANGED endif endif endif	}

; mjb	1/13/14 removed one HERS distribution type for another - Non-Demand Control is out, Below Grade Pipes is in								  																	  																	  																	  									
   "Write DHWSys2 Type"				Zone:Action = {	if ( IfValidAnd( DHWSys2:FloorAreaServed > 0.5 ) ) then
                                                      WriteToFile( "%c%s%c,", 34, EnumString(    DHWSys2:SystemType ), 34 )
																	else if ( IfValidAnd( AltDHWSys2:FloorAreaServed > 0.5 ) ) then 
                                                      WriteToFile( "%c%s%c,", 34, EnumString( AltDHWSys2:SystemType ), 34 )
																	else if ( IfValidAnd( ExDHWSys2:FloorAreaServed > 0.5 ) ) then 
                                                      WriteToFile( "%c%s%c,", 34, EnumString(  ExDHWSys2:SystemType ), 34 )
																	else	UNCHANGED endif endif endif	}
                              ; SAC 2/15/18 - replaced following w/ above to avoid unnecessary maintenance whenever enum wording is changed (tic #983)
										;							if ( IfValidAnd( DHWSys2:FloorAreaServed > 0.5 )) then	
										;								switch (DHWSys2:SystemType)
										;									case  3840 :	WriteToFile( "Standard," )
										;									case  4096 :	WriteToFile( "Pipe Insulation - All Lines," )
										;									case  4352 :	WriteToFile( "Insulated and Protected Pipe Below Grade," )
										;									case  4608 :	WriteToFile( "Parallel Piping," )
										;									case  4992 :	WriteToFile( "Recirculation - Non-Demand Control," )
										;									case  5248 :	WriteToFile( "Recirculation - Demand Control Push Button," )
										;									case  5504 :	WriteToFile( "Recirculation - Demand Control Occupancy/Motion," )
										;									case  8392704 :	WriteToFile( "(HERS req'd) Pipe Insulation - All Lines," )
										;									case  8393216 :	WriteToFile( "(HERS req'd) Parallel Piping," )
										;									case  8392960 :	WriteToFile( "(HERS req'd) Insulated and Protected Pipe Below Grade," )
										;									case  8393856 :	WriteToFile( "(HERS req'd) Recirculation - Demand Control Push Button," )
										;									case  8394112 :	WriteToFile( "(HERS req'd) Recirculation - Demand Control Occupancy/Motion," )
										;									case  8394240 :	WriteToFile( "(HERS req'd) Point of Use," )
										;									case  8394496 :	WriteToFile( "(HERS req'd) Compact Distribution System," )
										;									default :	WriteToFile( "Standard," )
										;								endswitch
										;							else
										;								if ( IfValidAnd( AltDHWSys2:FloorAreaServed > 0.5 )) then 
										;									switch (AltDHWSys2:SystemType)
										;										case  3840 :	WriteToFile( "Standard," )
										;										case  4096 :	WriteToFile( "Pipe Insulation - All Lines," )
										;										case  4352 :	WriteToFile( "Insulated and Protected Pipe Below Grade," )
										;										case  4608 :	WriteToFile( "Parallel Piping," )
										;										case  4992 :	WriteToFile( "Recirculation - Non-Demand Control," )
										;										case  5248 :	WriteToFile( "Recirculation - Demand Control Push Button," )
										;										case  5504 :	WriteToFile( "Recirculation - Demand Control Occupancy/Motion," )
										;										case  8392704 :	WriteToFile( "(HERS req'd) Pipe Insulation - All Lines," )
										;										case  8393216 :	WriteToFile( "(HERS req'd) Parallel Piping," )
										;										case  8392960 :	WriteToFile( "(HERS req'd) Insulated and Protected Pipe Below Grade," )
										;										case  8393856 :	WriteToFile( "(HERS req'd) Recirculation - Demand Control Push Button," )
										;										case  8394112 :	WriteToFile( "(HERS req'd) Recirculation - Demand Control Occupancy/Motion," )
										;										case  8394240 :	WriteToFile( "(HERS req'd) Point of Use," )
										;										case  8394496 :	WriteToFile( "(HERS req'd) Compact Distribution System," )
										;										default :	WriteToFile( "Standard," )
										;									endswitch
										;								else
										;									if ( IfValidAnd( ExDHWSys2:FloorAreaServed > 0.5 )) then 
										;										switch (ExDHWSys2:SystemType)
										;											case  3840 :	WriteToFile( "Standard," )
										;											case  4096 :	WriteToFile( "Pipe Insulation - All Lines," )
										;											case  4352 :	WriteToFile( "Insulated and Protected Pipe Below Grade," )
										;											case  4608 :	WriteToFile( "Parallel Piping," )
										;											case  4992 :	WriteToFile( "Recirculation - Non-Demand Control," )
										;											case  5248 :	WriteToFile( "Recirculation - Demand Control Push Button," )
										;											case  5504 :	WriteToFile( "Recirculation - Demand Control Occupancy/Motion," )
										;											case  8392704 :	WriteToFile( "(HERS req'd) Pipe Insulation - All Lines," )
										;											case  8393216 :	WriteToFile( "(HERS req'd) Parallel Piping," )
										;											case  8392960 :	WriteToFile( "(HERS req'd) Insulated and Protected Pipe Below Grade," )
										;											case  8393856 :	WriteToFile( "(HERS req'd) Recirculation - Demand Control Push Button," )
										;											case  8394112 :	WriteToFile( "(HERS req'd) Recirculation - Demand Control Occupancy/Motion," )
										;											case  8394240 :	WriteToFile( "(HERS req'd) Point of Use," )
										;											case  8394496 :	WriteToFile( "(HERS req'd) Compact Distribution System," )
										;											default :	WriteToFile( "Standard," )
										;										endswitch
										;									else	UNCHANGED endif endif endif	}
											

   "Write DHWSys2 MFamDistType"			
   	Zone:Action = {   if ( IfValidAnd( DHWSys2:FloorAreaServed > 0.5 ) .AND. IfValidAnd( DHWSys2:MFamDistType > -0.5 ) .AND. IfValidAnd( Proj:IsMultiFamily > 0.5 )) then 
   								WriteToFile( "%c%s%c,", 34, EnumString( DHWSys2:MFamDistType ), 34 )
						;			switch (DHWSys2:MFamDistType)
						;				case  0 :	WriteToFile( "None," )
						;				case  5056 :	WriteToFile( "No Control," )
						;				case  6336 :	WriteToFile( "Demand Control (Standard Design for new construction)," )
						;				case  6592 :	WriteToFile( "Temperature modulation," )
						;				case  6848 :	WriteToFile( "Temperature modulation & monitoring," )
						;				case  8393664 :	WriteToFile( "No Control with HERS verification," )
						;				case  8394944 :	WriteToFile( "Demand Control with HERS verification," )
						;				case  8395200 :	WriteToFile( "Temperature modulation with HERS verification," )
						;				case  8395456 :	WriteToFile( "Temperature modulation & monitoring with HERS verification," )
						;				default :	WriteToFile( "None," )
						;			endswitch
								else if ( IfValidAnd( AltDHWSys2:FloorAreaServed > 0.5 ) .AND. IfValidAnd( AltDHWSys2:MFamDistType > -0.5 ) .AND. IfValidAnd( Proj:IsMultiFamily > 0.5 )) then
   								WriteToFile( "%c%s%c,", 34, EnumString( AltDHWSys2:MFamDistType ), 34 )
						;			switch (AltDHWSys2:MFamDistType)
						;				case  0 :	WriteToFile( "None," )
						;				case  5056 :	WriteToFile( "No Control," )
						;				case  6336 :	WriteToFile( "Demand Control (Standard Design for new construction)," )
						;				case  6592 :	WriteToFile( "Temperature modulation," )
						;				case  6848 :	WriteToFile( "Temperature modulation & monitoring," )
						;				case  8393664 :	WriteToFile( "No Control with HERS verification," )
						;				case  8394944 :	WriteToFile( "Demand Control with HERS verification," )
						;				case  8395200 :	WriteToFile( "Temperature modulation with HERS verification," )
						;				case  8395456 :	WriteToFile( "Temperature modulation & monitoring with HERS verification," )
						;				default :	WriteToFile( "None," )
						;			endswitch
								else if ( IfValidAnd( ExDHWSys2:FloorAreaServed > 0.5 ) .AND. IfValidAnd( ExDHWSys2:MFamDistType > -0.5 ) .AND. IfValidAnd( Proj:IsMultiFamily > 0.5 )) then
   								WriteToFile( "%c%s%c,", 34, EnumString( ExDHWSys2:MFamDistType ), 34 )
						;			switch (ExDHWSys2:MFamDistType)
						;				case  0 :	WriteToFile( "None," )
						;				case  5056 :	WriteToFile( "No Control," )
						;				case  6336 :	WriteToFile( "Demand Control (Standard Design for new construction)," )
						;				case  6592 :	WriteToFile( "Temperature modulation," )
						;				case  6848 :	WriteToFile( "Temperature modulation & monitoring," )
						;				case  8393664 :	WriteToFile( "No Control with HERS verification," )
						;				case  8394944 :	WriteToFile( "Demand Control with HERS verification," )
						;				case  8395200 :	WriteToFile( "Temperature modulation with HERS verification," )
						;				case  8395456 :	WriteToFile( "Temperature modulation & monitoring with HERS verification," )
						;				default :	WriteToFile( "None," )
						;			endswitch
								else UNCHANGED	endif	endif endif	}

   "Write DHWSys2 Water Heater 1"		Zone:Action = {   if ( IfValidAnd( DHWSys2:HeaterMultFlt[1] > 0.001 ) ) then
																				if ( Proj:IsMultiFamily > 0.5 ) then  
									  												WriteToFile( "%c%s%c,", 34, DHWSys2:DHWHeater[1]:Name , 34  )
																				else  WriteToFile( "%c%s%c,", 34, DHWSys2:DHWHeater[1]:Name , 34  )
																				endif
																			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[1] > 0.001 ) ) then 
																				if ( Proj:IsMultiFamily > 0.5 ) then  
									  												WriteToFile( "%c%s%c,", 34, AltDHWSys2:DHWHeater[1]:Name , 34  )
																				else  WriteToFile( "%c%s%c,", 34, AltDHWSys2:DHWHeater[1]:Name , 34  )
																				endif
																			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[1] > 0.001 ) ) then 
																				if ( Proj:IsMultiFamily > 0.5 ) then  
									  												WriteToFile( "%c%s%c,", 34, ExDHWSys2:DHWHeater[1]:Name , 34  )
																				else  WriteToFile( "%c%s%c,", 34, ExDHWSys2:DHWHeater[1]:Name , 34  )
																				endif
								  											else UNCHANGED	endif	endif endif	}

	; SAC 4/24/15 - added logic to many rules below to handle DHW reporting when DHWheater is actually an HVACSys (where HVACSys:CanBeDHWHtr = 1)
   ; SAC 7/6/17 - mods to properly report NEEA-rated HPWHs (tic #841)
    "Write DHWSys2 DHW1 Fuel Type"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[1] > 0.001 )  ) then  
   			if (LocalCompAssigned( DHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( DHWSys2:DHWHeater[1]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( DHWSys2:DHWHeater[1] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( DHWSys2:DHWHeater[1]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[1] > 0.001 ) ) then 
   			if (LocalCompAssigned( AltDHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( AltDHWSys2:DHWHeater[1]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( AltDHWSys2:DHWHeater[1] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( AltDHWSys2:DHWHeater[1]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[1] > 0.001 ) ) then 
   			if (LocalCompAssigned( ExDHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( ExDHWSys2:DHWHeater[1]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( ExDHWSys2:DHWHeater[1] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( ExDHWSys2:DHWHeater[1]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else UNCHANGED	endif	endif endif	}

   "Write DHWSys2 DHW1 Tank Type"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[1] > 0.001 )  ) then  
   			if (LocalCompAssigned( DHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( DHWSys2:DHWHeater[1]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( DHWSys2:DHWHeater[1]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( DHWSys2:DHWHeater[1] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( DHWSys2:DHWHeater[1]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[1] > 0.001 ) ) then 
   			if (LocalCompAssigned( AltDHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( AltDHWSys2:DHWHeater[1]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( AltDHWSys2:DHWHeater[1]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( AltDHWSys2:DHWHeater[1] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( AltDHWSys2:DHWHeater[1]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( ExDHWSys2:HeaterMultFlt[1] > 0.001 ) then 
   			if (LocalCompAssigned( ExDHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( ExDHWSys2:DHWHeater[1]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( ExDHWSys2:DHWHeater[1]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( ExDHWSys2:DHWHeater[1] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( ExDHWSys2:DHWHeater[1]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else UNCHANGED	endif	endif endif	}

   "Write DHWSys2 DHW1 Tank Volume"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[1] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", DHWSys2:DHWHeater[1]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[1]:TankVolume  )
				      endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[1]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", AltDHWSys2:DHWHeater[1]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[1]:TankVolume  )
				      endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[1]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", ExDHWSys2:DHWHeater[1]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[1]:TankVolume  )
				      endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[1]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW1 Energy Factor"	Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[1] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[1]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[1]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[1]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[1]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[1]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[1]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW1 Input Rating"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[1] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( DHWSys2:DHWHeater[1]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[1]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[1]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( AltDHWSys2:DHWHeater[1]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[1]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[1]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( ExDHWSys2:DHWHeater[1]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[1]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[1]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW1 Input Rating units"	Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[1] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, DHWSys2:DHWHeater[1]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( DHWSys2:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, DHWSys2:DHWHeater[1]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, AltDHWSys2:DHWHeater[1]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, AltDHWSys2:DHWHeater[1]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, ExDHWSys2:DHWHeater[1]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, ExDHWSys2:DHWHeater[1]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW1 IntInsulRVal"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[1] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[1]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[1]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[1]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[1]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[1]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[1]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW1 ExtInsulRVal"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[1] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[1]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[1]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[1]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[1]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[1]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[1]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW1 Standby Loss Frac"	Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[1] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( DHWSys2:DHWHeater[1]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[1]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[1]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( AltDHWSys2:DHWHeater[1]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[1]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[1]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( ExDHWSys2:DHWHeater[1]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[1]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[1] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[1]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW1 HPWH Make & Model"	   Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[1] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( DHWSys2:DHWHeater[1]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( DHWSys2:DHWHeater[1]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( DHWSys2:DHWHeater[1]:HPWHBrand ),
				                                     EnumString( DHWSys2:DHWHeater[1]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( AltDHWSys2:DHWHeater[1]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( AltDHWSys2:DHWHeater[1]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( AltDHWSys2:DHWHeater[1]:HPWHBrand ),
				                                     EnumString( AltDHWSys2:DHWHeater[1]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[1]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( ExDHWSys2:DHWHeater[1]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( ExDHWSys2:DHWHeater[1]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( ExDHWSys2:DHWHeater[1]:HPWHBrand ),
				                                     EnumString( ExDHWSys2:DHWHeater[1]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW1 Tank Location"	   Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[1] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[1]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( DHWSys2:DHWHeater[1]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( DHWSys2:DHWHeater[1]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", DHWSys2:DHWHeater[1]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[1]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( AltDHWSys2:DHWHeater[1]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( AltDHWSys2:DHWHeater[1]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", AltDHWSys2:DHWHeater[1]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[1]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( ExDHWSys2:DHWHeater[1]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( ExDHWSys2:DHWHeater[1]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", ExDHWSys2:DHWHeater[1]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW1 Rated Flow"	   Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[1] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[1]:HeaterType = 10 ) .OR.
				          IfValidAnd( DHWSys2:DHWHeater[1]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", DHWSys2:DHWHeater[1]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[1]:HeaterType = 10 ) .OR.
				          IfValidAnd( AltDHWSys2:DHWHeater[1]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", AltDHWSys2:DHWHeater[1]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[1]:HeaterType = 10 ) .OR.
				          IfValidAnd( ExDHWSys2:DHWHeater[1]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", ExDHWSys2:DHWHeater[1]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW1 First Hour Rating & Recovery Efficiency"	   Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[1] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[1]:HeaterType = 12 ) .OR.
				          IfValidAnd( DHWSys2:DHWHeater[1]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( DHWSys2:DHWHeater[1]:FirstHourRating, -1 ),
				                                   ValidOr( DHWSys2:DHWHeater[1]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else 	WriteToFile( ",," )  endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[1]:HeaterType = 12 ) .OR.
				          IfValidAnd( AltDHWSys2:DHWHeater[1]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( AltDHWSys2:DHWHeater[1]:FirstHourRating, -1 ),
				                                   ValidOr( AltDHWSys2:DHWHeater[1]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else	WriteToFile( ",," )  endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[1] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[1] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[1]:HeaterType = 12 ) .OR.
				          IfValidAnd( ExDHWSys2:DHWHeater[1]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( ExDHWSys2:DHWHeater[1]:FirstHourRating, -1 ),
				                                   ValidOr( ExDHWSys2:DHWHeater[1]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else	WriteToFile( ",," )  endif
			else UNCHANGED endif endif endif }


   "Write DHWSys2 Water Heater 2"		Zone:Action = {   if ( IfValidAnd( DHWSys2:HeaterMultFlt[2] > 0.001 ) .AND. LocalCompAssigned( DHWSys2:DHWHeater[2] )) then
																				if ( Proj:IsMultiFamily > 0.5 ) then  
								  													   WriteToFile( "\n,,,,,%c%s%c,", 34, DHWSys2:DHWHeater[2]:Name , 34  )
																				else  WriteToFile(  "\n,,,,%c%s%c,", 34, DHWSys2:DHWHeater[2]:Name , 34  )
																				endif
																			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[2] > 0.001 ) .AND. LocalCompAssigned( AltDHWSys2:DHWHeater[2] )) then 
																				if ( Proj:IsMultiFamily > 0.5 ) then  
								  													   WriteToFile( "\n,,,,,%c%s%c,", 34, AltDHWSys2:DHWHeater[2]:Name , 34  )
																				else  WriteToFile(  "\n,,,,%c%s%c,", 34, AltDHWSys2:DHWHeater[2]:Name , 34  )
																				endif
																			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[2] > 0.001 ) .AND. LocalCompAssigned( ExDHWSys2:DHWHeater[2] )) then 
																				if ( Proj:IsMultiFamily > 0.5 ) then  
								  													   WriteToFile( "\n,,,,,%c%s%c,", 34, ExDHWSys2:DHWHeater[2]:Name , 34  )
																				else  WriteToFile(  "\n,,,,%c%s%c,", 34, ExDHWSys2:DHWHeater[2]:Name , 34  )
																				endif
								  											else UNCHANGED	endif	endif endif	}

    "Write DHWSys2 DHW2 Fuel Type"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[2] > 0.001 )  ) then  
   			if (LocalCompAssigned( DHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( DHWSys2:DHWHeater[2]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( DHWSys2:DHWHeater[2] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( DHWSys2:DHWHeater[2]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[2] > 0.001 ) ) then 
   			if (LocalCompAssigned( AltDHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( AltDHWSys2:DHWHeater[2]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( AltDHWSys2:DHWHeater[2] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( AltDHWSys2:DHWHeater[2]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[2] > 0.001 ) ) then 
   			if (LocalCompAssigned( ExDHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( ExDHWSys2:DHWHeater[2]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( ExDHWSys2:DHWHeater[2] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( ExDHWSys2:DHWHeater[2]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else UNCHANGED	endif	endif endif	}

   "Write DHWSys2 DHW2 Tank Type"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[2] > 0.001 )  ) then  
   			if (LocalCompAssigned( DHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( DHWSys2:DHWHeater[2]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( DHWSys2:DHWHeater[2]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( DHWSys2:DHWHeater[2] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( DHWSys2:DHWHeater[2]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[2] > 0.001 ) ) then 
   			if (LocalCompAssigned( AltDHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( AltDHWSys2:DHWHeater[2]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( AltDHWSys2:DHWHeater[2]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( AltDHWSys2:DHWHeater[2] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( AltDHWSys2:DHWHeater[2]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( ExDHWSys2:HeaterMultFlt[2] > 0.001 ) then 
   			if (LocalCompAssigned( ExDHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( ExDHWSys2:DHWHeater[2]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( ExDHWSys2:DHWHeater[2]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( ExDHWSys2:DHWHeater[2] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( ExDHWSys2:DHWHeater[2]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else UNCHANGED	endif	endif endif	}

   "Write DHWSys2 DHW2 Tank Volume"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[2] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", DHWSys2:DHWHeater[2]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[2]:TankVolume  )
				      endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[2]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", AltDHWSys2:DHWHeater[2]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[2]:TankVolume  )
				      endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[2]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", ExDHWSys2:DHWHeater[2]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[2]:TankVolume  )
				      endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[2]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW2 Energy Factor"	Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[2] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[2]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[2]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[2]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[2]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[2]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[2]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW2 Input Rating"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[2] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( DHWSys2:DHWHeater[2]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[2]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[2]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( AltDHWSys2:DHWHeater[2]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[2]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[2]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( ExDHWSys2:DHWHeater[2]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[2]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[2]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW2 Input Rating units"	Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[2] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, DHWSys2:DHWHeater[2]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( DHWSys2:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, DHWSys2:DHWHeater[2]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, AltDHWSys2:DHWHeater[2]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, AltDHWSys2:DHWHeater[2]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, ExDHWSys2:DHWHeater[2]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, ExDHWSys2:DHWHeater[2]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW2 IntInsulRVal"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[2] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[2]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[2]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[2]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[2]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[2]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[2]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW2 ExtInsulRVal"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[2] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[2]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[2]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[2]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[2]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[2]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[2]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW2 Standby Loss Frac"	Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[2] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( DHWSys2:DHWHeater[2]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[2]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[2]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( AltDHWSys2:DHWHeater[2]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[2]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[2]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( ExDHWSys2:DHWHeater[2]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[2]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[2] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[2]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW2 HPWH Make & Model"	   Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[2] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( DHWSys2:DHWHeater[2]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( DHWSys2:DHWHeater[2]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( DHWSys2:DHWHeater[2]:HPWHBrand ),
				                                     EnumString( DHWSys2:DHWHeater[2]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( AltDHWSys2:DHWHeater[2]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( AltDHWSys2:DHWHeater[2]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( AltDHWSys2:DHWHeater[2]:HPWHBrand ),
				                                     EnumString( AltDHWSys2:DHWHeater[2]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[2]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( ExDHWSys2:DHWHeater[2]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( ExDHWSys2:DHWHeater[2]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( ExDHWSys2:DHWHeater[2]:HPWHBrand ),
				                                     EnumString( ExDHWSys2:DHWHeater[2]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW2 Tank Location"	   Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[2] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[2]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( DHWSys2:DHWHeater[2]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( DHWSys2:DHWHeater[2]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", DHWSys2:DHWHeater[2]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[2]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( AltDHWSys2:DHWHeater[2]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( AltDHWSys2:DHWHeater[2]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", AltDHWSys2:DHWHeater[2]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[2]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( ExDHWSys2:DHWHeater[2]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( ExDHWSys2:DHWHeater[2]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", ExDHWSys2:DHWHeater[2]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW2 Rated Flow"	   Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[2] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[2]:HeaterType = 10 ) .OR.
				          IfValidAnd( DHWSys2:DHWHeater[2]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", DHWSys2:DHWHeater[2]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[2]:HeaterType = 10 ) .OR.
				          IfValidAnd( AltDHWSys2:DHWHeater[2]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", AltDHWSys2:DHWHeater[2]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[2]:HeaterType = 10 ) .OR.
				          IfValidAnd( ExDHWSys2:DHWHeater[2]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", ExDHWSys2:DHWHeater[2]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW2 First Hour Rating & Recovery Efficiency"	   Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[2] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[2]:HeaterType = 12 ) .OR.
				          IfValidAnd( DHWSys2:DHWHeater[2]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( DHWSys2:DHWHeater[2]:FirstHourRating, -1 ),
				                                   ValidOr( DHWSys2:DHWHeater[2]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else 	WriteToFile( ",," )  endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[2]:HeaterType = 12 ) .OR.
				          IfValidAnd( AltDHWSys2:DHWHeater[2]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( AltDHWSys2:DHWHeater[2]:FirstHourRating, -1 ),
				                                   ValidOr( AltDHWSys2:DHWHeater[2]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else	WriteToFile( ",," )  endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[2] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[2] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[2]:HeaterType = 12 ) .OR.
				          IfValidAnd( ExDHWSys2:DHWHeater[2]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( ExDHWSys2:DHWHeater[2]:FirstHourRating, -1 ),
				                                   ValidOr( ExDHWSys2:DHWHeater[2]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else	WriteToFile( ",," )  endif
			else UNCHANGED endif endif endif }


   "Write DHWSys2 Water Heater 3"		Zone:Action = {   if ( IfValidAnd( DHWSys2:HeaterMultFlt[3] > 0.001 )) then
																				if ( Proj:IsMultiFamily > 0.5 ) then  
								  													WriteToFile( "\n,,,,,%c%s%c,", 34, DHWSys2:DHWHeater[3]:Name , 34  )
																				else  	WriteToFile( "\n,,,,%c%s%c,", 34, DHWSys2:DHWHeater[3]:Name , 34  )
																				endif
																			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[3] > 0.001 )) then 
																				if ( Proj:IsMultiFamily > 0.5 ) then  
								  													WriteToFile( "\n,,,,,%c%s%c,", 34, AltDHWSys2:DHWHeater[3]:Name , 34  )
																				else  	WriteToFile( "\n,,,,%c%s%c,", 34, AltDHWSys2:DHWHeater[3]:Name , 34  )
																				endif
																			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[3] > 0.001 )) then 
																				if ( Proj:IsMultiFamily > 0.5 ) then  
								  													WriteToFile( "\n,,,,,%c%s%c,", 34, ExDHWSys2:DHWHeater[3]:Name , 34  )
																				else  	WriteToFile( "\n,,,,%c%s%c,", 34, ExDHWSys2:DHWHeater[3]:Name , 34  )
																				endif
								  											else UNCHANGED	endif	endif endif	}

    "Write DHWSys2 DHW3 Fuel Type"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[3] > 0.001 )  ) then  
   			if (LocalCompAssigned( DHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( DHWSys2:DHWHeater[3]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( DHWSys2:DHWHeater[3] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( DHWSys2:DHWHeater[3]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[3] > 0.001 ) ) then 
   			if (LocalCompAssigned( AltDHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( AltDHWSys2:DHWHeater[3]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( AltDHWSys2:DHWHeater[3] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( AltDHWSys2:DHWHeater[3]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[3] > 0.001 ) ) then 
   			if (LocalCompAssigned( ExDHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( ExDHWSys2:DHWHeater[3]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( ExDHWSys2:DHWHeater[3] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( ExDHWSys2:DHWHeater[3]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else UNCHANGED	endif	endif endif	}

   "Write DHWSys2 DHW3 Tank Type"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[3] > 0.001 )  ) then  
   			if (LocalCompAssigned( DHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( DHWSys2:DHWHeater[3]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( DHWSys2:DHWHeater[3]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( DHWSys2:DHWHeater[3] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( DHWSys2:DHWHeater[3]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[3] > 0.001 ) ) then 
   			if (LocalCompAssigned( AltDHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( AltDHWSys2:DHWHeater[3]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( AltDHWSys2:DHWHeater[3]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( AltDHWSys2:DHWHeater[3] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( AltDHWSys2:DHWHeater[3]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( ExDHWSys2:HeaterMultFlt[3] > 0.001 ) then 
   			if (LocalCompAssigned( ExDHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( ExDHWSys2:DHWHeater[3]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( ExDHWSys2:DHWHeater[3]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( ExDHWSys2:DHWHeater[3] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( ExDHWSys2:DHWHeater[3]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else UNCHANGED	endif	endif endif	}

   "Write DHWSys2 DHW3 Tank Volume"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[3] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", DHWSys2:DHWHeater[3]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[3]:TankVolume  )
				      endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[3]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", AltDHWSys2:DHWHeater[3]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[3]:TankVolume  )
				      endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[3]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", ExDHWSys2:DHWHeater[3]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[3]:TankVolume  )
				      endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[3]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW3 Energy Factor"	Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[3] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[3]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[3]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[3]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[3]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[3]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[3]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW3 Input Rating"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[3] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( DHWSys2:DHWHeater[3]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[3]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[3]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( AltDHWSys2:DHWHeater[3]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[3]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[3]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( ExDHWSys2:DHWHeater[3]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[3]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[3]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW3 Input Rating units"	Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[3] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, DHWSys2:DHWHeater[3]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( DHWSys2:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, DHWSys2:DHWHeater[3]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, AltDHWSys2:DHWHeater[3]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, AltDHWSys2:DHWHeater[3]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, ExDHWSys2:DHWHeater[3]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, ExDHWSys2:DHWHeater[3]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW3 IntInsulRVal"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[3] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[3]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[3]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[3]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[3]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[3]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[3]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW3 ExtInsulRVal"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[3] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[3]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[3]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[3]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[3]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[3]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[3]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW3 Standby Loss Frac"	Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[3] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( DHWSys2:DHWHeater[3]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[3]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[3]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( AltDHWSys2:DHWHeater[3]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[3]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[3]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( ExDHWSys2:DHWHeater[3]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[3]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[3] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[3]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW3 HPWH Make & Model"	   Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[3] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( DHWSys2:DHWHeater[3]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( DHWSys2:DHWHeater[3]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( DHWSys2:DHWHeater[3]:HPWHBrand ),
				                                     EnumString( DHWSys2:DHWHeater[3]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( AltDHWSys2:DHWHeater[3]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( AltDHWSys2:DHWHeater[3]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( AltDHWSys2:DHWHeater[3]:HPWHBrand ),
				                                     EnumString( AltDHWSys2:DHWHeater[3]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[3]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( ExDHWSys2:DHWHeater[3]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( ExDHWSys2:DHWHeater[3]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( ExDHWSys2:DHWHeater[3]:HPWHBrand ),
				                                     EnumString( ExDHWSys2:DHWHeater[3]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW3 Tank Location"	   Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[3] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[3]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( DHWSys2:DHWHeater[3]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( DHWSys2:DHWHeater[3]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", DHWSys2:DHWHeater[3]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[3]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( AltDHWSys2:DHWHeater[3]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( AltDHWSys2:DHWHeater[3]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", AltDHWSys2:DHWHeater[3]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[3]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( ExDHWSys2:DHWHeater[3]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( ExDHWSys2:DHWHeater[3]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", ExDHWSys2:DHWHeater[3]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW3 Rated Flow"	   Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[3] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[3]:HeaterType = 10 ) .OR.
				          IfValidAnd( DHWSys2:DHWHeater[3]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", DHWSys2:DHWHeater[3]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[3]:HeaterType = 10 ) .OR.
				          IfValidAnd( AltDHWSys2:DHWHeater[3]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", AltDHWSys2:DHWHeater[3]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[3]:HeaterType = 10 ) .OR.
				          IfValidAnd( ExDHWSys2:DHWHeater[3]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", ExDHWSys2:DHWHeater[3]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW3 First Hour Rating & Recovery Efficiency"	   Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[3] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[3]:HeaterType = 12 ) .OR.
				          IfValidAnd( DHWSys2:DHWHeater[3]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( DHWSys2:DHWHeater[3]:FirstHourRating, -1 ),
				                                   ValidOr( DHWSys2:DHWHeater[3]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else 	WriteToFile( ",," )  endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[3]:HeaterType = 12 ) .OR.
				          IfValidAnd( AltDHWSys2:DHWHeater[3]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( AltDHWSys2:DHWHeater[3]:FirstHourRating, -1 ),
				                                   ValidOr( AltDHWSys2:DHWHeater[3]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else	WriteToFile( ",," )  endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[3] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[3] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[3]:HeaterType = 12 ) .OR.
				          IfValidAnd( ExDHWSys2:DHWHeater[3]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( ExDHWSys2:DHWHeater[3]:FirstHourRating, -1 ),
				                                   ValidOr( ExDHWSys2:DHWHeater[3]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else	WriteToFile( ",," )  endif
			else UNCHANGED endif endif endif }


   "Write DHWSys2 Water Heater 4"		Zone:Action = {   if ( IfValidAnd( DHWSys2:HeaterMultFlt[4] > 0.001 )) then
																				if ( Proj:IsMultiFamily > 0.5 ) then  
								  													WriteToFile( "\n,,,,,%c%s%c,", 34, DHWSys2:DHWHeater[4]:Name , 34  )
																				else  	WriteToFile( "\n,,,,%c%s%c,", 34, DHWSys2:DHWHeater[4]:Name , 34  )
																				endif
																			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[4] > 0.001 )) then 
																				if ( Proj:IsMultiFamily > 0.5 ) then  
								  													WriteToFile( "\n,,,,,%c%s%c,", 34, AltDHWSys2:DHWHeater[4]:Name , 34  )
																				else  	WriteToFile( "\n,,,,%c%s%c,", 34, AltDHWSys2:DHWHeater[4]:Name , 34  )
																				endif
																			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[4] > 0.001 )) then 
																				if ( Proj:IsMultiFamily > 0.5 ) then  
								  													WriteToFile( "\n,,,,,%c%s%c,", 34, ExDHWSys2:DHWHeater[4]:Name , 34  )
																				else  	WriteToFile( "\n,,,,%c%s%c,", 34, ExDHWSys2:DHWHeater[4]:Name , 34  )
																				endif
								  											else UNCHANGED	endif	endif endif	}

    "Write DHWSys2 DHW4 Fuel Type"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[4] > 0.001 )  ) then  
   			if (LocalCompAssigned( DHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( DHWSys2:DHWHeater[4]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( DHWSys2:DHWHeater[4] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( DHWSys2:DHWHeater[4]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[4] > 0.001 ) ) then 
   			if (LocalCompAssigned( AltDHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( AltDHWSys2:DHWHeater[4]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( AltDHWSys2:DHWHeater[4] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( AltDHWSys2:DHWHeater[4]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[4] > 0.001 ) ) then 
   			if (LocalCompAssigned( ExDHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( ExDHWSys2:DHWHeater[4]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( ExDHWSys2:DHWHeater[4] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( ExDHWSys2:DHWHeater[4]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else UNCHANGED	endif	endif endif	}

   "Write DHWSys2 DHW4 Tank Type"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[4] > 0.001 )  ) then  
   			if (LocalCompAssigned( DHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( DHWSys2:DHWHeater[4]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( DHWSys2:DHWHeater[4]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( DHWSys2:DHWHeater[4] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( DHWSys2:DHWHeater[4]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[4] > 0.001 ) ) then 
   			if (LocalCompAssigned( AltDHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( AltDHWSys2:DHWHeater[4]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( AltDHWSys2:DHWHeater[4]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( AltDHWSys2:DHWHeater[4] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( AltDHWSys2:DHWHeater[4]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( ExDHWSys2:HeaterMultFlt[4] > 0.001 ) then 
   			if (LocalCompAssigned( ExDHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( ExDHWSys2:DHWHeater[4]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( ExDHWSys2:DHWHeater[4]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( ExDHWSys2:DHWHeater[4] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( ExDHWSys2:DHWHeater[4]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else UNCHANGED	endif	endif endif	}

   "Write DHWSys2 DHW4 Tank Volume"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[4] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", DHWSys2:DHWHeater[4]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[4]:TankVolume  )
				      endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[4]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", AltDHWSys2:DHWHeater[4]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[4]:TankVolume  )
				      endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[4]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", ExDHWSys2:DHWHeater[4]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[4]:TankVolume  )
				      endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[4]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW4 Energy Factor"	Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[4] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[4]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[4]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[4]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[4]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[4]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[4]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW4 Input Rating"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[4] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( DHWSys2:DHWHeater[4]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[4]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[4]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( AltDHWSys2:DHWHeater[4]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[4]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[4]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( ExDHWSys2:DHWHeater[4]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[4]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[4]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW4 Input Rating units"	Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[4] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, DHWSys2:DHWHeater[4]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( DHWSys2:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, DHWSys2:DHWHeater[4]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, AltDHWSys2:DHWHeater[4]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, AltDHWSys2:DHWHeater[4]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, ExDHWSys2:DHWHeater[4]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, ExDHWSys2:DHWHeater[4]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW4 IntInsulRVal"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[4] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[4]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[4]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[4]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[4]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[4]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[4]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW4 ExtInsulRVal"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[4] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[4]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[4]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[4]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[4]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[4]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[4]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW4 Standby Loss Frac"	Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[4] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( DHWSys2:DHWHeater[4]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[4]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[4]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( AltDHWSys2:DHWHeater[4]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[4]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[4]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( ExDHWSys2:DHWHeater[4]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[4]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[4] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[4]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW4 HPWH Make & Model"	   Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[4] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( DHWSys2:DHWHeater[4]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( DHWSys2:DHWHeater[4]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( DHWSys2:DHWHeater[4]:HPWHBrand ),
				                                     EnumString( DHWSys2:DHWHeater[4]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( AltDHWSys2:DHWHeater[4]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( AltDHWSys2:DHWHeater[4]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( AltDHWSys2:DHWHeater[4]:HPWHBrand ),
				                                     EnumString( AltDHWSys2:DHWHeater[4]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[4]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( ExDHWSys2:DHWHeater[4]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( ExDHWSys2:DHWHeater[4]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( ExDHWSys2:DHWHeater[4]:HPWHBrand ),
				                                     EnumString( ExDHWSys2:DHWHeater[4]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW4 Tank Location"	   Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[4] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[4]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( DHWSys2:DHWHeater[4]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( DHWSys2:DHWHeater[4]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", DHWSys2:DHWHeater[4]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[4]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( AltDHWSys2:DHWHeater[4]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( AltDHWSys2:DHWHeater[4]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", AltDHWSys2:DHWHeater[4]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[4]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( ExDHWSys2:DHWHeater[4]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( ExDHWSys2:DHWHeater[4]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", ExDHWSys2:DHWHeater[4]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW4 Rated Flow"	   Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[4] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[4]:HeaterType = 10 ) .OR.
				          IfValidAnd( DHWSys2:DHWHeater[4]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", DHWSys2:DHWHeater[4]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[4]:HeaterType = 10 ) .OR.
				          IfValidAnd( AltDHWSys2:DHWHeater[4]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", AltDHWSys2:DHWHeater[4]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[4]:HeaterType = 10 ) .OR.
				          IfValidAnd( ExDHWSys2:DHWHeater[4]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", ExDHWSys2:DHWHeater[4]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW4 First Hour Rating & Recovery Efficiency"	   Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[4] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[4]:HeaterType = 12 ) .OR.
				          IfValidAnd( DHWSys2:DHWHeater[4]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( DHWSys2:DHWHeater[4]:FirstHourRating, -1 ),
				                                   ValidOr( DHWSys2:DHWHeater[4]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else 	WriteToFile( ",," )  endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[4]:HeaterType = 12 ) .OR.
				          IfValidAnd( AltDHWSys2:DHWHeater[4]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( AltDHWSys2:DHWHeater[4]:FirstHourRating, -1 ),
				                                   ValidOr( AltDHWSys2:DHWHeater[4]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else	WriteToFile( ",," )  endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[4] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[4] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[4]:HeaterType = 12 ) .OR.
				          IfValidAnd( ExDHWSys2:DHWHeater[4]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( ExDHWSys2:DHWHeater[4]:FirstHourRating, -1 ),
				                                   ValidOr( ExDHWSys2:DHWHeater[4]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else	WriteToFile( ",," )  endif
			else UNCHANGED endif endif endif }


   "Write DHWSys2 Water Heater 5"		Zone:Action = {   if ( IfValidAnd( DHWSys2:HeaterMultFlt[5] > 0.001 )) then
																				if ( Proj:IsMultiFamily > 0.5 ) then  
								  													WriteToFile( "\n,,,,,%c%s%c,", 34, DHWSys2:DHWHeater[5]:Name , 34  )
																				else  	WriteToFile( "\n,,,,%c%s%c,", 34, DHWSys2:DHWHeater[5]:Name , 34  )
																				endif
																			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[5] > 0.001 )) then 
																				if ( Proj:IsMultiFamily > 0.5 ) then  
								  													WriteToFile( "\n,,,,,%c%s%c,", 34, AltDHWSys2:DHWHeater[5]:Name , 34  )
																				else  	WriteToFile( "\n,,,,%c%s%c,", 34, AltDHWSys2:DHWHeater[5]:Name , 34  )
																				endif
																			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[5] > 0.001 )) then 
																				if ( Proj:IsMultiFamily > 0.5 ) then  
								  													WriteToFile( "\n,,,,,%c%s%c,", 34, ExDHWSys2:DHWHeater[5]:Name , 34  )
																				else  	WriteToFile( "\n,,,,%c%s%c,", 34, ExDHWSys2:DHWHeater[5]:Name , 34  )
																				endif
								  											else UNCHANGED	endif	endif endif	}

    "Write DHWSys2 DHW5 Fuel Type"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[5] > 0.001 )  ) then  
   			if (LocalCompAssigned( DHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( DHWSys2:DHWHeater[5]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( DHWSys2:DHWHeater[5] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( DHWSys2:DHWHeater[5]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[5] > 0.001 ) ) then 
   			if (LocalCompAssigned( AltDHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( AltDHWSys2:DHWHeater[5]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( AltDHWSys2:DHWHeater[5] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( AltDHWSys2:DHWHeater[5]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[5] > 0.001 ) ) then 
   			if (LocalCompAssigned( ExDHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( ExDHWSys2:DHWHeater[5]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( ExDHWSys2:DHWHeater[5] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( ExDHWSys2:DHWHeater[5]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else UNCHANGED	endif	endif endif	}

   "Write DHWSys2 DHW5 Tank Type"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[5] > 0.001 )  ) then  
   			if (LocalCompAssigned( DHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( DHWSys2:DHWHeater[5]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( DHWSys2:DHWHeater[5]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( DHWSys2:DHWHeater[5] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( DHWSys2:DHWHeater[5]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[5] > 0.001 ) ) then 
   			if (LocalCompAssigned( AltDHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( AltDHWSys2:DHWHeater[5]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( AltDHWSys2:DHWHeater[5]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( AltDHWSys2:DHWHeater[5] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( AltDHWSys2:DHWHeater[5]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( ExDHWSys2:HeaterMultFlt[5] > 0.001 ) then 
   			if (LocalCompAssigned( ExDHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( ExDHWSys2:DHWHeater[5]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( ExDHWSys2:DHWHeater[5]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( ExDHWSys2:DHWHeater[5] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( ExDHWSys2:DHWHeater[5]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else UNCHANGED	endif	endif endif	}

   "Write DHWSys2 DHW5 Tank Volume"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[5] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", DHWSys2:DHWHeater[5]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[5]:TankVolume  )
				      endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[5]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", AltDHWSys2:DHWHeater[5]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[5]:TankVolume  )
				      endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[5]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", ExDHWSys2:DHWHeater[5]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[5]:TankVolume  )
				      endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[5]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW5 Energy Factor"	Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[5] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[5]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[5]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[5]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[5]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[5]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[5]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW5 Input Rating"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[5] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( DHWSys2:DHWHeater[5]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[5]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[5]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( AltDHWSys2:DHWHeater[5]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[5]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[5]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( ExDHWSys2:DHWHeater[5]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[5]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[5]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW5 Input Rating units"	Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[5] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, DHWSys2:DHWHeater[5]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( DHWSys2:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, DHWSys2:DHWHeater[5]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, AltDHWSys2:DHWHeater[5]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, AltDHWSys2:DHWHeater[5]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, ExDHWSys2:DHWHeater[5]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, ExDHWSys2:DHWHeater[5]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW5 IntInsulRVal"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[5] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[5]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[5]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[5]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[5]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[5]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[5]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW5 ExtInsulRVal"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[5] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[5]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[5]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[5]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[5]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[5]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[5]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW5 Standby Loss Frac"	Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[5] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( DHWSys2:DHWHeater[5]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[5]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[5]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( AltDHWSys2:DHWHeater[5]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[5]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[5]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( ExDHWSys2:DHWHeater[5]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[5]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[5] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[5]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW5 HPWH Make & Model"	   Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[5] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( DHWSys2:DHWHeater[5]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( DHWSys2:DHWHeater[5]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( DHWSys2:DHWHeater[5]:HPWHBrand ),
				                                     EnumString( DHWSys2:DHWHeater[5]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( AltDHWSys2:DHWHeater[5]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( AltDHWSys2:DHWHeater[5]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( AltDHWSys2:DHWHeater[5]:HPWHBrand ),
				                                     EnumString( AltDHWSys2:DHWHeater[5]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[5]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( ExDHWSys2:DHWHeater[5]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( ExDHWSys2:DHWHeater[5]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( ExDHWSys2:DHWHeater[5]:HPWHBrand ),
				                                     EnumString( ExDHWSys2:DHWHeater[5]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW5 Tank Location"	   Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[5] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[5]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( DHWSys2:DHWHeater[5]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( DHWSys2:DHWHeater[5]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", DHWSys2:DHWHeater[5]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[5]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( AltDHWSys2:DHWHeater[5]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( AltDHWSys2:DHWHeater[5]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", AltDHWSys2:DHWHeater[5]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[5]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( ExDHWSys2:DHWHeater[5]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( ExDHWSys2:DHWHeater[5]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", ExDHWSys2:DHWHeater[5]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW5 Rated Flow"	   Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[5] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[5]:HeaterType = 10 ) .OR.
				          IfValidAnd( DHWSys2:DHWHeater[5]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", DHWSys2:DHWHeater[5]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[5]:HeaterType = 10 ) .OR.
				          IfValidAnd( AltDHWSys2:DHWHeater[5]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", AltDHWSys2:DHWHeater[5]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[5]:HeaterType = 10 ) .OR.
				          IfValidAnd( ExDHWSys2:DHWHeater[5]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", ExDHWSys2:DHWHeater[5]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW5 First Hour Rating & Recovery Efficiency"	   Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[5] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[5]:HeaterType = 12 ) .OR.
				          IfValidAnd( DHWSys2:DHWHeater[5]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( DHWSys2:DHWHeater[5]:FirstHourRating, -1 ),
				                                   ValidOr( DHWSys2:DHWHeater[5]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else 	WriteToFile( ",," )  endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[5]:HeaterType = 12 ) .OR.
				          IfValidAnd( AltDHWSys2:DHWHeater[5]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( AltDHWSys2:DHWHeater[5]:FirstHourRating, -1 ),
				                                   ValidOr( AltDHWSys2:DHWHeater[5]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else	WriteToFile( ",," )  endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[5] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[5] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[5]:HeaterType = 12 ) .OR.
				          IfValidAnd( ExDHWSys2:DHWHeater[5]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( ExDHWSys2:DHWHeater[5]:FirstHourRating, -1 ),
				                                   ValidOr( ExDHWSys2:DHWHeater[5]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else	WriteToFile( ",," )  endif
			else UNCHANGED endif endif endif }


   "Write DHWSys2 Water Heater 6"		Zone:Action = {   if ( IfValidAnd( DHWSys2:HeaterMultFlt[6] > 0.001 )) then
																				if ( Proj:IsMultiFamily > 0.5 ) then  
								  													WriteToFile( "\n,,,,,%c%s%c,", 34, DHWSys2:DHWHeater[6]:Name , 34  )
																				else  	WriteToFile( "\n,,,,%c%s%c,", 34, DHWSys2:DHWHeater[6]:Name , 34  )
																				endif
																			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[6] > 0.001 )) then 
																				if ( Proj:IsMultiFamily > 0.5 ) then  
								  													WriteToFile( "\n,,,,,%c%s%c,", 34, AltDHWSys2:DHWHeater[6]:Name , 34  )
																				else  	WriteToFile( "\n,,,,%c%s%c,", 34, AltDHWSys2:DHWHeater[6]:Name , 34  )
																				endif
																			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[6] > 0.001 )) then 
																				if ( Proj:IsMultiFamily > 0.5 ) then  
								  													WriteToFile( "\n,,,,,%c%s%c,", 34, ExDHWSys2:DHWHeater[6]:Name , 34  )
																				else  	WriteToFile( "\n,,,,%c%s%c,", 34, ExDHWSys2:DHWHeater[6]:Name , 34  )
																				endif
								  											else UNCHANGED	endif	endif endif	}

    "Write DHWSys2 DHW6 Fuel Type"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[6] > 0.001 )  ) then  
   			if (LocalCompAssigned( DHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( DHWSys2:DHWHeater[6]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( DHWSys2:DHWHeater[6] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( DHWSys2:DHWHeater[6]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[6] > 0.001 ) ) then 
   			if (LocalCompAssigned( AltDHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( AltDHWSys2:DHWHeater[6]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( AltDHWSys2:DHWHeater[6] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( AltDHWSys2:DHWHeater[6]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[6] > 0.001 ) ) then 
   			if (LocalCompAssigned( ExDHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
   			then	WriteToFile( EnumString( ExDHWSys2:DHWHeater[6]:HeaterElementType ) + "," )
   			else if (LocalCompAssigned( ExDHWSys2:DHWHeater[6] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( ExDHWSys2:DHWHeater[6]:DHWHeaterElementType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else UNCHANGED	endif	endif endif	}

   "Write DHWSys2 DHW6 Tank Type"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[6] > 0.001 )  ) then  
   			if (LocalCompAssigned( DHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( DHWSys2:DHWHeater[6]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( DHWSys2:DHWHeater[6]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( DHWSys2:DHWHeater[6] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( DHWSys2:DHWHeater[6]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[6] > 0.001 ) ) then 
   			if (LocalCompAssigned( AltDHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( AltDHWSys2:DHWHeater[6]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( AltDHWSys2:DHWHeater[6]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( AltDHWSys2:DHWHeater[6] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( AltDHWSys2:DHWHeater[6]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else if ( ExDHWSys2:HeaterMultFlt[6] > 0.001 ) then 
   			if (LocalCompAssigned( ExDHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
   			then	if (IfValidAnd( ExDHWSys2:DHWHeater[6]:HeaterElementType = 5 )) then  WriteToFile( "NA," )
   			      else  WriteToFile( EnumString( ExDHWSys2:DHWHeater[6]:TankType ) + "," )
   			      endif
   			else if (LocalCompAssigned( ExDHWSys2:DHWHeater[6] ) == ComponentType( "HVACSys" ))
   			then	WriteToFile( EnumString( ExDHWSys2:DHWHeater[6]:DHWTankType ) + "," )
   			else	WriteToFile( "<unrecognized DHW heater object type>," )
   			endif endif
   		else UNCHANGED	endif	endif endif	}

   "Write DHWSys2 DHW6 Tank Volume"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[6] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", DHWSys2:DHWHeater[6]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[6]:TankVolume  )
				      endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[6]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", AltDHWSys2:DHWHeater[6]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[6]:TankVolume  )
				      endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[6]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "%0.3f,", HPWHData_NEEA:TankVolume( "Model", ExDHWSys2:DHWHeater[6]:HPWHModel )  )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[6]:TankVolume  )
				      endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[6]:DHWTankVolume  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW6 Energy Factor"	Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[6] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[6]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[6]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[6]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[6]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NEEA Rated," )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[6]:EnergyFactor  )
				      endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[6]:DHWEnergyFactor  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW6 Input Rating"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[6] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( DHWSys2:DHWHeater[6]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[6]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[6]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( AltDHWSys2:DHWHeater[6]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[6]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[6]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( ExDHWSys2:DHWHeater[6]:InputRatingSim ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[6]:InputRatingSim  )
				      endif endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[6]:DHWInputRating  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW6 Input Rating units"	Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[6] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, DHWSys2:DHWHeater[6]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( DHWSys2:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, DHWSys2:DHWHeater[6]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, AltDHWSys2:DHWHeater[6]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, AltDHWSys2:DHWHeater[6]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	WriteToFile( "%c%s%c,", 34, ExDHWSys2:DHWHeater[6]:InputRatingUnits , 34  )
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%c%s%c,", 34, ExDHWSys2:DHWHeater[6]:DHWInputRatingUnits , 34  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW6 IntInsulRVal"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[6] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[6]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[6]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[6]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[6]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[6]:IntInsulRVal  )
				      endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[6]:DHWIntInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW6 ExtInsulRVal"		Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[6] > 0.001 )  ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[6]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[6]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[6]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[6]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[6]:ExtInsulRVal  )
				      endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[6]:DHWExtInsulRVal  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW6 Standby Loss Frac"	Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[6] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( DHWSys2:DHWHeater[6]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", DHWSys2:DHWHeater[6]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( DHWSys2:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", DHWSys2:DHWHeater[6]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( AltDHWSys2:DHWHeater[6]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[6]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( AltDHWSys2:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", AltDHWSys2:DHWHeater[6]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ))
				      then  WriteToFile( "NA," )
				      else if (LocalStatus( ExDHWSys2:DHWHeater[6]:StandbyLossFrac ) < 1)
				      then  WriteToFile( "," )
				      else  WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[6]:StandbyLossFrac  )
				      endif endif
				else if (LocalCompAssigned( ExDHWSys2:DHWHeater[6] ) == ComponentType( "HVACSys" ))
				then	WriteToFile( "%0.3f,", ExDHWSys2:DHWHeater[6]:DHWStandbyLossFrac  )
				else	WriteToFile( "," )  endif endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW6 HPWH Make & Model"	   Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[6] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( DHWSys2:DHWHeater[6]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( DHWSys2:DHWHeater[6]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( DHWSys2:DHWHeater[6]:HPWHBrand ),
				                                     EnumString( DHWSys2:DHWHeater[6]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( AltDHWSys2:DHWHeater[6]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( AltDHWSys2:DHWHeater[6]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( AltDHWSys2:DHWHeater[6]:HPWHBrand ),
				                                     EnumString( AltDHWSys2:DHWHeater[6]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[6]:IsNEEAHtPumpWtrHtr > 0 ) .AND.
                      IfValidAnd( ExDHWSys2:DHWHeater[6]:HPWHBrand > 2 ) .AND.
				          IfValidAnd( ExDHWSys2:DHWHeater[6]:HPWHModel > 1 ))
				      then  WriteToFile( "%s / %s,", EnumString( ExDHWSys2:DHWHeater[6]:HPWHBrand ),
				                                     EnumString( ExDHWSys2:DHWHeater[6]:HPWHModel ) )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW6 Tank Location"	   Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[6] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[6]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( DHWSys2:DHWHeater[6]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( DHWSys2:DHWHeater[6]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", DHWSys2:DHWHeater[6]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[6]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( AltDHWSys2:DHWHeater[6]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( AltDHWSys2:DHWHeater[6]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", AltDHWSys2:DHWHeater[6]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[6]:ShowTankLocation > 0 ))
				      then  if (IfValidAnd( ExDHWSys2:DHWHeater[6]:TankOutside > 0.5 ))
				            then  WriteToFile( "outside," )
				            else if (LocalCompAssigned( ExDHWSys2:DHWHeater[6]:TankZone ) < 1)
				            then  WriteToFile( "unknown," )
				            else  WriteToFile( "%s,", ExDHWSys2:DHWHeater[6]:TankZone:Name )
				            endif endif
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW6 Rated Flow"	   Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[6] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[6]:HeaterType = 10 ) .OR.
				          IfValidAnd( DHWSys2:DHWHeater[6]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", DHWSys2:DHWHeater[6]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else 	WriteToFile( "," )  endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[6]:HeaterType = 10 ) .OR.
				          IfValidAnd( AltDHWSys2:DHWHeater[6]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", AltDHWSys2:DHWHeater[6]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[6]:HeaterType = 10 ) .OR.
				          IfValidAnd( ExDHWSys2:DHWHeater[6]:HeaterType = 15 ))
				      then  WriteToFile( "%g,", ExDHWSys2:DHWHeater[6]:RatedFlow )
				      else  WriteToFile( "," )
				      endif
				else	WriteToFile( "," )  endif
			else UNCHANGED endif endif endif }                                                

   "Write DHWSys2 DHW6 First Hour Rating & Recovery Efficiency"	   Zone:Action = {
         if ( IfValidAnd( DHWSys2:HeaterMultFlt[6] > 0.001 ) ) then  
				if (LocalCompAssigned( DHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( DHWSys2:DHWHeater[6]:HeaterType = 12 ) .OR.
				          IfValidAnd( DHWSys2:DHWHeater[6]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( DHWSys2:DHWHeater[6]:FirstHourRating, -1 ),
				                                   ValidOr( DHWSys2:DHWHeater[6]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else 	WriteToFile( ",," )  endif
			else if ( IfValidAnd( AltDHWSys2:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( AltDHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( AltDHWSys2:DHWHeater[6]:HeaterType = 12 ) .OR.
				          IfValidAnd( AltDHWSys2:DHWHeater[6]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( AltDHWSys2:DHWHeater[6]:FirstHourRating, -1 ),
				                                   ValidOr( AltDHWSys2:DHWHeater[6]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else	WriteToFile( ",," )  endif
			else if ( IfValidAnd( ExDHWSys2:HeaterMultFlt[6] > 0.001 ) ) then 
				if (LocalCompAssigned( ExDHWSys2:DHWHeater[6] ) == ComponentType( "DHWHeater" ))
				then	if (IfValidAnd( ExDHWSys2:DHWHeater[6]:HeaterType = 12 ) .OR.
				          IfValidAnd( ExDHWSys2:DHWHeater[6]:HeaterType = 14 ))
				      then  WriteToFile( "%g,%g,", ValidOr( ExDHWSys2:DHWHeater[6]:FirstHourRating, -1 ),
				                                   ValidOr( ExDHWSys2:DHWHeater[6]:RecovEff, -1 ) )
				      else  WriteToFile( ",," )
				      endif
				else	WriteToFile( ",," )  endif
			else UNCHANGED endif endif endif }


   "Write blank line"				Zone:Action = { WriteToFile( "\n" )	}
END

;*************************************************************************
RULELIST  "HVACSys_Data_Report" 0 0 0 1
;*************************************************************************
;	mjb	mods to work with new HVACSys - multiple Heat, Cool and Heat Pump objects	9/12/13
   "Write HVACSys Name"						HVACSys:Action = {   if ( FloorAreaServed > 0.5 )then WriteToFile( ",%c%s%c,", 34, HVACSys:Name, 34 ) else UNCHANGED endif	}
   "Write HVACSys Status"					HVACSys:Action = {   if ( FloorAreaServed > 0.5 )then WriteToFile( "%s,", EnumString( HVACSys:Status ) ) else UNCHANGED endif   }
   "Write HVACSys Type"						HVACSys:Action = {   if ( FloorAreaServed > 0.5 )then WriteToFile( "%s,", HVACSys:TypeAbbrevStr ) else UNCHANGED endif   }
;   "Write HVACSys Heat Capacity"		HVACSys:Action = {   if ( FloorAreaServed > 0.5 )then WriteToFile( "%0.3f,", HeatSystem:TotalCapacity ) else UNCHANGED endif   }
;   "Write HVACSys Cool Capacity"		HVACSys:Action = {   if ( FloorAreaServed > 0.5 )then WriteToFile( "%0.3f,", CoolSystem:TotalCapacity ) else UNCHANGED endif   }
;   "Write HVACSys Ducted flag"			HVACSys:Action = {   if ( FloorAreaServed > 0.5 )then 
;																					if (HeatSystem:Ducted > 0.5 .OR. CoolSystem:Ducted > 0.5 ) then  
;								  														WriteToFile( "%c%s%c,\n",	34, "Yes" , 34  )
;								  													else  WriteToFile( "%c%s%c,\n",	34, "No" , 34 )  
;								  													endif  
;																				else UNCHANGED endif }                                                

   ; SAC 11/14/17 - revisions to report "3.413 HSPF" for Electric heating systems (tic #926)
   ; SAC 11/28/17 - revisions to report "3.413 HSPF" for ElecCombHydro heating systems (tic #910)
   "Write column headings for HeatSystem Data"	HVACSys:Action = {
         if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then 
            if ( Type == 2 .AND. HaveHtPump ) then  WriteToFile( "\n,,Heat Pump (Heating):, Type, HSPF, Cap47, Cap 17, Aux. Htg. Capacity, Ducted,\n" )
            else if (HeatSysType = 8 .OR.       ; Electric heating
                     HeatSysTypeAbbrev = "ElecCombHydro")
            then  WriteToFile( "\n,,Heating System:, Type, HSPF, Ducted,\n" )
            else	WriteToFile( "\n,,Heating System:, Type, AFUE, Ducted,\n" ) endif endif
         else UNCHANGED endif }
; global mods to handle 'smf' (StdMixedFuel) the same way we handle 's' (Std) models - SAC 1/17/18
; [1] HVACHeat/HtPump object
   "Write HVACHeat/HtPump Name"			HVACSys:Action = {  if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																						if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( ",,%c%s%c,", 34, HtPumpSystem[1]:Name, 34 )
																						else WriteToFile( ",,%c%s%c,", 34, HeatSystem[1]:Name, 34 )endif
								        									  		else UNCHANGED endif
								        									  	else UNCHANGED endif} 
   "Write HVACHeat/HtPump Type"			HVACSys:Action = {  if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then 
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																						if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%s,", HtPumpSystem[1]:TypeAbbrevStr )
																						else WriteToFile( "%s,", HeatSystem[1]:TypeAbbrevStr )endif 
																					else WriteToFile( ",,,%s,", EnumString(StdHeatingType) ) endif
																			  else UNCHANGED endif  }
; "Dbg-1"		HVACSys:Action	= {	if ( HaveHeating < 0.5 .OR. FloorAreaServed < 0.5 .OR. Type != 2 ) then  UNCHANGED
; 											else  MessageBox( "RunNumber=%g, HaveHtPump=%g, HtPumpSystem[1]:HSPF=%g, HeatSystem[1]:AFUE=%g, HtSysAFUE=%g", Proj:RunNumber, HaveHtPump, HtPumpSystem[1]:HSPF, HeatSystem[1]:AFUE, HtSysAFUE )  endif  }
   ; SAC 11/14/17 - revisions to report "3.413 HSPF" for Electric heating systems (tic #926)
   ; SAC 11/28/17 - revisions to report "3.413 HSPF" for ElecCombHydro heating systems (tic #910)
   "Write HVACHeat/HtPump Heating Efficiency"	HVACSys:Action = {
         if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then 
            if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
               if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%0.3f,", HtPumpSystem[1]:HSPF ) 
               else if (HeatSysType = 8 .OR.    ; Electric heating
                        HeatSysTypeAbbrev = "ElecCombHydro")
               then  WriteToFile( "3.413," )
               else	WriteToFile( "%0.3f,", HeatSystem[1]:AFUE ) endif endif
            else
               if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%0.3f,", HPSysHSPF ) 
               else if (HeatSysType = 8 .OR.    ; Electric heating
                        HeatSysTypeAbbrev = "ElecCombHydro")
               then  WriteToFile( "3.413," )
               else	WriteToFile( "%0.3f,", HtSysAFUE ) endif endif
            endif
         else UNCHANGED endif }
   "Write HVACHtPump Cap47"			HVACSys:Action = {  if ( Type == 2 .AND. HaveHtPump .AND. FloorAreaServed > 0.5  ) then  
   																			if (HPSysAutoSize)
   																			then  WriteToFile( "autosize," ) 
   																			else if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" )
   																			then  WriteToFile( "%0.3f,", HtPumpSystem[1]:Cap47 ) 
																				else WriteToFile( "%0.3f,", HPSysCap47 ) endif endif
																		  else UNCHANGED endif }
   "Write HVACHtPump Cap17"			HVACSys:Action = {   if ( Type == 2 .AND. HaveHtPump .AND. FloorAreaServed > 0.5  ) then  
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
   																				WriteToFile( "%0.3f,", HtPumpSystem[1]:Cap17 ) 
																				else WriteToFile( "%0.3f,", HPSysCap17 ) endif
																			else UNCHANGED endif }
   "Write HVACHtPump AuxHtgCap"		HVACSys:Action = {   if ( Type == 2 .AND. HaveHtPump .AND. FloorAreaServed > 0.5  ) then  
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
   																				WriteToFile( "%0.3f,", HtPumpSystem[1]:AuxHtgCap )
																				else WriteToFile( "%0.3f,", HPSysAuxHtgCap ) endif
																			else UNCHANGED endif }
   "Write HVACHtPump Ducted flag"		HVACSys:Action = {   if ( HaveHeating .AND. FloorAreaServed > 0.5 ) then
																					if ( HeatDucted )then  WriteToFile( "%c%s%c,\n",	34, "Yes" , 34  )
								  													else  WriteToFile( "%c%s%c,\n",	34, "No" , 34 ) endif  
																				else UNCHANGED endif }                                                
   "Write HVACHeaT/HtPump CHRecoveryEff"	HVACSys:Action = {   if ( HaveHeating .AND. FloorAreaServed > 0.5 ) then 
   																					if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																							if ( Type == 2 .AND. HaveHtPump ) then UNCHANGED else
																								if ( HeatSystem[1]:Type == 9 .AND. IfValidAnd( HeatSystem[1]:CHWHeater:HeaterElementType = 0 )==0) 
																								then WriteToFile( ",Combined Hydronic Recovery Efficiency:,%0.2f,", HeatSystem[1]:CHRecoveryEff ) 
																								else UNCHANGED endif 
																							endif
																						else UNCHANGED endif 
																					else UNCHANGED endif }
; [2] HVACHeat/HtPump object
   "Write HVACHeat/HtPump Name"			HVACSys:Action = {  if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then 
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																						if ( Type == 2 .AND. HtPumpSystem[2]:FloorAreaServed > 0.5 ) then WriteToFile( ",,%c%s%c,", 34, HtPumpSystem[2]:Name, 34 )
																							else if ( HeatSystem[2]:FloorAreaServed > 0.5 ) then WriteToFile( ",,%c%s%c,", 34, HeatSystem[2]:Name, 34 ) else UNCHANGED endif
																						endif
																					else UNCHANGED endif
								        									  else UNCHANGED endif } 
   "Write HVACHeat/HtPump Type"			HVACSys:Action = {  if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then 
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																						if ( Type == 2 .AND. HtPumpSystem[2]:FloorAreaServed > 0.5 ) then WriteToFile( "%s,", HtPumpSystem[2]:TypeAbbrevStr )
																							else if ( HeatSystem[2]:FloorAreaServed > 0.5 ) then WriteToFile( "%s,", HeatSystem[2]:TypeAbbrevStr ) else UNCHANGED endif
																						endif 
								        									  		else UNCHANGED endif 
																				else UNCHANGED endif  }
   "Write HVACHeat/HtPump Heating Efficiency"	HVACSys:Action = {  if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then 
   																							if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																									if ( Type == 2 .AND. HtPumpSystem[2]:FloorAreaServed > 0.5 ) then WriteToFile( "%0.3f,", HtPumpSystem[2]:HSPF ) 
   																									else if ( HeatSystem[2]:FloorAreaServed > 0.5 .AND. (HeatSysType = 8 .OR. HeatSysTypeAbbrev = "ElecCombHydro")) then  WriteToFile( "3.413," )     ; Electric heating
																										else if ( HeatSystem[2]:FloorAreaServed > 0.5 ) then	WriteToFile( "%0.3f,", HeatSystem[2]:AFUE ) else UNCHANGED endif endif
																									endif 
								        									  					else UNCHANGED endif 
																						  else UNCHANGED endif }
   "Write HVACHtPump Cap47"			HVACSys:Action = {  if ( Type == 2 .AND. FloorAreaServed > 0.5 .AND. HtPumpSystem[2]:FloorAreaServed > 0.5 ) then  
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
   																				WriteToFile( "%0.3f,", HtPumpSystem[2]:Cap47 ) 
																				else UNCHANGED endif
																		  else UNCHANGED endif }
   "Write HVACHtPump Cap17"			HVACSys:Action = {   if ( Type == 2 .AND. HaveHtPump .AND. FloorAreaServed > 0.5 .AND. HtPumpSystem[2]:FloorAreaServed > 0.5 ) then  
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
   																				WriteToFile( "%0.3f,", HtPumpSystem[2]:Cap17 ) 
																				else UNCHANGED endif
																			else UNCHANGED endif }
   "Write HVACHtPump AuxHtgCap"			HVACSys:Action = {   if ( Type == 2 .AND. HaveHtPump .AND. FloorAreaServed > 0.5 .AND. HtPumpSystem[2]:FloorAreaServed > 0.5 ) then  
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
   																					WriteToFile( "%0.3f,", HtPumpSystem[2]:AuxHtgCap )
																					else UNCHANGED endif
																				else UNCHANGED endif }
   "Write HVACHtPump Ducted flag"		HVACSys:Action = {   if ( HaveHeating .AND. FloorAreaServed > 0.5 ) then
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																						if ( HeatSystem[2]:FloorAreaServed > 0.5 .OR. HtPumpSystem[2]:FloorAreaServed > 0.5 ) then
																							if ( HeatDucted )	then  WriteToFile( "%c%s%c,\n",	34, "Yes" , 34  )
								  															else  WriteToFile( "%c%s%c,\n",	34, "No" , 34 )  endif 
										 												else UNCHANGED endif 
										 											else UNCHANGED endif 
																				else UNCHANGED endif }                                                
   "Write HVACHeat/HtPump CHRecoveryEff"	HVACSys:Action = {   if ( HaveHeating .AND. FloorAreaServed > 0.5 ) then 
   																					if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																							if ( Type == 2 .AND. HaveHtPump ) then UNCHANGED else
																								if ( HeatSystem[2]:Type == 9 .AND. HeatSystem[2]:FloorAreaServed > 0.5 .AND. IfValidAnd( HeatSystem[2]:CHWHeater:HeaterElementType = 0 )==0) 
																								then WriteToFile( ",Combined Hydronic Recovery Efficiency:,%0.2f,", HeatSystem[2]:CHRecoveryEff ) 
																								else UNCHANGED endif 
																							endif
																						else UNCHANGED endif 
																					else UNCHANGED endif }

; [3] HVACHeat/HtPump object
   "Write HVACHeat/HtPump Name"			HVACSys:Action = {  if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then 
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																						if ( Type == 2 .AND. HtPumpSystem[3]:FloorAreaServed > 0.5 ) then WriteToFile( ",,%c%s%c,", 34, HtPumpSystem[3]:Name, 34 )
																							else if ( HeatSystem[3]:FloorAreaServed > 0.5 ) then WriteToFile( ",,%c%s%c,", 34, HeatSystem[3]:Name, 34 ) else UNCHANGED endif
																						endif
																					else UNCHANGED endif
								        									  else UNCHANGED endif } 
   "Write HVACHeat/HtPump Type"			HVACSys:Action = {  if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then 
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																						if ( Type == 2 .AND. HtPumpSystem[3]:FloorAreaServed > 0.5 ) then WriteToFile( "%s,", HtPumpSystem[3]:TypeAbbrevStr )
																							else if ( HeatSystem[3]:FloorAreaServed > 0.5 ) then WriteToFile( "%s,", HeatSystem[3]:TypeAbbrevStr ) else UNCHANGED endif
																						endif 
								        									  		else UNCHANGED endif 
																				else UNCHANGED endif  }
   "Write HVACHeat/HtPump Heating Efficiency"	HVACSys:Action = {  if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then 
   																							if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																									if ( Type == 2 .AND. HtPumpSystem[3]:FloorAreaServed > 0.5 ) then WriteToFile( "%0.3f,", HtPumpSystem[3]:HSPF ) 
   																									else if ( HeatSystem[3]:FloorAreaServed > 0.5 .AND. (HeatSysType = 8 .OR. HeatSysTypeAbbrev = "ElecCombHydro")) then  WriteToFile( "3.413," )     ; Electric heating
																										else if ( HeatSystem[3]:FloorAreaServed > 0.5 ) then	WriteToFile( "%0.3f,", HeatSystem[3]:AFUE ) else UNCHANGED endif endif
																									endif 
								        									  					else UNCHANGED endif 
																						  else UNCHANGED endif }
   "Write HVACHtPump Cap47"			HVACSys:Action = {  if ( Type == 2 .AND. FloorAreaServed > 0.5 .AND. HtPumpSystem[3]:FloorAreaServed > 0.5 ) then  
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
   																				WriteToFile( "%0.3f,", HtPumpSystem[3]:Cap47 ) 
																				else UNCHANGED endif
																		  else UNCHANGED endif }
   "Write HVACHtPump Cap17"			HVACSys:Action = {   if ( Type == 2 .AND. HaveHtPump .AND. FloorAreaServed > 0.5 .AND. HtPumpSystem[3]:FloorAreaServed > 0.5 ) then  
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
   																				WriteToFile( "%0.3f,", HtPumpSystem[3]:Cap17 ) 
																				else UNCHANGED endif
																			else UNCHANGED endif }
   "Write HVACHtPump AuxHtgCap"			HVACSys:Action = {   if ( Type == 2 .AND. HaveHtPump .AND. FloorAreaServed > 0.5 .AND. HtPumpSystem[3]:FloorAreaServed > 0.5 ) then  
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
   																					WriteToFile( "%0.3f,", HtPumpSystem[3]:AuxHtgCap )
																					else UNCHANGED endif
																				else UNCHANGED endif }
   "Write HVACHtPump Ducted flag"		HVACSys:Action = {   if ( HaveHeating .AND. FloorAreaServed > 0.5 ) then
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																						if ( HeatSystem[3]:FloorAreaServed > 0.5 .OR. HtPumpSystem[3]:FloorAreaServed > 0.5 ) then
																							if ( HeatDucted )	then  WriteToFile( "%c%s%c,\n",	34, "Yes" , 34  )
								  															else  WriteToFile( "%c%s%c,\n",	34, "No" , 34 )  endif 
										 												else UNCHANGED endif 
										 											else UNCHANGED endif 
																				else UNCHANGED endif }                                                
   "Write HVACHeat/HtPump CHRecoveryEff"	HVACSys:Action = {   if ( HaveHeating .AND. FloorAreaServed > 0.5 ) then 
   																					if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																							if ( Type == 2 .AND. HaveHtPump ) then UNCHANGED else
																								if ( HeatSystem[3]:Type == 9 .AND. HeatSystem[3]:FloorAreaServed > 0.5 .AND. IfValidAnd( HeatSystem[3]:CHWHeater:HeaterElementType = 0 )==0) 
																								then WriteToFile( ",Combined Hydronic Recovery Efficiency:,%0.2f,", HeatSystem[3]:CHRecoveryEff ) 
																								else UNCHANGED endif 
																							endif
																						else UNCHANGED endif 
																					else UNCHANGED endif }

; [4] HVACHeat/HtPump object
   "Write HVACHeat/HtPump Name"			HVACSys:Action = {  if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then 
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																						if ( Type == 2 .AND. HtPumpSystem[4]:FloorAreaServed > 0.5 ) then WriteToFile( ",,%c%s%c,", 34, HtPumpSystem[4]:Name, 34 )
																							else if ( HeatSystem[4]:FloorAreaServed > 0.5 ) then WriteToFile( ",,%c%s%c,", 34, HeatSystem[4]:Name, 34 ) else UNCHANGED endif
																						endif
																					else UNCHANGED endif
								        									  else UNCHANGED endif } 
   "Write HVACHeat/HtPump Type"			HVACSys:Action = {  if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then 
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																						if ( Type == 2 .AND. HtPumpSystem[4]:FloorAreaServed > 0.5 ) then WriteToFile( "%s,", HtPumpSystem[4]:TypeAbbrevStr )
																							else if ( HeatSystem[4]:FloorAreaServed > 0.5 ) then WriteToFile( "%s,", HeatSystem[4]:TypeAbbrevStr ) else UNCHANGED endif
																						endif 
								        									  		else UNCHANGED endif 
																				else UNCHANGED endif  }
   "Write HVACHeat/HtPump Heating Efficiency"	HVACSys:Action = {  if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then 
   																							if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																									if ( Type == 2 .AND. HtPumpSystem[4]:FloorAreaServed > 0.5 ) then WriteToFile( "%0.3f,", HtPumpSystem[4]:HSPF ) 
   																									else if ( HeatSystem[4]:FloorAreaServed > 0.5 .AND. (HeatSysType = 8 .OR. HeatSysTypeAbbrev = "ElecCombHydro")) then  WriteToFile( "3.413," )     ; Electric heating
																										else if ( HeatSystem[4]:FloorAreaServed > 0.5 ) then	WriteToFile( "%0.3f,", HeatSystem[4]:AFUE ) else UNCHANGED endif endif
																									endif 
								        									  					else UNCHANGED endif 
																						  else UNCHANGED endif }
   "Write HVACHtPump Cap47"			HVACSys:Action = {  if ( Type == 2 .AND. FloorAreaServed > 0.5 .AND. HtPumpSystem[4]:FloorAreaServed > 0.5 ) then  
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
   																				WriteToFile( "%0.3f,", HtPumpSystem[4]:Cap47 ) 
																				else UNCHANGED endif
																		  else UNCHANGED endif }
   "Write HVACHtPump Cap17"			HVACSys:Action = {   if ( Type == 2 .AND. HaveHtPump .AND. FloorAreaServed > 0.5 .AND. HtPumpSystem[4]:FloorAreaServed > 0.5 ) then  
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
   																				WriteToFile( "%0.3f,", HtPumpSystem[4]:Cap17 ) 
																				else UNCHANGED endif
																			else UNCHANGED endif }
   "Write HVACHtPump AuxHtgCap"			HVACSys:Action = {   if ( Type == 2 .AND. HaveHtPump .AND. FloorAreaServed > 0.5 .AND. HtPumpSystem[4]:FloorAreaServed > 0.5 ) then  
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
   																					WriteToFile( "%0.3f,", HtPumpSystem[4]:AuxHtgCap )
																					else UNCHANGED endif
																				else UNCHANGED endif }
   "Write HVACHtPump Ducted flag"		HVACSys:Action = {   if ( HaveHeating .AND. FloorAreaServed > 0.5 ) then
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																						if ( HeatSystem[4]:FloorAreaServed > 0.5 .OR. HtPumpSystem[4]:FloorAreaServed > 0.5 ) then
																							if ( HeatDucted )	then  WriteToFile( "%c%s%c,\n",	34, "Yes" , 34  )
								  															else  WriteToFile( "%c%s%c,\n",	34, "No" , 34 )  endif 
										 												else UNCHANGED endif 
										 											else UNCHANGED endif 
																				else UNCHANGED endif }                                                
   "Write HVACHeat/HtPump CHRecoveryEff"	HVACSys:Action = {   if ( HaveHeating .AND. FloorAreaServed > 0.5 ) then 
   																					if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																							if ( Type == 2 .AND. HaveHtPump ) then UNCHANGED else
																								if ( HeatSystem[4]:Type == 9 .AND. HeatSystem[4]:FloorAreaServed > 0.5 .AND. IfValidAnd( HeatSystem[4]:CHWHeater:HeaterElementType = 0 )==0) 
																								then WriteToFile( ",Combined Hydronic Recovery Efficiency:,%0.2f,", HeatSystem[4]:CHRecoveryEff ) 
																								else UNCHANGED endif 
																							endif
																						else UNCHANGED endif 
																					else UNCHANGED endif }

; [5] HVACHeat/HtPump object
   "Write HVACHeat/HtPump Name"			HVACSys:Action = {  if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then 
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																						if ( Type == 2 .AND. HtPumpSystem[5]:FloorAreaServed > 0.5 ) then WriteToFile( ",,%c%s%c,", 34, HtPumpSystem[5]:Name, 34 )
																							else if ( HeatSystem[5]:FloorAreaServed > 0.5 ) then WriteToFile( ",,%c%s%c,", 34, HeatSystem[5]:Name, 34 ) else UNCHANGED endif
																						endif
																					else UNCHANGED endif
								        									  else UNCHANGED endif } 
   "Write HVACHeat/HtPump Type"			HVACSys:Action = {  if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then 
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																						if ( Type == 2 .AND. HtPumpSystem[5]:FloorAreaServed > 0.5 ) then WriteToFile( "%s,", HtPumpSystem[5]:TypeAbbrevStr )
																							else if ( HeatSystem[5]:FloorAreaServed > 0.5 ) then WriteToFile( "%s,", HeatSystem[5]:TypeAbbrevStr ) else UNCHANGED endif
																						endif 
								        									  		else UNCHANGED endif 
																				else UNCHANGED endif  }
   "Write HVACHeat/HtPump Heating Efficiency"	HVACSys:Action = {  if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then 
   																							if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																									if ( Type == 2 .AND. HtPumpSystem[5]:FloorAreaServed > 0.5 ) then WriteToFile( "%0.3f,", HtPumpSystem[5]:HSPF ) 
   																									else if ( HeatSystem[5]:FloorAreaServed > 0.5 .AND. (HeatSysType = 8 .OR. HeatSysTypeAbbrev = "ElecCombHydro")) then  WriteToFile( "3.413," )     ; Electric heating
																										else if ( HeatSystem[5]:FloorAreaServed > 0.5 ) then	WriteToFile( "%0.3f,", HeatSystem[5]:AFUE ) else UNCHANGED endif endif
																									endif 
								        									  					else UNCHANGED endif 
																						  else UNCHANGED endif }
   "Write HVACHtPump Cap47"			HVACSys:Action = {  if ( Type == 2 .AND. FloorAreaServed > 0.5 .AND. HtPumpSystem[5]:FloorAreaServed > 0.5 ) then  
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
   																				WriteToFile( "%0.3f,", HtPumpSystem[5]:Cap47 ) 
																				else UNCHANGED endif
																		  else UNCHANGED endif }
   "Write HVACHtPump Cap17"			HVACSys:Action = {   if ( Type == 2 .AND. HaveHtPump .AND. FloorAreaServed > 0.5 .AND. HtPumpSystem[5]:FloorAreaServed > 0.5 ) then  
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
   																				WriteToFile( "%0.3f,", HtPumpSystem[5]:Cap17 ) 
																				else UNCHANGED endif
																			else UNCHANGED endif }
   "Write HVACHtPump AuxHtgCap"			HVACSys:Action = {   if ( Type == 2 .AND. HaveHtPump .AND. FloorAreaServed > 0.5 .AND. HtPumpSystem[5]:FloorAreaServed > 0.5 ) then  
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
   																					WriteToFile( "%0.3f,", HtPumpSystem[5]:AuxHtgCap )
																					else UNCHANGED endif
																				else UNCHANGED endif }
   "Write HVACHtPump Ducted flag"		HVACSys:Action = {   if ( HaveHeating .AND. FloorAreaServed > 0.5 ) then
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																						if ( HeatSystem[5]:FloorAreaServed > 0.5 .OR. HtPumpSystem[5]:FloorAreaServed > 0.5 ) then
																							if ( HeatDucted )	then  WriteToFile( "%c%s%c,\n",	34, "Yes" , 34  )
								  															else  WriteToFile( "%c%s%c,\n",	34, "No" , 34 )  endif 
										 												else UNCHANGED endif 
										 											else UNCHANGED endif 
																				else UNCHANGED endif }                                                
   "Write HVACHeat/HtPump CHRecoveryEff"	HVACSys:Action = {   if ( HaveHeating .AND. FloorAreaServed > 0.5 ) then 
   																					if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																							if ( Type == 2 .AND. HaveHtPump ) then UNCHANGED else
																								if ( HeatSystem[5]:Type == 9 .AND. HeatSystem[5]:FloorAreaServed > 0.5 .AND. IfValidAnd( HeatSystem[5]:CHWHeater:HeaterElementType = 0 )==0) 
																								then WriteToFile( ",Combined Hydronic Recovery Efficiency:,%0.2f,", HeatSystem[5]:CHRecoveryEff ) 
																								else UNCHANGED endif 
																							endif
																						else UNCHANGED endif 
																					else UNCHANGED endif }

; [6] HVACHeat/HtPump object
   "Write HVACHeat/HtPump Name"			HVACSys:Action = {  if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then 
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																						if ( Type == 2 .AND. HtPumpSystem[6]:FloorAreaServed > 0.5 ) then WriteToFile( ",,%c%s%c,", 34, HtPumpSystem[6]:Name, 34 )
																							else if ( HeatSystem[6]:FloorAreaServed > 0.5 ) then WriteToFile( ",,%c%s%c,", 34, HeatSystem[6]:Name, 34 ) else UNCHANGED endif
																						endif
																					else UNCHANGED endif
								        									  else UNCHANGED endif } 
   "Write HVACHeat/HtPump Type"			HVACSys:Action = {  if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then 
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																						if ( Type == 2 .AND. HtPumpSystem[6]:FloorAreaServed > 0.5 ) then WriteToFile( "%s,", HtPumpSystem[6]:TypeAbbrevStr )
																							else if ( HeatSystem[6]:FloorAreaServed > 0.5 ) then WriteToFile( "%s,", HeatSystem[6]:TypeAbbrevStr ) else UNCHANGED endif
																						endif 
								        									  		else UNCHANGED endif 
																				else UNCHANGED endif  }
   "Write HVACHeat/HtPump Heating Efficiency"	HVACSys:Action = {  if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then 
   																							if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																									if ( Type == 2 .AND. HtPumpSystem[6]:FloorAreaServed > 0.5 ) then WriteToFile( "%0.3f,", HtPumpSystem[6]:HSPF ) 
   																									else if ( HeatSystem[6]:FloorAreaServed > 0.5 .AND. (HeatSysType = 8 .OR. HeatSysTypeAbbrev = "ElecCombHydro")) then  WriteToFile( "3.413," )     ; Electric heating
																										else if ( HeatSystem[6]:FloorAreaServed > 0.5 ) then	WriteToFile( "%0.3f,", HeatSystem[6]:AFUE ) else UNCHANGED endif endif
																									endif 
								        									  					else UNCHANGED endif 
																						  else UNCHANGED endif }
   "Write HVACHtPump Cap47"			HVACSys:Action = {  if ( Type == 2 .AND. FloorAreaServed > 0.5 .AND. HtPumpSystem[6]:FloorAreaServed > 0.5 ) then  
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
   																				WriteToFile( "%0.3f,", HtPumpSystem[6]:Cap47 ) 
																				else UNCHANGED endif
																		  else UNCHANGED endif }
   "Write HVACHtPump Cap17"			HVACSys:Action = {   if ( Type == 2 .AND. HaveHtPump .AND. FloorAreaServed > 0.5 .AND. HtPumpSystem[6]:FloorAreaServed > 0.5 ) then  
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
   																				WriteToFile( "%0.3f,", HtPumpSystem[6]:Cap17 ) 
																				else UNCHANGED endif
																			else UNCHANGED endif }
   "Write HVACHtPump AuxHtgCap"			HVACSys:Action = {   if ( Type == 2 .AND. HaveHtPump .AND. FloorAreaServed > 0.5 .AND. HtPumpSystem[6]:FloorAreaServed > 0.5 ) then  
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
   																					WriteToFile( "%0.3f,", HtPumpSystem[6]:AuxHtgCap )
																					else UNCHANGED endif
																				else UNCHANGED endif }
   "Write HVACHtPump Ducted flag"		HVACSys:Action = {   if ( HaveHeating .AND. FloorAreaServed > 0.5 ) then
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																						if ( HeatSystem[6]:FloorAreaServed > 0.5 .OR. HtPumpSystem[6]:FloorAreaServed > 0.5 ) then
																							if ( HeatDucted )	then  WriteToFile( "%c%s%c,\n",	34, "Yes" , 34  )
								  															else  WriteToFile( "%c%s%c,\n",	34, "No" , 34 )  endif 
										 												else UNCHANGED endif 
										 											else UNCHANGED endif 
																				else UNCHANGED endif }                                                
   "Write HVACHeat/HtPump CHRecoveryEff"	HVACSys:Action = {   if ( HaveHeating .AND. FloorAreaServed > 0.5 ) then 
   																					if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																							if ( Type == 2 .AND. HaveHtPump ) then UNCHANGED else
																								if ( HeatSystem[6]:Type == 9 .AND. HeatSystem[6]:FloorAreaServed > 0.5 .AND. IfValidAnd( HeatSystem[6]:CHWHeater:HeaterElementType = 0 )==0) 
																								then WriteToFile( ",Combined Hydronic Recovery Efficiency:,%0.2f,", HeatSystem[6]:CHRecoveryEff ) 
																								else UNCHANGED endif 
																							endif
																						else UNCHANGED endif 
																					else UNCHANGED endif }

; [7] HVACHeat/HtPump object
   "Write HVACHeat/HtPump Name"			HVACSys:Action = {  if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then 
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																						if ( Type == 2 .AND. HtPumpSystem[7]:FloorAreaServed > 0.5 ) then WriteToFile( ",,%c%s%c,", 34, HtPumpSystem[7]:Name, 34 )
																							else if ( HeatSystem[7]:FloorAreaServed > 0.5 ) then WriteToFile( ",,%c%s%c,", 34, HeatSystem[7]:Name, 34 ) else UNCHANGED endif
																						endif
																					else UNCHANGED endif
								        									  else UNCHANGED endif } 
   "Write HVACHeat/HtPump Type"			HVACSys:Action = {  if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then 
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																						if ( Type == 2 .AND. HtPumpSystem[7]:FloorAreaServed > 0.5 ) then WriteToFile( "%s,", HtPumpSystem[7]:TypeAbbrevStr )
																							else if ( HeatSystem[7]:FloorAreaServed > 0.5 ) then WriteToFile( "%s,", HeatSystem[7]:TypeAbbrevStr ) else UNCHANGED endif
																						endif 
								        									  		else UNCHANGED endif 
																				else UNCHANGED endif  }
   "Write HVACHeat/HtPump Heating Efficiency"	HVACSys:Action = {  if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then 
   																							if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																									if ( Type == 2 .AND. HtPumpSystem[7]:FloorAreaServed > 0.5 ) then WriteToFile( "%0.3f,", HtPumpSystem[7]:HSPF ) 
   																									else if ( HeatSystem[7]:FloorAreaServed > 0.5 .AND. (HeatSysType = 8 .OR. HeatSysTypeAbbrev = "ElecCombHydro")) then  WriteToFile( "3.413," )     ; Electric heating
																										else if ( HeatSystem[7]:FloorAreaServed > 0.5 ) then	WriteToFile( "%0.3f,", HeatSystem[7]:AFUE ) else UNCHANGED endif endif
																									endif 
								        									  					else UNCHANGED endif 
																						  else UNCHANGED endif }
   "Write HVACHtPump Cap47"			HVACSys:Action = {  if ( Type == 2 .AND. FloorAreaServed > 0.5 .AND. HtPumpSystem[7]:FloorAreaServed > 0.5 ) then  
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
   																				WriteToFile( "%0.3f,", HtPumpSystem[7]:Cap47 ) 
																				else UNCHANGED endif
																		  else UNCHANGED endif }
   "Write HVACHtPump Cap17"			HVACSys:Action = {   if ( Type == 2 .AND. HaveHtPump .AND. FloorAreaServed > 0.5 .AND. HtPumpSystem[7]:FloorAreaServed > 0.5 ) then  
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
   																				WriteToFile( "%0.3f,", HtPumpSystem[7]:Cap17 ) 
																				else UNCHANGED endif
																			else UNCHANGED endif }
   "Write HVACHtPump AuxHtgCap"			HVACSys:Action = {   if ( Type == 2 .AND. HaveHtPump .AND. FloorAreaServed > 0.5 .AND. HtPumpSystem[7]:FloorAreaServed > 0.5 ) then  
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
   																					WriteToFile( "%0.3f,", HtPumpSystem[7]:AuxHtgCap )
																					else UNCHANGED endif
																				else UNCHANGED endif }
   "Write HVACHtPump Ducted flag"		HVACSys:Action = {   if ( HaveHeating .AND. FloorAreaServed > 0.5 ) then
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																						if ( HeatSystem[7]:FloorAreaServed > 0.5 .OR. HtPumpSystem[7]:FloorAreaServed > 0.5 ) then
																							if ( HeatDucted )	then  WriteToFile( "%c%s%c,\n",	34, "Yes" , 34  )
								  															else  WriteToFile( "%c%s%c,\n",	34, "No" , 34 )  endif 
										 												else UNCHANGED endif 
										 											else UNCHANGED endif 
																				else UNCHANGED endif }                                                
   "Write HVACHeat/HtPump CHRecoveryEff"	HVACSys:Action = {   if ( HaveHeating .AND. FloorAreaServed > 0.5 ) then 
   																					if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																							if ( Type == 2 .AND. HaveHtPump ) then UNCHANGED else
																								if ( HeatSystem[7]:Type == 9 .AND. HeatSystem[7]:FloorAreaServed > 0.5 .AND. IfValidAnd( HeatSystem[7]:CHWHeater:HeaterElementType = 0 )==0) 
																								then WriteToFile( ",Combined Hydronic Recovery Efficiency:,%0.2f,", HeatSystem[7]:CHRecoveryEff ) 
																								else UNCHANGED endif 
																							endif
																						else UNCHANGED endif 
																					else UNCHANGED endif }

; [8] HVACHeat/HtPump object
   "Write HVACHeat/HtPump Name"			HVACSys:Action = {  if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then 
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																						if ( Type == 2 .AND. HtPumpSystem[8]:FloorAreaServed > 0.5 ) then WriteToFile( ",,%c%s%c,", 34, HtPumpSystem[8]:Name, 34 )
																							else if ( HeatSystem[8]:FloorAreaServed > 0.5 ) then WriteToFile( ",,%c%s%c,", 34, HeatSystem[8]:Name, 34 ) else UNCHANGED endif
																						endif
																					else UNCHANGED endif
								        									  else UNCHANGED endif } 
   "Write HVACHeat/HtPump Type"			HVACSys:Action = {  if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then 
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																						if ( Type == 2 .AND. HtPumpSystem[8]:FloorAreaServed > 0.5 ) then WriteToFile( "%s,", HtPumpSystem[8]:TypeAbbrevStr )
																							else if ( HeatSystem[8]:FloorAreaServed > 0.5 ) then WriteToFile( "%s,", HeatSystem[8]:TypeAbbrevStr ) else UNCHANGED endif
																						endif 
								        									  		else UNCHANGED endif 
																				else UNCHANGED endif  }
   "Write HVACHeat/HtPump Heating Efficiency"	HVACSys:Action = {  if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then 
   																							if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																									if ( Type == 2 .AND. HtPumpSystem[8]:FloorAreaServed > 0.5 ) then WriteToFile( "%0.3f,", HtPumpSystem[8]:HSPF ) 
   																									else if ( HeatSystem[8]:FloorAreaServed > 0.5 .AND. (HeatSysType = 8 .OR. HeatSysTypeAbbrev = "ElecCombHydro")) then  WriteToFile( "3.413," )     ; Electric heating
																										else if ( HeatSystem[8]:FloorAreaServed > 0.5 ) then	WriteToFile( "%0.3f,", HeatSystem[8]:AFUE ) else UNCHANGED endif endif
																									endif 
								        									  					else UNCHANGED endif 
																						  else UNCHANGED endif }
   "Write HVACHtPump Cap47"			HVACSys:Action = {  if ( Type == 2 .AND. FloorAreaServed > 0.5 .AND. HtPumpSystem[8]:FloorAreaServed > 0.5 ) then  
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
   																				WriteToFile( "%0.3f,", HtPumpSystem[8]:Cap47 ) 
																				else UNCHANGED endif
																		  else UNCHANGED endif }
   "Write HVACHtPump Cap17"			HVACSys:Action = {   if ( Type == 2 .AND. HaveHtPump .AND. FloorAreaServed > 0.5 .AND. HtPumpSystem[8]:FloorAreaServed > 0.5 ) then  
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
   																				WriteToFile( "%0.3f,", HtPumpSystem[8]:Cap17 ) 
																				else UNCHANGED endif
																			else UNCHANGED endif }
   "Write HVACHtPump AuxHtgCap"			HVACSys:Action = {   if ( Type == 2 .AND. HaveHtPump .AND. FloorAreaServed > 0.5 .AND. HtPumpSystem[8]:FloorAreaServed > 0.5 ) then  
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
   																					WriteToFile( "%0.3f,", HtPumpSystem[8]:AuxHtgCap )
																					else UNCHANGED endif
																				else UNCHANGED endif }
   "Write HVACHtPump Ducted flag"		HVACSys:Action = {   if ( HaveHeating .AND. FloorAreaServed > 0.5 ) then
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																						if ( HeatSystem[8]:FloorAreaServed > 0.5 .OR. HtPumpSystem[8]:FloorAreaServed > 0.5 ) then
																							if ( HeatDucted )	then  WriteToFile( "%c%s%c,\n",	34, "Yes" , 34  )
								  															else  WriteToFile( "%c%s%c,\n",	34, "No" , 34 )  endif 
										 												else UNCHANGED endif 
										 											else UNCHANGED endif 
																				else UNCHANGED endif }                                                
   "Write HVACHeat/HtPump CHRecoveryEff"	HVACSys:Action = {   if ( HaveHeating .AND. FloorAreaServed > 0.5 ) then 
   																					if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																							if ( Type == 2 .AND. HaveHtPump ) then UNCHANGED else
																								if ( HeatSystem[8]:Type == 9 .AND. HeatSystem[8]:FloorAreaServed > 0.5 .AND. IfValidAnd( HeatSystem[8]:CHWHeater:HeaterElementType = 0 )==0) 
																								then WriteToFile( ",Combined Hydronic Recovery Efficiency:,%0.2f,", HeatSystem[8]:CHRecoveryEff ) 
																								else UNCHANGED endif 
																							endif
																						else UNCHANGED endif 
																					else UNCHANGED endif }

; [9] HVACHeat/HtPump object
   "Write HVACHeat/HtPump Name"			HVACSys:Action = {  if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then 
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																						if ( Type == 2 .AND. HtPumpSystem[9]:FloorAreaServed > 0.5 ) then WriteToFile( ",,%c%s%c,", 34, HtPumpSystem[9]:Name, 34 )
																							else if ( HeatSystem[9]:FloorAreaServed > 0.5 ) then WriteToFile( ",,%c%s%c,", 34, HeatSystem[9]:Name, 34 ) else UNCHANGED endif
																						endif
																					else UNCHANGED endif
								        									  else UNCHANGED endif } 
   "Write HVACHeat/HtPump Type"			HVACSys:Action = {  if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then 
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																						if ( Type == 2 .AND. HtPumpSystem[9]:FloorAreaServed > 0.5 ) then WriteToFile( "%s,", HtPumpSystem[9]:TypeAbbrevStr )
																							else if ( HeatSystem[9]:FloorAreaServed > 0.5 ) then WriteToFile( "%s,", HeatSystem[9]:TypeAbbrevStr ) else UNCHANGED endif
																						endif 
								        									  		else UNCHANGED endif 
																				else UNCHANGED endif  }
   "Write HVACHeat/HtPump Heating Efficiency"	HVACSys:Action = {  if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then 
   																							if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																									if ( Type == 2 .AND. HtPumpSystem[9]:FloorAreaServed > 0.5 ) then WriteToFile( "%0.3f,", HtPumpSystem[9]:HSPF ) 
   																									else if ( HeatSystem[9]:FloorAreaServed > 0.5 .AND. (HeatSysType = 8 .OR. HeatSysTypeAbbrev = "ElecCombHydro")) then  WriteToFile( "3.413," )     ; Electric heating
																										else if ( HeatSystem[9]:FloorAreaServed > 0.5 ) then	WriteToFile( "%0.3f,", HeatSystem[9]:AFUE ) else UNCHANGED endif endif
																									endif 
								        									  					else UNCHANGED endif 
																						  else UNCHANGED endif }
   "Write HVACHtPump Cap47"			HVACSys:Action = {  if ( Type == 2 .AND. FloorAreaServed > 0.5 .AND. HtPumpSystem[9]:FloorAreaServed > 0.5 ) then  
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
   																				WriteToFile( "%0.3f,", HtPumpSystem[9]:Cap47 ) 
																				else UNCHANGED endif
																		  else UNCHANGED endif }
   "Write HVACHtPump Cap17"			HVACSys:Action = {   if ( Type == 2 .AND. HaveHtPump .AND. FloorAreaServed > 0.5 .AND. HtPumpSystem[9]:FloorAreaServed > 0.5 ) then  
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
   																				WriteToFile( "%0.3f,", HtPumpSystem[9]:Cap17 ) 
																				else UNCHANGED endif
																			else UNCHANGED endif }
   "Write HVACHtPump AuxHtgCap"			HVACSys:Action = {   if ( Type == 2 .AND. HaveHtPump .AND. FloorAreaServed > 0.5 .AND. HtPumpSystem[9]:FloorAreaServed > 0.5 ) then  
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
   																					WriteToFile( "%0.3f,", HtPumpSystem[9]:AuxHtgCap )
																					else UNCHANGED endif
																				else UNCHANGED endif }
   "Write HVACHtPump Ducted flag"		HVACSys:Action = {   if ( HaveHeating .AND. FloorAreaServed > 0.5 ) then
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																						if ( HeatSystem[9]:FloorAreaServed > 0.5 .OR. HtPumpSystem[9]:FloorAreaServed > 0.5 ) then
																							if ( HeatDucted )	then  WriteToFile( "%c%s%c,\n",	34, "Yes" , 34  )
								  															else  WriteToFile( "%c%s%c,\n",	34, "No" , 34 )  endif 
										 												else UNCHANGED endif 
										 											else UNCHANGED endif 
																				else UNCHANGED endif }                                                
   "Write HVACHeat/HtPump CHRecoveryEff"	HVACSys:Action = {   if ( HaveHeating .AND. FloorAreaServed > 0.5 ) then 
   																					if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																							if ( Type == 2 .AND. HaveHtPump ) then UNCHANGED else
																								if ( HeatSystem[9]:Type == 9 .AND. HeatSystem[9]:FloorAreaServed > 0.5 .AND. IfValidAnd( HeatSystem[9]:CHWHeater:HeaterElementType = 0 )==0) 
																								then WriteToFile( ",Combined Hydronic Recovery Efficiency:,%0.2f,", HeatSystem[9]:CHRecoveryEff ) 
																								else UNCHANGED endif 
																							endif
																						else UNCHANGED endif 
																					else UNCHANGED endif }

; [10] HVACHeat/HtPump object
   "Write HVACHeat/HtPump Name"			HVACSys:Action = {  if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then 
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																						if ( Type == 2 .AND. HtPumpSystem[10]:FloorAreaServed > 0.5 ) then WriteToFile( ",,%c%s%c,", 34, HtPumpSystem[10]:Name, 34 )
																							else if ( HeatSystem[10]:FloorAreaServed > 0.5 ) then WriteToFile( ",,%c%s%c,", 34, HeatSystem[10]:Name, 34 ) else UNCHANGED endif
																						endif
																					else UNCHANGED endif
								        									  else UNCHANGED endif } 
   "Write HVACHeat/HtPump Type"			HVACSys:Action = {  if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then 
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																						if ( Type == 2 .AND. HtPumpSystem[10]:FloorAreaServed > 0.5 ) then WriteToFile( "%s,", HtPumpSystem[10]:TypeAbbrevStr )
																							else if ( HeatSystem[10]:FloorAreaServed > 0.5 ) then WriteToFile( "%s,", HeatSystem[10]:TypeAbbrevStr ) else UNCHANGED endif
																						endif 
								        									  		else UNCHANGED endif 
																				else UNCHANGED endif  }
   "Write HVACHeat/HtPump Heating Efficiency"	HVACSys:Action = {  if ( HaveHeating .AND. FloorAreaServed > 0.5  ) then 
   																							if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																									if ( Type == 2 .AND. HtPumpSystem[10]:FloorAreaServed > 0.5 ) then WriteToFile( "%0.3f,", HtPumpSystem[10]:HSPF ) 
   																									else if ( HeatSystem[10]:FloorAreaServed > 0.5 .AND. (HeatSysType = 8 .OR. HeatSysTypeAbbrev = "ElecCombHydro")) then  WriteToFile( "3.413," )     ; Electric heating
																										else if ( HeatSystem[10]:FloorAreaServed > 0.5 ) then	WriteToFile( "%0.3f,", HeatSystem[10]:AFUE ) else UNCHANGED endif endif
																									endif 
								        									  					else UNCHANGED endif 
																						  else UNCHANGED endif }
   "Write HVACHtPump Cap47"			HVACSys:Action = {  if ( Type == 2 .AND. FloorAreaServed > 0.5 .AND. HtPumpSystem[10]:FloorAreaServed > 0.5 ) then  
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
   																				WriteToFile( "%0.3f,", HtPumpSystem[10]:Cap47 ) 
																				else UNCHANGED endif
																		  else UNCHANGED endif }
   "Write HVACHtPump Cap17"			HVACSys:Action = {   if ( Type == 2 .AND. HaveHtPump .AND. FloorAreaServed > 0.5 .AND. HtPumpSystem[10]:FloorAreaServed > 0.5 ) then  
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
   																				WriteToFile( "%0.3f,", HtPumpSystem[10]:Cap17 ) 
																				else UNCHANGED endif
																			else UNCHANGED endif }
   "Write HVACHtPump AuxHtgCap"			HVACSys:Action = {   if ( Type == 2 .AND. HaveHtPump .AND. FloorAreaServed > 0.5 .AND. HtPumpSystem[10]:FloorAreaServed > 0.5 ) then  
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
   																					WriteToFile( "%0.3f,", HtPumpSystem[10]:AuxHtgCap )
																					else UNCHANGED endif
																				else UNCHANGED endif }
   "Write HVACHtPump Ducted flag"		HVACSys:Action = {   if ( HaveHeating .AND. FloorAreaServed > 0.5 ) then
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																						if ( HeatSystem[10]:FloorAreaServed > 0.5 .OR. HtPumpSystem[10]:FloorAreaServed > 0.5 ) then
																							if ( HeatDucted )	then  WriteToFile( "%c%s%c,\n",	34, "Yes" , 34  )
								  															else  WriteToFile( "%c%s%c,\n",	34, "No" , 34 )  endif 
										 												else UNCHANGED endif 
										 											else UNCHANGED endif 
																				else UNCHANGED endif }                                                
   "Write HVACHeat/HtPump CHRecoveryEff"	HVACSys:Action = {   if ( HaveHeating .AND. FloorAreaServed > 0.5 ) then 
   																					if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																							if ( Type == 2 .AND. HaveHtPump ) then UNCHANGED else
																								if ( HeatSystem[10]:Type == 9 .AND. HeatSystem[10]:FloorAreaServed > 0.5 .AND. IfValidAnd( HeatSystem[10]:CHWHeater:HeaterElementType = 0 )==0) 
																								then WriteToFile( ",Combined Hydronic Recovery Efficiency:,%0.2f,", HeatSystem[10]:CHRecoveryEff ) 
																								else UNCHANGED endif 
																							endif
																						else UNCHANGED endif 
																					else UNCHANGED endif }

   "Write column headings for CoolSystem Data"	HVACSys:Action =     ; SAC 09/16/22 (tic #1331)
      {  if ( HaveCooling .AND. FloorAreaServed > 0.5  )
         then  if ( Type == 2 .AND. HaveHtPump )
               then  if (EffMetric < 2)
                     then  WriteToFile( "\n,,Heat Pump (Cooling):, Type, SEER, EER, CFM/Ton, AC Charge, Ducted,\n" )
                     else  WriteToFile( "\n,,Heat Pump (Cooling):, Type, SEER2, EER2, CFM/Ton, AC Charge, Ducted,\n" )  endif
					else  if (EffMetric < 2)
                     then  WriteToFile( "\n,,Cooling System:, Type, SEER, EER, CFM/Ton, AC Charge, Ducted,\n" )
                     else  WriteToFile( "\n,,Cooling System:, Type, SEER2, EER2, CFM/Ton, AC Charge, Ducted,\n" )  endif
					endif
			else UNCHANGED endif  }

   ; copy of rule setting HVACSys:NoCoolingRpt to ensure it is set prior to being referenced below (tic #947) - SAC 1/3/18
	"Check for No Cooling in HVACSys" 	HVACSys:NoCoolingRpt = { if ( IfValidAnd( CoolSystem:Type < 2 ) .AND. IfValidAnd( NumHtPumpSystemTypes < 1 ) .AND. IfValidAnd( FloorAreaServed > 0.5 ) ) then 1 else 0 endif }

; [1] HVACCool/HtPump object
   ; SAC 5/10/19 - rule revisions to avoid evaluation errors when heatpump system invalid due to missing capacities
   "Write HVACCool Name"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5  ) then
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																				if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( ",,%c%s%c,", 34, HtPumpSystem[1]:Name, 34 )
																				else if (Type != 2 .AND. LocalCompAssigned( CoolSystem[1] )) then WriteToFile( ",,%c%s%c,", 34, CoolSystem[1]:Name, 34 )
																				else WriteToFile( ",,%c<unknown>%c,", 34, 34 ) endif endif
																			else UNCHANGED endif
																	  else UNCHANGED endif  }
   "Write HVACCool Type"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5  ) then
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																				if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%s,", HtPumpSystem[1]:TypeAbbrevStr )
																				else 
																					if ( NoCoolingRpt < 0.5 .AND. LocalCompAssigned( CoolSystem[1] ) ) then WriteToFile( "%s,", CoolSystem[1]:TypeAbbrevStr )
																					else WriteToFile( "%s,", "No Cooling" )	endif endif
																			else WriteToFile( ",,,%s,", EnumString(StdCoolingType) ) endif
																	  else UNCHANGED endif  }
   "Write HVACCool SEER"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5  ) then 
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																				if ( Type == 2 .AND. HaveHtPump ) 
                                                            then  if (EffMetric < 2)
                                                                  then  WriteToFile( "%0.3f,", HtPumpSystem[1]:SEER )
                                                                  else  WriteToFile( "%0.3f,", HtPumpSystem[1]:SEER2 )  endif
																				else if ( NoCoolingRpt < 0.5 )
                                                            then  if (EffMetric < 2)
                                                                  then  WriteToFile( "%0.3f,", CoolSystem[1]:SEER )
                                                                  else  WriteToFile( "%0.3f,", CoolSystem[1]:SEER2 )  endif
                                                            else  WriteToFile( "%s,", "NA" ) endif endif
																			else  if (EffMetric < 2)
                                                               then  WriteToFile( "%0.3f,", ClSysSEER ) 
                                                               else  WriteToFile( "%0.3f,", ClSysSEER2 )  endif  endif
																	  else UNCHANGED endif  }     ; SAC 09/16/22 (tic #1331)
   "Write HVACCool EER"				HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5  ) then 
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
									 											if ( Type == 2 .AND. HaveHtPump )
                                                            then  if (EffMetric < 2)
                                                                  then  WriteToFile( "%0.3f,", HtPumpSystem[1]:EER )
                                                                  else  WriteToFile( "%0.3f,", HtPumpSystem[1]:EER2 )  endif
																				else if ( NoCoolingRpt < 0.5 )
                                                            then  if (EffMetric < 2)
                                                                  then  WriteToFile( "%0.3f,", CoolSystem[1]:EER )
                                                                  else  WriteToFile( "%0.3f,", CoolSystem[1]:EER2 )  endif
                                                            else  WriteToFile( "%s,", "NA" ) endif endif
																			else  if (EffMetric < 2)
                                                               then  WriteToFile( "%0.3f,", ClSysEER ) 
                                                               else  WriteToFile( "%0.3f,", ClSysEER2 )  endif  endif
																	  else UNCHANGED endif  }     ; SAC 09/16/22 (tic #1331)
   "Write HVACCool CFMperTon"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5  ) then 
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
									 												if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%0.3f,", HtPumpSystem[1]:CFMperTon )
																					else 
																						if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%0.3f,", CoolSystem[1]:CFMperTon ) else WriteToFile( "%s,", "NA" ) endif endif
																				else WriteToFile( "%0.3f,", ClSysCFMperTon ) endif
																		  else UNCHANGED endif  } 
   "Write HVACCool ACCharge"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5  ) then
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																					if ( Type == 2 .AND. HaveHtPump ) then 	
																						if ( HtPumpSystem[1]:ACCharge > 2.5 ) then  if (Proj:StandardsVersion > 2015) then  WriteToFile( "%c%s%c,", 34, "FID", 34 )  else  WriteToFile( "%c%s%c,", 34, "CID", 34 )  endif
								  														else  	
																							if ( HtPumpSystem[1]:ACCharge > 1.5 ) then WriteToFile( "%c%s%c,",	34, "Verified" , 34 )  
																							else	WriteToFile( "%c%s%c,",	34, "Not  Verified" , 34 )  endif
								  														endif
									   											else
																						if ( NoCoolingRpt < 0.5 ) then 
																							if ( CoolSystem[1]:ACCharge > 2.5 ) then  if (Proj:StandardsVersion > 2015) then  WriteToFile( "%c%s%c,", 34, "FID", 34 )  else  WriteToFile( "%c%s%c,", 34, "CID", 34 )  endif
								  															else  	
																								if ( CoolSystem[1]:ACCharge > 1.5 ) then WriteToFile( "%c%s%c,",	34, "Verified" , 34 )  
																								else	WriteToFile( "%c%s%c,",	34, "Not  Verified" , 34 )  endif
								  															endif
								  														else WriteToFile( "%c%s%c,",	34, "NA" , 34 ) endif 
                                               				   	endif
																				else WriteToFile( "%0.3f,", ClSysRefrigChgAdjFctr ) endif
																			else UNCHANGED endif  }
   "Write HVACCool Ducted flag"			HVACSys:Action = { if ( HaveCooling .AND. FloorAreaServed > 0.5 ) then 
   																			if ( NoCoolingRpt < 0.5 ) then
																					if (CoolDucted > 0.5 ) then  WriteToFile( "%c%s%c,\n",	34, "Yes" , 34  )
								  													else  	WriteToFile( "%c%s%c,\n",	34, "No" , 34 )  endif 
								  												else WriteToFile( "%c%s%c,\n",	34, "NA" , 34 )  endif
																			 else WriteToFile( "\n" ) endif  }                                                
; [2] HVACCool/HtPump object
   "Write HVACCool Name"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[2] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[2] ) > 0) ) then
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																				if ( Type == 2 .AND. HaveHtPump  ) then WriteToFile( ",,%c%s%c,", 34, HtPumpSystem[2]:Name, 34 )
																					else WriteToFile( ",,%c%s%c,", 34, CoolSystem[2]:Name, 34 )	endif
																			else UNCHANGED endif
																		else UNCHANGED endif  }
   "Write HVACCool Type"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[2] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[2] ) > 0) ) then
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																				if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%s,", HtPumpSystem[2]:TypeAbbrevStr )
																					else if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%s,", CoolSystem[2]:TypeAbbrevStr ) else WriteToFile( "%s,", "No Cooling" )	endif
																				endif
																			else UNCHANGED endif
																		else UNCHANGED endif  }
   "Write HVACCool SEER"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[2] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[2] ) > 0) ) then 
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																				if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%0.3f,", HtPumpSystem[2]:SEER )
																					else if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%0.3f,", CoolSystem[2]:SEER ) else WriteToFile( "%s,", "NA" ) endif
																				endif
																			else UNCHANGED endif
																		else UNCHANGED endif  }
   "Write HVACCool EER"				HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[2] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[2] ) > 0) ) then 
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
									 											if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%0.3f,", HtPumpSystem[2]:EER )
																					else if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%0.3f,", CoolSystem[2]:EER ) else WriteToFile( "%s,", "NA" ) endif
																				endif
																			else UNCHANGED endif
																	  else UNCHANGED endif  } 
   "Write HVACCool CFMperTon"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[2] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[2] ) > 0) ) then 
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
									 												if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%0.3f,", HtPumpSystem[2]:CFMperTon )
																						else 	if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%0.3f,", CoolSystem[2]:CFMperTon ) else WriteToFile( "%s,", "NA" ) endif
																					endif
																				else UNCHANGED endif
																		  else UNCHANGED endif  } 
   "Write HVACCool ACCharge"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[2] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[2] ) > 0) ) then
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																					if ( Type == 2 .AND. HaveHtPump ) then 	
																						if ( HtPumpSystem[2]:ACCharge > 2.5 ) then  if (Proj:StandardsVersion > 2015) then  WriteToFile( "%c%s%c,", 34, "FID", 34 )  else  WriteToFile( "%c%s%c,", 34, "CID", 34 )  endif
								  														else  	
																							if ( HtPumpSystem[2]:ACCharge > 1.5 ) then WriteToFile( "%c%s%c,",	34, "Verified" , 34 )  
																							else	WriteToFile( "%c%s%c,",	34, "Not  Verified" , 34 )  endif
								  														endif
									   											else 
																						if ( NoCoolingRpt < 0.5 ) then 
																							if ( CoolSystem[2]:ACCharge > 2.5 ) then  if (Proj:StandardsVersion > 2015) then  WriteToFile( "%c%s%c,", 34, "FID", 34 )  else  WriteToFile( "%c%s%c,", 34, "CID", 34 )  endif
								  															else  	
																								if ( CoolSystem[2]:ACCharge > 1.5 ) then WriteToFile( "%c%s%c,",	34, "Verified" , 34 )  
																								else	WriteToFile( "%c%s%c,",	34, "Not  Verified" , 34 )  endif
								  															endif
								  														else WriteToFile( "%c%s%c,",	34, "NA" , 34 ) endif 
									   											endif  
																				else UNCHANGED endif
																			else UNCHANGED endif }
   "Write HVACCool Ducted flag"			HVACSys:Action = {	if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[2] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[2] ) > 0) ) then 
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
;																						if ( CoolSystem[2]:FloorAreaServed > 0.5 .OR. HtPumpSystem[2]:FloorAreaServed > 0.5 ) then  
   																						if ( NoCoolingRpt < 0.5 ) then
																								if (CoolDucted > 0.5 ) then  WriteToFile( "%c%s%c,\n",	34, "Yes" , 34  )
								  																else  	WriteToFile( "%c%s%c,\n",	34, "No" , 34 )  endif 
								  															else WriteToFile( "%c%s%c,\n",	34, "NA" , 34 )  endif
;																						else UNCHANGED endif
																					else UNCHANGED endif
																			 	else UNCHANGED endif }                                                

; [3] HVACCool/HtPump object
   "Write HVACCool Name"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[3] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[3] ) > 0) ) then
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																				if ( Type == 2 .AND. HaveHtPump  ) then WriteToFile( ",,%c%s%c,", 34, HtPumpSystem[3]:Name, 34 )
																					else WriteToFile( ",,%c%s%c,", 34, CoolSystem[3]:Name, 34 )	endif
																			else UNCHANGED endif
																		else UNCHANGED endif  }
   "Write HVACCool Type"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[3] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[3] ) > 0) ) then
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																				if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%s,", HtPumpSystem[3]:TypeAbbrevStr )
																					else if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%s,", CoolSystem[3]:TypeAbbrevStr ) else WriteToFile( "%s,", "No Cooling" )	endif
																				endif
																			else UNCHANGED endif
																		else UNCHANGED endif  }
   "Write HVACCool SEER"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[3] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[3] ) > 0) ) then 
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																				if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%0.3f,", HtPumpSystem[3]:SEER )
																					else if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%0.3f,", CoolSystem[3]:SEER ) else WriteToFile( "%s,", "NA" ) endif
																				endif
																			else UNCHANGED endif
																		else UNCHANGED endif  }
   "Write HVACCool EER"				HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[3] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[3] ) > 0) ) then 
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
									 											if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%0.3f,", HtPumpSystem[3]:EER )
																					else if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%0.3f,", CoolSystem[3]:EER ) else WriteToFile( "%s,", "NA" ) endif
																				endif
																			else UNCHANGED endif
																	  else UNCHANGED endif  } 
   "Write HVACCool CFMperTon"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[3] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[3] ) > 0) ) then 
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
									 												if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%0.3f,", HtPumpSystem[3]:CFMperTon )
																						else 	if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%0.3f,", CoolSystem[3]:CFMperTon ) else WriteToFile( "%s,", "NA" ) endif
																					endif
																				else UNCHANGED endif
																		  else UNCHANGED endif  } 
   "Write HVACCool ACCharge"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[3] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[3] ) > 0) ) then
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																					if ( Type == 2 .AND. HaveHtPump ) then 	
																						if ( HtPumpSystem[3]:ACCharge > 2.5 ) then  if (Proj:StandardsVersion > 2015) then  WriteToFile( "%c%s%c,", 34, "FID", 34 )  else  WriteToFile( "%c%s%c,", 34, "CID", 34 )  endif
								  														else  	
																							if ( HtPumpSystem[3]:ACCharge > 1.5 ) then WriteToFile( "%c%s%c,",	34, "Verified" , 34 )  
																							else	WriteToFile( "%c%s%c,",	34, "Not  Verified" , 34 )  endif
								  														endif
									   											else 
																						if ( NoCoolingRpt < 0.5 ) then 
																							if ( CoolSystem[3]:ACCharge > 2.5 ) then  if (Proj:StandardsVersion > 2015) then  WriteToFile( "%c%s%c,", 34, "FID", 34 )  else  WriteToFile( "%c%s%c,", 34, "CID", 34 )  endif
								  															else  	
																								if ( CoolSystem[3]:ACCharge > 1.5 ) then WriteToFile( "%c%s%c,",	34, "Verified" , 34 )  
																								else	WriteToFile( "%c%s%c,",	34, "Not  Verified" , 34 )  endif
								  															endif
								  														else WriteToFile( "%c%s%c,",	34, "NA" , 34 ) endif 
									   											endif  
																				else UNCHANGED endif
																			else UNCHANGED endif }
   "Write HVACCool Ducted flag"			HVACSys:Action = {	if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[3] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[3] ) > 0) ) then 
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
;																						if ( CoolSystem[3]:FloorAreaServed > 0.5 .OR. HtPumpSystem[3]:FloorAreaServed > 0.5 ) then  
   																						if ( NoCoolingRpt < 0.5 ) then
																								if (CoolDucted > 0.5 ) then  WriteToFile( "%c%s%c,\n",	34, "Yes" , 34  )
								  																else  	WriteToFile( "%c%s%c,\n",	34, "No" , 34 )  endif 
								  															else WriteToFile( "%c%s%c,\n",	34, "NA" , 34 )  endif
;																						else UNCHANGED endif
																					else UNCHANGED endif
																			 	else UNCHANGED endif }                                                

; [4] HVACCool/HtPump object
   "Write HVACCool Name"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[4] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[4] ) > 0) ) then
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																				if ( Type == 2 .AND. HaveHtPump  ) then WriteToFile( ",,%c%s%c,", 34, HtPumpSystem[4]:Name, 34 )
																					else WriteToFile( ",,%c%s%c,", 34, CoolSystem[4]:Name, 34 )	endif
																			else UNCHANGED endif
																		else UNCHANGED endif  }
   "Write HVACCool Type"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[4] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[4] ) > 0) ) then
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																				if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%s,", HtPumpSystem[4]:TypeAbbrevStr )
																					else if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%s,", CoolSystem[4]:TypeAbbrevStr ) else WriteToFile( "%s,", "No Cooling" )	endif
																				endif
																			else UNCHANGED endif
																		else UNCHANGED endif  }
   "Write HVACCool SEER"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[4] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[4] ) > 0) ) then 
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																				if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%0.3f,", HtPumpSystem[4]:SEER )
																					else if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%0.3f,", CoolSystem[4]:SEER ) else WriteToFile( "%s,", "NA" ) endif
																				endif
																			else UNCHANGED endif
																		else UNCHANGED endif  }
   "Write HVACCool EER"				HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[4] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[4] ) > 0) ) then 
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
									 											if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%0.3f,", HtPumpSystem[4]:EER )
																					else if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%0.3f,", CoolSystem[4]:EER ) else WriteToFile( "%s,", "NA" ) endif
																				endif
																			else UNCHANGED endif
																	  else UNCHANGED endif  } 
   "Write HVACCool CFMperTon"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[4] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[4] ) > 0) ) then 
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
									 												if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%0.3f,", HtPumpSystem[4]:CFMperTon )
																						else 	if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%0.3f,", CoolSystem[4]:CFMperTon ) else WriteToFile( "%s,", "NA" ) endif
																					endif
																				else UNCHANGED endif
																		  else UNCHANGED endif  } 
   "Write HVACCool ACCharge"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[4] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[4] ) > 0) ) then
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																					if ( Type == 2 .AND. HaveHtPump ) then 	
																						if ( HtPumpSystem[4]:ACCharge > 2.5 ) then  if (Proj:StandardsVersion > 2015) then  WriteToFile( "%c%s%c,", 34, "FID", 34 )  else  WriteToFile( "%c%s%c,", 34, "CID", 34 )  endif
								  														else  	
																							if ( HtPumpSystem[4]:ACCharge > 1.5 ) then WriteToFile( "%c%s%c,",	34, "Verified" , 34 )  
																							else	WriteToFile( "%c%s%c,",	34, "Not  Verified" , 34 )  endif
								  														endif
									   											else 
																						if ( NoCoolingRpt < 0.5 ) then 
																							if ( CoolSystem[4]:ACCharge > 2.5 ) then  if (Proj:StandardsVersion > 2015) then  WriteToFile( "%c%s%c,", 34, "FID", 34 )  else  WriteToFile( "%c%s%c,", 34, "CID", 34 )  endif
								  															else  	
																								if ( CoolSystem[4]:ACCharge > 1.5 ) then WriteToFile( "%c%s%c,",	34, "Verified" , 34 )  
																								else	WriteToFile( "%c%s%c,",	34, "Not  Verified" , 34 )  endif
								  															endif
								  														else WriteToFile( "%c%s%c,",	34, "NA" , 34 ) endif 
									   											endif  
																				else UNCHANGED endif
																			else UNCHANGED endif }
   "Write HVACCool Ducted flag"			HVACSys:Action = {	if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[4] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[4] ) > 0) ) then 
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
;																						if ( CoolSystem[4]:FloorAreaServed > 0.5 .OR. HtPumpSystem[4]:FloorAreaServed > 0.5 ) then  
   																						if ( NoCoolingRpt < 0.5 ) then
																								if (CoolDucted > 0.5 ) then  WriteToFile( "%c%s%c,\n",	34, "Yes" , 34  )
								  																else  	WriteToFile( "%c%s%c,\n",	34, "No" , 34 )  endif 
								  															else WriteToFile( "%c%s%c,\n",	34, "NA" , 34 )  endif
;																						else UNCHANGED endif
																					else UNCHANGED endif
																			 	else UNCHANGED endif }                                                

; [5] HVACCool/HtPump object
   "Write HVACCool Name"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[5] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[5] ) > 0) ) then
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																				if ( Type == 2 .AND. HaveHtPump  ) then WriteToFile( ",,%c%s%c,", 34, HtPumpSystem[5]:Name, 34 )
																					else WriteToFile( ",,%c%s%c,", 34, CoolSystem[5]:Name, 34 )	endif
																			else UNCHANGED endif
																		else UNCHANGED endif  }
   "Write HVACCool Type"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[5] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[5] ) > 0) ) then
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																				if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%s,", HtPumpSystem[5]:TypeAbbrevStr )
																					else if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%s,", CoolSystem[5]:TypeAbbrevStr ) else WriteToFile( "%s,", "No Cooling" )	endif
																				endif
																			else UNCHANGED endif
																		else UNCHANGED endif  }
   "Write HVACCool SEER"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[5] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[5] ) > 0) ) then 
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																				if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%0.3f,", HtPumpSystem[5]:SEER )
																					else if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%0.3f,", CoolSystem[5]:SEER ) else WriteToFile( "%s,", "NA" ) endif
																				endif
																			else UNCHANGED endif
																		else UNCHANGED endif  }
   "Write HVACCool EER"				HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[5] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[5] ) > 0) ) then 
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
									 											if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%0.3f,", HtPumpSystem[5]:EER )
																					else if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%0.3f,", CoolSystem[5]:EER ) else WriteToFile( "%s,", "NA" ) endif
																				endif
																			else UNCHANGED endif
																	  else UNCHANGED endif  } 
   "Write HVACCool CFMperTon"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[5] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[5] ) > 0) ) then 
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
									 												if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%0.3f,", HtPumpSystem[5]:CFMperTon )
																						else 	if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%0.3f,", CoolSystem[5]:CFMperTon ) else WriteToFile( "%s,", "NA" ) endif
																					endif
																				else UNCHANGED endif
																		  else UNCHANGED endif  } 
   "Write HVACCool ACCharge"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[5] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[5] ) > 0) ) then
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																					if ( Type == 2 .AND. HaveHtPump ) then 	
																						if ( HtPumpSystem[5]:ACCharge > 2.5 ) then  if (Proj:StandardsVersion > 2015) then  WriteToFile( "%c%s%c,", 34, "FID", 34 )  else  WriteToFile( "%c%s%c,", 34, "CID", 34 )  endif
								  														else  	
																							if ( HtPumpSystem[5]:ACCharge > 1.5 ) then WriteToFile( "%c%s%c,",	34, "Verified" , 34 )  
																							else	WriteToFile( "%c%s%c,",	34, "Not  Verified" , 34 )  endif
								  														endif
									   											else 
																						if ( NoCoolingRpt < 0.5 ) then 
																							if ( CoolSystem[5]:ACCharge > 2.5 ) then  if (Proj:StandardsVersion > 2015) then  WriteToFile( "%c%s%c,", 34, "FID", 34 )  else  WriteToFile( "%c%s%c,", 34, "CID", 34 )  endif
								  															else  	
																								if ( CoolSystem[5]:ACCharge > 1.5 ) then WriteToFile( "%c%s%c,",	34, "Verified" , 34 )  
																								else	WriteToFile( "%c%s%c,",	34, "Not  Verified" , 34 )  endif
								  															endif
								  														else WriteToFile( "%c%s%c,",	34, "NA" , 34 ) endif 
									   											endif  
																				else UNCHANGED endif
																			else UNCHANGED endif }
   "Write HVACCool Ducted flag"			HVACSys:Action = {	if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[5] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[5] ) > 0) ) then 
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
;																						if ( CoolSystem[5]:FloorAreaServed > 0.5 .OR. HtPumpSystem[5]:FloorAreaServed > 0.5 ) then  
   																						if ( NoCoolingRpt < 0.5 ) then
																								if (CoolDucted > 0.5 ) then  WriteToFile( "%c%s%c,\n",	34, "Yes" , 34  )
								  																else  	WriteToFile( "%c%s%c,\n",	34, "No" , 34 )  endif 
								  															else WriteToFile( "%c%s%c,\n",	34, "NA" , 34 )  endif
;																						else UNCHANGED endif
																					else UNCHANGED endif
																			 	else UNCHANGED endif }                                                

; [6] HVACCool/HtPump object
   "Write HVACCool Name"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[6] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[6] ) > 0) ) then
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																				if ( Type == 2 .AND. HaveHtPump  ) then WriteToFile( ",,%c%s%c,", 34, HtPumpSystem[6]:Name, 34 )
																					else WriteToFile( ",,%c%s%c,", 34, CoolSystem[6]:Name, 34 )	endif
																			else UNCHANGED endif
																		else UNCHANGED endif  }
   "Write HVACCool Type"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[6] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[6] ) > 0) ) then
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																				if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%s,", HtPumpSystem[6]:TypeAbbrevStr )
																					else if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%s,", CoolSystem[6]:TypeAbbrevStr ) else WriteToFile( "%s,", "No Cooling" )	endif
																				endif
																			else UNCHANGED endif
																		else UNCHANGED endif  }
   "Write HVACCool SEER"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[6] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[6] ) > 0) ) then 
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																				if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%0.3f,", HtPumpSystem[6]:SEER )
																					else if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%0.3f,", CoolSystem[6]:SEER ) else WriteToFile( "%s,", "NA" ) endif
																				endif
																			else UNCHANGED endif
																		else UNCHANGED endif  }
   "Write HVACCool EER"				HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[6] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[6] ) > 0) ) then 
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
									 											if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%0.3f,", HtPumpSystem[6]:EER )
																					else if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%0.3f,", CoolSystem[6]:EER ) else WriteToFile( "%s,", "NA" ) endif
																				endif
																			else UNCHANGED endif
																	  else UNCHANGED endif  } 
   "Write HVACCool CFMperTon"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[6] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[6] ) > 0) ) then 
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
									 												if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%0.3f,", HtPumpSystem[6]:CFMperTon )
																						else 	if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%0.3f,", CoolSystem[6]:CFMperTon ) else WriteToFile( "%s,", "NA" ) endif
																					endif
																				else UNCHANGED endif
																		  else UNCHANGED endif  } 
   "Write HVACCool ACCharge"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[6] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[6] ) > 0) ) then
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																					if ( Type == 2 .AND. HaveHtPump ) then 	
																						if ( HtPumpSystem[6]:ACCharge > 2.5 ) then  if (Proj:StandardsVersion > 2015) then  WriteToFile( "%c%s%c,", 34, "FID", 34 )  else  WriteToFile( "%c%s%c,", 34, "CID", 34 )  endif
								  														else  	
																							if ( HtPumpSystem[6]:ACCharge > 1.5 ) then WriteToFile( "%c%s%c,",	34, "Verified" , 34 )  
																							else	WriteToFile( "%c%s%c,",	34, "Not  Verified" , 34 )  endif
								  														endif
									   											else 
																						if ( NoCoolingRpt < 0.5 ) then 
																							if ( CoolSystem[6]:ACCharge > 2.5 ) then  if (Proj:StandardsVersion > 2015) then  WriteToFile( "%c%s%c,", 34, "FID", 34 )  else  WriteToFile( "%c%s%c,", 34, "CID", 34 )  endif
								  															else  	
																								if ( CoolSystem[6]:ACCharge > 1.5 ) then WriteToFile( "%c%s%c,",	34, "Verified" , 34 )  
																								else	WriteToFile( "%c%s%c,",	34, "Not  Verified" , 34 )  endif
								  															endif
								  														else WriteToFile( "%c%s%c,",	34, "NA" , 34 ) endif 
									   											endif  
																				else UNCHANGED endif
																			else UNCHANGED endif }
   "Write HVACCool Ducted flag"			HVACSys:Action = {	if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[6] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[6] ) > 0) ) then 
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
;																						if ( CoolSystem[6]:FloorAreaServed > 0.5 .OR. HtPumpSystem[6]:FloorAreaServed > 0.5 ) then  
   																						if ( NoCoolingRpt < 0.5 ) then
																								if (CoolDucted > 0.5 ) then  WriteToFile( "%c%s%c,\n",	34, "Yes" , 34  )
								  																else  	WriteToFile( "%c%s%c,\n",	34, "No" , 34 )  endif 
								  															else WriteToFile( "%c%s%c,\n",	34, "NA" , 34 )  endif
;																						else UNCHANGED endif
																					else UNCHANGED endif
																			 	else UNCHANGED endif }                                                

; [7] HVACCool/HtPump object
   "Write HVACCool Name"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[7] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[7] ) > 0) ) then
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																				if ( Type == 2 .AND. HaveHtPump  ) then WriteToFile( ",,%c%s%c,", 34, HtPumpSystem[7]:Name, 34 )
																					else WriteToFile( ",,%c%s%c,", 34, CoolSystem[7]:Name, 34 )	endif
																			else UNCHANGED endif
																		else UNCHANGED endif  }
   "Write HVACCool Type"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[7] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[7] ) > 0) ) then
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																				if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%s,", HtPumpSystem[7]:TypeAbbrevStr )
																					else if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%s,", CoolSystem[7]:TypeAbbrevStr ) else WriteToFile( "%s,", "No Cooling" )	endif
																				endif
																			else UNCHANGED endif
																		else UNCHANGED endif  }
   "Write HVACCool SEER"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[7] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[7] ) > 0) ) then 
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																				if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%0.3f,", HtPumpSystem[7]:SEER )
																					else if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%0.3f,", CoolSystem[7]:SEER ) else WriteToFile( "%s,", "NA" ) endif
																				endif
																			else UNCHANGED endif
																		else UNCHANGED endif  }
   "Write HVACCool EER"				HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[7] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[7] ) > 0) ) then 
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
									 											if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%0.3f,", HtPumpSystem[7]:EER )
																					else if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%0.3f,", CoolSystem[7]:EER ) else WriteToFile( "%s,", "NA" ) endif
																				endif
																			else UNCHANGED endif
																	  else UNCHANGED endif  } 
   "Write HVACCool CFMperTon"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[7] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[7] ) > 0) ) then 
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
									 												if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%0.3f,", HtPumpSystem[7]:CFMperTon )
																						else 	if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%0.3f,", CoolSystem[7]:CFMperTon ) else WriteToFile( "%s,", "NA" ) endif
																					endif
																				else UNCHANGED endif
																		  else UNCHANGED endif  } 
   "Write HVACCool ACCharge"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[7] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[7] ) > 0) ) then
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																					if ( Type == 2 .AND. HaveHtPump ) then 	
																						if ( HtPumpSystem[7]:ACCharge > 2.5 ) then  if (Proj:StandardsVersion > 2015) then  WriteToFile( "%c%s%c,", 34, "FID", 34 )  else  WriteToFile( "%c%s%c,", 34, "CID", 34 )  endif
								  														else  	
																							if ( HtPumpSystem[7]:ACCharge > 1.5 ) then WriteToFile( "%c%s%c,",	34, "Verified" , 34 )  
																							else	WriteToFile( "%c%s%c,",	34, "Not  Verified" , 34 )  endif
								  														endif
									   											else 
																						if ( NoCoolingRpt < 0.5 ) then 
																							if ( CoolSystem[7]:ACCharge > 2.5 ) then  if (Proj:StandardsVersion > 2015) then  WriteToFile( "%c%s%c,", 34, "FID", 34 )  else  WriteToFile( "%c%s%c,", 34, "CID", 34 )  endif
								  															else  	
																								if ( CoolSystem[7]:ACCharge > 1.5 ) then WriteToFile( "%c%s%c,",	34, "Verified" , 34 )  
																								else	WriteToFile( "%c%s%c,",	34, "Not  Verified" , 34 )  endif
								  															endif
								  														else WriteToFile( "%c%s%c,",	34, "NA" , 34 ) endif 
									   											endif  
																				else UNCHANGED endif
																			else UNCHANGED endif }
   "Write HVACCool Ducted flag"			HVACSys:Action = {	if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[7] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[7] ) > 0) ) then 
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
;																						if ( CoolSystem[7]:FloorAreaServed > 0.5 .OR. HtPumpSystem[7]:FloorAreaServed > 0.5 ) then  
   																						if ( NoCoolingRpt < 0.5 ) then
																								if (CoolDucted > 0.5 ) then  WriteToFile( "%c%s%c,\n",	34, "Yes" , 34  )
								  																else  	WriteToFile( "%c%s%c,\n",	34, "No" , 34 )  endif 
								  															else WriteToFile( "%c%s%c,\n",	34, "NA" , 34 )  endif
;																						else UNCHANGED endif
																					else UNCHANGED endif
																			 	else UNCHANGED endif }                                                
; [8] HVACCool/HtPump object
   "Write HVACCool Name"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[8] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[8] ) > 0) ) then
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																				if ( Type == 2 .AND. HaveHtPump  ) then WriteToFile( ",,%c%s%c,", 34, HtPumpSystem[8]:Name, 34 )
																					else WriteToFile( ",,%c%s%c,", 34, CoolSystem[8]:Name, 34 )	endif
																			else UNCHANGED endif
																		else UNCHANGED endif  }
   "Write HVACCool Type"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[8] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[8] ) > 0) ) then
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																				if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%s,", HtPumpSystem[8]:TypeAbbrevStr )
																					else if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%s,", CoolSystem[8]:TypeAbbrevStr ) else WriteToFile( "%s,", "No Cooling" )	endif
																				endif
																			else UNCHANGED endif
																		else UNCHANGED endif  }
   "Write HVACCool SEER"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[8] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[8] ) > 0) ) then 
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																				if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%0.3f,", HtPumpSystem[8]:SEER )
																					else if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%0.3f,", CoolSystem[8]:SEER ) else WriteToFile( "%s,", "NA" ) endif
																				endif
																			else UNCHANGED endif
																		else UNCHANGED endif  }
   "Write HVACCool EER"				HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[8] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[8] ) > 0) ) then 
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
									 											if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%0.3f,", HtPumpSystem[8]:EER )
																					else if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%0.3f,", CoolSystem[8]:EER ) else WriteToFile( "%s,", "NA" ) endif
																				endif
																			else UNCHANGED endif
																	  else UNCHANGED endif  } 
   "Write HVACCool CFMperTon"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[8] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[8] ) > 0) ) then 
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
									 												if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%0.3f,", HtPumpSystem[8]:CFMperTon )
																						else 	if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%0.3f,", CoolSystem[8]:CFMperTon ) else WriteToFile( "%s,", "NA" ) endif
																					endif
																				else UNCHANGED endif
																		  else UNCHANGED endif  } 
   "Write HVACCool ACCharge"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[8] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[8] ) > 0) ) then
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																					if ( Type == 2 .AND. HaveHtPump ) then 	
																						if ( HtPumpSystem[8]:ACCharge > 2.5 ) then  if (Proj:StandardsVersion > 2015) then  WriteToFile( "%c%s%c,", 34, "FID", 34 )  else  WriteToFile( "%c%s%c,", 34, "CID", 34 )  endif
								  														else  	
																							if ( HtPumpSystem[8]:ACCharge > 1.5 ) then WriteToFile( "%c%s%c,",	34, "Verified" , 34 )  
																							else	WriteToFile( "%c%s%c,",	34, "Not  Verified" , 34 )  endif
								  														endif
									   											else 
																						if ( NoCoolingRpt < 0.5 ) then 
																							if ( CoolSystem[8]:ACCharge > 2.5 ) then  if (Proj:StandardsVersion > 2015) then  WriteToFile( "%c%s%c,", 34, "FID", 34 )  else  WriteToFile( "%c%s%c,", 34, "CID", 34 )  endif
								  															else  	
																								if ( CoolSystem[8]:ACCharge > 1.5 ) then WriteToFile( "%c%s%c,",	34, "Verified" , 34 )  
																								else	WriteToFile( "%c%s%c,",	34, "Not  Verified" , 34 )  endif
								  															endif
								  														else WriteToFile( "%c%s%c,",	34, "NA" , 34 ) endif 
									   											endif  
																				else UNCHANGED endif
																			else UNCHANGED endif }
   "Write HVACCool Ducted flag"			HVACSys:Action = {	if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[8] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[8] ) > 0) ) then 
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
;																						if ( CoolSystem[8]:FloorAreaServed > 0.5 .OR. HtPumpSystem[8]:FloorAreaServed > 0.5 ) then  
   																						if ( NoCoolingRpt < 0.5 ) then
																								if (CoolDucted > 0.5 ) then  WriteToFile( "%c%s%c,\n",	34, "Yes" , 34  )
								  																else  	WriteToFile( "%c%s%c,\n",	34, "No" , 34 )  endif 
								  															else WriteToFile( "%c%s%c,\n",	34, "NA" , 34 )  endif
;																						else UNCHANGED endif
																					else UNCHANGED endif
																			 	else UNCHANGED endif }                                                

; [9] HVACCool/HtPump object
   "Write HVACCool Name"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[9] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[9] ) > 0) ) then
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																				if ( Type == 2 .AND. HaveHtPump  ) then WriteToFile( ",,%c%s%c,", 34, HtPumpSystem[9]:Name, 34 )
																					else WriteToFile( ",,%c%s%c,", 34, CoolSystem[9]:Name, 34 )	endif
																			else UNCHANGED endif
																		else UNCHANGED endif  }
   "Write HVACCool Type"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[9] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[9] ) > 0) ) then
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																				if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%s,", HtPumpSystem[9]:TypeAbbrevStr )
																					else if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%s,", CoolSystem[9]:TypeAbbrevStr ) else WriteToFile( "%s,", "No Cooling" )	endif
																				endif
																			else UNCHANGED endif
																		else UNCHANGED endif  }
   "Write HVACCool SEER"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[9] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[9] ) > 0) ) then 
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																				if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%0.3f,", HtPumpSystem[9]:SEER )
																					else if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%0.3f,", CoolSystem[9]:SEER ) else WriteToFile( "%s,", "NA" ) endif
																				endif
																			else UNCHANGED endif
																		else UNCHANGED endif  }
   "Write HVACCool EER"				HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[9] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[9] ) > 0) ) then 
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
									 											if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%0.3f,", HtPumpSystem[9]:EER )
																					else if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%0.3f,", CoolSystem[9]:EER ) else WriteToFile( "%s,", "NA" ) endif
																				endif
																			else UNCHANGED endif
																	  else UNCHANGED endif  } 
   "Write HVACCool CFMperTon"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[9] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[9] ) > 0) ) then 
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
									 												if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%0.3f,", HtPumpSystem[9]:CFMperTon )
																						else 	if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%0.3f,", CoolSystem[9]:CFMperTon ) else WriteToFile( "%s,", "NA" ) endif
																					endif
																				else UNCHANGED endif
																		  else UNCHANGED endif  } 
   "Write HVACCool ACCharge"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[9] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[9] ) > 0) ) then
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																					if ( Type == 2 .AND. HaveHtPump ) then 	
																						if ( HtPumpSystem[9]:ACCharge > 2.5 ) then  if (Proj:StandardsVersion > 2015) then  WriteToFile( "%c%s%c,", 34, "FID", 34 )  else  WriteToFile( "%c%s%c,", 34, "CID", 34 )  endif
								  														else  	
																							if ( HtPumpSystem[9]:ACCharge > 1.5 ) then WriteToFile( "%c%s%c,",	34, "Verified" , 34 )  
																							else	WriteToFile( "%c%s%c,",	34, "Not  Verified" , 34 )  endif
								  														endif
									   											else 
																						if ( NoCoolingRpt < 0.5 ) then 
																							if ( CoolSystem[9]:ACCharge > 2.5 ) then  if (Proj:StandardsVersion > 2015) then  WriteToFile( "%c%s%c,", 34, "FID", 34 )  else  WriteToFile( "%c%s%c,", 34, "CID", 34 )  endif
								  															else  	
																								if ( CoolSystem[9]:ACCharge > 1.5 ) then WriteToFile( "%c%s%c,",	34, "Verified" , 34 )  
																								else	WriteToFile( "%c%s%c,",	34, "Not  Verified" , 34 )  endif
								  															endif
								  														else WriteToFile( "%c%s%c,",	34, "NA" , 34 ) endif 
									   											endif  
																				else UNCHANGED endif
																			else UNCHANGED endif }
   "Write HVACCool Ducted flag"			HVACSys:Action = {	if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[9] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[9] ) > 0) ) then 
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
;																						if ( CoolSystem[9]:FloorAreaServed > 0.5 .OR. HtPumpSystem[9]:FloorAreaServed > 0.5 ) then  
   																						if ( NoCoolingRpt < 0.5 ) then
																								if (CoolDucted > 0.5 ) then  WriteToFile( "%c%s%c,\n",	34, "Yes" , 34  )
								  																else  	WriteToFile( "%c%s%c,\n",	34, "No" , 34 )  endif 
								  															else WriteToFile( "%c%s%c,\n",	34, "NA" , 34 )  endif
;																						else UNCHANGED endif
																					else UNCHANGED endif
																			 	else UNCHANGED endif }                                                

; [10] HVACCool/HtPump object
  "Write HVACCool Name"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[10] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[10] ) > 0) ) then
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																				if ( Type == 2 .AND. HaveHtPump  ) then WriteToFile( ",,%c%s%c,", 34, HtPumpSystem[10]:Name, 34 )
																					else WriteToFile( ",,%c%s%c,", 34, CoolSystem[10]:Name, 34 )	endif
																			else UNCHANGED endif
																		else UNCHANGED endif  }
   "Write HVACCool Type"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[10] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[10] ) > 0) ) then
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																				if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%s,", HtPumpSystem[10]:TypeAbbrevStr )
																					else if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%s,", CoolSystem[10]:TypeAbbrevStr ) else WriteToFile( "%s,", "No Cooling" )	endif
																				endif
																			else UNCHANGED endif
																		else UNCHANGED endif  }
   "Write HVACCool SEER"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[10] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[10] ) > 0) ) then 
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																				if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%0.3f,", HtPumpSystem[10]:SEER )
																					else if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%0.3f,", CoolSystem[10]:SEER ) else WriteToFile( "%s,", "NA" ) endif
																				endif
																			else UNCHANGED endif
																		else UNCHANGED endif  }
   "Write HVACCool EER"				HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[10] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[10] ) > 0) ) then 
   																		if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
									 											if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%0.3f,", HtPumpSystem[10]:EER )
																					else if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%0.3f,", CoolSystem[10]:EER ) else WriteToFile( "%s,", "NA" ) endif
																				endif
																			else UNCHANGED endif
																	  else UNCHANGED endif  } 
   "Write HVACCool CFMperTon"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[10] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[10] ) > 0) ) then 
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
									 												if ( Type == 2 .AND. HaveHtPump ) then WriteToFile( "%0.3f,", HtPumpSystem[10]:CFMperTon )
																						else 	if ( NoCoolingRpt < 0.5 ) then WriteToFile( "%0.3f,", CoolSystem[10]:CFMperTon ) else WriteToFile( "%s,", "NA" ) endif
																					endif
																				else UNCHANGED endif
																		  else UNCHANGED endif  } 
   "Write HVACCool ACCharge"			HVACSys:Action = {  if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[10] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[10] ) > 0) ) then
   																			if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
																					if ( Type == 2 .AND. HaveHtPump ) then 	
																						if ( HtPumpSystem[10]:ACCharge > 2.5 ) then  if (Proj:StandardsVersion > 2015) then  WriteToFile( "%c%s%c,", 34, "FID", 34 )  else  WriteToFile( "%c%s%c,", 34, "CID", 34 )  endif
								  														else  	
																							if ( HtPumpSystem[10]:ACCharge > 1.5 ) then WriteToFile( "%c%s%c,",	34, "Verified" , 34 )  
																							else	WriteToFile( "%c%s%c,",	34, "Not  Verified" , 34 )  endif
								  														endif
									   											else 
																						if ( NoCoolingRpt < 0.5 ) then 
																							if ( CoolSystem[10]:ACCharge > 2.5 ) then  if (Proj:StandardsVersion > 2015) then  WriteToFile( "%c%s%c,", 34, "FID", 34 )  else  WriteToFile( "%c%s%c,", 34, "CID", 34 )  endif
								  															else  	
																								if ( CoolSystem[10]:ACCharge > 1.5 ) then WriteToFile( "%c%s%c,",	34, "Verified" , 34 )  
																								else	WriteToFile( "%c%s%c,",	34, "Not  Verified" , 34 )  endif
								  															endif
								  														else WriteToFile( "%c%s%c,",	34, "NA" , 34 ) endif 
									   											endif  
																				else UNCHANGED endif
																			else UNCHANGED endif }
   "Write HVACCool Ducted flag"			HVACSys:Action = {	if ( HaveCooling .AND. FloorAreaServed > 0.5 .AND. (LocalCompAssigned( CoolSystem[10] ) > 0 .OR. LocalCompAssigned( HtPumpSystem[10] ) > 0) ) then 
   																				if ( Proj:RunAbbrev != "s" .AND. Proj:RunAbbrev != "smf" ) then 
;																						if ( CoolSystem[10]:FloorAreaServed > 0.5 .OR. HtPumpSystem[10]:FloorAreaServed > 0.5 ) then  
   																						if ( NoCoolingRpt < 0.5 ) then
																								if (CoolDucted > 0.5 ) then  WriteToFile( "%c%s%c,\n",	34, "Yes" , 34  )
								  																else  	WriteToFile( "%c%s%c,\n",	34, "No" , 34 )  endif 
								  															else WriteToFile( "%c%s%c,\n",	34, "NA" , 34 )  endif
;																						else UNCHANGED endif
																					else UNCHANGED endif
																			 	else UNCHANGED endif }                                                
; mjb	6/13/14	only report Fan and Dist data if defined in Proposed Design (TypeRpt > 0.5)
   "Write column headings for Fan Data"		HVACSys:Action = {  if ( Fan:FloorAreaServed > 0.5 .AND. IfValidAnd(Fan:TypeRpt > 0.5) ) then WriteToFile( "\n,,Fan:, Type, Watts/CFM,\n" )
									else UNCHANGED endif  }
   "Write HVACFan Name"				HVACSys:Action = {  if ( Fan:FloorAreaServed > 0.5 .AND. IfValidAnd(Fan:TypeRpt > 0.5) ) then WriteToFile( ",,%c%s%c,", 34, Fan:Name, 34 )
									else UNCHANGED endif  }

   "Write HVACFan Type"				HVACSys:Action = {  if ( Fan:FloorAreaServed > 0.5 .AND. IfValidAnd(Fan:TypeRpt > 0.5) ) then WriteToFile( "%s,", Fan:TypeAbbrevStr )
									else UNCHANGED endif  }

   "Write HVACFan WperCFMCool"			HVACSys:Action = {  if ( Fan:FloorAreaServed > 0.5 .AND. IfValidAnd(Fan:TypeRpt > 0.5) ) then WriteToFile( "%0.3f,", Fan:WperCFMCool )                                              
									else UNCHANGED endif  }



   "Write column headings for Dist Data"	HVACSys:Action = {  if ( FloorAreaServed > 0.5 .AND. IfValidAnd(DistribSystem:DuctsCreatedForAnalysis < 0.5) ) then	
									if ( DistribSystem:Type == 8 .OR. DistribSystem:Type == 10  .OR. DistribSystem:Type == 11 .OR. DistribSystem:Type == 14  ) then UNCHANGED
										else WriteToFile( "\n\n,,Distribution System:, Type, Percent Leakage, Insulation R-Value, Supply Area (ft2), Supply Dia (in), Return Area (ft2), Return Dia (in), Bypass Duct,\n" )
										endif
									else UNCHANGED endif  }
 
   "Write HVACDist Name"		HVACSys:Action = {   if ( FloorAreaServed > 0.5 .AND. IfValidAnd(DistribSystem:DuctsCreatedForAnalysis < 0.5) ) then WriteToFile( ",,%c%s%c,", 34, DistribSystem:Name, 34 )
																	else UNCHANGED endif  }

   "Write HVACDist Type"		HVACSys:Action = {   if ( FloorAreaServed > 0.5 .AND. IfValidAnd(DistribSystem:DuctsCreatedForAnalysis < 0.5) ) then WriteToFile( "%s,", DistribSystem:TypeAbbrevStr )
																	else UNCHANGED endif  }

;	"debug DuctLeakageValRpt"	HVACSys:Action	= { 	if ( Status != 1 ) then UNCHANGED else
;																		MessageBox( "HVACSys: '%s'  DuctLeakageValRpt %g", Name, DistribSystem:DuctLeakageValRpt )
;																	endif	}

   "Write HVACDist DuctLeakageValRpt"	HVACSys:Action = {   if ( FloorAreaServed > 0.5 .AND. IfValidAnd(DistribSystem:DuctsCreatedForAnalysis < 0.5) ) then WriteToFile( "%0.3f,", DistribSystem:DuctLeakageValRpt )
																				else UNCHANGED endif  }
;	mjb-10/9/13	need to have some treatment like this to report duct leakage correctly (but not done yet)
;	"Write Duct Leakage Msg" 			HVACDist:HERSCheck:DuctLkgRptMsg = { if ( HERSCheck:DuctLeakage > 0.5 ) then 
;												if ( DefaultSystem > 0.5 .OR. DuctLeakage > 10) then 
;													if ( Proj:IsMultiFamily > 0.5 ) then "total leakage <= 12.0 or leakage to outdoors <= 6.0"
;													 else "6.0" endif
;												 else FltToStr( DuctLeakageValRpt, 1, 0, 3 ) endif
;											      else UNDEFINED endif }
;

   "Write HVACDist DuctInsRvalue"	HVACSys:Action = {   if ( FloorAreaServed > 0.5 .AND. IfValidAnd(DistribSystem:DuctsCreatedForAnalysis < 0.5) ) then 
																				WriteToFile( "%0.3f,", DistribSystem:DuctInsRvalue )
																			else UNCHANGED endif  }

   "Write HVACDist SupplyDuctArea"	HVACSys:Action = {   if ( FloorAreaServed > 0.5 .AND. IfValidAnd(DistribSystem:TypeRpt > 0.5) ) then WriteToFile( "%0.3f,", DistribSystem:SupplyDuctArea )                                               
								else UNCHANGED endif  }

   "Write HVACDist SupplyDuctDiam"	HVACSys:Action = {   if ( FloorAreaServed > 0.5 .AND. IfValidAnd(DistribSystem:TypeRpt > 0.5) ) then WriteToFile( "%0.3f,", DistribSystem:SupplyDuctDiam )                                              
								else UNCHANGED endif  }

   "Write HVACDist ReturnDuctArea"	HVACSys:Action = {   if ( FloorAreaServed > 0.5 .AND. IfValidAnd(DistribSystem:TypeRpt > 0.5) ) then WriteToFile( "%0.3f,", DistribSystem:ReturnDuctArea )                                              
								else UNCHANGED endif  }

   "Write HVACDist ReturnDuctDiam"	HVACSys:Action = {   if ( FloorAreaServed > 0.5 .AND. IfValidAnd(DistribSystem:TypeRpt > 0.5) ) then WriteToFile( "%0.3f,", DistribSystem:ReturnDuctDiam )                                              
								else UNCHANGED endif  }

   "Write HVACDist HasBypassDuct flag"	HVACSys:Action = {  if ( FloorAreaServed > 0.5 .AND. IfValidAnd(DistribSystem:DuctsCreatedForAnalysis < 0.5) ) then 
								if ( DistribSystem:Type == 8 .OR. DistribSystem:Type == 10  .OR. DistribSystem:Type == 11 .OR. DistribSystem:Type == 14 ) then UNCHANGED
									else  		
										if (DistribSystem:HasBypassDuct > 0.5 ) then  WriteToFile( "%c%s%c,\n\n", 34, "Yes" , 34  )
								  			else  	WriteToFile( "%c%s%c,\n\n", 34, "No" , 34 )  
								  			endif                                                
									endif
								else WriteToFile( "\n\n" )	 endif  }

END


;*************************************************************************
;*************************************************************************

ENDFILE
