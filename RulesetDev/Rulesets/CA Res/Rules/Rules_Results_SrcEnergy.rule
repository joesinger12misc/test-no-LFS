; -------------------------------------------------------------------------
; Rules pertaining to:   Simulation and Compliance Analysis Results
; CEC Title-24 Residential Energy Code
; -------------------------------------------------------------------------
; Copyright (c) 2012-2019, California Energy Commission
; Copyright (c) 2019, SAC Software Solutions, LLC
; All rights reserved.
; Redistribution and use in source and binary forms, with or without modification,
; are permitted provided that the following conditions are met:
; - Redistributions of source code must retain the above copyright notice, this
;   list of conditions and the following disclaimer.
; - Redistributions in binary form must reproduce the above copyright notice, this
;   list of conditions, the following disclaimer in the documentation and/or other
;   materials provided with the distribution.
; - Neither the name of the California Energy Commission nor the names of its
;   contributors may be used to endorse or promote products derived from this
;   software without specific prior written permission.
; DISCLAIMER: THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
; "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
; THE IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
; NON-INFRINGEMENT ARE DISCLAIMED. IN NO EVENT SHALL CALIFORNIA ENERGY COMMISSION,
; WRIGHTSOFT CORPORATION, ITRON, INC. OR ANY OTHER AUTHOR OR COPYRIGHT HOLDER OF
; THIS SOFTWARE (COLLECTIVELY, THE "AUTHORS") BE LIABLE FOR ANY DIRECT, INDIRECT,
; INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
; LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
; OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
; LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
; OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
; ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.  EACH LICENSEE AND SUBLICENSEE OF THE
; SOFTWARE AGREES NOT TO ASSERT ANY CLAIM AGAINST ANY OF THE AUTHORS RELATING TO
; THIS SOFTWARE, WHETHER DUE TO PERFORMANCE ISSUES, TITLE OR INFRINGEMENT ISSUES,
; STRICT LIABILITY OR OTHERWISE.
; -------------------------------------------------------------------------

; 'HPHtg' -> 'HPBU' - SAC 07/02/21

;*************************************************************************
RULELIST "CARes_ProposedSrcEnergyResults" 1 0 0 1
;*************************************************************************
         ; SAC 8/24/19 - replaced 1/3.413 & 0.01 EDR1 table multipliers with Proj:SrcSecMult_Elec & SrcSecMult_Fuel to accommodate 2022+ switch to native (E3) EDR1 table units
         ; SAC 8/26/19 - added primary table multipliers (of 1.0) to all ApplyHourlyResultMult* function calls (to accommodate 2022+ TDV table unit switch)
  ; Space Heating (& heating fan)
	"Calculate Src - Elec   - SpcHt"		Proj:RunResults[1]:PropElecSrc[1]			= {	if (LocalRef( RunResults[1]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - SpcHt"		Proj:RunResults[1]:PropNatGasSrc			= {	if (LocalRef( RunResults[1]:PropNatGasEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - SpcHt"		Proj:RunResults[1]:PropOtherSrc			= {	if (LocalRef( RunResults[1]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - SpcHt"		Proj:RunResults[1]:ProposedSrc[1]			= {	LocalRef( RunResults[1]:PropElecSrc[1] ) + LocalRef( RunResults[1]:PropNatGasSrc ) + LocalRef( RunResults[1]:PropOtherSrc )   }

  ; Space Cooling (& cooling fan)
	"Calculate Src - Elec   - SpcCl"		Proj:RunResults[2]:PropElecSrc[1]			= {	if (LocalRef( RunResults[2]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - SpcCl"		Proj:RunResults[2]:PropNatGasSrc			= {	if (LocalRef( RunResults[2]:PropNatGasEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - SpcCl"		Proj:RunResults[2]:PropOtherSrc			= {	if (LocalRef( RunResults[2]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - SpcCl"		Proj:RunResults[2]:ProposedSrc[1]			= {	LocalRef( RunResults[2]:PropElecSrc[1] ) + LocalRef( RunResults[2]:PropNatGasSrc ) + LocalRef( RunResults[2]:PropOtherSrc )   }

  ; IAQ Ventilation Fans
	"Calculate Src - Elec   - IAQVent"	Proj:RunResults[3]:PropElecSrc[1]			= {	if (LocalRef( RunResults[3]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "FanV" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - IAQVent"	Proj:RunResults[3]:PropNatGasSrc			= {	0  }
	"Calculate Src - Other  - IAQVent"	Proj:RunResults[3]:PropOtherSrc			= {	0  }
	"Calculate Src - TOTAL  - IAQVent"	Proj:RunResults[3]:ProposedSrc[1]			= {	LocalRef( RunResults[3]:PropElecSrc[1] )   }

  ; Other HVAC (aux & misc fans)
	"Calculate Src - Elec   - OthrHVAC"	Proj:RunResults[4]:PropElecSrc[1]		= {	if (LocalRef( RunResults[4]:PropElecEnergy[1] ) < 0.0001 .AND. OthrHVAC_SpcHtFrac == 0) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "User1" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - OthrHVAC"	Proj:RunResults[4]:PropNatGasSrc			= {	0  }
	"Calculate Src - Other  - OthrHVAC"	Proj:RunResults[4]:PropOtherSrc			= {	0  }
	"Calculate Src - TOTAL  - OthrHVAC"	Proj:RunResults[4]:ProposedSrc[1]		= {	LocalRef( RunResults[4]:PropElecSrc[1] )   }

; SAC 1/27/19 - REDISTRIBUTE OthrHVAC Prop Src across SpcHt & SpcCl by fuel based on ratio of total Src (across all fuels) (tic #1053)
   "Set OthrHVAC_SpcHtFrac - PropSrc"     Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResults[4]:ProposedSrc[1] != 0 )==0) then  0
                                                                        else if (IfValidAnd( RunResults[1]:ProposedSrc[1] == 0 ) .AND.
                                                                                 IfValidAnd( RunResults[2]:ProposedSrc[1] == 0 )) then  0.5
                                                                        else   ValidOr( RunResults[1]:ProposedSrc[1], 0 ) / 
                                                                              (ValidOr( RunResults[1]:ProposedSrc[1], 0 ) + ValidOr( RunResults[2]:ProposedSrc[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Elec   - SpcHt"		Proj:RunResults[1]:PropElecSrc[1]	   = {   if (IfValidAnd( RunResults[4]:PropElecSrc[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[1]:PropElecSrc[1] + (RunResults[4]:PropElecSrc[1]     * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - NatGas - SpcHt"		Proj:RunResults[1]:PropNatGasSrc[1]	   = {   if (IfValidAnd( RunResults[4]:PropNatGasSrc[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[1]:PropNatGasSrc[1] + (RunResults[4]:PropNatGasSrc[1] * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - Other  - SpcHt"		Proj:RunResults[1]:PropOtherSrc[1]	   = {   if (IfValidAnd( RunResults[4]:PropOtherSrc[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[1]:PropOtherSrc[1] + (RunResults[4]:PropOtherSrc[1]   * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - TOTAL  - SpcHt"		Proj:RunResults[1]:ProposedSrc[1]	   = {	LocalRef( RunResults[1]:PropElecSrc[1] ) + LocalRef( RunResults[1]:PropNatGasSrc[1] ) + LocalRef( RunResults[1]:PropOtherSrc[1] )   }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Elec   - SpcCl"		Proj:RunResults[2]:PropElecSrc[1]	   = {   if (IfValidAnd( RunResults[4]:PropElecSrc[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[2]:PropElecSrc[1] + (RunResults[4]:PropElecSrc[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - NatGas - SpcCl"		Proj:RunResults[2]:PropNatGasSrc[1]	   = {   if (IfValidAnd( RunResults[4]:PropNatGasSrc[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[2]:PropNatGasSrc[1] + (RunResults[4]:PropNatGasSrc[1] * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - Other  - SpcCl"		Proj:RunResults[2]:PropOtherSrc[1]	   = {   if (IfValidAnd( RunResults[4]:PropOtherSrc[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[2]:PropOtherSrc[1] + (RunResults[4]:PropOtherSrc[1]   * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - TOTAL  - SpcCl"		Proj:RunResults[2]:ProposedSrc[1]	   = {	LocalRef( RunResults[2]:PropElecSrc[1] ) + LocalRef( RunResults[2]:PropNatGasSrc[1] ) + LocalRef( RunResults[2]:PropOtherSrc[1] )   }

  ; Other HVAC (aux & misc fans)
	"ZERO-OUT         - Elec   - OthrHVAC"	Proj:RunResults[4]:PropElecSrc[1]	 = {	0  }
	"ZERO-OUT         - NatGas - OthrHVAC"	Proj:RunResults[4]:PropNatGasSrc[1]	 = {	0  }
	"ZERO-OUT         - Other  - OthrHVAC"	Proj:RunResults[4]:PropOtherSrc[1]	 = {	0  }
	"ZERO-OUT         - TOTAL  - OthrHVAC"	Proj:RunResults[4]:ProposedSrc[1]	 = {	0  }

  ; Water Heating
	"Calculate Src - Elec   - WtrHt"		Proj:RunResults[5]:PropElecSrc[1]			= {	if (LocalRef( RunResults[5]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else if (CSEinclDHWMFL_EU)
			 			  																					   then  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / CondFloorArea) + 0.5) / 100
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate Src - NatGas - WtrHt"		Proj:RunResults[5]:PropNatGasSrc			= {	if (LocalRef( RunResults[5]:PropNatGasEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - WtrHt"		Proj:RunResults[5]:PropOtherSrc			= {	if (LocalRef( RunResults[5]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - WtrHt"		Proj:RunResults[5]:ProposedSrc[1]			= {	LocalRef( RunResults[5]:PropElecSrc[1] ) + LocalRef( RunResults[5]:PropNatGasSrc ) + LocalRef( RunResults[5]:PropOtherSrc )   }

  ; Inside Lighting
	"Calculate Src - Elec   - InsLtg"	Proj:RunResults[6]:PropElecSrc[1]			= {	if (LocalRef( RunResults[6]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - InsLtg"	Proj:RunResults[6]:PropNatGasSrc			= {	if (LocalRef( RunResults[6]:PropNatGasEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - InsLtg"	Proj:RunResults[6]:PropOtherSrc			= {	if (LocalRef( RunResults[6]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - InsLtg"	Proj:RunResults[6]:ProposedSrc[1]			= {	LocalRef( RunResults[6]:PropElecSrc[1] ) + LocalRef( RunResults[6]:PropNatGasSrc ) + LocalRef( RunResults[6]:PropOtherSrc )   }

  ; Appliances & Cooking
	"Calculate Src - Elec   - AppCkg"	Proj:RunResults[7]:PropElecSrc[1]			= {	if (LocalRef( RunResults[7]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - AppCkg"	Proj:RunResults[7]:PropNatGasSrc			= {	if (LocalRef( RunResults[7]:PropNatGasEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - AppCkg"	Proj:RunResults[7]:PropOtherSrc			= {	if (LocalRef( RunResults[7]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - AppCkg"	Proj:RunResults[7]:ProposedSrc[1]			= {	LocalRef( RunResults[7]:PropElecSrc[1] ) + LocalRef( RunResults[7]:PropNatGasSrc ) + LocalRef( RunResults[7]:PropOtherSrc )   }

  ; Plug Loads
	"Calculate Src - Elec   - Plugs"		Proj:RunResults[8]:PropElecSrc[1]			= {	if (LocalRef( RunResults[8]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - Plugs"		Proj:RunResults[8]:PropNatGasSrc			= {	if (LocalRef( RunResults[8]:PropNatGasEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - Plugs"		Proj:RunResults[8]:PropOtherSrc			= {	if (LocalRef( RunResults[8]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - Plugs"		Proj:RunResults[8]:ProposedSrc[1]			= {	LocalRef( RunResults[8]:PropElecSrc[1] ) + LocalRef( RunResults[8]:PropNatGasSrc ) + LocalRef( RunResults[8]:PropOtherSrc )   }

  ; Exterior
	"Calculate Src - Elec   - Ext"		Proj:RunResults[9]:PropElecSrc[1]			= {	if (LocalRef( RunResults[9]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - Ext"		Proj:RunResults[9]:PropNatGasSrc			= {	if (LocalRef( RunResults[9]:PropNatGasEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - Ext"		Proj:RunResults[9]:PropOtherSrc			= {	if (LocalRef( RunResults[9]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - Ext"		Proj:RunResults[9]:ProposedSrc[1]			= {	LocalRef( RunResults[9]:PropElecSrc[1] ) + LocalRef( RunResults[9]:PropNatGasSrc ) + LocalRef( RunResults[9]:PropOtherSrc )   }

      ; revised all calls to ApplyHourlyResultMultipliers_NEM() to include hourly NEM table name & col arguments - SAC 05/16/23 (NEM3)
      ; revised all calls to ApplyHourlyResultMultipliers_NEM() to include NEMGrossUpFactor argument - SAC 05/25/23 (NEM3)
  ; PV
	"Calculate Src - Elec   - PV"			Proj:RunResults[13]:PropElecSrc[1]		=     ; added logic to calc Src energy for COmmunity Solar projects - SAC 05/25/22 (tic #1321)
    { if (LocalRef( RunResults[13]:PropElecEnergy[1]		) > -0.0001) then  0
      else if (CommunitySolarProjID > 0 .AND. IfValidAnd( CmntySlr_SrcEnergy < 0 )) then  CmntySlr_SrcEnergy * PVWDCSizeMultiplier[1] / CondFloorArea
		else if (IfValidAnd( NetEnergyMeteringSrcAdj != 0))
      then  if (LocalRef( RunResults[14]:PropElecEnergy[1] ) = 0)
            then  int( (100 * ApplyHourlyResultMultipliers_NEM( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringSrcAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor          ) / CondFloorArea) + 0.5) / 100
            else  int( (100 * ApplyHourlyResultMultipliers_NEM( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringSrcAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, 1, "BT" ) / CondFloorArea) + 0.5) / 100  endif
      else        int( (100 * ApplyHourlyResultMultipliers(     "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "PV" ) / CondFloorArea) + 0.5) / 100  endif endif endif  }
	"Calculate Src - NatGas - PV"			Proj:RunResults[13]:PropNatGasSrc		= {	0  }
	"Calculate Src - Other  - PV"			Proj:RunResults[13]:PropOtherSrc			= {	0  }
	"Calculate Src - TOTAL  - PV"			Proj:RunResults[13]:ProposedSrc[1]		= {	LocalRef( RunResults[13]:PropElecSrc[1] )   }

  ; Battery
	"Calculate Src - Elec   - Battery"	Proj:RunResults[14]:PropElecSrc[1]		= {	if (LocalRef( RunResults[14]:PropElecEnergy[1]		) = 0) then  0
		else if (IfValidAnd( NetEnergyMeteringSrcAdj != 0))
      then  if (LocalRef( RunResults[13]:PropElecEnergy[1] ) = 0)
            then  int( (100 * ApplyHourlyResultMultipliers_NEM( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "BT", "Tot", NetEnergyMeteringSrcAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor          ) / CondFloorArea) + 0.5) / 100
            else  int( (100 * ApplyHourlyResultMultipliers_NEM( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "BT", "Tot", NetEnergyMeteringSrcAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, 1, "PV" ) / CondFloorArea) + 0.5) / 100  endif
      else        int( (100 * ApplyHourlyResultMultipliers(     "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "BT" ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate Src - NatGas - Battery"	Proj:RunResults[14]:PropNatGasSrc		= {	0  }
	"Calculate Src - Other  - Battery"	Proj:RunResults[14]:PropOtherSrc			= {	0  }
	"Calculate Src - TOTAL  - Battery"	Proj:RunResults[14]:ProposedSrc[1]		= {	LocalRef( RunResults[14]:PropElecSrc[1] )   }

  ; Compliance Total
	"Calculate Src - Elec   - Comp Ttl"	Proj:RunResults[11]:PropElecSrc[1]		= {	RunResults[1]:PropElecSrc[1]    + RunResults[2]:PropElecSrc[1]    + RunResults[3]:PropElecSrc[1]    + RunResults[4]:PropElecSrc[1]    + RunResults[5]:PropElecSrc[1]     }
	"Calculate Src - NatGas - Comp Ttl"	Proj:RunResults[11]:PropNatGasSrc		= {	RunResults[1]:PropNatGasSrc     + RunResults[2]:PropNatGasSrc     + RunResults[3]:PropNatGasSrc     + RunResults[4]:PropNatGasSrc     + RunResults[5]:PropNatGasSrc      }
	"Calculate Src - Other  - Comp Ttl"	Proj:RunResults[11]:PropOtherSrc			= {	RunResults[1]:PropOtherSrc      + RunResults[2]:PropOtherSrc      + RunResults[3]:PropOtherSrc      + RunResults[4]:PropOtherSrc      + RunResults[5]:PropOtherSrc       }
	"Calculate Src - TOTAL  - Comp Ttl"	Proj:RunResults[11]:ProposedSrc[1]		= {	RunResults[1]:ProposedSrc[1]    + RunResults[2]:ProposedSrc[1]    + RunResults[3]:ProposedSrc[1]    + RunResults[4]:ProposedSrc[1]    + RunResults[5]:ProposedSrc[1]     }

  ; Total
	"Calculate Src - Elec   - Total"		Proj:RunResults[10]:PropElecSrc[1]		= {	RunResults[11]:PropElecSrc[1]    + RunResults[6]:PropElecSrc[1]    + RunResults[7]:PropElecSrc[1]    + RunResults[8]:PropElecSrc[1]    + RunResults[9]:PropElecSrc[1]     }
	"Calculate Src - NatGas - Total"		Proj:RunResults[10]:PropNatGasSrc		= {	RunResults[11]:PropNatGasSrc     + RunResults[6]:PropNatGasSrc     + RunResults[7]:PropNatGasSrc     + RunResults[8]:PropNatGasSrc     + RunResults[9]:PropNatGasSrc      }
	"Calculate Src - Other  - Total"		Proj:RunResults[10]:PropOtherSrc			= {	RunResults[11]:PropOtherSrc      + RunResults[6]:PropOtherSrc      + RunResults[7]:PropOtherSrc      + RunResults[8]:PropOtherSrc      + RunResults[9]:PropOtherSrc       }
	"Calculate Src - TOTAL  - Total"		Proj:RunResults[10]:ProposedSrc[1]		= {	RunResults[11]:ProposedSrc[1]    + RunResults[6]:ProposedSrc[1]    + RunResults[7]:ProposedSrc[1]    + RunResults[8]:ProposedSrc[1]    + RunResults[9]:ProposedSrc[1]     }
   ; SAC 4/7/17 - shifted PV & Batt from CompTot to Tot for 2019
   ; SAC 4/28/17 - add in only Battery to Total for 2016
	"Add in PV Src - Elec   - Total"	   Proj:RunResults[10]:PropElecSrc[1]	   = {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                    else if (EnergyCodeYearNum < 2019) 
                                                                                    then  RunResults[10]:PropElecSrc[1]    + RunResults[14]:PropElecSrc[1]
                                                                                    else  RunResults[10]:PropElecSrc[1]    + RunResults[13]:PropElecSrc[1]    + RunResults[14]:PropElecSrc[1]     endif endif   }
	"Add in PV Src - TOTAL  - Total"	   Proj:RunResults[10]:ProposedSrc[1]  	= {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                    else if (EnergyCodeYearNum < 2019) 
                                                                                    then  RunResults[10]:ProposedSrc[1]    + RunResults[14]:ProposedSrc[1]
                                                                                    else  RunResults[10]:ProposedSrc[1]    + RunResults[13]:ProposedSrc[1]    + RunResults[14]:ProposedSrc[1]     endif endif   }
END


;*************************************************************************  - SAC 6/25/13
RULELIST "CARes_ProposedSrcEnergyResults_N" 1 0 0 1
;*************************************************************************
; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
         ; SAC 8/24/19 - replaced 1/3.413 & 0.01 EDR1 table multipliers with Proj:SrcSecMult_Elec & SrcSecMult_Fuel to accommodate 2022+ switch to native (E3) EDR1 table units
         ; SAC 8/26/19 - added primary table multipliers (of 1.0) to all ApplyHourlyResultMult* function calls (to accommodate 2022+ TDV table unit switch)
  ; Space Heating (& heating fan)
	"Calculate Src - Elec   - N-SpcHt"		Proj:RunResultsN[1]:PropElecSrc[1]			= {	if (LocalRef( RunResultsN[1]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - N-SpcHt"		Proj:RunResultsN[1]:PropNatGasSrc		= {	if (LocalRef( RunResultsN[1]:PropNatGasEnergy[1]	) < 0.0001) then  0                                                                                                     
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - N-SpcHt"		Proj:RunResultsN[1]:PropOtherSrc			= {	if (LocalRef( RunResultsN[1]:PropOtherEnergy[1]		) < 0.0001) then  0                                                                                                     
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - N-SpcHt"		Proj:RunResultsN[1]:ProposedSrc[1]			= {	LocalRef( RunResultsN[1]:PropElecSrc[1] ) + LocalRef( RunResultsN[1]:PropNatGasSrc ) + LocalRef( RunResultsN[1]:PropOtherSrc )   }

  ; Space Cooling (& cooling fan)
	"Calculate Src - Elec   - N-SpcCl"		Proj:RunResultsN[2]:PropElecSrc[1]			= {	if (LocalRef( RunResultsN[2]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - N-SpcCl"		Proj:RunResultsN[2]:PropNatGasSrc		= {	if (LocalRef( RunResultsN[2]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - N-SpcCl"		Proj:RunResultsN[2]:PropOtherSrc			= {	if (LocalRef( RunResultsN[2]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - N-SpcCl"		Proj:RunResultsN[2]:ProposedSrc[1]			= {	LocalRef( RunResultsN[2]:PropElecSrc[1] ) + LocalRef( RunResultsN[2]:PropNatGasSrc ) + LocalRef( RunResultsN[2]:PropOtherSrc )   }

  ; IAQ Ventilation Fans
	"Calculate Src - Elec   - N-IAQVent"	Proj:RunResultsN[3]:PropElecSrc[1]			= {	if (LocalRef( RunResultsN[3]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "FanV" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - N-IAQVent"	Proj:RunResultsN[3]:PropNatGasSrc		= {	0  }
	"Calculate Src - Other  - N-IAQVent"	Proj:RunResultsN[3]:PropOtherSrc			= {	0  }
	"Calculate Src - TOTAL  - N-IAQVent"	Proj:RunResultsN[3]:ProposedSrc[1]			= {	LocalRef( RunResultsN[3]:PropElecSrc[1] )   }

; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
  ; Other HVAC (aux & misc fans)
	"Calculate Src - Elec   - N-OthrHVAC"	Proj:RunResultsN[4]:PropElecSrc[1]		= {	if (LocalRef( RunResultsN[4]:PropElecEnergy[1] ) < 0.0001 .AND. OthrHVAC_SpcHtFrac == 0) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "User1" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - N-OthrHVAC"	Proj:RunResultsN[4]:PropNatGasSrc		= {	0  }
	"Calculate Src - Other  - N-OthrHVAC"	Proj:RunResultsN[4]:PropOtherSrc			= {	0  }
	"Calculate Src - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:ProposedSrc[1]		= {	LocalRef( RunResultsN[4]:PropElecSrc[1] )   }

; SAC 1/27/19 - REDISTRIBUTE OthrHVAC N-Prop Src across SpcHt & SpcCl by fuel based on ratio of total Src (across all fuels) (tic #1053)
   "Set OthrHVAC_SpcHtFrac - N-PropSrc"      Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResultsN[4]:ProposedSrc[1] != 0 )==0) then  0
                                                                           else if (IfValidAnd( RunResultsN[1]:ProposedSrc[1] == 0 ) .AND.
                                                                                    IfValidAnd( RunResultsN[2]:ProposedSrc[1] == 0 )) then  0.5
                                                                           else   ValidOr( RunResultsN[1]:ProposedSrc[1], 0 ) / 
                                                                                 (ValidOr( RunResultsN[1]:ProposedSrc[1], 0 ) + ValidOr( RunResultsN[2]:ProposedSrc[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Elec   - N-SpcHt"		Proj:RunResultsN[1]:PropElecSrc[1]	   = {   if (IfValidAnd( RunResultsN[4]:PropElecSrc[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsN[1]:PropElecSrc[1] + (RunResultsN[4]:PropElecSrc[1]     * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - NatGas - N-SpcHt"		Proj:RunResultsN[1]:PropNatGasSrc[1]	= {   if (IfValidAnd( RunResultsN[4]:PropNatGasSrc[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsN[1]:PropNatGasSrc[1] + (RunResultsN[4]:PropNatGasSrc[1] * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - Other  - N-SpcHt"		Proj:RunResultsN[1]:PropOtherSrc[1]	   = {   if (IfValidAnd( RunResultsN[4]:PropOtherSrc[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsN[1]:PropOtherSrc[1] + (RunResultsN[4]:PropOtherSrc[1]   * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - TOTAL  - N-SpcHt"		Proj:RunResultsN[1]:ProposedSrc[1]	   = {	LocalRef( RunResultsN[1]:PropElecSrc[1] ) + LocalRef( RunResultsN[1]:PropNatGasSrc[1] ) + LocalRef( RunResultsN[1]:PropOtherSrc[1] )   }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Elec   - N-SpcCl"		Proj:RunResultsN[2]:PropElecSrc[1]	   = {   if (IfValidAnd( RunResultsN[4]:PropElecSrc[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsN[2]:PropElecSrc[1] + (RunResultsN[4]:PropElecSrc[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - NatGas - N-SpcCl"		Proj:RunResultsN[2]:PropNatGasSrc[1]	= {   if (IfValidAnd( RunResultsN[4]:PropNatGasSrc[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsN[2]:PropNatGasSrc[1] + (RunResultsN[4]:PropNatGasSrc[1] * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - Other  - N-SpcCl"		Proj:RunResultsN[2]:PropOtherSrc[1]	   = {   if (IfValidAnd( RunResultsN[4]:PropOtherSrc[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsN[2]:PropOtherSrc[1] + (RunResultsN[4]:PropOtherSrc[1]   * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - TOTAL  - N-SpcCl"		Proj:RunResultsN[2]:ProposedSrc[1]	   = {	LocalRef( RunResultsN[2]:PropElecSrc[1] ) + LocalRef( RunResultsN[2]:PropNatGasSrc[1] ) + LocalRef( RunResultsN[2]:PropOtherSrc[1] )   }
  ; Other HVAC (aux & misc fans)
	"ZERO-OUT         - Elec   - N-OthrHVAC"	Proj:RunResultsN[4]:PropElecSrc[1]	   = {	0  }
	"ZERO-OUT         - NatGas - N-OthrHVAC"	Proj:RunResultsN[4]:PropNatGasSrc[1]	= {	0  }
	"ZERO-OUT         - Other  - N-OthrHVAC"	Proj:RunResultsN[4]:PropOtherSrc[1]	   = {	0  }
	"ZERO-OUT         - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:ProposedSrc[1]	   = {	0  }
   ; SAC 1/27/19 - end of - redistribution of OthrHVAC PropSrc

  ; Water Heating
	"Calculate Src - Elec   - N-WtrHt"		Proj:RunResultsN[5]:PropElecSrc[1]			= {	if (LocalRef( RunResultsN[5]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else if (CSEinclDHWMFL_EU)
			 			  																							then  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / CondFloorArea) + 0.5) / 100
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate Src - NatGas - N-WtrHt"		Proj:RunResultsN[5]:PropNatGasSrc		= {	if (LocalRef( RunResultsN[5]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - N-WtrHt"		Proj:RunResultsN[5]:PropOtherSrc			= {	if (LocalRef( RunResultsN[5]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - N-WtrHt"		Proj:RunResultsN[5]:ProposedSrc[1]			= {	LocalRef( RunResultsN[5]:PropElecSrc[1] ) + LocalRef( RunResultsN[5]:PropNatGasSrc ) + LocalRef( RunResultsN[5]:PropOtherSrc )   }

  ; Inside Lighting
	"Calculate Src - Elec   - N-InsLtg"		Proj:RunResultsN[6]:PropElecSrc[1]			= {	if (LocalRef( RunResultsN[6]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - N-InsLtg"		Proj:RunResultsN[6]:PropNatGasSrc		= {	if (LocalRef( RunResultsN[6]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - N-InsLtg"		Proj:RunResultsN[6]:PropOtherSrc			= {	if (LocalRef( RunResultsN[6]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - N-InsLtg"		Proj:RunResultsN[6]:ProposedSrc[1]			= {	LocalRef( RunResultsN[6]:PropElecSrc[1] ) + LocalRef( RunResultsN[6]:PropNatGasSrc ) + LocalRef( RunResultsN[6]:PropOtherSrc )   }

  ; Appliances & Cooking
	"Calculate Src - Elec   - N-AppCkg"		Proj:RunResultsN[7]:PropElecSrc[1]			= {	if (LocalRef( RunResultsN[7]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - N-AppCkg"		Proj:RunResultsN[7]:PropNatGasSrc		= {	if (LocalRef( RunResultsN[7]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - N-AppCkg"		Proj:RunResultsN[7]:PropOtherSrc			= {	if (LocalRef( RunResultsN[7]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - N-AppCkg"		Proj:RunResultsN[7]:ProposedSrc[1]			= {	LocalRef( RunResultsN[7]:PropElecSrc[1] ) + LocalRef( RunResultsN[7]:PropNatGasSrc ) + LocalRef( RunResultsN[7]:PropOtherSrc )   }

  ; Plug Loads
	"Calculate Src - Elec   - N-Plugs"		Proj:RunResultsN[8]:PropElecSrc[1]			= {	if (LocalRef( RunResultsN[8]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - N-Plugs"		Proj:RunResultsN[8]:PropNatGasSrc		= {	if (LocalRef( RunResultsN[8]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - N-Plugs"		Proj:RunResultsN[8]:PropOtherSrc			= {	if (LocalRef( RunResultsN[8]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - N-Plugs"		Proj:RunResultsN[8]:ProposedSrc[1]			= {	LocalRef( RunResultsN[8]:PropElecSrc[1] ) + LocalRef( RunResultsN[8]:PropNatGasSrc ) + LocalRef( RunResultsN[8]:PropOtherSrc )   }

  ; Exterior
	"Calculate Src - Elec   - N-Ext"			Proj:RunResultsN[9]:PropElecSrc[1]			= {	if (LocalRef( RunResultsN[9]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - N-Ext"			Proj:RunResultsN[9]:PropNatGasSrc		= {	if (LocalRef( RunResultsN[9]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - N-Ext"			Proj:RunResultsN[9]:PropOtherSrc			= {	if (LocalRef( RunResultsN[9]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - N-Ext"			Proj:RunResultsN[9]:ProposedSrc[1]			= {	LocalRef( RunResultsN[9]:PropElecSrc[1] ) + LocalRef( RunResultsN[9]:PropNatGasSrc ) + LocalRef( RunResultsN[9]:PropOtherSrc )   }

  ; PV
	"Calculate Src - Elec   - N-PV"			Proj:RunResultsN[13]:PropElecSrc[1]		=        ; added logic to calc Src energy for Community Solar projects - SAC 05/25/22 (tic #1321)
    { if (LocalRef( RunResultsN[13]:PropElecEnergy[1]		) > -0.0001) then  0
      else if (CommunitySolarProjID > 0 .AND. IfValidAnd( CmntySlr_SrcEnergy < 0 )) then  CmntySlr_SrcEnergy * PVWDCSizeMultiplier[1] / CondFloorArea
		else if (IfValidAnd( NetEnergyMeteringSrcAdj != 0))
      then  if (LocalRef( RunResultsN[14]:PropElecEnergy[1] ) = 0)
            then  int( (100 * ApplyHourlyResultMultipliers_NEM( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringSrcAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor          ) / CondFloorArea) + 0.5) / 100
            else  int( (100 * ApplyHourlyResultMultipliers_NEM( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringSrcAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, 1, "BT" ) / CondFloorArea) + 0.5) / 100  endif
      else        int( (100 * ApplyHourlyResultMultipliers(     "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "PV" ) / CondFloorArea) + 0.5) / 100  endif endif endif  }
	"Calculate Src - NatGas - N-PV"			Proj:RunResultsN[13]:PropNatGasSrc		= {	0  }
	"Calculate Src - Other  - N-PV"			Proj:RunResultsN[13]:PropOtherSrc		= {	0  }
	"Calculate Src - TOTAL  - N-PV"			Proj:RunResultsN[13]:ProposedSrc[1]		= {	LocalRef( RunResultsN[13]:PropElecSrc[1] )   }
; "store BEMProc details"		Proj:Action = {  StoreBEMProc( "DsgnRtg PV Src", 0 )  }
; "testing"	Proj:Action	= {	MessageBox( "RunResultsN[13]:ProposedSrc[1] = %g  and [2] = %g", ValidOr( RunResultsN[13]:ProposedSrc[1], 0 ), ValidOr( RunResultsN[13]:ProposedSrc[2], 0 ) )  }

  ; Battery
	"Calculate Src - Elec   - N-Battery"	Proj:RunResultsN[14]:PropElecSrc[1]		= {	if (LocalRef( RunResultsN[14]:PropElecEnergy[1]		) < 0.0001) then  0
		else if (IfValidAnd( NetEnergyMeteringSrcAdj != 0))
      then  if (LocalRef( RunResultsN[13]:PropElecEnergy[1] ) = 0)
            then  int( (100 * ApplyHourlyResultMultipliers_NEM( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "BT", "Tot", NetEnergyMeteringSrcAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor          ) / CondFloorArea) + 0.5) / 100
            else  int( (100 * ApplyHourlyResultMultipliers_NEM( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "BT", "Tot", NetEnergyMeteringSrcAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, 1, "PV" ) / CondFloorArea) + 0.5) / 100  endif
      else        int( (100 * ApplyHourlyResultMultipliers(     "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "BT" ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate Src - NatGas - N-Battery"	Proj:RunResultsN[14]:PropNatGasSrc		= {	0  }
	"Calculate Src - Other  - N-Battery"	Proj:RunResultsN[14]:PropOtherSrc		= {	0  }
	"Calculate Src - TOTAL  - N-Battery"	Proj:RunResultsN[14]:ProposedSrc[1]		= {	LocalRef( RunResultsN[14]:PropElecSrc[1] )   }

  ; Compliance Total
	"Calculate Src - Elec   - N-Comp Ttl"	Proj:RunResultsN[11]:PropElecSrc[1]		= {	RunResultsN[1]:PropElecSrc[1]    + RunResultsN[2]:PropElecSrc[1]    + RunResultsN[3]:PropElecSrc[1]    + RunResultsN[4]:PropElecSrc[1]    + RunResultsN[5]:PropElecSrc[1]     }
	"Calculate Src - NatGas - N-Comp Ttl"	Proj:RunResultsN[11]:PropNatGasSrc		= {	RunResultsN[1]:PropNatGasSrc     + RunResultsN[2]:PropNatGasSrc     + RunResultsN[3]:PropNatGasSrc     + RunResultsN[4]:PropNatGasSrc     + RunResultsN[5]:PropNatGasSrc      }
	"Calculate Src - Other  - N-Comp Ttl"	Proj:RunResultsN[11]:PropOtherSrc		= {	RunResultsN[1]:PropOtherSrc      + RunResultsN[2]:PropOtherSrc      + RunResultsN[3]:PropOtherSrc      + RunResultsN[4]:PropOtherSrc      + RunResultsN[5]:PropOtherSrc       }
	"Calculate Src - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:ProposedSrc[1]		= {	RunResultsN[1]:ProposedSrc[1]    + RunResultsN[2]:ProposedSrc[1]    + RunResultsN[3]:ProposedSrc[1]    + RunResultsN[4]:ProposedSrc[1]    + RunResultsN[5]:ProposedSrc[1]     }

  ; Total
	"Calculate Src - Elec   - N-Total"		Proj:RunResultsN[10]:PropElecSrc[1]		= {	RunResultsN[11]:PropElecSrc[1]    + RunResultsN[6]:PropElecSrc[1]    + RunResultsN[7]:PropElecSrc[1]    + RunResultsN[8]:PropElecSrc[1]    + RunResultsN[9]:PropElecSrc[1]     }
	"Calculate Src - NatGas - N-Total"		Proj:RunResultsN[10]:PropNatGasSrc		= {	RunResultsN[11]:PropNatGasSrc  + RunResultsN[6]:PropNatGasSrc  + RunResultsN[7]:PropNatGasSrc  + RunResultsN[8]:PropNatGasSrc  + RunResultsN[9]:PropNatGasSrc   }
	"Calculate Src - Other  - N-Total"		Proj:RunResultsN[10]:PropOtherSrc		= {	RunResultsN[11]:PropOtherSrc   + RunResultsN[6]:PropOtherSrc   + RunResultsN[7]:PropOtherSrc   + RunResultsN[8]:PropOtherSrc   + RunResultsN[9]:PropOtherSrc    }
	"Calculate Src - TOTAL  - N-Total"		Proj:RunResultsN[10]:ProposedSrc[1]		= {	RunResultsN[11]:ProposedSrc[1]    + RunResultsN[6]:ProposedSrc[1]    + RunResultsN[7]:ProposedSrc[1]    + RunResultsN[8]:ProposedSrc[1]    + RunResultsN[9]:ProposedSrc[1]     }
   ; SAC 4/28/17 - shifted PV & Batt from CompTot to Tot for 2019
   ; SAC 4/28/17 - add in only Battery to Total for 2016
	"Add in PV Src - Elec   - N-Total"	   Proj:RunResultsN[10]:PropElecSrc[1]	   = {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                       else if (EnergyCodeYearNum < 2019) 
                                                                                       then  RunResultsN[10]:PropElecSrc[1]    + RunResultsN[14]:PropElecSrc[1]
                                                                                       else  RunResultsN[10]:PropElecSrc[1]    + RunResultsN[13]:PropElecSrc[1]    + RunResultsN[14]:PropElecSrc[1]     endif endif   }
	"Add in PV Src - TOTAL  - N-Total"	   Proj:RunResultsN[10]:ProposedSrc[1]  	= {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                       else if (EnergyCodeYearNum < 2019) 
                                                                                       then  RunResultsN[10]:ProposedSrc[1]    + RunResultsN[14]:ProposedSrc[1]
                                                                                       else  RunResultsN[10]:ProposedSrc[1]    + RunResultsN[13]:ProposedSrc[1]    + RunResultsN[14]:ProposedSrc[1]     endif endif   }
END

;*************************************************************************  - SAC 6/25/13
RULELIST "CARes_ProposedSrcEnergyResults_E" 1 0 0 1
;*************************************************************************
; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
         ; SAC 8/24/19 - replaced 1/3.413 & 0.01 EDR1 table multipliers with Proj:SrcSecMult_Elec & SrcSecMult_Fuel to accommodate 2022+ switch to native (E3) EDR1 table units
         ; SAC 8/26/19 - added primary table multipliers (of 1.0) to all ApplyHourlyResultMult* function calls (to accommodate 2022+ TDV table unit switch)
  ; Space Heating (& heating fan)
	"Calculate Src - Elec   - E-SpcHt"		Proj:RunResultsE[1]:PropElecSrc[1]			= {	if (LocalRef( RunResultsE[1]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - E-SpcHt"		Proj:RunResultsE[1]:PropNatGasSrc		= {	if (LocalRef( RunResultsE[1]:PropNatGasEnergy[1]	) < 0.0001) then  0                                                                                                     
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - E-SpcHt"		Proj:RunResultsE[1]:PropOtherSrc			= {	if (LocalRef( RunResultsE[1]:PropOtherEnergy[1]		) < 0.0001) then  0                                                                                                     
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - E-SpcHt"		Proj:RunResultsE[1]:ProposedSrc[1]			= {	LocalRef( RunResultsE[1]:PropElecSrc[1] ) + LocalRef( RunResultsE[1]:PropNatGasSrc ) + LocalRef( RunResultsE[1]:PropOtherSrc )   }

  ; Space Cooling (& cooling fan)
	"Calculate Src - Elec   - E-SpcCl"		Proj:RunResultsE[2]:PropElecSrc[1]			= {	if (LocalRef( RunResultsE[2]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - E-SpcCl"		Proj:RunResultsE[2]:PropNatGasSrc		= {	if (LocalRef( RunResultsE[2]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - E-SpcCl"		Proj:RunResultsE[2]:PropOtherSrc			= {	if (LocalRef( RunResultsE[2]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - E-SpcCl"		Proj:RunResultsE[2]:ProposedSrc[1]			= {	LocalRef( RunResultsE[2]:PropElecSrc[1] ) + LocalRef( RunResultsE[2]:PropNatGasSrc ) + LocalRef( RunResultsE[2]:PropOtherSrc )   }

  ; IAQ Ventilation Fans
	"Calculate Src - Elec   - E-IAQVent"	Proj:RunResultsE[3]:PropElecSrc[1]			= {	if (LocalRef( RunResultsE[3]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "FanV" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - E-IAQVent"	Proj:RunResultsE[3]:PropNatGasSrc		= {	0  }
	"Calculate Src - Other  - E-IAQVent"	Proj:RunResultsE[3]:PropOtherSrc			= {	0  }
	"Calculate Src - TOTAL  - E-IAQVent"	Proj:RunResultsE[3]:ProposedSrc[1]			= {	LocalRef( RunResultsE[3]:PropElecSrc[1] )   }

; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
  ; Other HVAC (aux & misc fans)
	"Calculate Src - Elec   - E-OthrHVAC"	Proj:RunResultsE[4]:PropElecSrc[1]		= {	if (LocalRef( RunResultsE[4]:PropElecEnergy[1] ) < 0.0001 .AND. OthrHVAC_SpcHtFrac == 0) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "User1" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - E-OthrHVAC"	Proj:RunResultsE[4]:PropNatGasSrc		= {	0  }
	"Calculate Src - Other  - E-OthrHVAC"	Proj:RunResultsE[4]:PropOtherSrc			= {	0  }
	"Calculate Src - TOTAL  - E-OthrHVAC"	Proj:RunResultsE[4]:ProposedSrc[1]		= {	LocalRef( RunResultsE[4]:PropElecSrc[1] )   }

; SAC 1/27/19 - REDISTRIBUTE OthrHVAC E-Prop Src across SpcHt & SpcCl by fuel based on ratio of total Src (across all fuels) (tic #1053)
   "Set OthrHVAC_SpcHtFrac - E-PropSrc"      Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResultsE[4]:ProposedSrc[1] != 0 )==0) then  0
                                                                           else if (IfValidAnd( RunResultsE[1]:ProposedSrc[1] == 0 ) .AND.
                                                                                    IfValidAnd( RunResultsE[2]:ProposedSrc[1] == 0 )) then  0.5
                                                                           else   ValidOr( RunResultsE[1]:ProposedSrc[1], 0 ) / 
                                                                                 (ValidOr( RunResultsE[1]:ProposedSrc[1], 0 ) + ValidOr( RunResultsE[2]:ProposedSrc[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Elec   - E-SpcHt"		Proj:RunResultsE[1]:PropElecSrc[1]	   = {   if (IfValidAnd( RunResultsE[4]:PropElecSrc[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsE[1]:PropElecSrc[1] + (RunResultsE[4]:PropElecSrc[1]     * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - NatGas - E-SpcHt"		Proj:RunResultsE[1]:PropNatGasSrc[1]	= {   if (IfValidAnd( RunResultsE[4]:PropNatGasSrc[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsE[1]:PropNatGasSrc[1] + (RunResultsE[4]:PropNatGasSrc[1] * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - Other  - E-SpcHt"		Proj:RunResultsE[1]:PropOtherSrc[1]	   = {   if (IfValidAnd( RunResultsE[4]:PropOtherSrc[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsE[1]:PropOtherSrc[1] + (RunResultsE[4]:PropOtherSrc[1]   * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - TOTAL  - E-SpcHt"		Proj:RunResultsE[1]:ProposedSrc[1]	   = {	LocalRef( RunResultsE[1]:PropElecSrc[1] ) + LocalRef( RunResultsE[1]:PropNatGasSrc[1] ) + LocalRef( RunResultsE[1]:PropOtherSrc[1] )   }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Elec   - E-SpcCl"		Proj:RunResultsE[2]:PropElecSrc[1]	   = {   if (IfValidAnd( RunResultsE[4]:PropElecSrc[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsE[2]:PropElecSrc[1] + (RunResultsE[4]:PropElecSrc[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - NatGas - E-SpcCl"		Proj:RunResultsE[2]:PropNatGasSrc[1]	= {   if (IfValidAnd( RunResultsE[4]:PropNatGasSrc[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsE[2]:PropNatGasSrc[1] + (RunResultsE[4]:PropNatGasSrc[1] * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - Other  - E-SpcCl"		Proj:RunResultsE[2]:PropOtherSrc[1]	   = {   if (IfValidAnd( RunResultsE[4]:PropOtherSrc[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsE[2]:PropOtherSrc[1] + (RunResultsE[4]:PropOtherSrc[1]   * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - TOTAL  - E-SpcCl"		Proj:RunResultsE[2]:ProposedSrc[1]	   = {	LocalRef( RunResultsE[2]:PropElecSrc[1] ) + LocalRef( RunResultsE[2]:PropNatGasSrc[1] ) + LocalRef( RunResultsE[2]:PropOtherSrc[1] )   }
  ; Other HVAC (aux & misc fans)
	"ZERO-OUT         - Elec   - E-OthrHVAC"	Proj:RunResultsE[4]:PropElecSrc[1]	   = {	0  }
	"ZERO-OUT         - NatGas - E-OthrHVAC"	Proj:RunResultsE[4]:PropNatGasSrc[1]	= {	0  }
	"ZERO-OUT         - Other  - E-OthrHVAC"	Proj:RunResultsE[4]:PropOtherSrc[1]	   = {	0  }
	"ZERO-OUT         - TOTAL  - E-OthrHVAC"	Proj:RunResultsE[4]:ProposedSrc[1]	   = {	0  }
   ; SAC 1/27/19 - end of - redistribution of OthrHVAC PropSrc

  ; Water Heating
	"Calculate Src - Elec   - E-WtrHt"		Proj:RunResultsE[5]:PropElecSrc[1]			= {	if (LocalRef( RunResultsE[5]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else if (CSEinclDHWMFL_EU)
			 			  																							then  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / CondFloorArea) + 0.5) / 100
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate Src - NatGas - E-WtrHt"		Proj:RunResultsE[5]:PropNatGasSrc		= {	if (LocalRef( RunResultsE[5]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - E-WtrHt"		Proj:RunResultsE[5]:PropOtherSrc			= {	if (LocalRef( RunResultsE[5]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - E-WtrHt"		Proj:RunResultsE[5]:ProposedSrc[1]			= {	LocalRef( RunResultsE[5]:PropElecSrc[1] ) + LocalRef( RunResultsE[5]:PropNatGasSrc ) + LocalRef( RunResultsE[5]:PropOtherSrc )   }

  ; Inside Lighting
	"Calculate Src - Elec   - E-InsLtg"		Proj:RunResultsE[6]:PropElecSrc[1]			= {	if (LocalRef( RunResultsE[6]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - E-InsLtg"		Proj:RunResultsE[6]:PropNatGasSrc		= {	if (LocalRef( RunResultsE[6]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - E-InsLtg"		Proj:RunResultsE[6]:PropOtherSrc			= {	if (LocalRef( RunResultsE[6]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - E-InsLtg"		Proj:RunResultsE[6]:ProposedSrc[1]			= {	LocalRef( RunResultsE[6]:PropElecSrc[1] ) + LocalRef( RunResultsE[6]:PropNatGasSrc ) + LocalRef( RunResultsE[6]:PropOtherSrc )   }

  ; Appliances & Cooking
	"Calculate Src - Elec   - E-AppCkg"		Proj:RunResultsE[7]:PropElecSrc[1]			= {	if (LocalRef( RunResultsE[7]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - E-AppCkg"		Proj:RunResultsE[7]:PropNatGasSrc		= {	if (LocalRef( RunResultsE[7]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - E-AppCkg"		Proj:RunResultsE[7]:PropOtherSrc			= {	if (LocalRef( RunResultsE[7]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - E-AppCkg"		Proj:RunResultsE[7]:ProposedSrc[1]			= {	LocalRef( RunResultsE[7]:PropElecSrc[1] ) + LocalRef( RunResultsE[7]:PropNatGasSrc ) + LocalRef( RunResultsE[7]:PropOtherSrc )   }

  ; Plug Loads
	"Calculate Src - Elec   - E-Plugs"		Proj:RunResultsE[8]:PropElecSrc[1]			= {	if (LocalRef( RunResultsE[8]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - E-Plugs"		Proj:RunResultsE[8]:PropNatGasSrc		= {	if (LocalRef( RunResultsE[8]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - E-Plugs"		Proj:RunResultsE[8]:PropOtherSrc			= {	if (LocalRef( RunResultsE[8]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - E-Plugs"		Proj:RunResultsE[8]:ProposedSrc[1]			= {	LocalRef( RunResultsE[8]:PropElecSrc[1] ) + LocalRef( RunResultsE[8]:PropNatGasSrc ) + LocalRef( RunResultsE[8]:PropOtherSrc )   }

  ; Exterior
	"Calculate Src - Elec   - E-Ext"			Proj:RunResultsE[9]:PropElecSrc[1]			= {	if (LocalRef( RunResultsE[9]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - E-Ext"			Proj:RunResultsE[9]:PropNatGasSrc		= {	if (LocalRef( RunResultsE[9]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - E-Ext"			Proj:RunResultsE[9]:PropOtherSrc			= {	if (LocalRef( RunResultsE[9]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - E-Ext"			Proj:RunResultsE[9]:ProposedSrc[1]			= {	LocalRef( RunResultsE[9]:PropElecSrc[1] ) + LocalRef( RunResultsE[9]:PropNatGasSrc ) + LocalRef( RunResultsE[9]:PropOtherSrc )   }

  ; PV
	"Calculate Src - Elec   - E-PV"			Proj:RunResultsE[13]:PropElecSrc[1]		=           ; added logic to calc Src energy for Community Solar projects - SAC 05/25/22 (tic #1321)
    { if (LocalRef( RunResultsE[13]:PropElecEnergy[1]		) > -0.0001) then  0
      else if (CommunitySolarProjID > 0 .AND. IfValidAnd( CmntySlr_SrcEnergy < 0 )) then  CmntySlr_SrcEnergy * PVWDCSizeMultiplier[1] / CondFloorArea
		else if (IfValidAnd( NetEnergyMeteringSrcAdj != 0))
      then  if (LocalRef( RunResultsE[14]:PropElecEnergy[1] ) = 0)
            then  int( (100 * ApplyHourlyResultMultipliers_NEM( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringSrcAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor          ) / CondFloorArea) + 0.5) / 100
            else  int( (100 * ApplyHourlyResultMultipliers_NEM( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringSrcAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, 1, "BT" ) / CondFloorArea) + 0.5) / 100  endif
      else        int( (100 * ApplyHourlyResultMultipliers(     "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "PV" ) / CondFloorArea) + 0.5) / 100  endif endif endif  }
	"Calculate Src - NatGas - E-PV"			Proj:RunResultsE[13]:PropNatGasSrc		= {	0  }
	"Calculate Src - Other  - E-PV"			Proj:RunResultsE[13]:PropOtherSrc		= {	0  }
	"Calculate Src - TOTAL  - E-PV"			Proj:RunResultsE[13]:ProposedSrc[1]		= {	LocalRef( RunResultsE[13]:PropElecSrc[1] )   }

  ; Battery
	"Calculate Src - Elec   - E-Battery"	Proj:RunResultsE[14]:PropElecSrc[1]		= {	if (LocalRef( RunResultsE[14]:PropElecEnergy[1]		) < 0.0001) then  0
		else if (IfValidAnd( NetEnergyMeteringSrcAdj != 0))
      then  if (LocalRef( RunResultsE[13]:PropElecEnergy[1] ) = 0)
            then  int( (100 * ApplyHourlyResultMultipliers_NEM( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "BT", "Tot", NetEnergyMeteringSrcAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor          ) / CondFloorArea) + 0.5) / 100
            else  int( (100 * ApplyHourlyResultMultipliers_NEM( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "BT", "Tot", NetEnergyMeteringSrcAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, 1, "PV" ) / CondFloorArea) + 0.5) / 100  endif
      else        int( (100 * ApplyHourlyResultMultipliers(     "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "BT" ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate Src - NatGas - E-Battery"	Proj:RunResultsE[14]:PropNatGasSrc		= {	0  }
	"Calculate Src - Other  - E-Battery"	Proj:RunResultsE[14]:PropOtherSrc		= {	0  }
	"Calculate Src - TOTAL  - E-Battery"	Proj:RunResultsE[14]:ProposedSrc[1]		= {	LocalRef( RunResultsE[14]:PropElecSrc[1] )   }

  ; Compliance Total
	"Calculate Src - Elec   - E-Comp Ttl"	Proj:RunResultsE[11]:PropElecSrc[1]			= {	RunResultsE[1]:PropElecSrc[1]    + RunResultsE[2]:PropElecSrc[1]    + RunResultsE[3]:PropElecSrc[1]    + RunResultsE[4]:PropElecSrc[1]    + RunResultsE[5]:PropElecSrc[1]     }
	"Calculate Src - NatGas - E-Comp Ttl"	Proj:RunResultsE[11]:PropNatGasSrc		= {	RunResultsE[1]:PropNatGasSrc  + RunResultsE[2]:PropNatGasSrc  + RunResultsE[3]:PropNatGasSrc  + RunResultsE[4]:PropNatGasSrc  + RunResultsE[5]:PropNatGasSrc   }
	"Calculate Src - Other  - E-Comp Ttl"	Proj:RunResultsE[11]:PropOtherSrc		= {	RunResultsE[1]:PropOtherSrc   + RunResultsE[2]:PropOtherSrc   + RunResultsE[3]:PropOtherSrc   + RunResultsE[4]:PropOtherSrc   + RunResultsE[5]:PropOtherSrc    }
	"Calculate Src - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:ProposedSrc[1]			= {	RunResultsE[1]:ProposedSrc[1]    + RunResultsE[2]:ProposedSrc[1]    + RunResultsE[3]:ProposedSrc[1]    + RunResultsE[4]:ProposedSrc[1]    + RunResultsE[5]:ProposedSrc[1]     }

  ; Total
	"Calculate Src - Elec   - E-Total"		Proj:RunResultsE[10]:PropElecSrc[1]			= {	RunResultsE[11]:PropElecSrc[1]    + RunResultsE[6]:PropElecSrc[1]    + RunResultsE[7]:PropElecSrc[1]    + RunResultsE[8]:PropElecSrc[1]    + RunResultsE[9]:PropElecSrc[1]     }
	"Calculate Src - NatGas - E-Total"		Proj:RunResultsE[10]:PropNatGasSrc		= {	RunResultsE[11]:PropNatGasSrc  + RunResultsE[6]:PropNatGasSrc  + RunResultsE[7]:PropNatGasSrc  + RunResultsE[8]:PropNatGasSrc  + RunResultsE[9]:PropNatGasSrc   }
	"Calculate Src - Other  - E-Total"		Proj:RunResultsE[10]:PropOtherSrc		= {	RunResultsE[11]:PropOtherSrc   + RunResultsE[6]:PropOtherSrc   + RunResultsE[7]:PropOtherSrc   + RunResultsE[8]:PropOtherSrc   + RunResultsE[9]:PropOtherSrc    }
	"Calculate Src - TOTAL  - E-Total"		Proj:RunResultsE[10]:ProposedSrc[1]			= {	RunResultsE[11]:ProposedSrc[1]    + RunResultsE[6]:ProposedSrc[1]    + RunResultsE[7]:ProposedSrc[1]    + RunResultsE[8]:ProposedSrc[1]    + RunResultsE[9]:ProposedSrc[1]     }
   ; SAC 4/28/17 - shifted PV & Batt from CompTot to Tot for 2019
   ; SAC 4/28/17 - add in only Battery to Total for 2016
	"Add in PV Src - Elec   - E-Total"	   Proj:RunResultsE[10]:PropElecSrc[1]	   = {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                       else if (EnergyCodeYearNum < 2019) 
                                                                                       then  RunResultsE[10]:PropElecSrc[1]    + RunResultsE[14]:PropElecSrc[1]
                                                                                       else  RunResultsE[10]:PropElecSrc[1]    + RunResultsE[13]:PropElecSrc[1]    + RunResultsE[14]:PropElecSrc[1]     endif endif   }
	"Add in PV Src - TOTAL  - E-Total"	   Proj:RunResultsE[10]:ProposedSrc[1]  	= {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                       else if (EnergyCodeYearNum < 2019) 
                                                                                       then  RunResultsE[10]:ProposedSrc[1]    + RunResultsE[14]:ProposedSrc[1]
                                                                                       else  RunResultsE[10]:ProposedSrc[1]    + RunResultsE[13]:ProposedSrc[1]    + RunResultsE[14]:ProposedSrc[1]     endif endif   }
END

;*************************************************************************  - SAC 6/25/13
RULELIST "CARes_ProposedSrcEnergyResults_S" 1 0 0 1
;*************************************************************************
; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
         ; SAC 8/24/19 - replaced 1/3.413 & 0.01 EDR1 table multipliers with Proj:SrcSecMult_Elec & SrcSecMult_Fuel to accommodate 2022+ switch to native (E3) EDR1 table units
         ; SAC 8/26/19 - added primary table multipliers (of 1.0) to all ApplyHourlyResultMult* function calls (to accommodate 2022+ TDV table unit switch)
  ; Space Heating (& heating fan)
	"Calculate Src - Elec   - S-SpcHt"		Proj:RunResultsS[1]:PropElecSrc[1]			= {	if (LocalRef( RunResultsS[1]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - S-SpcHt"		Proj:RunResultsS[1]:PropNatGasSrc		= {	if (LocalRef( RunResultsS[1]:PropNatGasEnergy[1]	) < 0.0001) then  0                                                                                                     
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - S-SpcHt"		Proj:RunResultsS[1]:PropOtherSrc			= {	if (LocalRef( RunResultsS[1]:PropOtherEnergy[1]		) < 0.0001) then  0                                                                                                     
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - S-SpcHt"		Proj:RunResultsS[1]:ProposedSrc[1]			= {	LocalRef( RunResultsS[1]:PropElecSrc[1] ) + LocalRef( RunResultsS[1]:PropNatGasSrc ) + LocalRef( RunResultsS[1]:PropOtherSrc )   }

  ; Space Cooling (& cooling fan)
	"Calculate Src - Elec   - S-SpcCl"		Proj:RunResultsS[2]:PropElecSrc[1]			= {	if (LocalRef( RunResultsS[2]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - S-SpcCl"		Proj:RunResultsS[2]:PropNatGasSrc		= {	if (LocalRef( RunResultsS[2]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - S-SpcCl"		Proj:RunResultsS[2]:PropOtherSrc			= {	if (LocalRef( RunResultsS[2]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - S-SpcCl"		Proj:RunResultsS[2]:ProposedSrc[1]			= {	LocalRef( RunResultsS[2]:PropElecSrc[1] ) + LocalRef( RunResultsS[2]:PropNatGasSrc ) + LocalRef( RunResultsS[2]:PropOtherSrc )   }

  ; IAQ Ventilation Fans
	"Calculate Src - Elec   - S-IAQVent"	Proj:RunResultsS[3]:PropElecSrc[1]			= {	if (LocalRef( RunResultsS[3]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "FanV" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - S-IAQVent"	Proj:RunResultsS[3]:PropNatGasSrc		= {	0  }
	"Calculate Src - Other  - S-IAQVent"	Proj:RunResultsS[3]:PropOtherSrc			= {	0  }
	"Calculate Src - TOTAL  - S-IAQVent"	Proj:RunResultsS[3]:ProposedSrc[1]			= {	LocalRef( RunResultsS[3]:PropElecSrc[1] )   }

; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
  ; Other HVAC (aux & misc fans)
	"Calculate Src - Elec   - S-OthrHVAC"	Proj:RunResultsS[4]:PropElecSrc[1]		= {	if (LocalRef( RunResultsS[4]:PropElecEnergy[1] ) < 0.0001 .AND. OthrHVAC_SpcHtFrac == 0) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "User1" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - S-OthrHVAC"	Proj:RunResultsS[4]:PropNatGasSrc		= {	0  }
	"Calculate Src - Other  - S-OthrHVAC"	Proj:RunResultsS[4]:PropOtherSrc			= {	0  }
	"Calculate Src - TOTAL  - S-OthrHVAC"	Proj:RunResultsS[4]:ProposedSrc[1]		= {	LocalRef( RunResultsS[4]:PropElecSrc[1] )   }

; SAC 1/27/19 - REDISTRIBUTE OthrHVAC S-Prop Src across SpcHt & SpcCl by fuel based on ratio of total Src (across all fuels) (tic #1053)
   "Set OthrHVAC_SpcHtFrac - S-PropSrc"      Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResultsS[4]:ProposedSrc[1] != 0 )==0) then  0
                                                                           else if (IfValidAnd( RunResultsS[1]:ProposedSrc[1] == 0 ) .AND.
                                                                                    IfValidAnd( RunResultsS[2]:ProposedSrc[1] == 0 )) then  0.5
                                                                           else   ValidOr( RunResultsS[1]:ProposedSrc[1], 0 ) / 
                                                                                 (ValidOr( RunResultsS[1]:ProposedSrc[1], 0 ) + ValidOr( RunResultsS[2]:ProposedSrc[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Elec   - S-SpcHt"		Proj:RunResultsS[1]:PropElecSrc[1]	   = {   if (IfValidAnd( RunResultsS[4]:PropElecSrc[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsS[1]:PropElecSrc[1] + (RunResultsS[4]:PropElecSrc[1]     * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - NatGas - S-SpcHt"		Proj:RunResultsS[1]:PropNatGasSrc[1]	= {   if (IfValidAnd( RunResultsS[4]:PropNatGasSrc[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsS[1]:PropNatGasSrc[1] + (RunResultsS[4]:PropNatGasSrc[1] * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - Other  - S-SpcHt"		Proj:RunResultsS[1]:PropOtherSrc[1]	   = {   if (IfValidAnd( RunResultsS[4]:PropOtherSrc[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsS[1]:PropOtherSrc[1] + (RunResultsS[4]:PropOtherSrc[1]   * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - TOTAL  - S-SpcHt"		Proj:RunResultsS[1]:ProposedSrc[1]	   = {	LocalRef( RunResultsS[1]:PropElecSrc[1] ) + LocalRef( RunResultsS[1]:PropNatGasSrc[1] ) + LocalRef( RunResultsS[1]:PropOtherSrc[1] )   }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Elec   - S-SpcCl"		Proj:RunResultsS[2]:PropElecSrc[1]	   = {   if (IfValidAnd( RunResultsS[4]:PropElecSrc[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsS[2]:PropElecSrc[1] + (RunResultsS[4]:PropElecSrc[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - NatGas - S-SpcCl"		Proj:RunResultsS[2]:PropNatGasSrc[1]	= {   if (IfValidAnd( RunResultsS[4]:PropNatGasSrc[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsS[2]:PropNatGasSrc[1] + (RunResultsS[4]:PropNatGasSrc[1] * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - Other  - S-SpcCl"		Proj:RunResultsS[2]:PropOtherSrc[1]	   = {   if (IfValidAnd( RunResultsS[4]:PropOtherSrc[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsS[2]:PropOtherSrc[1] + (RunResultsS[4]:PropOtherSrc[1]   * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - TOTAL  - S-SpcCl"		Proj:RunResultsS[2]:ProposedSrc[1]	   = {	LocalRef( RunResultsS[2]:PropElecSrc[1] ) + LocalRef( RunResultsS[2]:PropNatGasSrc[1] ) + LocalRef( RunResultsS[2]:PropOtherSrc[1] )   }
  ; Other HVAC (aux & misc fans)
	"ZERO-OUT         - Elec   - S-OthrHVAC"	Proj:RunResultsS[4]:PropElecSrc[1]	   = {	0  }
	"ZERO-OUT         - NatGas - S-OthrHVAC"	Proj:RunResultsS[4]:PropNatGasSrc[1]	= {	0  }
	"ZERO-OUT         - Other  - S-OthrHVAC"	Proj:RunResultsS[4]:PropOtherSrc[1]	   = {	0  }
	"ZERO-OUT         - TOTAL  - S-OthrHVAC"	Proj:RunResultsS[4]:ProposedSrc[1]	   = {	0  }
   ; SAC 1/27/19 - end of - redistribution of OthrHVAC PropSrc

  ; Water Heating
	"Calculate Src - Elec   - S-WtrHt"		Proj:RunResultsS[5]:PropElecSrc[1]			= {	if (LocalRef( RunResultsS[5]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else if (CSEinclDHWMFL_EU)
			 			  																							then  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / CondFloorArea) + 0.5) / 100
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate Src - NatGas - S-WtrHt"		Proj:RunResultsS[5]:PropNatGasSrc		= {	if (LocalRef( RunResultsS[5]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - S-WtrHt"		Proj:RunResultsS[5]:PropOtherSrc			= {	if (LocalRef( RunResultsS[5]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - S-WtrHt"		Proj:RunResultsS[5]:ProposedSrc[1]			= {	LocalRef( RunResultsS[5]:PropElecSrc[1] ) + LocalRef( RunResultsS[5]:PropNatGasSrc ) + LocalRef( RunResultsS[5]:PropOtherSrc )   }

  ; Inside Lighting
	"Calculate Src - Elec   - S-InsLtg"		Proj:RunResultsS[6]:PropElecSrc[1]			= {	if (LocalRef( RunResultsS[6]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - S-InsLtg"		Proj:RunResultsS[6]:PropNatGasSrc		= {	if (LocalRef( RunResultsS[6]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - S-InsLtg"		Proj:RunResultsS[6]:PropOtherSrc			= {	if (LocalRef( RunResultsS[6]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - S-InsLtg"		Proj:RunResultsS[6]:ProposedSrc[1]			= {	LocalRef( RunResultsS[6]:PropElecSrc[1] ) + LocalRef( RunResultsS[6]:PropNatGasSrc ) + LocalRef( RunResultsS[6]:PropOtherSrc )   }

  ; Appliances & Cooking
	"Calculate Src - Elec   - S-AppCkg"		Proj:RunResultsS[7]:PropElecSrc[1]			= {	if (LocalRef( RunResultsS[7]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - S-AppCkg"		Proj:RunResultsS[7]:PropNatGasSrc		= {	if (LocalRef( RunResultsS[7]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - S-AppCkg"		Proj:RunResultsS[7]:PropOtherSrc			= {	if (LocalRef( RunResultsS[7]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - S-AppCkg"		Proj:RunResultsS[7]:ProposedSrc[1]			= {	LocalRef( RunResultsS[7]:PropElecSrc[1] ) + LocalRef( RunResultsS[7]:PropNatGasSrc ) + LocalRef( RunResultsS[7]:PropOtherSrc )   }

  ; Plug Loads
	"Calculate Src - Elec   - S-Plugs"		Proj:RunResultsS[8]:PropElecSrc[1]			= {	if (LocalRef( RunResultsS[8]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - S-Plugs"		Proj:RunResultsS[8]:PropNatGasSrc		= {	if (LocalRef( RunResultsS[8]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - S-Plugs"		Proj:RunResultsS[8]:PropOtherSrc			= {	if (LocalRef( RunResultsS[8]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - S-Plugs"		Proj:RunResultsS[8]:ProposedSrc[1]			= {	LocalRef( RunResultsS[8]:PropElecSrc[1] ) + LocalRef( RunResultsS[8]:PropNatGasSrc ) + LocalRef( RunResultsS[8]:PropOtherSrc )   }

  ; Exterior
	"Calculate Src - Elec   - S-Ext"			Proj:RunResultsS[9]:PropElecSrc[1]			= {	if (LocalRef( RunResultsS[9]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - S-Ext"			Proj:RunResultsS[9]:PropNatGasSrc		= {	if (LocalRef( RunResultsS[9]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - S-Ext"			Proj:RunResultsS[9]:PropOtherSrc			= {	if (LocalRef( RunResultsS[9]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - S-Ext"			Proj:RunResultsS[9]:ProposedSrc[1]			= {	LocalRef( RunResultsS[9]:PropElecSrc[1] ) + LocalRef( RunResultsS[9]:PropNatGasSrc ) + LocalRef( RunResultsS[9]:PropOtherSrc )   }

  ; PV
	"Calculate Src - Elec   - S-PV"			Proj:RunResultsS[13]:PropElecSrc[1]		=        ; added logic to calc Src energy for Community Solar projects - SAC 05/25/22 (tic #1321)
    { if (LocalRef( RunResultsS[13]:PropElecEnergy[1]		) > -0.0001) then  0
      else if (CommunitySolarProjID > 0 .AND. IfValidAnd( CmntySlr_SrcEnergy < 0 )) then  CmntySlr_SrcEnergy * PVWDCSizeMultiplier[1] / CondFloorArea
		else if (IfValidAnd( NetEnergyMeteringSrcAdj != 0))
      then  if (LocalRef( RunResultsS[14]:PropElecEnergy[1] ) = 0)
            then  int( (100 * ApplyHourlyResultMultipliers_NEM( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringSrcAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor          ) / CondFloorArea) + 0.5) / 100
            else  int( (100 * ApplyHourlyResultMultipliers_NEM( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringSrcAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, 1, "BT" ) / CondFloorArea) + 0.5) / 100  endif
      else        int( (100 * ApplyHourlyResultMultipliers(     "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "PV" ) / CondFloorArea) + 0.5) / 100  endif endif endif  }
	"Calculate Src - NatGas - S-PV"			Proj:RunResultsS[13]:PropNatGasSrc		= {	0  }
	"Calculate Src - Other  - S-PV"			Proj:RunResultsS[13]:PropOtherSrc		= {	0  }
	"Calculate Src - TOTAL  - S-PV"			Proj:RunResultsS[13]:ProposedSrc[1]		= {	LocalRef( RunResultsS[13]:PropElecSrc[1] )   }

  ; Battery
	"Calculate Src - Elec   - S-Battery"	Proj:RunResultsS[14]:PropElecSrc[1]		= {	if (LocalRef( RunResultsS[14]:PropElecEnergy[1]		) < 0.0001) then  0
		else if (IfValidAnd( NetEnergyMeteringSrcAdj != 0))
      then  if (LocalRef( RunResultsS[13]:PropElecEnergy[1] ) = 0)
            then  int( (100 * ApplyHourlyResultMultipliers_NEM( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "BT", "Tot", NetEnergyMeteringSrcAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor          ) / CondFloorArea) + 0.5) / 100
            else  int( (100 * ApplyHourlyResultMultipliers_NEM( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "BT", "Tot", NetEnergyMeteringSrcAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, 1, "PV" ) / CondFloorArea) + 0.5) / 100  endif
      else        int( (100 * ApplyHourlyResultMultipliers(     "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "BT" ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate Src - NatGas - S-Battery"	Proj:RunResultsS[14]:PropNatGasSrc		= {	0  }
	"Calculate Src - Other  - S-Battery"	Proj:RunResultsS[14]:PropOtherSrc		= {	0  }
	"Calculate Src - TOTAL  - S-Battery"	Proj:RunResultsS[14]:ProposedSrc[1]		= {	LocalRef( RunResultsS[14]:PropElecSrc[1] )   }

  ; Compliance Total
	"Calculate Src - Elec   - S-Comp Ttl"	Proj:RunResultsS[11]:PropElecSrc[1]		= {	RunResultsS[1]:PropElecSrc[1]    + RunResultsS[2]:PropElecSrc[1]    + RunResultsS[3]:PropElecSrc[1]    + RunResultsS[4]:PropElecSrc[1]    + RunResultsS[5]:PropElecSrc[1]     }
	"Calculate Src - NatGas - S-Comp Ttl"	Proj:RunResultsS[11]:PropNatGasSrc		= {	RunResultsS[1]:PropNatGasSrc  + RunResultsS[2]:PropNatGasSrc  + RunResultsS[3]:PropNatGasSrc  + RunResultsS[4]:PropNatGasSrc  + RunResultsS[5]:PropNatGasSrc   }
	"Calculate Src - Other  - S-Comp Ttl"	Proj:RunResultsS[11]:PropOtherSrc		= {	RunResultsS[1]:PropOtherSrc   + RunResultsS[2]:PropOtherSrc   + RunResultsS[3]:PropOtherSrc   + RunResultsS[4]:PropOtherSrc   + RunResultsS[5]:PropOtherSrc    }
	"Calculate Src - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:ProposedSrc[1]		= {	RunResultsS[1]:ProposedSrc[1]    + RunResultsS[2]:ProposedSrc[1]    + RunResultsS[3]:ProposedSrc[1]    + RunResultsS[4]:ProposedSrc[1]    + RunResultsS[5]:ProposedSrc[1]     }

  ; Total
	"Calculate Src - Elec   - S-Total"		Proj:RunResultsS[10]:PropElecSrc[1]			= {	RunResultsS[11]:PropElecSrc[1]    + RunResultsS[6]:PropElecSrc[1]    + RunResultsS[7]:PropElecSrc[1]    + RunResultsS[8]:PropElecSrc[1]    + RunResultsS[9]:PropElecSrc[1]     }
	"Calculate Src - NatGas - S-Total"		Proj:RunResultsS[10]:PropNatGasSrc		= {	RunResultsS[11]:PropNatGasSrc  + RunResultsS[6]:PropNatGasSrc  + RunResultsS[7]:PropNatGasSrc  + RunResultsS[8]:PropNatGasSrc  + RunResultsS[9]:PropNatGasSrc   }
	"Calculate Src - Other  - S-Total"		Proj:RunResultsS[10]:PropOtherSrc		= {	RunResultsS[11]:PropOtherSrc   + RunResultsS[6]:PropOtherSrc   + RunResultsS[7]:PropOtherSrc   + RunResultsS[8]:PropOtherSrc   + RunResultsS[9]:PropOtherSrc    }
	"Calculate Src - TOTAL  - S-Total"		Proj:RunResultsS[10]:ProposedSrc[1]			= {	RunResultsS[11]:ProposedSrc[1]    + RunResultsS[6]:ProposedSrc[1]    + RunResultsS[7]:ProposedSrc[1]    + RunResultsS[8]:ProposedSrc[1]    + RunResultsS[9]:ProposedSrc[1]     }
   ; SAC 4/28/17 - shifted PV & Batt from CompTot to Tot for 2019
   ; SAC 4/28/17 - add in only Battery to Total for 2016
	"Add in PV Src - Elec   - S-Total"	   Proj:RunResultsS[10]:PropElecSrc[1]	   = {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                       else if (EnergyCodeYearNum < 2019) 
                                                                                       then  RunResultsS[10]:PropElecSrc[1]    + RunResultsS[14]:PropElecSrc[1]
                                                                                       else  RunResultsS[10]:PropElecSrc[1]    + RunResultsS[13]:PropElecSrc[1]    + RunResultsS[14]:PropElecSrc[1]     endif endif   }
	"Add in PV Src - TOTAL  - S-Total"	   Proj:RunResultsS[10]:ProposedSrc[1]  	= {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                       else if (EnergyCodeYearNum < 2019) 
                                                                                       then  RunResultsS[10]:ProposedSrc[1]    + RunResultsS[14]:ProposedSrc[1]
                                                                                       else  RunResultsS[10]:ProposedSrc[1]    + RunResultsS[13]:ProposedSrc[1]    + RunResultsS[14]:ProposedSrc[1]     endif endif   }
END

;*************************************************************************  - SAC 6/25/13
RULELIST "CARes_ProposedSrcEnergyResults_W" 1 0 0 1
;*************************************************************************
; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
         ; SAC 8/24/19 - replaced 1/3.413 & 0.01 EDR1 table multipliers with Proj:SrcSecMult_Elec & SrcSecMult_Fuel to accommodate 2022+ switch to native (E3) EDR1 table units
         ; SAC 8/26/19 - added primary table multipliers (of 1.0) to all ApplyHourlyResultMult* function calls (to accommodate 2022+ TDV table unit switch)
  ; Space Heating (& heating fan)
	"Calculate Src - Elec   - W-SpcHt"		Proj:RunResultsW[1]:PropElecSrc[1]			= {	if (LocalRef( RunResultsW[1]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - W-SpcHt"		Proj:RunResultsW[1]:PropNatGasSrc		= {	if (LocalRef( RunResultsW[1]:PropNatGasEnergy[1]	) < 0.0001) then  0                                                                                                     
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - W-SpcHt"		Proj:RunResultsW[1]:PropOtherSrc			= {	if (LocalRef( RunResultsW[1]:PropOtherEnergy[1]		) < 0.0001) then  0                                                                                                     
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - W-SpcHt"		Proj:RunResultsW[1]:ProposedSrc[1]			= {	LocalRef( RunResultsW[1]:PropElecSrc[1] ) + LocalRef( RunResultsW[1]:PropNatGasSrc ) + LocalRef( RunResultsW[1]:PropOtherSrc )   }

  ; Space Cooling (& cooling fan)
	"Calculate Src - Elec   - W-SpcCl"		Proj:RunResultsW[2]:PropElecSrc[1]			= {	if (LocalRef( RunResultsW[2]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - W-SpcCl"		Proj:RunResultsW[2]:PropNatGasSrc		= {	if (LocalRef( RunResultsW[2]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - W-SpcCl"		Proj:RunResultsW[2]:PropOtherSrc			= {	if (LocalRef( RunResultsW[2]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - W-SpcCl"		Proj:RunResultsW[2]:ProposedSrc[1]			= {	LocalRef( RunResultsW[2]:PropElecSrc[1] ) + LocalRef( RunResultsW[2]:PropNatGasSrc ) + LocalRef( RunResultsW[2]:PropOtherSrc )   }

  ; IAQ Ventilation Fans
	"Calculate Src - Elec   - W-IAQVent"	Proj:RunResultsW[3]:PropElecSrc[1]			= {	if (LocalRef( RunResultsW[3]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "FanV" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - W-IAQVent"	Proj:RunResultsW[3]:PropNatGasSrc		= {	0  }
	"Calculate Src - Other  - W-IAQVent"	Proj:RunResultsW[3]:PropOtherSrc			= {	0  }
	"Calculate Src - TOTAL  - W-IAQVent"	Proj:RunResultsW[3]:ProposedSrc[1]			= {	LocalRef( RunResultsW[3]:PropElecSrc[1] )   }

; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
  ; Other HVAC (aux & misc fans)
	"Calculate Src - Elec   - W-OthrHVAC"	Proj:RunResultsW[4]:PropElecSrc[1]		= {	if (LocalRef( RunResultsW[4]:PropElecEnergy[1] ) < 0.0001 .AND. OthrHVAC_SpcHtFrac == 0) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "User1" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - W-OthrHVAC"	Proj:RunResultsW[4]:PropNatGasSrc		= {	0  }
	"Calculate Src - Other  - W-OthrHVAC"	Proj:RunResultsW[4]:PropOtherSrc			= {	0  }
	"Calculate Src - TOTAL  - W-OthrHVAC"	Proj:RunResultsW[4]:ProposedSrc[1]		= {	LocalRef( RunResultsW[4]:PropElecSrc[1] )   }

; SAC 1/27/19 - REDISTRIBUTE OthrHVAC W-Prop Src across SpcHt & SpcCl by fuel based on ratio of total Src (across all fuels) (tic #1053)
   "Set OthrHVAC_SpcHtFrac - W-PropSrc"      Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResultsW[4]:ProposedSrc[1] != 0 )==0) then  0
                                                                           else if (IfValidAnd( RunResultsW[1]:ProposedSrc[1] == 0 ) .AND.
                                                                                    IfValidAnd( RunResultsW[2]:ProposedSrc[1] == 0 )) then  0.5
                                                                           else   ValidOr( RunResultsW[1]:ProposedSrc[1], 0 ) / 
                                                                                 (ValidOr( RunResultsW[1]:ProposedSrc[1], 0 ) + ValidOr( RunResultsW[2]:ProposedSrc[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Elec   - W-SpcHt"		Proj:RunResultsW[1]:PropElecSrc[1]	   = {   if (IfValidAnd( RunResultsW[4]:PropElecSrc[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsW[1]:PropElecSrc[1] + (RunResultsW[4]:PropElecSrc[1]     * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - NatGas - W-SpcHt"		Proj:RunResultsW[1]:PropNatGasSrc[1]	= {   if (IfValidAnd( RunResultsW[4]:PropNatGasSrc[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsW[1]:PropNatGasSrc[1] + (RunResultsW[4]:PropNatGasSrc[1] * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - Other  - W-SpcHt"		Proj:RunResultsW[1]:PropOtherSrc[1]	   = {   if (IfValidAnd( RunResultsW[4]:PropOtherSrc[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsW[1]:PropOtherSrc[1] + (RunResultsW[4]:PropOtherSrc[1]   * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - TOTAL  - W-SpcHt"		Proj:RunResultsW[1]:ProposedSrc[1]	   = {	LocalRef( RunResultsW[1]:PropElecSrc[1] ) + LocalRef( RunResultsW[1]:PropNatGasSrc[1] ) + LocalRef( RunResultsW[1]:PropOtherSrc[1] )   }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Elec   - W-SpcCl"		Proj:RunResultsW[2]:PropElecSrc[1]	   = {   if (IfValidAnd( RunResultsW[4]:PropElecSrc[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsW[2]:PropElecSrc[1] + (RunResultsW[4]:PropElecSrc[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - NatGas - W-SpcCl"		Proj:RunResultsW[2]:PropNatGasSrc[1]	= {   if (IfValidAnd( RunResultsW[4]:PropNatGasSrc[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsW[2]:PropNatGasSrc[1] + (RunResultsW[4]:PropNatGasSrc[1] * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - Other  - W-SpcCl"		Proj:RunResultsW[2]:PropOtherSrc[1]	   = {   if (IfValidAnd( RunResultsW[4]:PropOtherSrc[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsW[2]:PropOtherSrc[1] + (RunResultsW[4]:PropOtherSrc[1]   * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - TOTAL  - W-SpcCl"		Proj:RunResultsW[2]:ProposedSrc[1]	   = {	LocalRef( RunResultsW[2]:PropElecSrc[1] ) + LocalRef( RunResultsW[2]:PropNatGasSrc[1] ) + LocalRef( RunResultsW[2]:PropOtherSrc[1] )   }
  ; Other HVAC (aux & misc fans)
	"ZERO-OUT         - Elec   - W-OthrHVAC"	Proj:RunResultsW[4]:PropElecSrc[1]	   = {	0  }
	"ZERO-OUT         - NatGas - W-OthrHVAC"	Proj:RunResultsW[4]:PropNatGasSrc[1]	= {	0  }
	"ZERO-OUT         - Other  - W-OthrHVAC"	Proj:RunResultsW[4]:PropOtherSrc[1]	   = {	0  }
	"ZERO-OUT         - TOTAL  - W-OthrHVAC"	Proj:RunResultsW[4]:ProposedSrc[1]	   = {	0  }
   ; SAC 1/27/19 - end of - redistribution of OthrHVAC PropSrc

  ; Water Heating
	"Calculate Src - Elec   - W-WtrHt"		Proj:RunResultsW[5]:PropElecSrc[1]			= {	if (LocalRef( RunResultsW[5]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else if (CSEinclDHWMFL_EU)
			 			  																							then  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / CondFloorArea) + 0.5) / 100
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate Src - NatGas - W-WtrHt"		Proj:RunResultsW[5]:PropNatGasSrc		= {	if (LocalRef( RunResultsW[5]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - W-WtrHt"		Proj:RunResultsW[5]:PropOtherSrc			= {	if (LocalRef( RunResultsW[5]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - W-WtrHt"		Proj:RunResultsW[5]:ProposedSrc[1]			= {	LocalRef( RunResultsW[5]:PropElecSrc[1] ) + LocalRef( RunResultsW[5]:PropNatGasSrc ) + LocalRef( RunResultsW[5]:PropOtherSrc )   }

  ; Inside Lighting
	"Calculate Src - Elec   - W-InsLtg"		Proj:RunResultsW[6]:PropElecSrc[1]			= {	if (LocalRef( RunResultsW[6]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - W-InsLtg"		Proj:RunResultsW[6]:PropNatGasSrc		= {	if (LocalRef( RunResultsW[6]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - W-InsLtg"		Proj:RunResultsW[6]:PropOtherSrc			= {	if (LocalRef( RunResultsW[6]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - W-InsLtg"		Proj:RunResultsW[6]:ProposedSrc[1]			= {	LocalRef( RunResultsW[6]:PropElecSrc[1] ) + LocalRef( RunResultsW[6]:PropNatGasSrc ) + LocalRef( RunResultsW[6]:PropOtherSrc )   }

  ; Appliances & Cooking
	"Calculate Src - Elec   - W-AppCkg"		Proj:RunResultsW[7]:PropElecSrc[1]			= {	if (LocalRef( RunResultsW[7]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - W-AppCkg"		Proj:RunResultsW[7]:PropNatGasSrc		= {	if (LocalRef( RunResultsW[7]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - W-AppCkg"		Proj:RunResultsW[7]:PropOtherSrc			= {	if (LocalRef( RunResultsW[7]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - W-AppCkg"		Proj:RunResultsW[7]:ProposedSrc[1]			= {	LocalRef( RunResultsW[7]:PropElecSrc[1] ) + LocalRef( RunResultsW[7]:PropNatGasSrc ) + LocalRef( RunResultsW[7]:PropOtherSrc )   }

  ; Plug Loads
	"Calculate Src - Elec   - W-Plugs"		Proj:RunResultsW[8]:PropElecSrc[1]			= {	if (LocalRef( RunResultsW[8]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - W-Plugs"		Proj:RunResultsW[8]:PropNatGasSrc		= {	if (LocalRef( RunResultsW[8]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - W-Plugs"		Proj:RunResultsW[8]:PropOtherSrc			= {	if (LocalRef( RunResultsW[8]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - W-Plugs"		Proj:RunResultsW[8]:ProposedSrc[1]			= {	LocalRef( RunResultsW[8]:PropElecSrc[1] ) + LocalRef( RunResultsW[8]:PropNatGasSrc ) + LocalRef( RunResultsW[8]:PropOtherSrc )   }

  ; Exterior
	"Calculate Src - Elec   - W-Ext"			Proj:RunResultsW[9]:PropElecSrc[1]			= {	if (LocalRef( RunResultsW[9]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - W-Ext"			Proj:RunResultsW[9]:PropNatGasSrc		= {	if (LocalRef( RunResultsW[9]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - W-Ext"			Proj:RunResultsW[9]:PropOtherSrc			= {	if (LocalRef( RunResultsW[9]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - W-Ext"			Proj:RunResultsW[9]:ProposedSrc[1]			= {	LocalRef( RunResultsW[9]:PropElecSrc[1] ) + LocalRef( RunResultsW[9]:PropNatGasSrc ) + LocalRef( RunResultsW[9]:PropOtherSrc )   }

  ; PV
	"Calculate Src - Elec   - W-PV"			Proj:RunResultsW[13]:PropElecSrc[1]		=        ; added logic to calc Src energy for Community Solar projects - SAC 05/25/22 (tic #1321)
    { if (LocalRef( RunResultsW[13]:PropElecEnergy[1]		) > -0.0001) then  0
      else if (CommunitySolarProjID > 0 .AND. IfValidAnd( CmntySlr_SrcEnergy < 0 )) then  CmntySlr_SrcEnergy * PVWDCSizeMultiplier[1] / CondFloorArea
		else if (IfValidAnd( NetEnergyMeteringSrcAdj != 0))
      then  if (LocalRef( RunResultsW[14]:PropElecEnergy[1] ) = 0)
            then  int( (100 * ApplyHourlyResultMultipliers_NEM( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringSrcAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor          ) / CondFloorArea) + 0.5) / 100
            else  int( (100 * ApplyHourlyResultMultipliers_NEM( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringSrcAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, 1, "BT" ) / CondFloorArea) + 0.5) / 100  endif
      else        int( (100 * ApplyHourlyResultMultipliers(     "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "PV" ) / CondFloorArea) + 0.5) / 100  endif endif endif  }
	"Calculate Src - NatGas - W-PV"			Proj:RunResultsW[13]:PropNatGasSrc		= {	0  }
	"Calculate Src - Other  - W-PV"			Proj:RunResultsW[13]:PropOtherSrc		= {	0  }
	"Calculate Src - TOTAL  - W-PV"			Proj:RunResultsW[13]:ProposedSrc[1]		= {	LocalRef( RunResultsW[13]:PropElecSrc[1] )   }

  ; Battery
	"Calculate Src - Elec   - W-Battery"	Proj:RunResultsW[14]:PropElecSrc[1]		= {	if (LocalRef( RunResultsW[14]:PropElecEnergy[1]		) < 0.0001) then  0
		else if (IfValidAnd( NetEnergyMeteringSrcAdj != 0))
      then  if (LocalRef( RunResultsW[13]:PropElecEnergy[1] ) = 0)
            then  int( (100 * ApplyHourlyResultMultipliers_NEM( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "BT", "Tot", NetEnergyMeteringSrcAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor          ) / CondFloorArea) + 0.5) / 100
            else  int( (100 * ApplyHourlyResultMultipliers_NEM( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "BT", "Tot", NetEnergyMeteringSrcAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, 1, "PV" ) / CondFloorArea) + 0.5) / 100  endif
      else        int( (100 * ApplyHourlyResultMultipliers(     "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "BT" ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate Src - NatGas - W-Battery"	Proj:RunResultsW[14]:PropNatGasSrc		= {	0  }
	"Calculate Src - Other  - W-Battery"	Proj:RunResultsW[14]:PropOtherSrc		= {	0  }
	"Calculate Src - TOTAL  - W-Battery"	Proj:RunResultsW[14]:ProposedSrc[1]		= {	LocalRef( RunResultsW[14]:PropElecSrc[1] )   }

  ; Compliance Total
	"Calculate Src - Elec   - W-Comp Ttl"	Proj:RunResultsW[11]:PropElecSrc[1]			= {	RunResultsW[1]:PropElecSrc[1]    + RunResultsW[2]:PropElecSrc[1]    + RunResultsW[3]:PropElecSrc[1]    + RunResultsW[4]:PropElecSrc[1]    + RunResultsW[5]:PropElecSrc[1]     }
	"Calculate Src - NatGas - W-Comp Ttl"	Proj:RunResultsW[11]:PropNatGasSrc		= {	RunResultsW[1]:PropNatGasSrc  + RunResultsW[2]:PropNatGasSrc  + RunResultsW[3]:PropNatGasSrc  + RunResultsW[4]:PropNatGasSrc  + RunResultsW[5]:PropNatGasSrc   }
	"Calculate Src - Other  - W-Comp Ttl"	Proj:RunResultsW[11]:PropOtherSrc		= {	RunResultsW[1]:PropOtherSrc   + RunResultsW[2]:PropOtherSrc   + RunResultsW[3]:PropOtherSrc   + RunResultsW[4]:PropOtherSrc   + RunResultsW[5]:PropOtherSrc    }
	"Calculate Src - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:ProposedSrc[1]			= {	RunResultsW[1]:ProposedSrc[1]    + RunResultsW[2]:ProposedSrc[1]    + RunResultsW[3]:ProposedSrc[1]    + RunResultsW[4]:ProposedSrc[1]    + RunResultsW[5]:ProposedSrc[1]     }

  ; Total
	"Calculate Src - Elec   - W-Total"		Proj:RunResultsW[10]:PropElecSrc[1]			= {	RunResultsW[11]:PropElecSrc[1]    + RunResultsW[6]:PropElecSrc[1]    + RunResultsW[7]:PropElecSrc[1]    + RunResultsW[8]:PropElecSrc[1]    + RunResultsW[9]:PropElecSrc[1]     }
	"Calculate Src - NatGas - W-Total"		Proj:RunResultsW[10]:PropNatGasSrc		= {	RunResultsW[11]:PropNatGasSrc  + RunResultsW[6]:PropNatGasSrc  + RunResultsW[7]:PropNatGasSrc  + RunResultsW[8]:PropNatGasSrc  + RunResultsW[9]:PropNatGasSrc   }
	"Calculate Src - Other  - W-Total"		Proj:RunResultsW[10]:PropOtherSrc		= {	RunResultsW[11]:PropOtherSrc   + RunResultsW[6]:PropOtherSrc   + RunResultsW[7]:PropOtherSrc   + RunResultsW[8]:PropOtherSrc   + RunResultsW[9]:PropOtherSrc    }
	"Calculate Src - TOTAL  - W-Total"		Proj:RunResultsW[10]:ProposedSrc[1]			= {	RunResultsW[11]:ProposedSrc[1]    + RunResultsW[6]:ProposedSrc[1]    + RunResultsW[7]:ProposedSrc[1]    + RunResultsW[8]:ProposedSrc[1]    + RunResultsW[9]:ProposedSrc[1]     }
   ; SAC 4/28/17 - shifted PV & Batt from CompTot to Tot for 2019
   ; SAC 4/28/17 - add in only Battery to Total for 2016
	"Add in PV Src - Elec   - W-Total"	   Proj:RunResultsW[10]:PropElecSrc[1]	   = {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                       else if (EnergyCodeYearNum < 2019) 
                                                                                       then  RunResultsW[10]:PropElecSrc[1]    + RunResultsW[14]:PropElecSrc[1]
                                                                                       else  RunResultsW[10]:PropElecSrc[1]    + RunResultsW[13]:PropElecSrc[1]    + RunResultsW[14]:PropElecSrc[1]     endif endif   }
	"Add in PV Src - TOTAL  - W-Total"	   Proj:RunResultsW[10]:ProposedSrc[1]  	= {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                       else if (EnergyCodeYearNum < 2019) 
                                                                                       then  RunResultsW[10]:ProposedSrc[1]    + RunResultsW[14]:ProposedSrc[1]
                                                                                       else  RunResultsW[10]:ProposedSrc[1]    + RunResultsW[13]:ProposedSrc[1]    + RunResultsW[14]:ProposedSrc[1]     endif endif   }
END


;*************************************************************************
RULELIST "CARes_DRtgPropMultSrcEnergyResults" 1 0 0 1
;*************************************************************************
	"Calculate Src - TOTAL  - SpcHt"			Proj:RunResults[1]:ProposedSrc[3]			= {	LocalRef( RunResults[1]:PropElecSrc[1] ) + LocalRef( RunResults[1]:PropNatGasSrc ) + LocalRef( RunResults[1]:PropOtherSrc )  }
	"Calculate Src - TOTAL  - SpcCl"			Proj:RunResults[2]:ProposedSrc[3]			= {	LocalRef( RunResults[2]:PropElecSrc[1] ) + LocalRef( RunResults[2]:PropNatGasSrc ) + LocalRef( RunResults[2]:PropOtherSrc )  }
	"Calculate Src - TOTAL  - IAQVent"		Proj:RunResults[3]:ProposedSrc[3]			= {	LocalRef( RunResults[3]:PropElecSrc[1] )   }
	"Calculate Src - TOTAL  - OthrHVAC"		Proj:RunResults[4]:ProposedSrc[3]			= {	RunResults[4]:ProposedSrc[1]  }
	"Calculate Src - TOTAL  - WtrHt"			Proj:RunResults[5]:ProposedSrc[3]			= {	LocalRef( RunResults[5]:PropElecSrc[1] ) + LocalRef( RunResults[5]:PropNatGasSrc ) + LocalRef( RunResults[5]:PropOtherSrc )  }
	"Calculate Src - TOTAL  - InsLtg"		Proj:RunResults[6]:ProposedSrc[3]			= {	RunResults[6]:ProposedSrc[1]  }
	"Calculate Src - TOTAL  - AppCkg"		Proj:RunResults[7]:ProposedSrc[3]			= {	LocalRef( RunResults[7]:PropElecSrc[1] ) + LocalRef( RunResults[7]:PropNatGasSrc ) + LocalRef( RunResults[7]:PropOtherSrc )  }
	"Calculate Src - TOTAL  - Plugs"			Proj:RunResults[8]:ProposedSrc[3]			= {	RunResults[8]:ProposedSrc[1]  }
	"Calculate Src - TOTAL  - Ext"			Proj:RunResults[9]:ProposedSrc[3]			= {	RunResults[9]:ProposedSrc[1]  }
	"Calculate Src - TOTAL  - PV"				Proj:RunResults[13]:ProposedSrc[3]			= {	RunResults[13]:ProposedSrc[1]   }
	"Calculate Src - TOTAL  - Battery"		Proj:RunResults[14]:ProposedSrc[3]			= {	RunResults[14]:ProposedSrc[1]   }

	"Calculate Src - TOTAL  - Comp Ttl"		Proj:RunResults[11]:ProposedSrc[3]			= {	RunResults[1]:ProposedSrc[3]    + RunResults[2]:ProposedSrc[3]    + RunResults[3]:ProposedSrc[3]    + RunResults[4]:ProposedSrc[3]    + RunResults[5]:ProposedSrc[3]     }
	"Calculate Src - TOTAL  - Total"			Proj:RunResults[10]:ProposedSrc[3]			= {	RunResults[11]:ProposedSrc[3]   + RunResults[6]:ProposedSrc[3]    + RunResults[7]:ProposedSrc[3]    + RunResults[8]:ProposedSrc[3]    + RunResults[9]:ProposedSrc[3]     }
END

;*************************************************************************  - SAC 3/14/16
RULELIST "CARes_DRtgPropMultSrcEnergyResults_N" 1 0 0 1
;*************************************************************************
	"Calculate Src - TOTAL  - N-SpcHt"		Proj:RunResultsN[1]:ProposedSrc[3]			= {	LocalRef( RunResultsN[1]:PropElecSrc[1] ) + LocalRef( RunResultsN[1]:PropNatGasSrc ) + LocalRef( RunResultsN[1]:PropOtherSrc )  }
	"Calculate Src - TOTAL  - N-SpcCl"		Proj:RunResultsN[2]:ProposedSrc[3]			= {	LocalRef( RunResultsN[2]:PropElecSrc[1] ) + LocalRef( RunResultsN[2]:PropNatGasSrc ) + LocalRef( RunResultsN[2]:PropOtherSrc )  }
	"Calculate Src - TOTAL  - N-IAQVent"	Proj:RunResultsN[3]:ProposedSrc[3]			= {	LocalRef( RunResultsN[3]:PropElecSrc[1] )   }
	"Calculate Src - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:ProposedSrc[3]			= {	RunResultsN[4]:ProposedSrc[1]  }
	"Calculate Src - TOTAL  - N-WtrHt"		Proj:RunResultsN[5]:ProposedSrc[3]			= {	LocalRef( RunResultsN[5]:PropElecSrc[1] ) + LocalRef( RunResultsN[5]:PropNatGasSrc ) + LocalRef( RunResultsN[5]:PropOtherSrc )  }
	"Calculate Src - TOTAL  - N-InsLtg"		Proj:RunResultsN[6]:ProposedSrc[3]			= {	RunResultsN[6]:ProposedSrc[1]  }
	"Calculate Src - TOTAL  - N-AppCkg"		Proj:RunResultsN[7]:ProposedSrc[3]			= {	LocalRef( RunResultsN[7]:PropElecSrc[1] ) + LocalRef( RunResultsN[7]:PropNatGasSrc ) + LocalRef( RunResultsN[7]:PropOtherSrc )  }
	"Calculate Src - TOTAL  - N-Plugs"		Proj:RunResultsN[8]:ProposedSrc[3]			= {	RunResultsN[8]:ProposedSrc[1]  }
	"Calculate Src - TOTAL  - N-Ext"			Proj:RunResultsN[9]:ProposedSrc[3]			= {	RunResultsN[9]:ProposedSrc[1]  }
	"Calculate Src - TOTAL  - N-PV"			Proj:RunResultsN[13]:ProposedSrc[3]			= {	RunResultsN[13]:ProposedSrc[1]   }
	"Calculate Src - TOTAL  - N-Battery"	Proj:RunResultsN[14]:ProposedSrc[3]			= {	RunResultsN[14]:ProposedSrc[1]   }

	"Calculate Src - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:ProposedSrc[3]			= {	RunResultsN[1]:ProposedSrc[3]    + RunResultsN[2]:ProposedSrc[3]    + RunResultsN[3]:ProposedSrc[3]    + RunResultsN[4]:ProposedSrc[3]    + RunResultsN[5]:ProposedSrc[3]     }
	"Calculate Src - TOTAL  - N-Total"		Proj:RunResultsN[10]:ProposedSrc[3]			= {	RunResultsN[11]:ProposedSrc[3]    + RunResultsN[6]:ProposedSrc[3]    + RunResultsN[7]:ProposedSrc[3]    + RunResultsN[8]:ProposedSrc[3]    + RunResultsN[9]:ProposedSrc[3]     }
END

;*************************************************************************  - SAC 3/14/16
RULELIST "CARes_DRtgPropMultSrcEnergyResults_E" 1 0 0 1
;*************************************************************************
	"Calculate Src - TOTAL  - E-SpcHt"		Proj:RunResultsE[1]:ProposedSrc[3]			= {	LocalRef( RunResultsE[1]:PropElecSrc[1] ) + LocalRef( RunResultsE[1]:PropNatGasSrc ) + LocalRef( RunResultsE[1]:PropOtherSrc )  }
	"Calculate Src - TOTAL  - E-SpcCl"		Proj:RunResultsE[2]:ProposedSrc[3]			= {	LocalRef( RunResultsE[2]:PropElecSrc[1] ) + LocalRef( RunResultsE[2]:PropNatGasSrc ) + LocalRef( RunResultsE[2]:PropOtherSrc )  }
	"Calculate Src - TOTAL  - E-IAQVent"	Proj:RunResultsE[3]:ProposedSrc[3]			= {	LocalRef( RunResultsE[3]:PropElecSrc[1] )   }
	"Calculate Src - TOTAL  - E-OthrHVAC"	Proj:RunResultsE[4]:ProposedSrc[3]			= {	RunResultsE[4]:ProposedSrc[1]  }
	"Calculate Src - TOTAL  - E-WtrHt"		Proj:RunResultsE[5]:ProposedSrc[3]			= {	LocalRef( RunResultsE[5]:PropElecSrc[1] ) + LocalRef( RunResultsE[5]:PropNatGasSrc ) + LocalRef( RunResultsE[5]:PropOtherSrc )  }
	"Calculate Src - TOTAL  - E-InsLtg"		Proj:RunResultsE[6]:ProposedSrc[3]			= {	RunResultsE[6]:ProposedSrc[1]  }
	"Calculate Src - TOTAL  - E-AppCkg"		Proj:RunResultsE[7]:ProposedSrc[3]			= {	LocalRef( RunResultsE[7]:PropElecSrc[1] ) + LocalRef( RunResultsE[7]:PropNatGasSrc ) + LocalRef( RunResultsE[7]:PropOtherSrc )  }
	"Calculate Src - TOTAL  - E-Plugs"		Proj:RunResultsE[8]:ProposedSrc[3]			= {	RunResultsE[8]:ProposedSrc[1]  }
	"Calculate Src - TOTAL  - E-Ext"			Proj:RunResultsE[9]:ProposedSrc[3]			= {	RunResultsE[9]:ProposedSrc[1]  }
	"Calculate Src - TOTAL  - E-PV"			Proj:RunResultsE[13]:ProposedSrc[3]			= {	RunResultsE[13]:ProposedSrc[1]   }
	"Calculate Src - TOTAL  - E-Battery"	Proj:RunResultsE[14]:ProposedSrc[3]			= {	RunResultsE[14]:ProposedSrc[1]   }

	"Calculate Src - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:ProposedSrc[3]			= {	RunResultsE[1]:ProposedSrc[3]    + RunResultsE[2]:ProposedSrc[3]    + RunResultsE[3]:ProposedSrc[3]    + RunResultsE[4]:ProposedSrc[3]    + RunResultsE[5]:ProposedSrc[3]     }
	"Calculate Src - TOTAL  - E-Total"		Proj:RunResultsE[10]:ProposedSrc[3]			= {	RunResultsE[11]:ProposedSrc[3]    + RunResultsE[6]:ProposedSrc[3]    + RunResultsE[7]:ProposedSrc[3]    + RunResultsE[8]:ProposedSrc[3]    + RunResultsE[9]:ProposedSrc[3]     }
END

;*************************************************************************  - SAC 3/14/16
RULELIST "CARes_DRtgPropMultSrcEnergyResults_S" 1 0 0 1
;*************************************************************************
	"Calculate Src - TOTAL  - S-SpcHt"		Proj:RunResultsS[1]:ProposedSrc[3]			= {	LocalRef( RunResultsS[1]:PropElecSrc[1] ) + LocalRef( RunResultsS[1]:PropNatGasSrc ) + LocalRef( RunResultsS[1]:PropOtherSrc )  }
	"Calculate Src - TOTAL  - S-SpcCl"		Proj:RunResultsS[2]:ProposedSrc[3]			= {	LocalRef( RunResultsS[2]:PropElecSrc[1] ) + LocalRef( RunResultsS[2]:PropNatGasSrc ) + LocalRef( RunResultsS[2]:PropOtherSrc )  }
	"Calculate Src - TOTAL  - S-IAQVent"	Proj:RunResultsS[3]:ProposedSrc[3]			= {	LocalRef( RunResultsS[3]:PropElecSrc[1] )   }
	"Calculate Src - TOTAL  - S-OthrHVAC"	Proj:RunResultsS[4]:ProposedSrc[3]			= {	RunResultsS[4]:ProposedSrc[1]  }
	"Calculate Src - TOTAL  - S-WtrHt"		Proj:RunResultsS[5]:ProposedSrc[3]			= {	LocalRef( RunResultsS[5]:PropElecSrc[1] ) + LocalRef( RunResultsS[5]:PropNatGasSrc ) + LocalRef( RunResultsS[5]:PropOtherSrc )  }
	"Calculate Src - TOTAL  - S-InsLtg"		Proj:RunResultsS[6]:ProposedSrc[3]			= {	RunResultsS[6]:ProposedSrc[1]  }
	"Calculate Src - TOTAL  - S-AppCkg"		Proj:RunResultsS[7]:ProposedSrc[3]			= {	LocalRef( RunResultsS[7]:PropElecSrc[1] ) + LocalRef( RunResultsS[7]:PropNatGasSrc ) + LocalRef( RunResultsS[7]:PropOtherSrc )  }
	"Calculate Src - TOTAL  - S-Plugs"		Proj:RunResultsS[8]:ProposedSrc[3]			= {	RunResultsS[8]:ProposedSrc[1]  }
	"Calculate Src - TOTAL  - S-Ext"			Proj:RunResultsS[9]:ProposedSrc[3]			= {	RunResultsS[9]:ProposedSrc[1]  }
	"Calculate Src - TOTAL  - S-PV"			Proj:RunResultsS[13]:ProposedSrc[3]			= {	RunResultsS[13]:ProposedSrc[1]   }
	"Calculate Src - TOTAL  - S-Battery"	Proj:RunResultsS[14]:ProposedSrc[3]			= {	RunResultsS[14]:ProposedSrc[1]   }

	"Calculate Src - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:ProposedSrc[3]			= {	RunResultsS[1]:ProposedSrc[3]    + RunResultsS[2]:ProposedSrc[3]    + RunResultsS[3]:ProposedSrc[3]    + RunResultsS[4]:ProposedSrc[3]    + RunResultsS[5]:ProposedSrc[3]     }
	"Calculate Src - TOTAL  - S-Total"		Proj:RunResultsS[10]:ProposedSrc[3]			= {	RunResultsS[11]:ProposedSrc[3]    + RunResultsS[6]:ProposedSrc[3]    + RunResultsS[7]:ProposedSrc[3]    + RunResultsS[8]:ProposedSrc[3]    + RunResultsS[9]:ProposedSrc[3]     }
END

;*************************************************************************  - SAC 3/14/16
RULELIST "CARes_DRtgPropMultSrcEnergyResults_W" 1 0 0 1
;*************************************************************************
	"Calculate Src - TOTAL  - W-SpcHt"		Proj:RunResultsW[1]:ProposedSrc[3]			= {	LocalRef( RunResultsW[1]:PropElecSrc[1] ) + LocalRef( RunResultsW[1]:PropNatGasSrc ) + LocalRef( RunResultsW[1]:PropOtherSrc )  }
	"Calculate Src - TOTAL  - W-SpcCl"		Proj:RunResultsW[2]:ProposedSrc[3]			= {	LocalRef( RunResultsW[2]:PropElecSrc[1] ) + LocalRef( RunResultsW[2]:PropNatGasSrc ) + LocalRef( RunResultsW[2]:PropOtherSrc )  }
	"Calculate Src - TOTAL  - W-IAQVent"	Proj:RunResultsW[3]:ProposedSrc[3]			= {	LocalRef( RunResultsW[3]:PropElecSrc[1] )   }
	"Calculate Src - TOTAL  - W-OthrHVAC"	Proj:RunResultsW[4]:ProposedSrc[3]			= {	RunResultsW[4]:ProposedSrc[1]  }
	"Calculate Src - TOTAL  - W-WtrHt"		Proj:RunResultsW[5]:ProposedSrc[3]			= {	LocalRef( RunResultsW[5]:PropElecSrc[1] ) + LocalRef( RunResultsW[5]:PropNatGasSrc ) + LocalRef( RunResultsW[5]:PropOtherSrc )  }
	"Calculate Src - TOTAL  - W-InsLtg"		Proj:RunResultsW[6]:ProposedSrc[3]			= {	RunResultsW[6]:ProposedSrc[1]  }
	"Calculate Src - TOTAL  - W-AppCkg"		Proj:RunResultsW[7]:ProposedSrc[3]			= {	LocalRef( RunResultsW[7]:PropElecSrc[1] ) + LocalRef( RunResultsW[7]:PropNatGasSrc ) + LocalRef( RunResultsW[7]:PropOtherSrc )  }
	"Calculate Src - TOTAL  - W-Plugs"		Proj:RunResultsW[8]:ProposedSrc[3]			= {	RunResultsW[8]:ProposedSrc[1]  }
	"Calculate Src - TOTAL  - W-Ext"			Proj:RunResultsW[9]:ProposedSrc[3]			= {	RunResultsW[9]:ProposedSrc[1]  }
	"Calculate Src - TOTAL  - W-PV"			Proj:RunResultsW[13]:ProposedSrc[3]			= {	RunResultsW[13]:ProposedSrc[1]   }
	"Calculate Src - TOTAL  - W-Battery"	Proj:RunResultsW[14]:ProposedSrc[3]			= {	RunResultsW[14]:ProposedSrc[1]   }

	"Calculate Src - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:ProposedSrc[3]			= {	RunResultsW[1]:ProposedSrc[3]    + RunResultsW[2]:ProposedSrc[3]    + RunResultsW[3]:ProposedSrc[3]    + RunResultsW[4]:ProposedSrc[3]    + RunResultsW[5]:ProposedSrc[3]     }
	"Calculate Src - TOTAL  - W-Total"		Proj:RunResultsW[10]:ProposedSrc[3]			= {	RunResultsW[11]:ProposedSrc[3]    + RunResultsW[6]:ProposedSrc[3]    + RunResultsW[7]:ProposedSrc[3]    + RunResultsW[8]:ProposedSrc[3]    + RunResultsW[9]:ProposedSrc[3]     }
END


;*************************************************************************
RULELIST "CARes_StandardSrcEnergyResults" 1 0 0 1
;*************************************************************************
; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
         ; SAC 8/24/19 - replaced 1/3.413 & 0.01 EDR1 table multipliers with Proj:SrcSecMult_Elec & SrcSecMult_Fuel to accommodate 2022+ switch to native (E3) EDR1 table units
         ; SAC 8/26/19 - added primary table multipliers (of 1.0) to all ApplyHourlyResultMult* function calls (to accommodate 2022+ TDV table unit switch)
  ; Space Heating (& heating fan)
	"Calculate Src - Elec   - SpcHt"		Proj:RunResults[1]:StdElecSrc				= {	if (LocalRef( RunResults[1]:StdElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - SpcHt"		Proj:RunResults[1]:StdNatGasSrc			= {	if (LocalRef( RunResults[1]:StdNatGasEnergy		) < 0.0001) then  0                                                                                                        
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - SpcHt"		Proj:RunResults[1]:StdOtherSrc			= {	if (LocalRef( RunResults[1]:StdOtherEnergy		) < 0.0001) then  0                                                                                                        
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - SpcHt"		Proj:RunResults[1]:StandardSrc			= {	LocalRef( RunResults[1]:StdElecSrc ) + LocalRef( RunResults[1]:StdNatGasSrc ) + LocalRef( RunResults[1]:StdOtherSrc )   }

  ; Space Cooling (& cooling fan)
	"Calculate Src - Elec   - SpcCl"		Proj:RunResults[2]:StdElecSrc				= {	if (LocalRef( RunResults[2]:StdElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - SpcCl"		Proj:RunResults[2]:StdNatGasSrc			= {	if (LocalRef( RunResults[2]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - SpcCl"		Proj:RunResults[2]:StdOtherSrc			= {	if (LocalRef( RunResults[2]:StdOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - SpcCl"		Proj:RunResults[2]:StandardSrc			= {	LocalRef( RunResults[2]:StdElecSrc ) + LocalRef( RunResults[2]:StdNatGasSrc ) + LocalRef( RunResults[2]:StdOtherSrc )   }

  ; IAQ Ventilation Fans
	"Calculate Src - Elec   - IAQVent"	Proj:RunResults[3]:StdElecSrc				= {	if (LocalRef( RunResults[3]:StdElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "FanV" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - IAQVent"	Proj:RunResults[3]:StdNatGasSrc			= {	0  }
	"Calculate Src - Other  - IAQVent"	Proj:RunResults[3]:StdOtherSrc			= {	0  }
	"Calculate Src - TOTAL  - IAQVent"	Proj:RunResults[3]:StandardSrc			= {	LocalRef( RunResults[3]:StdElecSrc )   }

  ; Other HVAC (aux & misc fans)
   ; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
   ; SAC 11/15/18 - restored "Other HVAC" [4] to handle VCHP CFan via "User1" enduse
	"Calculate Src - Elec   - OthrHVAC"	Proj:RunResults[4]:StdElecSrc				= {	if (LocalRef( RunResults[4]:StdElecEnergy ) < 0.0001 .AND. OthrHVAC_SpcHtFrac == 0) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "User1" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - OthrHVAC"	Proj:RunResults[4]:StdNatGasSrc			= {	0  }
	"Calculate Src - Other  - OthrHVAC"	Proj:RunResults[4]:StdOtherSrc			= {	0  }
	"Calculate Src - TOTAL  - OthrHVAC"	Proj:RunResults[4]:StandardSrc			= {	RunResults[4]:StdElecSrc  }

; SAC 1/27/19 - REDISTRIBUTE OthrHVAC Std Src across SpcHt & SpcCl by fuel based on ratio of total Src (across all fuels) (tic #1053)
   "Set OthrHVAC_SpcHtFrac - StdSrc"      Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResults[4]:StandardSrc[1] != 0 )==0) then  0
                                                                        else if (IfValidAnd( RunResults[1]:StandardSrc[1] == 0 ) .AND.
                                                                                 IfValidAnd( RunResults[2]:StandardSrc[1] == 0 )) then  0.5
                                                                        else   ValidOr( RunResults[1]:StandardSrc[1], 0 ) / 
                                                                              (ValidOr( RunResults[1]:StandardSrc[1], 0 ) + ValidOr( RunResults[2]:StandardSrc[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Elec   - SpcHt"		Proj:RunResults[1]:StdElecSrc[1]	   = {   if (IfValidAnd( RunResults[4]:StdElecSrc[1] != 0 )==0) then  UNCHANGED
                                                                                    else  RunResults[1]:StdElecSrc[1] + (RunResults[4]:StdElecSrc[1]     * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - TOTAL  - SpcHt"		Proj:RunResults[1]:StandardSrc[1]	= {	LocalRef( RunResults[1]:StdElecSrc[1] ) + LocalRef( RunResults[1]:StdNatGasSrc[1] ) + LocalRef( RunResults[1]:StdOtherSrc[1] )   }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Elec   - SpcCl"		Proj:RunResults[2]:StdElecSrc[1]	   = {   if (IfValidAnd( RunResults[4]:StdElecSrc[1] != 0 )==0) then  UNCHANGED
                                                                                    else  RunResults[2]:StdElecSrc[1] + (RunResults[4]:StdElecSrc[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - TOTAL  - SpcCl"		Proj:RunResults[2]:StandardSrc[1]	= {	LocalRef( RunResults[2]:StdElecSrc[1] ) + LocalRef( RunResults[2]:StdNatGasSrc[1] ) + LocalRef( RunResults[2]:StdOtherSrc[1] )   }
  ; Other HVAC (aux & misc fans)
	"ZERO-OUT         - Elec   - OthrHVAC"	Proj:RunResults[4]:StdElecSrc[1]	   = {	0  }
	"ZERO-OUT         - NatGas - OthrHVAC"	Proj:RunResults[4]:StdNatGasSrc[1]	= {	0  }
	"ZERO-OUT         - Other  - OthrHVAC"	Proj:RunResults[4]:StdOtherSrc[1]	= {	0  }
	"ZERO-OUT         - TOTAL  - OthrHVAC"	Proj:RunResults[4]:StandardSrc[1]	= {	0  }
   ; SAC 1/27/19 - end of - redistribution of OthrHVAC StdSrc

  ; Water Heating
	"Calculate Src - Elec   - WtrHt"		Proj:RunResults[5]:StdElecSrc				= {	if (LocalRef( RunResults[5]:StdElecEnergy		) < 0.0001) then  0
			 			  																						else if (CSEinclDHWMFL_EU)
			 			  																				      then  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / CondFloorArea) + 0.5) / 100 
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate Src - NatGas - WtrHt"		Proj:RunResults[5]:StdNatGasSrc			= {	if (LocalRef( RunResults[5]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - WtrHt"		Proj:RunResults[5]:StdOtherSrc			= {	if (LocalRef( RunResults[5]:StdOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - WtrHt"		Proj:RunResults[5]:StandardSrc			= {	LocalRef( RunResults[5]:StdElecSrc ) + LocalRef( RunResults[5]:StdNatGasSrc ) + LocalRef( RunResults[5]:StdOtherSrc )   }

  ; Inside Lighting
	"Calculate Src - Elec   - InsLtg"	Proj:RunResults[6]:StdElecSrc				= {	if (LocalRef( RunResults[6]:StdElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - InsLtg"	Proj:RunResults[6]:StdNatGasSrc			= {	if (LocalRef( RunResults[6]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - InsLtg"	Proj:RunResults[6]:StdOtherSrc			= {	if (LocalRef( RunResults[6]:StdOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - InsLtg"	Proj:RunResults[6]:StandardSrc			= {	LocalRef( RunResults[6]:StdElecSrc ) + LocalRef( RunResults[6]:StdNatGasSrc ) + LocalRef( RunResults[6]:StdOtherSrc )   }

  ; Appliances & Cooking
	"Calculate Src - Elec   - AppCkg"	Proj:RunResults[7]:StdElecSrc				= {	if (LocalRef( RunResults[7]:StdElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - AppCkg"	Proj:RunResults[7]:StdNatGasSrc			= {	if (LocalRef( RunResults[7]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - AppCkg"	Proj:RunResults[7]:StdOtherSrc			= {	if (LocalRef( RunResults[7]:StdOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - AppCkg"	Proj:RunResults[7]:StandardSrc			= {	LocalRef( RunResults[7]:StdElecSrc ) + LocalRef( RunResults[7]:StdNatGasSrc ) + LocalRef( RunResults[7]:StdOtherSrc )   }

  ; Plug Loads
	"Calculate Src - Elec   - Plugs"		Proj:RunResults[8]:StdElecSrc				= {	if (LocalRef( RunResults[8]:StdElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - Plugs"		Proj:RunResults[8]:StdNatGasSrc			= {	if (LocalRef( RunResults[8]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - Plugs"		Proj:RunResults[8]:StdOtherSrc			= {	if (LocalRef( RunResults[8]:StdOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - Plugs"		Proj:RunResults[8]:StandardSrc			= {	LocalRef( RunResults[8]:StdElecSrc ) + LocalRef( RunResults[8]:StdNatGasSrc ) + LocalRef( RunResults[8]:StdOtherSrc )   }

  ; Exterior
	"Calculate Src - Elec   - Ext"		Proj:RunResults[9]:StdElecSrc				= {	if (LocalRef( RunResults[9]:StdElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - Ext"		Proj:RunResults[9]:StdNatGasSrc			= {	if (LocalRef( RunResults[9]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - Ext"		Proj:RunResults[9]:StdOtherSrc			= {	if (LocalRef( RunResults[9]:StdOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - Ext"		Proj:RunResults[9]:StandardSrc			= {	LocalRef( RunResults[9]:StdElecSrc ) + LocalRef( RunResults[9]:StdNatGasSrc ) + LocalRef( RunResults[9]:StdOtherSrc )   }

  ; PV
   ; mods to calc NEM-adjusted PV Src (StdElecSrc) for 2019 analysis
	"Calculate Src - Elec   - PV"			Proj:RunResults[13]:StdElecSrc			= {	if (LocalRef( RunResults[13]:StdElecEnergy		) > -0.0001) then  0
		else if (IfValidAnd( NetEnergyMeteringSrcAdj != 0))
      then  if (LocalRef( RunResults[14]:PropElecEnergy[1] ) = 0)
            then  int( (100 * ApplyHourlyResultMultipliers_NEM( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringSrcAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor          ) / CondFloorArea) + 0.5) / 100
            else  int( (100 * ApplyHourlyResultMultipliers_NEM( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringSrcAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, 1, "BT" ) / CondFloorArea) + 0.5) / 100  endif
      else        int( (100 * ApplyHourlyResultMultipliers(     "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "PV" ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate Src - NatGas - PV"			Proj:RunResults[13]:StdNatGasSrc			= {	0  }
	"Calculate Src - Other  - PV"			Proj:RunResults[13]:StdOtherSrc			= {	0  }
	"Calculate Src - TOTAL  - PV"			Proj:RunResults[13]:StandardSrc			= {	LocalRef( RunResults[13]:StdElecSrc )   }

  ; Battery
   ; mods to calc NEM-adjusted Battery Src (StdElecSrc) for 2019 analysis
	"Calculate Src - Elec   - Battery"	Proj:RunResults[14]:StdElecSrc			= {	if (LocalRef( RunResults[14]:StdElecEnergy		) < 0.0001) then  0
		else if (IfValidAnd( NetEnergyMeteringSrcAdj != 0))
      then  if (LocalRef( RunResults[13]:PropElecEnergy[1] ) = 0)
            then  int( (100 * ApplyHourlyResultMultipliers_NEM( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "BT", "Tot", NetEnergyMeteringSrcAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor          ) / CondFloorArea) + 0.5) / 100
            else  int( (100 * ApplyHourlyResultMultipliers_NEM( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "BT", "Tot", NetEnergyMeteringSrcAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, 1, "PV" ) / CondFloorArea) + 0.5) / 100  endif
      else        int( (100 * ApplyHourlyResultMultipliers(     "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "BT" ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate Src - NatGas - Battery"	Proj:RunResults[14]:StdNatGasSrc			= {	0  }
	"Calculate Src - Other  - Battery"	Proj:RunResults[14]:StdOtherSrc			= {	0  }
	"Calculate Src - TOTAL  - Battery"	Proj:RunResults[14]:StandardSrc			= {	LocalRef( RunResults[14]:StdElecSrc )   }

  ; Compliance Total
  ; SAC 1/14/13 - added in PVCredit to Std (elec) Src
; mjb-10/16/13	remove PVCredit from Std Design
	"Calculate Src - Elec   - Comp Ttl"	Proj:RunResults[11]:StdElecSrc			= {	RunResults[1]:StdElecSrc    + RunResults[2]:StdElecSrc    + RunResults[3]:StdElecSrc    + RunResults[4]:StdElecSrc    + RunResults[5]:StdElecSrc     }
	"Calculate Src - NatGas - Comp Ttl"	Proj:RunResults[11]:StdNatGasSrc			= {	RunResults[1]:StdNatGasSrc  + RunResults[2]:StdNatGasSrc  + RunResults[3]:StdNatGasSrc  + RunResults[4]:StdNatGasSrc  + RunResults[5]:StdNatGasSrc   }
	"Calculate Src - Other  - Comp Ttl"	Proj:RunResults[11]:StdOtherSrc			= {	RunResults[1]:StdOtherSrc   + RunResults[2]:StdOtherSrc   + RunResults[3]:StdOtherSrc   + RunResults[4]:StdOtherSrc   + RunResults[5]:StdOtherSrc    }
	"Calculate Src - TOTAL  - Comp Ttl"	Proj:RunResults[11]:StandardSrc			= {	RunResults[1]:StandardSrc   + RunResults[2]:StandardSrc   + RunResults[3]:StandardSrc   + RunResults[4]:StandardSrc   + RunResults[5]:StandardSrc    }

  ; Total
	"Calculate Src - Elec   - Total"		Proj:RunResults[10]:StdElecSrc			= {	RunResults[11]:StdElecSrc    + RunResults[6]:StdElecSrc    + RunResults[7]:StdElecSrc    + RunResults[8]:StdElecSrc    + RunResults[9]:StdElecSrc    + RunResults[13]:StdElecSrc    + RunResults[14]:StdElecSrc     }
	"Calculate Src - NatGas - Total"		Proj:RunResults[10]:StdNatGasSrc			= {	RunResults[11]:StdNatGasSrc  + RunResults[6]:StdNatGasSrc  + RunResults[7]:StdNatGasSrc  + RunResults[8]:StdNatGasSrc  + RunResults[9]:StdNatGasSrc  + RunResults[13]:StdNatGasSrc  + RunResults[14]:StdNatGasSrc   }
	"Calculate Src - Other  - Total"		Proj:RunResults[10]:StdOtherSrc			= {	RunResults[11]:StdOtherSrc   + RunResults[6]:StdOtherSrc   + RunResults[7]:StdOtherSrc   + RunResults[8]:StdOtherSrc   + RunResults[9]:StdOtherSrc   + RunResults[13]:StdOtherSrc   + RunResults[14]:StdOtherSrc    }
	"Calculate Src - TOTAL  - Total"		Proj:RunResults[10]:StandardSrc			= {	RunResults[11]:StandardSrc   + RunResults[6]:StandardSrc   + RunResults[7]:StandardSrc   + RunResults[8]:StandardSrc   + RunResults[9]:StandardSrc   + RunResults[13]:StandardSrc   + RunResults[14]:StandardSrc    }


;	; SAC 4/2/14 - moved PV credit calcs into subordinate rulelist
;	"Set Proj:PVBaseTDV"						Proj:PVBaseTDV	= {	RunResults[11]:StandardTDV * CondFloorArea  }		; SAC 4/14/15 - switched from elecTotalTDV to totalCompTDV - was: RunResults[10]:StdElecTDV
;	"Perform PV calcs if applicable"		Proj:Action		= {	if (PVGenCredit < 1 .OR. StandardsVersion == 2014 .OR. CondFloorArea < 0.01) then  UNCHANGED
;																				else	switch ( CompCodeBase )
;																							case  2013 :	EvalRulelist( "CARes_CalculatePVCredit_2013Compliance" )
;																							case  2016 :	EvalRulelist( "CARes_CalculatePVCredit_2016Compliance" )
;																							default    :	UNCHANGED   ; no specific PV credit for 2019 or 2022
;																						endswitch  endif  }
;	; SAC 4/3/15 - set new EnergyUse:PropPVCreditTDV property (needed to track & pass PVCredit from first to second Proposed EnergyUse data)
;	"Store PropPVCreditTDV[1]"				Proj:RunResults[6]:PropPVCreditTDV[1]		= {	PVCredit[1]  }
;; ADJUST certain Proposed results that now are to have PVCredit applied to them
;; mjb-10/16/13	subtracted PVCredit from Proposed Design Elec and TOTAL 
;	"Calculate TDV - Elec   - Comp Ttl"	Proj:RunResults[11]:PropElecTDV[1]			= {	RunResults[11]:PropElecTDV[1]  - PVCredit[1]  }
;	"Calculate TDV - TOTAL  - Comp Ttl"	Proj:RunResults[11]:ProposedTDV[1]			= {	RunResults[11]:ProposedTDV[1]  - PVCredit[1]  }
;	"Calculate TDV - Elec   - Total"		Proj:RunResults[10]:PropElecTDV[1]			= {	RunResults[10]:PropElecTDV[1]  - PVCredit[1]  }
;	"Calculate TDV - TOTAL  - Total"		Proj:RunResults[10]:ProposedTDV[1]			= {	RunResults[10]:ProposedTDV[1]  - PVCredit[1]  }


  ; Compliance Margins
	"Calc Src Comp Margin - SpcHt"    	Proj:RunResults[1]:CompMarginSrc		= {	LocalRef( RunResults[1]:StandardSrc  ) - LocalRef( RunResults[1]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - SpcCl"    	Proj:RunResults[2]:CompMarginSrc		= {	LocalRef( RunResults[2]:StandardSrc  ) - LocalRef( RunResults[2]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - IAQVent"  	Proj:RunResults[3]:CompMarginSrc		= {	LocalRef( RunResults[3]:StandardSrc  ) - LocalRef( RunResults[3]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - OthrHVAC" 	Proj:RunResults[4]:CompMarginSrc		= {	LocalRef( RunResults[4]:StandardSrc  ) - LocalRef( RunResults[4]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - WtrHt"    	Proj:RunResults[5]:CompMarginSrc		= {	LocalRef( RunResults[5]:StandardSrc  ) - LocalRef( RunResults[5]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - InsLtg"   	Proj:RunResults[6]:CompMarginSrc		= {	LocalRef( RunResults[6]:StandardSrc  ) - LocalRef( RunResults[6]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - AppCkg"   	Proj:RunResults[7]:CompMarginSrc		= {	LocalRef( RunResults[7]:StandardSrc  ) - LocalRef( RunResults[7]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - Plugs"    	Proj:RunResults[8]:CompMarginSrc		= {	LocalRef( RunResults[8]:StandardSrc  ) - LocalRef( RunResults[8]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - Ext"      	Proj:RunResults[9]:CompMarginSrc		= {	LocalRef( RunResults[9]:StandardSrc  ) - LocalRef( RunResults[9]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - PV"      	Proj:RunResults[13]:CompMarginSrc	= {	LocalRef( RunResults[13]:StandardSrc ) - LocalRef( RunResults[13]:ProposedSrc[1] )   }
	"Calc Src Comp Margin - Battery"    Proj:RunResults[14]:CompMarginSrc	= {	LocalRef( RunResults[14]:StandardSrc ) - LocalRef( RunResults[14]:ProposedSrc[1] )   }
	"Calc Src Comp Margin - Total"    	Proj:RunResults[10]:CompMarginSrc	= {	LocalRef( RunResults[10]:StandardSrc ) - LocalRef( RunResults[10]:ProposedSrc[1] )   }
	"Calc Src Comp Margin - Comp Ttl" 	Proj:RunResults[11]:CompMarginSrc	= {	LocalRef( RunResults[11]:StandardSrc ) - LocalRef( RunResults[11]:ProposedSrc[1] )   }

  ; Percent Improvement
	"Calc Src Pct Improve - SpcHt"    	Proj:RunResults[1]:PctImproveSrc		= {	if (LocalRef( RunResults[1]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResults[1]:CompMarginSrc  ) * 100 / LocalRef( RunResults[1]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - SpcCl"    	Proj:RunResults[2]:PctImproveSrc		= {	if (LocalRef( RunResults[2]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResults[2]:CompMarginSrc  ) * 100 / LocalRef( RunResults[2]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - IAQVent"  	Proj:RunResults[3]:PctImproveSrc		= {	if (LocalRef( RunResults[3]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResults[3]:CompMarginSrc  ) * 100 / LocalRef( RunResults[3]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - OthrHVAC" 	Proj:RunResults[4]:PctImproveSrc		= {	if (LocalRef( RunResults[4]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResults[4]:CompMarginSrc  ) * 100 / LocalRef( RunResults[4]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - WtrHt"    	Proj:RunResults[5]:PctImproveSrc		= {	if (LocalRef( RunResults[5]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResults[5]:CompMarginSrc  ) * 100 / LocalRef( RunResults[5]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - InsLtg"   	Proj:RunResults[6]:PctImproveSrc		= {	if (LocalRef( RunResults[6]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResults[6]:CompMarginSrc  ) * 100 / LocalRef( RunResults[6]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - AppCkg"   	Proj:RunResults[7]:PctImproveSrc		= {	if (LocalRef( RunResults[7]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResults[7]:CompMarginSrc  ) * 100 / LocalRef( RunResults[7]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - Plugs"    	Proj:RunResults[8]:PctImproveSrc		= {	if (LocalRef( RunResults[8]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResults[8]:CompMarginSrc  ) * 100 / LocalRef( RunResults[8]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - Ext"      	Proj:RunResults[9]:PctImproveSrc		= {	if (LocalRef( RunResults[9]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResults[9]:CompMarginSrc  ) * 100 / LocalRef( RunResults[9]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - PV"      	Proj:RunResults[13]:PctImproveSrc	= {	if (LocalRef( RunResults[13]:StandardSrc ) == 0) then  0  else  LocalRef( RunResults[13]:CompMarginSrc ) * 100 / LocalRef( RunResults[13]:StandardSrc )  endif  }
	"Calc Src Pct Improve - Battery"    Proj:RunResults[14]:PctImproveSrc	= {	if (LocalRef( RunResults[14]:StandardSrc ) == 0) then  0  else  LocalRef( RunResults[14]:CompMarginSrc ) * 100 / LocalRef( RunResults[14]:StandardSrc )  endif  }
	"Calc Src Pct Improve - Total"    	Proj:RunResults[10]:PctImproveSrc	= {	if (LocalRef( RunResults[10]:StandardSrc ) == 0) then  0  else  LocalRef( RunResults[10]:CompMarginSrc ) * 100 / LocalRef( RunResults[10]:StandardSrc )  endif  }
	"Calc Src Pct Improve - Comp Ttl"  	Proj:RunResults[11]:PctImproveSrc	= {	if (LocalRef( RunResults[11]:StandardSrc ) == 0) then  0  else  LocalRef( RunResults[11]:CompMarginSrc ) * 100 / LocalRef( RunResults[11]:StandardSrc )  endif  }

END

;*************************************************************************
RULELIST "CARes_DesignRatingSrcEnergyResults" 1 0 0 1
;*************************************************************************

	"Store DRtg Proposed Src-multiplied results"		Proj:Action = {	EvalRulelist( "CARes_DRtgPropMultSrcEnergyResults" )  }		; SAC 3/14/16

; 1,           "DesignRatingSrc",   BEMP_Flt,  1,  0,  0, "kBtu/ft2-yr",      0,  0,             39110, "Design Rating source energy run result for this enduse" 
; 1,           "DRtgPctSavSrc",     BEMP_Flt,  1,  0,  0, "%",                0,  0,             39110, "Percent improvement (DesignRtg -> Prop source energy) for this enduse" 

; 1,           "DRtgElecSrc",       BEMP_Flt,  1,  0,  0, "kBtu/ft2-yr",      0,  0,             39110, "Design Rating run Eletric source energy for this enduse" 
; 1,           "DRtgNatGasSrc",     BEMP_Flt,  1,  0,  0, "kBtu/ft2-yr",      0,  0,             39110, "Design Rating run Natural Gas source energy for this enduse" 
; 1,           "DRtgOtherSrc",      BEMP_Flt,  1,  0,  0, "kBtu/ft2-yr",      0,  0,             39110, "Design Rating run Other Fuel source energy for this enduse" 

; SAC 12/5/19 - REMOVED application of fuel adjustment multipliers (leftover from DesignRatingTDV[2] rules) when setting RunResults[*]:DesignRatingSrc[2]
; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
         ; SAC 8/24/19 - replaced 1/3.413 & 0.01 EDR1 table multipliers with Proj:SrcSecMult_Elec & SrcSecMult_Fuel to accommodate 2022+ switch to native (E3) EDR1 table units
         ; SAC 8/26/19 - added primary table multipliers (of 1.0) to all ApplyHourlyResultMult* function calls (to accommodate 2022+ TDV table unit switch)
  ; Space Heating (& heating fan)
	"Calculate Src - Elec   - SpcHt"		Proj:RunResults[1]:DRtgElecSrc			= {	if (LocalRef( RunResults[1]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - SpcHt"		Proj:RunResults[1]:DRtgNatGasSrc			= {	if (LocalRef( RunResults[1]:DRtgNatGasEnergy		) < 0.0001) then  0                                                                                                        
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - SpcHt"		Proj:RunResults[1]:DRtgOtherSrc			= {	if (LocalRef( RunResults[1]:DRtgOtherEnergy		) < 0.0001) then  0                                                                                                        
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - SpcHt"		Proj:RunResults[1]:DesignRatingSrc[1]	= {	LocalRef( RunResults[1]:DRtgElecSrc ) + LocalRef( RunResults[1]:DRtgNatGasSrc ) + LocalRef( RunResults[1]:DRtgOtherSrc )   }
	"Calculate Src - TOTAL  - SpcHt"		Proj:RunResults[1]:DesignRatingSrc[2]	= {	RunResults[1]:DesignRatingSrc[1]   }

  ; Space Cooling (& cooling fan)
	"Calculate Src - Elec   - SpcCl"		Proj:RunResults[2]:DRtgElecSrc			= {	if (LocalRef( RunResults[2]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - SpcCl"		Proj:RunResults[2]:DRtgNatGasSrc			= {	if (LocalRef( RunResults[2]:DRtgNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - SpcCl"		Proj:RunResults[2]:DRtgOtherSrc			= {	if (LocalRef( RunResults[2]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - SpcCl"		Proj:RunResults[2]:DesignRatingSrc[1]	= {	LocalRef( RunResults[2]:DRtgElecSrc ) + LocalRef( RunResults[2]:DRtgNatGasSrc ) + LocalRef( RunResults[2]:DRtgOtherSrc )   }
	"Calculate Src - TOTAL  - SpcCl"		Proj:RunResults[2]:DesignRatingSrc[2]	= {	RunResults[2]:DesignRatingSrc[1]   }

  ; IAQ Ventilation Fans
	"Calculate Src - Elec   - IAQVent"	Proj:RunResults[3]:DRtgElecSrc			= {	if (LocalRef( RunResults[3]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "FanV" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - IAQVent"	Proj:RunResults[3]:DRtgNatGasSrc			= {	0  }
	"Calculate Src - Other  - IAQVent"	Proj:RunResults[3]:DRtgOtherSrc			= {	0  }
	"Calculate Src - TOTAL  - IAQVent"	Proj:RunResults[3]:DesignRatingSrc[1]	= {	LocalRef( RunResults[3]:DRtgElecSrc )   }
	"Calculate Src - TOTAL  - IAQVent"	Proj:RunResults[3]:DesignRatingSrc[2]	= {	LocalRef( RunResults[3]:DRtgElecSrc )   }

  ; Other HVAC (aux & misc fans)
   ; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
   ; SAC 11/15/18 - restored "Other HVAC" [4] to handle VCHP CFan via "User1" enduse
	"Calculate Src - Elec   - OthrHVAC"	Proj:RunResults[4]:DRtgElecSrc			= {	if (LocalRef( RunResults[4]:DRtgElecEnergy ) < 0.0001 .AND. OthrHVAC_SpcHtFrac == 0) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "User1" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - OthrHVAC"	Proj:RunResults[4]:DRtgNatGasSrc			= {	0  }
	"Calculate Src - Other  - OthrHVAC"	Proj:RunResults[4]:DRtgOtherSrc			= {	0  }
	"Calculate Src - TOTAL  - OthrHVAC"	Proj:RunResults[4]:DesignRatingSrc[1]	= {	LocalRef( RunResults[4]:DRtgElecSrc )  }
	"Calculate Src - TOTAL  - OthrHVAC"	Proj:RunResults[4]:DesignRatingSrc[2]	= {	RunResults[4]:DesignRatingSrc[1]  }

; SAC 1/27/19 - REDISTRIBUTE OthrHVAC DRtg Src across SpcHt & SpcCl by fuel based on ratio of total Src (across all fuels) (tic #1053)
   "Set OthrHVAC_SpcHtFrac - DRtgSrc"     Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResults[4]:DesignRatingSrc[1] != 0 )==0) then  0
                                                                        else if (IfValidAnd( RunResults[1]:DesignRatingSrc[1] == 0 ) .AND.
                                                                                 IfValidAnd( RunResults[2]:DesignRatingSrc[1] == 0 )) then  0.5
                                                                        else   ValidOr( RunResults[1]:DesignRatingSrc[1], 0 ) / 
                                                                              (ValidOr( RunResults[1]:DesignRatingSrc[1], 0 ) + ValidOr( RunResults[2]:DesignRatingSrc[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Elec   - SpcHt"    Proj:RunResults[1]:DRtgElecSrc[1]	   = {   if (IfValidAnd( RunResults[4]:DRtgElecSrc[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[1]:DRtgElecSrc[1] + (RunResults[4]:DRtgElecSrc[1]     * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - TOTAL  - SpcHt"		Proj:RunResults[1]:DesignRatingSrc[1]	= {	LocalRef( RunResults[1]:DRtgElecSrc[1] ) + LocalRef( RunResults[1]:DRtgNatGasSrc[1] ) + LocalRef( RunResults[1]:DRtgOtherSrc[1] )   }
	"REALLOC OthrHVAC - TOTAL  - SpcHt"		Proj:RunResults[1]:DesignRatingSrc[2]	= {	RunResults[1]:DesignRatingSrc[1]   }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Elec   - SpcCl"		Proj:RunResults[2]:DRtgElecSrc[1]	   = {   if (IfValidAnd( RunResults[4]:DRtgElecSrc[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[2]:DRtgElecSrc[1] + (RunResults[4]:DRtgElecSrc[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - TOTAL  - SpcCl"		Proj:RunResults[2]:DesignRatingSrc[1]	= {	LocalRef( RunResults[2]:DRtgElecSrc[1] ) + LocalRef( RunResults[2]:DRtgNatGasSrc[1] ) + LocalRef( RunResults[2]:DRtgOtherSrc[1] )   }
	"REALLOC OthrHVAC - TOTAL  - SpcCl"		Proj:RunResults[2]:DesignRatingSrc[2]	= {	RunResults[2]:DesignRatingSrc[1]   }
  ; Other HVAC (aux & misc fans)
	"ZERO-OUT         - Elec   - OthrHVAC"	Proj:RunResults[4]:DRtgElecSrc[1]	   = {	0  }
	"ZERO-OUT         - NatGas - OthrHVAC"	Proj:RunResults[4]:DRtgNatGasSrc[1]	   = {	0  }
	"ZERO-OUT         - Other  - OthrHVAC"	Proj:RunResults[4]:DRtgOtherSrc[1]	   = {	0  }
	"ZERO-OUT         - TOTAL  - OthrHVAC"	Proj:RunResults[4]:DesignRatingSrc[1]	= {	0  }
	"ZERO-OUT         - TOTAL  - OthrHVAC"	Proj:RunResults[4]:DesignRatingSrc[2]	= {	0  }
   ; SAC 1/27/19 - end of - redistribution of OthrHVAC DRtgSrc

  ; Water Heating
	"Calculate Src - Elec   - WtrHt"		Proj:RunResults[5]:DRtgElecSrc			= {	if (LocalRef( RunResults[5]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																						else if (CSEinclDHWMFL_EU)
			 			  																						then  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / CondFloorArea) + 0.5) / 100
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate Src - NatGas - WtrHt"		Proj:RunResults[5]:DRtgNatGasSrc			= {	if (LocalRef( RunResults[5]:DRtgNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - WtrHt"		Proj:RunResults[5]:DRtgOtherSrc			= {	if (LocalRef( RunResults[5]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - WtrHt"		Proj:RunResults[5]:DesignRatingSrc[1]	= {	LocalRef( RunResults[5]:DRtgElecSrc ) + LocalRef( RunResults[5]:DRtgNatGasSrc ) + LocalRef( RunResults[5]:DRtgOtherSrc )   }
	"Calculate Src - TOTAL  - WtrHt"		Proj:RunResults[5]:DesignRatingSrc[2]	= {	RunResults[5]:DesignRatingSrc[1]   }

  ; Inside Lighting
	"Calculate Src - Elec   - InsLtg"	Proj:RunResults[6]:DRtgElecSrc			= {	if (LocalRef( RunResults[6]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - InsLtg"	Proj:RunResults[6]:DRtgNatGasSrc			= {	if (LocalRef( RunResults[6]:DRtgNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - InsLtg"	Proj:RunResults[6]:DRtgOtherSrc			= {	if (LocalRef( RunResults[6]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - InsLtg"	Proj:RunResults[6]:DesignRatingSrc[1]	= {	LocalRef( RunResults[6]:DRtgElecSrc ) + LocalRef( RunResults[6]:DRtgNatGasSrc ) + LocalRef( RunResults[6]:DRtgOtherSrc )   }
	"Calculate Src - TOTAL  - InsLtg"	Proj:RunResults[6]:DesignRatingSrc[2]	= {	RunResults[6]:DesignRatingSrc[1]   }

  ; Appliances & Cooking
	"Calculate Src - Elec   - AppCkg"	Proj:RunResults[7]:DRtgElecSrc			= {	if (LocalRef( RunResults[7]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - AppCkg"	Proj:RunResults[7]:DRtgNatGasSrc			= {	if (LocalRef( RunResults[7]:DRtgNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - AppCkg"	Proj:RunResults[7]:DRtgOtherSrc			= {	if (LocalRef( RunResults[7]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - AppCkg"	Proj:RunResults[7]:DesignRatingSrc[1]	= {	LocalRef( RunResults[7]:DRtgElecSrc ) + LocalRef( RunResults[7]:DRtgNatGasSrc ) + LocalRef( RunResults[7]:DRtgOtherSrc )   }
	"Calculate Src - TOTAL  - AppCkg"	Proj:RunResults[7]:DesignRatingSrc[2]	= {	RunResults[7]:DesignRatingSrc[1]   }

  ; Plug Loads
	"Calculate Src - Elec   - Plugs"		Proj:RunResults[8]:DRtgElecSrc			= {	if (LocalRef( RunResults[8]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - Plugs"		Proj:RunResults[8]:DRtgNatGasSrc			= {	if (LocalRef( RunResults[8]:DRtgNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - Plugs"		Proj:RunResults[8]:DRtgOtherSrc			= {	if (LocalRef( RunResults[8]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - Plugs"		Proj:RunResults[8]:DesignRatingSrc[1]	= {	LocalRef( RunResults[8]:DRtgElecSrc ) + LocalRef( RunResults[8]:DRtgNatGasSrc ) + LocalRef( RunResults[8]:DRtgOtherSrc )   }
	"Calculate Src - TOTAL  - Plugs"		Proj:RunResults[8]:DesignRatingSrc[2]	= {	RunResults[8]:DesignRatingSrc[1]   }

  ; Exterior
	"Calculate Src - Elec   - Ext"		Proj:RunResults[9]:DRtgElecSrc			= {	if (LocalRef( RunResults[9]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - Ext"		Proj:RunResults[9]:DRtgNatGasSrc			= {	if (LocalRef( RunResults[9]:DRtgNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - Ext"		Proj:RunResults[9]:DRtgOtherSrc			= {	if (LocalRef( RunResults[9]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - Ext"		Proj:RunResults[9]:DesignRatingSrc[1]	= {	LocalRef( RunResults[9]:DRtgElecSrc ) + LocalRef( RunResults[9]:DRtgNatGasSrc ) + LocalRef( RunResults[9]:DRtgOtherSrc )   }
	"Calculate Src - TOTAL  - Ext"		Proj:RunResults[9]:DesignRatingSrc[2]	= {	RunResults[9]:DesignRatingSrc[1]   }

  ; PV
	"Calculate Src - Elec   - PV"			Proj:RunResults[13]:DRtgElecSrc			= {	if (LocalRef( RunResults[13]:DRtgElecEnergy		) > -0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "PV" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - PV"			Proj:RunResults[13]:DRtgNatGasSrc		= {	0  }
	"Calculate Src - Other  - PV"			Proj:RunResults[13]:DRtgOtherSrc			= {	0  }
	"Calculate Src - TOTAL  - PV"			Proj:RunResults[13]:DesignRatingSrc[1]	= {	LocalRef( RunResults[13]:DRtgElecSrc )   }
	"Calculate Src - TOTAL  - PV"			Proj:RunResults[13]:DesignRatingSrc[2]	= {	RunResults[13]:DesignRatingSrc[1]   }

  ; Battery - SAC 12/15/16
	"Calculate Src - Elec   - Battery"	Proj:RunResults[14]:DRtgElecSrc			= {	if (LocalRef( RunResults[14]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "BT" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - Battery"	Proj:RunResults[14]:DRtgNatGasSrc		= {	0  }
	"Calculate Src - Other  - Battery"	Proj:RunResults[14]:DRtgOtherSrc			= {	0  }
	"Calculate Src - TOTAL  - Battery"	Proj:RunResults[14]:DesignRatingSrc[1]	= {	LocalRef( RunResults[14]:DRtgElecSrc )   }
	"Calculate Src - TOTAL  - Battery"	Proj:RunResults[14]:DesignRatingSrc[2]	= {	RunResults[14]:DesignRatingSrc[1]   }

  ; Compliance Total
  ; SAC 1/14/13 - added in PVCredit to Std (elec) Src
; mjb-10/16/13	remove PVCredit from Std Design
	"Calculate Src - Elec   - Comp Ttl"	Proj:RunResults[11]:DRtgElecSrc			= {	RunResults[1]:DRtgElecSrc    + RunResults[2]:DRtgElecSrc    + RunResults[3]:DRtgElecSrc    + RunResults[4]:DRtgElecSrc    + RunResults[5]:DRtgElecSrc     }
	"Calculate Src - NatGas - Comp Ttl"	Proj:RunResults[11]:DRtgNatGasSrc		= {	RunResults[1]:DRtgNatGasSrc  + RunResults[2]:DRtgNatGasSrc  + RunResults[3]:DRtgNatGasSrc  + RunResults[4]:DRtgNatGasSrc  + RunResults[5]:DRtgNatGasSrc   }
	"Calculate Src - Other  - Comp Ttl"	Proj:RunResults[11]:DRtgOtherSrc			= {	RunResults[1]:DRtgOtherSrc   + RunResults[2]:DRtgOtherSrc   + RunResults[3]:DRtgOtherSrc   + RunResults[4]:DRtgOtherSrc   + RunResults[5]:DRtgOtherSrc    }
	"Calculate Src - TOTAL  - Comp Ttl"	Proj:RunResults[11]:DesignRatingSrc[1]	= {	RunResults[1]:DesignRatingSrc[1]   + RunResults[2]:DesignRatingSrc[1]   + RunResults[3]:DesignRatingSrc[1]   + RunResults[4]:DesignRatingSrc[1]   + RunResults[5]:DesignRatingSrc[1]    }
	"Calculate Src - TOTAL  - Comp Ttl"	Proj:RunResults[11]:DesignRatingSrc[2]	= {	RunResults[1]:DesignRatingSrc[2]   + RunResults[2]:DesignRatingSrc[2]   + RunResults[3]:DesignRatingSrc[2]   + RunResults[4]:DesignRatingSrc[2]   + RunResults[5]:DesignRatingSrc[2]    }

  ; Total
	"Calculate Src - Elec   - Total"		Proj:RunResults[10]:DRtgElecSrc			= {	RunResults[11]:DRtgElecSrc    + RunResults[6]:DRtgElecSrc    + RunResults[7]:DRtgElecSrc    + RunResults[8]:DRtgElecSrc    + RunResults[9]:DRtgElecSrc     }
	"Calculate Src - NatGas - Total"		Proj:RunResults[10]:DRtgNatGasSrc		= {	RunResults[11]:DRtgNatGasSrc  + RunResults[6]:DRtgNatGasSrc  + RunResults[7]:DRtgNatGasSrc  + RunResults[8]:DRtgNatGasSrc  + RunResults[9]:DRtgNatGasSrc   }
	"Calculate Src - Other  - Total"		Proj:RunResults[10]:DRtgOtherSrc			= {	RunResults[11]:DRtgOtherSrc   + RunResults[6]:DRtgOtherSrc   + RunResults[7]:DRtgOtherSrc   + RunResults[8]:DRtgOtherSrc   + RunResults[9]:DRtgOtherSrc    }
	"Calculate Src - TOTAL  - Total"		Proj:RunResults[10]:DesignRatingSrc[1]	= {	RunResults[11]:DesignRatingSrc[1]   + RunResults[6]:DesignRatingSrc[1]   + RunResults[7]:DesignRatingSrc[1]   + RunResults[8]:DesignRatingSrc[1]   + RunResults[9]:DesignRatingSrc[1]    }
	"Calculate Src - TOTAL  - Total"		Proj:RunResults[10]:DesignRatingSrc[2]	= {	RunResults[11]:DesignRatingSrc[2]   + RunResults[6]:DesignRatingSrc[2]   + RunResults[7]:DesignRatingSrc[2]   + RunResults[8]:DesignRatingSrc[2]   + RunResults[9]:DesignRatingSrc[2]    }

;  ; SAC 2/1/16 - inserted RE-calc of Standard model PVCredit (so that it is available for analysis results reporting following design rating run)
;	"Set Proj:PVBaseTDV"						Proj:PVBaseTDV	= {	ValidOr( RunResults[11]:StandardTDV, 0 ) * CondFloorArea  }		; SAC 4/14/15 - switched from elecTotalTDV to totalCompTDV - was: RunResults[10]:StdElecTDV
;	"Perform PV calcs if applicable"		Proj:Action		= {	if (PVGenCredit < 1 .OR. StandardsVersion == 2014 .OR. CondFloorArea < 0.01) then  UNCHANGED
;																				else	switch ( CompCodeBase )
;																							case  2013 :	EvalRulelist( "CARes_CalculatePVCredit_2013Compliance" )
;																							case  2016 :	EvalRulelist( "CARes_CalculatePVCredit_2016Compliance" )
;																							default    :	UNCHANGED   ; no specific PV credit for 2019 or 2022
;																						endswitch  endif  }
;
;	; SAC 4/2/14 - moved PV credit calcs into subordinate rulelist
;	"Set Proj:PVBaseTDV - DRtg"						Proj:PVBaseTDV	= {	ValidOr( RunResults[10]:DesignRatingTDV[1], 0 ) * CondFloorArea  }		; SAC 4/14/15 - switched from elecTDV to totalTDV - was: RunResults[10]:DRtgElecTDV
;		; SAC 3/24/16 - removed logic 'PVGenCredit < 1 .OR.' preventing call to CARes_CalculatePVCredit_2016DesignRating when compliance PV credit toggled off
;	"Perform PV calcs if applicable - DRtg"		Proj:Action		= {	if ((StdDesignBase == 2013 .AND. StandardsVersion == 2014) .OR. CondFloorArea < 0.01) then  UNCHANGED
;																							else	switch ( CompCodeBase )
;																										case  2016 :	EvalRulelist( "CARes_CalculatePVCredit_2016DesignRating" )
;																										case  2019 :	EvalRulelist( "CARes_CalculatePVCredit_2016DesignRating" )  ; DsgnRtg PVCredit for 2016 & 2019 same
;																										case  2022 :	EvalRulelist( "CARes_CalculatePVCredit_2016DesignRating" )  ; DsgnRtg PVCredit for 2016, 2019 & 2022 same ??
;																										default    :	UNCHANGED
;																									endswitch  endif  }
;	; SAC 4/3/15 - set new EnergyUse:PropPVCreditTDV property (needed to track & pass PVCredit from first to second Proposed EnergyUse data)
;	"Store PropPVCreditTDV[2]"				Proj:RunResults[6]:PropPVCreditTDV[2]		= {	PVCredit[2]  }			; SAC 1/28/16 - still track this under InsLtg enduse ??

	; SAC SAC 4/8/15 - adjust RunResults[6]:Prop*[2] properties for DRtgLtgReduction
	"Adjust - Elec   - InsLtg for DRtgLtgReduction"	Proj:RunResults[6]:PropElecSrc[2]		= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropElecSrc[2]      <= 0) then  UNCHANGED
			 			  																										else  int( (100 * (RunResults[6]:PropElecSrc[2]      * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
	"Recalc - TOTAL  - InsLtg for DRtgLtgReduction"	Proj:RunResults[6]:ProposedSrc[2]		= {	RunResults[6]:PropElecSrc[2]    + RunResults[6]:PropNatGasSrc       + RunResults[6]:PropOtherSrc         }
	"Recalc - TOTAL  - InsLtg for DRtgLtgReduction"	Proj:RunResults[6]:ProposedSrc[3]		= {	RunResults[6]:ProposedSrc[2]  }
; ADJUST certain Proposed results that now are to have PVCredit applied to them
; mjb-10/16/13	subtracted PVCredit from Proposed Design Elec and TOTAL 
; SAC 4/9/15 - updated to also recalc energy use sums (to catch mods for design rating lighting credit)
; SAC 4/7/17 - shifted PV & Batt from CompTot to Tot for 2019
	"Recalc Src - Elec   - Comp Ttl"		Proj:RunResults[11]:PropElecSrc[2]			= {	if (EnergyCodeYearNum < 2019)
                                                                                       then  RunResults[1]:PropElecSrc[2]       + RunResults[2]:PropElecSrc[2]      + RunResults[3]:PropElecSrc[2]      + RunResults[4]:PropElecSrc[2]      + RunResults[5]:PropElecSrc[2]      + RunResults[13]:PropElecSrc[2]      + RunResults[14]:PropElecSrc[2]       ; - PVCredit[2]  }
                                                                                       else  RunResults[1]:PropElecSrc[2]       + RunResults[2]:PropElecSrc[2]      + RunResults[3]:PropElecSrc[2]      + RunResults[4]:PropElecSrc[2]      + RunResults[5]:PropElecSrc[2]        endif  } 
	"Recalc Src - TOTAL  - Comp Ttl"		Proj:RunResults[11]:ProposedSrc[2]			= {	if (EnergyCodeYearNum < 2019)
                                                                                       then  RunResults[1]:ProposedSrc[2]       + RunResults[2]:ProposedSrc[2]      + RunResults[3]:ProposedSrc[2]      + RunResults[4]:ProposedSrc[2]      + RunResults[5]:ProposedSrc[2]      + RunResults[13]:ProposedSrc[2]      + RunResults[14]:ProposedSrc[2]       ; - PVCredit[2]  }
                                                                                       else  RunResults[1]:ProposedSrc[2]       + RunResults[2]:ProposedSrc[2]      + RunResults[3]:ProposedSrc[2]      + RunResults[4]:ProposedSrc[2]      + RunResults[5]:ProposedSrc[2]        endif  }
	"Recalc Src - TOTAL  - Comp Ttl"		Proj:RunResults[11]:ProposedSrc[3]			= {	if (EnergyCodeYearNum < 2019)
                                                                                       then  RunResults[1]:ProposedSrc[3]       + RunResults[2]:ProposedSrc[3]      + RunResults[3]:ProposedSrc[3]      + RunResults[4]:ProposedSrc[3]      + RunResults[5]:ProposedSrc[3]      + RunResults[13]:ProposedSrc[3]      + RunResults[14]:ProposedSrc[3]       ; - PVCredit[2]  }
                                                                                       else  RunResults[1]:ProposedSrc[3]       + RunResults[2]:ProposedSrc[3]      + RunResults[3]:ProposedSrc[3]      + RunResults[4]:ProposedSrc[3]      + RunResults[5]:ProposedSrc[3]        endif  }
	"Recalc Src - Elec   - Total"			Proj:RunResults[10]:PropElecSrc[2]			= {	if (EnergyCodeYearNum < 2019)
                                                                                       then  RunResults[11]:PropElecSrc[2]      + RunResults[6]:PropElecSrc[2]      + RunResults[7]:PropElecSrc[2]      + RunResults[8]:PropElecSrc[2]      + RunResults[9]:PropElecSrc[2]       
                                                                                       else  RunResults[11]:PropElecSrc[2]      + RunResults[6]:PropElecSrc[2]      + RunResults[7]:PropElecSrc[2]      + RunResults[8]:PropElecSrc[2]      + RunResults[9]:PropElecSrc[2]      + RunResults[13]:PropElecSrc[2]      + RunResults[14]:PropElecSrc[2]       endif  }
	"Recalc Src - TOTAL  - Total"			Proj:RunResults[10]:ProposedSrc[2]			= {	if (EnergyCodeYearNum < 2019)
                                                                                       then  RunResults[11]:ProposedSrc[2]      + RunResults[6]:ProposedSrc[2]      + RunResults[7]:ProposedSrc[2]      + RunResults[8]:ProposedSrc[2]      + RunResults[9]:ProposedSrc[2]       
                                                                                       else  RunResults[11]:ProposedSrc[2]      + RunResults[6]:ProposedSrc[2]      + RunResults[7]:ProposedSrc[2]      + RunResults[8]:ProposedSrc[2]      + RunResults[9]:ProposedSrc[2]      + RunResults[13]:ProposedSrc[2]      + RunResults[14]:ProposedSrc[2]       endif  }
	"Recalc Src - TOTAL  - Total"			Proj:RunResults[10]:ProposedSrc[3]			= {	if (EnergyCodeYearNum < 2019)
                                                                                       then  RunResults[11]:ProposedSrc[3]      + RunResults[6]:ProposedSrc[3]      + RunResults[7]:ProposedSrc[3]      + RunResults[8]:ProposedSrc[3]      + RunResults[9]:ProposedSrc[3]       
                                                                                       else  RunResults[11]:ProposedSrc[3]      + RunResults[6]:ProposedSrc[3]      + RunResults[7]:ProposedSrc[3]      + RunResults[8]:ProposedSrc[3]      + RunResults[9]:ProposedSrc[3]      + RunResults[13]:ProposedSrc[3]      + RunResults[14]:ProposedSrc[3]       endif  }

  ; Percent Improvement
   ; SAC 10/2/17 - switched from reporting delta with DRtgSrc w/o fuel adjustment mult applied to DRtgSrc W/ fuel adjustment mult applied
	"Calc Src Pct Improve - SpcHt"    	Proj:RunResults[1]:DRtgPctSavSrc		= {	if (LocalRef( RunResults[1]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResults[1]:DesignRatingSrc[2]  ) - LocalRef( RunResults[1]:ProposedSrc[2]  )) * 100 / LocalRef( RunResults[1]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - SpcCl"    	Proj:RunResults[2]:DRtgPctSavSrc		= {	if (LocalRef( RunResults[2]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResults[2]:DesignRatingSrc[2]  ) - LocalRef( RunResults[2]:ProposedSrc[2]  )) * 100 / LocalRef( RunResults[2]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - IAQVent"  	Proj:RunResults[3]:DRtgPctSavSrc		= {	if (LocalRef( RunResults[3]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResults[3]:DesignRatingSrc[2]  ) - LocalRef( RunResults[3]:ProposedSrc[2]  )) * 100 / LocalRef( RunResults[3]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - OthrHVAC" 	Proj:RunResults[4]:DRtgPctSavSrc		= {	if (LocalRef( RunResults[4]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResults[4]:DesignRatingSrc[2]  ) - LocalRef( RunResults[4]:ProposedSrc[2]  )) * 100 / LocalRef( RunResults[4]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - WtrHt"    	Proj:RunResults[5]:DRtgPctSavSrc		= {	if (LocalRef( RunResults[5]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResults[5]:DesignRatingSrc[2]  ) - LocalRef( RunResults[5]:ProposedSrc[2]  )) * 100 / LocalRef( RunResults[5]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - InsLtg"   	Proj:RunResults[6]:DRtgPctSavSrc		= {	if (LocalRef( RunResults[6]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResults[6]:DesignRatingSrc[2]  ) - LocalRef( RunResults[6]:ProposedSrc[2]  )) * 100 / LocalRef( RunResults[6]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - AppCkg"   	Proj:RunResults[7]:DRtgPctSavSrc		= {	if (LocalRef( RunResults[7]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResults[7]:DesignRatingSrc[2]  ) - LocalRef( RunResults[7]:ProposedSrc[2]  )) * 100 / LocalRef( RunResults[7]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - Plugs"    	Proj:RunResults[8]:DRtgPctSavSrc		= {	if (LocalRef( RunResults[8]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResults[8]:DesignRatingSrc[2]  ) - LocalRef( RunResults[8]:ProposedSrc[2]  )) * 100 / LocalRef( RunResults[8]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - Ext"      	Proj:RunResults[9]:DRtgPctSavSrc		= {	if (LocalRef( RunResults[9]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResults[9]:DesignRatingSrc[2]  ) - LocalRef( RunResults[9]:ProposedSrc[2]  )) * 100 / LocalRef( RunResults[9]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - PV"      	Proj:RunResults[13]:DRtgPctSavSrc	= {	if (LocalRef( RunResults[13]:DesignRatingSrc[2] ) == 0) then  0  else  (LocalRef( RunResults[13]:DesignRatingSrc[2] ) - LocalRef( RunResults[13]:ProposedSrc[2] )) * 100 / LocalRef( RunResults[13]:DesignRatingSrc[2] )  endif  }
	"Calc Src Pct Improve - Battery"  	Proj:RunResults[14]:DRtgPctSavSrc	= {	if (LocalRef( RunResults[14]:DesignRatingSrc[2] ) == 0) then  0  else  (LocalRef( RunResults[14]:DesignRatingSrc[2] ) - LocalRef( RunResults[14]:ProposedSrc[2] )) * 100 / LocalRef( RunResults[13]:DesignRatingSrc[2] )  endif  }
	"Calc Src Pct Improve - Total"    	Proj:RunResults[10]:DRtgPctSavSrc	= {	if (LocalRef( RunResults[10]:DesignRatingSrc[2] ) == 0) then  0  else  (LocalRef( RunResults[10]:DesignRatingSrc[2] ) - LocalRef( RunResults[10]:ProposedSrc[2] )) * 100 / LocalRef( RunResults[10]:DesignRatingSrc[2] )  endif  }
	"Calc Src Pct Improve - Comp Ttl"  	Proj:RunResults[11]:DRtgPctSavSrc	= {	if (LocalRef( RunResults[11]:DesignRatingSrc[2] ) == 0) then  0  else  (LocalRef( RunResults[11]:DesignRatingSrc[2] ) - LocalRef( RunResults[11]:ProposedSrc[2] )) * 100 / LocalRef( RunResults[11]:DesignRatingSrc[2] )  endif  }

END


;*************************************************************************
RULELIST "CARes_StandardSrcEnergyResults_NESW" 1 0 0 1
;*************************************************************************

; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
         ; SAC 8/24/19 - replaced 1/3.413 & 0.01 EDR1 table multipliers with Proj:SrcSecMult_Elec & SrcSecMult_Fuel to accommodate 2022+ switch to native (E3) EDR1 table units
         ; SAC 8/26/19 - added primary table multipliers (of 1.0) to all ApplyHourlyResultMult* function calls (to accommodate 2022+ TDV table unit switch)
  ; Space Heating (& heating fan)
	"Calculate Src - Elec   - N-SpcHt"		Proj:RunResultsN[1]:StdElecSrc			= {	if (LocalRef( RunResultsN[1]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - N-SpcHt"		Proj:RunResultsN[1]:StdNatGasSrc			= {	if (LocalRef( RunResultsN[1]:StdNatGasEnergy		) < 0.0001) then  0                                                                                                        
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - N-SpcHt"		Proj:RunResultsN[1]:StdOtherSrc			= {	if (LocalRef( RunResultsN[1]:StdOtherEnergy		) < 0.0001) then  0                                                                                                        
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - N-SpcHt"		Proj:RunResultsN[1]:StandardSrc			= {	LocalRef( RunResultsN[1]:StdElecSrc ) + LocalRef( RunResultsN[1]:StdNatGasSrc ) + LocalRef( RunResultsN[1]:StdOtherSrc )   }

  ; Space Cooling (& cooling fan)
	"Calculate Src - Elec   - N-SpcCl"		Proj:RunResultsN[2]:StdElecSrc			= {	if (LocalRef( RunResultsN[2]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - N-SpcCl"		Proj:RunResultsN[2]:StdNatGasSrc			= {	if (LocalRef( RunResultsN[2]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - N-SpcCl"		Proj:RunResultsN[2]:StdOtherSrc			= {	if (LocalRef( RunResultsN[2]:StdOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - N-SpcCl"		Proj:RunResultsN[2]:StandardSrc			= {	LocalRef( RunResultsN[2]:StdElecSrc ) + LocalRef( RunResultsN[2]:StdNatGasSrc ) + LocalRef( RunResultsN[2]:StdOtherSrc )   }

  ; IAQ Ventilation Fans
	"Calculate Src - Elec   - N-IAQVent"	Proj:RunResultsN[3]:StdElecSrc			= {	if (LocalRef( RunResultsN[3]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "FanV" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - N-IAQVent"	Proj:RunResultsN[3]:StdNatGasSrc			= {	0  }
	"Calculate Src - Other  - N-IAQVent"	Proj:RunResultsN[3]:StdOtherSrc			= {	0  }
	"Calculate Src - TOTAL  - N-IAQVent"	Proj:RunResultsN[3]:StandardSrc			= {	LocalRef( RunResultsN[3]:StdElecSrc )   }

; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
  ; Other HVAC (aux & misc fans)
	"Calculate Src - Elec   - N-OthrHVAC"	Proj:RunResultsN[4]:StdElecSrc			= {	0  }
	"Calculate Src - NatGas - N-OthrHVAC"	Proj:RunResultsN[4]:StdNatGasSrc			= {	0  }
	"Calculate Src - Other  - N-OthrHVAC"	Proj:RunResultsN[4]:StdOtherSrc			= {	0  }
	"Calculate Src - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:StandardSrc			= {	0  }

  ; Water Heating
	"Calculate Src - Elec   - N-WtrHt"		Proj:RunResultsN[5]:StdElecSrc			= {	if (LocalRef( RunResultsN[5]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else if (CSEinclDHWMFL_EU)
			 			  																							then  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / CondFloorArea) + 0.5) / 100
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate Src - NatGas - N-WtrHt"		Proj:RunResultsN[5]:StdNatGasSrc			= {	if (LocalRef( RunResultsN[5]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - N-WtrHt"		Proj:RunResultsN[5]:StdOtherSrc			= {	if (LocalRef( RunResultsN[5]:StdOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - N-WtrHt"		Proj:RunResultsN[5]:StandardSrc			= {	LocalRef( RunResultsN[5]:StdElecSrc ) + LocalRef( RunResultsN[5]:StdNatGasSrc ) + LocalRef( RunResultsN[5]:StdOtherSrc )   }

  ; Inside Lighting
	"Calculate Src - Elec   - N-InsLtg"		Proj:RunResultsN[6]:StdElecSrc			= {	if (LocalRef( RunResultsN[6]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - N-InsLtg"		Proj:RunResultsN[6]:StdNatGasSrc			= {	if (LocalRef( RunResultsN[6]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - N-InsLtg"		Proj:RunResultsN[6]:StdOtherSrc			= {	if (LocalRef( RunResultsN[6]:StdOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - N-InsLtg"		Proj:RunResultsN[6]:StandardSrc			= {	LocalRef( RunResultsN[6]:StdElecSrc ) + LocalRef( RunResultsN[6]:StdNatGasSrc ) + LocalRef( RunResultsN[6]:StdOtherSrc )   }

  ; Appliances & Cooking
	"Calculate Src - Elec   - N-AppCkg"		Proj:RunResultsN[7]:StdElecSrc			= {	if (LocalRef( RunResultsN[7]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - N-AppCkg"		Proj:RunResultsN[7]:StdNatGasSrc			= {	if (LocalRef( RunResultsN[7]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - N-AppCkg"		Proj:RunResultsN[7]:StdOtherSrc			= {	if (LocalRef( RunResultsN[7]:StdOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - N-AppCkg"		Proj:RunResultsN[7]:StandardSrc			= {	LocalRef( RunResultsN[7]:StdElecSrc ) + LocalRef( RunResultsN[7]:StdNatGasSrc ) + LocalRef( RunResultsN[7]:StdOtherSrc )   }

  ; Plug Loads
	"Calculate Src - Elec   - N-Plugs"		Proj:RunResultsN[8]:StdElecSrc			= {	if (LocalRef( RunResultsN[8]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - N-Plugs"		Proj:RunResultsN[8]:StdNatGasSrc			= {	if (LocalRef( RunResultsN[8]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - N-Plugs"		Proj:RunResultsN[8]:StdOtherSrc			= {	if (LocalRef( RunResultsN[8]:StdOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - N-Plugs"		Proj:RunResultsN[8]:StandardSrc			= {	LocalRef( RunResultsN[8]:StdElecSrc ) + LocalRef( RunResultsN[8]:StdNatGasSrc ) + LocalRef( RunResultsN[8]:StdOtherSrc )   }

  ; Exterior
	"Calculate Src - Elec   - N-Ext"			Proj:RunResultsN[9]:StdElecSrc			= {	if (LocalRef( RunResultsN[9]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - N-Ext"			Proj:RunResultsN[9]:StdNatGasSrc			= {	if (LocalRef( RunResultsN[9]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - N-Ext"			Proj:RunResultsN[9]:StdOtherSrc			= {	if (LocalRef( RunResultsN[9]:StdOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - N-Ext"			Proj:RunResultsN[9]:StandardSrc			= {	LocalRef( RunResultsN[9]:StdElecSrc ) + LocalRef( RunResultsN[9]:StdNatGasSrc ) + LocalRef( RunResultsN[9]:StdOtherSrc )   }

  ; PV
   ; mods to calc NEM-adjusted PV Src (StdElecSrc) for 2019 analysis
	"Calculate Src - Elec   - N-PV"			Proj:RunResultsN[13]:StdElecSrc			= {	if (LocalRef( RunResultsN[13]:StdElecEnergy		) > -0.0001) then  0
		else if (IfValidAnd( NetEnergyMeteringSrcAdj != 0))
      then  if (LocalRef( RunResultsN[14]:PropElecEnergy[1] ) = 0)
            then  int( (100 * ApplyHourlyResultMultipliers_NEM( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringSrcAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor          ) / CondFloorArea) + 0.5) / 100
            else  int( (100 * ApplyHourlyResultMultipliers_NEM( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringSrcAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, 1, "BT" ) / CondFloorArea) + 0.5) / 100  endif
      else        int( (100 * ApplyHourlyResultMultipliers(     "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "PV" ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate Src - NatGas - N-PV"			Proj:RunResultsN[13]:StdNatGasSrc		= {	0  }
	"Calculate Src - Other  - N-PV"			Proj:RunResultsN[13]:StdOtherSrc			= {	0  }
	"Calculate Src - TOTAL  - N-PV"			Proj:RunResultsN[13]:StandardSrc			= {	LocalRef( RunResultsN[13]:StdElecSrc )   }

  ; Battery
   ; mods to calc NEM-adjusted Battery Src (StdElecSrc) for 2019 analysis
	"Calculate Src - Elec   - N-Battery"	Proj:RunResultsN[14]:StdElecSrc			= {	if (LocalRef( RunResultsN[14]:StdElecEnergy		) < 0.0001) then  0
		else if (IfValidAnd( NetEnergyMeteringSrcAdj != 0))
      then  if (LocalRef( RunResultsN[13]:PropElecEnergy[1] ) = 0)
            then  int( (100 * ApplyHourlyResultMultipliers_NEM( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "BT", "Tot", NetEnergyMeteringSrcAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor          ) / CondFloorArea) + 0.5) / 100
            else  int( (100 * ApplyHourlyResultMultipliers_NEM( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "BT", "Tot", NetEnergyMeteringSrcAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, 1, "PV" ) / CondFloorArea) + 0.5) / 100  endif
      else        int( (100 * ApplyHourlyResultMultipliers(     "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "BT" ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate Src - NatGas - N-Battery"	Proj:RunResultsN[14]:StdNatGasSrc		= {	0  }
	"Calculate Src - Other  - N-Battery"	Proj:RunResultsN[14]:StdOtherSrc			= {	0  }
	"Calculate Src - TOTAL  - N-Battery"	Proj:RunResultsN[14]:StandardSrc			= {	LocalRef( RunResultsN[14]:StdElecSrc )   }

  ; Compliance Total
  ; SAC 1/14/13 - added in PVCredit to Std (elec) Src
; mjb-10/16/13	remove PVCredit from Std Design
	"Calculate Src - Elec   - N-Comp Ttl"	Proj:RunResultsN[11]:StdElecSrc			= {	RunResultsN[1]:StdElecSrc    + RunResultsN[2]:StdElecSrc    + RunResultsN[3]:StdElecSrc    + RunResultsN[4]:StdElecSrc    + RunResultsN[5]:StdElecSrc     }
	"Calculate Src - NatGas - N-Comp Ttl"	Proj:RunResultsN[11]:StdNatGasSrc		= {	RunResultsN[1]:StdNatGasSrc  + RunResultsN[2]:StdNatGasSrc  + RunResultsN[3]:StdNatGasSrc  + RunResultsN[4]:StdNatGasSrc  + RunResultsN[5]:StdNatGasSrc   }
	"Calculate Src - Other  - N-Comp Ttl"	Proj:RunResultsN[11]:StdOtherSrc			= {	RunResultsN[1]:StdOtherSrc   + RunResultsN[2]:StdOtherSrc   + RunResultsN[3]:StdOtherSrc   + RunResultsN[4]:StdOtherSrc   + RunResultsN[5]:StdOtherSrc    }
	"Calculate Src - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:StandardSrc			= {	RunResultsN[1]:StandardSrc   + RunResultsN[2]:StandardSrc   + RunResultsN[3]:StandardSrc   + RunResultsN[4]:StandardSrc   + RunResultsN[5]:StandardSrc    }

  ; Total
	"Calculate Src - Elec   - N-Total"		Proj:RunResultsN[10]:StdElecSrc			= {	RunResultsN[11]:StdElecSrc    + RunResultsN[6]:StdElecSrc    + RunResultsN[7]:StdElecSrc    + RunResultsN[8]:StdElecSrc    + RunResultsN[9]:StdElecSrc    + RunResultsN[13]:StdElecSrc    + RunResultsN[14]:StdElecSrc     }
	"Calculate Src - NatGas - N-Total"		Proj:RunResultsN[10]:StdNatGasSrc		= {	RunResultsN[11]:StdNatGasSrc  + RunResultsN[6]:StdNatGasSrc  + RunResultsN[7]:StdNatGasSrc  + RunResultsN[8]:StdNatGasSrc  + RunResultsN[9]:StdNatGasSrc  + RunResultsN[13]:StdNatGasSrc  + RunResultsN[14]:StdNatGasSrc   }
	"Calculate Src - Other  - N-Total"		Proj:RunResultsN[10]:StdOtherSrc			= {	RunResultsN[11]:StdOtherSrc   + RunResultsN[6]:StdOtherSrc   + RunResultsN[7]:StdOtherSrc   + RunResultsN[8]:StdOtherSrc   + RunResultsN[9]:StdOtherSrc   + RunResultsN[13]:StdOtherSrc   + RunResultsN[14]:StdOtherSrc    }
	"Calculate Src - TOTAL  - N-Total"		Proj:RunResultsN[10]:StandardSrc			= {	RunResultsN[11]:StandardSrc   + RunResultsN[6]:StandardSrc   + RunResultsN[7]:StandardSrc   + RunResultsN[8]:StandardSrc   + RunResultsN[9]:StandardSrc   + RunResultsN[13]:StandardSrc   + RunResultsN[14]:StandardSrc    }

; not applicable to source energy (2022+) ?? - SAC 6/13/19
;	; SAC 4/2/14 - moved PV credit calcs into subordinate rulelist
;	"Set Proj:PVBaseTDV"						Proj:PVBaseTDV	= {	RunResultsN[11]:StandardTDV * CondFloorArea  }		; SAC 4/14/15 - switched from elecTotalTDV to totalCompTDV - was: RunResultsN[10]:StdElecTDV
;	"Perform PV calcs if applicable"		Proj:Action		= {	if (PVGenCredit < 1 .OR. StandardsVersion == 2014 .OR. CondFloorArea < 0.01) then  UNCHANGED
;																				else	switch ( CompCodeBase )
;																							case  2013 :	EvalRulelist( "CARes_CalculatePVCredit_2013Compliance" )
;																							case  2016 :	EvalRulelist( "CARes_CalculatePVCredit_2016Compliance" )
;																							default    :	UNCHANGED   ; no specific PV credit for 2019 or 2022
;																						endswitch  endif  }
;	; SAC 4/3/15 - set new EnergyUse:PropPVCreditTDV property (needed to track & pass PVCredit from first to second Proposed EnergyUse data)
;	"Store PropPVCreditTDV[1] - N"			Proj:RunResultsN[6]:PropPVCreditTDV[1]		= {	PVCredit[1]  }
;	"Store PropPVCreditTDV[1] - E"			Proj:RunResultsE[6]:PropPVCreditTDV[1]		= {	PVCredit[1]  }
;	"Store PropPVCreditTDV[1] - S"			Proj:RunResultsS[6]:PropPVCreditTDV[1]		= {	PVCredit[1]  }
;	"Store PropPVCreditTDV[1] - W"			Proj:RunResultsW[6]:PropPVCreditTDV[1]		= {	PVCredit[1]  }
;; ADJUST certain Proposed results that now are to have PVCredit applied to them
;; mjb-10/16/13	subtracted PVCredit from Elec and TOTAL
;	"Calculate TDV - Elec   - N-Comp Ttl"	Proj:RunResultsN[11]:PropElecTDV[1]			= {	RunResultsN[11]:PropElecTDV[1]  - PVCredit[1]  }
;	"Calculate TDV - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:ProposedTDV[1]			= {	RunResultsN[11]:ProposedTDV[1]  - PVCredit[1]  }
;	"Calculate TDV - Elec   - N-Total"		Proj:RunResultsN[10]:PropElecTDV[1]			= {	RunResultsN[10]:PropElecTDV[1]  - PVCredit[1]  }
;	"Calculate TDV - TOTAL  - N-Total"		Proj:RunResultsN[10]:ProposedTDV[1]			= {	RunResultsN[10]:ProposedTDV[1]  - PVCredit[1]  }
;
;	"Calculate TDV - Elec   - E-Comp Ttl"	Proj:RunResultsE[11]:PropElecTDV[1]			= {	RunResultsE[11]:PropElecTDV[1]  - PVCredit[1]  }
;	"Calculate TDV - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:ProposedTDV[1]			= {	RunResultsE[11]:ProposedTDV[1]  - PVCredit[1]  }
;	"Calculate TDV - Elec   - E-Total"		Proj:RunResultsE[10]:PropElecTDV[1]			= {	RunResultsE[10]:PropElecTDV[1]  - PVCredit[1]  }
;	"Calculate TDV - TOTAL  - E-Total"		Proj:RunResultsE[10]:ProposedTDV[1]			= {	RunResultsE[10]:ProposedTDV[1]  - PVCredit[1]  }
;
;	"Calculate TDV - Elec   - S-Comp Ttl"	Proj:RunResultsS[11]:PropElecTDV[1]			= {	RunResultsS[11]:PropElecTDV[1]  - PVCredit[1]  }
;	"Calculate TDV - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:ProposedTDV[1]			= {	RunResultsS[11]:ProposedTDV[1]  - PVCredit[1]  }
;	"Calculate TDV - Elec   - S-Total"		Proj:RunResultsS[10]:PropElecTDV[1]			= {	RunResultsS[10]:PropElecTDV[1]  - PVCredit[1]  }
;	"Calculate TDV - TOTAL  - S-Total"		Proj:RunResultsS[10]:ProposedTDV[1]			= {	RunResultsS[10]:ProposedTDV[1]  - PVCredit[1]  }
;
;	"Calculate TDV - Elec   - W-Comp Ttl"	Proj:RunResultsW[11]:PropElecTDV[1]			= {	RunResultsW[11]:PropElecTDV[1]  - PVCredit[1]  }
;	"Calculate TDV - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:ProposedTDV[1]			= {	RunResultsW[11]:ProposedTDV[1]  - PVCredit[1]  }
;	"Calculate TDV - Elec   - W-Total"		Proj:RunResultsW[10]:PropElecTDV[1]			= {	RunResultsW[10]:PropElecTDV[1]  - PVCredit[1]  }
;	"Calculate TDV - TOTAL  - W-Total"		Proj:RunResultsW[10]:ProposedTDV[1]			= {	RunResultsW[10]:ProposedTDV[1]  - PVCredit[1]  }

; -- COPY N results to E --
  ; Space Heating (& heating fan)
	"Calculate Src - Elec   - E-SpcHt"		Proj:RunResultsE[1]:StdElecSrc			= {	RunResultsN[1]:StdElecSrc        }
	"Calculate Src - NatGas - E-SpcHt"		Proj:RunResultsE[1]:StdNatGasSrc			= {	RunResultsN[1]:StdNatGasSrc      }
	"Calculate Src - Other  - E-SpcHt"		Proj:RunResultsE[1]:StdOtherSrc			= {	RunResultsN[1]:StdOtherSrc       }
	"Calculate Src - TOTAL  - E-SpcHt"		Proj:RunResultsE[1]:StandardSrc			= {	RunResultsN[1]:StandardSrc       }
  ; Space Cooling (& cooling fan)                                                                                     
	"Calculate Src - Elec   - E-SpcCl"		Proj:RunResultsE[2]:StdElecSrc			= {	RunResultsN[2]:StdElecSrc        }
	"Calculate Src - NatGas - E-SpcCl"		Proj:RunResultsE[2]:StdNatGasSrc			= {	RunResultsN[2]:StdNatGasSrc      }
	"Calculate Src - Other  - E-SpcCl"		Proj:RunResultsE[2]:StdOtherSrc			= {	RunResultsN[2]:StdOtherSrc       }
	"Calculate Src - TOTAL  - E-SpcCl"		Proj:RunResultsE[2]:StandardSrc			= {	RunResultsN[2]:StandardSrc       }
  ; IAQ Ventilation Fans                                                                                              
	"Calculate Src - Elec   - E-IAQVent"	Proj:RunResultsE[3]:StdElecSrc			= {	RunResultsN[3]:StdElecSrc        }
	"Calculate Src - NatGas - E-IAQVent"	Proj:RunResultsE[3]:StdNatGasSrc			= {	RunResultsN[3]:StdNatGasSrc      }
	"Calculate Src - Other  - E-IAQVent"	Proj:RunResultsE[3]:StdOtherSrc			= {	RunResultsN[3]:StdOtherSrc       }
	"Calculate Src - TOTAL  - E-IAQVent"	Proj:RunResultsE[3]:StandardSrc			= {	RunResultsN[3]:StandardSrc       }
  ; Other HVAC (aux & misc fans)                                                                                      
	"Calculate Src - Elec   - E-OthrHVAC"	Proj:RunResultsE[4]:StdElecSrc			= {	RunResultsN[4]:StdElecSrc        }
	"Calculate Src - NatGas - E-OthrHVAC"	Proj:RunResultsE[4]:StdNatGasSrc			= {	RunResultsN[4]:StdNatGasSrc      }
	"Calculate Src - Other  - E-OthrHVAC"	Proj:RunResultsE[4]:StdOtherSrc			= {	RunResultsN[4]:StdOtherSrc       }
	"Calculate Src - TOTAL  - E-OthrHVAC"	Proj:RunResultsE[4]:StandardSrc			= {	RunResultsN[4]:StandardSrc       }
  ; Water Heating                                                                                                     
	"Calculate Src - Elec   - E-WtrHt"		Proj:RunResultsE[5]:StdElecSrc			= {	RunResultsN[5]:StdElecSrc        }
	"Calculate Src - NatGas - E-WtrHt"		Proj:RunResultsE[5]:StdNatGasSrc			= {	RunResultsN[5]:StdNatGasSrc      }
	"Calculate Src - Other  - E-WtrHt"		Proj:RunResultsE[5]:StdOtherSrc			= {	RunResultsN[5]:StdOtherSrc       }
	"Calculate Src - TOTAL  - E-WtrHt"		Proj:RunResultsE[5]:StandardSrc			= {	RunResultsN[5]:StandardSrc       }
  ; Inside Lighting                                                                                                   
	"Calculate Src - Elec   - E-InsLtg"		Proj:RunResultsE[6]:StdElecSrc			= {	RunResultsN[6]:StdElecSrc        }
	"Calculate Src - NatGas - E-InsLtg"		Proj:RunResultsE[6]:StdNatGasSrc			= {	RunResultsN[6]:StdNatGasSrc      }
	"Calculate Src - Other  - E-InsLtg"		Proj:RunResultsE[6]:StdOtherSrc			= {	RunResultsN[6]:StdOtherSrc       }
	"Calculate Src - TOTAL  - E-InsLtg"		Proj:RunResultsE[6]:StandardSrc			= {	RunResultsN[6]:StandardSrc       }
  ; Appliances & Cooking                                                                                              
	"Calculate Src - Elec   - E-AppCkg"		Proj:RunResultsE[7]:StdElecSrc			= {	RunResultsN[7]:StdElecSrc        }
	"Calculate Src - NatGas - E-AppCkg"		Proj:RunResultsE[7]:StdNatGasSrc			= {	RunResultsN[7]:StdNatGasSrc      }
	"Calculate Src - Other  - E-AppCkg"		Proj:RunResultsE[7]:StdOtherSrc			= {	RunResultsN[7]:StdOtherSrc       }
	"Calculate Src - TOTAL  - E-AppCkg"		Proj:RunResultsE[7]:StandardSrc			= {	RunResultsN[7]:StandardSrc       }
  ; Plug Loads                                                                                                        
	"Calculate Src - Elec   - E-Plugs"		Proj:RunResultsE[8]:StdElecSrc			= {	RunResultsN[8]:StdElecSrc        }
	"Calculate Src - NatGas - E-Plugs"		Proj:RunResultsE[8]:StdNatGasSrc			= {	RunResultsN[8]:StdNatGasSrc      }
	"Calculate Src - Other  - E-Plugs"		Proj:RunResultsE[8]:StdOtherSrc			= {	RunResultsN[8]:StdOtherSrc       }
	"Calculate Src - TOTAL  - E-Plugs"		Proj:RunResultsE[8]:StandardSrc			= {	RunResultsN[8]:StandardSrc       }
  ; Exterior                                                                                                          
	"Calculate Src - Elec   - E-Ext"			Proj:RunResultsE[9]:StdElecSrc			= {	RunResultsN[9]:StdElecSrc        }
	"Calculate Src - NatGas - E-Ext"			Proj:RunResultsE[9]:StdNatGasSrc			= {	RunResultsN[9]:StdNatGasSrc      }
	"Calculate Src - Other  - E-Ext"			Proj:RunResultsE[9]:StdOtherSrc			= {	RunResultsN[9]:StdOtherSrc       }
	"Calculate Src - TOTAL  - E-Ext"			Proj:RunResultsE[9]:StandardSrc			= {	RunResultsN[9]:StandardSrc       }
  ; PV
	"Calculate Src - Elec   - E-PV"			Proj:RunResultsE[13]:StdElecSrc			= {	RunResultsN[13]:StdElecSrc       }
	"Calculate Src - NatGas - E-PV"			Proj:RunResultsE[13]:StdNatGasSrc		= {	RunResultsN[13]:StdNatGasSrc     }
	"Calculate Src - Other  - E-PV"			Proj:RunResultsE[13]:StdOtherSrc			= {	RunResultsN[13]:StdOtherSrc      }
	"Calculate Src - TOTAL  - E-PV"			Proj:RunResultsE[13]:StandardSrc			= {	RunResultsN[13]:StandardSrc      }
  ; Battery
	"Calculate Src - Elec   - E-Battery"	Proj:RunResultsE[14]:StdElecSrc			= {	RunResultsN[14]:StdElecSrc       }
	"Calculate Src - NatGas - E-Battery"	Proj:RunResultsE[14]:StdNatGasSrc		= {	RunResultsN[14]:StdNatGasSrc     }
	"Calculate Src - Other  - E-Battery"	Proj:RunResultsE[14]:StdOtherSrc			= {	RunResultsN[14]:StdOtherSrc      }
	"Calculate Src - TOTAL  - E-Battery"	Proj:RunResultsE[14]:StandardSrc			= {	RunResultsN[14]:StandardSrc      }
  ; Compliance Total                                                                                                  
	"Calculate Src - Elec   - E-Comp Ttl"	Proj:RunResultsE[11]:StdElecSrc			= {	RunResultsN[11]:StdElecSrc       }
	"Calculate Src - NatGas - E-Comp Ttl"	Proj:RunResultsE[11]:StdNatGasSrc		= {	RunResultsN[11]:StdNatGasSrc     }
	"Calculate Src - Other  - E-Comp Ttl"	Proj:RunResultsE[11]:StdOtherSrc			= {	RunResultsN[11]:StdOtherSrc      }
	"Calculate Src - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:StandardSrc			= {	RunResultsN[11]:StandardSrc      }
  ; Total                                                                                                             
	"Calculate Src - Elec   - E-Total"		Proj:RunResultsE[10]:StdElecSrc			= {	RunResultsN[10]:StdElecSrc       }
	"Calculate Src - NatGas - E-Total"		Proj:RunResultsE[10]:StdNatGasSrc		= {	RunResultsN[10]:StdNatGasSrc     }
	"Calculate Src - Other  - E-Total"		Proj:RunResultsE[10]:StdOtherSrc			= {	RunResultsN[10]:StdOtherSrc      }
	"Calculate Src - TOTAL  - E-Total"		Proj:RunResultsE[10]:StandardSrc			= {	RunResultsN[10]:StandardSrc      }

; -- COPY N results to S --
  ; Space Heating (& heating fan)
	"Calculate Src - Elec   - S-SpcHt"		Proj:RunResultsS[1]:StdElecSrc			= {	RunResultsN[1]:StdElecSrc        }
	"Calculate Src - NatGas - S-SpcHt"		Proj:RunResultsS[1]:StdNatGasSrc			= {	RunResultsN[1]:StdNatGasSrc      }
	"Calculate Src - Other  - S-SpcHt"		Proj:RunResultsS[1]:StdOtherSrc			= {	RunResultsN[1]:StdOtherSrc       }
	"Calculate Src - TOTAL  - S-SpcHt"		Proj:RunResultsS[1]:StandardSrc			= {	RunResultsN[1]:StandardSrc       }
  ; Space Cooling (& cooling fan)                                                                                     
	"Calculate Src - Elec   - S-SpcCl"		Proj:RunResultsS[2]:StdElecSrc			= {	RunResultsN[2]:StdElecSrc        }
	"Calculate Src - NatGas - S-SpcCl"		Proj:RunResultsS[2]:StdNatGasSrc			= {	RunResultsN[2]:StdNatGasSrc      }
	"Calculate Src - Other  - S-SpcCl"		Proj:RunResultsS[2]:StdOtherSrc			= {	RunResultsN[2]:StdOtherSrc       }
	"Calculate Src - TOTAL  - S-SpcCl"		Proj:RunResultsS[2]:StandardSrc			= {	RunResultsN[2]:StandardSrc       }
  ; IAQ Ventilation Fans                                                                                              
	"Calculate Src - Elec   - S-IAQVent"	Proj:RunResultsS[3]:StdElecSrc			= {	RunResultsN[3]:StdElecSrc        }
	"Calculate Src - NatGas - S-IAQVent"	Proj:RunResultsS[3]:StdNatGasSrc			= {	RunResultsN[3]:StdNatGasSrc      }
	"Calculate Src - Other  - S-IAQVent"	Proj:RunResultsS[3]:StdOtherSrc			= {	RunResultsN[3]:StdOtherSrc       }
	"Calculate Src - TOTAL  - S-IAQVent"	Proj:RunResultsS[3]:StandardSrc			= {	RunResultsN[3]:StandardSrc       }
  ; Other HVAC (aux & misc fans)                                                                                      
	"Calculate Src - Elec   - S-OthrHVAC"	Proj:RunResultsS[4]:StdElecSrc			= {	RunResultsN[4]:StdElecSrc        }
	"Calculate Src - NatGas - S-OthrHVAC"	Proj:RunResultsS[4]:StdNatGasSrc			= {	RunResultsN[4]:StdNatGasSrc      }
	"Calculate Src - Other  - S-OthrHVAC"	Proj:RunResultsS[4]:StdOtherSrc			= {	RunResultsN[4]:StdOtherSrc       }
	"Calculate Src - TOTAL  - S-OthrHVAC"	Proj:RunResultsS[4]:StandardSrc			= {	RunResultsN[4]:StandardSrc       }
  ; Water Heating                                                                                                     
	"Calculate Src - Elec   - S-WtrHt"		Proj:RunResultsS[5]:StdElecSrc			= {	RunResultsN[5]:StdElecSrc        }
	"Calculate Src - NatGas - S-WtrHt"		Proj:RunResultsS[5]:StdNatGasSrc			= {	RunResultsN[5]:StdNatGasSrc      }
	"Calculate Src - Other  - S-WtrHt"		Proj:RunResultsS[5]:StdOtherSrc			= {	RunResultsN[5]:StdOtherSrc       }
	"Calculate Src - TOTAL  - S-WtrHt"		Proj:RunResultsS[5]:StandardSrc			= {	RunResultsN[5]:StandardSrc       }
  ; Inside Lighting                                                                                                   
	"Calculate Src - Elec   - S-InsLtg"		Proj:RunResultsS[6]:StdElecSrc			= {	RunResultsN[6]:StdElecSrc        }
	"Calculate Src - NatGas - S-InsLtg"		Proj:RunResultsS[6]:StdNatGasSrc			= {	RunResultsN[6]:StdNatGasSrc      }
	"Calculate Src - Other  - S-InsLtg"		Proj:RunResultsS[6]:StdOtherSrc			= {	RunResultsN[6]:StdOtherSrc       }
	"Calculate Src - TOTAL  - S-InsLtg"		Proj:RunResultsS[6]:StandardSrc			= {	RunResultsN[6]:StandardSrc       }
  ; Appliances & Cooking                                                                                              
	"Calculate Src - Elec   - S-AppCkg"		Proj:RunResultsS[7]:StdElecSrc			= {	RunResultsN[7]:StdElecSrc        }
	"Calculate Src - NatGas - S-AppCkg"		Proj:RunResultsS[7]:StdNatGasSrc			= {	RunResultsN[7]:StdNatGasSrc      }
	"Calculate Src - Other  - S-AppCkg"		Proj:RunResultsS[7]:StdOtherSrc			= {	RunResultsN[7]:StdOtherSrc       }
	"Calculate Src - TOTAL  - S-AppCkg"		Proj:RunResultsS[7]:StandardSrc			= {	RunResultsN[7]:StandardSrc       }
  ; Plug Loads                                                                                                        
	"Calculate Src - Elec   - S-Plugs"		Proj:RunResultsS[8]:StdElecSrc			= {	RunResultsN[8]:StdElecSrc        }
	"Calculate Src - NatGas - S-Plugs"		Proj:RunResultsS[8]:StdNatGasSrc			= {	RunResultsN[8]:StdNatGasSrc      }
	"Calculate Src - Other  - S-Plugs"		Proj:RunResultsS[8]:StdOtherSrc			= {	RunResultsN[8]:StdOtherSrc       }
	"Calculate Src - TOTAL  - S-Plugs"		Proj:RunResultsS[8]:StandardSrc			= {	RunResultsN[8]:StandardSrc       }
  ; Exterior                                                                                                          
	"Calculate Src - Elec   - S-Ext"			Proj:RunResultsS[9]:StdElecSrc			= {	RunResultsN[9]:StdElecSrc        }
	"Calculate Src - NatGas - S-Ext"			Proj:RunResultsS[9]:StdNatGasSrc			= {	RunResultsN[9]:StdNatGasSrc      }
	"Calculate Src - Other  - S-Ext"			Proj:RunResultsS[9]:StdOtherSrc			= {	RunResultsN[9]:StdOtherSrc       }
	"Calculate Src - TOTAL  - S-Ext"			Proj:RunResultsS[9]:StandardSrc			= {	RunResultsN[9]:StandardSrc       }
  ; PV
	"Calculate Src - Elec   - S-PV"			Proj:RunResultsS[13]:StdElecSrc			= {	RunResultsN[13]:StdElecSrc       }
	"Calculate Src - NatGas - S-PV"			Proj:RunResultsS[13]:StdNatGasSrc		= {	RunResultsN[13]:StdNatGasSrc     }
	"Calculate Src - Other  - S-PV"			Proj:RunResultsS[13]:StdOtherSrc			= {	RunResultsN[13]:StdOtherSrc      }
	"Calculate Src - TOTAL  - S-PV"			Proj:RunResultsS[13]:StandardSrc			= {	RunResultsN[13]:StandardSrc      }
  ; Battery
	"Calculate Src - Elec   - S-Battery"	Proj:RunResultsS[14]:StdElecSrc			= {	RunResultsN[14]:StdElecSrc       }
	"Calculate Src - NatGas - S-Battery"	Proj:RunResultsS[14]:StdNatGasSrc		= {	RunResultsN[14]:StdNatGasSrc     }
	"Calculate Src - Other  - S-Battery"	Proj:RunResultsS[14]:StdOtherSrc			= {	RunResultsN[14]:StdOtherSrc      }
	"Calculate Src - TOTAL  - S-Battery"	Proj:RunResultsS[14]:StandardSrc			= {	RunResultsN[14]:StandardSrc      }
  ; Compliance Total                                                                                                  
	"Calculate Src - Elec   - S-Comp Ttl"	Proj:RunResultsS[11]:StdElecSrc			= {	RunResultsN[11]:StdElecSrc       }
	"Calculate Src - NatGas - S-Comp Ttl"	Proj:RunResultsS[11]:StdNatGasSrc		= {	RunResultsN[11]:StdNatGasSrc     }
	"Calculate Src - Other  - S-Comp Ttl"	Proj:RunResultsS[11]:StdOtherSrc			= {	RunResultsN[11]:StdOtherSrc      }
	"Calculate Src - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:StandardSrc			= {	RunResultsN[11]:StandardSrc      }
  ; Total                                                                                                             
	"Calculate Src - Elec   - S-Total"		Proj:RunResultsS[10]:StdElecSrc			= {	RunResultsN[10]:StdElecSrc       }
	"Calculate Src - NatGas - S-Total"		Proj:RunResultsS[10]:StdNatGasSrc		= {	RunResultsN[10]:StdNatGasSrc     }
	"Calculate Src - Other  - S-Total"		Proj:RunResultsS[10]:StdOtherSrc			= {	RunResultsN[10]:StdOtherSrc      }
	"Calculate Src - TOTAL  - S-Total"		Proj:RunResultsS[10]:StandardSrc			= {	RunResultsN[10]:StandardSrc      }

; -- COPY N results to W --
  ; Space Heating (& heating fan)
	"Calculate Src - Elec   - W-SpcHt"		Proj:RunResultsW[1]:StdElecSrc			= {	RunResultsN[1]:StdElecSrc        }
	"Calculate Src - NatGas - W-SpcHt"		Proj:RunResultsW[1]:StdNatGasSrc			= {	RunResultsN[1]:StdNatGasSrc      }
	"Calculate Src - Other  - W-SpcHt"		Proj:RunResultsW[1]:StdOtherSrc			= {	RunResultsN[1]:StdOtherSrc       }
	"Calculate Src - TOTAL  - W-SpcHt"		Proj:RunResultsW[1]:StandardSrc			= {	RunResultsN[1]:StandardSrc       }
  ; Space Cooling (& cooling fan)                                                                                     
	"Calculate Src - Elec   - W-SpcCl"		Proj:RunResultsW[2]:StdElecSrc			= {	RunResultsN[2]:StdElecSrc        }
	"Calculate Src - NatGas - W-SpcCl"		Proj:RunResultsW[2]:StdNatGasSrc			= {	RunResultsN[2]:StdNatGasSrc      }
	"Calculate Src - Other  - W-SpcCl"		Proj:RunResultsW[2]:StdOtherSrc			= {	RunResultsN[2]:StdOtherSrc       }
	"Calculate Src - TOTAL  - W-SpcCl"		Proj:RunResultsW[2]:StandardSrc			= {	RunResultsN[2]:StandardSrc       }
  ; IAQ Ventilation Fans                                                                                              
	"Calculate Src - Elec   - W-IAQVent"	Proj:RunResultsW[3]:StdElecSrc			= {	RunResultsN[3]:StdElecSrc        }
	"Calculate Src - NatGas - W-IAQVent"	Proj:RunResultsW[3]:StdNatGasSrc			= {	RunResultsN[3]:StdNatGasSrc      }
	"Calculate Src - Other  - W-IAQVent"	Proj:RunResultsW[3]:StdOtherSrc			= {	RunResultsN[3]:StdOtherSrc       }
	"Calculate Src - TOTAL  - W-IAQVent"	Proj:RunResultsW[3]:StandardSrc			= {	RunResultsN[3]:StandardSrc       }
  ; Other HVAC (aux & misc fans)                                                                                      
	"Calculate Src - Elec   - W-OthrHVAC"	Proj:RunResultsW[4]:StdElecSrc			= {	RunResultsN[4]:StdElecSrc        }
	"Calculate Src - NatGas - W-OthrHVAC"	Proj:RunResultsW[4]:StdNatGasSrc			= {	RunResultsN[4]:StdNatGasSrc      }
	"Calculate Src - Other  - W-OthrHVAC"	Proj:RunResultsW[4]:StdOtherSrc			= {	RunResultsN[4]:StdOtherSrc       }
	"Calculate Src - TOTAL  - W-OthrHVAC"	Proj:RunResultsW[4]:StandardSrc			= {	RunResultsN[4]:StandardSrc       }
  ; Water Heating                                                                                                     
	"Calculate Src - Elec   - W-WtrHt"		Proj:RunResultsW[5]:StdElecSrc			= {	RunResultsN[5]:StdElecSrc        }
	"Calculate Src - NatGas - W-WtrHt"		Proj:RunResultsW[5]:StdNatGasSrc			= {	RunResultsN[5]:StdNatGasSrc      }
	"Calculate Src - Other  - W-WtrHt"		Proj:RunResultsW[5]:StdOtherSrc			= {	RunResultsN[5]:StdOtherSrc       }
	"Calculate Src - TOTAL  - W-WtrHt"		Proj:RunResultsW[5]:StandardSrc			= {	RunResultsN[5]:StandardSrc       }
  ; Inside Lighting                                                                                                   
	"Calculate Src - Elec   - W-InsLtg"		Proj:RunResultsW[6]:StdElecSrc			= {	RunResultsN[6]:StdElecSrc        }
	"Calculate Src - NatGas - W-InsLtg"		Proj:RunResultsW[6]:StdNatGasSrc			= {	RunResultsN[6]:StdNatGasSrc      }
	"Calculate Src - Other  - W-InsLtg"		Proj:RunResultsW[6]:StdOtherSrc			= {	RunResultsN[6]:StdOtherSrc       }
	"Calculate Src - TOTAL  - W-InsLtg"		Proj:RunResultsW[6]:StandardSrc			= {	RunResultsN[6]:StandardSrc       }
  ; Appliances & Cooking                                                                                              
	"Calculate Src - Elec   - W-AppCkg"		Proj:RunResultsW[7]:StdElecSrc			= {	RunResultsN[7]:StdElecSrc        }
	"Calculate Src - NatGas - W-AppCkg"		Proj:RunResultsW[7]:StdNatGasSrc			= {	RunResultsN[7]:StdNatGasSrc      }
	"Calculate Src - Other  - W-AppCkg"		Proj:RunResultsW[7]:StdOtherSrc			= {	RunResultsN[7]:StdOtherSrc       }
	"Calculate Src - TOTAL  - W-AppCkg"		Proj:RunResultsW[7]:StandardSrc			= {	RunResultsN[7]:StandardSrc       }
  ; Plug Loads                                                                                                        
	"Calculate Src - Elec   - W-Plugs"		Proj:RunResultsW[8]:StdElecSrc			= {	RunResultsN[8]:StdElecSrc        }
	"Calculate Src - NatGas - W-Plugs"		Proj:RunResultsW[8]:StdNatGasSrc			= {	RunResultsN[8]:StdNatGasSrc      }
	"Calculate Src - Other  - W-Plugs"		Proj:RunResultsW[8]:StdOtherSrc			= {	RunResultsN[8]:StdOtherSrc       }
	"Calculate Src - TOTAL  - W-Plugs"		Proj:RunResultsW[8]:StandardSrc			= {	RunResultsN[8]:StandardSrc       }
  ; Exterior                                                                                                          
	"Calculate Src - Elec   - W-Ext"			Proj:RunResultsW[9]:StdElecSrc			= {	RunResultsN[9]:StdElecSrc        }
	"Calculate Src - NatGas - W-Ext"			Proj:RunResultsW[9]:StdNatGasSrc			= {	RunResultsN[9]:StdNatGasSrc      }
	"Calculate Src - Other  - W-Ext"			Proj:RunResultsW[9]:StdOtherSrc			= {	RunResultsN[9]:StdOtherSrc       }
	"Calculate Src - TOTAL  - W-Ext"			Proj:RunResultsW[9]:StandardSrc			= {	RunResultsN[9]:StandardSrc       }
  ; PV
	"Calculate Src - Elec   - W-PV"			Proj:RunResultsW[13]:StdElecSrc			= {	RunResultsN[13]:StdElecSrc       }
	"Calculate Src - NatGas - W-PV"			Proj:RunResultsW[13]:StdNatGasSrc		= {	RunResultsN[13]:StdNatGasSrc     }
	"Calculate Src - Other  - W-PV"			Proj:RunResultsW[13]:StdOtherSrc			= {	RunResultsN[13]:StdOtherSrc      }
	"Calculate Src - TOTAL  - W-PV"			Proj:RunResultsW[13]:StandardSrc			= {	RunResultsN[13]:StandardSrc      }
  ; Battery
	"Calculate Src - Elec   - W-Battery"   Proj:RunResultsW[14]:StdElecSrc			= {	RunResultsN[14]:StdElecSrc       }
	"Calculate Src - NatGas - W-Battery"	Proj:RunResultsW[14]:StdNatGasSrc		= {	RunResultsN[14]:StdNatGasSrc     }
	"Calculate Src - Other  - W-Battery"	Proj:RunResultsW[14]:StdOtherSrc			= {	RunResultsN[14]:StdOtherSrc      }
	"Calculate Src - TOTAL  - W-Battery"	Proj:RunResultsW[14]:StandardSrc			= {	RunResultsN[14]:StandardSrc      }
  ; Compliance Total                                                                                                  
	"Calculate Src - Elec   - W-Comp Ttl"	Proj:RunResultsW[11]:StdElecSrc			= {	RunResultsN[11]:StdElecSrc       }
	"Calculate Src - NatGas - W-Comp Ttl"	Proj:RunResultsW[11]:StdNatGasSrc		= {	RunResultsN[11]:StdNatGasSrc     }
	"Calculate Src - Other  - W-Comp Ttl"	Proj:RunResultsW[11]:StdOtherSrc			= {	RunResultsN[11]:StdOtherSrc      }
	"Calculate Src - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:StandardSrc			= {	RunResultsN[11]:StandardSrc      }
  ; Total                                                                                                             
	"Calculate Src - Elec   - W-Total"		Proj:RunResultsW[10]:StdElecSrc			= {	RunResultsN[10]:StdElecSrc       }
	"Calculate Src - NatGas - W-Total"		Proj:RunResultsW[10]:StdNatGasSrc		= {	RunResultsN[10]:StdNatGasSrc     }
	"Calculate Src - Other  - W-Total"		Proj:RunResultsW[10]:StdOtherSrc			= {	RunResultsN[10]:StdOtherSrc      }
	"Calculate Src - TOTAL  - W-Total"		Proj:RunResultsW[10]:StandardSrc			= {	RunResultsN[10]:StandardSrc      }


  ; Compliance Margins - NORTH
	"Calc Src Comp Margin - N-SpcHt"    	Proj:RunResultsN[1]:CompMarginSrc	= {	LocalRef( RunResultsN[1]:StandardSrc  ) - LocalRef( RunResultsN[1]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - N-SpcCl"    	Proj:RunResultsN[2]:CompMarginSrc	= {	LocalRef( RunResultsN[2]:StandardSrc  ) - LocalRef( RunResultsN[2]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - N-IAQVent"  	Proj:RunResultsN[3]:CompMarginSrc	= {	LocalRef( RunResultsN[3]:StandardSrc  ) - LocalRef( RunResultsN[3]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - N-OthrHVAC" 	Proj:RunResultsN[4]:CompMarginSrc	= {	LocalRef( RunResultsN[4]:StandardSrc  ) - LocalRef( RunResultsN[4]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - N-WtrHt"    	Proj:RunResultsN[5]:CompMarginSrc	= {	LocalRef( RunResultsN[5]:StandardSrc  ) - LocalRef( RunResultsN[5]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - N-InsLtg"   	Proj:RunResultsN[6]:CompMarginSrc	= {	LocalRef( RunResultsN[6]:StandardSrc  ) - LocalRef( RunResultsN[6]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - N-AppCkg"   	Proj:RunResultsN[7]:CompMarginSrc	= {	LocalRef( RunResultsN[7]:StandardSrc  ) - LocalRef( RunResultsN[7]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - N-Plugs"    	Proj:RunResultsN[8]:CompMarginSrc	= {	LocalRef( RunResultsN[8]:StandardSrc  ) - LocalRef( RunResultsN[8]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - N-Ext"      	Proj:RunResultsN[9]:CompMarginSrc	= {	LocalRef( RunResultsN[9]:StandardSrc  ) - LocalRef( RunResultsN[9]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - N-PV"     	 	Proj:RunResultsN[13]:CompMarginSrc	= {	LocalRef( RunResultsN[13]:StandardSrc ) - LocalRef( RunResultsN[13]:ProposedSrc[1] )   }
	"Calc Src Comp Margin - N-Battery"     Proj:RunResultsN[14]:CompMarginSrc	= {	LocalRef( RunResultsN[14]:StandardSrc ) - LocalRef( RunResultsN[14]:ProposedSrc[1] )   }
	"Calc Src Comp Margin - N-Total"    	Proj:RunResultsN[10]:CompMarginSrc	= {	LocalRef( RunResultsN[10]:StandardSrc ) - LocalRef( RunResultsN[10]:ProposedSrc[1] )   }
	"Calc Src Comp Margin - N-Comp Ttl" 	Proj:RunResultsN[11]:CompMarginSrc	= {	LocalRef( RunResultsN[11]:StandardSrc ) - LocalRef( RunResultsN[11]:ProposedSrc[1] )   }
  ; Percent Improvement
	"Calc Src Pct Improve - N-SpcHt"    	Proj:RunResultsN[1]:PctImproveSrc	= {	if (LocalRef( RunResultsN[1]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsN[1]:CompMarginSrc  ) * 100 / LocalRef( RunResultsN[1]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - N-SpcCl"    	Proj:RunResultsN[2]:PctImproveSrc	= {	if (LocalRef( RunResultsN[2]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsN[2]:CompMarginSrc  ) * 100 / LocalRef( RunResultsN[2]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - N-IAQVent"  	Proj:RunResultsN[3]:PctImproveSrc	= {	if (LocalRef( RunResultsN[3]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsN[3]:CompMarginSrc  ) * 100 / LocalRef( RunResultsN[3]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - N-OthrHVAC" 	Proj:RunResultsN[4]:PctImproveSrc	= {	if (LocalRef( RunResultsN[4]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsN[4]:CompMarginSrc  ) * 100 / LocalRef( RunResultsN[4]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - N-WtrHt"    	Proj:RunResultsN[5]:PctImproveSrc	= {	if (LocalRef( RunResultsN[5]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsN[5]:CompMarginSrc  ) * 100 / LocalRef( RunResultsN[5]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - N-InsLtg"   	Proj:RunResultsN[6]:PctImproveSrc	= {	if (LocalRef( RunResultsN[6]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsN[6]:CompMarginSrc  ) * 100 / LocalRef( RunResultsN[6]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - N-AppCkg"   	Proj:RunResultsN[7]:PctImproveSrc	= {	if (LocalRef( RunResultsN[7]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsN[7]:CompMarginSrc  ) * 100 / LocalRef( RunResultsN[7]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - N-Plugs"    	Proj:RunResultsN[8]:PctImproveSrc	= {	if (LocalRef( RunResultsN[8]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsN[8]:CompMarginSrc  ) * 100 / LocalRef( RunResultsN[8]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - N-Ext"      	Proj:RunResultsN[9]:PctImproveSrc	= {	if (LocalRef( RunResultsN[9]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsN[9]:CompMarginSrc  ) * 100 / LocalRef( RunResultsN[9]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - N-PV"     	 	Proj:RunResultsN[13]:PctImproveSrc	= {	if (LocalRef( RunResultsN[13]:StandardSrc ) == 0) then  0  else  LocalRef( RunResultsN[13]:CompMarginSrc ) * 100 / LocalRef( RunResultsN[13]:StandardSrc )  endif  }
	"Calc Src Pct Improve - N-Battery"     Proj:RunResultsN[14]:PctImproveSrc	= {	if (LocalRef( RunResultsN[14]:StandardSrc ) == 0) then  0  else  LocalRef( RunResultsN[14]:CompMarginSrc ) * 100 / LocalRef( RunResultsN[14]:StandardSrc )  endif  }
	"Calc Src Pct Improve - N-Total"    	Proj:RunResultsN[10]:PctImproveSrc	= {	if (LocalRef( RunResultsN[10]:StandardSrc ) == 0) then  0  else  LocalRef( RunResultsN[10]:CompMarginSrc ) * 100 / LocalRef( RunResultsN[10]:StandardSrc )  endif  }
	"Calc Src Pct Improve - N-Comp Ttl"  	Proj:RunResultsN[11]:PctImproveSrc	= {	if (LocalRef( RunResultsN[11]:StandardSrc ) == 0) then  0  else  LocalRef( RunResultsN[11]:CompMarginSrc ) * 100 / LocalRef( RunResultsN[11]:StandardSrc )  endif  }

  ; Compliance Margins - EAST
	"Calc Src Comp Margin - E-SpcHt"    	Proj:RunResultsE[1]:CompMarginSrc	= {	LocalRef( RunResultsE[1]:StandardSrc  ) - LocalRef( RunResultsE[1]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - E-SpcCl"    	Proj:RunResultsE[2]:CompMarginSrc	= {	LocalRef( RunResultsE[2]:StandardSrc  ) - LocalRef( RunResultsE[2]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - E-IAQVent"  	Proj:RunResultsE[3]:CompMarginSrc	= {	LocalRef( RunResultsE[3]:StandardSrc  ) - LocalRef( RunResultsE[3]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - E-OthrHVAC" 	Proj:RunResultsE[4]:CompMarginSrc	= {	LocalRef( RunResultsE[4]:StandardSrc  ) - LocalRef( RunResultsE[4]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - E-WtrHt"    	Proj:RunResultsE[5]:CompMarginSrc	= {	LocalRef( RunResultsE[5]:StandardSrc  ) - LocalRef( RunResultsE[5]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - E-InsLtg"   	Proj:RunResultsE[6]:CompMarginSrc	= {	LocalRef( RunResultsE[6]:StandardSrc  ) - LocalRef( RunResultsE[6]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - E-AppCkg"   	Proj:RunResultsE[7]:CompMarginSrc	= {	LocalRef( RunResultsE[7]:StandardSrc  ) - LocalRef( RunResultsE[7]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - E-Plugs"    	Proj:RunResultsE[8]:CompMarginSrc	= {	LocalRef( RunResultsE[8]:StandardSrc  ) - LocalRef( RunResultsE[8]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - E-Ext"      	Proj:RunResultsE[9]:CompMarginSrc	= {	LocalRef( RunResultsE[9]:StandardSrc  ) - LocalRef( RunResultsE[9]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - E-PV"     	 	Proj:RunResultsE[13]:CompMarginSrc	= {	LocalRef( RunResultsE[13]:StandardSrc ) - LocalRef( RunResultsE[13]:ProposedSrc[1] )   }
	"Calc Src Comp Margin - E-Battery"     Proj:RunResultsE[14]:CompMarginSrc	= {	LocalRef( RunResultsE[14]:StandardSrc ) - LocalRef( RunResultsE[14]:ProposedSrc[1] )   }
	"Calc Src Comp Margin - E-Total"    	Proj:RunResultsE[10]:CompMarginSrc	= {	LocalRef( RunResultsE[10]:StandardSrc ) - LocalRef( RunResultsE[10]:ProposedSrc[1] )   }
	"Calc Src Comp Margin - E-Comp Ttl" 	Proj:RunResultsE[11]:CompMarginSrc	= {	LocalRef( RunResultsE[11]:StandardSrc ) - LocalRef( RunResultsE[11]:ProposedSrc[1] )   }
  ; Percent Improvement
	"Calc Src Pct Improve - E-SpcHt"    	Proj:RunResultsE[1]:PctImproveSrc	= {	if (LocalRef( RunResultsE[1]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsE[1]:CompMarginSrc  ) * 100 / LocalRef( RunResultsE[1]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - E-SpcCl"    	Proj:RunResultsE[2]:PctImproveSrc	= {	if (LocalRef( RunResultsE[2]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsE[2]:CompMarginSrc  ) * 100 / LocalRef( RunResultsE[2]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - E-IAQVent"  	Proj:RunResultsE[3]:PctImproveSrc	= {	if (LocalRef( RunResultsE[3]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsE[3]:CompMarginSrc  ) * 100 / LocalRef( RunResultsE[3]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - E-OthrHVAC" 	Proj:RunResultsE[4]:PctImproveSrc	= {	if (LocalRef( RunResultsE[4]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsE[4]:CompMarginSrc  ) * 100 / LocalRef( RunResultsE[4]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - E-WtrHt"    	Proj:RunResultsE[5]:PctImproveSrc	= {	if (LocalRef( RunResultsE[5]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsE[5]:CompMarginSrc  ) * 100 / LocalRef( RunResultsE[5]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - E-InsLtg"   	Proj:RunResultsE[6]:PctImproveSrc	= {	if (LocalRef( RunResultsE[6]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsE[6]:CompMarginSrc  ) * 100 / LocalRef( RunResultsE[6]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - E-AppCkg"   	Proj:RunResultsE[7]:PctImproveSrc	= {	if (LocalRef( RunResultsE[7]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsE[7]:CompMarginSrc  ) * 100 / LocalRef( RunResultsE[7]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - E-Plugs"    	Proj:RunResultsE[8]:PctImproveSrc	= {	if (LocalRef( RunResultsE[8]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsE[8]:CompMarginSrc  ) * 100 / LocalRef( RunResultsE[8]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - E-Ext"      	Proj:RunResultsE[9]:PctImproveSrc	= {	if (LocalRef( RunResultsE[9]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsE[9]:CompMarginSrc  ) * 100 / LocalRef( RunResultsE[9]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - E-PV"     	 	Proj:RunResultsE[13]:PctImproveSrc	= {	if (LocalRef( RunResultsE[13]:StandardSrc ) == 0) then  0  else  LocalRef( RunResultsE[13]:CompMarginSrc ) * 100 / LocalRef( RunResultsE[13]:StandardSrc )  endif  }
	"Calc Src Pct Improve - E-Battery"     Proj:RunResultsE[14]:PctImproveSrc	= {	if (LocalRef( RunResultsE[14]:StandardSrc ) == 0) then  0  else  LocalRef( RunResultsE[14]:CompMarginSrc ) * 100 / LocalRef( RunResultsE[14]:StandardSrc )  endif  }
	"Calc Src Pct Improve - E-Total"    	Proj:RunResultsE[10]:PctImproveSrc	= {	if (LocalRef( RunResultsE[10]:StandardSrc ) == 0) then  0  else  LocalRef( RunResultsE[10]:CompMarginSrc ) * 100 / LocalRef( RunResultsE[10]:StandardSrc )  endif  }
	"Calc Src Pct Improve - E-Comp Ttl"  	Proj:RunResultsE[11]:PctImproveSrc	= {	if (LocalRef( RunResultsE[11]:StandardSrc ) == 0) then  0  else  LocalRef( RunResultsE[11]:CompMarginSrc ) * 100 / LocalRef( RunResultsE[11]:StandardSrc )  endif  }

  ; Compliance Margins - SOUTH
	"Calc Src Comp Margin - S-SpcHt"    	Proj:RunResultsS[1]:CompMarginSrc	= {	LocalRef( RunResultsS[1]:StandardSrc  ) - LocalRef( RunResultsS[1]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - S-SpcCl"    	Proj:RunResultsS[2]:CompMarginSrc	= {	LocalRef( RunResultsS[2]:StandardSrc  ) - LocalRef( RunResultsS[2]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - S-IAQVent"  	Proj:RunResultsS[3]:CompMarginSrc	= {	LocalRef( RunResultsS[3]:StandardSrc  ) - LocalRef( RunResultsS[3]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - S-OthrHVAC" 	Proj:RunResultsS[4]:CompMarginSrc	= {	LocalRef( RunResultsS[4]:StandardSrc  ) - LocalRef( RunResultsS[4]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - S-WtrHt"    	Proj:RunResultsS[5]:CompMarginSrc	= {	LocalRef( RunResultsS[5]:StandardSrc  ) - LocalRef( RunResultsS[5]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - S-InsLtg"   	Proj:RunResultsS[6]:CompMarginSrc	= {	LocalRef( RunResultsS[6]:StandardSrc  ) - LocalRef( RunResultsS[6]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - S-AppCkg"   	Proj:RunResultsS[7]:CompMarginSrc	= {	LocalRef( RunResultsS[7]:StandardSrc  ) - LocalRef( RunResultsS[7]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - S-Plugs"    	Proj:RunResultsS[8]:CompMarginSrc	= {	LocalRef( RunResultsS[8]:StandardSrc  ) - LocalRef( RunResultsS[8]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - S-Ext"      	Proj:RunResultsS[9]:CompMarginSrc	= {	LocalRef( RunResultsS[9]:StandardSrc  ) - LocalRef( RunResultsS[9]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - S-PV"     	 	Proj:RunResultsS[13]:CompMarginSrc	= {	LocalRef( RunResultsS[13]:StandardSrc ) - LocalRef( RunResultsS[13]:ProposedSrc[1] )   }
	"Calc Src Comp Margin - S-Battery"     Proj:RunResultsS[14]:CompMarginSrc	= {	LocalRef( RunResultsS[14]:StandardSrc ) - LocalRef( RunResultsS[14]:ProposedSrc[1] )   }
	"Calc Src Comp Margin - S-Total"    	Proj:RunResultsS[10]:CompMarginSrc	= {	LocalRef( RunResultsS[10]:StandardSrc ) - LocalRef( RunResultsS[10]:ProposedSrc[1] )   }
	"Calc Src Comp Margin - S-Comp Ttl" 	Proj:RunResultsS[11]:CompMarginSrc	= {	LocalRef( RunResultsS[11]:StandardSrc ) - LocalRef( RunResultsS[11]:ProposedSrc[1] )   }
  ; Percent Improvement
	"Calc Src Pct Improve - S-SpcHt"    	Proj:RunResultsS[1]:PctImproveSrc	= {	if (LocalRef( RunResultsS[1]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsS[1]:CompMarginSrc  ) * 100 / LocalRef( RunResultsS[1]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - S-SpcCl"    	Proj:RunResultsS[2]:PctImproveSrc	= {	if (LocalRef( RunResultsS[2]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsS[2]:CompMarginSrc  ) * 100 / LocalRef( RunResultsS[2]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - S-IAQVent"  	Proj:RunResultsS[3]:PctImproveSrc	= {	if (LocalRef( RunResultsS[3]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsS[3]:CompMarginSrc  ) * 100 / LocalRef( RunResultsS[3]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - S-OthrHVAC" 	Proj:RunResultsS[4]:PctImproveSrc	= {	if (LocalRef( RunResultsS[4]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsS[4]:CompMarginSrc  ) * 100 / LocalRef( RunResultsS[4]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - S-WtrHt"    	Proj:RunResultsS[5]:PctImproveSrc	= {	if (LocalRef( RunResultsS[5]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsS[5]:CompMarginSrc  ) * 100 / LocalRef( RunResultsS[5]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - S-InsLtg"   	Proj:RunResultsS[6]:PctImproveSrc	= {	if (LocalRef( RunResultsS[6]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsS[6]:CompMarginSrc  ) * 100 / LocalRef( RunResultsS[6]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - S-AppCkg"   	Proj:RunResultsS[7]:PctImproveSrc	= {	if (LocalRef( RunResultsS[7]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsS[7]:CompMarginSrc  ) * 100 / LocalRef( RunResultsS[7]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - S-Plugs"    	Proj:RunResultsS[8]:PctImproveSrc	= {	if (LocalRef( RunResultsS[8]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsS[8]:CompMarginSrc  ) * 100 / LocalRef( RunResultsS[8]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - S-Ext"      	Proj:RunResultsS[9]:PctImproveSrc	= {	if (LocalRef( RunResultsS[9]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsS[9]:CompMarginSrc  ) * 100 / LocalRef( RunResultsS[9]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - S-PV"  	    	Proj:RunResultsS[13]:PctImproveSrc	= {	if (LocalRef( RunResultsS[13]:StandardSrc ) == 0) then  0  else  LocalRef( RunResultsS[13]:CompMarginSrc ) * 100 / LocalRef( RunResultsS[13]:StandardSrc )  endif  }
	"Calc Src Pct Improve - S-Battery"  	Proj:RunResultsS[14]:PctImproveSrc	= {	if (LocalRef( RunResultsS[14]:StandardSrc ) == 0) then  0  else  LocalRef( RunResultsS[14]:CompMarginSrc ) * 100 / LocalRef( RunResultsS[14]:StandardSrc )  endif  }
	"Calc Src Pct Improve - S-Total"    	Proj:RunResultsS[10]:PctImproveSrc	= {	if (LocalRef( RunResultsS[10]:StandardSrc ) == 0) then  0  else  LocalRef( RunResultsS[10]:CompMarginSrc ) * 100 / LocalRef( RunResultsS[10]:StandardSrc )  endif  }
	"Calc Src Pct Improve - S-Comp Ttl"  	Proj:RunResultsS[11]:PctImproveSrc	= {	if (LocalRef( RunResultsS[11]:StandardSrc ) == 0) then  0  else  LocalRef( RunResultsS[11]:CompMarginSrc ) * 100 / LocalRef( RunResultsS[11]:StandardSrc )  endif  }

  ; Compliance Margins - WEST
	"Calc Src Comp Margin - W-SpcHt"    	Proj:RunResultsW[1]:CompMarginSrc	= {	LocalRef( RunResultsW[1]:StandardSrc  ) - LocalRef( RunResultsW[1]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - W-SpcCl"    	Proj:RunResultsW[2]:CompMarginSrc	= {	LocalRef( RunResultsW[2]:StandardSrc  ) - LocalRef( RunResultsW[2]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - W-IAQVent"  	Proj:RunResultsW[3]:CompMarginSrc	= {	LocalRef( RunResultsW[3]:StandardSrc  ) - LocalRef( RunResultsW[3]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - W-OthrHVAC" 	Proj:RunResultsW[4]:CompMarginSrc	= {	LocalRef( RunResultsW[4]:StandardSrc  ) - LocalRef( RunResultsW[4]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - W-WtrHt"    	Proj:RunResultsW[5]:CompMarginSrc	= {	LocalRef( RunResultsW[5]:StandardSrc  ) - LocalRef( RunResultsW[5]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - W-InsLtg"   	Proj:RunResultsW[6]:CompMarginSrc	= {	LocalRef( RunResultsW[6]:StandardSrc  ) - LocalRef( RunResultsW[6]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - W-AppCkg"   	Proj:RunResultsW[7]:CompMarginSrc	= {	LocalRef( RunResultsW[7]:StandardSrc  ) - LocalRef( RunResultsW[7]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - W-Plugs"    	Proj:RunResultsW[8]:CompMarginSrc	= {	LocalRef( RunResultsW[8]:StandardSrc  ) - LocalRef( RunResultsW[8]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - W-Ext"      	Proj:RunResultsW[9]:CompMarginSrc	= {	LocalRef( RunResultsW[9]:StandardSrc  ) - LocalRef( RunResultsW[9]:ProposedSrc[1]  )   }
	"Calc Src Comp Margin - W-PV"      		Proj:RunResultsW[13]:CompMarginSrc	= {	LocalRef( RunResultsW[13]:StandardSrc ) - LocalRef( RunResultsW[13]:ProposedSrc[1] )   }
	"Calc Src Comp Margin - W-Battery"     Proj:RunResultsW[14]:CompMarginSrc	= {	LocalRef( RunResultsW[14]:StandardSrc ) - LocalRef( RunResultsW[14]:ProposedSrc[1] )   }
	"Calc Src Comp Margin - W-Total"    	Proj:RunResultsW[10]:CompMarginSrc	= {	LocalRef( RunResultsW[10]:StandardSrc ) - LocalRef( RunResultsW[10]:ProposedSrc[1] )   }
	"Calc Src Comp Margin - W-Comp Ttl" 	Proj:RunResultsW[11]:CompMarginSrc	= {	LocalRef( RunResultsW[11]:StandardSrc ) - LocalRef( RunResultsW[11]:ProposedSrc[1] )   }
  ; Percent Improvement
	"Calc Src Pct Improve - W-SpcHt"    	Proj:RunResultsW[1]:PctImproveSrc	= {	if (LocalRef( RunResultsW[1]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsW[1]:CompMarginSrc  ) * 100 / LocalRef( RunResultsW[1]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - W-SpcCl"    	Proj:RunResultsW[2]:PctImproveSrc	= {	if (LocalRef( RunResultsW[2]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsW[2]:CompMarginSrc  ) * 100 / LocalRef( RunResultsW[2]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - W-IAQVent"  	Proj:RunResultsW[3]:PctImproveSrc	= {	if (LocalRef( RunResultsW[3]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsW[3]:CompMarginSrc  ) * 100 / LocalRef( RunResultsW[3]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - W-OthrHVAC" 	Proj:RunResultsW[4]:PctImproveSrc	= {	if (LocalRef( RunResultsW[4]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsW[4]:CompMarginSrc  ) * 100 / LocalRef( RunResultsW[4]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - W-WtrHt"    	Proj:RunResultsW[5]:PctImproveSrc	= {	if (LocalRef( RunResultsW[5]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsW[5]:CompMarginSrc  ) * 100 / LocalRef( RunResultsW[5]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - W-InsLtg"   	Proj:RunResultsW[6]:PctImproveSrc	= {	if (LocalRef( RunResultsW[6]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsW[6]:CompMarginSrc  ) * 100 / LocalRef( RunResultsW[6]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - W-AppCkg"   	Proj:RunResultsW[7]:PctImproveSrc	= {	if (LocalRef( RunResultsW[7]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsW[7]:CompMarginSrc  ) * 100 / LocalRef( RunResultsW[7]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - W-Plugs"    	Proj:RunResultsW[8]:PctImproveSrc	= {	if (LocalRef( RunResultsW[8]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsW[8]:CompMarginSrc  ) * 100 / LocalRef( RunResultsW[8]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - W-Ext"      	Proj:RunResultsW[9]:PctImproveSrc	= {	if (LocalRef( RunResultsW[9]:StandardSrc  ) == 0) then  0  else  LocalRef( RunResultsW[9]:CompMarginSrc  ) * 100 / LocalRef( RunResultsW[9]:StandardSrc  )  endif  }
	"Calc Src Pct Improve - W-PV"      		Proj:RunResultsW[13]:PctImproveSrc	= {	if (LocalRef( RunResultsW[13]:StandardSrc ) == 0) then  0  else  LocalRef( RunResultsW[13]:CompMarginSrc ) * 100 / LocalRef( RunResultsW[13]:StandardSrc )  endif  }
	"Calc Src Pct Improve - W-Battery"  	Proj:RunResultsW[14]:PctImproveSrc	= {	if (LocalRef( RunResultsW[14]:StandardSrc ) == 0) then  0  else  LocalRef( RunResultsW[14]:CompMarginSrc ) * 100 / LocalRef( RunResultsW[14]:StandardSrc )  endif  }
	"Calc Src Pct Improve - W-Total"    	Proj:RunResultsW[10]:PctImproveSrc	= {	if (LocalRef( RunResultsW[10]:StandardSrc ) == 0) then  0  else  LocalRef( RunResultsW[10]:CompMarginSrc ) * 100 / LocalRef( RunResultsW[10]:StandardSrc )  endif  }
	"Calc Src Pct Improve - W-Comp Ttl"  	Proj:RunResultsW[11]:PctImproveSrc	= {	if (LocalRef( RunResultsW[11]:StandardSrc ) == 0) then  0  else  LocalRef( RunResultsW[11]:CompMarginSrc ) * 100 / LocalRef( RunResultsW[11]:StandardSrc )  endif  }

; SAC 6/13/19 - prevent override of Worst orientation calc already set based on TDV
;; -- NOW -- Calculate WORST case scenario and reference THOSE RunResults objects in the main RunResults[] elements
;	"Determine which RunResults is Worst case"	Proj:WorstOrientation	= {
;         if (EnergyCodeYearNum >= 2019 .AND. LocalStatus( WorstOrientation ) > 0) then  UNCHANGED
;         else if (RunResultsN[11]:CompMarginTDV <= RunResultsE[11]:CompMarginTDV .AND.
;						RunResultsN[11]:CompMarginTDV <= RunResultsS[11]:CompMarginTDV .AND.
;						RunResultsN[11]:CompMarginTDV <= RunResultsW[11]:CompMarginTDV )	then	1
;			else if (RunResultsE[11]:CompMarginTDV <= RunResultsN[11]:CompMarginTDV .AND.
;						RunResultsE[11]:CompMarginTDV <= RunResultsS[11]:CompMarginTDV .AND.
;						RunResultsE[11]:CompMarginTDV <= RunResultsW[11]:CompMarginTDV )	then	2
;			else if (RunResultsS[11]:CompMarginTDV <= RunResultsN[11]:CompMarginTDV .AND.
;						RunResultsS[11]:CompMarginTDV <= RunResultsE[11]:CompMarginTDV .AND.
;						RunResultsS[11]:CompMarginTDV <= RunResultsW[11]:CompMarginTDV )	then	3	else	4	endif endif endif endif  }
;"dbg" Proj:Action = { PostMessageToLog( "   Setting worst orientation to %g", WorstOrientation )  }
;	"Call rules to set Worst case RunResults"		Proj:Action		= {	switch (WorstOrientation)
;																								case  2 :  EvalRulelist( "CARes_RunResults_SetWorst_SrcEnergy_E" )
;																								case  3 :  EvalRulelist( "CARes_RunResults_SetWorst_SrcEnergy_S" )
;																								case  4 :  EvalRulelist( "CARes_RunResults_SetWorst_SrcEnergy_W" )
;																								default :  EvalRulelist( "CARes_RunResults_SetWorst_SrcEnergy_N" )
;																							endswitch  }
END

;*************************************************************************
RULELIST "CARes_DesignRatingSrcEnergyResults_NESW" 1 0 0 1
;*************************************************************************

	"Store DRtg Proposed Src-multiplied results (N)"		Proj:Action = {	EvalRulelist( "CARes_DRtgPropMultSrcEnergyResults_N" )  }		; SAC 3/14/16
	"Store DRtg Proposed Src-multiplied results (E)"		Proj:Action = {	EvalRulelist( "CARes_DRtgPropMultSrcEnergyResults_E" )  }
	"Store DRtg Proposed Src-multiplied results (S)"		Proj:Action = {	EvalRulelist( "CARes_DRtgPropMultSrcEnergyResults_S" )  }
	"Store DRtg Proposed Src-multiplied results (W)"		Proj:Action = {	EvalRulelist( "CARes_DRtgPropMultSrcEnergyResults_W" )  }

; 1,           "DesignRatingSrc",   BEMP_Flt,  1,  0,  0, "kBtu/ft2-yr",      0,  0,             39110, "Design Rating Src run result for this enduse" 
; 1,           "DRtgPctSavSrc",     BEMP_Flt,  1,  0,  0, "%",                0,  0,             39110, "Percent improvement (DesignRtg -> Prop Src) for this enduse" 

; 1,           "DRtgElecSrc",       BEMP_Flt,  1,  0,  0, "kBtu/ft2-yr",      0,  0,             39110, "Design Rating run Eletric Src for this enduse" 
; 1,           "DRtgNatGasSrc",     BEMP_Flt,  1,  0,  0, "kBtu/ft2-yr",      0,  0,             39110, "Design Rating run Natural Gas Src for this enduse" 
; 1,           "DRtgOtherSrc",      BEMP_Flt,  1,  0,  0, "kBtu/ft2-yr",      0,  0,             39110, "Design Rating run Other Fuel Src for this enduse" 

; SAC 12/5/19 - REMOVED application of fuel adjustment multipliers (leftover from DesignRatingTDV[2] rules) when setting RunResults[*]:DesignRatingSrc[2]
; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
         ; SAC 8/24/19 - replaced 1/3.413 & 0.01 EDR1 table multipliers with Proj:SrcSecMult_Elec & SrcSecMult_Fuel to accommodate 2022+ switch to native (E3) EDR1 table units
         ; SAC 8/26/19 - added primary table multipliers (of 1.0) to all ApplyHourlyResultMult* function calls (to accommodate 2022+ TDV table unit switch)
  ; Space Heating (& heating fan)
	"Calculate Src - Elec   - N-SpcHt"		Proj:RunResultsN[1]:DRtgElecSrc			= {	if (LocalRef( RunResultsN[1]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - N-SpcHt"		Proj:RunResultsN[1]:DRtgNatGasSrc		= {	if (LocalRef( RunResultsN[1]:DRtgNatGasEnergy	) < 0.0001) then  0                                                                                                        
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - N-SpcHt"		Proj:RunResultsN[1]:DRtgOtherSrc			= {	if (LocalRef( RunResultsN[1]:DRtgOtherEnergy		) < 0.0001) then  0                                                                                                        
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - N-SpcHt"		Proj:RunResultsN[1]:DesignRatingSrc[1]	= {	LocalRef( RunResultsN[1]:DRtgElecSrc ) + LocalRef( RunResultsN[1]:DRtgNatGasSrc ) + LocalRef( RunResultsN[1]:DRtgOtherSrc )   }
	"Calculate Src - TOTAL  - N-SpcHt"		Proj:RunResultsN[1]:DesignRatingSrc[2]	= {	RunResultsN[1]:DesignRatingSrc[1]   }

  ; Space Cooling (& cooling fan)
	"Calculate Src - Elec   - N-SpcCl"		Proj:RunResultsN[2]:DRtgElecSrc			= {	if (LocalRef( RunResultsN[2]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - N-SpcCl"		Proj:RunResultsN[2]:DRtgNatGasSrc		= {	if (LocalRef( RunResultsN[2]:DRtgNatGasEnergy	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - N-SpcCl"		Proj:RunResultsN[2]:DRtgOtherSrc			= {	if (LocalRef( RunResultsN[2]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - N-SpcCl"		Proj:RunResultsN[2]:DesignRatingSrc[1]	= {	LocalRef( RunResultsN[2]:DRtgElecSrc ) + LocalRef( RunResultsN[2]:DRtgNatGasSrc ) + LocalRef( RunResultsN[2]:DRtgOtherSrc )   }
	"Calculate Src - TOTAL  - N-SpcCl"		Proj:RunResultsN[2]:DesignRatingSrc[2]	= {	RunResultsN[2]:DesignRatingSrc[1]   }

  ; IAQ Ventilation Fans
	"Calculate Src - Elec   - N-IAQVent"	Proj:RunResultsN[3]:DRtgElecSrc			= {	if (LocalRef( RunResultsN[3]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "FanV" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - N-IAQVent"	Proj:RunResultsN[3]:DRtgNatGasSrc		= {	0  }
	"Calculate Src - Other  - N-IAQVent"	Proj:RunResultsN[3]:DRtgOtherSrc			= {	0  }
	"Calculate Src - TOTAL  - N-IAQVent"	Proj:RunResultsN[3]:DesignRatingSrc[1]	= {	LocalRef( RunResultsN[3]:DRtgElecSrc )   }
	"Calculate Src - TOTAL  - N-IAQVent"	Proj:RunResultsN[3]:DesignRatingSrc[2]	= {	RunResultsN[3]:DesignRatingSrc[1]   }

; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
  ; Other HVAC (aux & misc fans)
	"Calculate Src - Elec   - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgElecSrc			= {	if (LocalRef( RunResultsN[4]:DRtgElecEnergy ) < 0.0001 .AND. OthrHVAC_SpcHtFrac == 0) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "User1" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgNatGasSrc		= {	0  }
	"Calculate Src - Other  - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgOtherSrc			= {	0  }
	"Calculate Src - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:DesignRatingSrc[1]	= {	LocalRef( RunResultsN[4]:DRtgElecSrc )   }
	"Calculate Src - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:DesignRatingSrc[2]	= {	RunResultsN[4]:DesignRatingSrc[1]   }

; SAC 1/27/19 - REDISTRIBUTE OthrHVAC DRtg Src across SpcHt & SpcCl by fuel based on ratio of total Src (across all fuels) (tic #1053)
   "Set OthrHVAC_SpcHtFrac - N-DRtgSrc"      Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResultsN[4]:DesignRatingSrc[1] != 0 )==0) then  0
                                                                           else if (IfValidAnd( RunResultsN[1]:DesignRatingSrc[1] == 0 ) .AND.
                                                                                    IfValidAnd( RunResultsN[2]:DesignRatingSrc[1] == 0 )) then  0.5
                                                                           else   ValidOr( RunResultsN[1]:DesignRatingSrc[1], 0 ) / 
                                                                                 (ValidOr( RunResultsN[1]:DesignRatingSrc[1], 0 ) + ValidOr( RunResultsN[2]:DesignRatingSrc[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Elec   - N-SpcHt"     Proj:RunResultsN[1]:DRtgElecSrc[1]	   = {   if (IfValidAnd( RunResultsN[4]:DRtgElecSrc[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsN[1]:DRtgElecSrc[1] + (RunResultsN[4]:DRtgElecSrc[1]     * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - TOTAL  - N-SpcHt"		Proj:RunResultsN[1]:DesignRatingSrc[1]	= {	LocalRef( RunResultsN[1]:DRtgElecSrc[1] ) + LocalRef( RunResultsN[1]:DRtgNatGasSrc[1] ) + LocalRef( RunResultsN[1]:DRtgOtherSrc[1] )   }
	"REALLOC OthrHVAC - TOTAL  - N-SpcHt"		Proj:RunResultsN[1]:DesignRatingSrc[2]	= {	RunResultsN[1]:DesignRatingSrc[1]   }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Elec   - N-SpcCl"		Proj:RunResultsN[2]:DRtgElecSrc[1]	   = {   if (IfValidAnd( RunResultsN[4]:DRtgElecSrc[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsN[2]:DRtgElecSrc[1] + (RunResultsN[4]:DRtgElecSrc[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - TOTAL  - N-SpcCl"		Proj:RunResultsN[2]:DesignRatingSrc[1]	= {	LocalRef( RunResultsN[2]:DRtgElecSrc[1] ) + LocalRef( RunResultsN[2]:DRtgNatGasSrc[1] ) + LocalRef( RunResultsN[2]:DRtgOtherSrc[1] )   }
	"REALLOC OthrHVAC - TOTAL  - N-SpcCl"		Proj:RunResultsN[2]:DesignRatingSrc[2]	= {	RunResultsN[2]:DesignRatingSrc[1]   }
  ; Other HVAC (aux & misc fans)
	"ZERO-OUT         - Elec   - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgElecSrc[1]	   = {	0  }
	"ZERO-OUT         - NatGas - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgNatGasSrc[1]	= {	0  }
	"ZERO-OUT         - Other  - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgOtherSrc[1]	   = {	0  }
	"ZERO-OUT         - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:DesignRatingSrc[1]	= {	0  }
	"ZERO-OUT         - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:DesignRatingSrc[2]	= {	0  }
   ; SAC 1/27/19 - end of - redistribution of OthrHVAC PropSrc

  ; Water Heating
	"Calculate Src - Elec   - N-WtrHt"		Proj:RunResultsN[5]:DRtgElecSrc			= {	if (LocalRef( RunResultsN[5]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else if (CSEinclDHWMFL_EU)
			 			  																							then  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / CondFloorArea) + 0.5) / 100
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate Src - NatGas - N-WtrHt"		Proj:RunResultsN[5]:DRtgNatGasSrc		= {	if (LocalRef( RunResultsN[5]:DRtgNatGasEnergy	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - N-WtrHt"		Proj:RunResultsN[5]:DRtgOtherSrc			= {	if (LocalRef( RunResultsN[5]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - N-WtrHt"		Proj:RunResultsN[5]:DesignRatingSrc[1]	= {	LocalRef( RunResultsN[5]:DRtgElecSrc ) + LocalRef( RunResultsN[5]:DRtgNatGasSrc ) + LocalRef( RunResultsN[5]:DRtgOtherSrc )   }
	"Calculate Src - TOTAL  - N-WtrHt"		Proj:RunResultsN[5]:DesignRatingSrc[2]	= {	RunResultsN[5]:DesignRatingSrc[1]   }

  ; Inside Lighting
	"Calculate Src - Elec   - N-InsLtg"		Proj:RunResultsN[6]:DRtgElecSrc			= {	if (LocalRef( RunResultsN[6]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - N-InsLtg"		Proj:RunResultsN[6]:DRtgNatGasSrc		= {	if (LocalRef( RunResultsN[6]:DRtgNatGasEnergy	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - N-InsLtg"		Proj:RunResultsN[6]:DRtgOtherSrc			= {	if (LocalRef( RunResultsN[6]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - N-InsLtg"		Proj:RunResultsN[6]:DesignRatingSrc[1]	= {	LocalRef( RunResultsN[6]:DRtgElecSrc ) + LocalRef( RunResultsN[6]:DRtgNatGasSrc ) + LocalRef( RunResultsN[6]:DRtgOtherSrc )   }
	"Calculate Src - TOTAL  - N-InsLtg"		Proj:RunResultsN[6]:DesignRatingSrc[2]	= {	RunResultsN[6]:DesignRatingSrc[1]   }

  ; Appliances & Cooking
	"Calculate Src - Elec   - N-AppCkg"		Proj:RunResultsN[7]:DRtgElecSrc			= {	if (LocalRef( RunResultsN[7]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - N-AppCkg"		Proj:RunResultsN[7]:DRtgNatGasSrc		= {	if (LocalRef( RunResultsN[7]:DRtgNatGasEnergy	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - N-AppCkg"		Proj:RunResultsN[7]:DRtgOtherSrc			= {	if (LocalRef( RunResultsN[7]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - N-AppCkg"		Proj:RunResultsN[7]:DesignRatingSrc[1]	= {	LocalRef( RunResultsN[7]:DRtgElecSrc ) + LocalRef( RunResultsN[7]:DRtgNatGasSrc ) + LocalRef( RunResultsN[7]:DRtgOtherSrc )   }
	"Calculate Src - TOTAL  - N-AppCkg"		Proj:RunResultsN[7]:DesignRatingSrc[2]	= {	RunResultsN[7]:DesignRatingSrc[1]   }

  ; Plug Loads
	"Calculate Src - Elec   - N-Plugs"		Proj:RunResultsN[8]:DRtgElecSrc			= {	if (LocalRef( RunResultsN[8]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - N-Plugs"		Proj:RunResultsN[8]:DRtgNatGasSrc		= {	if (LocalRef( RunResultsN[8]:DRtgNatGasEnergy	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - N-Plugs"		Proj:RunResultsN[8]:DRtgOtherSrc			= {	if (LocalRef( RunResultsN[8]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - N-Plugs"		Proj:RunResultsN[8]:DesignRatingSrc[1]	= {	LocalRef( RunResultsN[8]:DRtgElecSrc ) + LocalRef( RunResultsN[8]:DRtgNatGasSrc ) + LocalRef( RunResultsN[8]:DRtgOtherSrc )   }
	"Calculate Src - TOTAL  - N-Plugs"		Proj:RunResultsN[8]:DesignRatingSrc[2]	= {	RunResultsN[8]:DesignRatingSrc[1]   }

  ; Exterior
	"Calculate Src - Elec   - N-Ext"			Proj:RunResultsN[9]:DRtgElecSrc			= {	if (LocalRef( RunResultsN[9]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - N-Ext"			Proj:RunResultsN[9]:DRtgNatGasSrc		= {	if (LocalRef( RunResultsN[9]:DRtgNatGasEnergy	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 2, SrcMult_Fuel, SrcSecTbl_NGas, ClimateZone, SrcSecMult_Fuel, RunID, "MtrNatGas", "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - Other  - N-Ext"			Proj:RunResultsN[9]:DRtgOtherSrc			= {	if (LocalRef( RunResultsN[9]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 3, SrcMult_Fuel, SrcSecTbl_Othr, ClimateZone, SrcSecMult_Fuel, RunID, "MtrOther",  "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - TOTAL  - N-Ext"			Proj:RunResultsN[9]:DesignRatingSrc[1]	= {	LocalRef( RunResultsN[9]:DRtgElecSrc ) + LocalRef( RunResultsN[9]:DRtgNatGasSrc ) + LocalRef( RunResultsN[9]:DRtgOtherSrc )   }
	"Calculate Src - TOTAL  - N-Ext"			Proj:RunResultsN[9]:DesignRatingSrc[2]	= {	RunResultsN[9]:DesignRatingSrc[1]   }

  ; PV
	"Calculate Src - Elec   - N-PV"			Proj:RunResultsN[13]:DRtgElecSrc			= {	if (LocalRef( RunResultsN[13]:DRtgElecEnergy		) > -0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec", "PV" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - N-PV"			Proj:RunResultsN[13]:DRtgNatGasSrc		= {	0  }
	"Calculate Src - Other  - N-PV"			Proj:RunResultsN[13]:DRtgOtherSrc		= {	0  }
	"Calculate Src - TOTAL  - N-PV"			Proj:RunResultsN[13]:DesignRatingSrc[1] = {	LocalRef( RunResultsN[13]:DRtgElecSrc )   }
	"Calculate Src - TOTAL  - N-PV"			Proj:RunResultsN[13]:DesignRatingSrc[2] = {	RunResultsN[13]:DesignRatingSrc[1]   }

  ; Battery
	"Calculate Src - Elec   - N-Battery"	Proj:RunResultsN[14]:DRtgElecSrc			= {	if (LocalRef( RunResultsN[14]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "none", EDR1TableName, ((ClimateZone-1) * 3) + 1, SrcMult_Elec, SrcSecTbl_Elec, ClimateZone, SrcSecMult_Elec, RunID, "MtrElec",   "BT" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate Src - NatGas - N-Battery"	Proj:RunResultsN[14]:DRtgNatGasSrc		= {	0  }
	"Calculate Src - Other  - N-Battery"	Proj:RunResultsN[14]:DRtgOtherSrc		= {	0  }
	"Calculate Src - TOTAL  - N-Battery"	Proj:RunResultsN[14]:DesignRatingSrc[1] = {	LocalRef( RunResultsN[14]:DRtgElecSrc )   }
	"Calculate Src - TOTAL  - N-Battery"	Proj:RunResultsN[14]:DesignRatingSrc[2] = {	RunResultsN[14]:DesignRatingSrc[1]   }

  ; Compliance Total
	"Calculate Src - Elec   - N-Comp Ttl"	Proj:RunResultsN[11]:DRtgElecSrc			= {	RunResultsN[1]:DRtgElecSrc     + RunResultsN[2]:DRtgElecSrc     + RunResultsN[3]:DRtgElecSrc     + RunResultsN[4]:DRtgElecSrc     + RunResultsN[5]:DRtgElecSrc      }
	"Calculate Src - NatGas - N-Comp Ttl"	Proj:RunResultsN[11]:DRtgNatGasSrc		= {	RunResultsN[1]:DRtgNatGasSrc   + RunResultsN[2]:DRtgNatGasSrc   + RunResultsN[3]:DRtgNatGasSrc   + RunResultsN[4]:DRtgNatGasSrc   + RunResultsN[5]:DRtgNatGasSrc    }
	"Calculate Src - Other  - N-Comp Ttl"	Proj:RunResultsN[11]:DRtgOtherSrc		= {	RunResultsN[1]:DRtgOtherSrc    + RunResultsN[2]:DRtgOtherSrc    + RunResultsN[3]:DRtgOtherSrc    + RunResultsN[4]:DRtgOtherSrc    + RunResultsN[5]:DRtgOtherSrc     }
	"Calculate Src - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:DesignRatingSrc[1] = {	RunResultsN[1]:DesignRatingSrc[1] + RunResultsN[2]:DesignRatingSrc[1] + RunResultsN[3]:DesignRatingSrc[1] + RunResultsN[4]:DesignRatingSrc[1] + RunResultsN[5]:DesignRatingSrc[1]  }
	"Calculate Src - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:DesignRatingSrc[2] = {	RunResultsN[1]:DesignRatingSrc[2] + RunResultsN[2]:DesignRatingSrc[2] + RunResultsN[3]:DesignRatingSrc[2] + RunResultsN[4]:DesignRatingSrc[2] + RunResultsN[5]:DesignRatingSrc[2]  }

  ; Total
	"Calculate Src - Elec   - N-Total"		Proj:RunResultsN[10]:DRtgElecSrc			= {	RunResultsN[11]:DRtgElecSrc     + RunResultsN[6]:DRtgElecSrc     + RunResultsN[7]:DRtgElecSrc     + RunResultsN[8]:DRtgElecSrc     + RunResultsN[9]:DRtgElecSrc      }
	"Calculate Src - NatGas - N-Total"		Proj:RunResultsN[10]:DRtgNatGasSrc		= {	RunResultsN[11]:DRtgNatGasSrc   + RunResultsN[6]:DRtgNatGasSrc   + RunResultsN[7]:DRtgNatGasSrc   + RunResultsN[8]:DRtgNatGasSrc   + RunResultsN[9]:DRtgNatGasSrc    }
	"Calculate Src - Other  - N-Total"		Proj:RunResultsN[10]:DRtgOtherSrc		= {	RunResultsN[11]:DRtgOtherSrc    + RunResultsN[6]:DRtgOtherSrc    + RunResultsN[7]:DRtgOtherSrc    + RunResultsN[8]:DRtgOtherSrc    + RunResultsN[9]:DRtgOtherSrc     }
	"Calculate Src - TOTAL  - N-Total"		Proj:RunResultsN[10]:DesignRatingSrc[1] = {	RunResultsN[11]:DesignRatingSrc[1] + RunResultsN[6]:DesignRatingSrc[1] + RunResultsN[7]:DesignRatingSrc[1] + RunResultsN[8]:DesignRatingSrc[1] + RunResultsN[9]:DesignRatingSrc[1]  }
	"Calculate Src - TOTAL  - N-Total"		Proj:RunResultsN[10]:DesignRatingSrc[2] = {	RunResultsN[11]:DesignRatingSrc[2] + RunResultsN[6]:DesignRatingSrc[2] + RunResultsN[7]:DesignRatingSrc[2] + RunResultsN[8]:DesignRatingSrc[2] + RunResultsN[9]:DesignRatingSrc[2]  }


; not applicable to source energy (2022+) ?? - SAC 6/13/19
;  ; SAC 2/1/16 - inserted RE-calc of Standard model PVCredit (so that it is available for analysis results reporting following design rating run)
;	"Set Proj:PVBaseTDV"						Proj:PVBaseTDV	= {	RunResultsN[11]:StandardTDV * CondFloorArea  }		; SAC 4/14/15 - switched from elecTotalTDV to totalCompTDV - was: RunResultsN[10]:StdElecTDV
;	"Perform PV calcs if applicable"		Proj:Action		= {	if (PVGenCredit < 1 .OR. StandardsVersion == 2014 .OR. CondFloorArea < 0.01) then  UNCHANGED
;																				else	switch ( CompCodeBase )
;																							case  2013 :	EvalRulelist( "CARes_CalculatePVCredit_2013Compliance" )
;																							case  2016 :	EvalRulelist( "CARes_CalculatePVCredit_2016Compliance" )
;																							default    :	UNCHANGED   ; no specific PV credit for 2019 or 2022
;																						endswitch  endif  }
;
;	; SAC 4/2/14 - moved PV credit calcs into subordinate rulelist
;	"Set Proj:PVBaseTDV - DRtg"						Proj:PVBaseTDV	= {	RunResultsN[10]:DesignRatingTDV[1] * CondFloorArea  }		; SAC 4/14/15 - switched from elecTDV to totalTDV - was: RunResultsN[10]:DRtgElecTDV
;		; SAC 2/7/18 - removed logic 'PVGenCredit < 1 .OR.' preventing call to CARes_CalculatePVCredit_2016DesignRating when compliance PV credit toggled off  (repeat of mod made above 3/24/16)
;	"Perform PV calcs if applicable - DRtg"		Proj:Action		= {	if ((StdDesignBase == 2013 .AND. StandardsVersion == 2014) .OR. CondFloorArea < 0.01) then  UNCHANGED
;																							else	switch ( CompCodeBase )
;																										case  2016 :	EvalRulelist( "CARes_CalculatePVCredit_2016DesignRating" )
;																										case  2019 :	EvalRulelist( "CARes_CalculatePVCredit_2016DesignRating" )  ; DsgnRtg PVCredit for 2016 & 2019 same
;																										case  2022 :	EvalRulelist( "CARes_CalculatePVCredit_2016DesignRating" )  ; DsgnRtg PVCredit for 2016, 2019 & 2022 same ??
;																										default    :	UNCHANGED
;																									endswitch  endif  }
;	; SAC 4/3/15 - set new EnergyUse:PropPVCreditTDV property (needed to track & pass PVCredit from first to second Proposed EnergyUse data)
;	"Store PropPVCreditTDV[2] - N"			Proj:RunResultsN[6]:PropPVCreditTDV[2]		= {	PVCredit[2]  }
;	"Store PropPVCreditTDV[2] - E"			Proj:RunResultsE[6]:PropPVCreditTDV[2]		= {	PVCredit[2]  }
;	"Store PropPVCreditTDV[2] - S"			Proj:RunResultsS[6]:PropPVCreditTDV[2]		= {	PVCredit[2]  }
;	"Store PropPVCreditTDV[2] - W"			Proj:RunResultsW[6]:PropPVCreditTDV[2]		= {	PVCredit[2]  }

	; SAC 4/9/15 - adjust RunResults[6]:Prop*[2] properties for DRtgLtgReduction
	"Adjust - Elec   - N-InsLtg for DRtgLtgReduction"	Proj:RunResultsN[6]:PropElecSrc[2]			= {	if (DRtgLtgReduction <= 0 .OR. RunResultsN[6]:PropElecSrc[2]      <= 0) then  UNCHANGED
			 			  																												else              int( (100 * (RunResultsN[6]:PropElecSrc[2]      * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
;	"Adjust - NatGas - N-InsLtg for DRtgLtgReduction"	Proj:RunResultsN[6]:PropNatGasSrc			= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropNatGasSrc[2]    <= 0) then  UNCHANGED
;			 			  																												else              int( (100 * (RunResults[6]:PropNatGasSrc[2]    * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
;	"Adjust - Other  - N-InsLtg for DRtgLtgReduction"	Proj:RunResultsN[6]:PropOtherSrc				= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropOtherSrc[2]     <= 0) then  UNCHANGED
;																																		else              int( (100 * (RunResults[6]:PropOtherSrc[2]     * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
	"Recalc - TOTAL  - N-InsLtg for DRtgLtgReduction"	Proj:RunResultsN[6]:ProposedSrc[2]			= {	RunResultsN[6]:PropElecSrc[2]    + RunResultsN[6]:PropNatGasSrc       + RunResultsN[6]:PropOtherSrc         }
	"Recalc - TOTAL  - N-InsLtg for DRtgLtgReduction"	Proj:RunResultsN[6]:ProposedSrc[3]			= {	RunResultsN[6]:ProposedSrc[2]  }

	"Adjust - Elec   - E-InsLtg for DRtgLtgReduction"	Proj:RunResultsE[6]:PropElecSrc[2]			= {	if (DRtgLtgReduction <= 0 .OR. RunResultsE[6]:PropElecSrc[2]      <= 0) then  UNCHANGED
			 			  																												else              int( (100 * (RunResultsE[6]:PropElecSrc[2]      * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
;	"Adjust - NatGas - E-InsLtg for DRtgLtgReduction"	Proj:RunResultsE[6]:PropNatGasSrc			= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropNatGasSrc[2]    <= 0) then  UNCHANGED
;			 			  																												else              int( (100 * (RunResults[6]:PropNatGasSrc[2]    * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
;	"Adjust - Other  - E-InsLtg for DRtgLtgReduction"	Proj:RunResultsE[6]:PropOtherSrc				= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropOtherSrc[2]     <= 0) then  UNCHANGED
;																																		else              int( (100 * (RunResults[6]:PropOtherSrc[2]     * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
	"Recalc - TOTAL  - E-InsLtg for DRtgLtgReduction"	Proj:RunResultsE[6]:ProposedSrc[2]			= {	RunResultsE[6]:PropElecSrc[2]    + RunResultsE[6]:PropNatGasSrc       + RunResultsE[6]:PropOtherSrc         }
	"Recalc - TOTAL  - E-InsLtg for DRtgLtgReduction"	Proj:RunResultsE[6]:ProposedSrc[3]			= {	RunResultsE[6]:ProposedSrc[2]  }

	"Adjust - Elec   - S-InsLtg for DRtgLtgReduction"	Proj:RunResultsS[6]:PropElecSrc[2]			= {	if (DRtgLtgReduction <= 0 .OR. RunResultsS[6]:PropElecSrc[2]      <= 0) then  UNCHANGED
			 			  																												else              int( (100 * (RunResultsS[6]:PropElecSrc[2]      * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
;	"Adjust - NatGas - S-InsLtg for DRtgLtgReduction"	Proj:RunResultsS[6]:PropNatGasSrc			= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropNatGasSrc[2]    <= 0) then  UNCHANGED
;			 			  																												else              int( (100 * (RunResults[6]:PropNatGasSrc[2]    * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
;	"Adjust - Other  - S-InsLtg for DRtgLtgReduction"	Proj:RunResultsS[6]:PropOtherSrc				= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropOtherSrc[2]     <= 0) then  UNCHANGED
;																																		else              int( (100 * (RunResults[6]:PropOtherSrc[2]     * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
	"Recalc - TOTAL  - S-InsLtg for DRtgLtgReduction"	Proj:RunResultsS[6]:ProposedSrc[2]			= {	RunResultsS[6]:PropElecSrc[2]    + RunResultsS[6]:PropNatGasSrc       + RunResultsS[6]:PropOtherSrc         }
	"Recalc - TOTAL  - S-InsLtg for DRtgLtgReduction"	Proj:RunResultsS[6]:ProposedSrc[3]			= {	RunResultsS[6]:ProposedSrc[2]  }

	"Adjust - Elec   - W-InsLtg for DRtgLtgReduction"	Proj:RunResultsW[6]:PropElecSrc[2]			= {	if (DRtgLtgReduction <= 0 .OR. RunResultsW[6]:PropElecSrc[2]      <= 0) then  UNCHANGED
			 			  																												else              int( (100 * (RunResultsW[6]:PropElecSrc[2]      * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
;	"Adjust - NatGas - W-InsLtg for DRtgLtgReduction"	Proj:RunResultsW[6]:PropNatGasSrc			= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropNatGasSrc[2]    <= 0) then  UNCHANGED
;			 			  																												else              int( (100 * (RunResults[6]:PropNatGasSrc[2]    * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
;	"Adjust - Other  - W-InsLtg for DRtgLtgReduction"	Proj:RunResultsW[6]:PropOtherSrc				= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropOtherSrc[2]     <= 0) then  UNCHANGED
;																																		else              int( (100 * (RunResults[6]:PropOtherSrc[2]     * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
	"Recalc - TOTAL  - W-InsLtg for DRtgLtgReduction"	Proj:RunResultsW[6]:ProposedSrc[2]			= {	RunResultsW[6]:PropElecSrc[2]    + RunResultsW[6]:PropNatGasSrc       + RunResultsW[6]:PropOtherSrc         }
	"Recalc - TOTAL  - W-InsLtg for DRtgLtgReduction"	Proj:RunResultsW[6]:ProposedSrc[3]			= {	RunResultsW[6]:ProposedSrc[2]  }

; ADJUST certain Proposed results that now are to have PVCredit applied to them
; mjb-10/16/13	subtracted PVCredit from Proposed Design Elec and TOTAL 
; SAC 4/9/15 - updated to also recalc energy use sums (to catch mods for design rating lighting credit)
; SAC 3/3/18 - shifted PV & Batt from CompTot to Tot for 2019 (done on 4/7/17 for single orientation runs) (tic #973)
	"Recalc Src   - Elec   - N-Comp Ttl"	Proj:RunResultsN[11]:PropElecSrc[2]			= {	RunResultsN[1]:PropElecSrc[2]       + RunResultsN[2]:PropElecSrc[2]      + RunResultsN[3]:PropElecSrc[2]      + RunResultsN[4]:PropElecSrc[2]      + RunResultsN[5]:PropElecSrc[2]       } ; - PVCredit[2]  }
	"Recalc Src   - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:ProposedSrc[2]			= {	RunResultsN[1]:ProposedSrc[2]       + RunResultsN[2]:ProposedSrc[2]      + RunResultsN[3]:ProposedSrc[2]      + RunResultsN[4]:ProposedSrc[2]      + RunResultsN[5]:ProposedSrc[2]       } ; - PVCredit[2]  }
	"Recalc Src   - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:ProposedSrc[3]			= {	RunResultsN[1]:ProposedSrc[3]       + RunResultsN[2]:ProposedSrc[3]      + RunResultsN[3]:ProposedSrc[3]      + RunResultsN[4]:ProposedSrc[3]      + RunResultsN[5]:ProposedSrc[3]       } ; - PVCredit[2]  }
	"Recalc Src   - Elec   - N-Total"		Proj:RunResultsN[10]:PropElecSrc[2]			= {	RunResultsN[11]:PropElecSrc[2]      + RunResultsN[6]:PropElecSrc[2]      + RunResultsN[7]:PropElecSrc[2]      + RunResultsN[8]:PropElecSrc[2]      + RunResultsN[9]:PropElecSrc[2]      + RunResultsN[13]:PropElecSrc[2]      + RunResultsN[14]:PropElecSrc[2]     }
	"Recalc Src   - TOTAL  - N-Total"		Proj:RunResultsN[10]:ProposedSrc[2]			= {	RunResultsN[11]:ProposedSrc[2]      + RunResultsN[6]:ProposedSrc[2]      + RunResultsN[7]:ProposedSrc[2]      + RunResultsN[8]:ProposedSrc[2]      + RunResultsN[9]:ProposedSrc[2]      + RunResultsN[13]:ProposedSrc[2]      + RunResultsN[14]:ProposedSrc[2]     }
	"Recalc Src   - TOTAL  - N-Total"		Proj:RunResultsN[10]:ProposedSrc[3]			= {	RunResultsN[11]:ProposedSrc[3]      + RunResultsN[6]:ProposedSrc[3]      + RunResultsN[7]:ProposedSrc[3]      + RunResultsN[8]:ProposedSrc[3]      + RunResultsN[9]:ProposedSrc[3]      + RunResultsN[13]:ProposedSrc[3]      + RunResultsN[14]:ProposedSrc[3]     }

	"Recalc Src   - Elec   - E-Comp Ttl"	Proj:RunResultsE[11]:PropElecSrc[2]			= {	RunResultsE[1]:PropElecSrc[2]       + RunResultsE[2]:PropElecSrc[2]      + RunResultsE[3]:PropElecSrc[2]      + RunResultsE[4]:PropElecSrc[2]      + RunResultsE[5]:PropElecSrc[2]       } ; - PVCredit[2]  }
	"Recalc Src   - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:ProposedSrc[2]			= {	RunResultsE[1]:ProposedSrc[2]       + RunResultsE[2]:ProposedSrc[2]      + RunResultsE[3]:ProposedSrc[2]      + RunResultsE[4]:ProposedSrc[2]      + RunResultsE[5]:ProposedSrc[2]       } ; - PVCredit[2]  }
	"Recalc Src   - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:ProposedSrc[3]			= {	RunResultsE[1]:ProposedSrc[3]       + RunResultsE[2]:ProposedSrc[3]      + RunResultsE[3]:ProposedSrc[3]      + RunResultsE[4]:ProposedSrc[3]      + RunResultsE[5]:ProposedSrc[3]       } ; - PVCredit[2]  }
	"Recalc Src   - Elec   - E-Total"		Proj:RunResultsE[10]:PropElecSrc[2]			= {	RunResultsE[11]:PropElecSrc[2]      + RunResultsE[6]:PropElecSrc[2]      + RunResultsE[7]:PropElecSrc[2]      + RunResultsE[8]:PropElecSrc[2]      + RunResultsE[9]:PropElecSrc[2]      + RunResultsE[13]:PropElecSrc[2]      + RunResultsE[14]:PropElecSrc[2]     }
	"Recalc Src   - TOTAL  - E-Total"		Proj:RunResultsE[10]:ProposedSrc[2]			= {	RunResultsE[11]:ProposedSrc[2]      + RunResultsE[6]:ProposedSrc[2]      + RunResultsE[7]:ProposedSrc[2]      + RunResultsE[8]:ProposedSrc[2]      + RunResultsE[9]:ProposedSrc[2]      + RunResultsE[13]:ProposedSrc[2]      + RunResultsE[14]:ProposedSrc[2]     }
	"Recalc Src   - TOTAL  - E-Total"		Proj:RunResultsE[10]:ProposedSrc[3]			= {	RunResultsE[11]:ProposedSrc[3]      + RunResultsE[6]:ProposedSrc[3]      + RunResultsE[7]:ProposedSrc[3]      + RunResultsE[8]:ProposedSrc[3]      + RunResultsE[9]:ProposedSrc[3]      + RunResultsE[13]:ProposedSrc[3]      + RunResultsE[14]:ProposedSrc[3]     }
                                                                                                                                                                                                                                                          
	"Recalc Src   - Elec   - S-Comp Ttl"	Proj:RunResultsS[11]:PropElecSrc[2]			= {	RunResultsS[1]:PropElecSrc[2]       + RunResultsS[2]:PropElecSrc[2]      + RunResultsS[3]:PropElecSrc[2]      + RunResultsS[4]:PropElecSrc[2]      + RunResultsS[5]:PropElecSrc[2]       } ; - PVCredit[2]  }
	"Recalc Src   - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:ProposedSrc[2]			= {	RunResultsS[1]:ProposedSrc[2]       + RunResultsS[2]:ProposedSrc[2]      + RunResultsS[3]:ProposedSrc[2]      + RunResultsS[4]:ProposedSrc[2]      + RunResultsS[5]:ProposedSrc[2]       } ; - PVCredit[2]  }
	"Recalc Src   - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:ProposedSrc[3]			= {	RunResultsS[1]:ProposedSrc[3]       + RunResultsS[2]:ProposedSrc[3]      + RunResultsS[3]:ProposedSrc[3]      + RunResultsS[4]:ProposedSrc[3]      + RunResultsS[5]:ProposedSrc[3]       } ; - PVCredit[2]  }
	"Recalc Src   - Elec   - S-Total"		Proj:RunResultsS[10]:PropElecSrc[2]			= {	RunResultsS[11]:PropElecSrc[2]      + RunResultsS[6]:PropElecSrc[2]      + RunResultsS[7]:PropElecSrc[2]      + RunResultsS[8]:PropElecSrc[2]      + RunResultsS[9]:PropElecSrc[2]      + RunResultsS[13]:PropElecSrc[2]      + RunResultsS[14]:PropElecSrc[2]     }
	"Recalc Src   - TOTAL  - S-Total"		Proj:RunResultsS[10]:ProposedSrc[2]			= {	RunResultsS[11]:ProposedSrc[2]      + RunResultsS[6]:ProposedSrc[2]      + RunResultsS[7]:ProposedSrc[2]      + RunResultsS[8]:ProposedSrc[2]      + RunResultsS[9]:ProposedSrc[2]      + RunResultsS[13]:ProposedSrc[2]      + RunResultsS[14]:ProposedSrc[2]     }
	"Recalc Src   - TOTAL  - S-Total"		Proj:RunResultsS[10]:ProposedSrc[3]			= {	RunResultsS[11]:ProposedSrc[3]      + RunResultsS[6]:ProposedSrc[3]      + RunResultsS[7]:ProposedSrc[3]      + RunResultsS[8]:ProposedSrc[3]      + RunResultsS[9]:ProposedSrc[3]      + RunResultsS[13]:ProposedSrc[3]      + RunResultsS[14]:ProposedSrc[3]     }
                                                                                                                                                                                                                                                          
	"Recalc Src   - Elec   - W-Comp Ttl"	Proj:RunResultsW[11]:PropElecSrc[2]			= {	RunResultsW[1]:PropElecSrc[2]       + RunResultsW[2]:PropElecSrc[2]      + RunResultsW[3]:PropElecSrc[2]      + RunResultsW[4]:PropElecSrc[2]      + RunResultsW[5]:PropElecSrc[2]       } ; - PVCredit[2]  }
	"Recalc Src   - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:ProposedSrc[2]			= {	RunResultsW[1]:ProposedSrc[2]       + RunResultsW[2]:ProposedSrc[2]      + RunResultsW[3]:ProposedSrc[2]      + RunResultsW[4]:ProposedSrc[2]      + RunResultsW[5]:ProposedSrc[2]       } ; - PVCredit[2]  }
	"Recalc Src   - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:ProposedSrc[3]			= {	RunResultsW[1]:ProposedSrc[3]       + RunResultsW[2]:ProposedSrc[3]      + RunResultsW[3]:ProposedSrc[3]      + RunResultsW[4]:ProposedSrc[3]      + RunResultsW[5]:ProposedSrc[3]       } ; - PVCredit[2]  }
	"Recalc Src   - Elec   - W-Total"		Proj:RunResultsW[10]:PropElecSrc[2]			= {	RunResultsW[11]:PropElecSrc[2]      + RunResultsW[6]:PropElecSrc[2]      + RunResultsW[7]:PropElecSrc[2]      + RunResultsW[8]:PropElecSrc[2]      + RunResultsW[9]:PropElecSrc[2]      + RunResultsW[13]:PropElecSrc[2]      + RunResultsW[14]:PropElecSrc[2]     }
	"Recalc Src   - TOTAL  - W-Total"		Proj:RunResultsW[10]:ProposedSrc[2]			= {	RunResultsW[11]:ProposedSrc[2]      + RunResultsW[6]:ProposedSrc[2]      + RunResultsW[7]:ProposedSrc[2]      + RunResultsW[8]:ProposedSrc[2]      + RunResultsW[9]:ProposedSrc[2]      + RunResultsW[13]:ProposedSrc[2]      + RunResultsW[14]:ProposedSrc[2]     }
	"Recalc Src   - TOTAL  - W-Total"		Proj:RunResultsW[10]:ProposedSrc[3]			= {	RunResultsW[11]:ProposedSrc[3]      + RunResultsW[6]:ProposedSrc[3]      + RunResultsW[7]:ProposedSrc[3]      + RunResultsW[8]:ProposedSrc[3]      + RunResultsW[9]:ProposedSrc[3]      + RunResultsW[13]:ProposedSrc[3]      + RunResultsW[14]:ProposedSrc[3]     }

  ; Compliance Total
  ; SAC 1/14/13 - added in PVCredit to Std (elec) Src
; mjb-10/16/13	remove PVCredit from Std Design
	"Calculate Src - Elec   - N-Comp Ttl"	Proj:RunResultsN[11]:DRtgElecSrc			= {	RunResultsN[1]:DRtgElecSrc     + RunResultsN[2]:DRtgElecSrc     + RunResultsN[3]:DRtgElecSrc     + RunResultsN[4]:DRtgElecSrc     + RunResultsN[5]:DRtgElecSrc     + RunResultsN[13]:DRtgElecSrc    + RunResultsN[14]:DRtgElecSrc     }
	"Calculate Src - NatGas - N-Comp Ttl"	Proj:RunResultsN[11]:DRtgNatGasSrc		= {	RunResultsN[1]:DRtgNatGasSrc   + RunResultsN[2]:DRtgNatGasSrc   + RunResultsN[3]:DRtgNatGasSrc   + RunResultsN[4]:DRtgNatGasSrc   + RunResultsN[5]:DRtgNatGasSrc   + RunResultsN[13]:DRtgNatGasSrc  + RunResultsN[14]:DRtgNatGasSrc   }
	"Calculate Src - Other  - N-Comp Ttl"	Proj:RunResultsN[11]:DRtgOtherSrc		= {	RunResultsN[1]:DRtgOtherSrc    + RunResultsN[2]:DRtgOtherSrc    + RunResultsN[3]:DRtgOtherSrc    + RunResultsN[4]:DRtgOtherSrc    + RunResultsN[5]:DRtgOtherSrc    + RunResultsN[13]:DRtgOtherSrc   + RunResultsN[14]:DRtgOtherSrc    }
	"Calculate Src - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:DesignRatingSrc[1] = {	RunResultsN[1]:DesignRatingSrc[1] + RunResultsN[2]:DesignRatingSrc[1] + RunResultsN[3]:DesignRatingSrc[1] + RunResultsN[4]:DesignRatingSrc[1] + RunResultsN[5]:DesignRatingSrc[1] + RunResultsN[13]:DesignRatingSrc[1] + RunResultsN[14]:DesignRatingSrc[1] }
	"Calculate Src - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:DesignRatingSrc[2] = {	RunResultsN[1]:DesignRatingSrc[2] + RunResultsN[2]:DesignRatingSrc[2] + RunResultsN[3]:DesignRatingSrc[2] + RunResultsN[4]:DesignRatingSrc[2] + RunResultsN[5]:DesignRatingSrc[2] + RunResultsN[13]:DesignRatingSrc[2] + RunResultsN[14]:DesignRatingSrc[2] }

  ; Total
	"Calculate Src - Elec   - N-Total"		Proj:RunResultsN[10]:DRtgElecSrc			= {	RunResultsN[11]:DRtgElecSrc     + RunResultsN[6]:DRtgElecSrc     + RunResultsN[7]:DRtgElecSrc     + RunResultsN[8]:DRtgElecSrc     + RunResultsN[9]:DRtgElecSrc      }
	"Calculate Src - NatGas - N-Total"		Proj:RunResultsN[10]:DRtgNatGasSrc		= {	RunResultsN[11]:DRtgNatGasSrc   + RunResultsN[6]:DRtgNatGasSrc   + RunResultsN[7]:DRtgNatGasSrc   + RunResultsN[8]:DRtgNatGasSrc   + RunResultsN[9]:DRtgNatGasSrc    }
	"Calculate Src - Other  - N-Total"		Proj:RunResultsN[10]:DRtgOtherSrc		= {	RunResultsN[11]:DRtgOtherSrc    + RunResultsN[6]:DRtgOtherSrc    + RunResultsN[7]:DRtgOtherSrc    + RunResultsN[8]:DRtgOtherSrc    + RunResultsN[9]:DRtgOtherSrc     }
	"Calculate Src - TOTAL  - N-Total"		Proj:RunResultsN[10]:DesignRatingSrc[1] = {	RunResultsN[11]:DesignRatingSrc[1] + RunResultsN[6]:DesignRatingSrc[1] + RunResultsN[7]:DesignRatingSrc[1] + RunResultsN[8]:DesignRatingSrc[1] + RunResultsN[9]:DesignRatingSrc[1]  }
	"Calculate Src - TOTAL  - N-Total"		Proj:RunResultsN[10]:DesignRatingSrc[2] = {	RunResultsN[11]:DesignRatingSrc[2] + RunResultsN[6]:DesignRatingSrc[2] + RunResultsN[7]:DesignRatingSrc[2] + RunResultsN[8]:DesignRatingSrc[2] + RunResultsN[9]:DesignRatingSrc[2]  }

; -- COPY N results to E --
  ; Space Heating (& heating fan)
	"Calculate Src - Elec   - E-SpcHt"		Proj:RunResultsE[1]:DRtgElecSrc			= {	RunResultsN[1]:DRtgElecSrc        }
	"Calculate Src - NatGas - E-SpcHt"		Proj:RunResultsE[1]:DRtgNatGasSrc		= {	RunResultsN[1]:DRtgNatGasSrc      }
	"Calculate Src - Other  - E-SpcHt"		Proj:RunResultsE[1]:DRtgOtherSrc			= {	RunResultsN[1]:DRtgOtherSrc       }
	"Calculate Src - TOTAL  - E-SpcHt"		Proj:RunResultsE[1]:DesignRatingSrc[1]	= {	RunResultsN[1]:DesignRatingSrc[1]    }
	"Calculate Src - TOTAL  - E-SpcHt"		Proj:RunResultsE[1]:DesignRatingSrc[2]	= {	RunResultsN[1]:DesignRatingSrc[2]    }
  ; Space Cooling (& cooling fan)                                                                                     
	"Calculate Src - Elec   - E-SpcCl"		Proj:RunResultsE[2]:DRtgElecSrc			= {	RunResultsN[2]:DRtgElecSrc        }
	"Calculate Src - NatGas - E-SpcCl"		Proj:RunResultsE[2]:DRtgNatGasSrc		= {	RunResultsN[2]:DRtgNatGasSrc      }
	"Calculate Src - Other  - E-SpcCl"		Proj:RunResultsE[2]:DRtgOtherSrc			= {	RunResultsN[2]:DRtgOtherSrc       }
	"Calculate Src - TOTAL  - E-SpcCl"		Proj:RunResultsE[2]:DesignRatingSrc[1]	= {	RunResultsN[2]:DesignRatingSrc[1]    }
	"Calculate Src - TOTAL  - E-SpcCl"		Proj:RunResultsE[2]:DesignRatingSrc[2]	= {	RunResultsN[2]:DesignRatingSrc[2]    }
  ; IAQ Ventilation Fans                                                                                              
	"Calculate Src - Elec   - E-IAQVent"	Proj:RunResultsE[3]:DRtgElecSrc			= {	RunResultsN[3]:DRtgElecSrc        }
	"Calculate Src - NatGas - E-IAQVent"	Proj:RunResultsE[3]:DRtgNatGasSrc		= {	RunResultsN[3]:DRtgNatGasSrc      }
	"Calculate Src - Other  - E-IAQVent"	Proj:RunResultsE[3]:DRtgOtherSrc			= {	RunResultsN[3]:DRtgOtherSrc       }
	"Calculate Src - TOTAL  - E-IAQVent"	Proj:RunResultsE[3]:DesignRatingSrc[1]	= {	RunResultsN[3]:DesignRatingSrc[1]    }
	"Calculate Src - TOTAL  - E-IAQVent"	Proj:RunResultsE[3]:DesignRatingSrc[2]	= {	RunResultsN[3]:DesignRatingSrc[2]    }
  ; Other HVAC (aux & misc fans)                                                                                      
	"Calculate Src - Elec   - E-OthrHVAC"	Proj:RunResultsE[4]:DRtgElecSrc			= {	RunResultsN[4]:DRtgElecSrc        }
	"Calculate Src - NatGas - E-OthrHVAC"	Proj:RunResultsE[4]:DRtgNatGasSrc		= {	RunResultsN[4]:DRtgNatGasSrc      }
	"Calculate Src - Other  - E-OthrHVAC"	Proj:RunResultsE[4]:DRtgOtherSrc			= {	RunResultsN[4]:DRtgOtherSrc       }
	"Calculate Src - TOTAL  - E-OthrHVAC"	Proj:RunResultsE[4]:DesignRatingSrc[1]	= {	RunResultsN[4]:DesignRatingSrc[1]    }
	"Calculate Src - TOTAL  - E-OthrHVAC"	Proj:RunResultsE[4]:DesignRatingSrc[2]	= {	RunResultsN[4]:DesignRatingSrc[2]    }
  ; Water Heating                                                                                                     
	"Calculate Src - Elec   - E-WtrHt"		Proj:RunResultsE[5]:DRtgElecSrc			= {	RunResultsN[5]:DRtgElecSrc        }
	"Calculate Src - NatGas - E-WtrHt"		Proj:RunResultsE[5]:DRtgNatGasSrc		= {	RunResultsN[5]:DRtgNatGasSrc      }
	"Calculate Src - Other  - E-WtrHt"		Proj:RunResultsE[5]:DRtgOtherSrc			= {	RunResultsN[5]:DRtgOtherSrc       }
	"Calculate Src - TOTAL  - E-WtrHt"		Proj:RunResultsE[5]:DesignRatingSrc[1]	= {	RunResultsN[5]:DesignRatingSrc[1]    }
	"Calculate Src - TOTAL  - E-WtrHt"		Proj:RunResultsE[5]:DesignRatingSrc[2]	= {	RunResultsN[5]:DesignRatingSrc[2]    }
  ; Inside Lighting                                                                                                   
	"Calculate Src - Elec   - E-InsLtg"		Proj:RunResultsE[6]:DRtgElecSrc			= {	RunResultsN[6]:DRtgElecSrc        }
	"Calculate Src - NatGas - E-InsLtg"		Proj:RunResultsE[6]:DRtgNatGasSrc		= {	RunResultsN[6]:DRtgNatGasSrc      }
	"Calculate Src - Other  - E-InsLtg"		Proj:RunResultsE[6]:DRtgOtherSrc			= {	RunResultsN[6]:DRtgOtherSrc       }
	"Calculate Src - TOTAL  - E-InsLtg"		Proj:RunResultsE[6]:DesignRatingSrc[1]	= {	RunResultsN[6]:DesignRatingSrc[1]    }
	"Calculate Src - TOTAL  - E-InsLtg"		Proj:RunResultsE[6]:DesignRatingSrc[2]	= {	RunResultsN[6]:DesignRatingSrc[2]    }
  ; Appliances & Cooking                                                                                              
	"Calculate Src - Elec   - E-AppCkg"		Proj:RunResultsE[7]:DRtgElecSrc			= {	RunResultsN[7]:DRtgElecSrc        }
	"Calculate Src - NatGas - E-AppCkg"		Proj:RunResultsE[7]:DRtgNatGasSrc		= {	RunResultsN[7]:DRtgNatGasSrc      }
	"Calculate Src - Other  - E-AppCkg"		Proj:RunResultsE[7]:DRtgOtherSrc			= {	RunResultsN[7]:DRtgOtherSrc       }
	"Calculate Src - TOTAL  - E-AppCkg"		Proj:RunResultsE[7]:DesignRatingSrc[1]	= {	RunResultsN[7]:DesignRatingSrc[1]    }
	"Calculate Src - TOTAL  - E-AppCkg"		Proj:RunResultsE[7]:DesignRatingSrc[2]	= {	RunResultsN[7]:DesignRatingSrc[2]    }
  ; Plug Loads                                                                                                        
	"Calculate Src - Elec   - E-Plugs"		Proj:RunResultsE[8]:DRtgElecSrc			= {	RunResultsN[8]:DRtgElecSrc        }
	"Calculate Src - NatGas - E-Plugs"		Proj:RunResultsE[8]:DRtgNatGasSrc		= {	RunResultsN[8]:DRtgNatGasSrc      }
	"Calculate Src - Other  - E-Plugs"		Proj:RunResultsE[8]:DRtgOtherSrc			= {	RunResultsN[8]:DRtgOtherSrc       }
	"Calculate Src - TOTAL  - E-Plugs"		Proj:RunResultsE[8]:DesignRatingSrc[1]	= {	RunResultsN[8]:DesignRatingSrc[1]    }
	"Calculate Src - TOTAL  - E-Plugs"		Proj:RunResultsE[8]:DesignRatingSrc[2]	= {	RunResultsN[8]:DesignRatingSrc[2]    }
  ; Exterior                                                                                                          
	"Calculate Src - Elec   - E-Ext"			Proj:RunResultsE[9]:DRtgElecSrc			= {	RunResultsN[9]:DRtgElecSrc        }
	"Calculate Src - NatGas - E-Ext"			Proj:RunResultsE[9]:DRtgNatGasSrc		= {	RunResultsN[9]:DRtgNatGasSrc      }
	"Calculate Src - Other  - E-Ext"			Proj:RunResultsE[9]:DRtgOtherSrc			= {	RunResultsN[9]:DRtgOtherSrc       }
	"Calculate Src - TOTAL  - E-Ext"			Proj:RunResultsE[9]:DesignRatingSrc[1]	= {	RunResultsN[9]:DesignRatingSrc[1]    }
	"Calculate Src - TOTAL  - E-Ext"			Proj:RunResultsE[9]:DesignRatingSrc[2]	= {	RunResultsN[9]:DesignRatingSrc[2]    }
  ; PV
	"Calculate Src - Elec   - E-PV"			Proj:RunResultsE[13]:DRtgElecSrc			= {	RunResultsN[13]:DRtgElecSrc       }
	"Calculate Src - NatGas - E-PV"			Proj:RunResultsE[13]:DRtgNatGasSrc		= {	RunResultsN[13]:DRtgNatGasSrc     }
	"Calculate Src - Other  - E-PV"			Proj:RunResultsE[13]:DRtgOtherSrc		= {	RunResultsN[13]:DRtgOtherSrc      }
	"Calculate Src - TOTAL  - E-PV"			Proj:RunResultsE[13]:DesignRatingSrc[1] = {	RunResultsN[13]:DesignRatingSrc[1]   }
	"Calculate Src - TOTAL  - E-PV"			Proj:RunResultsE[13]:DesignRatingSrc[2] = {	RunResultsN[13]:DesignRatingSrc[2]   }
  ; Battery
	"Calculate Src - Elec   - E-Battery"	Proj:RunResultsE[14]:DRtgElecSrc			= {	RunResultsN[14]:DRtgElecSrc       }
	"Calculate Src - NatGas - E-Battery"	Proj:RunResultsE[14]:DRtgNatGasSrc		= {	RunResultsN[14]:DRtgNatGasSrc     }
	"Calculate Src - Other  - E-Battery"	Proj:RunResultsE[14]:DRtgOtherSrc		= {	RunResultsN[14]:DRtgOtherSrc      }
	"Calculate Src - TOTAL  - E-Battery"	Proj:RunResultsE[14]:DesignRatingSrc[1] = {	RunResultsN[14]:DesignRatingSrc[1]   }
	"Calculate Src - TOTAL  - E-Battery"	Proj:RunResultsE[14]:DesignRatingSrc[2] = {	RunResultsN[14]:DesignRatingSrc[2]   }
  ; Compliance Total                                                                                                  
	"Calculate Src - Elec   - E-Comp Ttl"	Proj:RunResultsE[11]:DRtgElecSrc			= {	RunResultsN[11]:DRtgElecSrc       }
	"Calculate Src - NatGas - E-Comp Ttl"	Proj:RunResultsE[11]:DRtgNatGasSrc		= {	RunResultsN[11]:DRtgNatGasSrc     }
	"Calculate Src - Other  - E-Comp Ttl"	Proj:RunResultsE[11]:DRtgOtherSrc		= {	RunResultsN[11]:DRtgOtherSrc      }
	"Calculate Src - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:DesignRatingSrc[1] = {	RunResultsN[11]:DesignRatingSrc[1]   }
	"Calculate Src - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:DesignRatingSrc[2] = {	RunResultsN[11]:DesignRatingSrc[2]   }
  ; Total                                                                                                             
	"Calculate Src - Elec   - E-Total"		Proj:RunResultsE[10]:DRtgElecSrc			= {	RunResultsN[10]:DRtgElecSrc       }
	"Calculate Src - NatGas - E-Total"		Proj:RunResultsE[10]:DRtgNatGasSrc		= {	RunResultsN[10]:DRtgNatGasSrc     }
	"Calculate Src - Other  - E-Total"		Proj:RunResultsE[10]:DRtgOtherSrc		= {	RunResultsN[10]:DRtgOtherSrc      }
	"Calculate Src - TOTAL  - E-Total"		Proj:RunResultsE[10]:DesignRatingSrc[1] = {	RunResultsN[10]:DesignRatingSrc[1]   }
	"Calculate Src - TOTAL  - E-Total"		Proj:RunResultsE[10]:DesignRatingSrc[2] = {	RunResultsN[10]:DesignRatingSrc[2]   }

; -- COPY N results to S --
  ; Space Heating (& heating fan)
	"Calculate Src - Elec   - S-SpcHt"		Proj:RunResultsS[1]:DRtgElecSrc			= {	RunResultsN[1]:DRtgElecSrc        }
	"Calculate Src - NatGas - S-SpcHt"		Proj:RunResultsS[1]:DRtgNatGasSrc		= {	RunResultsN[1]:DRtgNatGasSrc      }
	"Calculate Src - Other  - S-SpcHt"		Proj:RunResultsS[1]:DRtgOtherSrc			= {	RunResultsN[1]:DRtgOtherSrc       }
	"Calculate Src - TOTAL  - S-SpcHt"		Proj:RunResultsS[1]:DesignRatingSrc[1]	= {	RunResultsN[1]:DesignRatingSrc[1]    }
	"Calculate Src - TOTAL  - S-SpcHt"		Proj:RunResultsS[1]:DesignRatingSrc[2]	= {	RunResultsN[1]:DesignRatingSrc[2]    }
  ; Space Cooling (& cooling fan)                                                                                     
	"Calculate Src - Elec   - S-SpcCl"		Proj:RunResultsS[2]:DRtgElecSrc			= {	RunResultsN[2]:DRtgElecSrc        }
	"Calculate Src - NatGas - S-SpcCl"		Proj:RunResultsS[2]:DRtgNatGasSrc		= {	RunResultsN[2]:DRtgNatGasSrc      }
	"Calculate Src - Other  - S-SpcCl"		Proj:RunResultsS[2]:DRtgOtherSrc			= {	RunResultsN[2]:DRtgOtherSrc       }
	"Calculate Src - TOTAL  - S-SpcCl"		Proj:RunResultsS[2]:DesignRatingSrc[1]	= {	RunResultsN[2]:DesignRatingSrc[1]    }
	"Calculate Src - TOTAL  - S-SpcCl"		Proj:RunResultsS[2]:DesignRatingSrc[2]	= {	RunResultsN[2]:DesignRatingSrc[2]    }
  ; IAQ Ventilation Fans                                                                                              
	"Calculate Src - Elec   - S-IAQVent"	Proj:RunResultsS[3]:DRtgElecSrc			= {	RunResultsN[3]:DRtgElecSrc        }
	"Calculate Src - NatGas - S-IAQVent"	Proj:RunResultsS[3]:DRtgNatGasSrc		= {	RunResultsN[3]:DRtgNatGasSrc      }
	"Calculate Src - Other  - S-IAQVent"	Proj:RunResultsS[3]:DRtgOtherSrc			= {	RunResultsN[3]:DRtgOtherSrc       }
	"Calculate Src - TOTAL  - S-IAQVent"	Proj:RunResultsS[3]:DesignRatingSrc[1]	= {	RunResultsN[3]:DesignRatingSrc[1]    }
	"Calculate Src - TOTAL  - S-IAQVent"	Proj:RunResultsS[3]:DesignRatingSrc[2]	= {	RunResultsN[3]:DesignRatingSrc[2]    }
  ; Other HVAC (aux & misc fans)                                                                                      
	"Calculate Src - Elec   - S-OthrHVAC"	Proj:RunResultsS[4]:DRtgElecSrc			= {	RunResultsN[4]:DRtgElecSrc        }
	"Calculate Src - NatGas - S-OthrHVAC"	Proj:RunResultsS[4]:DRtgNatGasSrc		= {	RunResultsN[4]:DRtgNatGasSrc      }
	"Calculate Src - Other  - S-OthrHVAC"	Proj:RunResultsS[4]:DRtgOtherSrc			= {	RunResultsN[4]:DRtgOtherSrc       }
	"Calculate Src - TOTAL  - S-OthrHVAC"	Proj:RunResultsS[4]:DesignRatingSrc[1]	= {	RunResultsN[4]:DesignRatingSrc[1]    }
	"Calculate Src - TOTAL  - S-OthrHVAC"	Proj:RunResultsS[4]:DesignRatingSrc[2]	= {	RunResultsN[4]:DesignRatingSrc[2]    }
  ; Water Heating                                                                                                     
	"Calculate Src - Elec   - S-WtrHt"		Proj:RunResultsS[5]:DRtgElecSrc			= {	RunResultsN[5]:DRtgElecSrc        }
	"Calculate Src - NatGas - S-WtrHt"		Proj:RunResultsS[5]:DRtgNatGasSrc		= {	RunResultsN[5]:DRtgNatGasSrc      }
	"Calculate Src - Other  - S-WtrHt"		Proj:RunResultsS[5]:DRtgOtherSrc			= {	RunResultsN[5]:DRtgOtherSrc       }
	"Calculate Src - TOTAL  - S-WtrHt"		Proj:RunResultsS[5]:DesignRatingSrc[1]	= {	RunResultsN[5]:DesignRatingSrc[1]    }
	"Calculate Src - TOTAL  - S-WtrHt"		Proj:RunResultsS[5]:DesignRatingSrc[2]	= {	RunResultsN[5]:DesignRatingSrc[2]    }
  ; Inside Lighting                                                                                                   
	"Calculate Src - Elec   - S-InsLtg"		Proj:RunResultsS[6]:DRtgElecSrc			= {	RunResultsN[6]:DRtgElecSrc        }
	"Calculate Src - NatGas - S-InsLtg"		Proj:RunResultsS[6]:DRtgNatGasSrc		= {	RunResultsN[6]:DRtgNatGasSrc      }
	"Calculate Src - Other  - S-InsLtg"		Proj:RunResultsS[6]:DRtgOtherSrc			= {	RunResultsN[6]:DRtgOtherSrc       }
	"Calculate Src - TOTAL  - S-InsLtg"		Proj:RunResultsS[6]:DesignRatingSrc[1]	= {	RunResultsN[6]:DesignRatingSrc[1]    }
	"Calculate Src - TOTAL  - S-InsLtg"		Proj:RunResultsS[6]:DesignRatingSrc[2]	= {	RunResultsN[6]:DesignRatingSrc[2]    }
  ; Appliances & Cooking                                                                                              
	"Calculate Src - Elec   - S-AppCkg"		Proj:RunResultsS[7]:DRtgElecSrc			= {	RunResultsN[7]:DRtgElecSrc        }
	"Calculate Src - NatGas - S-AppCkg"		Proj:RunResultsS[7]:DRtgNatGasSrc		= {	RunResultsN[7]:DRtgNatGasSrc      }
	"Calculate Src - Other  - S-AppCkg"		Proj:RunResultsS[7]:DRtgOtherSrc			= {	RunResultsN[7]:DRtgOtherSrc       }
	"Calculate Src - TOTAL  - S-AppCkg"		Proj:RunResultsS[7]:DesignRatingSrc[1]	= {	RunResultsN[7]:DesignRatingSrc[1]    }
	"Calculate Src - TOTAL  - S-AppCkg"		Proj:RunResultsS[7]:DesignRatingSrc[2]	= {	RunResultsN[7]:DesignRatingSrc[2]    }
  ; Plug Loads                                                                                                        
	"Calculate Src - Elec   - S-Plugs"		Proj:RunResultsS[8]:DRtgElecSrc			= {	RunResultsN[8]:DRtgElecSrc        }
	"Calculate Src - NatGas - S-Plugs"		Proj:RunResultsS[8]:DRtgNatGasSrc		= {	RunResultsN[8]:DRtgNatGasSrc      }
	"Calculate Src - Other  - S-Plugs"		Proj:RunResultsS[8]:DRtgOtherSrc			= {	RunResultsN[8]:DRtgOtherSrc       }
	"Calculate Src - TOTAL  - S-Plugs"		Proj:RunResultsS[8]:DesignRatingSrc[1]	= {	RunResultsN[8]:DesignRatingSrc[1]    }
	"Calculate Src - TOTAL  - S-Plugs"		Proj:RunResultsS[8]:DesignRatingSrc[2]	= {	RunResultsN[8]:DesignRatingSrc[2]    }
  ; Exterior                                                                                                          
	"Calculate Src - Elec   - S-Ext"			Proj:RunResultsS[9]:DRtgElecSrc			= {	RunResultsN[9]:DRtgElecSrc        }
	"Calculate Src - NatGas - S-Ext"			Proj:RunResultsS[9]:DRtgNatGasSrc		= {	RunResultsN[9]:DRtgNatGasSrc      }
	"Calculate Src - Other  - S-Ext"			Proj:RunResultsS[9]:DRtgOtherSrc			= {	RunResultsN[9]:DRtgOtherSrc       }
	"Calculate Src - TOTAL  - S-Ext"			Proj:RunResultsS[9]:DesignRatingSrc[1]	= {	RunResultsN[9]:DesignRatingSrc[1]    }
	"Calculate Src - TOTAL  - S-Ext"			Proj:RunResultsS[9]:DesignRatingSrc[2]	= {	RunResultsN[9]:DesignRatingSrc[2]    }
  ; PV
	"Calculate Src - Elec   - S-PV"			Proj:RunResultsS[13]:DRtgElecSrc			= {	RunResultsN[13]:DRtgElecSrc       }
	"Calculate Src - NatGas - S-PV"			Proj:RunResultsS[13]:DRtgNatGasSrc		= {	RunResultsN[13]:DRtgNatGasSrc     }
	"Calculate Src - Other  - S-PV"			Proj:RunResultsS[13]:DRtgOtherSrc		= {	RunResultsN[13]:DRtgOtherSrc      }
	"Calculate Src - TOTAL  - S-PV"			Proj:RunResultsS[13]:DesignRatingSrc[1] = {	RunResultsN[13]:DesignRatingSrc[1]   }
	"Calculate Src - TOTAL  - S-PV"			Proj:RunResultsS[13]:DesignRatingSrc[2] = {	RunResultsN[13]:DesignRatingSrc[2]   }
  ; Battery
	"Calculate Src - Elec   - S-Battery"	Proj:RunResultsS[14]:DRtgElecSrc			= {	RunResultsN[14]:DRtgElecSrc       }
	"Calculate Src - NatGas - S-Battery"	Proj:RunResultsS[14]:DRtgNatGasSrc		= {	RunResultsN[14]:DRtgNatGasSrc     }
	"Calculate Src - Other  - S-Battery"	Proj:RunResultsS[14]:DRtgOtherSrc		= {	RunResultsN[14]:DRtgOtherSrc      }
	"Calculate Src - TOTAL  - S-Battery"	Proj:RunResultsS[14]:DesignRatingSrc[1] = {	RunResultsN[14]:DesignRatingSrc[1]   }
	"Calculate Src - TOTAL  - S-Battery"	Proj:RunResultsS[14]:DesignRatingSrc[2] = {	RunResultsN[14]:DesignRatingSrc[2]   }
  ; Compliance Total                                                                                                  
	"Calculate Src - Elec   - S-Comp Ttl"	Proj:RunResultsS[11]:DRtgElecSrc			= {	RunResultsN[11]:DRtgElecSrc       }
	"Calculate Src - NatGas - S-Comp Ttl"	Proj:RunResultsS[11]:DRtgNatGasSrc		= {	RunResultsN[11]:DRtgNatGasSrc     }
	"Calculate Src - Other  - S-Comp Ttl"	Proj:RunResultsS[11]:DRtgOtherSrc		= {	RunResultsN[11]:DRtgOtherSrc      }
	"Calculate Src - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:DesignRatingSrc[1] = {	RunResultsN[11]:DesignRatingSrc[1]   }
	"Calculate Src - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:DesignRatingSrc[2] = {	RunResultsN[11]:DesignRatingSrc[2]   }
  ; Total                                                                                                             
	"Calculate Src - Elec   - S-Total"		Proj:RunResultsS[10]:DRtgElecSrc			= {	RunResultsN[10]:DRtgElecSrc       }
	"Calculate Src - NatGas - S-Total"		Proj:RunResultsS[10]:DRtgNatGasSrc		= {	RunResultsN[10]:DRtgNatGasSrc     }
	"Calculate Src - Other  - S-Total"		Proj:RunResultsS[10]:DRtgOtherSrc		= {	RunResultsN[10]:DRtgOtherSrc      }
	"Calculate Src - TOTAL  - S-Total"		Proj:RunResultsS[10]:DesignRatingSrc[1] = {	RunResultsN[10]:DesignRatingSrc[1]   }
	"Calculate Src - TOTAL  - S-Total"		Proj:RunResultsS[10]:DesignRatingSrc[2] = {	RunResultsN[10]:DesignRatingSrc[2]   }

; -- COPY N results to W --
  ; Space Heating (& heating fan)
	"Calculate Src - Elec   - W-SpcHt"		Proj:RunResultsW[1]:DRtgElecSrc			= {	RunResultsN[1]:DRtgElecSrc        }
	"Calculate Src - NatGas - W-SpcHt"		Proj:RunResultsW[1]:DRtgNatGasSrc		= {	RunResultsN[1]:DRtgNatGasSrc      }
	"Calculate Src - Other  - W-SpcHt"		Proj:RunResultsW[1]:DRtgOtherSrc			= {	RunResultsN[1]:DRtgOtherSrc       }
	"Calculate Src - TOTAL  - W-SpcHt"		Proj:RunResultsW[1]:DesignRatingSrc[1]	= {	RunResultsN[1]:DesignRatingSrc[1]    }
	"Calculate Src - TOTAL  - W-SpcHt"		Proj:RunResultsW[1]:DesignRatingSrc[2]	= {	RunResultsN[1]:DesignRatingSrc[2]    }
  ; Space Cooling (& cooling fan)                                                                                     
	"Calculate Src - Elec   - W-SpcCl"		Proj:RunResultsW[2]:DRtgElecSrc			= {	RunResultsN[2]:DRtgElecSrc        }
	"Calculate Src - NatGas - W-SpcCl"		Proj:RunResultsW[2]:DRtgNatGasSrc		= {	RunResultsN[2]:DRtgNatGasSrc      }
	"Calculate Src - Other  - W-SpcCl"		Proj:RunResultsW[2]:DRtgOtherSrc			= {	RunResultsN[2]:DRtgOtherSrc       }
	"Calculate Src - TOTAL  - W-SpcCl"		Proj:RunResultsW[2]:DesignRatingSrc[1]	= {	RunResultsN[2]:DesignRatingSrc[1]    }
	"Calculate Src - TOTAL  - W-SpcCl"		Proj:RunResultsW[2]:DesignRatingSrc[2]	= {	RunResultsN[2]:DesignRatingSrc[2]    }
  ; IAQ Ventilation Fans                                                                                              
	"Calculate Src - Elec   - W-IAQVent"	Proj:RunResultsW[3]:DRtgElecSrc			= {	RunResultsN[3]:DRtgElecSrc        }
	"Calculate Src - NatGas - W-IAQVent"	Proj:RunResultsW[3]:DRtgNatGasSrc		= {	RunResultsN[3]:DRtgNatGasSrc      }
	"Calculate Src - Other  - W-IAQVent"	Proj:RunResultsW[3]:DRtgOtherSrc			= {	RunResultsN[3]:DRtgOtherSrc       }
	"Calculate Src - TOTAL  - W-IAQVent"	Proj:RunResultsW[3]:DesignRatingSrc[1]	= {	RunResultsN[3]:DesignRatingSrc[1]    }
	"Calculate Src - TOTAL  - W-IAQVent"	Proj:RunResultsW[3]:DesignRatingSrc[2]	= {	RunResultsN[3]:DesignRatingSrc[2]    }
  ; Other HVAC (aux & misc fans)                                                                                      
	"Calculate Src - Elec   - W-OthrHVAC"	Proj:RunResultsW[4]:DRtgElecSrc			= {	RunResultsN[4]:DRtgElecSrc        }
	"Calculate Src - NatGas - W-OthrHVAC"	Proj:RunResultsW[4]:DRtgNatGasSrc		= {	RunResultsN[4]:DRtgNatGasSrc      }
	"Calculate Src - Other  - W-OthrHVAC"	Proj:RunResultsW[4]:DRtgOtherSrc			= {	RunResultsN[4]:DRtgOtherSrc       }
	"Calculate Src - TOTAL  - W-OthrHVAC"	Proj:RunResultsW[4]:DesignRatingSrc[1]	= {	RunResultsN[4]:DesignRatingSrc[1]    }
	"Calculate Src - TOTAL  - W-OthrHVAC"	Proj:RunResultsW[4]:DesignRatingSrc[2]	= {	RunResultsN[4]:DesignRatingSrc[2]    }
  ; Water Heating                                                                                                     
	"Calculate Src - Elec   - W-WtrHt"		Proj:RunResultsW[5]:DRtgElecSrc			= {	RunResultsN[5]:DRtgElecSrc        }
	"Calculate Src - NatGas - W-WtrHt"		Proj:RunResultsW[5]:DRtgNatGasSrc		= {	RunResultsN[5]:DRtgNatGasSrc      }
	"Calculate Src - Other  - W-WtrHt"		Proj:RunResultsW[5]:DRtgOtherSrc			= {	RunResultsN[5]:DRtgOtherSrc       }
	"Calculate Src - TOTAL  - W-WtrHt"		Proj:RunResultsW[5]:DesignRatingSrc[1]	= {	RunResultsN[5]:DesignRatingSrc[1]    }
	"Calculate Src - TOTAL  - W-WtrHt"		Proj:RunResultsW[5]:DesignRatingSrc[2]	= {	RunResultsN[5]:DesignRatingSrc[2]    }
  ; Inside Lighting                                                                                                   
	"Calculate Src - Elec   - W-InsLtg"		Proj:RunResultsW[6]:DRtgElecSrc			= {	RunResultsN[6]:DRtgElecSrc        }
	"Calculate Src - NatGas - W-InsLtg"		Proj:RunResultsW[6]:DRtgNatGasSrc		= {	RunResultsN[6]:DRtgNatGasSrc      }
	"Calculate Src - Other  - W-InsLtg"		Proj:RunResultsW[6]:DRtgOtherSrc			= {	RunResultsN[6]:DRtgOtherSrc       }
	"Calculate Src - TOTAL  - W-InsLtg"		Proj:RunResultsW[6]:DesignRatingSrc[1]	= {	RunResultsN[6]:DesignRatingSrc[1]    }
	"Calculate Src - TOTAL  - W-InsLtg"		Proj:RunResultsW[6]:DesignRatingSrc[2]	= {	RunResultsN[6]:DesignRatingSrc[2]    }
  ; Appliances & Cooking                                                                                              
	"Calculate Src - Elec   - W-AppCkg"		Proj:RunResultsW[7]:DRtgElecSrc			= {	RunResultsN[7]:DRtgElecSrc        }
	"Calculate Src - NatGas - W-AppCkg"		Proj:RunResultsW[7]:DRtgNatGasSrc		= {	RunResultsN[7]:DRtgNatGasSrc      }
	"Calculate Src - Other  - W-AppCkg"		Proj:RunResultsW[7]:DRtgOtherSrc			= {	RunResultsN[7]:DRtgOtherSrc       }
	"Calculate Src - TOTAL  - W-AppCkg"		Proj:RunResultsW[7]:DesignRatingSrc[1]	= {	RunResultsN[7]:DesignRatingSrc[1]    }
	"Calculate Src - TOTAL  - W-AppCkg"		Proj:RunResultsW[7]:DesignRatingSrc[2]	= {	RunResultsN[7]:DesignRatingSrc[2]    }
  ; Plug Loads                                                                                                        
	"Calculate Src - Elec   - W-Plugs"		Proj:RunResultsW[8]:DRtgElecSrc			= {	RunResultsN[8]:DRtgElecSrc        }
	"Calculate Src - NatGas - W-Plugs"		Proj:RunResultsW[8]:DRtgNatGasSrc		= {	RunResultsN[8]:DRtgNatGasSrc      }
	"Calculate Src - Other  - W-Plugs"		Proj:RunResultsW[8]:DRtgOtherSrc			= {	RunResultsN[8]:DRtgOtherSrc       }
	"Calculate Src - TOTAL  - W-Plugs"		Proj:RunResultsW[8]:DesignRatingSrc[1]	= {	RunResultsN[8]:DesignRatingSrc[1]    }
	"Calculate Src - TOTAL  - W-Plugs"		Proj:RunResultsW[8]:DesignRatingSrc[2]	= {	RunResultsN[8]:DesignRatingSrc[2]    }
  ; Exterior                                                                                                          
	"Calculate Src - Elec   - W-Ext"			Proj:RunResultsW[9]:DRtgElecSrc			= {	RunResultsN[9]:DRtgElecSrc        }
	"Calculate Src - NatGas - W-Ext"			Proj:RunResultsW[9]:DRtgNatGasSrc		= {	RunResultsN[9]:DRtgNatGasSrc      }
	"Calculate Src - Other  - W-Ext"			Proj:RunResultsW[9]:DRtgOtherSrc			= {	RunResultsN[9]:DRtgOtherSrc       }
	"Calculate Src - TOTAL  - W-Ext"			Proj:RunResultsW[9]:DesignRatingSrc[1]	= {	RunResultsN[9]:DesignRatingSrc[1]    }
	"Calculate Src - TOTAL  - W-Ext"			Proj:RunResultsW[9]:DesignRatingSrc[2]	= {	RunResultsN[9]:DesignRatingSrc[2]    }
  ; PV
	"Calculate Src - Elec   - W-PV"			Proj:RunResultsW[13]:DRtgElecSrc			= {	RunResultsN[13]:DRtgElecSrc       }
	"Calculate Src - NatGas - W-PV"			Proj:RunResultsW[13]:DRtgNatGasSrc		= {	RunResultsN[13]:DRtgNatGasSrc     }
	"Calculate Src - Other  - W-PV"			Proj:RunResultsW[13]:DRtgOtherSrc		= {	RunResultsN[13]:DRtgOtherSrc      }
	"Calculate Src - TOTAL  - W-PV"			Proj:RunResultsW[13]:DesignRatingSrc[1] = {	RunResultsN[13]:DesignRatingSrc[1]   }
	"Calculate Src - TOTAL  - W-PV"			Proj:RunResultsW[13]:DesignRatingSrc[2] = {	RunResultsN[13]:DesignRatingSrc[2]   }
  ; Battery
	"Calculate Src - Elec   - W-Battery"	Proj:RunResultsW[14]:DRtgElecSrc			= {	RunResultsN[14]:DRtgElecSrc       }
	"Calculate Src - NatGas - W-Battery"	Proj:RunResultsW[14]:DRtgNatGasSrc		= {	RunResultsN[14]:DRtgNatGasSrc     }
	"Calculate Src - Other  - W-Battery"	Proj:RunResultsW[14]:DRtgOtherSrc		= {	RunResultsN[14]:DRtgOtherSrc      }
	"Calculate Src - TOTAL  - W-Battery"	Proj:RunResultsW[14]:DesignRatingSrc[1] = {	RunResultsN[14]:DesignRatingSrc[1]   }
	"Calculate Src - TOTAL  - W-Battery"	Proj:RunResultsW[14]:DesignRatingSrc[2] = {	RunResultsN[14]:DesignRatingSrc[2]   }
  ; Compliance Total                                                                                                  
	"Calculate Src - Elec   - W-Comp Ttl"	Proj:RunResultsW[11]:DRtgElecSrc			= {	RunResultsN[11]:DRtgElecSrc       }
	"Calculate Src - NatGas - W-Comp Ttl"	Proj:RunResultsW[11]:DRtgNatGasSrc		= {	RunResultsN[11]:DRtgNatGasSrc     }
	"Calculate Src - Other  - W-Comp Ttl"	Proj:RunResultsW[11]:DRtgOtherSrc		= {	RunResultsN[11]:DRtgOtherSrc      }
	"Calculate Src - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:DesignRatingSrc[1] = {	RunResultsN[11]:DesignRatingSrc[1]   }
	"Calculate Src - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:DesignRatingSrc[2] = {	RunResultsN[11]:DesignRatingSrc[2]   }
  ; Total                                                                                                             
	"Calculate Src - Elec   - W-Total"		Proj:RunResultsW[10]:DRtgElecSrc			= {	RunResultsN[10]:DRtgElecSrc       }
	"Calculate Src - NatGas - W-Total"		Proj:RunResultsW[10]:DRtgNatGasSrc		= {	RunResultsN[10]:DRtgNatGasSrc     }
	"Calculate Src - Other  - W-Total"		Proj:RunResultsW[10]:DRtgOtherSrc		= {	RunResultsN[10]:DRtgOtherSrc      }
	"Calculate Src - TOTAL  - W-Total"		Proj:RunResultsW[10]:DesignRatingSrc[1] = {	RunResultsN[10]:DesignRatingSrc[1]   }
	"Calculate Src - TOTAL  - W-Total"		Proj:RunResultsW[10]:DesignRatingSrc[2] = {	RunResultsN[10]:DesignRatingSrc[2]   }


  ; Percent Improvement - NORTH
   ; SAC 10/2/17 - switched from reporting delta with DRtgSrc w/o fuel adjustment mult applied to DRtgSrc W/ fuel adjustment mult applied
	"Calc Src Pct Improve - N-SpcHt"    	Proj:RunResultsN[1]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsN[1]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsN[1]:DesignRatingSrc[2]  ) - LocalRef( RunResultsN[1]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsN[1]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - N-SpcCl"    	Proj:RunResultsN[2]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsN[2]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsN[2]:DesignRatingSrc[2]  ) - LocalRef( RunResultsN[2]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsN[2]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - N-IAQVent"  	Proj:RunResultsN[3]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsN[3]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsN[3]:DesignRatingSrc[2]  ) - LocalRef( RunResultsN[3]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsN[3]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - N-OthrHVAC" 	Proj:RunResultsN[4]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsN[4]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsN[4]:DesignRatingSrc[2]  ) - LocalRef( RunResultsN[4]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsN[4]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - N-WtrHt"    	Proj:RunResultsN[5]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsN[5]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsN[5]:DesignRatingSrc[2]  ) - LocalRef( RunResultsN[5]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsN[5]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - N-InsLtg"   	Proj:RunResultsN[6]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsN[6]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsN[6]:DesignRatingSrc[2]  ) - LocalRef( RunResultsN[6]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsN[6]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - N-AppCkg"   	Proj:RunResultsN[7]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsN[7]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsN[7]:DesignRatingSrc[2]  ) - LocalRef( RunResultsN[7]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsN[7]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - N-Plugs"    	Proj:RunResultsN[8]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsN[8]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsN[8]:DesignRatingSrc[2]  ) - LocalRef( RunResultsN[8]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsN[8]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - N-Ext"      	Proj:RunResultsN[9]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsN[9]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsN[9]:DesignRatingSrc[2]  ) - LocalRef( RunResultsN[9]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsN[9]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - N-PV"     	 	Proj:RunResultsN[13]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsN[13]:DesignRatingSrc[2] ) == 0) then  0  else  (LocalRef( RunResultsN[13]:DesignRatingSrc[2] ) - LocalRef( RunResultsN[13]:ProposedSrc[2] )) * 100 / LocalRef( RunResultsN[13]:DesignRatingSrc[2] )  endif  }
	"Calc Src Pct Improve - N-Battery"     Proj:RunResultsN[14]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsN[14]:DesignRatingSrc[2] ) == 0) then  0  else  (LocalRef( RunResultsN[14]:DesignRatingSrc[2] ) - LocalRef( RunResultsN[14]:ProposedSrc[2] )) * 100 / LocalRef( RunResultsN[14]:DesignRatingSrc[2] )  endif  }
	"Calc Src Pct Improve - N-Total"    	Proj:RunResultsN[10]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsN[10]:DesignRatingSrc[2] ) == 0) then  0  else  (LocalRef( RunResultsN[10]:DesignRatingSrc[2] ) - LocalRef( RunResultsN[10]:ProposedSrc[2] )) * 100 / LocalRef( RunResultsN[10]:DesignRatingSrc[2] )  endif  }
	"Calc Src Pct Improve - N-Comp Ttl"  	Proj:RunResultsN[11]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsN[11]:DesignRatingSrc[2] ) == 0) then  0  else  (LocalRef( RunResultsN[11]:DesignRatingSrc[2] ) - LocalRef( RunResultsN[11]:ProposedSrc[2] )) * 100 / LocalRef( RunResultsN[11]:DesignRatingSrc[2] )  endif  }

  ; Percent Improvement - EAST
   ; SAC 10/2/17 - switched from reporting delta with DRtgSrc w/o fuel adjustment mult applied to DRtgSrc W/ fuel adjustment mult applied
	"Calc Src Pct Improve - E-SpcHt"    	Proj:RunResultsE[1]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsE[1]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsE[1]:DesignRatingSrc[2]  ) - LocalRef( RunResultsE[1]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsE[1]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - E-SpcCl"    	Proj:RunResultsE[2]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsE[2]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsE[2]:DesignRatingSrc[2]  ) - LocalRef( RunResultsE[2]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsE[2]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - E-IAQVent"  	Proj:RunResultsE[3]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsE[3]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsE[3]:DesignRatingSrc[2]  ) - LocalRef( RunResultsE[3]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsE[3]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - E-OthrHVAC" 	Proj:RunResultsE[4]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsE[4]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsE[4]:DesignRatingSrc[2]  ) - LocalRef( RunResultsE[4]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsE[4]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - E-WtrHt"    	Proj:RunResultsE[5]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsE[5]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsE[5]:DesignRatingSrc[2]  ) - LocalRef( RunResultsE[5]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsE[5]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - E-InsLtg"   	Proj:RunResultsE[6]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsE[6]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsE[6]:DesignRatingSrc[2]  ) - LocalRef( RunResultsE[6]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsE[6]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - E-AppCkg"   	Proj:RunResultsE[7]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsE[7]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsE[7]:DesignRatingSrc[2]  ) - LocalRef( RunResultsE[7]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsE[7]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - E-Plugs"    	Proj:RunResultsE[8]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsE[8]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsE[8]:DesignRatingSrc[2]  ) - LocalRef( RunResultsE[8]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsE[8]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - E-Ext"      	Proj:RunResultsE[9]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsE[9]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsE[9]:DesignRatingSrc[2]  ) - LocalRef( RunResultsE[9]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsE[9]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - E-PV"     	 	Proj:RunResultsE[13]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsE[13]:DesignRatingSrc[2] ) == 0) then  0  else  (LocalRef( RunResultsE[13]:DesignRatingSrc[2] ) - LocalRef( RunResultsE[13]:ProposedSrc[2] )) * 100 / LocalRef( RunResultsE[13]:DesignRatingSrc[2] )  endif  }
	"Calc Src Pct Improve - E-Battery"     Proj:RunResultsE[14]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsE[14]:DesignRatingSrc[2] ) == 0) then  0  else  (LocalRef( RunResultsE[14]:DesignRatingSrc[2] ) - LocalRef( RunResultsE[14]:ProposedSrc[2] )) * 100 / LocalRef( RunResultsE[14]:DesignRatingSrc[2] )  endif  }
	"Calc Src Pct Improve - E-Total"    	Proj:RunResultsE[10]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsE[10]:DesignRatingSrc[2] ) == 0) then  0  else  (LocalRef( RunResultsE[10]:DesignRatingSrc[2] ) - LocalRef( RunResultsE[10]:ProposedSrc[2] )) * 100 / LocalRef( RunResultsE[10]:DesignRatingSrc[2] )  endif  }
	"Calc Src Pct Improve - E-Comp Ttl"  	Proj:RunResultsE[11]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsE[11]:DesignRatingSrc[2] ) == 0) then  0  else  (LocalRef( RunResultsE[11]:DesignRatingSrc[2] ) - LocalRef( RunResultsE[11]:ProposedSrc[2] )) * 100 / LocalRef( RunResultsE[11]:DesignRatingSrc[2] )  endif  }

  ; Percent Improvement - SOUTH
   ; SAC 10/2/17 - switched from reporting delta with DRtgSrc w/o fuel adjustment mult applied to DRtgSrc W/ fuel adjustment mult applied
	"Calc Src Pct Improve - S-SpcHt"    	Proj:RunResultsS[1]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsS[1]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsS[1]:DesignRatingSrc[2]  ) - LocalRef( RunResultsS[1]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsS[1]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - S-SpcCl"    	Proj:RunResultsS[2]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsS[2]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsS[2]:DesignRatingSrc[2]  ) - LocalRef( RunResultsS[2]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsS[2]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - S-IAQVent"  	Proj:RunResultsS[3]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsS[3]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsS[3]:DesignRatingSrc[2]  ) - LocalRef( RunResultsS[3]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsS[3]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - S-OthrHVAC" 	Proj:RunResultsS[4]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsS[4]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsS[4]:DesignRatingSrc[2]  ) - LocalRef( RunResultsS[4]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsS[4]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - S-WtrHt"    	Proj:RunResultsS[5]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsS[5]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsS[5]:DesignRatingSrc[2]  ) - LocalRef( RunResultsS[5]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsS[5]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - S-InsLtg"   	Proj:RunResultsS[6]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsS[6]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsS[6]:DesignRatingSrc[2]  ) - LocalRef( RunResultsS[6]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsS[6]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - S-AppCkg"   	Proj:RunResultsS[7]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsS[7]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsS[7]:DesignRatingSrc[2]  ) - LocalRef( RunResultsS[7]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsS[7]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - S-Plugs"    	Proj:RunResultsS[8]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsS[8]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsS[8]:DesignRatingSrc[2]  ) - LocalRef( RunResultsS[8]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsS[8]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - S-Ext"      	Proj:RunResultsS[9]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsS[9]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsS[9]:DesignRatingSrc[2]  ) - LocalRef( RunResultsS[9]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsS[9]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - S-PV"    	  	Proj:RunResultsS[13]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsS[13]:DesignRatingSrc[2] ) == 0) then  0  else  (LocalRef( RunResultsS[13]:DesignRatingSrc[2] ) - LocalRef( RunResultsS[13]:ProposedSrc[2] )) * 100 / LocalRef( RunResultsS[13]:DesignRatingSrc[2] )  endif  }
	"Calc Src Pct Improve - S-Battery"    	Proj:RunResultsS[14]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsS[14]:DesignRatingSrc[2] ) == 0) then  0  else  (LocalRef( RunResultsS[14]:DesignRatingSrc[2] ) - LocalRef( RunResultsS[14]:ProposedSrc[2] )) * 100 / LocalRef( RunResultsS[14]:DesignRatingSrc[2] )  endif  }
	"Calc Src Pct Improve - S-Total"    	Proj:RunResultsS[10]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsS[10]:DesignRatingSrc[2] ) == 0) then  0  else  (LocalRef( RunResultsS[10]:DesignRatingSrc[2] ) - LocalRef( RunResultsS[10]:ProposedSrc[2] )) * 100 / LocalRef( RunResultsS[10]:DesignRatingSrc[2] )  endif  }
	"Calc Src Pct Improve - S-Comp Ttl"  	Proj:RunResultsS[11]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsS[11]:DesignRatingSrc[2] ) == 0) then  0  else  (LocalRef( RunResultsS[11]:DesignRatingSrc[2] ) - LocalRef( RunResultsS[11]:ProposedSrc[2] )) * 100 / LocalRef( RunResultsS[11]:DesignRatingSrc[2] )  endif  }

  ; Percent Improvement - WEST
   ; SAC 10/2/17 - switched from reporting delta with DRtgSrc w/o fuel adjustment mult applied to DRtgSrc W/ fuel adjustment mult applied
	"Calc Src Pct Improve - W-SpcHt"    	Proj:RunResultsW[1]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsW[1]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsW[1]:DesignRatingSrc[2]  ) - LocalRef( RunResultsW[1]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsW[1]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - W-SpcCl"    	Proj:RunResultsW[2]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsW[2]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsW[2]:DesignRatingSrc[2]  ) - LocalRef( RunResultsW[2]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsW[2]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - W-IAQVent"  	Proj:RunResultsW[3]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsW[3]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsW[3]:DesignRatingSrc[2]  ) - LocalRef( RunResultsW[3]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsW[3]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - W-OthrHVAC" 	Proj:RunResultsW[4]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsW[4]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsW[4]:DesignRatingSrc[2]  ) - LocalRef( RunResultsW[4]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsW[4]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - W-WtrHt"    	Proj:RunResultsW[5]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsW[5]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsW[5]:DesignRatingSrc[2]  ) - LocalRef( RunResultsW[5]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsW[5]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - W-InsLtg"   	Proj:RunResultsW[6]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsW[6]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsW[6]:DesignRatingSrc[2]  ) - LocalRef( RunResultsW[6]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsW[6]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - W-AppCkg"   	Proj:RunResultsW[7]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsW[7]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsW[7]:DesignRatingSrc[2]  ) - LocalRef( RunResultsW[7]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsW[7]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - W-Plugs"    	Proj:RunResultsW[8]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsW[8]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsW[8]:DesignRatingSrc[2]  ) - LocalRef( RunResultsW[8]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsW[8]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - W-Ext"      	Proj:RunResultsW[9]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsW[9]:DesignRatingSrc[2]  ) == 0) then  0  else  (LocalRef( RunResultsW[9]:DesignRatingSrc[2]  ) - LocalRef( RunResultsW[9]:ProposedSrc[2]  )) * 100 / LocalRef( RunResultsW[9]:DesignRatingSrc[2]  )  endif  }
	"Calc Src Pct Improve - W-PV"     	 	Proj:RunResultsW[13]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsW[13]:DesignRatingSrc[2] ) == 0) then  0  else  (LocalRef( RunResultsW[13]:DesignRatingSrc[2] ) - LocalRef( RunResultsW[13]:ProposedSrc[2] )) * 100 / LocalRef( RunResultsW[13]:DesignRatingSrc[2] )  endif  }
	"Calc Src Pct Improve - W-Battery"     Proj:RunResultsW[14]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsW[14]:DesignRatingSrc[2] ) == 0) then  0  else  (LocalRef( RunResultsW[14]:DesignRatingSrc[2] ) - LocalRef( RunResultsW[14]:ProposedSrc[2] )) * 100 / LocalRef( RunResultsW[14]:DesignRatingSrc[2] )  endif  }
	"Calc Src Pct Improve - W-Total"    	Proj:RunResultsW[10]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsW[10]:DesignRatingSrc[2] ) == 0) then  0  else  (LocalRef( RunResultsW[10]:DesignRatingSrc[2] ) - LocalRef( RunResultsW[10]:ProposedSrc[2] )) * 100 / LocalRef( RunResultsW[10]:DesignRatingSrc[2] )  endif  }
	"Calc Src Pct Improve - W-Comp Ttl"  	Proj:RunResultsW[11]:DRtgPctSavSrc	= {	if (LocalRef( RunResultsW[11]:DesignRatingSrc[2] ) == 0) then  0  else  (LocalRef( RunResultsW[11]:DesignRatingSrc[2] ) - LocalRef( RunResultsW[11]:ProposedSrc[2] )) * 100 / LocalRef( RunResultsW[11]:DesignRatingSrc[2] )  endif  }
END

;*************************************************************************   - SAC 6/25/13
RULELIST "CARes_RunResults_SetWorst_SrcEnergy_N" 1 0 1 1
;*************************************************************************
 	"Set ResultSummary[1]:EDR1DesignRating"			Proj:ResultSummary[1]:EDR1DesignRating		= {  ResultSummary[2]:EDR1DesignRating		}
 	"Set ResultSummary[1]:EDR1DesignRatingStd"		Proj:ResultSummary[1]:EDR1DesignRatingStd	= {  ResultSummary[2]:EDR1DesignRatingStd	}
  ; Proposed Src
	"Set ResultSummary[1]:Title1[31]"			Proj:ResultSummary[1]:Title1[31]		= {	ResultSummary[2]:Title1[31]		}
	"Set ResultSummary[1]:Title2[31]"			Proj:ResultSummary[1]:Title2[31]		= {	ResultSummary[2]:Title2[31]		}
	"Set ResultSummary[1]:Title3[31]"			Proj:ResultSummary[1]:Title3[31]		= {	ResultSummary[2]:Title3[31]	   }	
	"Set ResultSummary[1]:Enduse1[31]"			Proj:ResultSummary[1]:Enduse1[31]	= {	ResultSummary[2]:Enduse1[31]	   }
	"Set ResultSummary[1]:Enduse2[31]"			Proj:ResultSummary[1]:Enduse2[31]	= {	ResultSummary[2]:Enduse2[31]	   }
	"Set ResultSummary[1]:Enduse3[31]"			Proj:ResultSummary[1]:Enduse3[31]	= {	ResultSummary[2]:Enduse3[31]	   }
	"Set ResultSummary[1]:Enduse4[31]"			Proj:ResultSummary[1]:Enduse4[31]	= {	ResultSummary[2]:Enduse4[31]	   }
	"Set ResultSummary[1]:Enduse5[31]"			Proj:ResultSummary[1]:Enduse5[31]	= {	ResultSummary[2]:Enduse5[31]	   }
	"Set ResultSummary[1]:Enduse14[31]"			Proj:ResultSummary[1]:Enduse14[31]	= {	ResultSummary[2]:Enduse14[31]	   }
	"Set ResultSummary[1]:Enduse6[31]"			Proj:ResultSummary[1]:Enduse6[31]	= {	ResultSummary[2]:Enduse6[31]	   }
	"Set ResultSummary[1]:Enduse7[31]"			Proj:ResultSummary[1]:Enduse7[31]	= {	ResultSummary[2]:Enduse7[31]	   }
	"Set ResultSummary[1]:Enduse8[31]"			Proj:ResultSummary[1]:Enduse8[31]	= {	ResultSummary[2]:Enduse8[31]	   }
	"Set ResultSummary[1]:Enduse9[31]"			Proj:ResultSummary[1]:Enduse9[31]	= {	ResultSummary[2]:Enduse9[31]	   }
 	"Set ResultSummary[1]:Enduse10[31]"			Proj:ResultSummary[1]:Enduse10[31]	= {	ResultSummary[2]:Enduse10[31]	   }
 	"Set ResultSummary[1]:Enduse11[31]"			Proj:ResultSummary[1]:Enduse11[31]	= {	ResultSummary[2]:Enduse11[31]	   }
 	"Set ResultSummary[1]:Enduse12[31]"			Proj:ResultSummary[1]:Enduse12[31]	= {	ResultSummary[2]:Enduse12[31]	   }
 	"Set ResultSummary[1]:Enduse13[31]"			Proj:ResultSummary[1]:Enduse13[31]	= {	ResultSummary[2]:Enduse13[31]	   }
  ; Standard Src
	"Set ResultSummary[1]:Title1[32]"			Proj:ResultSummary[1]:Title1[32]		= {	ResultSummary[2]:Title1[32]		}
	"Set ResultSummary[1]:Title2[32]"			Proj:ResultSummary[1]:Title2[32]		= {	ResultSummary[2]:Title2[32]		}
	"Set ResultSummary[1]:Title3[32]"			Proj:ResultSummary[1]:Title3[32]		= {	ResultSummary[2]:Title3[32]		}
	"Set ResultSummary[1]:Enduse1[32]"			Proj:ResultSummary[1]:Enduse1[32]	= {	ResultSummary[2]:Enduse1[32]	   }
	"Set ResultSummary[1]:Enduse2[32]"			Proj:ResultSummary[1]:Enduse2[32]	= {	ResultSummary[2]:Enduse2[32]	   }
	"Set ResultSummary[1]:Enduse3[32]"			Proj:ResultSummary[1]:Enduse3[32]	= {	ResultSummary[2]:Enduse3[32]	   }
	"Set ResultSummary[1]:Enduse4[32]"			Proj:ResultSummary[1]:Enduse4[32]	= {	ResultSummary[2]:Enduse4[32]	   }
	"Set ResultSummary[1]:Enduse5[32]"			Proj:ResultSummary[1]:Enduse5[32]	= {	ResultSummary[2]:Enduse5[32]	   }
	"Set ResultSummary[1]:Enduse6[32]"			Proj:ResultSummary[1]:Enduse6[32]	= {	ResultSummary[2]:Enduse6[32]	   }
	"Set ResultSummary[1]:Enduse7[32]"			Proj:ResultSummary[1]:Enduse7[32]	= {	ResultSummary[2]:Enduse7[32]	   }
	"Set ResultSummary[1]:Enduse8[32]"			Proj:ResultSummary[1]:Enduse8[32]	= {	ResultSummary[2]:Enduse8[32]	   }
	"Set ResultSummary[1]:Enduse9[32]"			Proj:ResultSummary[1]:Enduse9[32]	= {	ResultSummary[2]:Enduse9[32]	   }
 	"Set ResultSummary[1]:Enduse10[32]"			Proj:ResultSummary[1]:Enduse10[32]	= {	ResultSummary[2]:Enduse10[32]	   }
 	"Set ResultSummary[1]:Enduse11[32]"			Proj:ResultSummary[1]:Enduse11[32]	= {	ResultSummary[2]:Enduse11[32]	   }
 	"Set ResultSummary[1]:Enduse12[32]"			Proj:ResultSummary[1]:Enduse12[32]	= {	ResultSummary[2]:Enduse12[32]	   }
	"Set ResultSummary[1]:Enduse13[32]"			Proj:ResultSummary[1]:Enduse13[32]	= {	ResultSummary[2]:Enduse13[32]	   }
	"Set ResultSummary[1]:Enduse14[32]"			Proj:ResultSummary[1]:Enduse14[32]	= {	ResultSummary[2]:Enduse14[32]	   }
  ; Compliance Margin Src
	"Set ResultSummary[1]:Title1[33]"			Proj:ResultSummary[1]:Title1[33]		= {	ResultSummary[2]:Title1[33]		}
	"Set ResultSummary[1]:Title2[33]"			Proj:ResultSummary[1]:Title2[33]		= {	ResultSummary[2]:Title2[33]		}
	"Set ResultSummary[1]:Title3[33]"			Proj:ResultSummary[1]:Title3[33]		= {	ResultSummary[2]:Title3[33]		}
	"Set ResultSummary[1]:Enduse1[33]"			Proj:ResultSummary[1]:Enduse1[33]	= {	ResultSummary[2]:Enduse1[33]	   }
	"Set ResultSummary[1]:Enduse2[33]"			Proj:ResultSummary[1]:Enduse2[33]	= {	ResultSummary[2]:Enduse2[33]	   }
	"Set ResultSummary[1]:Enduse3[33]"			Proj:ResultSummary[1]:Enduse3[33]	= {	ResultSummary[2]:Enduse3[33]	   }
	"Set ResultSummary[1]:Enduse4[33]"			Proj:ResultSummary[1]:Enduse4[33]	= {	ResultSummary[2]:Enduse4[33]	   }
	"Set ResultSummary[1]:Enduse5[33]"			Proj:ResultSummary[1]:Enduse5[33]	= {	ResultSummary[2]:Enduse5[33]	   }
	"Set ResultSummary[1]:Enduse14[33]"			Proj:ResultSummary[1]:Enduse14[33]	= {	ResultSummary[2]:Enduse14[33]	   }
	"Set ResultSummary[1]:Enduse6[33]"			Proj:ResultSummary[1]:Enduse6[33]	= {	ResultSummary[2]:Enduse6[33]	   }
	"Set ResultSummary[1]:Enduse7[33]"			Proj:ResultSummary[1]:Enduse7[33]	= {	ResultSummary[2]:Enduse7[33]	   }
	"Set ResultSummary[1]:Enduse8[33]"			Proj:ResultSummary[1]:Enduse8[33]	= {	ResultSummary[2]:Enduse8[33]	   }
	"Set ResultSummary[1]:Enduse9[33]"			Proj:ResultSummary[1]:Enduse9[33]	= {	ResultSummary[2]:Enduse9[33]	   }
 	"Set ResultSummary[1]:Enduse10[33]"			Proj:ResultSummary[1]:Enduse10[33]	= {	ResultSummary[2]:Enduse10[33]	   }
 	"Set ResultSummary[1]:Enduse11[33]"			Proj:ResultSummary[1]:Enduse11[33]	= {	ResultSummary[2]:Enduse11[33]	   }
 	"Set ResultSummary[1]:Enduse12[33]"			Proj:ResultSummary[1]:Enduse12[33]	= {	ResultSummary[2]:Enduse12[33]	   }
 	"Set ResultSummary[1]:Enduse13[33]"			Proj:ResultSummary[1]:Enduse13[33]	= {	ResultSummary[2]:Enduse13[33]	   }
  ; Design Rating Proposed Src
	"Set ResultSummary[1]:Title1[34]"			Proj:ResultSummary[1]:Title1[34]		= {	ResultSummary[2]:Title1[34]	 }	
	"Set ResultSummary[1]:Title2[34]"			Proj:ResultSummary[1]:Title2[34]		= {	ResultSummary[2]:Title2[34]	 }	
	"Set ResultSummary[1]:Title3[34]"			Proj:ResultSummary[1]:Title3[34]		= {	ResultSummary[2]:Title3[34]	 }	
	"Set ResultSummary[1]:Enduse1[34]"			Proj:ResultSummary[1]:Enduse1[34]	= {	ResultSummary[2]:Enduse1[34]	 }
	"Set ResultSummary[1]:Enduse2[34]"			Proj:ResultSummary[1]:Enduse2[34]	= {	ResultSummary[2]:Enduse2[34]	 }
	"Set ResultSummary[1]:Enduse3[34]"			Proj:ResultSummary[1]:Enduse3[34]	= {	ResultSummary[2]:Enduse3[34]	 }
	"Set ResultSummary[1]:Enduse4[34]"			Proj:ResultSummary[1]:Enduse4[34]	= {	ResultSummary[2]:Enduse4[34]	 }
	"Set ResultSummary[1]:Enduse5[34]"			Proj:ResultSummary[1]:Enduse5[34]	= {	ResultSummary[2]:Enduse5[34]	 }
	"Set ResultSummary[1]:Enduse6[34]"			Proj:ResultSummary[1]:Enduse6[34]	= {	ResultSummary[2]:Enduse6[34]	 }
	"Set ResultSummary[1]:Enduse7[34]"			Proj:ResultSummary[1]:Enduse7[34]	= {	ResultSummary[2]:Enduse7[34]	 }
	"Set ResultSummary[1]:Enduse8[34]"			Proj:ResultSummary[1]:Enduse8[34]	= {	ResultSummary[2]:Enduse8[34]	 }
	"Set ResultSummary[1]:Enduse9[34]"			Proj:ResultSummary[1]:Enduse9[34]	= {	ResultSummary[2]:Enduse9[34]	 }
	"Set ResultSummary[1]:Enduse10[34]"			Proj:ResultSummary[1]:Enduse10[34]	= {	ResultSummary[2]:Enduse10[34]	 }
	"Set ResultSummary[1]:Enduse11[34]"			Proj:ResultSummary[1]:Enduse11[34]	= {	ResultSummary[2]:Enduse11[34]	 }
	"Set ResultSummary[1]:Enduse12[34]"			Proj:ResultSummary[1]:Enduse12[34]	= {	ResultSummary[2]:Enduse12[34]	 }
	"Set ResultSummary[1]:Enduse13[34]"			Proj:ResultSummary[1]:Enduse13[34]	= {	ResultSummary[2]:Enduse13[34]	 }
	"Set ResultSummary[1]:Enduse14[34]"			Proj:ResultSummary[1]:Enduse14[34]	= {	ResultSummary[2]:Enduse14[34]	 }
  ; DesignRating Src
	"Set ResultSummary[1]:Title1[35]"			Proj:ResultSummary[1]:Title1[35]		= {	ResultSummary[2]:Title1[35]		}
	"Set ResultSummary[1]:Title2[35]"			Proj:ResultSummary[1]:Title2[35]		= {	ResultSummary[2]:Title2[35]		}
	"Set ResultSummary[1]:Title3[35]"			Proj:ResultSummary[1]:Title3[35]		= {	ResultSummary[2]:Title3[35]		}
	"Set ResultSummary[1]:Enduse1[35]"			Proj:ResultSummary[1]:Enduse1[35]	= {	ResultSummary[2]:Enduse1[35]	   }
	"Set ResultSummary[1]:Enduse2[35]"			Proj:ResultSummary[1]:Enduse2[35]	= {	ResultSummary[2]:Enduse2[35]	   }
	"Set ResultSummary[1]:Enduse3[35]"			Proj:ResultSummary[1]:Enduse3[35]	= {	ResultSummary[2]:Enduse3[35]	   }
	"Set ResultSummary[1]:Enduse4[35]"			Proj:ResultSummary[1]:Enduse4[35]	= {	ResultSummary[2]:Enduse4[35]	   }
	"Set ResultSummary[1]:Enduse5[35]"			Proj:ResultSummary[1]:Enduse5[35]	= {	ResultSummary[2]:Enduse5[35]	   }
	"Set ResultSummary[1]:Enduse14[35]"			Proj:ResultSummary[1]:Enduse14[35]	= {	ResultSummary[2]:Enduse14[35]	   }
	"Set ResultSummary[1]:Enduse6[35]"			Proj:ResultSummary[1]:Enduse6[35]	= {	ResultSummary[2]:Enduse6[35]	   }
	"Set ResultSummary[1]:Enduse7[35]"			Proj:ResultSummary[1]:Enduse7[35]	= {	ResultSummary[2]:Enduse7[35]	   }
	"Set ResultSummary[1]:Enduse8[35]"			Proj:ResultSummary[1]:Enduse8[35]	= {	ResultSummary[2]:Enduse8[35]	   }
	"Set ResultSummary[1]:Enduse9[35]"			Proj:ResultSummary[1]:Enduse9[35]	= {	ResultSummary[2]:Enduse9[35]	   }
 	"Set ResultSummary[1]:Enduse10[35]"			Proj:ResultSummary[1]:Enduse10[35]	= {	ResultSummary[2]:Enduse10[35]	   }
 	"Set ResultSummary[1]:Enduse11[35]"			Proj:ResultSummary[1]:Enduse11[35]	= {	ResultSummary[2]:Enduse11[35]	   }
 	"Set ResultSummary[1]:Enduse12[35]"			Proj:ResultSummary[1]:Enduse12[35]	= {	ResultSummary[2]:Enduse12[35]	   }
	"Set ResultSummary[1]:Enduse13[35]"			Proj:ResultSummary[1]:Enduse13[35]	= {	ResultSummary[2]:Enduse13[35]	   }
  ; DesignRating Margin Src
	"Set ResultSummary[1]:Title1[36]"			Proj:ResultSummary[1]:Title1[36]		= {	ResultSummary[2]:Title1[36]		}
	"Set ResultSummary[1]:Title2[36]"			Proj:ResultSummary[1]:Title2[36]		= {	ResultSummary[2]:Title2[36]		}
	"Set ResultSummary[1]:Title3[36]"			Proj:ResultSummary[1]:Title3[36]		= {	ResultSummary[2]:Title3[36]		}
	"Set ResultSummary[1]:Enduse1[36]"			Proj:ResultSummary[1]:Enduse1[36]	= {	ResultSummary[2]:Enduse1[36]	   }
	"Set ResultSummary[1]:Enduse2[36]"			Proj:ResultSummary[1]:Enduse2[36]	= {	ResultSummary[2]:Enduse2[36]	   }
	"Set ResultSummary[1]:Enduse3[36]"			Proj:ResultSummary[1]:Enduse3[36]	= {	ResultSummary[2]:Enduse3[36]	   }
	"Set ResultSummary[1]:Enduse4[36]"			Proj:ResultSummary[1]:Enduse4[36]	= {	ResultSummary[2]:Enduse4[36]	   }
	"Set ResultSummary[1]:Enduse5[36]"			Proj:ResultSummary[1]:Enduse5[36]	= {	ResultSummary[2]:Enduse5[36]	   }
	"Set ResultSummary[1]:Enduse14[36]"			Proj:ResultSummary[1]:Enduse14[36]	= {	ResultSummary[2]:Enduse14[36]	   }
	"Set ResultSummary[1]:Enduse6[36]"			Proj:ResultSummary[1]:Enduse6[36]	= {	ResultSummary[2]:Enduse6[36]	   }
	"Set ResultSummary[1]:Enduse7[36]"			Proj:ResultSummary[1]:Enduse7[36]	= {	ResultSummary[2]:Enduse7[36]	   }
	"Set ResultSummary[1]:Enduse8[36]"			Proj:ResultSummary[1]:Enduse8[36]	= {	ResultSummary[2]:Enduse8[36]	   }
	"Set ResultSummary[1]:Enduse9[36]"			Proj:ResultSummary[1]:Enduse9[36]	= {	ResultSummary[2]:Enduse9[36]	   }
 	"Set ResultSummary[1]:Enduse10[36]"			Proj:ResultSummary[1]:Enduse10[36]	= {	ResultSummary[2]:Enduse10[36]	   }
 	"Set ResultSummary[1]:Enduse11[36]"			Proj:ResultSummary[1]:Enduse11[36]	= {	ResultSummary[2]:Enduse11[36]	   }
 	"Set ResultSummary[1]:Enduse12[36]"			Proj:ResultSummary[1]:Enduse12[36]	= {	ResultSummary[2]:Enduse12[36]	   }
 	"Set ResultSummary[1]:Enduse13[36]"			Proj:ResultSummary[1]:Enduse13[36]	= {	ResultSummary[2]:Enduse13[36]	   }


;	"Set worst case ResultSummary[1]:PropInputPVMult"        Proj:ResultSummary[1]:PropInputPVMult        = {  ResultSummary[2]:PropInputPVMult      }  ; SAC 1/12/18
;	"Set worst case ResultSummary[1]:PropPVScaleFactor"      Proj:ResultSummary[1]:PropPVScaleFactor      = {  ResultSummary[2]:PropPVScaleFactor    }  ; SAC 6/13/17
;	"Set worst case ResultSummary[1]:NetSurpPVProduction"    Proj:ResultSummary[1]:NetSurpPVProduction    = {  ResultSummary[2]:NetSurpPVProduction  }
;	"Set worst case ResultSummary[1]:UnscaledPropPVRatio"    Proj:ResultSummary[1]:UnscaledPropPVRatio    = {  ResultSummary[2]:UnscaledPropPVRatio  }
;   "Set worst case ResultSummary[1]:StdDesignPVSize"        Proj:ResultSummary[1]:StdDesignPVSize        = {  ResultSummary[2]:StdDesignPVSize        }    ; SAC 1/7/18
;   "Set worst case ResultSummary[1]:DesignRating"           Proj:ResultSummary[1]:DesignRating           = {  ResultSummary[2]:DesignRating           }
;   "Set worst case ResultSummary[1]:DesignRatingNoPV"       Proj:ResultSummary[1]:DesignRatingNoPV       = {  ResultSummary[2]:DesignRatingNoPV       }
;   "Set worst case ResultSummary[1]:DesignRatingPVOnly"     Proj:ResultSummary[1]:DesignRatingPVOnly     = {  ResultSummary[2]:DesignRatingPVOnly     }
;   "Set worst case ResultSummary[1]:DesignRatingStd"        Proj:ResultSummary[1]:DesignRatingStd        = {  ResultSummary[2]:DesignRatingStd        }
;   "Set worst case ResultSummary[1]:DesignRatingStdNoPV"    Proj:ResultSummary[1]:DesignRatingStdNoPV    = {  ResultSummary[2]:DesignRatingStdNoPV    }
;   "Set worst case ResultSummary[1]:DesignRatingStdPVOnly"  Proj:ResultSummary[1]:DesignRatingStdPVOnly  = {  ResultSummary[2]:DesignRatingStdPVOnly  }
;   "Set worst case ResultSummary[1]:Enduse98[15]"           Proj:ResultSummary[1]:Enduse98[15]           = {  if (LocalStatus( ResultSummary[2]:Enduse98[15]          ) > 0) then  ResultSummary[2]:Enduse98[15]            else  UNDEFINED  endif  }    ; SAC 1/27/19 (tic #1053)
;   "Set worst case ResultSummary[1]:Enduse99[15]"           Proj:ResultSummary[1]:Enduse99[15]           = {  if (LocalStatus( ResultSummary[2]:Enduse99[15]          ) > 0) then  ResultSummary[2]:Enduse99[15]            else  UNDEFINED  endif  }
;	"Set worst case ResultSummary[1]:Enduse14[15]"           Proj:ResultSummary[1]:Enduse14[15]           = {  if (LocalStatus( ResultSummary[2]:Enduse14[15]          ) > 0) then  ResultSummary[2]:Enduse14[15]            else  UNDEFINED  endif  }
;   "Set worst case ResultSummary[1]:Enduse98[17]"           Proj:ResultSummary[1]:Enduse98[17]           = {  if (LocalStatus( ResultSummary[2]:Enduse98[17]          ) > 0) then  ResultSummary[2]:Enduse98[17]            else  UNDEFINED  endif  }
;   "Set worst case ResultSummary[1]:Enduse99[17]"           Proj:ResultSummary[1]:Enduse99[17]           = {  if (LocalStatus( ResultSummary[2]:Enduse99[17]          ) > 0) then  ResultSummary[2]:Enduse99[17]            else  UNDEFINED  endif  }
;	"Set worst case ResultSummary[1]:Enduse14[17]"           Proj:ResultSummary[1]:Enduse14[17]           = {  if (LocalStatus( ResultSummary[2]:Enduse14[17]          ) > 0) then  ResultSummary[2]:Enduse14[17]            else  UNDEFINED  endif  }
;   "Set worst case ResultSummary[1]:Enduse98[19]"           Proj:ResultSummary[1]:Enduse98[19]           = {  if (LocalStatus( ResultSummary[2]:Enduse98[19]          ) > 0) then  ResultSummary[2]:Enduse98[19]            else  UNDEFINED  endif  }
;   "Set worst case ResultSummary[1]:Enduse99[19]"           Proj:ResultSummary[1]:Enduse99[19]           = {  if (LocalStatus( ResultSummary[2]:Enduse99[19]          ) > 0) then  ResultSummary[2]:Enduse99[19]            else  UNDEFINED  endif  }
;	"Set worst case ResultSummary[1]:Enduse14[19]"           Proj:ResultSummary[1]:Enduse14[19]           = {  if (LocalStatus( ResultSummary[2]:Enduse14[19]          ) > 0) then  ResultSummary[2]:Enduse14[19]            else  UNDEFINED  endif  }
;   "Set worst case ResultSummary[1]:Enduse98[8]"            Proj:ResultSummary[1]:Enduse98[8]            = {  if (LocalStatus( ResultSummary[2]:Enduse98[8]           ) > 0) then  ResultSummary[2]:Enduse98[8]             else  UNDEFINED  endif  }
;   "Set worst case ResultSummary[1]:Enduse99[8]"            Proj:ResultSummary[1]:Enduse99[8]            = {  if (LocalStatus( ResultSummary[2]:Enduse99[8]           ) > 0) then  ResultSummary[2]:Enduse99[8]             else  UNDEFINED  endif  }
;	"Set worst case ResultSummary[1]:Enduse14[8]"            Proj:ResultSummary[1]:Enduse14[8]            = {  if (LocalStatus( ResultSummary[2]:Enduse14[8]           ) > 0) then  ResultSummary[2]:Enduse14[8]             else  UNDEFINED  endif  }
;   "Set worst case ResultSummary[1]:Enduse98[2]"            Proj:ResultSummary[1]:Enduse98[2]            = {  if (LocalStatus( ResultSummary[2]:Enduse98[2]           ) > 0) then  ResultSummary[2]:Enduse98[2]             else  UNDEFINED  endif  }
;   "Set worst case ResultSummary[1]:Enduse99[2]"            Proj:ResultSummary[1]:Enduse99[2]            = {  if (LocalStatus( ResultSummary[2]:Enduse99[2]           ) > 0) then  ResultSummary[2]:Enduse99[2]             else  UNDEFINED  endif  }
;	"Set worst case ResultSummary[1]:Enduse14[2]"            Proj:ResultSummary[1]:Enduse14[2]            = {  if (LocalStatus( ResultSummary[2]:Enduse14[2]           ) > 0) then  ResultSummary[2]:Enduse14[2]             else  UNDEFINED  endif  }
;   "Set worst case ResultSummary[1]:Enduse98[4]"            Proj:ResultSummary[1]:Enduse98[4]            = {  if (LocalStatus( ResultSummary[2]:Enduse98[4]           ) > 0) then  ResultSummary[2]:Enduse98[4]             else  UNDEFINED  endif  }
;   "Set worst case ResultSummary[1]:Enduse99[4]"            Proj:ResultSummary[1]:Enduse99[4]            = {  if (LocalStatus( ResultSummary[2]:Enduse99[4]           ) > 0) then  ResultSummary[2]:Enduse99[4]             else  UNDEFINED  endif  }
;	"Set worst case ResultSummary[1]:Enduse14[4]"            Proj:ResultSummary[1]:Enduse14[4]            = {  if (LocalStatus( ResultSummary[2]:Enduse14[4]           ) > 0) then  ResultSummary[2]:Enduse14[4]             else  UNDEFINED  endif  }
;   "Set worst case ResultSummary[1]:ResultsNotes[1]"        Proj:ResultSummary[1]:ResultsNotes[1]        = {  if (LocalStatus( ResultSummary[2]:ResultsNotes[1]       ) > 0) then  ResultSummary[2]:ResultsNotes[1]         else  UNDEFINED  endif  }
;	"Set worst case ResultSummary[1]:HaveResultsNotesPV[1]"  Proj:ResultSummary[1]:HaveResultsNotesPV[1]  = {  if (LocalStatus( ResultSummary[2]:HaveResultsNotesPV[1] ) > 0) then  ResultSummary[2]:HaveResultsNotesPV[1]   else  UNDEFINED  endif  }
;   "Set worst case ResultSummary[1]:ResultsNotes[2]"        Proj:ResultSummary[1]:ResultsNotes[2]        = {  if (LocalStatus( ResultSummary[2]:ResultsNotes[2]       ) > 0) then  ResultSummary[2]:ResultsNotes[2]         else  UNDEFINED  endif  }
;	"Set worst case ResultSummary[1]:HaveResultsNotesPV[2]"  Proj:ResultSummary[1]:HaveResultsNotesPV[2]  = {  if (LocalStatus( ResultSummary[2]:HaveResultsNotesPV[2] ) > 0) then  ResultSummary[2]:HaveResultsNotesPV[2]   else  UNDEFINED  endif  }
;   "Set worst case ResultSummary[1]:ResultsNotes[3]"        Proj:ResultSummary[1]:ResultsNotes[3]        = {  if (LocalStatus( ResultSummary[2]:ResultsNotes[3]       ) > 0) then  ResultSummary[2]:ResultsNotes[3]         else  UNDEFINED  endif  }
;	"Set worst case ResultSummary[1]:HaveResultsNotesPV[3]"  Proj:ResultSummary[1]:HaveResultsNotesPV[3]  = {  if (LocalStatus( ResultSummary[2]:HaveResultsNotesPV[3] ) > 0) then  ResultSummary[2]:HaveResultsNotesPV[3]   else  UNDEFINED  endif  }
;   "Set worst case ResultSummary[1]:ResultsNotes[4]"        Proj:ResultSummary[1]:ResultsNotes[4]        = {  if (LocalStatus( ResultSummary[2]:ResultsNotes[4]       ) > 0) then  ResultSummary[2]:ResultsNotes[4]         else  UNDEFINED  endif  }
;	"Set worst case ResultSummary[1]:HaveResultsNotesPV[4]"  Proj:ResultSummary[1]:HaveResultsNotesPV[4]  = {  if (LocalStatus( ResultSummary[2]:HaveResultsNotesPV[4] ) > 0) then  ResultSummary[2]:HaveResultsNotesPV[4]   else  UNDEFINED  endif  }
;   "Set worst case ResultSummary[1]:ResultsNotes[5]"        Proj:ResultSummary[1]:ResultsNotes[5]        = {  if (LocalStatus( ResultSummary[2]:ResultsNotes[5]       ) > 0) then  ResultSummary[2]:ResultsNotes[5]         else  UNDEFINED  endif  }
;	"Set worst case ResultSummary[1]:HaveResultsNotesPV[5]"  Proj:ResultSummary[1]:HaveResultsNotesPV[5]  = {  if (LocalStatus( ResultSummary[2]:HaveResultsNotesPV[5] ) > 0) then  ResultSummary[2]:HaveResultsNotesPV[5]   else  UNDEFINED  endif  }
;   "Set worst case ResultSummary[1]:ResultsNotes[6]"        Proj:ResultSummary[1]:ResultsNotes[6]        = {  if (LocalStatus( ResultSummary[2]:ResultsNotes[6]       ) > 0) then  ResultSummary[2]:ResultsNotes[6]        else  UNDEFINED  endif  }
;	"Set worst case ResultSummary[1]:HaveResultsNotesPV[6]"  Proj:ResultSummary[1]:HaveResultsNotesPV[6]  = {  if (LocalStatus( ResultSummary[2]:HaveResultsNotesPV[6] ) > 0) then  ResultSummary[2]:HaveResultsNotesPV[6]  else  UNDEFINED  endif  }
;	"Set worst case ResultSummary[1]:GHCEnergyEffCap"        Proj:ResultSummary[1]:GHCEnergyEffCap        = {  if (LocalStatus( ResultSummary[2]:GHCEnergyEffCap       ) > 0) then  ResultSummary[2]:GHCEnergyEffCap         else  UNDEFINED  endif  }   ; SAC 1/12/18
;	"Set worst case ResultSummary[1]:GHCEnergyEffTDV"        Proj:ResultSummary[1]:GHCEnergyEffTDV        = {  if (LocalStatus( ResultSummary[2]:GHCEnergyEffTDV       ) > 0) then  ResultSummary[2]:GHCEnergyEffTDV         else  UNDEFINED  endif  }
;	"Set worst case ResultSummary[1]:GHCEnergyEffElec"       Proj:ResultSummary[1]:GHCEnergyEffElec       = {  if (LocalStatus( ResultSummary[2]:GHCEnergyEffElec      ) > 0) then  ResultSummary[2]:GHCEnergyEffElec        else  UNDEFINED  endif  }
;	"Set worst case ResultSummary[1]:GHCEnergyEffBattFrac"   Proj:ResultSummary[1]:GHCEnergyEffBattFrac   = {  if (LocalStatus( ResultSummary[2]:GHCEnergyEffBattFrac  ) > 0) then  ResultSummary[2]:GHCEnergyEffBattFrac    else  UNDEFINED  endif  }
;	"Set worst case ResultSummary[1]:GHCEnergyEffCO2"        Proj:ResultSummary[1]:GHCEnergyEffCO2        = {  if (LocalStatus( ResultSummary[2]:GHCEnergyEffCO2       ) > 0) then  ResultSummary[2]:GHCEnergyEffCO2        else  UNDEFINED  endif  }   ; SAC 1/27/18
;	"Set worst case ResultSummary[1]:Enduse11[4]"            Proj:ResultSummary[1]:Enduse11[4]            = {  if (LocalStatus( ResultSummary[2]:Enduse11[4]           ) > 0) then  ResultSummary[2]:Enduse11[4]            else  UNDEFINED  endif  }   ;  SAC 1/22/18
;	"Set worst case ResultSummary[1]:Enduse11[8]"            Proj:ResultSummary[1]:Enduse11[8]            = {  if (LocalStatus( ResultSummary[2]:Enduse11[8]           ) > 0) then  ResultSummary[2]:Enduse11[8]            else  UNDEFINED  endif  }
;	"Set worst case ResultSummary[1]:PctSavingsCmpTDV"       Proj:ResultSummary[1]:PctSavingsCmpTDV       = {  if (LocalStatus( ResultSummary[2]:PctSavingsCmpTDV      ) > 0) then  ResultSummary[2]:PctSavingsCmpTDV       else  UNDEFINED  endif  }
;	"Set worst case ResultSummary[1]:PctSavCmpTDVLbl"        Proj:ResultSummary[1]:PctSavCmpTDVLbl        = {  if (LocalStatus( ResultSummary[2]:PctSavCmpTDVLbl       ) > 0) then  ResultSummary[2]:PctSavCmpTDVLbl        else  UNDEFINED  endif  }
;	"Set worst case ResultSummary[1]:PFlxElecEnergy[1]"      Proj:ResultSummary[1]:PFlxElecEnergy[1]      = {  if (LocalStatus( ResultSummary[2]:PFlxElecEnergy[1]     ) > 0) then  ResultSummary[2]:PFlxElecEnergy[1]      else  UNDEFINED  endif  }  ; SAC 2/1/19 (tic #1053)
;	"Set worst case ResultSummary[1]:PFlxElecEnergy[2]"      Proj:ResultSummary[1]:PFlxElecEnergy[2]      = {  if (LocalStatus( ResultSummary[2]:PFlxElecEnergy[2]     ) > 0) then  ResultSummary[2]:PFlxElecEnergy[2]      else  UNDEFINED  endif  }
;	"Set worst case ResultSummary[1]:PFlxNatGasEnergy[1]"    Proj:ResultSummary[1]:PFlxNatGasEnergy[1]    = {  if (LocalStatus( ResultSummary[2]:PFlxNatGasEnergy[1]   ) > 0) then  ResultSummary[2]:PFlxNatGasEnergy[1]    else  UNDEFINED  endif  }
;	"Set worst case ResultSummary[1]:PFlxNatGasEnergy[2]"    Proj:ResultSummary[1]:PFlxNatGasEnergy[2]    = {  if (LocalStatus( ResultSummary[2]:PFlxNatGasEnergy[2]   ) > 0) then  ResultSummary[2]:PFlxNatGasEnergy[2]    else  UNDEFINED  endif  }
;	"Set worst case ResultSummary[1]:PFlxOtherEnergy[1]"     Proj:ResultSummary[1]:PFlxOtherEnergy[1]     = {  if (LocalStatus( ResultSummary[2]:PFlxOtherEnergy[1]    ) > 0) then  ResultSummary[2]:PFlxOtherEnergy[1]     else  UNDEFINED  endif  }
;	"Set worst case ResultSummary[1]:PFlxOtherEnergy[2]"     Proj:ResultSummary[1]:PFlxOtherEnergy[2]     = {  if (LocalStatus( ResultSummary[2]:PFlxOtherEnergy[2]    ) > 0) then  ResultSummary[2]:PFlxOtherEnergy[2]     else  UNDEFINED  endif  }
;	"Set worst case ResultSummary[1]:PFlxTDV[1]"             Proj:ResultSummary[1]:PFlxTDV[1]             = {  if (LocalStatus( ResultSummary[2]:PFlxTDV[1]            ) > 0) then  ResultSummary[2]:PFlxTDV[1]             else  UNDEFINED  endif  }
;	"Set worst case ResultSummary[1]:PFlxTDV[2]"             Proj:ResultSummary[1]:PFlxTDV[2]             = {  if (LocalStatus( ResultSummary[2]:PFlxTDV[2]            ) > 0) then  ResultSummary[2]:PFlxTDV[2]             else  UNDEFINED  endif  }
;   "Set worst case Carbon results"     Proj:Action  =       ; SAC 2/4/19 (tic #1053)
;      {  if (EnergyCodeYearNum < 2019) then  UNCHANGED
;         else  EvalRulelist( "CARes_RunResults_SetWorstCarbon_N" )  endif  }
END
;*************************************************************************   - SAC 6/25/13
RULELIST "CARes_RunResults_SetWorst_SrcEnergy_E" 1 0 1 1
;*************************************************************************
 	"Set ResultSummary[1]:EDR1DesignRating"			Proj:ResultSummary[1]:EDR1DesignRating		= {  ResultSummary[3]:EDR1DesignRating		}
 	"Set ResultSummary[1]:EDR1DesignRatingStd"		Proj:ResultSummary[1]:EDR1DesignRatingStd	= {  ResultSummary[3]:EDR1DesignRatingStd	}
  ; Proposed Src
	"Set ResultSummary[1]:Title1[31]"			Proj:ResultSummary[1]:Title1[31]		= {	ResultSummary[3]:Title1[31]		}
	"Set ResultSummary[1]:Title2[31]"			Proj:ResultSummary[1]:Title2[31]		= {	ResultSummary[3]:Title2[31]		}
	"Set ResultSummary[1]:Title3[31]"			Proj:ResultSummary[1]:Title3[31]		= {	ResultSummary[3]:Title3[31]	   }	
	"Set ResultSummary[1]:Enduse1[31]"			Proj:ResultSummary[1]:Enduse1[31]	= {	ResultSummary[3]:Enduse1[31]	   }
	"Set ResultSummary[1]:Enduse2[31]"			Proj:ResultSummary[1]:Enduse2[31]	= {	ResultSummary[3]:Enduse2[31]	   }
	"Set ResultSummary[1]:Enduse3[31]"			Proj:ResultSummary[1]:Enduse3[31]	= {	ResultSummary[3]:Enduse3[31]	   }
	"Set ResultSummary[1]:Enduse4[31]"			Proj:ResultSummary[1]:Enduse4[31]	= {	ResultSummary[3]:Enduse4[31]	   }
	"Set ResultSummary[1]:Enduse5[31]"			Proj:ResultSummary[1]:Enduse5[31]	= {	ResultSummary[3]:Enduse5[31]	   }
	"Set ResultSummary[1]:Enduse14[31]"			Proj:ResultSummary[1]:Enduse14[31]	= {	ResultSummary[3]:Enduse14[31]	   }
	"Set ResultSummary[1]:Enduse6[31]"			Proj:ResultSummary[1]:Enduse6[31]	= {	ResultSummary[3]:Enduse6[31]	   }
	"Set ResultSummary[1]:Enduse7[31]"			Proj:ResultSummary[1]:Enduse7[31]	= {	ResultSummary[3]:Enduse7[31]	   }
	"Set ResultSummary[1]:Enduse8[31]"			Proj:ResultSummary[1]:Enduse8[31]	= {	ResultSummary[3]:Enduse8[31]	   }
	"Set ResultSummary[1]:Enduse9[31]"			Proj:ResultSummary[1]:Enduse9[31]	= {	ResultSummary[3]:Enduse9[31]	   }
 	"Set ResultSummary[1]:Enduse10[31]"			Proj:ResultSummary[1]:Enduse10[31]	= {	ResultSummary[3]:Enduse10[31]	   }
 	"Set ResultSummary[1]:Enduse11[31]"			Proj:ResultSummary[1]:Enduse11[31]	= {	ResultSummary[3]:Enduse11[31]	   }
 	"Set ResultSummary[1]:Enduse12[31]"			Proj:ResultSummary[1]:Enduse12[31]	= {	ResultSummary[3]:Enduse12[31]	   }
 	"Set ResultSummary[1]:Enduse13[31]"			Proj:ResultSummary[1]:Enduse13[31]	= {	ResultSummary[3]:Enduse13[31]	   }
  ; Standard Src
	"Set ResultSummary[1]:Title1[32]"			Proj:ResultSummary[1]:Title1[32]		= {	ResultSummary[3]:Title1[32]		}
	"Set ResultSummary[1]:Title2[32]"			Proj:ResultSummary[1]:Title2[32]		= {	ResultSummary[3]:Title2[32]		}
	"Set ResultSummary[1]:Title3[32]"			Proj:ResultSummary[1]:Title3[32]		= {	ResultSummary[3]:Title3[32]		}
	"Set ResultSummary[1]:Enduse1[32]"			Proj:ResultSummary[1]:Enduse1[32]	= {	ResultSummary[3]:Enduse1[32]	   }
	"Set ResultSummary[1]:Enduse2[32]"			Proj:ResultSummary[1]:Enduse2[32]	= {	ResultSummary[3]:Enduse2[32]	   }
	"Set ResultSummary[1]:Enduse3[32]"			Proj:ResultSummary[1]:Enduse3[32]	= {	ResultSummary[3]:Enduse3[32]	   }
	"Set ResultSummary[1]:Enduse4[32]"			Proj:ResultSummary[1]:Enduse4[32]	= {	ResultSummary[3]:Enduse4[32]	   }
	"Set ResultSummary[1]:Enduse5[32]"			Proj:ResultSummary[1]:Enduse5[32]	= {	ResultSummary[3]:Enduse5[32]	   }
	"Set ResultSummary[1]:Enduse6[32]"			Proj:ResultSummary[1]:Enduse6[32]	= {	ResultSummary[3]:Enduse6[32]	   }
	"Set ResultSummary[1]:Enduse7[32]"			Proj:ResultSummary[1]:Enduse7[32]	= {	ResultSummary[3]:Enduse7[32]	   }
	"Set ResultSummary[1]:Enduse8[32]"			Proj:ResultSummary[1]:Enduse8[32]	= {	ResultSummary[3]:Enduse8[32]	   }
	"Set ResultSummary[1]:Enduse9[32]"			Proj:ResultSummary[1]:Enduse9[32]	= {	ResultSummary[3]:Enduse9[32]	   }
 	"Set ResultSummary[1]:Enduse10[32]"			Proj:ResultSummary[1]:Enduse10[32]	= {	ResultSummary[3]:Enduse10[32]	   }
 	"Set ResultSummary[1]:Enduse11[32]"			Proj:ResultSummary[1]:Enduse11[32]	= {	ResultSummary[3]:Enduse11[32]	   }
 	"Set ResultSummary[1]:Enduse12[32]"			Proj:ResultSummary[1]:Enduse12[32]	= {	ResultSummary[3]:Enduse12[32]	   }
	"Set ResultSummary[1]:Enduse13[32]"			Proj:ResultSummary[1]:Enduse13[32]	= {	ResultSummary[3]:Enduse13[32]	   }
	"Set ResultSummary[1]:Enduse14[32]"			Proj:ResultSummary[1]:Enduse14[32]	= {	ResultSummary[3]:Enduse14[32]	   }
  ; Compliance Margin Src
	"Set ResultSummary[1]:Title1[33]"			Proj:ResultSummary[1]:Title1[33]		= {	ResultSummary[3]:Title1[33]		}
	"Set ResultSummary[1]:Title2[33]"			Proj:ResultSummary[1]:Title2[33]		= {	ResultSummary[3]:Title2[33]		}
	"Set ResultSummary[1]:Title3[33]"			Proj:ResultSummary[1]:Title3[33]		= {	ResultSummary[3]:Title3[33]		}
	"Set ResultSummary[1]:Enduse1[33]"			Proj:ResultSummary[1]:Enduse1[33]	= {	ResultSummary[3]:Enduse1[33]	   }
	"Set ResultSummary[1]:Enduse2[33]"			Proj:ResultSummary[1]:Enduse2[33]	= {	ResultSummary[3]:Enduse2[33]	   }
	"Set ResultSummary[1]:Enduse3[33]"			Proj:ResultSummary[1]:Enduse3[33]	= {	ResultSummary[3]:Enduse3[33]	   }
	"Set ResultSummary[1]:Enduse4[33]"			Proj:ResultSummary[1]:Enduse4[33]	= {	ResultSummary[3]:Enduse4[33]	   }
	"Set ResultSummary[1]:Enduse5[33]"			Proj:ResultSummary[1]:Enduse5[33]	= {	ResultSummary[3]:Enduse5[33]	   }
	"Set ResultSummary[1]:Enduse14[33]"			Proj:ResultSummary[1]:Enduse14[33]	= {	ResultSummary[3]:Enduse14[33]	   }
	"Set ResultSummary[1]:Enduse6[33]"			Proj:ResultSummary[1]:Enduse6[33]	= {	ResultSummary[3]:Enduse6[33]	   }
	"Set ResultSummary[1]:Enduse7[33]"			Proj:ResultSummary[1]:Enduse7[33]	= {	ResultSummary[3]:Enduse7[33]	   }
	"Set ResultSummary[1]:Enduse8[33]"			Proj:ResultSummary[1]:Enduse8[33]	= {	ResultSummary[3]:Enduse8[33]	   }
	"Set ResultSummary[1]:Enduse9[33]"			Proj:ResultSummary[1]:Enduse9[33]	= {	ResultSummary[3]:Enduse9[33]	   }
 	"Set ResultSummary[1]:Enduse10[33]"			Proj:ResultSummary[1]:Enduse10[33]	= {	ResultSummary[3]:Enduse10[33]	   }
 	"Set ResultSummary[1]:Enduse11[33]"			Proj:ResultSummary[1]:Enduse11[33]	= {	ResultSummary[3]:Enduse11[33]	   }
 	"Set ResultSummary[1]:Enduse12[33]"			Proj:ResultSummary[1]:Enduse12[33]	= {	ResultSummary[3]:Enduse12[33]	   }
 	"Set ResultSummary[1]:Enduse13[33]"			Proj:ResultSummary[1]:Enduse13[33]	= {	ResultSummary[3]:Enduse13[33]	   }
  ; Design Rating Proposed Src
	"Set ResultSummary[1]:Title1[34]"			Proj:ResultSummary[1]:Title1[34]		= {	ResultSummary[3]:Title1[34]	 }	
	"Set ResultSummary[1]:Title2[34]"			Proj:ResultSummary[1]:Title2[34]		= {	ResultSummary[3]:Title2[34]	 }	
	"Set ResultSummary[1]:Title3[34]"			Proj:ResultSummary[1]:Title3[34]		= {	ResultSummary[3]:Title3[34]	 }	
	"Set ResultSummary[1]:Enduse1[34]"			Proj:ResultSummary[1]:Enduse1[34]	= {	ResultSummary[3]:Enduse1[34]	 }
	"Set ResultSummary[1]:Enduse2[34]"			Proj:ResultSummary[1]:Enduse2[34]	= {	ResultSummary[3]:Enduse2[34]	 }
	"Set ResultSummary[1]:Enduse3[34]"			Proj:ResultSummary[1]:Enduse3[34]	= {	ResultSummary[3]:Enduse3[34]	 }
	"Set ResultSummary[1]:Enduse4[34]"			Proj:ResultSummary[1]:Enduse4[34]	= {	ResultSummary[3]:Enduse4[34]	 }
	"Set ResultSummary[1]:Enduse5[34]"			Proj:ResultSummary[1]:Enduse5[34]	= {	ResultSummary[3]:Enduse5[34]	 }
	"Set ResultSummary[1]:Enduse6[34]"			Proj:ResultSummary[1]:Enduse6[34]	= {	ResultSummary[3]:Enduse6[34]	 }
	"Set ResultSummary[1]:Enduse7[34]"			Proj:ResultSummary[1]:Enduse7[34]	= {	ResultSummary[3]:Enduse7[34]	 }
	"Set ResultSummary[1]:Enduse8[34]"			Proj:ResultSummary[1]:Enduse8[34]	= {	ResultSummary[3]:Enduse8[34]	 }
	"Set ResultSummary[1]:Enduse9[34]"			Proj:ResultSummary[1]:Enduse9[34]	= {	ResultSummary[3]:Enduse9[34]	 }
	"Set ResultSummary[1]:Enduse10[34]"			Proj:ResultSummary[1]:Enduse10[34]	= {	ResultSummary[3]:Enduse10[34]	 }
	"Set ResultSummary[1]:Enduse11[34]"			Proj:ResultSummary[1]:Enduse11[34]	= {	ResultSummary[3]:Enduse11[34]	 }
	"Set ResultSummary[1]:Enduse12[34]"			Proj:ResultSummary[1]:Enduse12[34]	= {	ResultSummary[3]:Enduse12[34]	 }
	"Set ResultSummary[1]:Enduse13[34]"			Proj:ResultSummary[1]:Enduse13[34]	= {	ResultSummary[3]:Enduse13[34]	 }
	"Set ResultSummary[1]:Enduse14[34]"			Proj:ResultSummary[1]:Enduse14[34]	= {	ResultSummary[3]:Enduse14[34]	 }
  ; DesignRating Src
	"Set ResultSummary[1]:Title1[35]"			Proj:ResultSummary[1]:Title1[35]		= {	ResultSummary[3]:Title1[35]		}
	"Set ResultSummary[1]:Title2[35]"			Proj:ResultSummary[1]:Title2[35]		= {	ResultSummary[3]:Title2[35]		}
	"Set ResultSummary[1]:Title3[35]"			Proj:ResultSummary[1]:Title3[35]		= {	ResultSummary[3]:Title3[35]		}
	"Set ResultSummary[1]:Enduse1[35]"			Proj:ResultSummary[1]:Enduse1[35]	= {	ResultSummary[3]:Enduse1[35]	   }
	"Set ResultSummary[1]:Enduse2[35]"			Proj:ResultSummary[1]:Enduse2[35]	= {	ResultSummary[3]:Enduse2[35]	   }
	"Set ResultSummary[1]:Enduse3[35]"			Proj:ResultSummary[1]:Enduse3[35]	= {	ResultSummary[3]:Enduse3[35]	   }
	"Set ResultSummary[1]:Enduse4[35]"			Proj:ResultSummary[1]:Enduse4[35]	= {	ResultSummary[3]:Enduse4[35]	   }
	"Set ResultSummary[1]:Enduse5[35]"			Proj:ResultSummary[1]:Enduse5[35]	= {	ResultSummary[3]:Enduse5[35]	   }
	"Set ResultSummary[1]:Enduse14[35]"			Proj:ResultSummary[1]:Enduse14[35]	= {	ResultSummary[3]:Enduse14[35]	   }
	"Set ResultSummary[1]:Enduse6[35]"			Proj:ResultSummary[1]:Enduse6[35]	= {	ResultSummary[3]:Enduse6[35]	   }
	"Set ResultSummary[1]:Enduse7[35]"			Proj:ResultSummary[1]:Enduse7[35]	= {	ResultSummary[3]:Enduse7[35]	   }
	"Set ResultSummary[1]:Enduse8[35]"			Proj:ResultSummary[1]:Enduse8[35]	= {	ResultSummary[3]:Enduse8[35]	   }
	"Set ResultSummary[1]:Enduse9[35]"			Proj:ResultSummary[1]:Enduse9[35]	= {	ResultSummary[3]:Enduse9[35]	   }
 	"Set ResultSummary[1]:Enduse10[35]"			Proj:ResultSummary[1]:Enduse10[35]	= {	ResultSummary[3]:Enduse10[35]	   }
 	"Set ResultSummary[1]:Enduse11[35]"			Proj:ResultSummary[1]:Enduse11[35]	= {	ResultSummary[3]:Enduse11[35]	   }
 	"Set ResultSummary[1]:Enduse12[35]"			Proj:ResultSummary[1]:Enduse12[35]	= {	ResultSummary[3]:Enduse12[35]	   }
	"Set ResultSummary[1]:Enduse13[35]"			Proj:ResultSummary[1]:Enduse13[35]	= {	ResultSummary[3]:Enduse13[35]	   }
  ; DesignRating Margin Src
	"Set ResultSummary[1]:Title1[36]"			Proj:ResultSummary[1]:Title1[36]		= {	ResultSummary[3]:Title1[36]		}
	"Set ResultSummary[1]:Title2[36]"			Proj:ResultSummary[1]:Title2[36]		= {	ResultSummary[3]:Title2[36]		}
	"Set ResultSummary[1]:Title3[36]"			Proj:ResultSummary[1]:Title3[36]		= {	ResultSummary[3]:Title3[36]		}
	"Set ResultSummary[1]:Enduse1[36]"			Proj:ResultSummary[1]:Enduse1[36]	= {	ResultSummary[3]:Enduse1[36]	   }
	"Set ResultSummary[1]:Enduse2[36]"			Proj:ResultSummary[1]:Enduse2[36]	= {	ResultSummary[3]:Enduse2[36]	   }
	"Set ResultSummary[1]:Enduse3[36]"			Proj:ResultSummary[1]:Enduse3[36]	= {	ResultSummary[3]:Enduse3[36]	   }
	"Set ResultSummary[1]:Enduse4[36]"			Proj:ResultSummary[1]:Enduse4[36]	= {	ResultSummary[3]:Enduse4[36]	   }
	"Set ResultSummary[1]:Enduse5[36]"			Proj:ResultSummary[1]:Enduse5[36]	= {	ResultSummary[3]:Enduse5[36]	   }
	"Set ResultSummary[1]:Enduse14[36]"			Proj:ResultSummary[1]:Enduse14[36]	= {	ResultSummary[3]:Enduse14[36]	   }
	"Set ResultSummary[1]:Enduse6[36]"			Proj:ResultSummary[1]:Enduse6[36]	= {	ResultSummary[3]:Enduse6[36]	   }
	"Set ResultSummary[1]:Enduse7[36]"			Proj:ResultSummary[1]:Enduse7[36]	= {	ResultSummary[3]:Enduse7[36]	   }
	"Set ResultSummary[1]:Enduse8[36]"			Proj:ResultSummary[1]:Enduse8[36]	= {	ResultSummary[3]:Enduse8[36]	   }
	"Set ResultSummary[1]:Enduse9[36]"			Proj:ResultSummary[1]:Enduse9[36]	= {	ResultSummary[3]:Enduse9[36]	   }
 	"Set ResultSummary[1]:Enduse10[36]"			Proj:ResultSummary[1]:Enduse10[36]	= {	ResultSummary[3]:Enduse10[36]	   }
 	"Set ResultSummary[1]:Enduse11[36]"			Proj:ResultSummary[1]:Enduse11[36]	= {	ResultSummary[3]:Enduse11[36]	   }
 	"Set ResultSummary[1]:Enduse12[36]"			Proj:ResultSummary[1]:Enduse12[36]	= {	ResultSummary[3]:Enduse12[36]	   }
 	"Set ResultSummary[1]:Enduse13[36]"			Proj:ResultSummary[1]:Enduse13[36]	= {	ResultSummary[3]:Enduse13[36]	   }
END
;*************************************************************************   - SAC 6/25/13
RULELIST "CARes_RunResults_SetWorst_SrcEnergy_S" 1 0 1 1
;*************************************************************************
 	"Set ResultSummary[1]:EDR1DesignRating"			Proj:ResultSummary[1]:EDR1DesignRating		= {  ResultSummary[4]:EDR1DesignRating		}
 	"Set ResultSummary[1]:EDR1DesignRatingStd"		Proj:ResultSummary[1]:EDR1DesignRatingStd	= {  ResultSummary[4]:EDR1DesignRatingStd	}
  ; Proposed Src
	"Set ResultSummary[1]:Title1[31]"			Proj:ResultSummary[1]:Title1[31]		= {	ResultSummary[4]:Title1[31]		}
	"Set ResultSummary[1]:Title2[31]"			Proj:ResultSummary[1]:Title2[31]		= {	ResultSummary[4]:Title2[31]		}
	"Set ResultSummary[1]:Title3[31]"			Proj:ResultSummary[1]:Title3[31]		= {	ResultSummary[4]:Title3[31]	   }	
	"Set ResultSummary[1]:Enduse1[31]"			Proj:ResultSummary[1]:Enduse1[31]	= {	ResultSummary[4]:Enduse1[31]	   }
	"Set ResultSummary[1]:Enduse2[31]"			Proj:ResultSummary[1]:Enduse2[31]	= {	ResultSummary[4]:Enduse2[31]	   }
	"Set ResultSummary[1]:Enduse3[31]"			Proj:ResultSummary[1]:Enduse3[31]	= {	ResultSummary[4]:Enduse3[31]	   }
	"Set ResultSummary[1]:Enduse4[31]"			Proj:ResultSummary[1]:Enduse4[31]	= {	ResultSummary[4]:Enduse4[31]	   }
	"Set ResultSummary[1]:Enduse5[31]"			Proj:ResultSummary[1]:Enduse5[31]	= {	ResultSummary[4]:Enduse5[31]	   }
	"Set ResultSummary[1]:Enduse14[31]"			Proj:ResultSummary[1]:Enduse14[31]	= {	ResultSummary[4]:Enduse14[31]	   }
	"Set ResultSummary[1]:Enduse6[31]"			Proj:ResultSummary[1]:Enduse6[31]	= {	ResultSummary[4]:Enduse6[31]	   }
	"Set ResultSummary[1]:Enduse7[31]"			Proj:ResultSummary[1]:Enduse7[31]	= {	ResultSummary[4]:Enduse7[31]	   }
	"Set ResultSummary[1]:Enduse8[31]"			Proj:ResultSummary[1]:Enduse8[31]	= {	ResultSummary[4]:Enduse8[31]	   }
	"Set ResultSummary[1]:Enduse9[31]"			Proj:ResultSummary[1]:Enduse9[31]	= {	ResultSummary[4]:Enduse9[31]	   }
 	"Set ResultSummary[1]:Enduse10[31]"			Proj:ResultSummary[1]:Enduse10[31]	= {	ResultSummary[4]:Enduse10[31]	   }
 	"Set ResultSummary[1]:Enduse11[31]"			Proj:ResultSummary[1]:Enduse11[31]	= {	ResultSummary[4]:Enduse11[31]	   }
 	"Set ResultSummary[1]:Enduse12[31]"			Proj:ResultSummary[1]:Enduse12[31]	= {	ResultSummary[4]:Enduse12[31]	   }
 	"Set ResultSummary[1]:Enduse13[31]"			Proj:ResultSummary[1]:Enduse13[31]	= {	ResultSummary[4]:Enduse13[31]	   }
  ; Standard Src
	"Set ResultSummary[1]:Title1[32]"			Proj:ResultSummary[1]:Title1[32]		= {	ResultSummary[4]:Title1[32]		}
	"Set ResultSummary[1]:Title2[32]"			Proj:ResultSummary[1]:Title2[32]		= {	ResultSummary[4]:Title2[32]		}
	"Set ResultSummary[1]:Title3[32]"			Proj:ResultSummary[1]:Title3[32]		= {	ResultSummary[4]:Title3[32]		}
	"Set ResultSummary[1]:Enduse1[32]"			Proj:ResultSummary[1]:Enduse1[32]	= {	ResultSummary[4]:Enduse1[32]	   }
	"Set ResultSummary[1]:Enduse2[32]"			Proj:ResultSummary[1]:Enduse2[32]	= {	ResultSummary[4]:Enduse2[32]	   }
	"Set ResultSummary[1]:Enduse3[32]"			Proj:ResultSummary[1]:Enduse3[32]	= {	ResultSummary[4]:Enduse3[32]	   }
	"Set ResultSummary[1]:Enduse4[32]"			Proj:ResultSummary[1]:Enduse4[32]	= {	ResultSummary[4]:Enduse4[32]	   }
	"Set ResultSummary[1]:Enduse5[32]"			Proj:ResultSummary[1]:Enduse5[32]	= {	ResultSummary[4]:Enduse5[32]	   }
	"Set ResultSummary[1]:Enduse6[32]"			Proj:ResultSummary[1]:Enduse6[32]	= {	ResultSummary[4]:Enduse6[32]	   }
	"Set ResultSummary[1]:Enduse7[32]"			Proj:ResultSummary[1]:Enduse7[32]	= {	ResultSummary[4]:Enduse7[32]	   }
	"Set ResultSummary[1]:Enduse8[32]"			Proj:ResultSummary[1]:Enduse8[32]	= {	ResultSummary[4]:Enduse8[32]	   }
	"Set ResultSummary[1]:Enduse9[32]"			Proj:ResultSummary[1]:Enduse9[32]	= {	ResultSummary[4]:Enduse9[32]	   }
 	"Set ResultSummary[1]:Enduse10[32]"			Proj:ResultSummary[1]:Enduse10[32]	= {	ResultSummary[4]:Enduse10[32]	   }
 	"Set ResultSummary[1]:Enduse11[32]"			Proj:ResultSummary[1]:Enduse11[32]	= {	ResultSummary[4]:Enduse11[32]	   }
 	"Set ResultSummary[1]:Enduse12[32]"			Proj:ResultSummary[1]:Enduse12[32]	= {	ResultSummary[4]:Enduse12[32]	   }
	"Set ResultSummary[1]:Enduse13[32]"			Proj:ResultSummary[1]:Enduse13[32]	= {	ResultSummary[4]:Enduse13[32]	   }
	"Set ResultSummary[1]:Enduse14[32]"			Proj:ResultSummary[1]:Enduse14[32]	= {	ResultSummary[4]:Enduse14[32]	   }
  ; Compliance Margin Src
	"Set ResultSummary[1]:Title1[33]"			Proj:ResultSummary[1]:Title1[33]		= {	ResultSummary[4]:Title1[33]		}
	"Set ResultSummary[1]:Title2[33]"			Proj:ResultSummary[1]:Title2[33]		= {	ResultSummary[4]:Title2[33]		}
	"Set ResultSummary[1]:Title3[33]"			Proj:ResultSummary[1]:Title3[33]		= {	ResultSummary[4]:Title3[33]		}
	"Set ResultSummary[1]:Enduse1[33]"			Proj:ResultSummary[1]:Enduse1[33]	= {	ResultSummary[4]:Enduse1[33]	   }
	"Set ResultSummary[1]:Enduse2[33]"			Proj:ResultSummary[1]:Enduse2[33]	= {	ResultSummary[4]:Enduse2[33]	   }
	"Set ResultSummary[1]:Enduse3[33]"			Proj:ResultSummary[1]:Enduse3[33]	= {	ResultSummary[4]:Enduse3[33]	   }
	"Set ResultSummary[1]:Enduse4[33]"			Proj:ResultSummary[1]:Enduse4[33]	= {	ResultSummary[4]:Enduse4[33]	   }
	"Set ResultSummary[1]:Enduse5[33]"			Proj:ResultSummary[1]:Enduse5[33]	= {	ResultSummary[4]:Enduse5[33]	   }
	"Set ResultSummary[1]:Enduse14[33]"			Proj:ResultSummary[1]:Enduse14[33]	= {	ResultSummary[4]:Enduse14[33]	   }
	"Set ResultSummary[1]:Enduse6[33]"			Proj:ResultSummary[1]:Enduse6[33]	= {	ResultSummary[4]:Enduse6[33]	   }
	"Set ResultSummary[1]:Enduse7[33]"			Proj:ResultSummary[1]:Enduse7[33]	= {	ResultSummary[4]:Enduse7[33]	   }
	"Set ResultSummary[1]:Enduse8[33]"			Proj:ResultSummary[1]:Enduse8[33]	= {	ResultSummary[4]:Enduse8[33]	   }
	"Set ResultSummary[1]:Enduse9[33]"			Proj:ResultSummary[1]:Enduse9[33]	= {	ResultSummary[4]:Enduse9[33]	   }
 	"Set ResultSummary[1]:Enduse10[33]"			Proj:ResultSummary[1]:Enduse10[33]	= {	ResultSummary[4]:Enduse10[33]	   }
 	"Set ResultSummary[1]:Enduse11[33]"			Proj:ResultSummary[1]:Enduse11[33]	= {	ResultSummary[4]:Enduse11[33]	   }
 	"Set ResultSummary[1]:Enduse12[33]"			Proj:ResultSummary[1]:Enduse12[33]	= {	ResultSummary[4]:Enduse12[33]	   }
 	"Set ResultSummary[1]:Enduse13[33]"			Proj:ResultSummary[1]:Enduse13[33]	= {	ResultSummary[4]:Enduse13[33]	   }
  ; Design Rating Proposed Src
	"Set ResultSummary[1]:Title1[34]"			Proj:ResultSummary[1]:Title1[34]		= {	ResultSummary[4]:Title1[34]	 }	
	"Set ResultSummary[1]:Title2[34]"			Proj:ResultSummary[1]:Title2[34]		= {	ResultSummary[4]:Title2[34]	 }	
	"Set ResultSummary[1]:Title3[34]"			Proj:ResultSummary[1]:Title3[34]		= {	ResultSummary[4]:Title3[34]	 }	
	"Set ResultSummary[1]:Enduse1[34]"			Proj:ResultSummary[1]:Enduse1[34]	= {	ResultSummary[4]:Enduse1[34]	 }
	"Set ResultSummary[1]:Enduse2[34]"			Proj:ResultSummary[1]:Enduse2[34]	= {	ResultSummary[4]:Enduse2[34]	 }
	"Set ResultSummary[1]:Enduse3[34]"			Proj:ResultSummary[1]:Enduse3[34]	= {	ResultSummary[4]:Enduse3[34]	 }
	"Set ResultSummary[1]:Enduse4[34]"			Proj:ResultSummary[1]:Enduse4[34]	= {	ResultSummary[4]:Enduse4[34]	 }
	"Set ResultSummary[1]:Enduse5[34]"			Proj:ResultSummary[1]:Enduse5[34]	= {	ResultSummary[4]:Enduse5[34]	 }
	"Set ResultSummary[1]:Enduse6[34]"			Proj:ResultSummary[1]:Enduse6[34]	= {	ResultSummary[4]:Enduse6[34]	 }
	"Set ResultSummary[1]:Enduse7[34]"			Proj:ResultSummary[1]:Enduse7[34]	= {	ResultSummary[4]:Enduse7[34]	 }
	"Set ResultSummary[1]:Enduse8[34]"			Proj:ResultSummary[1]:Enduse8[34]	= {	ResultSummary[4]:Enduse8[34]	 }
	"Set ResultSummary[1]:Enduse9[34]"			Proj:ResultSummary[1]:Enduse9[34]	= {	ResultSummary[4]:Enduse9[34]	 }
	"Set ResultSummary[1]:Enduse10[34]"			Proj:ResultSummary[1]:Enduse10[34]	= {	ResultSummary[4]:Enduse10[34]	 }
	"Set ResultSummary[1]:Enduse11[34]"			Proj:ResultSummary[1]:Enduse11[34]	= {	ResultSummary[4]:Enduse11[34]	 }
	"Set ResultSummary[1]:Enduse12[34]"			Proj:ResultSummary[1]:Enduse12[34]	= {	ResultSummary[4]:Enduse12[34]	 }
	"Set ResultSummary[1]:Enduse13[34]"			Proj:ResultSummary[1]:Enduse13[34]	= {	ResultSummary[4]:Enduse13[34]	 }
	"Set ResultSummary[1]:Enduse14[34]"			Proj:ResultSummary[1]:Enduse14[34]	= {	ResultSummary[4]:Enduse14[34]	 }
  ; DesignRating Src
	"Set ResultSummary[1]:Title1[35]"			Proj:ResultSummary[1]:Title1[35]		= {	ResultSummary[4]:Title1[35]		}
	"Set ResultSummary[1]:Title2[35]"			Proj:ResultSummary[1]:Title2[35]		= {	ResultSummary[4]:Title2[35]		}
	"Set ResultSummary[1]:Title3[35]"			Proj:ResultSummary[1]:Title3[35]		= {	ResultSummary[4]:Title3[35]		}
	"Set ResultSummary[1]:Enduse1[35]"			Proj:ResultSummary[1]:Enduse1[35]	= {	ResultSummary[4]:Enduse1[35]	   }
	"Set ResultSummary[1]:Enduse2[35]"			Proj:ResultSummary[1]:Enduse2[35]	= {	ResultSummary[4]:Enduse2[35]	   }
	"Set ResultSummary[1]:Enduse3[35]"			Proj:ResultSummary[1]:Enduse3[35]	= {	ResultSummary[4]:Enduse3[35]	   }
	"Set ResultSummary[1]:Enduse4[35]"			Proj:ResultSummary[1]:Enduse4[35]	= {	ResultSummary[4]:Enduse4[35]	   }
	"Set ResultSummary[1]:Enduse5[35]"			Proj:ResultSummary[1]:Enduse5[35]	= {	ResultSummary[4]:Enduse5[35]	   }
	"Set ResultSummary[1]:Enduse14[35]"			Proj:ResultSummary[1]:Enduse14[35]	= {	ResultSummary[4]:Enduse14[35]	   }
	"Set ResultSummary[1]:Enduse6[35]"			Proj:ResultSummary[1]:Enduse6[35]	= {	ResultSummary[4]:Enduse6[35]	   }
	"Set ResultSummary[1]:Enduse7[35]"			Proj:ResultSummary[1]:Enduse7[35]	= {	ResultSummary[4]:Enduse7[35]	   }
	"Set ResultSummary[1]:Enduse8[35]"			Proj:ResultSummary[1]:Enduse8[35]	= {	ResultSummary[4]:Enduse8[35]	   }
	"Set ResultSummary[1]:Enduse9[35]"			Proj:ResultSummary[1]:Enduse9[35]	= {	ResultSummary[4]:Enduse9[35]	   }
 	"Set ResultSummary[1]:Enduse10[35]"			Proj:ResultSummary[1]:Enduse10[35]	= {	ResultSummary[4]:Enduse10[35]	   }
 	"Set ResultSummary[1]:Enduse11[35]"			Proj:ResultSummary[1]:Enduse11[35]	= {	ResultSummary[4]:Enduse11[35]	   }
 	"Set ResultSummary[1]:Enduse12[35]"			Proj:ResultSummary[1]:Enduse12[35]	= {	ResultSummary[4]:Enduse12[35]	   }
	"Set ResultSummary[1]:Enduse13[35]"			Proj:ResultSummary[1]:Enduse13[35]	= {	ResultSummary[4]:Enduse13[35]	   }
  ; DesignRating Margin Src
	"Set ResultSummary[1]:Title1[36]"			Proj:ResultSummary[1]:Title1[36]		= {	ResultSummary[4]:Title1[36]		}
	"Set ResultSummary[1]:Title2[36]"			Proj:ResultSummary[1]:Title2[36]		= {	ResultSummary[4]:Title2[36]		}
	"Set ResultSummary[1]:Title3[36]"			Proj:ResultSummary[1]:Title3[36]		= {	ResultSummary[4]:Title3[36]		}
	"Set ResultSummary[1]:Enduse1[36]"			Proj:ResultSummary[1]:Enduse1[36]	= {	ResultSummary[4]:Enduse1[36]	   }
	"Set ResultSummary[1]:Enduse2[36]"			Proj:ResultSummary[1]:Enduse2[36]	= {	ResultSummary[4]:Enduse2[36]	   }
	"Set ResultSummary[1]:Enduse3[36]"			Proj:ResultSummary[1]:Enduse3[36]	= {	ResultSummary[4]:Enduse3[36]	   }
	"Set ResultSummary[1]:Enduse4[36]"			Proj:ResultSummary[1]:Enduse4[36]	= {	ResultSummary[4]:Enduse4[36]	   }
	"Set ResultSummary[1]:Enduse5[36]"			Proj:ResultSummary[1]:Enduse5[36]	= {	ResultSummary[4]:Enduse5[36]	   }
	"Set ResultSummary[1]:Enduse14[36]"			Proj:ResultSummary[1]:Enduse14[36]	= {	ResultSummary[4]:Enduse14[36]	   }
	"Set ResultSummary[1]:Enduse6[36]"			Proj:ResultSummary[1]:Enduse6[36]	= {	ResultSummary[4]:Enduse6[36]	   }
	"Set ResultSummary[1]:Enduse7[36]"			Proj:ResultSummary[1]:Enduse7[36]	= {	ResultSummary[4]:Enduse7[36]	   }
	"Set ResultSummary[1]:Enduse8[36]"			Proj:ResultSummary[1]:Enduse8[36]	= {	ResultSummary[4]:Enduse8[36]	   }
	"Set ResultSummary[1]:Enduse9[36]"			Proj:ResultSummary[1]:Enduse9[36]	= {	ResultSummary[4]:Enduse9[36]	   }
 	"Set ResultSummary[1]:Enduse10[36]"			Proj:ResultSummary[1]:Enduse10[36]	= {	ResultSummary[4]:Enduse10[36]	   }
 	"Set ResultSummary[1]:Enduse11[36]"			Proj:ResultSummary[1]:Enduse11[36]	= {	ResultSummary[4]:Enduse11[36]	   }
 	"Set ResultSummary[1]:Enduse12[36]"			Proj:ResultSummary[1]:Enduse12[36]	= {	ResultSummary[4]:Enduse12[36]	   }
 	"Set ResultSummary[1]:Enduse13[36]"			Proj:ResultSummary[1]:Enduse13[36]	= {	ResultSummary[4]:Enduse13[36]	   }
END
;*************************************************************************   - SAC 6/25/13
RULELIST "CARes_RunResults_SetWorst_SrcEnergy_W" 1 0 1 1
;*************************************************************************
 	"Set ResultSummary[1]:EDR1DesignRating"			Proj:ResultSummary[1]:EDR1DesignRating		= {  ResultSummary[5]:EDR1DesignRating		}
 	"Set ResultSummary[1]:EDR1DesignRatingStd"		Proj:ResultSummary[1]:EDR1DesignRatingStd	= {  ResultSummary[5]:EDR1DesignRatingStd	}
  ; Proposed Src
	"Set ResultSummary[1]:Title1[31]"			Proj:ResultSummary[1]:Title1[31]		= {	ResultSummary[5]:Title1[31]		}
	"Set ResultSummary[1]:Title2[31]"			Proj:ResultSummary[1]:Title2[31]		= {	ResultSummary[5]:Title2[31]		}
	"Set ResultSummary[1]:Title3[31]"			Proj:ResultSummary[1]:Title3[31]		= {	ResultSummary[5]:Title3[31]	   }	
	"Set ResultSummary[1]:Enduse1[31]"			Proj:ResultSummary[1]:Enduse1[31]	= {	ResultSummary[5]:Enduse1[31]	   }
	"Set ResultSummary[1]:Enduse2[31]"			Proj:ResultSummary[1]:Enduse2[31]	= {	ResultSummary[5]:Enduse2[31]	   }
	"Set ResultSummary[1]:Enduse3[31]"			Proj:ResultSummary[1]:Enduse3[31]	= {	ResultSummary[5]:Enduse3[31]	   }
	"Set ResultSummary[1]:Enduse4[31]"			Proj:ResultSummary[1]:Enduse4[31]	= {	ResultSummary[5]:Enduse4[31]	   }
	"Set ResultSummary[1]:Enduse5[31]"			Proj:ResultSummary[1]:Enduse5[31]	= {	ResultSummary[5]:Enduse5[31]	   }
	"Set ResultSummary[1]:Enduse14[31]"			Proj:ResultSummary[1]:Enduse14[31]	= {	ResultSummary[5]:Enduse14[31]	   }
	"Set ResultSummary[1]:Enduse6[31]"			Proj:ResultSummary[1]:Enduse6[31]	= {	ResultSummary[5]:Enduse6[31]	   }
	"Set ResultSummary[1]:Enduse7[31]"			Proj:ResultSummary[1]:Enduse7[31]	= {	ResultSummary[5]:Enduse7[31]	   }
	"Set ResultSummary[1]:Enduse8[31]"			Proj:ResultSummary[1]:Enduse8[31]	= {	ResultSummary[5]:Enduse8[31]	   }
	"Set ResultSummary[1]:Enduse9[31]"			Proj:ResultSummary[1]:Enduse9[31]	= {	ResultSummary[5]:Enduse9[31]	   }
 	"Set ResultSummary[1]:Enduse10[31]"			Proj:ResultSummary[1]:Enduse10[31]	= {	ResultSummary[5]:Enduse10[31]	   }
 	"Set ResultSummary[1]:Enduse11[31]"			Proj:ResultSummary[1]:Enduse11[31]	= {	ResultSummary[5]:Enduse11[31]	   }
 	"Set ResultSummary[1]:Enduse12[31]"			Proj:ResultSummary[1]:Enduse12[31]	= {	ResultSummary[5]:Enduse12[31]	   }
 	"Set ResultSummary[1]:Enduse13[31]"			Proj:ResultSummary[1]:Enduse13[31]	= {	ResultSummary[5]:Enduse13[31]	   }
  ; Standard Src
	"Set ResultSummary[1]:Title1[32]"			Proj:ResultSummary[1]:Title1[32]		= {	ResultSummary[5]:Title1[32]		}
	"Set ResultSummary[1]:Title2[32]"			Proj:ResultSummary[1]:Title2[32]		= {	ResultSummary[5]:Title2[32]		}
	"Set ResultSummary[1]:Title3[32]"			Proj:ResultSummary[1]:Title3[32]		= {	ResultSummary[5]:Title3[32]		}
	"Set ResultSummary[1]:Enduse1[32]"			Proj:ResultSummary[1]:Enduse1[32]	= {	ResultSummary[5]:Enduse1[32]	   }
	"Set ResultSummary[1]:Enduse2[32]"			Proj:ResultSummary[1]:Enduse2[32]	= {	ResultSummary[5]:Enduse2[32]	   }
	"Set ResultSummary[1]:Enduse3[32]"			Proj:ResultSummary[1]:Enduse3[32]	= {	ResultSummary[5]:Enduse3[32]	   }
	"Set ResultSummary[1]:Enduse4[32]"			Proj:ResultSummary[1]:Enduse4[32]	= {	ResultSummary[5]:Enduse4[32]	   }
	"Set ResultSummary[1]:Enduse5[32]"			Proj:ResultSummary[1]:Enduse5[32]	= {	ResultSummary[5]:Enduse5[32]	   }
	"Set ResultSummary[1]:Enduse6[32]"			Proj:ResultSummary[1]:Enduse6[32]	= {	ResultSummary[5]:Enduse6[32]	   }
	"Set ResultSummary[1]:Enduse7[32]"			Proj:ResultSummary[1]:Enduse7[32]	= {	ResultSummary[5]:Enduse7[32]	   }
	"Set ResultSummary[1]:Enduse8[32]"			Proj:ResultSummary[1]:Enduse8[32]	= {	ResultSummary[5]:Enduse8[32]	   }
	"Set ResultSummary[1]:Enduse9[32]"			Proj:ResultSummary[1]:Enduse9[32]	= {	ResultSummary[5]:Enduse9[32]	   }
 	"Set ResultSummary[1]:Enduse10[32]"			Proj:ResultSummary[1]:Enduse10[32]	= {	ResultSummary[5]:Enduse10[32]	   }
 	"Set ResultSummary[1]:Enduse11[32]"			Proj:ResultSummary[1]:Enduse11[32]	= {	ResultSummary[5]:Enduse11[32]	   }
 	"Set ResultSummary[1]:Enduse12[32]"			Proj:ResultSummary[1]:Enduse12[32]	= {	ResultSummary[5]:Enduse12[32]	   }
	"Set ResultSummary[1]:Enduse13[32]"			Proj:ResultSummary[1]:Enduse13[32]	= {	ResultSummary[5]:Enduse13[32]	   }
	"Set ResultSummary[1]:Enduse14[32]"			Proj:ResultSummary[1]:Enduse14[32]	= {	ResultSummary[5]:Enduse14[32]	   }
  ; Compliance Margin Src
	"Set ResultSummary[1]:Title1[33]"			Proj:ResultSummary[1]:Title1[33]		= {	ResultSummary[5]:Title1[33]		}
	"Set ResultSummary[1]:Title2[33]"			Proj:ResultSummary[1]:Title2[33]		= {	ResultSummary[5]:Title2[33]		}
	"Set ResultSummary[1]:Title3[33]"			Proj:ResultSummary[1]:Title3[33]		= {	ResultSummary[5]:Title3[33]		}
	"Set ResultSummary[1]:Enduse1[33]"			Proj:ResultSummary[1]:Enduse1[33]	= {	ResultSummary[5]:Enduse1[33]	   }
	"Set ResultSummary[1]:Enduse2[33]"			Proj:ResultSummary[1]:Enduse2[33]	= {	ResultSummary[5]:Enduse2[33]	   }
	"Set ResultSummary[1]:Enduse3[33]"			Proj:ResultSummary[1]:Enduse3[33]	= {	ResultSummary[5]:Enduse3[33]	   }
	"Set ResultSummary[1]:Enduse4[33]"			Proj:ResultSummary[1]:Enduse4[33]	= {	ResultSummary[5]:Enduse4[33]	   }
	"Set ResultSummary[1]:Enduse5[33]"			Proj:ResultSummary[1]:Enduse5[33]	= {	ResultSummary[5]:Enduse5[33]	   }
	"Set ResultSummary[1]:Enduse14[33]"			Proj:ResultSummary[1]:Enduse14[33]	= {	ResultSummary[5]:Enduse14[33]	   }
	"Set ResultSummary[1]:Enduse6[33]"			Proj:ResultSummary[1]:Enduse6[33]	= {	ResultSummary[5]:Enduse6[33]	   }
	"Set ResultSummary[1]:Enduse7[33]"			Proj:ResultSummary[1]:Enduse7[33]	= {	ResultSummary[5]:Enduse7[33]	   }
	"Set ResultSummary[1]:Enduse8[33]"			Proj:ResultSummary[1]:Enduse8[33]	= {	ResultSummary[5]:Enduse8[33]	   }
	"Set ResultSummary[1]:Enduse9[33]"			Proj:ResultSummary[1]:Enduse9[33]	= {	ResultSummary[5]:Enduse9[33]	   }
 	"Set ResultSummary[1]:Enduse10[33]"			Proj:ResultSummary[1]:Enduse10[33]	= {	ResultSummary[5]:Enduse10[33]	   }
 	"Set ResultSummary[1]:Enduse11[33]"			Proj:ResultSummary[1]:Enduse11[33]	= {	ResultSummary[5]:Enduse11[33]	   }
 	"Set ResultSummary[1]:Enduse12[33]"			Proj:ResultSummary[1]:Enduse12[33]	= {	ResultSummary[5]:Enduse12[33]	   }
 	"Set ResultSummary[1]:Enduse13[33]"			Proj:ResultSummary[1]:Enduse13[33]	= {	ResultSummary[5]:Enduse13[33]	   }
  ; Design Rating Proposed Src
	"Set ResultSummary[1]:Title1[34]"			Proj:ResultSummary[1]:Title1[34]		= {	ResultSummary[5]:Title1[34]	 }	
	"Set ResultSummary[1]:Title2[34]"			Proj:ResultSummary[1]:Title2[34]		= {	ResultSummary[5]:Title2[34]	 }	
	"Set ResultSummary[1]:Title3[34]"			Proj:ResultSummary[1]:Title3[34]		= {	ResultSummary[5]:Title3[34]	 }	
	"Set ResultSummary[1]:Enduse1[34]"			Proj:ResultSummary[1]:Enduse1[34]	= {	ResultSummary[5]:Enduse1[34]	 }
	"Set ResultSummary[1]:Enduse2[34]"			Proj:ResultSummary[1]:Enduse2[34]	= {	ResultSummary[5]:Enduse2[34]	 }
	"Set ResultSummary[1]:Enduse3[34]"			Proj:ResultSummary[1]:Enduse3[34]	= {	ResultSummary[5]:Enduse3[34]	 }
	"Set ResultSummary[1]:Enduse4[34]"			Proj:ResultSummary[1]:Enduse4[34]	= {	ResultSummary[5]:Enduse4[34]	 }
	"Set ResultSummary[1]:Enduse5[34]"			Proj:ResultSummary[1]:Enduse5[34]	= {	ResultSummary[5]:Enduse5[34]	 }
	"Set ResultSummary[1]:Enduse6[34]"			Proj:ResultSummary[1]:Enduse6[34]	= {	ResultSummary[5]:Enduse6[34]	 }
	"Set ResultSummary[1]:Enduse7[34]"			Proj:ResultSummary[1]:Enduse7[34]	= {	ResultSummary[5]:Enduse7[34]	 }
	"Set ResultSummary[1]:Enduse8[34]"			Proj:ResultSummary[1]:Enduse8[34]	= {	ResultSummary[5]:Enduse8[34]	 }
	"Set ResultSummary[1]:Enduse9[34]"			Proj:ResultSummary[1]:Enduse9[34]	= {	ResultSummary[5]:Enduse9[34]	 }
	"Set ResultSummary[1]:Enduse10[34]"			Proj:ResultSummary[1]:Enduse10[34]	= {	ResultSummary[5]:Enduse10[34]	 }
	"Set ResultSummary[1]:Enduse11[34]"			Proj:ResultSummary[1]:Enduse11[34]	= {	ResultSummary[5]:Enduse11[34]	 }
	"Set ResultSummary[1]:Enduse12[34]"			Proj:ResultSummary[1]:Enduse12[34]	= {	ResultSummary[5]:Enduse12[34]	 }
	"Set ResultSummary[1]:Enduse13[34]"			Proj:ResultSummary[1]:Enduse13[34]	= {	ResultSummary[5]:Enduse13[34]	 }
	"Set ResultSummary[1]:Enduse14[34]"			Proj:ResultSummary[1]:Enduse14[34]	= {	ResultSummary[5]:Enduse14[34]	 }
  ; DesignRating Src
	"Set ResultSummary[1]:Title1[35]"			Proj:ResultSummary[1]:Title1[35]		= {	ResultSummary[5]:Title1[35]		}
	"Set ResultSummary[1]:Title2[35]"			Proj:ResultSummary[1]:Title2[35]		= {	ResultSummary[5]:Title2[35]		}
	"Set ResultSummary[1]:Title3[35]"			Proj:ResultSummary[1]:Title3[35]		= {	ResultSummary[5]:Title3[35]		}
	"Set ResultSummary[1]:Enduse1[35]"			Proj:ResultSummary[1]:Enduse1[35]	= {	ResultSummary[5]:Enduse1[35]	   }
	"Set ResultSummary[1]:Enduse2[35]"			Proj:ResultSummary[1]:Enduse2[35]	= {	ResultSummary[5]:Enduse2[35]	   }
	"Set ResultSummary[1]:Enduse3[35]"			Proj:ResultSummary[1]:Enduse3[35]	= {	ResultSummary[5]:Enduse3[35]	   }
	"Set ResultSummary[1]:Enduse4[35]"			Proj:ResultSummary[1]:Enduse4[35]	= {	ResultSummary[5]:Enduse4[35]	   }
	"Set ResultSummary[1]:Enduse5[35]"			Proj:ResultSummary[1]:Enduse5[35]	= {	ResultSummary[5]:Enduse5[35]	   }
	"Set ResultSummary[1]:Enduse14[35]"			Proj:ResultSummary[1]:Enduse14[35]	= {	ResultSummary[5]:Enduse14[35]	   }
	"Set ResultSummary[1]:Enduse6[35]"			Proj:ResultSummary[1]:Enduse6[35]	= {	ResultSummary[5]:Enduse6[35]	   }
	"Set ResultSummary[1]:Enduse7[35]"			Proj:ResultSummary[1]:Enduse7[35]	= {	ResultSummary[5]:Enduse7[35]	   }
	"Set ResultSummary[1]:Enduse8[35]"			Proj:ResultSummary[1]:Enduse8[35]	= {	ResultSummary[5]:Enduse8[35]	   }
	"Set ResultSummary[1]:Enduse9[35]"			Proj:ResultSummary[1]:Enduse9[35]	= {	ResultSummary[5]:Enduse9[35]	   }
 	"Set ResultSummary[1]:Enduse10[35]"			Proj:ResultSummary[1]:Enduse10[35]	= {	ResultSummary[5]:Enduse10[35]	   }
 	"Set ResultSummary[1]:Enduse11[35]"			Proj:ResultSummary[1]:Enduse11[35]	= {	ResultSummary[5]:Enduse11[35]	   }
 	"Set ResultSummary[1]:Enduse12[35]"			Proj:ResultSummary[1]:Enduse12[35]	= {	ResultSummary[5]:Enduse12[35]	   }
	"Set ResultSummary[1]:Enduse13[35]"			Proj:ResultSummary[1]:Enduse13[35]	= {	ResultSummary[5]:Enduse13[35]	   }
  ; DesignRating Margin Src
	"Set ResultSummary[1]:Title1[36]"			Proj:ResultSummary[1]:Title1[36]		= {	ResultSummary[5]:Title1[36]		}
	"Set ResultSummary[1]:Title2[36]"			Proj:ResultSummary[1]:Title2[36]		= {	ResultSummary[5]:Title2[36]		}
	"Set ResultSummary[1]:Title3[36]"			Proj:ResultSummary[1]:Title3[36]		= {	ResultSummary[5]:Title3[36]		}
	"Set ResultSummary[1]:Enduse1[36]"			Proj:ResultSummary[1]:Enduse1[36]	= {	ResultSummary[5]:Enduse1[36]	   }
	"Set ResultSummary[1]:Enduse2[36]"			Proj:ResultSummary[1]:Enduse2[36]	= {	ResultSummary[5]:Enduse2[36]	   }
	"Set ResultSummary[1]:Enduse3[36]"			Proj:ResultSummary[1]:Enduse3[36]	= {	ResultSummary[5]:Enduse3[36]	   }
	"Set ResultSummary[1]:Enduse4[36]"			Proj:ResultSummary[1]:Enduse4[36]	= {	ResultSummary[5]:Enduse4[36]	   }
	"Set ResultSummary[1]:Enduse5[36]"			Proj:ResultSummary[1]:Enduse5[36]	= {	ResultSummary[5]:Enduse5[36]	   }
	"Set ResultSummary[1]:Enduse14[36]"			Proj:ResultSummary[1]:Enduse14[36]	= {	ResultSummary[5]:Enduse14[36]	   }
	"Set ResultSummary[1]:Enduse6[36]"			Proj:ResultSummary[1]:Enduse6[36]	= {	ResultSummary[5]:Enduse6[36]	   }
	"Set ResultSummary[1]:Enduse7[36]"			Proj:ResultSummary[1]:Enduse7[36]	= {	ResultSummary[5]:Enduse7[36]	   }
	"Set ResultSummary[1]:Enduse8[36]"			Proj:ResultSummary[1]:Enduse8[36]	= {	ResultSummary[5]:Enduse8[36]	   }
	"Set ResultSummary[1]:Enduse9[36]"			Proj:ResultSummary[1]:Enduse9[36]	= {	ResultSummary[5]:Enduse9[36]	   }
 	"Set ResultSummary[1]:Enduse10[36]"			Proj:ResultSummary[1]:Enduse10[36]	= {	ResultSummary[5]:Enduse10[36]	   }
 	"Set ResultSummary[1]:Enduse11[36]"			Proj:ResultSummary[1]:Enduse11[36]	= {	ResultSummary[5]:Enduse11[36]	   }
 	"Set ResultSummary[1]:Enduse12[36]"			Proj:ResultSummary[1]:Enduse12[36]	= {	ResultSummary[5]:Enduse12[36]	   }
 	"Set ResultSummary[1]:Enduse13[36]"			Proj:ResultSummary[1]:Enduse13[36]	= {	ResultSummary[5]:Enduse13[36]	   }
END
;*************************************************************************


;************************************************************************* - SAC 4/10/17
RULELIST "CARes_ProposedSummary_SrcEnergy_ScalePV" 1 0 1 1
;*************************************************************************
; avoid RE-calculation of PropPVScaleFactor & NetSurpPVProduction - SAC 6/13/19
;   "Set PropPVScaleFactor"    Proj:ResultSummary[1]:PropPVScaleFactor  = {
;         (MaxPropPVRatio * (RunResults[10]:PropElecEnergy[1] - RunResults[13]:PropElecEnergy[1]))
;         / (-1 * RunResults[13]:PropElecEnergy[1])  }
;;"debugging"  Proj:Action = {  PostMessageToLog( "   Scaling PV: %g", ResultSummary[1]:PropPVScaleFactor )  }
;
;   ; SAC 4/30/17 - added NetSurpPVProduction to implement net surplus compensation
;   "Set Proj:ResultSummary[1]:NetSurpPVProduction"   Proj:ResultSummary[1]:NetSurpPVProduction  = {
;         (-1 * RunResults[13]:PropElecEnergy[1] * ValidOr( CondFloorArea, 0 ) / 3.412) * (1 - ResultSummary[1]:PropPVScaleFactor)  }

   ; then REMOVE effect of PV on Totals
   "Subtrct PV frm Elec   - Total"   Proj:RunResults[10]:PropElecSrc[1]      = {  RunResults[10]:PropElecSrc[1]     - RunResults[13]:PropElecSrc[1]      }  ; - RunResults[14]:PropElecSrc[1]      }
   "Subtrct PV frm TOTAL  - Total"   Proj:RunResults[10]:ProposedSrc[1]      = {  RunResults[10]:ProposedSrc[1]     - RunResults[13]:ProposedSrc[1]      }  ; - RunResults[14]:ProposedSrc[1]      }

   ; apply PV scaling factor
   "Scale Src - Elec   - PV"              Proj:RunResults[13]:PropElecSrc[1]      = {  ResultSummary[1]:PropPVScaleFactor * RunResults[13]:PropElecSrc[1]      }
   "Scale Src - TOTAL  - PV"              Proj:RunResults[13]:ProposedSrc[1]      = {  ResultSummary[1]:PropPVScaleFactor * RunResults[13]:ProposedSrc[1]      }
;   "Scale Src - Elec   - Battery"         Proj:RunResults[14]:PropElecSrc[1]      = {  ResultSummary[1]:PropPVScaleFactor * RunResults[14]:PropElecSrc[1]      }
;   "Scale Src - TOTAL  - Battery"         Proj:RunResults[14]:ProposedSrc[1]      = {  ResultSummary[1]:PropPVScaleFactor * RunResults[14]:ProposedSrc[1]      }

   ; apply Net Surplus Compensation to PV Src results
;"debugging"  Proj:Action = {  if (IfValidAnd( NetEnergyMeteringNSCSrcAdj > 0 )==0 .OR. IfValidAnd( ResultSummary[1]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
;                              else  PostMessageToLog( "   NSC adjustment of %g (%g * %g) to scaled PV Src of %g", ResultSummary[1]:NetSurpPVProduction * NetEnergyMeteringNSCSrcAdj, ResultSummary[1]:NetSurpPVProduction, NetEnergyMeteringNSCSrcAdj, (RunResults[13]:PropElecSrc[1] * CondFloorArea) )  endif  }
   "Add NSC to Src - Elec   - PV"   Proj:RunResults[13]:PropElecSrc[1]  = {
         if (IfValidAnd( NetEnergyMeteringNSCSrcAdj > 0 )==0 .OR.
             IfValidAnd( ResultSummary[1]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
         else  RunResults[13]:PropElecSrc[1] - (ResultSummary[1]:NetSurpPVProduction * NetEnergyMeteringNSCSrcAdj / CondFloorArea)  endif  }
   "Add NSC to Src - TOTAL  - PV"   Proj:RunResults[13]:ProposedSrc[1]  = {
         if (IfValidAnd( NetEnergyMeteringNSCSrcAdj > 0 )==0 .OR.
             IfValidAnd( ResultSummary[1]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
         else  RunResults[13]:ProposedSrc[1] - (ResultSummary[1]:NetSurpPVProduction * NetEnergyMeteringNSCSrcAdj / CondFloorArea)  endif  }

   ; RE-apply PV to Totals
   "Restore PV to Elec   - Total"    Proj:RunResults[10]:PropElecSrc[1]      = {  RunResults[10]:PropElecSrc[1]     + RunResults[13]:PropElecSrc[1]      }  ; + RunResults[14]:PropElecSrc[1]      }
   "Restore PV to TOTAL  - Total"    Proj:RunResults[10]:ProposedSrc[1]      = {  RunResults[10]:ProposedSrc[1]     + RunResults[13]:ProposedSrc[1]      }  ; + RunResults[14]:ProposedSrc[1]      }
END

;************************************************************************* - SAC 6/13/17 - based on 'CARes_ProposedSummary_ScalePV'
RULELIST "CARes_ProposedSummary_SrcEnergy_N_ScalePV" 1 0 1 1
;*************************************************************************
; avoid RE-calculation of PropPVScaleFactor & NetSurpPVProduction - SAC 6/13/19
;   "Set PropPVScaleFactor (N)"    Proj:ResultSummary[2]:PropPVScaleFactor  = {
;         (MaxPropPVRatio * (RunResultsN[10]:PropElecEnergy[1] - RunResultsN[13]:PropElecEnergy[1]))
;         / (-1 * RunResultsN[13]:PropElecEnergy[1])  }
;;"debugging"  Proj:Action = {  PostMessageToLog( "   N: Scaling PV: %g", ResultSummary[2]:PropPVScaleFactor )  }
;
;   ; SAC 4/30/17 - added NetSurpPVProduction to implement net surplus compensation
;   "Set Proj:ResultSummary[2]:NetSurpPVProduction (N)"   Proj:ResultSummary[2]:NetSurpPVProduction  = {
;         (-1 * RunResultsN[13]:PropElecEnergy[1] * ValidOr( CondFloorArea, 0 ) / 3.412) * (1 - ResultSummary[2]:PropPVScaleFactor)  }

   ; then REMOVE effect of PV on Totals
   "Subtrct PV frm Elec   - Total (N)"   Proj:RunResultsN[10]:PropElecSrc[1]      = {  RunResultsN[10]:PropElecSrc[1]     - RunResultsN[13]:PropElecSrc[1]      }  ; - RunResultsN[14]:PropElecSrc[1]      }
   "Subtrct PV frm TOTAL  - Total (N)"   Proj:RunResultsN[10]:ProposedSrc[1]      = {  RunResultsN[10]:ProposedSrc[1]     - RunResultsN[13]:ProposedSrc[1]      }  ; - RunResultsN[14]:ProposedSrc[1]      }

   ; apply PV scaling factor
   "Scale Src - Elec   - PV (N)"              Proj:RunResultsN[13]:PropElecSrc[1]      = {  ResultSummary[2]:PropPVScaleFactor * RunResultsN[13]:PropElecSrc[1]      }
   "Scale Src - TOTAL  - PV (N)"              Proj:RunResultsN[13]:ProposedSrc[1]      = {  ResultSummary[2]:PropPVScaleFactor * RunResultsN[13]:ProposedSrc[1]      }
;   "Scale Src - Elec   - Battery (N)"         Proj:RunResultsN[14]:PropElecSrc[1]      = {  ResultSummary[2]:PropPVScaleFactor * RunResultsN[14]:PropElecSrc[1]      }
;   "Scale Src - TOTAL  - Battery (N)"         Proj:RunResultsN[14]:ProposedSrc[1]      = {  ResultSummary[2]:PropPVScaleFactor * RunResultsN[14]:ProposedSrc[1]      }

   ; apply Net Surplus Compensation to PV Src results
;"debugging"  Proj:Action = {  if (IfValidAnd( NetEnergyMeteringNSCSrcAdj > 0 )==0 .OR. IfValidAnd( ResultSummary[2]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
;                              else  PostMessageToLog( "   N: NSC adjustment of %g (%g * %g) to scaled PV Src of %g", ResultSummary[2]:NetSurpPVProduction * NetEnergyMeteringNSCSrcAdj, ResultSummary[2]:NetSurpPVProduction, NetEnergyMeteringNSCSrcAdj, (RunResultsN[13]:PropElecSrc[1] * CondFloorArea) )  endif  }
   "Add NSC to Src - Elec   - PV (N)"   Proj:RunResultsN[13]:PropElecSrc[1]  = {
         if (IfValidAnd( NetEnergyMeteringNSCSrcAdj > 0 )==0 .OR.
             IfValidAnd( ResultSummary[2]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
         else  RunResultsN[13]:PropElecSrc[1] - (ResultSummary[2]:NetSurpPVProduction * NetEnergyMeteringNSCSrcAdj / CondFloorArea)  endif  }
   "Add NSC to Src - TOTAL  - PV (N)"   Proj:RunResultsN[13]:ProposedSrc[1]  = {
         if (IfValidAnd( NetEnergyMeteringNSCSrcAdj > 0 )==0 .OR.
             IfValidAnd( ResultSummary[2]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
         else  RunResultsN[13]:ProposedSrc[1] - (ResultSummary[2]:NetSurpPVProduction * NetEnergyMeteringNSCSrcAdj / CondFloorArea)  endif  }

   ; RE-apply PV to Totals
   "Restore PV to Elec   - Total (N)"    Proj:RunResultsN[10]:PropElecSrc[1]      = {  RunResultsN[10]:PropElecSrc[1]     + RunResultsN[13]:PropElecSrc[1]      }  ; + RunResultsN[14]:PropElecSrc[1]      }
   "Restore PV to TOTAL  - Total (N)"    Proj:RunResultsN[10]:ProposedSrc[1]      = {  RunResultsN[10]:ProposedSrc[1]     + RunResultsN[13]:ProposedSrc[1]      }  ; + RunResultsN[14]:ProposedSrc[1]      }
END
;************************************************************************* - SAC 6/13/17 - based on 'CARes_ProposedSummary_ScalePV'
RULELIST "CARes_ProposedSummary_SrcEnergy_E_ScalePV" 1 0 1 1
;*************************************************************************
; avoid RE-calculation of PropPVScaleFactor & NetSurpPVProduction - SAC 6/13/19
;   "Set PropPVScaleFactor (E)"    Proj:ResultSummary[3]:PropPVScaleFactor  = {
;         (MaxPropPVRatio * (RunResultsE[10]:PropElecEnergy[1] - RunResultsE[13]:PropElecEnergy[1]))
;         / (-1 * RunResultsE[13]:PropElecEnergy[1])  }
;;"debugging"  Proj:Action = {  PostMessageToLog( "   E: Scaling PV: %g", ResultSummary[3]:PropPVScaleFactor )  }
;
;   ; SAC 4/30/17 - added NetSurpPVProduction to implement net surplus compensation
;   "Set Proj:ResultSummary[3]:NetSurpPVProduction (E)"   Proj:ResultSummary[3]:NetSurpPVProduction  = {
;         (-1 * RunResultsE[13]:PropElecEnergy[1] * ValidOr( CondFloorArea, 0 ) / 3.412) * (1 - ResultSummary[3]:PropPVScaleFactor)  }

   ; then REMOVE effect of PV on Totals
   "Subtrct PV frm Elec   - Total (E)"   Proj:RunResultsE[10]:PropElecSrc[1]      = {  RunResultsE[10]:PropElecSrc[1]     - RunResultsE[13]:PropElecSrc[1]      }  ; - RunResultsE[14]:PropElecSrc[1]      }
   "Subtrct PV frm TOTAL  - Total (E)"   Proj:RunResultsE[10]:ProposedSrc[1]      = {  RunResultsE[10]:ProposedSrc[1]     - RunResultsE[13]:ProposedSrc[1]      }  ; - RunResultsE[14]:ProposedSrc[1]      }

   ; apply PV scaling factor
   "Scale Src - Elec   - PV (E)"              Proj:RunResultsE[13]:PropElecSrc[1]      = {  ResultSummary[3]:PropPVScaleFactor * RunResultsE[13]:PropElecSrc[1]      }
   "Scale Src - TOTAL  - PV (E)"              Proj:RunResultsE[13]:ProposedSrc[1]      = {  ResultSummary[3]:PropPVScaleFactor * RunResultsE[13]:ProposedSrc[1]      }
;   "Scale Src - Elec   - Battery (E)"         Proj:RunResultsE[14]:PropElecSrc[1]      = {  ResultSummary[3]:PropPVScaleFactor * RunResultsE[14]:PropElecSrc[1]      }
;   "Scale Src - TOTAL  - Battery (E)"         Proj:RunResultsE[14]:ProposedSrc[1]      = {  ResultSummary[3]:PropPVScaleFactor * RunResultsE[14]:ProposedSrc[1]      }

   ; apply Net Surplus Compensation to PV Src results
;"debugging"  Proj:Action = {  if (IfValidAnd( NetEnergyMeteringNSCSrcAdj > 0 )==0 .OR. IfValidAnd( ResultSummary[3]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
;                              else  PostMessageToLog( "   E: NSC adjustment of %g (%g * %g) to scaled PV Src of %g", ResultSummary[3]:NetSurpPVProduction * NetEnergyMeteringNSCSrcAdj, ResultSummary[3]:NetSurpPVProduction, NetEnergyMeteringNSCSrcAdj, (RunResultsE[13]:PropElecSrc[1] * CondFloorArea) )  endif  }
   "Add NSC to Src - Elec   - PV (E)"   Proj:RunResultsE[13]:PropElecSrc[1]  = {
         if (IfValidAnd( NetEnergyMeteringNSCSrcAdj > 0 )==0 .OR.
             IfValidAnd( ResultSummary[3]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
         else  RunResultsE[13]:PropElecSrc[1] - (ResultSummary[3]:NetSurpPVProduction * NetEnergyMeteringNSCSrcAdj / CondFloorArea)  endif  }
   "Add NSC to Src - TOTAL  - PV (E)"   Proj:RunResultsE[13]:ProposedSrc[1]  = {
         if (IfValidAnd( NetEnergyMeteringNSCSrcAdj > 0 )==0 .OR.
             IfValidAnd( ResultSummary[3]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
         else  RunResultsE[13]:ProposedSrc[1] - (ResultSummary[3]:NetSurpPVProduction * NetEnergyMeteringNSCSrcAdj / CondFloorArea)  endif  }

   ; RE-apply PV to Totals
   "Restore PV to Elec   - Total (E)"    Proj:RunResultsE[10]:PropElecSrc[1]      = {  RunResultsE[10]:PropElecSrc[1]     + RunResultsE[13]:PropElecSrc[1]      }  ; + RunResultsE[14]:PropElecSrc[1]      }
   "Restore PV to TOTAL  - Total (E)"    Proj:RunResultsE[10]:ProposedSrc[1]      = {  RunResultsE[10]:ProposedSrc[1]     + RunResultsE[13]:ProposedSrc[1]      }  ; + RunResultsE[14]:ProposedSrc[1]      }
END

;************************************************************************* - SAC 6/13/17 - based on 'CARes_ProposedSummary_ScalePV'
RULELIST "CARes_ProposedSummary_SrcEnergy_S_ScalePV" 1 0 1 1
;*************************************************************************
; avoid RE-calculation of PropPVScaleFactor & NetSurpPVProduction - SAC 6/13/19
;   "Set PropPVScaleFactor (S)"    Proj:ResultSummary[4]:PropPVScaleFactor  = {
;         (MaxPropPVRatio * (RunResultsS[10]:PropElecEnergy[1] - RunResultsS[13]:PropElecEnergy[1]))
;         / (-1 * RunResultsS[13]:PropElecEnergy[1])  }
;;"debugging"  Proj:Action = {  PostMessageToLog( "   S: Scaling PV: %g", ResultSummary[4]:PropPVScaleFactor )  }
;
;   ; SAC 4/30/17 - added NetSurpPVProduction to implement net surplus compensation
;   "Set Proj:ResultSummary[4]:NetSurpPVProduction (S)"   Proj:ResultSummary[4]:NetSurpPVProduction  = {
;         (-1 * RunResultsS[13]:PropElecEnergy[1] * ValidOr( CondFloorArea, 0 ) / 3.412) * (1 - ResultSummary[4]:PropPVScaleFactor)  }

   ; then REMOVE effect of PV on Totals
   "Subtrct PV frm Elec   - Total (S)"   Proj:RunResultsS[10]:PropElecSrc[1]      = {  RunResultsS[10]:PropElecSrc[1]     - RunResultsS[13]:PropElecSrc[1]      }  ; - RunResultsS[14]:PropElecSrc[1]      }
   "Subtrct PV frm TOTAL  - Total (S)"   Proj:RunResultsS[10]:ProposedSrc[1]      = {  RunResultsS[10]:ProposedSrc[1]     - RunResultsS[13]:ProposedSrc[1]      }  ; - RunResultsS[14]:ProposedSrc[1]      }

   ; apply PV scaling factor
   "Scale Src - Elec   - PV (S)"              Proj:RunResultsS[13]:PropElecSrc[1]      = {  ResultSummary[4]:PropPVScaleFactor * RunResultsS[13]:PropElecSrc[1]      }
   "Scale Src - TOTAL  - PV (S)"              Proj:RunResultsS[13]:ProposedSrc[1]      = {  ResultSummary[4]:PropPVScaleFactor * RunResultsS[13]:ProposedSrc[1]      }
;   "Scale Src - Elec   - Battery (S)"         Proj:RunResultsS[14]:PropElecSrc[1]      = {  ResultSummary[4]:PropPVScaleFactor * RunResultsS[14]:PropElecSrc[1]      }
;   "Scale Src - TOTAL  - Battery (S)"         Proj:RunResultsS[14]:ProposedSrc[1]      = {  ResultSummary[4]:PropPVScaleFactor * RunResultsS[14]:ProposedSrc[1]      }

   ; apply Net Surplus Compensation to PV Src results
;"debugging"  Proj:Action = {  if (IfValidAnd( NetEnergyMeteringNSCSrcAdj > 0 )==0 .OR. IfValidAnd( ResultSummary[4]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
;                              else  PostMessageToLog( "   S: NSC adjustment of %g (%g * %g) to scaled PV Src of %g", ResultSummary[4]:NetSurpPVProduction * NetEnergyMeteringNSCSrcAdj, ResultSummary[4]:NetSurpPVProduction, NetEnergyMeteringNSCSrcAdj, (RunResultsS[13]:PropElecSrc[1] * CondFloorArea) )  endif  }
   "Add NSC to Src - Elec   - PV (S)"   Proj:RunResultsS[13]:PropElecSrc[1]  = {
         if (IfValidAnd( NetEnergyMeteringNSCSrcAdj > 0 )==0 .OR.
             IfValidAnd( ResultSummary[4]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
         else  RunResultsS[13]:PropElecSrc[1] - (ResultSummary[4]:NetSurpPVProduction * NetEnergyMeteringNSCSrcAdj / CondFloorArea)  endif  }
   "Add NSC to Src - TOTAL  - PV (S)"   Proj:RunResultsS[13]:ProposedSrc[1]  = {
         if (IfValidAnd( NetEnergyMeteringNSCSrcAdj > 0 )==0 .OR.
             IfValidAnd( ResultSummary[4]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
         else  RunResultsS[13]:ProposedSrc[1] - (ResultSummary[4]:NetSurpPVProduction * NetEnergyMeteringNSCSrcAdj / CondFloorArea)  endif  }

   ; RE-apply PV to Totals
   "Restore PV to Elec   - Total (S)"    Proj:RunResultsS[10]:PropElecSrc[1]      = {  RunResultsS[10]:PropElecSrc[1]     + RunResultsS[13]:PropElecSrc[1]      }  ; + RunResultsS[14]:PropElecSrc[1]      }
   "Restore PV to TOTAL  - Total (S)"    Proj:RunResultsS[10]:ProposedSrc[1]      = {  RunResultsS[10]:ProposedSrc[1]     + RunResultsS[13]:ProposedSrc[1]      }  ; + RunResultsS[14]:ProposedSrc[1]      }
END

;************************************************************************* - SAC 6/13/17 - based on 'CARes_ProposedSummary_ScalePV'
RULELIST "CARes_ProposedSummary_SrcEnergy_W_ScalePV" 1 0 1 1
;*************************************************************************
; avoid RE-calculation of PropPVScaleFactor & NetSurpPVProduction - SAC 6/13/19
;   "Set PropPVScaleFactor (W)"    Proj:ResultSummary[5]:PropPVScaleFactor  = {
;         (MaxPropPVRatio * (RunResultsW[10]:PropElecEnergy[1] - RunResultsW[13]:PropElecEnergy[1]))
;         / (-1 * RunResultsW[13]:PropElecEnergy[1])  }
;;"debugging"  Proj:Action = {  PostMessageToLog( "   W: Scaling PV: %g", ResultSummary[5]:PropPVScaleFactor )  }
;
;   ; SAC 4/30/17 - added NetSurpPVProduction to implement net surplus compensation
;   "Set Proj:ResultSummary[5]:NetSurpPVProduction (W)"   Proj:ResultSummary[5]:NetSurpPVProduction  = {
;         (-1 * RunResultsW[13]:PropElecEnergy[1] * ValidOr( CondFloorArea, 0 ) / 3.412) * (1 - ResultSummary[5]:PropPVScaleFactor)  }

   ; then REMOVE effect of PV on Totals
   "Subtrct PV frm Elec   - Total (W)"   Proj:RunResultsW[10]:PropElecSrc[1]      = {  RunResultsW[10]:PropElecSrc[1]     - RunResultsW[13]:PropElecSrc[1]      }  ; - RunResultsW[14]:PropElecSrc[1]      }
   "Subtrct PV frm TOTAL  - Total (W)"   Proj:RunResultsW[10]:ProposedSrc[1]      = {  RunResultsW[10]:ProposedSrc[1]     - RunResultsW[13]:ProposedSrc[1]      }  ; - RunResultsW[14]:ProposedSrc[1]      }

   ; apply PV scaling factor
   "Scale Src - Elec   - PV (W)"              Proj:RunResultsW[13]:PropElecSrc[1]      = {  ResultSummary[5]:PropPVScaleFactor * RunResultsW[13]:PropElecSrc[1]      }
   "Scale Src - TOTAL  - PV (W)"              Proj:RunResultsW[13]:ProposedSrc[1]      = {  ResultSummary[5]:PropPVScaleFactor * RunResultsW[13]:ProposedSrc[1]      }
;   "Scale Src - Elec   - Battery (W)"         Proj:RunResultsW[14]:PropElecSrc[1]      = {  ResultSummary[5]:PropPVScaleFactor * RunResultsW[14]:PropElecSrc[1]      }
;   "Scale Src - TOTAL  - Battery (W)"         Proj:RunResultsW[14]:ProposedSrc[1]      = {  ResultSummary[5]:PropPVScaleFactor * RunResultsW[14]:ProposedSrc[1]      }

   ; apply Net Surplus Compensation to PV Src results
;"debugging"  Proj:Action = {  if (IfValidAnd( NetEnergyMeteringNSCSrcAdj > 0 )==0 .OR. IfValidAnd( ResultSummary[5]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
;                              else  PostMessageToLog( "   W: NSC adjustment of %g (%g * %g) to scaled PV Src of %g", ResultSummary[5]:NetSurpPVProduction * NetEnergyMeteringNSCSrcAdj, ResultSummary[5]:NetSurpPVProduction, NetEnergyMeteringNSCSrcAdj, (RunResultsW[13]:PropElecSrc[1] * CondFloorArea) )  endif  }
   "Add NSC to Src - Elec   - PV (W)"   Proj:RunResultsW[13]:PropElecSrc[1]  = {
         if (IfValidAnd( NetEnergyMeteringNSCSrcAdj > 0 )==0 .OR.
             IfValidAnd( ResultSummary[5]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
         else  RunResultsW[13]:PropElecSrc[1] - (ResultSummary[5]:NetSurpPVProduction * NetEnergyMeteringNSCSrcAdj / CondFloorArea)  endif  }
   "Add NSC to Src - TOTAL  - PV (W)"   Proj:RunResultsW[13]:ProposedSrc[1]  = {
         if (IfValidAnd( NetEnergyMeteringNSCSrcAdj > 0 )==0 .OR.
             IfValidAnd( ResultSummary[5]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
         else  RunResultsW[13]:ProposedSrc[1] - (ResultSummary[5]:NetSurpPVProduction * NetEnergyMeteringNSCSrcAdj / CondFloorArea)  endif  }

   ; RE-apply PV to Totals
   "Restore PV to Elec   - Total (W)"    Proj:RunResultsW[10]:PropElecSrc[1]      = {  RunResultsW[10]:PropElecSrc[1]     + RunResultsW[13]:PropElecSrc[1]      }  ; + RunResultsW[14]:PropElecSrc[1]      }
   "Restore PV to TOTAL  - Total (W)"    Proj:RunResultsW[10]:ProposedSrc[1]      = {  RunResultsW[10]:ProposedSrc[1]     + RunResultsW[13]:ProposedSrc[1]      }  ; + RunResultsW[14]:ProposedSrc[1]      }
END
;*************************************************************************


;*************************************************************************
RULELIST "CARes_SourceEnergySummary" 1 0 1 1
;*************************************************************************

 	"Set ResultSummary[1]:EDR1DesignRating"			Proj:ResultSummary[1]:EDR1DesignRating		= {
         if (IfValidAnd( RunResults[10]:DesignRatingSrc[2] != 0 )==0) then  UNDEFINED
      ;   else if (LocalStatus( ResultSummary[1]:PFlxSrc[2] ) > 0 .AND. LocalStatus( RunResults[11]:ProposedSrc[3] ) > 0)
      ;   then   int( ((ResultSummary[1]:PFlxSrc[2] +
      ;                 ValidOr( RunResults[10]:ProposedSrc[3], 0 )) * 1000 / RunResults[10]:DesignRatingSrc[2])+0.5 )/10
         else   int( ( ValidOr( RunResults[10]:ProposedSrc[3], 0 )  * 1000 / RunResults[10]:DesignRatingSrc[2])+0.5 )/10
         endif  }  ; endif  }
 	"Set ResultSummary[1]:EDR1DesignRatingStd"		Proj:ResultSummary[1]:EDR1DesignRatingStd		= {
         if (IfValidAnd( RunResults[10]:DesignRatingSrc[2] != 0 )==0 .OR.
             AnalysisType < 3) then  UNDEFINED
			else	int( ((	RunResults[1]:StdElecSrc[1] + RunResults[1]:StdNatGasSrc + RunResults[1]:StdOtherSrc +  ; SpcHt
      					 +	RunResults[2]:StdElecSrc[1] + RunResults[2]:StdNatGasSrc + RunResults[2]:StdOtherSrc +  ; SpcCl
      					 +	RunResults[3]:StdElecSrc[1]    ; IAQVent
		      			 +	RunResults[4]:StandardSrc[1]   ; OthrHVAC
      					 +	RunResults[5]:StdElecSrc[1] + RunResults[5]:StdNatGasSrc + RunResults[5]:StdOtherSrc +  ; WtrHt
		      			 +	RunResults[6]:StandardSrc[1]   ; InsLtg
      					 +	RunResults[7]:StdElecSrc[1] + RunResults[7]:StdNatGasSrc + RunResults[7]:StdOtherSrc +  ; AppCkg
		      			 +	RunResults[8]:StandardSrc[1]   ; Plugs
				      	 +	RunResults[9]:StandardSrc[1]   ; Ext
      					 +	RunResults[13]:StandardSrc[1]   ; PV
		      			 +	RunResults[14]:StandardSrc[1] ) ; Battery
				      			* 1000 / RunResults[10]:DesignRatingSrc[2])+0.5 )/10    endif  }

  ; Proposed Src
	"Set ResultSummary[1]:Title1[31]"				Proj:ResultSummary[1]:Title1[31]		= {	if (EnergyCodeYearNum < 2022) then  "Proposed"       else  UNDEFINED        endif  }
	"Set ResultSummary[1]:Title2[31]"				Proj:ResultSummary[1]:Title2[31]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "EDR1"  else  "Source"  endif endif  }   ; SAC 11/24/22
	"Set ResultSummary[1]:Title3[31]"				Proj:ResultSummary[1]:Title3[31]		= {	if (EnergyCodeYearNum < 2022) then  "(kBtu/ft-yr)"  else  "(kBtu/ft-yr)"  endif  }
	"Set ResultSummary[1]:Enduse1[31]"			Proj:ResultSummary[1]:Enduse1[31]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[1]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[1]:Enduse2[31]"			Proj:ResultSummary[1]:Enduse2[31]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[2]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[1]:Enduse3[31]"			Proj:ResultSummary[1]:Enduse3[31]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[3]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[1]:Enduse4[31]"			Proj:ResultSummary[1]:Enduse4[31]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[4]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[1]:Enduse5[31]"			Proj:ResultSummary[1]:Enduse5[31]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[5]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[1]:Enduse14[31]"			Proj:ResultSummary[1]:Enduse14[31]	= {	if (LocalCompAssigned( RunResults[14] ) == 0) then  UNDEFINED  else  FltToStr( RunResults[14]:ProposedSrc[1], 2 )  endif  }
	"Set ResultSummary[1]:Enduse6[31]"			Proj:ResultSummary[1]:Enduse6[31]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[6]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[1]:Enduse7[31]"			Proj:ResultSummary[1]:Enduse7[31]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[7]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[1]:Enduse8[31]"			Proj:ResultSummary[1]:Enduse8[31]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[8]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[1]:Enduse9[31]"			Proj:ResultSummary[1]:Enduse9[31]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[9]:ProposedSrc[1] , 2 )  endif  }
 	"Set ResultSummary[1]:Enduse10[31]"			Proj:ResultSummary[1]:Enduse10[31]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( RunResults[10]:ProposedSrc[1], 2 )  endif  }
 	"Set ResultSummary[1]:Enduse11[31]"			Proj:ResultSummary[1]:Enduse11[31]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( RunResults[11]:ProposedSrc[1], 2 )  endif  }
 	"Set ResultSummary[1]:Enduse12[31]"			Proj:ResultSummary[1]:Enduse12[31]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( RunResults[12]:ProposedSrc[1], 2 )  endif  }
 	"Set ResultSummary[1]:Enduse13[31]"			Proj:ResultSummary[1]:Enduse13[31]	= {	if (LocalCompAssigned( RunResults[13] ) == 0) then  UNDEFINED  else  FltToStr( RunResults[13]:ProposedSrc[1], 2 )  endif  }

  ; Standard Src
	"Set ResultSummary[1]:Title1[32]"				Proj:ResultSummary[1]:Title1[32]		= {	if (EnergyCodeYearNum < 2022) then  "Standard"       else  UNDEFINED        endif  }
	"Set ResultSummary[1]:Title2[32]"				Proj:ResultSummary[1]:Title2[32]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "EDR1"  else  "Source"  endif endif  }   ; SAC 11/23/22
	"Set ResultSummary[1]:Title3[32]"				Proj:ResultSummary[1]:Title3[32]		= {	if (EnergyCodeYearNum < 2022) then  "(kBtu/ft-yr)"  else  "(kBtu/ft-yr)"  endif  }
	"Set ResultSummary[1]:Enduse1[32]"			Proj:ResultSummary[1]:Enduse1[32]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[1]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[1]:Enduse2[32]"			Proj:ResultSummary[1]:Enduse2[32]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[2]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[1]:Enduse3[32]"			Proj:ResultSummary[1]:Enduse3[32]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[3]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[1]:Enduse4[32]"			Proj:ResultSummary[1]:Enduse4[32]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[4]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[1]:Enduse5[32]"			Proj:ResultSummary[1]:Enduse5[32]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[5]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[1]:Enduse6[32]"			Proj:ResultSummary[1]:Enduse6[32]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[6]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[1]:Enduse7[32]"			Proj:ResultSummary[1]:Enduse7[32]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[7]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[1]:Enduse8[32]"			Proj:ResultSummary[1]:Enduse8[32]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[8]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[1]:Enduse9[32]"			Proj:ResultSummary[1]:Enduse9[32]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[9]:StandardSrc , 2 )  endif  }
 	"Set ResultSummary[1]:Enduse10[32]"			Proj:ResultSummary[1]:Enduse10[32]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( RunResults[10]:StandardSrc, 2 )  endif  }
 	"Set ResultSummary[1]:Enduse11[32]"			Proj:ResultSummary[1]:Enduse11[32]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( RunResults[11]:StandardSrc, 2 )  endif  }
 	"Set ResultSummary[1]:Enduse12[32]"			Proj:ResultSummary[1]:Enduse12[32]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( RunResults[12]:StandardSrc, 2 )  endif  }
	"Set ResultSummary[1]:Enduse13[32]"			Proj:ResultSummary[1]:Enduse13[32]	= {	if (LocalCompAssigned( RunResults[13] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResults[13]:StandardSrc = 0 )) then  " "  else  FltToStr( RunResults[13]:StandardSrc, 2 )  endif endif  }
	"Set ResultSummary[1]:Enduse14[32]"			Proj:ResultSummary[1]:Enduse14[32]	= {	if (LocalCompAssigned( RunResults[14] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResults[14]:StandardSrc = 0 )) then  " "  else  FltToStr( RunResults[14]:StandardSrc, 2 )  endif endif  }

  ; Compliance Margin Src
	"Set ResultSummary[1]:Title1[33]"				Proj:ResultSummary[1]:Title1[33]		= {	if (EnergyCodeYearNum < 2022) then  "Compliance"     else  UNDEFINED        endif  }
	"Set ResultSummary[1]:Title2[33]"				Proj:ResultSummary[1]:Title2[33]		= {	if (EnergyCodeYearNum < 2022) then  "Margin"         else if (EnergyCodeYearNum < 2025) then  "EDR1    "  else  "Source"  endif endif  }   ; SAC 11/25/22
	"Set ResultSummary[1]:Title3[33]"				Proj:ResultSummary[1]:Title3[33]		= {	if (EnergyCodeYearNum < 2022) then  "(kBtu/ft-yr)"  else  "(kBtu/ft-yr)"  endif  }
	"Set ResultSummary[1]:Enduse1[33]"			Proj:ResultSummary[1]:Enduse1[33]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[1]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[1]:Enduse2[33]"			Proj:ResultSummary[1]:Enduse2[33]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[2]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[1]:Enduse3[33]"			Proj:ResultSummary[1]:Enduse3[33]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[3]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[1]:Enduse4[33]"			Proj:ResultSummary[1]:Enduse4[33]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[4]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[1]:Enduse5[33]"			Proj:ResultSummary[1]:Enduse5[33]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[5]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[1]:Enduse14[33]"			Proj:ResultSummary[1]:Enduse14[33]	= {	if (LocalCompAssigned( RunResults[14] ) == 0) then  UNDEFINED  else  FltToStr( RunResults[14]:CompMarginSrc, 2 )  endif  }
	"Set ResultSummary[1]:Enduse6[33]"			Proj:ResultSummary[1]:Enduse6[33]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[6]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[1]:Enduse7[33]"			Proj:ResultSummary[1]:Enduse7[33]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[7]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[1]:Enduse8[33]"			Proj:ResultSummary[1]:Enduse8[33]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[8]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[1]:Enduse9[33]"			Proj:ResultSummary[1]:Enduse9[33]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[9]:CompMarginSrc , 2 )  endif  }
 	"Set ResultSummary[1]:Enduse10[33]"			Proj:ResultSummary[1]:Enduse10[33]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( RunResults[10]:CompMarginSrc, 2 )  endif  }
 	"Set ResultSummary[1]:Enduse11[33]"			Proj:ResultSummary[1]:Enduse11[33]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( RunResults[11]:CompMarginSrc, 2 )  endif  }
 	"Set ResultSummary[1]:Enduse12[33]"			Proj:ResultSummary[1]:Enduse12[33]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( RunResults[12]:CompMarginSrc, 2 )  endif  }
 	"Set ResultSummary[1]:Enduse13[33]"			Proj:ResultSummary[1]:Enduse13[33]	= {	if (LocalCompAssigned( RunResults[13] ) == 0) then  UNDEFINED  else  FltToStr( RunResults[13]:CompMarginSrc, 2 )  endif  }

  ; Design Rating Proposed Src
	"Set ResultSummary[1]:Title1[34]"			Proj:ResultSummary[1]:Title1[34]			= {	ResultSummary[1]:Title1[31]  }	; Proposed Total Src -> DRtg Prop Total Src
	"Set ResultSummary[1]:Title2[34]"			Proj:ResultSummary[1]:Title2[34]			= {	ResultSummary[1]:Title2[31]  }
	"Set ResultSummary[1]:Title3[34]"			Proj:ResultSummary[1]:Title3[34]			= {	ResultSummary[1]:Title3[31]  }
	"Set ResultSummary[1]:Enduse1[34]"			Proj:ResultSummary[1]:Enduse1[34]		= {	ResultSummary[1]:Enduse1[31]  }
	"Set ResultSummary[1]:Enduse2[34]"			Proj:ResultSummary[1]:Enduse2[34]		= {	ResultSummary[1]:Enduse2[31]  }
	"Set ResultSummary[1]:Enduse3[34]"			Proj:ResultSummary[1]:Enduse3[34]		= {	ResultSummary[1]:Enduse3[31]  }
	"Set ResultSummary[1]:Enduse4[34]"			Proj:ResultSummary[1]:Enduse4[34]		= {	ResultSummary[1]:Enduse4[31]  }
	"Set ResultSummary[1]:Enduse5[34]"			Proj:ResultSummary[1]:Enduse5[34]		= {	ResultSummary[1]:Enduse5[31]  }
	"Set ResultSummary[1]:Enduse6[34]"			Proj:ResultSummary[1]:Enduse6[34]		= {	ResultSummary[1]:Enduse6[31]  }
	"Set ResultSummary[1]:Enduse7[34]"			Proj:ResultSummary[1]:Enduse7[34]		= {	ResultSummary[1]:Enduse7[31]  }
	"Set ResultSummary[1]:Enduse8[34]"			Proj:ResultSummary[1]:Enduse8[34]		= {	ResultSummary[1]:Enduse8[31]  }
	"Set ResultSummary[1]:Enduse9[34]"			Proj:ResultSummary[1]:Enduse9[34]		= {	ResultSummary[1]:Enduse9[31]  }
	"Set ResultSummary[1]:Enduse10[34]"			Proj:ResultSummary[1]:Enduse10[34]		= {	ResultSummary[1]:Enduse10[31]  }
	"Set ResultSummary[1]:Enduse11[34]"			Proj:ResultSummary[1]:Enduse11[34]		= {	ResultSummary[1]:Enduse11[31]  }
	"Set ResultSummary[1]:Enduse12[34]"			Proj:ResultSummary[1]:Enduse12[34]		= {	ResultSummary[1]:Enduse12[31]  }
	"Set ResultSummary[1]:Enduse13[34]"			Proj:ResultSummary[1]:Enduse13[34]		= {	ResultSummary[1]:Enduse13[31]  }
	"Set ResultSummary[1]:Enduse14[34]"			Proj:ResultSummary[1]:Enduse14[34]		= {	ResultSummary[1]:Enduse14[31]  }
;	"Set ResultSummary[1]:SummaryCol1[34]"		Proj:ResultSummary[1]:SummaryCol1[34]	= {	ResultSummary[1]:SummaryCol1[31]  } 
;	"Set ResultSummary[1]:SummaryCol2[34]"		Proj:ResultSummary[1]:SummaryCol2[34]	= {	ResultSummary[1]:SummaryCol2[31]  }
;	"Set ResultSummary[1]:SummaryCol3[34]"		Proj:ResultSummary[1]:SummaryCol3[34]	= {	ResultSummary[1]:SummaryCol3[31]  }

  ; DesignRating Src
	"Set ResultSummary[1]:Title1[35]"			Proj:ResultSummary[1]:Title1[35]		= {	if (EnergyCodeYearNum < 2022) then  "Reference"      else  UNDEFINED        endif  }
	"Set ResultSummary[1]:Title2[35]"			Proj:ResultSummary[1]:Title2[35]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else  "EDR1"           endif  }
	"Set ResultSummary[1]:Title3[35]"			Proj:ResultSummary[1]:Title3[35]		= {	if (EnergyCodeYearNum < 2022) then  "(kBtu/ft-yr)"  else  "(kBtu/ft-yr)"  endif  }
	"Set ResultSummary[1]:Enduse1[35]"			Proj:ResultSummary[1]:Enduse1[35]	= {	if (LocalCompAssigned( RunResults[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[1]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse2[35]"			Proj:ResultSummary[1]:Enduse2[35]	= {	if (LocalCompAssigned( RunResults[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[2]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse3[35]"			Proj:ResultSummary[1]:Enduse3[35]	= {	if (LocalCompAssigned( RunResults[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[3]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse4[35]"			Proj:ResultSummary[1]:Enduse4[35]	= {	if (LocalCompAssigned( RunResults[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[4]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse5[35]"			Proj:ResultSummary[1]:Enduse5[35]	= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[5]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse14[35]"			Proj:ResultSummary[1]:Enduse14[35]	= {	if (LocalCompAssigned( RunResults[14] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResults[14]:DesignRatingSrc[2] = 0 )) then  " "  else  FltToStr( LocalRef( RunResults[14]:DesignRatingSrc[2] ), 2 )  endif endif  }
	"Set ResultSummary[1]:Enduse6[35]"			Proj:ResultSummary[1]:Enduse6[35]	= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[6]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse7[35]"			Proj:ResultSummary[1]:Enduse7[35]	= {	if (LocalCompAssigned( RunResults[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[7]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse8[35]"			Proj:ResultSummary[1]:Enduse8[35]	= {	if (LocalCompAssigned( RunResults[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[8]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse9[35]"			Proj:ResultSummary[1]:Enduse9[35]	= {	if (LocalCompAssigned( RunResults[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[9]:DesignRatingSrc[2]  ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse10[35]"			Proj:ResultSummary[1]:Enduse10[35]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[10]:DesignRatingSrc[2] ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse11[35]"			Proj:ResultSummary[1]:Enduse11[35]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[11]:DesignRatingSrc[2] ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse12[35]"			Proj:ResultSummary[1]:Enduse12[35]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:DesignRatingSrc[2] ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse13[35]"			Proj:ResultSummary[1]:Enduse13[35]	= {	" "  }		; still blank out reference PV ??

  ; DesignRating Margin Src
	"Set ResultSummary[1]:Title1[36]"			Proj:ResultSummary[1]:Title1[36]		= {	if (EnergyCodeYearNum < 2022) then  "Design Rating"  else  UNDEFINED        endif  }
	"Set ResultSummary[1]:Title2[36]"			Proj:ResultSummary[1]:Title2[36]		= {	if (EnergyCodeYearNum < 2022) then  "Margin"         else  "EDR1"           endif  }
	"Set ResultSummary[1]:Title3[36]"			Proj:ResultSummary[1]:Title3[36]		= {	if (EnergyCodeYearNum < 2022) then  "(kBtu/ft-yr)"  else  "(kBtu/ft-yr)"  endif  }
	"Set ResultSummary[1]:Enduse1[36]"			Proj:ResultSummary[1]:Enduse1[36]	= {	if (LocalCompAssigned( RunResults[1]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[1]:DesignRatingSrc[2]  - RunResults[1]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse2[36]"			Proj:ResultSummary[1]:Enduse2[36]	= {	if (LocalCompAssigned( RunResults[2]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[2]:DesignRatingSrc[2]  - RunResults[2]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse3[36]"			Proj:ResultSummary[1]:Enduse3[36]	= {	if (LocalCompAssigned( RunResults[3]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[3]:DesignRatingSrc[2]  - RunResults[3]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse4[36]"			Proj:ResultSummary[1]:Enduse4[36]	= {	if (LocalCompAssigned( RunResults[4]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[4]:DesignRatingSrc[2]  - RunResults[4]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse5[36]"			Proj:ResultSummary[1]:Enduse5[36]	= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[5]:DesignRatingSrc[2]  - RunResults[5]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse14[36]"			Proj:ResultSummary[1]:Enduse14[36]	= {	if (LocalCompAssigned( RunResults[14] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[14]:DesignRatingSrc[2] - RunResults[14]:ProposedSrc[2] ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse6[36]"			Proj:ResultSummary[1]:Enduse6[36]	= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[6]:DesignRatingSrc[2]  - RunResults[6]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse7[36]"			Proj:ResultSummary[1]:Enduse7[36]	= {	if (LocalCompAssigned( RunResults[7]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[7]:DesignRatingSrc[2]  - RunResults[7]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse8[36]"			Proj:ResultSummary[1]:Enduse8[36]	= {	if (LocalCompAssigned( RunResults[8]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[8]:DesignRatingSrc[2]  - RunResults[8]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse9[36]"			Proj:ResultSummary[1]:Enduse9[36]	= {	if (LocalCompAssigned( RunResults[9]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[9]:DesignRatingSrc[2]  - RunResults[9]:ProposedSrc[2]  ), 2 )  endif  }
; 	"Set ResultSummary[1]:Enduse10[36]"			Proj:ResultSummary[1]:Enduse10[36]	= {
; 	      if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED
; 	      else  FltToStr( (int((RunResults[10]:DesignRatingSrc[2]*100)+0.5) - int((RunResults[10]:ProposedSrc[2]*100)+0.5)) / 100 - ValidOr( ResultSummary[1]:PFlxSrc[1], 0 ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse10[36]"			Proj:ResultSummary[1]:Enduse10[36]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( (int((RunResults[10]:DesignRatingSrc[2]*100)+0.5) - int((RunResults[10]:ProposedSrc[2]*100)+0.5)) / 100, 2 )  endif  }
 	"Set ResultSummary[1]:Enduse11[36]"			Proj:ResultSummary[1]:Enduse11[36]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[11]:DesignRatingSrc[2] - RunResults[11]:ProposedSrc[2] ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse12[36]"			Proj:ResultSummary[1]:Enduse12[36]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[12]:DesignRatingSrc[2] - RunResults[12]:ProposedSrc[2] ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse13[36]"			Proj:ResultSummary[1]:Enduse13[36]	= {	if (LocalCompAssigned( RunResults[13] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[13]:DesignRatingSrc[2] - RunResults[13]:ProposedSrc[2] ), 2 )  endif  }
END
;*************************************************************************

;*************************************************************************
RULELIST "CARes_SourceEnergySummary_NESW" 1 0 1 1
;*************************************************************************
; NORTH
 	"Set ResultSummary[2]:EDR1DesignRating"			Proj:ResultSummary[2]:EDR1DesignRating		= {
         if (IfValidAnd( RunResultsN[10]:DesignRatingSrc[2] != 0 )==0) then  UNDEFINED
      ;   else if (LocalStatus( ResultSummary[2]:PFlxSrc[2] ) > 0 .AND. LocalStatus( RunResultsN[11]:ProposedSrc[3] ) > 0)
      ;   then   int( ((ResultSummary[2]:PFlxSrc[2] +
      ;                 ValidOr( RunResultsN[10]:ProposedSrc[3], 0 )) * 1000 / RunResultsN[10]:DesignRatingSrc[2])+0.5 )/10
         else   int( ( ValidOr( RunResultsN[10]:ProposedSrc[3], 0 )  * 1000 / RunResultsN[10]:DesignRatingSrc[2])+0.5 )/10
         endif  }  ; endif  }
 	"Set ResultSummary[2]:EDR1DesignRatingStd"		Proj:ResultSummary[2]:EDR1DesignRatingStd		= {
         if (IfValidAnd( RunResultsN[10]:DesignRatingSrc[2] != 0 )==0 .OR.
             AnalysisType < 3) then  UNDEFINED
			else	int( ((	RunResultsN[1]:StdElecSrc[1] + RunResultsN[1]:StdNatGasSrc + RunResultsN[1]:StdOtherSrc +  ; SpcHt
      					 +	RunResultsN[2]:StdElecSrc[1] + RunResultsN[2]:StdNatGasSrc + RunResultsN[2]:StdOtherSrc +  ; SpcCl
      					 +	RunResultsN[3]:StdElecSrc[1]    ; IAQVent
		      			 +	RunResultsN[4]:StandardSrc[1]   ; OthrHVAC
      					 +	RunResultsN[5]:StdElecSrc[1] + RunResultsN[5]:StdNatGasSrc + RunResultsN[5]:StdOtherSrc +  ; WtrHt
		      			 +	RunResultsN[6]:StandardSrc[1]   ; InsLtg
      					 +	RunResultsN[7]:StdElecSrc[1] + RunResultsN[7]:StdNatGasSrc + RunResultsN[7]:StdOtherSrc +  ; AppCkg
		      			 +	RunResultsN[8]:StandardSrc[1]   ; Plugs
				      	 +	RunResultsN[9]:StandardSrc[1]   ; Ext
      					 +	RunResultsN[13]:StandardSrc[1]   ; PV
		      			 +	RunResultsN[14]:StandardSrc[1] ) ; Battery
				      			* 1000 / RunResultsN[10]:DesignRatingSrc[2])+0.5 )/10    endif  }

  ; Proposed Src
	"Set ResultSummary[2]:Title1[31]"				Proj:ResultSummary[2]:Title1[31]		= {	if (EnergyCodeYearNum < 2022) then  "Proposed"       else  UNDEFINED        endif  }
	"Set ResultSummary[2]:Title2[31]"				Proj:ResultSummary[2]:Title2[31]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "EDR1"  else  "Source"  endif endif  }   ; SAC 11/24/22
	"Set ResultSummary[2]:Title3[31]"				Proj:ResultSummary[2]:Title3[31]		= {	if (EnergyCodeYearNum < 2022) then  "(kBtu/ft-yr)"  else  "(kBtu/ft-yr)"  endif  }
	"Set ResultSummary[2]:Enduse1[31]"			Proj:ResultSummary[2]:Enduse1[31]		= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[1]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[2]:Enduse2[31]"			Proj:ResultSummary[2]:Enduse2[31]		= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[2]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[2]:Enduse3[31]"			Proj:ResultSummary[2]:Enduse3[31]		= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[3]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[2]:Enduse4[31]"			Proj:ResultSummary[2]:Enduse4[31]		= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[4]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[2]:Enduse5[31]"			Proj:ResultSummary[2]:Enduse5[31]		= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[5]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[2]:Enduse14[31]"			Proj:ResultSummary[2]:Enduse14[31]	= {	if (LocalCompAssigned( RunResultsN[14] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[14]:ProposedSrc[1], 2 )  endif  }
	"Set ResultSummary[2]:Enduse6[31]"			Proj:ResultSummary[2]:Enduse6[31]		= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[6]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[2]:Enduse7[31]"			Proj:ResultSummary[2]:Enduse7[31]		= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[7]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[2]:Enduse8[31]"			Proj:ResultSummary[2]:Enduse8[31]		= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[8]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[2]:Enduse9[31]"			Proj:ResultSummary[2]:Enduse9[31]		= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[9]:ProposedSrc[1] , 2 )  endif  }
 	"Set ResultSummary[2]:Enduse10[31]"			Proj:ResultSummary[2]:Enduse10[31]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[10]:ProposedSrc[1], 2 )  endif  }
 	"Set ResultSummary[2]:Enduse11[31]"			Proj:ResultSummary[2]:Enduse11[31]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[11]:ProposedSrc[1], 2 )  endif  }
 	"Set ResultSummary[2]:Enduse12[31]"			Proj:ResultSummary[2]:Enduse12[31]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[12]:ProposedSrc[1], 2 )  endif  }
 	"Set ResultSummary[2]:Enduse13[31]"			Proj:ResultSummary[2]:Enduse13[31]	= {	if (LocalCompAssigned( RunResultsN[13] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[13]:ProposedSrc[1], 2 )  endif  }

  ; Standard Src
	"Set ResultSummary[2]:Title1[32]"				Proj:ResultSummary[2]:Title1[32]		= {	if (EnergyCodeYearNum < 2022) then  "Standard"       else  UNDEFINED        endif  }
	"Set ResultSummary[2]:Title2[32]"				Proj:ResultSummary[2]:Title2[32]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "EDR1"  else  "Source"  endif endif  }   ; SAC 11/23/22
	"Set ResultSummary[2]:Title3[32]"				Proj:ResultSummary[2]:Title3[32]		= {	if (EnergyCodeYearNum < 2022) then  "(kBtu/ft-yr)"  else  "(kBtu/ft-yr)"  endif  }
	"Set ResultSummary[2]:Enduse1[32]"			Proj:ResultSummary[2]:Enduse1[32]		= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[1]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[2]:Enduse2[32]"			Proj:ResultSummary[2]:Enduse2[32]		= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[2]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[2]:Enduse3[32]"			Proj:ResultSummary[2]:Enduse3[32]		= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[3]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[2]:Enduse4[32]"			Proj:ResultSummary[2]:Enduse4[32]		= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[4]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[2]:Enduse5[32]"			Proj:ResultSummary[2]:Enduse5[32]		= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[5]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[2]:Enduse6[32]"			Proj:ResultSummary[2]:Enduse6[32]		= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[6]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[2]:Enduse7[32]"			Proj:ResultSummary[2]:Enduse7[32]		= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[7]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[2]:Enduse8[32]"			Proj:ResultSummary[2]:Enduse8[32]		= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[8]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[2]:Enduse9[32]"			Proj:ResultSummary[2]:Enduse9[32]		= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[9]:StandardSrc , 2 )  endif  }
 	"Set ResultSummary[2]:Enduse10[32]"			Proj:ResultSummary[2]:Enduse10[32]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[10]:StandardSrc, 2 )  endif  }
 	"Set ResultSummary[2]:Enduse11[32]"			Proj:ResultSummary[2]:Enduse11[32]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[11]:StandardSrc, 2 )  endif  }
 	"Set ResultSummary[2]:Enduse12[32]"			Proj:ResultSummary[2]:Enduse12[32]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[12]:StandardSrc, 2 )  endif  }
 	"Set ResultSummary[2]:Enduse13[32]"			Proj:ResultSummary[2]:Enduse13[32]	= {	if (LocalCompAssigned( RunResultsN[13] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsN[13]:StandardSrc = 0 )) then  " "  else  FltToStr( RunResultsN[13]:StandardSrc, 2 )  endif endif  }
	"Set ResultSummary[2]:Enduse14[32]"			Proj:ResultSummary[2]:Enduse14[32]	= {	if (LocalCompAssigned( RunResultsN[14] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsN[14]:StandardSrc = 0 )) then  " "  else  FltToStr( RunResultsN[14]:StandardSrc, 2 )  endif endif  }

  ; Compliance Margin Src
	"Set ResultSummary[2]:Title1[33]"				Proj:ResultSummary[2]:Title1[33]		= {	if (EnergyCodeYearNum < 2022) then  "Compliance"     else  UNDEFINED        endif  }
	"Set ResultSummary[2]:Title2[33]"				Proj:ResultSummary[2]:Title2[33]		= {	if (EnergyCodeYearNum < 2022) then  "Margin"         else if (EnergyCodeYearNum < 2025) then  "EDR1    "  else  "Source"  endif endif  }   ; SAC 11/25/22
	"Set ResultSummary[2]:Title3[33]"				Proj:ResultSummary[2]:Title3[33]		= {	if (EnergyCodeYearNum < 2022) then  "(kBtu/ft-yr)"  else  "(kBtu/ft-yr)"  endif  }
	"Set ResultSummary[2]:Enduse1[33]"			Proj:ResultSummary[2]:Enduse1[33]		= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[1]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[2]:Enduse2[33]"			Proj:ResultSummary[2]:Enduse2[33]		= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[2]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[2]:Enduse3[33]"			Proj:ResultSummary[2]:Enduse3[33]		= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[3]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[2]:Enduse4[33]"			Proj:ResultSummary[2]:Enduse4[33]		= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[4]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[2]:Enduse5[33]"			Proj:ResultSummary[2]:Enduse5[33]		= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[5]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[2]:Enduse14[33]"			Proj:ResultSummary[2]:Enduse14[33]	= {	if (LocalCompAssigned( RunResultsN[14] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[14]:CompMarginSrc, 2 )  endif  }
	"Set ResultSummary[2]:Enduse6[33]"			Proj:ResultSummary[2]:Enduse6[33]		= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[6]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[2]:Enduse7[33]"			Proj:ResultSummary[2]:Enduse7[33]		= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[7]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[2]:Enduse8[33]"			Proj:ResultSummary[2]:Enduse8[33]		= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[8]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[2]:Enduse9[33]"			Proj:ResultSummary[2]:Enduse9[33]		= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[9]:CompMarginSrc , 2 )  endif  }
 	"Set ResultSummary[2]:Enduse10[33]"			Proj:ResultSummary[2]:Enduse10[33]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[10]:CompMarginSrc, 2 )  endif  }
 	"Set ResultSummary[2]:Enduse11[33]"			Proj:ResultSummary[2]:Enduse11[33]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[11]:CompMarginSrc, 2 )  endif  }
 	"Set ResultSummary[2]:Enduse12[33]"			Proj:ResultSummary[2]:Enduse12[33]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[12]:CompMarginSrc, 2 )  endif  }
 	"Set ResultSummary[2]:Enduse13[33]"			Proj:ResultSummary[2]:Enduse13[33]	= {	if (LocalCompAssigned( RunResultsN[13] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[13]:CompMarginSrc, 2 )  endif  }

  ; Design Rating Proposed Src
	"Set ResultSummary[2]:Title1[34]"			Proj:ResultSummary[2]:Title1[34]			= {	ResultSummary[2]:Title1[31]  }	; Proposed Total Src -> DRtg Prop Total Src
	"Set ResultSummary[2]:Title2[34]"			Proj:ResultSummary[2]:Title2[34]			= {	ResultSummary[2]:Title2[31]  }
	"Set ResultSummary[2]:Title3[34]"			Proj:ResultSummary[2]:Title3[34]			= {	ResultSummary[2]:Title3[31]  }
	"Set ResultSummary[2]:Enduse1[34]"			Proj:ResultSummary[2]:Enduse1[34]		= {	ResultSummary[2]:Enduse1[31]  }
	"Set ResultSummary[2]:Enduse2[34]"			Proj:ResultSummary[2]:Enduse2[34]		= {	ResultSummary[2]:Enduse2[31]  }
	"Set ResultSummary[2]:Enduse3[34]"			Proj:ResultSummary[2]:Enduse3[34]		= {	ResultSummary[2]:Enduse3[31]  }
	"Set ResultSummary[2]:Enduse4[34]"			Proj:ResultSummary[2]:Enduse4[34]		= {	ResultSummary[2]:Enduse4[31]  }
	"Set ResultSummary[2]:Enduse5[34]"			Proj:ResultSummary[2]:Enduse5[34]		= {	ResultSummary[2]:Enduse5[31]  }
	"Set ResultSummary[2]:Enduse6[34]"			Proj:ResultSummary[2]:Enduse6[34]		= {	ResultSummary[2]:Enduse6[31]  }
	"Set ResultSummary[2]:Enduse7[34]"			Proj:ResultSummary[2]:Enduse7[34]		= {	ResultSummary[2]:Enduse7[31]  }
	"Set ResultSummary[2]:Enduse8[34]"			Proj:ResultSummary[2]:Enduse8[34]		= {	ResultSummary[2]:Enduse8[31]  }
	"Set ResultSummary[2]:Enduse9[34]"			Proj:ResultSummary[2]:Enduse9[34]		= {	ResultSummary[2]:Enduse9[31]  }
	"Set ResultSummary[2]:Enduse10[34]"			Proj:ResultSummary[2]:Enduse10[34]		= {	ResultSummary[2]:Enduse10[31]  }
	"Set ResultSummary[2]:Enduse11[34]"			Proj:ResultSummary[2]:Enduse11[34]		= {	ResultSummary[2]:Enduse11[31]  }
	"Set ResultSummary[2]:Enduse12[34]"			Proj:ResultSummary[2]:Enduse12[34]		= {	ResultSummary[2]:Enduse12[31]  }
	"Set ResultSummary[2]:Enduse13[34]"			Proj:ResultSummary[2]:Enduse13[34]		= {	ResultSummary[2]:Enduse13[31]  }
	"Set ResultSummary[2]:Enduse14[34]"			Proj:ResultSummary[2]:Enduse14[34]		= {	ResultSummary[2]:Enduse14[31]  }
;	"Set ResultSummary[2]:SummaryCol1[34]"		Proj:ResultSummary[2]:SummaryCol1[34]	= {	ResultSummary[2]:SummaryCol1[31]  } 
;	"Set ResultSummary[2]:SummaryCol2[34]"		Proj:ResultSummary[2]:SummaryCol2[34]	= {	ResultSummary[2]:SummaryCol2[31]  }
;	"Set ResultSummary[2]:SummaryCol3[34]"		Proj:ResultSummary[2]:SummaryCol3[34]	= {	ResultSummary[2]:SummaryCol3[31]  }

  ; DesignRating Src
	"Set ResultSummary[2]:Title1[35]"			Proj:ResultSummary[2]:Title1[35]		= {	if (EnergyCodeYearNum < 2022) then  "Reference"      else  UNDEFINED        endif  }
	"Set ResultSummary[2]:Title2[35]"			Proj:ResultSummary[2]:Title2[35]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else  "EDR1"           endif  }
	"Set ResultSummary[2]:Title3[35]"			Proj:ResultSummary[2]:Title3[35]		= {	if (EnergyCodeYearNum < 2022) then  "(kBtu/ft-yr)"  else  "(kBtu/ft-yr)"  endif  }
	"Set ResultSummary[2]:Enduse1[35]"			Proj:ResultSummary[2]:Enduse1[35]	= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[1]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse2[35]"			Proj:ResultSummary[2]:Enduse2[35]	= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[2]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse3[35]"			Proj:ResultSummary[2]:Enduse3[35]	= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[3]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse4[35]"			Proj:ResultSummary[2]:Enduse4[35]	= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[4]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse5[35]"			Proj:ResultSummary[2]:Enduse5[35]	= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[5]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse6[35]"			Proj:ResultSummary[2]:Enduse6[35]	= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[6]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse7[35]"			Proj:ResultSummary[2]:Enduse7[35]	= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[7]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse8[35]"			Proj:ResultSummary[2]:Enduse8[35]	= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[8]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse9[35]"			Proj:ResultSummary[2]:Enduse9[35]	= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[9]:DesignRatingSrc[2]  ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse10[35]"			Proj:ResultSummary[2]:Enduse10[35]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[10]:DesignRatingSrc[2] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse11[35]"			Proj:ResultSummary[2]:Enduse11[35]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[11]:DesignRatingSrc[2] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse12[35]"			Proj:ResultSummary[2]:Enduse12[35]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[12]:DesignRatingSrc[2] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse13[35]"			Proj:ResultSummary[2]:Enduse13[35]	= {	if (LocalCompAssigned( RunResultsN[13] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsN[13]:DesignRatingSrc[2] = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsN[13]:DesignRatingSrc[2] ), 2 )  endif endif  }
	"Set ResultSummary[2]:Enduse14[35]"			Proj:ResultSummary[2]:Enduse14[35]	= {	if (LocalCompAssigned( RunResultsN[14] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsN[14]:DesignRatingSrc[2] = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsN[14]:DesignRatingSrc[2] ), 2 )  endif endif  }

  ; DesignRating Margin Src
	"Set ResultSummary[2]:Title1[36]"			Proj:ResultSummary[2]:Title1[36]		= {	if (EnergyCodeYearNum < 2022) then  "Design Rating"  else  UNDEFINED        endif  }
	"Set ResultSummary[2]:Title2[36]"			Proj:ResultSummary[2]:Title2[36]		= {	if (EnergyCodeYearNum < 2022) then  "Margin"         else  "EDR1"           endif  }
	"Set ResultSummary[2]:Title3[36]"			Proj:ResultSummary[2]:Title3[36]		= {	if (EnergyCodeYearNum < 2022) then  "(kBtu/ft-yr)"  else  "(kBtu/ft-yr)"  endif  }
	"Set ResultSummary[2]:Enduse1[36]"			Proj:ResultSummary[2]:Enduse1[36]	= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[1]:DesignRatingSrc[2]  - RunResultsN[1]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse2[36]"			Proj:ResultSummary[2]:Enduse2[36]	= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[2]:DesignRatingSrc[2]  - RunResultsN[2]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse3[36]"			Proj:ResultSummary[2]:Enduse3[36]	= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[3]:DesignRatingSrc[2]  - RunResultsN[3]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse4[36]"			Proj:ResultSummary[2]:Enduse4[36]	= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[4]:DesignRatingSrc[2]  - RunResultsN[4]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse5[36]"			Proj:ResultSummary[2]:Enduse5[36]	= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[5]:DesignRatingSrc[2]  - RunResultsN[5]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse14[36]"			Proj:ResultSummary[2]:Enduse14[36]	= {	if (LocalCompAssigned( RunResultsN[14] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[14]:DesignRatingSrc[2] - RunResultsN[14]:ProposedSrc[2] ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse6[36]"			Proj:ResultSummary[2]:Enduse6[36]	= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[6]:DesignRatingSrc[2]  - RunResultsN[6]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse7[36]"			Proj:ResultSummary[2]:Enduse7[36]	= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[7]:DesignRatingSrc[2]  - RunResultsN[7]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse8[36]"			Proj:ResultSummary[2]:Enduse8[36]	= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[8]:DesignRatingSrc[2]  - RunResultsN[8]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse9[36]"			Proj:ResultSummary[2]:Enduse9[36]	= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[9]:DesignRatingSrc[2]  - RunResultsN[9]:ProposedSrc[2]  ), 2 )  endif  }
;   ; SAC 2/2/19 - Flexibility reporting via new PFlxSrc property (tic #1053)
; 	"Set ResultSummary[2]:Enduse10[36]"			Proj:ResultSummary[2]:Enduse10[36]	= {
; 	      if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED
; 	      else  FltToStr( (int((RunResultsN[10]:DesignRatingSrc[2]*100)+0.5) - int((RunResultsN[10]:ProposedSrc[2]*100)+0.5)) / 100 - ValidOr( ResultSummary[2]:PFlxSrc[1], 0 ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse10[36]"			Proj:ResultSummary[2]:Enduse10[36]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  FltToStr( (int((RunResultsN[10]:DesignRatingSrc[2]*100)+0.5) - int((RunResultsN[10]:ProposedSrc[2]*100)+0.5)) / 100, 2 )  endif  }
 	"Set ResultSummary[2]:Enduse11[36]"			Proj:ResultSummary[2]:Enduse11[36]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[11]:DesignRatingSrc[2] - RunResultsN[11]:ProposedSrc[2] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse12[36]"			Proj:ResultSummary[2]:Enduse12[36]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[12]:DesignRatingSrc[2] - RunResultsN[12]:ProposedSrc[2] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse13[36]"			Proj:ResultSummary[2]:Enduse13[36]	= {	if (LocalCompAssigned( RunResultsN[13] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[13]:DesignRatingSrc[2] - RunResultsN[13]:ProposedSrc[2] ), 2 )  endif  }

; EAST
 	"Set ResultSummary[3]:EDR1DesignRating"			Proj:ResultSummary[3]:EDR1DesignRating		= {
         if (IfValidAnd( RunResultsE[10]:DesignRatingSrc[2] != 0 )==0) then  UNDEFINED
      ;   else if (LocalStatus( ResultSummary[3]:PFlxSrc[2] ) > 0 .AND. LocalStatus( RunResultsE[11]:ProposedSrc[3] ) > 0)
      ;   then   int( ((ResultSummary[3]:PFlxSrc[2] +
      ;                 ValidOr( RunResultsE[10]:ProposedSrc[3], 0 )) * 1000 / RunResultsE[10]:DesignRatingSrc[2])+0.5 )/10
         else   int( ( ValidOr( RunResultsE[10]:ProposedSrc[3], 0 )  * 1000 / RunResultsE[10]:DesignRatingSrc[2])+0.5 )/10
         endif  }  ; endif  }
 	"Set ResultSummary[3]:EDR1DesignRatingStd"		Proj:ResultSummary[3]:EDR1DesignRatingStd		= {
         if (IfValidAnd( RunResultsE[10]:DesignRatingSrc[2] != 0 )==0 .OR.
             AnalysisType < 3) then  UNDEFINED
			else	int( ((	RunResultsE[1]:StdElecSrc[1] + RunResultsE[1]:StdNatGasSrc + RunResultsE[1]:StdOtherSrc +  ; SpcHt
      					 +	RunResultsE[2]:StdElecSrc[1] + RunResultsE[2]:StdNatGasSrc + RunResultsE[2]:StdOtherSrc +  ; SpcCl
      					 +	RunResultsE[3]:StdElecSrc[1]    ; IAQVent
		      			 +	RunResultsE[4]:StandardSrc[1]   ; OthrHVAC
      					 +	RunResultsE[5]:StdElecSrc[1] + RunResultsE[5]:StdNatGasSrc + RunResultsE[5]:StdOtherSrc +  ; WtrHt
		      			 +	RunResultsE[6]:StandardSrc[1]   ; InsLtg
      					 +	RunResultsE[7]:StdElecSrc[1] + RunResultsE[7]:StdNatGasSrc + RunResultsE[7]:StdOtherSrc +  ; AppCkg
		      			 +	RunResultsE[8]:StandardSrc[1]   ; Plugs
				      	 +	RunResultsE[9]:StandardSrc[1]   ; Ext
      					 +	RunResultsE[13]:StandardSrc[1]   ; PV
		      			 +	RunResultsE[14]:StandardSrc[1] ) ; Battery
				      			* 1000 / RunResultsE[10]:DesignRatingSrc[2])+0.5 )/10    endif  }

  ; Proposed Src
	"Set ResultSummary[3]:Title1[31]"				Proj:ResultSummary[3]:Title1[31]		= {	if (EnergyCodeYearNum < 2022) then  "Proposed"       else  UNDEFINED        endif  }
	"Set ResultSummary[3]:Title2[31]"				Proj:ResultSummary[3]:Title2[31]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "EDR1"  else  "Source"  endif endif  }   ; SAC 11/24/22
	"Set ResultSummary[3]:Title3[31]"				Proj:ResultSummary[3]:Title3[31]		= {	if (EnergyCodeYearNum < 2022) then  "(kBtu/ft-yr)"  else  "(kBtu/ft-yr)"  endif  }
	"Set ResultSummary[3]:Enduse1[31]"			Proj:ResultSummary[3]:Enduse1[31]		= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[1]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[3]:Enduse2[31]"			Proj:ResultSummary[3]:Enduse2[31]		= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[2]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[3]:Enduse3[31]"			Proj:ResultSummary[3]:Enduse3[31]		= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[3]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[3]:Enduse4[31]"			Proj:ResultSummary[3]:Enduse4[31]		= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[4]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[3]:Enduse5[31]"			Proj:ResultSummary[3]:Enduse5[31]		= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[5]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[3]:Enduse14[31]"			Proj:ResultSummary[3]:Enduse14[31]	= {	if (LocalCompAssigned( RunResultsE[14] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[14]:ProposedSrc[1], 2 )  endif  }
	"Set ResultSummary[3]:Enduse6[31]"			Proj:ResultSummary[3]:Enduse6[31]		= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[6]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[3]:Enduse7[31]"			Proj:ResultSummary[3]:Enduse7[31]		= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[7]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[3]:Enduse8[31]"			Proj:ResultSummary[3]:Enduse8[31]		= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[8]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[3]:Enduse9[31]"			Proj:ResultSummary[3]:Enduse9[31]		= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[9]:ProposedSrc[1] , 2 )  endif  }
 	"Set ResultSummary[3]:Enduse10[31]"			Proj:ResultSummary[3]:Enduse10[31]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[10]:ProposedSrc[1], 2 )  endif  }
 	"Set ResultSummary[3]:Enduse11[31]"			Proj:ResultSummary[3]:Enduse11[31]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[11]:ProposedSrc[1], 2 )  endif  }
 	"Set ResultSummary[3]:Enduse12[31]"			Proj:ResultSummary[3]:Enduse12[31]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[12]:ProposedSrc[1], 2 )  endif  }
 	"Set ResultSummary[3]:Enduse13[31]"			Proj:ResultSummary[3]:Enduse13[31]	= {	if (LocalCompAssigned( RunResultsE[13] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[13]:ProposedSrc[1], 2 )  endif  }

  ; Standard Src
	"Set ResultSummary[3]:Title1[32]"				Proj:ResultSummary[3]:Title1[32]		= {	if (EnergyCodeYearNum < 2022) then  "Standard"       else  UNDEFINED        endif  }
	"Set ResultSummary[3]:Title2[32]"				Proj:ResultSummary[3]:Title2[32]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "EDR1"  else  "Source"  endif endif  }   ; SAC 11/23/22
	"Set ResultSummary[3]:Title3[32]"				Proj:ResultSummary[3]:Title3[32]		= {	if (EnergyCodeYearNum < 2022) then  "(kBtu/ft-yr)"  else  "(kBtu/ft-yr)"  endif  }
	"Set ResultSummary[3]:Enduse1[32]"			Proj:ResultSummary[3]:Enduse1[32]		= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[1]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[3]:Enduse2[32]"			Proj:ResultSummary[3]:Enduse2[32]		= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[2]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[3]:Enduse3[32]"			Proj:ResultSummary[3]:Enduse3[32]		= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[3]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[3]:Enduse4[32]"			Proj:ResultSummary[3]:Enduse4[32]		= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[4]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[3]:Enduse5[32]"			Proj:ResultSummary[3]:Enduse5[32]		= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[5]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[3]:Enduse6[32]"			Proj:ResultSummary[3]:Enduse6[32]		= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[6]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[3]:Enduse7[32]"			Proj:ResultSummary[3]:Enduse7[32]		= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[7]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[3]:Enduse8[32]"			Proj:ResultSummary[3]:Enduse8[32]		= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[8]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[3]:Enduse9[32]"			Proj:ResultSummary[3]:Enduse9[32]		= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[9]:StandardSrc , 2 )  endif  }
 	"Set ResultSummary[3]:Enduse10[32]"			Proj:ResultSummary[3]:Enduse10[32]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[10]:StandardSrc, 2 )  endif  }
 	"Set ResultSummary[3]:Enduse11[32]"			Proj:ResultSummary[3]:Enduse11[32]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[11]:StandardSrc, 2 )  endif  }
 	"Set ResultSummary[3]:Enduse12[32]"			Proj:ResultSummary[3]:Enduse12[32]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[12]:StandardSrc, 2 )  endif  }
	"Set ResultSummary[3]:Enduse13[32]"			Proj:ResultSummary[3]:Enduse13[32]	= {	if (LocalCompAssigned( RunResultsE[13] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsE[13]:StandardSrc = 0 )) then  " "  else  FltToStr( RunResultsE[13]:StandardSrc, 2 )  endif endif  }
	"Set ResultSummary[3]:Enduse14[32]"			Proj:ResultSummary[3]:Enduse14[32]	= {	if (LocalCompAssigned( RunResultsE[14] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsE[14]:StandardSrc = 0 )) then  " "  else  FltToStr(  RunResultsE[14]:StandardSrc, 2 )  endif endif  }

  ; Compliance Margin Src
	"Set ResultSummary[3]:Title1[33]"				Proj:ResultSummary[3]:Title1[33]		= {	if (EnergyCodeYearNum < 2022) then  "Compliance"     else  UNDEFINED        endif  }
	"Set ResultSummary[3]:Title2[33]"				Proj:ResultSummary[3]:Title2[33]		= {	if (EnergyCodeYearNum < 2022) then  "Margin"         else if (EnergyCodeYearNum < 2025) then  "EDR1    "  else  "Source"  endif endif  }   ; SAC 11/25/22
	"Set ResultSummary[3]:Title3[33]"				Proj:ResultSummary[3]:Title3[33]		= {	if (EnergyCodeYearNum < 2022) then  "(kBtu/ft-yr)"  else  "(kBtu/ft-yr)"  endif  }
	"Set ResultSummary[3]:Enduse1[33]"			Proj:ResultSummary[3]:Enduse1[33]		= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[1]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[3]:Enduse2[33]"			Proj:ResultSummary[3]:Enduse2[33]		= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[2]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[3]:Enduse3[33]"			Proj:ResultSummary[3]:Enduse3[33]		= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[3]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[3]:Enduse4[33]"			Proj:ResultSummary[3]:Enduse4[33]		= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[4]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[3]:Enduse5[33]"			Proj:ResultSummary[3]:Enduse5[33]		= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[5]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[3]:Enduse14[33]"			Proj:ResultSummary[3]:Enduse14[33]	= {	if (LocalCompAssigned( RunResultsE[14] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[14]:CompMarginSrc, 2 )  endif  }
	"Set ResultSummary[3]:Enduse6[33]"			Proj:ResultSummary[3]:Enduse6[33]		= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[6]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[3]:Enduse7[33]"			Proj:ResultSummary[3]:Enduse7[33]		= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[7]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[3]:Enduse8[33]"			Proj:ResultSummary[3]:Enduse8[33]		= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[8]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[3]:Enduse9[33]"			Proj:ResultSummary[3]:Enduse9[33]		= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[9]:CompMarginSrc , 2 )  endif  }
 	"Set ResultSummary[3]:Enduse10[33]"			Proj:ResultSummary[3]:Enduse10[33]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[10]:CompMarginSrc, 2 )  endif  }
 	"Set ResultSummary[3]:Enduse11[33]"			Proj:ResultSummary[3]:Enduse11[33]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[11]:CompMarginSrc, 2 )  endif  }
 	"Set ResultSummary[3]:Enduse12[33]"			Proj:ResultSummary[3]:Enduse12[33]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[12]:CompMarginSrc, 2 )  endif  }
 	"Set ResultSummary[3]:Enduse13[33]"			Proj:ResultSummary[3]:Enduse13[33]	= {	if (LocalCompAssigned( RunResultsE[13] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[13]:CompMarginSrc,     2 )  endif  }

  ; Design Rating Proposed Src
	"Set ResultSummary[3]:Title1[34]"			Proj:ResultSummary[3]:Title1[34]			= {	ResultSummary[3]:Title1[31]  }	; Proposed Total Src -> DRtg Prop Total Src
	"Set ResultSummary[3]:Title2[34]"			Proj:ResultSummary[3]:Title2[34]			= {	ResultSummary[3]:Title2[31]  }
	"Set ResultSummary[3]:Title3[34]"			Proj:ResultSummary[3]:Title3[34]			= {	ResultSummary[3]:Title3[31]  }
	"Set ResultSummary[3]:Enduse1[34]"			Proj:ResultSummary[3]:Enduse1[34]		= {	ResultSummary[3]:Enduse1[31]  }
	"Set ResultSummary[3]:Enduse2[34]"			Proj:ResultSummary[3]:Enduse2[34]		= {	ResultSummary[3]:Enduse2[31]  }
	"Set ResultSummary[3]:Enduse3[34]"			Proj:ResultSummary[3]:Enduse3[34]		= {	ResultSummary[3]:Enduse3[31]  }
	"Set ResultSummary[3]:Enduse4[34]"			Proj:ResultSummary[3]:Enduse4[34]		= {	ResultSummary[3]:Enduse4[31]  }
	"Set ResultSummary[3]:Enduse5[34]"			Proj:ResultSummary[3]:Enduse5[34]		= {	ResultSummary[3]:Enduse5[31]  }
	"Set ResultSummary[3]:Enduse6[34]"			Proj:ResultSummary[3]:Enduse6[34]		= {	ResultSummary[3]:Enduse6[31]  }
	"Set ResultSummary[3]:Enduse7[34]"			Proj:ResultSummary[3]:Enduse7[34]		= {	ResultSummary[3]:Enduse7[31]  }
	"Set ResultSummary[3]:Enduse8[34]"			Proj:ResultSummary[3]:Enduse8[34]		= {	ResultSummary[3]:Enduse8[31]  }
	"Set ResultSummary[3]:Enduse9[34]"			Proj:ResultSummary[3]:Enduse9[34]		= {	ResultSummary[3]:Enduse9[31]  }
	"Set ResultSummary[3]:Enduse10[34]"			Proj:ResultSummary[3]:Enduse10[34]		= {	ResultSummary[3]:Enduse10[31]  }
	"Set ResultSummary[3]:Enduse11[34]"			Proj:ResultSummary[3]:Enduse11[34]		= {	ResultSummary[3]:Enduse11[31]  }
	"Set ResultSummary[3]:Enduse12[34]"			Proj:ResultSummary[3]:Enduse12[34]		= {	ResultSummary[3]:Enduse12[31]  }
	"Set ResultSummary[3]:Enduse13[34]"			Proj:ResultSummary[3]:Enduse13[34]		= {	ResultSummary[3]:Enduse13[31]  }
	"Set ResultSummary[3]:Enduse14[34]"			Proj:ResultSummary[3]:Enduse14[34]		= {	ResultSummary[3]:Enduse14[31]  }
;	"Set ResultSummary[3]:SummaryCol1[34]"		Proj:ResultSummary[3]:SummaryCol1[34]	= {	ResultSummary[3]:SummaryCol1[31]  } 
;	"Set ResultSummary[3]:SummaryCol2[34]"		Proj:ResultSummary[3]:SummaryCol2[34]	= {	ResultSummary[3]:SummaryCol2[31]  }
;	"Set ResultSummary[3]:SummaryCol3[34]"		Proj:ResultSummary[3]:SummaryCol3[34]	= {	ResultSummary[3]:SummaryCol3[31]  }

  ; DesignRating Src
	"Set ResultSummary[3]:Title1[35]"			Proj:ResultSummary[3]:Title1[35]		= {	if (EnergyCodeYearNum < 2022) then  "Reference"      else  UNDEFINED        endif  }
	"Set ResultSummary[3]:Title2[35]"			Proj:ResultSummary[3]:Title2[35]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else  "EDR1"           endif  }
	"Set ResultSummary[3]:Title3[35]"			Proj:ResultSummary[3]:Title3[35]		= {	if (EnergyCodeYearNum < 2022) then  "(kBtu/ft-yr)"  else  "(kBtu/ft-yr)"  endif  }
	"Set ResultSummary[3]:Enduse1[35]"			Proj:ResultSummary[3]:Enduse1[35]	= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[1]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse2[35]"			Proj:ResultSummary[3]:Enduse2[35]	= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[2]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse3[35]"			Proj:ResultSummary[3]:Enduse3[35]	= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[3]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse4[35]"			Proj:ResultSummary[3]:Enduse4[35]	= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[4]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse5[35]"			Proj:ResultSummary[3]:Enduse5[35]	= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[5]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse6[35]"			Proj:ResultSummary[3]:Enduse6[35]	= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[6]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse7[35]"			Proj:ResultSummary[3]:Enduse7[35]	= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[7]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse8[35]"			Proj:ResultSummary[3]:Enduse8[35]	= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[8]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse9[35]"			Proj:ResultSummary[3]:Enduse9[35]	= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[9]:DesignRatingSrc[2]  ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse10[35]"			Proj:ResultSummary[3]:Enduse10[35]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[10]:DesignRatingSrc[2] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse11[35]"			Proj:ResultSummary[3]:Enduse11[35]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[11]:DesignRatingSrc[2] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse12[35]"			Proj:ResultSummary[3]:Enduse12[35]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[12]:DesignRatingSrc[2] ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse13[35]"			Proj:ResultSummary[3]:Enduse13[35]	= {	if (LocalCompAssigned( RunResultsE[13] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsE[13]:DesignRatingSrc[2] = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsE[13]:DesignRatingSrc[2] ), 2 )  endif endif  }
	"Set ResultSummary[3]:Enduse14[35]"			Proj:ResultSummary[3]:Enduse14[35]	= {	if (LocalCompAssigned( RunResultsE[14] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsE[14]:DesignRatingSrc[2] = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsE[14]:DesignRatingSrc[2] ), 2 )  endif endif  }

  ; DesignRating Margin Src
	"Set ResultSummary[3]:Title1[36]"			Proj:ResultSummary[3]:Title1[36]		= {	if (EnergyCodeYearNum < 2022) then  "Design Rating"  else  UNDEFINED        endif  }
	"Set ResultSummary[3]:Title2[36]"			Proj:ResultSummary[3]:Title2[36]		= {	if (EnergyCodeYearNum < 2022) then  "Margin"         else  "EDR1"           endif  }
	"Set ResultSummary[3]:Title3[36]"			Proj:ResultSummary[3]:Title3[36]		= {	if (EnergyCodeYearNum < 2022) then  "(kBtu/ft-yr)"  else  "(kBtu/ft-yr)"  endif  }
	"Set ResultSummary[3]:Enduse1[36]"			Proj:ResultSummary[3]:Enduse1[36]	= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[1]:DesignRatingSrc[2]  - RunResultsE[1]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse2[36]"			Proj:ResultSummary[3]:Enduse2[36]	= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[2]:DesignRatingSrc[2]  - RunResultsE[2]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse3[36]"			Proj:ResultSummary[3]:Enduse3[36]	= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[3]:DesignRatingSrc[2]  - RunResultsE[3]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse4[36]"			Proj:ResultSummary[3]:Enduse4[36]	= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[4]:DesignRatingSrc[2]  - RunResultsE[4]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse5[36]"			Proj:ResultSummary[3]:Enduse5[36]	= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[5]:DesignRatingSrc[2]  - RunResultsE[5]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse14[36]"			Proj:ResultSummary[3]:Enduse14[36]	= {	if (LocalCompAssigned( RunResultsE[14] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[14]:DesignRatingSrc[2] - RunResultsE[14]:ProposedSrc[2] ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse6[36]"			Proj:ResultSummary[3]:Enduse6[36]	= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[6]:DesignRatingSrc[2]  - RunResultsE[6]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse7[36]"			Proj:ResultSummary[3]:Enduse7[36]	= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[7]:DesignRatingSrc[2]  - RunResultsE[7]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse8[36]"			Proj:ResultSummary[3]:Enduse8[36]	= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[8]:DesignRatingSrc[2]  - RunResultsE[8]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse9[36]"			Proj:ResultSummary[3]:Enduse9[36]	= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[9]:DesignRatingSrc[2]  - RunResultsE[9]:ProposedSrc[2]  ), 2 )  endif  }
;   ; SAC 2/2/19 - Flexibility reporting via new PFlxSrc property (tic #1053)
; 	"Set ResultSummary[3]:Enduse10[36]"			Proj:ResultSummary[3]:Enduse10[36]	= {
; 	      if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED
; 	      else  FltToStr( (int((RunResultsE[10]:DesignRatingSrc[2]*100)+0.5) - int((RunResultsE[10]:ProposedSrc[2]*100)+0.5)) / 100 - ValidOr( ResultSummary[3]:PFlxSrc[1], 0 ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse10[36]"			Proj:ResultSummary[3]:Enduse10[36]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  FltToStr( (int((RunResultsE[10]:DesignRatingSrc[2]*100)+0.5) - int((RunResultsE[10]:ProposedSrc[2]*100)+0.5)) / 100, 2 )  endif  }
 	"Set ResultSummary[3]:Enduse11[36]"			Proj:ResultSummary[3]:Enduse11[36]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[11]:DesignRatingSrc[2] - RunResultsE[11]:ProposedSrc[2] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse12[36]"			Proj:ResultSummary[3]:Enduse12[36]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[12]:DesignRatingSrc[2] - RunResultsE[12]:ProposedSrc[2] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse13[36]"			Proj:ResultSummary[3]:Enduse13[36]	= {	if (LocalCompAssigned( RunResultsE[13] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[13]:DesignRatingSrc[2] - RunResultsE[13]:ProposedSrc[2] ), 2 )  endif  }

; SOUTH
 	"Set ResultSummary[4]:EDR1DesignRating"			Proj:ResultSummary[4]:EDR1DesignRating		= {
         if (IfValidAnd( RunResultsS[10]:DesignRatingSrc[2] != 0 )==0) then  UNDEFINED
      ;   else if (LocalStatus( ResultSummary[4]:PFlxSrc[2] ) > 0 .AND. LocalStatus( RunResultsS[11]:ProposedSrc[3] ) > 0)
      ;   then   int( ((ResultSummary[4]:PFlxSrc[2] +
      ;                 ValidOr( RunResultsS[10]:ProposedSrc[3], 0 )) * 1000 / RunResultsS[10]:DesignRatingSrc[2])+0.5 )/10
         else   int( ( ValidOr( RunResultsS[10]:ProposedSrc[3], 0 )  * 1000 / RunResultsS[10]:DesignRatingSrc[2])+0.5 )/10
         endif  }  ; endif  }
 	"Set ResultSummary[4]:EDR1DesignRatingStd"		Proj:ResultSummary[4]:EDR1DesignRatingStd		= {
         if (IfValidAnd( RunResultsS[10]:DesignRatingSrc[2] != 0 )==0 .OR.
             AnalysisType < 3) then  UNDEFINED
			else	int( ((	RunResultsS[1]:StdElecSrc[1] + RunResultsS[1]:StdNatGasSrc + RunResultsS[1]:StdOtherSrc +  ; SpcHt
      					 +	RunResultsS[2]:StdElecSrc[1] + RunResultsS[2]:StdNatGasSrc + RunResultsS[2]:StdOtherSrc +  ; SpcCl
      					 +	RunResultsS[3]:StdElecSrc[1]    ; IAQVent
		      			 +	RunResultsS[4]:StandardSrc[1]   ; OthrHVAC
      					 +	RunResultsS[5]:StdElecSrc[1] + RunResultsS[5]:StdNatGasSrc + RunResultsS[5]:StdOtherSrc +  ; WtrHt
		      			 +	RunResultsS[6]:StandardSrc[1]   ; InsLtg
      					 +	RunResultsS[7]:StdElecSrc[1] + RunResultsS[7]:StdNatGasSrc + RunResultsS[7]:StdOtherSrc +  ; AppCkg
		      			 +	RunResultsS[8]:StandardSrc[1]   ; Plugs
				      	 +	RunResultsS[9]:StandardSrc[1]   ; Ext
      					 +	RunResultsS[13]:StandardSrc[1]   ; PV
		      			 +	RunResultsS[14]:StandardSrc[1] ) ; Battery
				      			* 1000 / RunResultsS[10]:DesignRatingSrc[2])+0.5 )/10    endif  }

  ; Proposed Src
	"Set ResultSummary[4]:Title1[31]"				Proj:ResultSummary[4]:Title1[31]		= {	if (EnergyCodeYearNum < 2022) then  "Proposed"       else  UNDEFINED        endif  }
	"Set ResultSummary[4]:Title2[31]"				Proj:ResultSummary[4]:Title2[31]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "EDR1"  else  "Source"  endif endif  }   ; SAC 11/24/22
	"Set ResultSummary[4]:Title3[31]"				Proj:ResultSummary[4]:Title3[31]		= {	if (EnergyCodeYearNum < 2022) then  "(kBtu/ft-yr)"  else  "(kBtu/ft-yr)"  endif  }
	"Set ResultSummary[4]:Enduse1[31]"			Proj:ResultSummary[4]:Enduse1[31]		= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[1]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[4]:Enduse2[31]"			Proj:ResultSummary[4]:Enduse2[31]		= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[2]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[4]:Enduse3[31]"			Proj:ResultSummary[4]:Enduse3[31]		= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[3]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[4]:Enduse4[31]"			Proj:ResultSummary[4]:Enduse4[31]		= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[4]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[4]:Enduse5[31]"			Proj:ResultSummary[4]:Enduse5[31]		= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[5]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[4]:Enduse14[31]"			Proj:ResultSummary[4]:Enduse14[31]	= {	if (LocalCompAssigned( RunResultsS[14] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[14]:ProposedSrc[1], 2 )  endif  }
	"Set ResultSummary[4]:Enduse6[31]"			Proj:ResultSummary[4]:Enduse6[31]		= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[6]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[4]:Enduse7[31]"			Proj:ResultSummary[4]:Enduse7[31]		= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[7]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[4]:Enduse8[31]"			Proj:ResultSummary[4]:Enduse8[31]		= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[8]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[4]:Enduse9[31]"			Proj:ResultSummary[4]:Enduse9[31]		= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[9]:ProposedSrc[1] , 2 )  endif  }
 	"Set ResultSummary[4]:Enduse10[31]"			Proj:ResultSummary[4]:Enduse10[31]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[10]:ProposedSrc[1], 2 )  endif  }
 	"Set ResultSummary[4]:Enduse11[31]"			Proj:ResultSummary[4]:Enduse11[31]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[11]:ProposedSrc[1], 2 )  endif  }
 	"Set ResultSummary[4]:Enduse12[31]"			Proj:ResultSummary[4]:Enduse12[31]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[12]:ProposedSrc[1], 2 )  endif  }
 	"Set ResultSummary[4]:Enduse13[31]"			Proj:ResultSummary[4]:Enduse13[31]	= {	if (LocalCompAssigned( RunResultsS[13] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[13]:ProposedSrc[1], 2 )  endif  }

  ; Standard Src
	"Set ResultSummary[4]:Title1[32]"				Proj:ResultSummary[4]:Title1[32]		= {	if (EnergyCodeYearNum < 2022) then  "Standard"       else  UNDEFINED        endif  }
	"Set ResultSummary[4]:Title2[32]"				Proj:ResultSummary[4]:Title2[32]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "EDR1"  else  "Source"  endif endif  }   ; SAC 11/23/22
	"Set ResultSummary[4]:Title3[32]"				Proj:ResultSummary[4]:Title3[32]		= {	if (EnergyCodeYearNum < 2022) then  "(kBtu/ft-yr)"  else  "(kBtu/ft-yr)"  endif  }
	"Set ResultSummary[4]:Enduse1[32]"			Proj:ResultSummary[4]:Enduse1[32]		= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[1]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[4]:Enduse2[32]"			Proj:ResultSummary[4]:Enduse2[32]		= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[2]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[4]:Enduse3[32]"			Proj:ResultSummary[4]:Enduse3[32]		= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[3]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[4]:Enduse4[32]"			Proj:ResultSummary[4]:Enduse4[32]		= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[4]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[4]:Enduse5[32]"			Proj:ResultSummary[4]:Enduse5[32]		= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[5]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[4]:Enduse6[32]"			Proj:ResultSummary[4]:Enduse6[32]		= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[6]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[4]:Enduse7[32]"			Proj:ResultSummary[4]:Enduse7[32]		= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[7]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[4]:Enduse8[32]"			Proj:ResultSummary[4]:Enduse8[32]		= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[8]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[4]:Enduse9[32]"			Proj:ResultSummary[4]:Enduse9[32]		= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[9]:StandardSrc , 2 )  endif  }
 	"Set ResultSummary[4]:Enduse10[32]"			Proj:ResultSummary[4]:Enduse10[32]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[10]:StandardSrc, 2 )  endif  }
 	"Set ResultSummary[4]:Enduse11[32]"			Proj:ResultSummary[4]:Enduse11[32]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[11]:StandardSrc, 2 )  endif  }
 	"Set ResultSummary[4]:Enduse12[32]"			Proj:ResultSummary[4]:Enduse12[32]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[12]:StandardSrc, 2 )  endif  }
	"Set ResultSummary[4]:Enduse13[32]"			Proj:ResultSummary[4]:Enduse13[32]	= {	if (LocalCompAssigned( RunResultsS[13] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsS[13]:StandardSrc = 0 )) then  " "  else  FltToStr( RunResultsS[13]:StandardSrc, 2 )  endif endif  }
	"Set ResultSummary[4]:Enduse14[32]"			Proj:ResultSummary[4]:Enduse14[32]	= {	if (LocalCompAssigned( RunResultsS[14] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsS[14]:StandardSrc = 0 )) then  " "  else  FltToStr( RunResultsS[14]:StandardSrc, 2 )  endif endif  }

  ; Compliance Margin Src
	"Set ResultSummary[4]:Title1[33]"				Proj:ResultSummary[4]:Title1[33]		= {	if (EnergyCodeYearNum < 2022) then  "Compliance"     else  UNDEFINED        endif  }
	"Set ResultSummary[4]:Title2[33]"				Proj:ResultSummary[4]:Title2[33]		= {	if (EnergyCodeYearNum < 2022) then  "Margin"         else if (EnergyCodeYearNum < 2025) then  "EDR1    "  else  "Source"  endif endif  }   ; SAC 11/25/22
	"Set ResultSummary[4]:Title3[33]"				Proj:ResultSummary[4]:Title3[33]		= {	if (EnergyCodeYearNum < 2022) then  "(kBtu/ft-yr)"  else  "(kBtu/ft-yr)"  endif  }
	"Set ResultSummary[4]:Enduse1[33]"			Proj:ResultSummary[4]:Enduse1[33]		= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[1]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[4]:Enduse2[33]"			Proj:ResultSummary[4]:Enduse2[33]		= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[2]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[4]:Enduse3[33]"			Proj:ResultSummary[4]:Enduse3[33]		= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[3]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[4]:Enduse4[33]"			Proj:ResultSummary[4]:Enduse4[33]		= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[4]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[4]:Enduse5[33]"			Proj:ResultSummary[4]:Enduse5[33]		= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[5]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[4]:Enduse14[33]"			Proj:ResultSummary[4]:Enduse14[33]	= {	if (LocalCompAssigned( RunResultsS[14] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[14]:CompMarginSrc, 2 )  endif  }
	"Set ResultSummary[4]:Enduse6[33]"			Proj:ResultSummary[4]:Enduse6[33]		= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[6]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[4]:Enduse7[33]"			Proj:ResultSummary[4]:Enduse7[33]		= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[7]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[4]:Enduse8[33]"			Proj:ResultSummary[4]:Enduse8[33]		= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[8]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[4]:Enduse9[33]"			Proj:ResultSummary[4]:Enduse9[33]		= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[9]:CompMarginSrc , 2 )  endif  }
 	"Set ResultSummary[4]:Enduse10[33]"			Proj:ResultSummary[4]:Enduse10[33]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[10]:CompMarginSrc, 2 )  endif  }
 	"Set ResultSummary[4]:Enduse11[33]"			Proj:ResultSummary[4]:Enduse11[33]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[11]:CompMarginSrc, 2 )  endif  }
 	"Set ResultSummary[4]:Enduse12[33]"			Proj:ResultSummary[4]:Enduse12[33]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[12]:CompMarginSrc, 2 )  endif  }
 	"Set ResultSummary[4]:Enduse13[33]"			Proj:ResultSummary[4]:Enduse13[33]	= {	if (LocalCompAssigned( RunResultsS[13] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[13]:CompMarginSrc, 2 )  endif  }

  ; Design Rating Proposed Src
	"Set ResultSummary[4]:Title1[34]"			Proj:ResultSummary[4]:Title1[34]			= {	ResultSummary[4]:Title1[31]  }	; Proposed Total Src -> DRtg Prop Total Src
	"Set ResultSummary[4]:Title2[34]"			Proj:ResultSummary[4]:Title2[34]			= {	ResultSummary[4]:Title2[31]  }
	"Set ResultSummary[4]:Title3[34]"			Proj:ResultSummary[4]:Title3[34]			= {	ResultSummary[4]:Title3[31]  }
	"Set ResultSummary[4]:Enduse1[34]"			Proj:ResultSummary[4]:Enduse1[34]		= {	ResultSummary[4]:Enduse1[31]  }
	"Set ResultSummary[4]:Enduse2[34]"			Proj:ResultSummary[4]:Enduse2[34]		= {	ResultSummary[4]:Enduse2[31]  }
	"Set ResultSummary[4]:Enduse3[34]"			Proj:ResultSummary[4]:Enduse3[34]		= {	ResultSummary[4]:Enduse3[31]  }
	"Set ResultSummary[4]:Enduse4[34]"			Proj:ResultSummary[4]:Enduse4[34]		= {	ResultSummary[4]:Enduse4[31]  }
	"Set ResultSummary[4]:Enduse5[34]"			Proj:ResultSummary[4]:Enduse5[34]		= {	ResultSummary[4]:Enduse5[31]  }
	"Set ResultSummary[4]:Enduse6[34]"			Proj:ResultSummary[4]:Enduse6[34]		= {	ResultSummary[4]:Enduse6[31]  }
	"Set ResultSummary[4]:Enduse7[34]"			Proj:ResultSummary[4]:Enduse7[34]		= {	ResultSummary[4]:Enduse7[31]  }
	"Set ResultSummary[4]:Enduse8[34]"			Proj:ResultSummary[4]:Enduse8[34]		= {	ResultSummary[4]:Enduse8[31]  }
	"Set ResultSummary[4]:Enduse9[34]"			Proj:ResultSummary[4]:Enduse9[34]		= {	ResultSummary[4]:Enduse9[31]  }
	"Set ResultSummary[4]:Enduse10[34]"			Proj:ResultSummary[4]:Enduse10[34]		= {	ResultSummary[4]:Enduse10[31]  }
	"Set ResultSummary[4]:Enduse11[34]"			Proj:ResultSummary[4]:Enduse11[34]		= {	ResultSummary[4]:Enduse11[31]  }
	"Set ResultSummary[4]:Enduse12[34]"			Proj:ResultSummary[4]:Enduse12[34]		= {	ResultSummary[4]:Enduse12[31]  }
	"Set ResultSummary[4]:Enduse13[34]"			Proj:ResultSummary[4]:Enduse13[34]		= {	ResultSummary[4]:Enduse13[31]  }
	"Set ResultSummary[4]:Enduse14[34]"			Proj:ResultSummary[4]:Enduse14[34]		= {	ResultSummary[4]:Enduse14[31]  }
;	"Set ResultSummary[4]:SummaryCol1[34]"		Proj:ResultSummary[4]:SummaryCol1[34]	= {	ResultSummary[4]:SummaryCol1[31]  } 
;	"Set ResultSummary[4]:SummaryCol2[34]"		Proj:ResultSummary[4]:SummaryCol2[34]	= {	ResultSummary[4]:SummaryCol2[31]  }
;	"Set ResultSummary[4]:SummaryCol3[34]"		Proj:ResultSummary[4]:SummaryCol3[34]	= {	ResultSummary[4]:SummaryCol3[31]  }

  ; DesignRating Src
	"Set ResultSummary[4]:Title1[35]"			Proj:ResultSummary[4]:Title1[35]		= {	if (EnergyCodeYearNum < 2022) then  "Reference"      else  UNDEFINED        endif  }
	"Set ResultSummary[4]:Title2[35]"			Proj:ResultSummary[4]:Title2[35]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else  "EDR1"           endif  }
	"Set ResultSummary[4]:Title3[35]"			Proj:ResultSummary[4]:Title3[35]		= {	if (EnergyCodeYearNum < 2022) then  "(kBtu/ft-yr)"  else  "(kBtu/ft-yr)"  endif  }
	"Set ResultSummary[4]:Enduse1[35]"			Proj:ResultSummary[4]:Enduse1[35]	= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[1]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse2[35]"			Proj:ResultSummary[4]:Enduse2[35]	= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[2]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse3[35]"			Proj:ResultSummary[4]:Enduse3[35]	= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[3]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse4[35]"			Proj:ResultSummary[4]:Enduse4[35]	= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[4]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse5[35]"			Proj:ResultSummary[4]:Enduse5[35]	= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[5]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse6[35]"			Proj:ResultSummary[4]:Enduse6[35]	= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[6]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse7[35]"			Proj:ResultSummary[4]:Enduse7[35]	= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[7]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse8[35]"			Proj:ResultSummary[4]:Enduse8[35]	= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[8]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse9[35]"			Proj:ResultSummary[4]:Enduse9[35]	= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[9]:DesignRatingSrc[2]  ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse10[35]"			Proj:ResultSummary[4]:Enduse10[35]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[10]:DesignRatingSrc[2] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse11[35]"			Proj:ResultSummary[4]:Enduse11[35]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[11]:DesignRatingSrc[2] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse12[35]"			Proj:ResultSummary[4]:Enduse12[35]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[12]:DesignRatingSrc[2] ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse13[35]"			Proj:ResultSummary[4]:Enduse13[35]	= {	if (LocalCompAssigned( RunResultsS[13] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsS[13]:DesignRatingSrc[2] = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsS[13]:DesignRatingSrc[2] ), 2 )  endif endif  }
	"Set ResultSummary[4]:Enduse14[35]"			Proj:ResultSummary[4]:Enduse14[35]	= {	if (LocalCompAssigned( RunResultsS[14] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsS[14]:DesignRatingSrc[2] = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsS[14]:DesignRatingSrc[2] ), 2 )  endif endif  }

  ; DesignRating Margin Src
	"Set ResultSummary[4]:Title1[36]"			Proj:ResultSummary[4]:Title1[36]		= {	if (EnergyCodeYearNum < 2022) then  "Design Rating"  else  UNDEFINED        endif  }
	"Set ResultSummary[4]:Title2[36]"			Proj:ResultSummary[4]:Title2[36]		= {	if (EnergyCodeYearNum < 2022) then  "Margin"         else  "EDR1"           endif  }
	"Set ResultSummary[4]:Title3[36]"			Proj:ResultSummary[4]:Title3[36]		= {	if (EnergyCodeYearNum < 2022) then  "(kBtu/ft-yr)"  else  "(kBtu/ft-yr)"  endif  }
	"Set ResultSummary[4]:Enduse1[36]"			Proj:ResultSummary[4]:Enduse1[36]	= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[1]:DesignRatingSrc[2]  - RunResultsS[1]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse2[36]"			Proj:ResultSummary[4]:Enduse2[36]	= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[2]:DesignRatingSrc[2]  - RunResultsS[2]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse3[36]"			Proj:ResultSummary[4]:Enduse3[36]	= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[3]:DesignRatingSrc[2]  - RunResultsS[3]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse4[36]"			Proj:ResultSummary[4]:Enduse4[36]	= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[4]:DesignRatingSrc[2]  - RunResultsS[4]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse5[36]"			Proj:ResultSummary[4]:Enduse5[36]	= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[5]:DesignRatingSrc[2]  - RunResultsS[5]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse14[36]"			Proj:ResultSummary[4]:Enduse14[36]	= {	if (LocalCompAssigned( RunResultsS[14] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[14]:DesignRatingSrc[2] - RunResultsS[14]:ProposedSrc[2] ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse6[36]"			Proj:ResultSummary[4]:Enduse6[36]	= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[6]:DesignRatingSrc[2]  - RunResultsS[6]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse7[36]"			Proj:ResultSummary[4]:Enduse7[36]	= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[7]:DesignRatingSrc[2]  - RunResultsS[7]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse8[36]"			Proj:ResultSummary[4]:Enduse8[36]	= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[8]:DesignRatingSrc[2]  - RunResultsS[8]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse9[36]"			Proj:ResultSummary[4]:Enduse9[36]	= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[9]:DesignRatingSrc[2]  - RunResultsS[9]:ProposedSrc[2]  ), 2 )  endif  }
;   ; SAC 2/2/19 - Flexibility reporting via new PFlxSrc property (tic #1053)
; 	"Set ResultSummary[4]:Enduse10[36]"			Proj:ResultSummary[4]:Enduse10[36]	= {
; 	      if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED
; 	      else  FltToStr( (int((RunResultsS[10]:DesignRatingSrc[2]*100)+0.5) - int((RunResultsS[10]:ProposedSrc[2]*100)+0.5)) / 100 - ValidOr( ResultSummary[4]:PFlxSrc[1], 0 ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse10[36]"			Proj:ResultSummary[4]:Enduse10[36]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  FltToStr( (int((RunResultsS[10]:DesignRatingSrc[2]*100)+0.5) - int((RunResultsS[10]:ProposedSrc[2]*100)+0.5)) / 100, 2 )  endif  }
 	"Set ResultSummary[4]:Enduse11[36]"			Proj:ResultSummary[4]:Enduse11[36]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[11]:DesignRatingSrc[2] - RunResultsS[11]:ProposedSrc[2] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse12[36]"			Proj:ResultSummary[4]:Enduse12[36]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[12]:DesignRatingSrc[2] - RunResultsS[12]:ProposedSrc[2] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse13[36]"			Proj:ResultSummary[4]:Enduse13[36]	= {	if (LocalCompAssigned( RunResultsS[13] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[13]:DesignRatingSrc[2] - RunResultsS[13]:ProposedSrc[2] ), 2 )  endif  }

; WEST
 	"Set ResultSummary[5]:EDR1DesignRating"			Proj:ResultSummary[5]:EDR1DesignRating		= {
         if (IfValidAnd( RunResultsW[10]:DesignRatingSrc[2] != 0 )==0) then  UNDEFINED
      ;   else if (LocalStatus( ResultSummary[5]:PFlxSrc[2] ) > 0 .AND. LocalStatus( RunResultsW[11]:ProposedSrc[3] ) > 0)
      ;   then   int( ((ResultSummary[5]:PFlxSrc[2] +
      ;                 ValidOr( RunResultsW[10]:ProposedSrc[3], 0 )) * 1000 / RunResultsW[10]:DesignRatingSrc[2])+0.5 )/10
         else   int( ( ValidOr( RunResultsW[10]:ProposedSrc[3], 0 )  * 1000 / RunResultsW[10]:DesignRatingSrc[2])+0.5 )/10
         endif  }  ; endif  }
 	"Set ResultSummary[5]:EDR1DesignRatingStd"		Proj:ResultSummary[5]:EDR1DesignRatingStd		= {
         if (IfValidAnd( RunResultsW[10]:DesignRatingSrc[2] != 0 )==0 .OR.
             AnalysisType < 3) then  UNDEFINED
			else	int( ((	RunResultsW[1]:StdElecSrc[1] + RunResultsW[1]:StdNatGasSrc + RunResultsW[1]:StdOtherSrc +  ; SpcHt
      					 +	RunResultsW[2]:StdElecSrc[1] + RunResultsW[2]:StdNatGasSrc + RunResultsW[2]:StdOtherSrc +  ; SpcCl
      					 +	RunResultsW[3]:StdElecSrc[1]    ; IAQVent
		      			 +	RunResultsW[4]:StandardSrc[1]   ; OthrHVAC
      					 +	RunResultsW[5]:StdElecSrc[1] + RunResultsW[5]:StdNatGasSrc + RunResultsW[5]:StdOtherSrc +  ; WtrHt
		      			 +	RunResultsW[6]:StandardSrc[1]   ; InsLtg
      					 +	RunResultsW[7]:StdElecSrc[1] + RunResultsW[7]:StdNatGasSrc + RunResultsW[7]:StdOtherSrc +  ; AppCkg
		      			 +	RunResultsW[8]:StandardSrc[1]   ; Plugs
				      	 +	RunResultsW[9]:StandardSrc[1]   ; Ext
      					 +	RunResultsW[13]:StandardSrc[1]   ; PV
		      			 +	RunResultsW[14]:StandardSrc[1] ) ; Battery
				      			* 1000 / RunResultsW[10]:DesignRatingSrc[2])+0.5 )/10    endif  }

  ; Proposed Src
	"Set ResultSummary[5]:Title1[31]"				Proj:ResultSummary[5]:Title1[31]		= {	if (EnergyCodeYearNum < 2022) then  "Proposed"       else  UNDEFINED        endif  }
	"Set ResultSummary[5]:Title2[31]"				Proj:ResultSummary[5]:Title2[31]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "EDR1"  else  "Source"  endif endif  }   ; SAC 11/24/22
	"Set ResultSummary[5]:Title3[31]"				Proj:ResultSummary[5]:Title3[31]		= {	if (EnergyCodeYearNum < 2022) then  "(kBtu/ft-yr)"  else  "(kBtu/ft-yr)"  endif  }
	"Set ResultSummary[5]:Enduse1[31]"			Proj:ResultSummary[5]:Enduse1[31]		= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[1]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[5]:Enduse2[31]"			Proj:ResultSummary[5]:Enduse2[31]		= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[2]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[5]:Enduse3[31]"			Proj:ResultSummary[5]:Enduse3[31]		= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[3]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[5]:Enduse4[31]"			Proj:ResultSummary[5]:Enduse4[31]		= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[4]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[5]:Enduse5[31]"			Proj:ResultSummary[5]:Enduse5[31]		= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[5]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[5]:Enduse14[31]"			Proj:ResultSummary[5]:Enduse14[31]	= {	if (LocalCompAssigned( RunResultsW[14] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[14]:ProposedSrc[1], 2 )  endif  }
	"Set ResultSummary[5]:Enduse6[31]"			Proj:ResultSummary[5]:Enduse6[31]		= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[6]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[5]:Enduse7[31]"			Proj:ResultSummary[5]:Enduse7[31]		= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[7]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[5]:Enduse8[31]"			Proj:ResultSummary[5]:Enduse8[31]		= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[8]:ProposedSrc[1] , 2 )  endif  }
	"Set ResultSummary[5]:Enduse9[31]"			Proj:ResultSummary[5]:Enduse9[31]		= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[9]:ProposedSrc[1] , 2 )  endif  }
 	"Set ResultSummary[5]:Enduse10[31]"			Proj:ResultSummary[5]:Enduse10[31]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[10]:ProposedSrc[1], 2 )  endif  }
 	"Set ResultSummary[5]:Enduse11[31]"			Proj:ResultSummary[5]:Enduse11[31]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[11]:ProposedSrc[1], 2 )  endif  }
 	"Set ResultSummary[5]:Enduse12[31]"			Proj:ResultSummary[5]:Enduse12[31]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[12]:ProposedSrc[1], 2 )  endif  }
 	"Set ResultSummary[5]:Enduse13[31]"			Proj:ResultSummary[5]:Enduse13[31]	= {	if (LocalCompAssigned( RunResultsW[13] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[13]:ProposedSrc[1], 2 )  endif  }

  ; Standard Src
	"Set ResultSummary[5]:Title1[32]"				Proj:ResultSummary[5]:Title1[32]		= {	if (EnergyCodeYearNum < 2022) then  "Standard"       else  UNDEFINED        endif  }
	"Set ResultSummary[5]:Title2[32]"				Proj:ResultSummary[5]:Title2[32]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "EDR1"  else  "Source"  endif endif  }   ; SAC 11/23/22
	"Set ResultSummary[5]:Title3[32]"				Proj:ResultSummary[5]:Title3[32]		= {	if (EnergyCodeYearNum < 2022) then  "(kBtu/ft-yr)"  else  "(kBtu/ft-yr)"  endif  }
	"Set ResultSummary[5]:Enduse1[32]"			Proj:ResultSummary[5]:Enduse1[32]		= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[1]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[5]:Enduse2[32]"			Proj:ResultSummary[5]:Enduse2[32]		= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[2]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[5]:Enduse3[32]"			Proj:ResultSummary[5]:Enduse3[32]		= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[3]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[5]:Enduse4[32]"			Proj:ResultSummary[5]:Enduse4[32]		= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[4]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[5]:Enduse5[32]"			Proj:ResultSummary[5]:Enduse5[32]		= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[5]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[5]:Enduse6[32]"			Proj:ResultSummary[5]:Enduse6[32]		= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[6]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[5]:Enduse7[32]"			Proj:ResultSummary[5]:Enduse7[32]		= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[7]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[5]:Enduse8[32]"			Proj:ResultSummary[5]:Enduse8[32]		= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[8]:StandardSrc , 2 )  endif  }
	"Set ResultSummary[5]:Enduse9[32]"			Proj:ResultSummary[5]:Enduse9[32]		= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[9]:StandardSrc , 2 )  endif  }
 	"Set ResultSummary[5]:Enduse10[32]"			Proj:ResultSummary[5]:Enduse10[32]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[10]:StandardSrc, 2 )  endif  }
 	"Set ResultSummary[5]:Enduse11[32]"			Proj:ResultSummary[5]:Enduse11[32]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[11]:StandardSrc, 2 )  endif  }
 	"Set ResultSummary[5]:Enduse12[32]"			Proj:ResultSummary[5]:Enduse12[32]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[12]:StandardSrc, 2 )  endif  }
	"Set ResultSummary[5]:Enduse13[32]"			Proj:ResultSummary[5]:Enduse13[32]	= {	if (LocalCompAssigned( RunResultsW[13] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsW[13]:StandardSrc = 0 )) then  " "  else  FltToStr( RunResultsW[13]:StandardSrc, 2 )  endif endif  }
	"Set ResultSummary[5]:Enduse14[32]"			Proj:ResultSummary[5]:Enduse14[32]	= {	if (LocalCompAssigned( RunResultsW[14] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsW[14]:StandardSrc = 0 )) then  " "  else  FltToStr( RunResultsW[14]:StandardSrc, 2 )  endif endif  }

  ; Compliance Margin Src
	"Set ResultSummary[5]:Title1[33]"				Proj:ResultSummary[5]:Title1[33]		= {	if (EnergyCodeYearNum < 2022) then  "Compliance"     else  UNDEFINED        endif  }
	"Set ResultSummary[5]:Title2[33]"				Proj:ResultSummary[5]:Title2[33]		= {	if (EnergyCodeYearNum < 2022) then  "Margin"         else if (EnergyCodeYearNum < 2025) then  "EDR1    "  else  "Source"  endif endif  }   ; SAC 11/25/22
	"Set ResultSummary[5]:Title3[33]"				Proj:ResultSummary[5]:Title3[33]		= {	if (EnergyCodeYearNum < 2022) then  "(kBtu/ft-yr)"  else  "(kBtu/ft-yr)"  endif  }
	"Set ResultSummary[5]:Enduse1[33]"			Proj:ResultSummary[5]:Enduse1[33]		= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[1]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[5]:Enduse2[33]"			Proj:ResultSummary[5]:Enduse2[33]		= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[2]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[5]:Enduse3[33]"			Proj:ResultSummary[5]:Enduse3[33]		= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[3]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[5]:Enduse4[33]"			Proj:ResultSummary[5]:Enduse4[33]		= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[4]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[5]:Enduse5[33]"			Proj:ResultSummary[5]:Enduse5[33]		= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[5]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[5]:Enduse14[33]"			Proj:ResultSummary[5]:Enduse14[33]	= {	if (LocalCompAssigned( RunResultsW[14] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[14]:CompMarginSrc, 2 )  endif  }
	"Set ResultSummary[5]:Enduse6[33]"			Proj:ResultSummary[5]:Enduse6[33]		= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[6]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[5]:Enduse7[33]"			Proj:ResultSummary[5]:Enduse7[33]		= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[7]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[5]:Enduse8[33]"			Proj:ResultSummary[5]:Enduse8[33]		= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[8]:CompMarginSrc , 2 )  endif  }
	"Set ResultSummary[5]:Enduse9[33]"			Proj:ResultSummary[5]:Enduse9[33]		= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[9]:CompMarginSrc , 2 )  endif  }
 	"Set ResultSummary[5]:Enduse10[33]"			Proj:ResultSummary[5]:Enduse10[33]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[10]:CompMarginSrc, 2 )  endif  }
 	"Set ResultSummary[5]:Enduse11[33]"			Proj:ResultSummary[5]:Enduse11[33]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[11]:CompMarginSrc, 2 )  endif  }
 	"Set ResultSummary[5]:Enduse12[33]"			Proj:ResultSummary[5]:Enduse12[33]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[12]:CompMarginSrc, 2 )  endif  }
 	"Set ResultSummary[5]:Enduse13[33]"			Proj:ResultSummary[5]:Enduse13[33]	= {	if (LocalCompAssigned( RunResultsW[13] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[13]:CompMarginSrc, 2 )  endif  }

  ; Design Rating Proposed Src
	"Set ResultSummary[5]:Title1[34]"			Proj:ResultSummary[5]:Title1[34]			= {	ResultSummary[5]:Title1[31]  }	; Proposed Total Src -> DRtg Prop Total Src
	"Set ResultSummary[5]:Title2[34]"			Proj:ResultSummary[5]:Title2[34]			= {	ResultSummary[5]:Title2[31]  }
	"Set ResultSummary[5]:Title3[34]"			Proj:ResultSummary[5]:Title3[34]			= {	ResultSummary[5]:Title3[31]  }
	"Set ResultSummary[5]:Enduse1[34]"			Proj:ResultSummary[5]:Enduse1[34]		= {	ResultSummary[5]:Enduse1[31]  }
	"Set ResultSummary[5]:Enduse2[34]"			Proj:ResultSummary[5]:Enduse2[34]		= {	ResultSummary[5]:Enduse2[31]  }
	"Set ResultSummary[5]:Enduse3[34]"			Proj:ResultSummary[5]:Enduse3[34]		= {	ResultSummary[5]:Enduse3[31]  }
	"Set ResultSummary[5]:Enduse4[34]"			Proj:ResultSummary[5]:Enduse4[34]		= {	ResultSummary[5]:Enduse4[31]  }
	"Set ResultSummary[5]:Enduse5[34]"			Proj:ResultSummary[5]:Enduse5[34]		= {	ResultSummary[5]:Enduse5[31]  }
	"Set ResultSummary[5]:Enduse6[34]"			Proj:ResultSummary[5]:Enduse6[34]		= {	ResultSummary[5]:Enduse6[31]  }
	"Set ResultSummary[5]:Enduse7[34]"			Proj:ResultSummary[5]:Enduse7[34]		= {	ResultSummary[5]:Enduse7[31]  }
	"Set ResultSummary[5]:Enduse8[34]"			Proj:ResultSummary[5]:Enduse8[34]		= {	ResultSummary[5]:Enduse8[31]  }
	"Set ResultSummary[5]:Enduse9[34]"			Proj:ResultSummary[5]:Enduse9[34]		= {	ResultSummary[5]:Enduse9[31]  }
	"Set ResultSummary[5]:Enduse10[34]"			Proj:ResultSummary[5]:Enduse10[34]		= {	ResultSummary[5]:Enduse10[31]  }
	"Set ResultSummary[5]:Enduse11[34]"			Proj:ResultSummary[5]:Enduse11[34]		= {	ResultSummary[5]:Enduse11[31]  }
	"Set ResultSummary[5]:Enduse12[34]"			Proj:ResultSummary[5]:Enduse12[34]		= {	ResultSummary[5]:Enduse12[31]  }
	"Set ResultSummary[5]:Enduse13[34]"			Proj:ResultSummary[5]:Enduse13[34]		= {	ResultSummary[5]:Enduse13[31]  }
	"Set ResultSummary[5]:Enduse14[34]"			Proj:ResultSummary[5]:Enduse14[34]		= {	ResultSummary[5]:Enduse14[31]  }
;	"Set ResultSummary[5]:SummaryCol1[34]"		Proj:ResultSummary[5]:SummaryCol1[34]	= {	ResultSummary[5]:SummaryCol1[31]  } 
;	"Set ResultSummary[5]:SummaryCol2[34]"		Proj:ResultSummary[5]:SummaryCol2[34]	= {	ResultSummary[5]:SummaryCol2[31]  }
;	"Set ResultSummary[5]:SummaryCol3[34]"		Proj:ResultSummary[5]:SummaryCol3[34]	= {	ResultSummary[5]:SummaryCol3[31]  }

  ; DesignRating Src
	"Set ResultSummary[5]:Title1[35]"			Proj:ResultSummary[5]:Title1[35]		= {	if (EnergyCodeYearNum < 2022) then  "Reference"      else  UNDEFINED        endif  }
	"Set ResultSummary[5]:Title2[35]"			Proj:ResultSummary[5]:Title2[35]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else  "EDR1"           endif  }
	"Set ResultSummary[5]:Title3[35]"			Proj:ResultSummary[5]:Title3[35]		= {	if (EnergyCodeYearNum < 2022) then  "(kBtu/ft-yr)"  else  "(kBtu/ft-yr)"  endif  }
	"Set ResultSummary[5]:Enduse1[35]"			Proj:ResultSummary[5]:Enduse1[35]	= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[1]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse2[35]"			Proj:ResultSummary[5]:Enduse2[35]	= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[2]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse3[35]"			Proj:ResultSummary[5]:Enduse3[35]	= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[3]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse4[35]"			Proj:ResultSummary[5]:Enduse4[35]	= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[4]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse5[35]"			Proj:ResultSummary[5]:Enduse5[35]	= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[5]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse6[35]"			Proj:ResultSummary[5]:Enduse6[35]	= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[6]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse7[35]"			Proj:ResultSummary[5]:Enduse7[35]	= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[7]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse8[35]"			Proj:ResultSummary[5]:Enduse8[35]	= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[8]:DesignRatingSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse9[35]"			Proj:ResultSummary[5]:Enduse9[35]	= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[9]:DesignRatingSrc[2]  ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse10[35]"			Proj:ResultSummary[5]:Enduse10[35]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[10]:DesignRatingSrc[2] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse11[35]"			Proj:ResultSummary[5]:Enduse11[35]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[11]:DesignRatingSrc[2] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse12[35]"			Proj:ResultSummary[5]:Enduse12[35]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[12]:DesignRatingSrc[2] ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse13[35]"			Proj:ResultSummary[5]:Enduse13[35]	= {	if (LocalCompAssigned( RunResultsW[13] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsW[13]:DesignRatingSrc[2] = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsW[13]:DesignRatingSrc[2] ), 2 )  endif endif  }
	"Set ResultSummary[5]:Enduse14[35]"			Proj:ResultSummary[5]:Enduse14[35]	= {	if (LocalCompAssigned( RunResultsW[14] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsW[14]:DesignRatingSrc[2] = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsW[14]:DesignRatingSrc[2] ), 2 )  endif endif  }

  ; DesignRating Margin Src
	"Set ResultSummary[5]:Title1[36]"			Proj:ResultSummary[5]:Title1[36]		= {	if (EnergyCodeYearNum < 2022) then  "Design Rating"  else  UNDEFINED        endif  }
	"Set ResultSummary[5]:Title2[36]"			Proj:ResultSummary[5]:Title2[36]		= {	if (EnergyCodeYearNum < 2022) then  "Margin"         else  "EDR1"           endif  }
	"Set ResultSummary[5]:Title3[36]"			Proj:ResultSummary[5]:Title3[36]		= {	if (EnergyCodeYearNum < 2022) then  "(kBtu/ft-yr)"  else  "(kBtu/ft-yr)"  endif  }
	"Set ResultSummary[5]:Enduse1[36]"			Proj:ResultSummary[5]:Enduse1[36]	= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[1]:DesignRatingSrc[2]  - RunResultsW[1]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse2[36]"			Proj:ResultSummary[5]:Enduse2[36]	= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[2]:DesignRatingSrc[2]  - RunResultsW[2]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse3[36]"			Proj:ResultSummary[5]:Enduse3[36]	= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[3]:DesignRatingSrc[2]  - RunResultsW[3]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse4[36]"			Proj:ResultSummary[5]:Enduse4[36]	= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[4]:DesignRatingSrc[2]  - RunResultsW[4]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse5[36]"			Proj:ResultSummary[5]:Enduse5[36]	= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[5]:DesignRatingSrc[2]  - RunResultsW[5]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse14[36]"			Proj:ResultSummary[5]:Enduse14[36]	= {	if (LocalCompAssigned( RunResultsW[14] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[14]:DesignRatingSrc[2] - RunResultsW[14]:ProposedSrc[2] ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse6[36]"			Proj:ResultSummary[5]:Enduse6[36]	= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[6]:DesignRatingSrc[2]  - RunResultsW[6]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse7[36]"			Proj:ResultSummary[5]:Enduse7[36]	= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[7]:DesignRatingSrc[2]  - RunResultsW[7]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse8[36]"			Proj:ResultSummary[5]:Enduse8[36]	= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[8]:DesignRatingSrc[2]  - RunResultsW[8]:ProposedSrc[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse9[36]"			Proj:ResultSummary[5]:Enduse9[36]	= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[9]:DesignRatingSrc[2]  - RunResultsW[9]:ProposedSrc[2]  ), 2 )  endif  }
;   ; SAC 2/2/19 - Flexibility reporting via new PFlxSrc property (tic #1053)
; 	"Set ResultSummary[5]:Enduse10[36]"			Proj:ResultSummary[5]:Enduse10[36]	= {
; 	      if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED
; 	      else  FltToStr( (int((RunResultsW[10]:DesignRatingSrc[2]*100)+0.5) - int((RunResultsW[10]:ProposedSrc[2]*100)+0.5)) / 100 - ValidOr( ResultSummary[5]:PFlxSrc[1], 0 ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse10[36]"			Proj:ResultSummary[5]:Enduse10[36]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  FltToStr( (int((RunResultsW[10]:DesignRatingSrc[2]*100)+0.5) - int((RunResultsW[10]:ProposedSrc[2]*100)+0.5)) / 100, 2 )  endif  }
 	"Set ResultSummary[5]:Enduse11[36]"			Proj:ResultSummary[5]:Enduse11[36]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[11]:DesignRatingSrc[2] - RunResultsW[11]:ProposedSrc[2] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse12[36]"			Proj:ResultSummary[5]:Enduse12[36]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[12]:DesignRatingSrc[2] - RunResultsW[12]:ProposedSrc[2] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse13[36]"			Proj:ResultSummary[5]:Enduse13[36]	= {	if (LocalCompAssigned( RunResultsW[13] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[13]:DesignRatingSrc[2] - RunResultsW[13]:ProposedSrc[2] ), 2 )  endif  }

	"Call rules to set Worst case RunResults"		Proj:Action		= {	switch (WorstOrientation)
																								case  2 :  EvalRulelist( "CARes_RunResults_SetWorst_SrcEnergy_E" )
																								case  3 :  EvalRulelist( "CARes_RunResults_SetWorst_SrcEnergy_S" )
																								case  4 :  EvalRulelist( "CARes_RunResults_SetWorst_SrcEnergy_W" )
																								default :  EvalRulelist( "CARes_RunResults_SetWorst_SrcEnergy_N" )
																							endswitch  }
END
;*************************************************************************



;*************************************************************************
;*************************************************************************

ENDFILE
