; -------------------------------------------------------------------------
; Rules pertaining to:   Defaulting the Proposed Building Model's Construction objects
; CEC Title-24 Residential Energy Code
; -------------------------------------------------------------------------
; Copyright (c) 2012-2014, California Energy Commission
; Copyright (c) 2012-2014, Wrightsoft Corporation
; All rights reserved.
; Redistribution and use in source and binary forms, with or without modification,
; are permitted provided that the following conditions are met:
; - Redistributions of source code must retain the above copyright notice, this
;   list of conditions and the following disclaimer.
; - Redistributions in binary form must reproduce the above copyright notice, this
;   list of conditions, the following disclaimer in the documentation and/or other
;   materials provided with the distribution.
; - Neither the name of the California Energy Commission nor the names of its
;   contributors may be used to endorse or promote products derived from this
;   software without specific prior written permission.
; DISCLAIMER: THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
; "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
; THE IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
; NON-INFRINGEMENT ARE DISCLAIMED. IN NO EVENT SHALL CALIFORNIA ENERGY COMMISSION,
; WRIGHTSOFT CORPORATION, ITRON, INC. OR ANY OTHER AUTHOR OR COPYRIGHT HOLDER OF
; THIS SOFTWARE (COLLECTIVELY, THE "AUTHORS") BE LIABLE FOR ANY DIRECT, INDIRECT,
; INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
; LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
; OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
; LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
; OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
; ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.  EACH LICENSEE AND SUBLICENSEE OF THE
; SOFTWARE AGREES NOT TO ASSERT ANY CLAIM AGAINST ANY OF THE AUTHORS RELATING TO
; THIS SOFTWARE, WHETHER DUE TO PERFORMANCE ISSUES, TITLE OR INFRINGEMENT ISSUES,
; STRICT LIABILITY OR OTHERWISE.
; -------------------------------------------------------------------------

; SAC 10/24/16 - new rulelist to default Construction (incl. attic edge) properties
;*************************************************************************
RULELIST "ProposedInput_Constructions" 0 0 0 0
;*************************************************************************
   ;--------------------------------------------------------------------
   ; ProposedInput: Construction Rules
   ;--------------------------------------------------------------------
	"Default Cons:Type"		Cons:Type = {	switch( Local( CanAssignTo ) )
															case  0 :	 0		; Exterior Walls -> Wood Framed Wall
															case 10 :	 0		; Interior Walls -> Wood Framed Wall
															case 20 :	 2		; Underground Walls -> Concrete / ICF / Brick
															case  1 :	10		; Attic Roofs
															case  2 :	10		; Cathedral Ceilings
															case  3 :	10		; Ceiling (blw attc)
															case  4 :	20		; Interior Floors
															case  5 :	20		; Exterior Floors
															case  6 :	10		; Interior Ceilings
															case  9 :	20		; Flrs over Crawlspc
															default : -1
														endswitch  }

	"Set Cons:LayerOrderLabel"		Cons:LayerOrderLabel = {	switch ( Local( CanAssignTo ) )
																					case  0 :  "(inside to outside)"		; Exterior Walls
																					case 10 :  "(inside to outside)" 	  ; Interior Walls
																					case 20 :  "(inside to outside)" 	  ; Underground Walls
																					default :  "(topmost to bottom)"
																;					default :  "(vertically top to bottom)"
																				endswitch  }

	"Set Cons:SecTypeLabel"		Cons:SecTypeLabel	  = {	switch( Local( CanAssignTo ) )
																			case  0 :	" "					; Exterior Walls
																			case 10 :	" "					; Interior Walls
																			case  1 :	"Roofing Type:"	; Attic Roofs
																			case  2 :	"Roofing Type:"	; Cathedral Ceilings
																			case  3 :	" "					; Ceiling (blw attc)
																			case  4 :	" "					; Interior Floors
																			case  5 :	" "		; Above:"				; Exterior Floors
																			case  6 :	" "					; Interior Ceilings
																			case  9 :	" "		; Above:"				; Flrs over Crawlspc
																			default : " "
																		endswitch  }
	"Set Cons:LayerLabels[1]"	Cons:LayerLabels[1] = {	switch( Local( CanAssignTo ) ) ; DD 2/12/14 - Allow for changing labels based upon construction type
																			case  0 :	"Inside Finish:"		; Exterior Walls
																			case 10 :	"Inside Finish:"		; Interior Walls
																			case 20 :	"Inside Finish:"		; Underground Walls
																			case  1 :	"Roofing:"				; Attic Roofs
																			case  2 :	"Roofing:"				; Cathedral Ceilings
																			case  3 :	"Attic Floor:"			; Ceiling (blw attc)
																			case  4 :	"Floor Surface:"		; Interior Floors
																			case  5 :	"Floor Surface:"		; Exterior Floors
																			case  6 :	"Floor Surface:"		; Interior Ceilings
																			case  9 :	"Floor Surface:"		; Flrs over Crawlspc
																			default : " "
																		endswitch  }
	"Set Cons:LayerVar[1]"		Cons:LayerVar[1] = {		switch( Local( CanAssignTo ) )
																			case  0 :	0		; Exterior Walls		-> InsideFinishLayer 
																			case 10 :	0		; Interior Walls		-> InsideFinishLayer
																			case 20 :	0		; Underground Walls	-> InsideFinishLayer
																			case  1 :	1		; Attic Roofs			-> RoofingLayer
																			case  2 :	1		; Cathedral Ceilings	-> RoofingLayer
																			case  3 :	2		; Ceiling (blw attc)	-> AtticFloorLayer
																			case  4 :	3		; Interior Floors		-> FloorSurfaceLayer
																			case  5 :	3		; Exterior Floors		-> FloorSurfaceLayer
																			case  6 :	3		; Interior Ceilings	-> FloorSurfaceLayer
																			case  9 :	3		; Flrs over Crawlspc -> FloorSurfaceLayer
																			default : -1
																		endswitch  }

	"Set Cons:LayerLabels[2]"	Cons:LayerLabels[2] = {	switch( Local( CanAssignTo ) )
																			case  0 :	switch( Type ) ; Exterior Walls 
																								case 2: "Insulation/Furring:" ; Concrete/ICF/ Brick
																								case 3: "Insulation/Furring:" ; Hollow Unit Masonry
																								case 4: "Insulation/Furring:" ; Adobe/Strawbale/Log
																								default: "Sheathing / Insulation:"	; Any Other
																							endswitch
																			case 10 :	switch( Type ) ; Interior Walls 
																								case 2: "Insulation/Furring:" ; Concrete/ICF/ Brick
																								case 3: "Insulation/Furring:" ; Hollow Unit Masonry
																								case 4: "Insulation/Furring:" ; Adobe/Strawbale/Log
																								default: "Sheathing / Insulation:"	; Any Other
																							endswitch
																			case 20 :	switch( Type ) ; Underground Walls 
																								case 2: "Insulation/Furring:" ; Concrete/ICF/ Brick
																								case 3: "Insulation/Furring:" ; Hollow Unit Masonry
																								case 4: "Insulation/Furring:" ; Adobe/Strawbale/Log
																								default: "Sheathing / Insulation:"	; Any Other
																							endswitch
																			case  1 :	"Above Deck Insulation:"	; Attic Roofs
																			case  2 :	"Above Deck Insulation:"	; Cathedral Ceilings
																			case  3 :	"Cavity / Frame:"				; Ceiling (blw attc)
																			case  4 :	switch( Type ) ; Interior Floors
																								case 25: "Insulation/Furring:"	; Concrete/ICF/ Brick
																								default: "Concrete Fill:"			; Any Other
																							endswitch
																			case  5 :	switch( Type ) ; Exterior Floors
																								case 25: "Insulation/Furring:"	; Concrete/ICF/ Brick
																								default: "Concrete Fill:"			; Any Other
																							endswitch
																			case  6 :	switch( Type ) ; Interior Ceilings
																								case 25: "Insulation/Furring:"	; Concrete/ICF/ Brick
																								default: "Concrete Fill:"			; Any Other
																							endswitch
																			case  9 :	switch( Type ) ; Flrs over Crawlspc
																								case 25: "Insulation/Furring:"	; Concrete/ICF/ Brick
																								default: "Concrete Fill:"			; Any Other
																							endswitch
																			default : " "
																		endswitch  }
	"Set Cons:LayerVar[2]"		Cons:LayerVar[2] = {		switch( Local( CanAssignTo ) )
																			case  0 :	switch( Type ) ; Exterior Walls 
																								case 2: 4 ; Concrete/ICF/ Brick -> FurringInsul2Layer
																								case 3: 4 ; Hollow Unit Masonry -> FurringInsul2Layer
																								case 4: 4 ; Adobe/Strawbale/Log -> FurringInsul2Layer
																								default: 0		; Any Other  -> SheathInsul2Layer
																							endswitch  
																			case 10 :	switch( Type ) ; Interior Walls 
																								case 2: 4 ; Concrete/ICF/ Brick -> FurringInsul2Layer
																								case 3: 4 ; Hollow Unit Masonry -> FurringInsul2Layer
																								case 4: 4 ; Adobe/Strawbale/Log -> FurringInsul2Layer
																								default: 0		; Any Other  -> SheathInsul2Layer
																							endswitch  
																			case 20 :	switch( Type ) ; Underground Walls 
																								case 2: 4 ; Concrete/ICF/ Brick -> FurringInsul2Layer
																								case 3: 4 ; Hollow Unit Masonry -> FurringInsul2Layer
																								case 4: 4 ; Adobe/Strawbale/Log -> FurringInsul2Layer
																								default: 0		; Any Other  -> SheathInsul2Layer
																							endswitch  
																			case  1 :	1		; Attic Roofs        -> AbvDeckInsulLayer
																			case  2 :	1		; Cathedral Ceilings -> AbvDeckInsulLayer
																			case  3 :	2		; Ceiling (blw attc) -> CavityLayer / FrameLayer
																			case  4 :	switch( Type ) ; Interior Floors
																								case 25: 4	; Concrete/ICF/ Brick -> FurringInsul2Layer
																								default: 3	; Any Other				 -> FlrConcreteFillLayer
																							endswitch
																			case  5 :	switch( Type ) ; Exterior Floors
																								case 25: 4	; Concrete/ICF/ Brick -> FurringInsul2Layer
																								default: 3	; Any Other				 -> FlrConcreteFillLayer
																							endswitch
																			case  6 :	switch( Type ) ; Interior Ceilings
																								case 25: 4	; Concrete/ICF/ Brick -> FurringInsul2Layer
																								default: 3	; Any Other				 -> FlrConcreteFillLayer
																							endswitch
																			case  9 :	switch( Type ) ; Flrs over Crawlspc
																								case 25: 4	; Concrete/ICF/ Brick -> FurringInsul2Layer
																								default: 3	; Any Other				 -> FlrConcreteFillLayer
																							endswitch
																			default : -1
																		endswitch  }

	"Set Cons:LayerLabels[3]"	Cons:LayerLabels[3] = {	switch( Local( CanAssignTo ) )
																			case  0 :	switch( Type ) ; Exterior Walls 
																								case 2: "Mass Layer:" ; Concrete/ ICF / Brick
																								case 3: "Mass Layer:" ; Hollow Unit Masonry
																								case 4: "Mass Layer:" ; Adobe / Strawbale / Log
																								case 5: "Panel Rated R (@ 75 F):" ; SIPS Wall
																								default: "Cavity / Frame:"	; Any Other
																							endswitch
																			case 10 :	switch( Type ) ; Interior Walls 
																								case 2: "Mass Layer:" ; Concrete/ ICF / Brick
																								case 3: "Mass Layer:" ; Hollow Unit Masonry
																								case 4: "Mass Layer:" ; Adobe / Strawbale / Log
																								case 5: "Panel Rated R(@ 75 F):" ; SIPS Wall
																								default: "Cavity / Frame:"	; Any Other
																							endswitch
																			case 20 :	switch( Type ) ; Underground Walls 
																								case 2: "Mass Layer:" ; Concrete/ ICF / Brick
																								case 3: "Mass Layer:" ; Hollow Unit Masonry
																								case 4: "Mass Layer:" ; Adobe / Strawbale / Log
																								case 5: "Panel Rated R(@ 75 F):" ; SIPS Wall
																								default: "Cavity / Frame:"	; Any Other
																							endswitch
																			case  1 :	"Roof Deck:"               ; Attic Roofs
																			case  2 :	"Roof Deck:"               ; Cathedral Ceilings
																			case  3 :	"Sheathing / Insulation:"	; Ceiling (blw attc)
																			case  4 :	switch( Type ) ; Interior Floors
																								case 24 : "" ; "SIPS Floor"
																								case 25 : "Mass Layer:" ; Concrete/ ICF / Brick
																								default : "Floor Deck:"					; all others
																							endswitch
																			case  5 :	switch( Type ) ; Exterior Floors
																								case 24 : "" ; "SIPS Floor"
																								case 25 : "Mass Layer:" ; Concrete/ ICF / Brick
																								default : "Floor Deck:"					; all others
																							endswitch
																			case  6 :	switch( Type ) ; Interior Ceilings
																								case 24 : "" ; "SIPS Floor"
																								case 25 : "Mass Layer:" ; Concrete/ ICF / Brick
																								default : "Floor Deck:"					; all others
																							endswitch
																			case  9 :	switch( Type ) ; Floors Over Crawlspace
																								case 24 : "" ; "SIPS Floor"
																								case 25 : "Mass Layer:" ; Concrete/ ICF / Brick
																								default : "Floor Deck:"					; all others
																							endswitch
																			default : " "
																		endswitch  }
	"Set Cons:LayerVar[3]"		Cons:LayerVar[3] = {		switch( Local( CanAssignTo ) )
																			case  0 :	switch( Type ) ; Exterior Walls 
																								case 2: 4 ; Concrete/ICF/ Brick -> MassLayer
																								case 3: 4 ; Hollow Unit Masonry -> MassLayer
																								case 4: 4 ; Adobe/Strawbale/Log -> MassLayer
																								default: 0		; Any Other  -> CavityLayer / FrameLayer
																							endswitch   
																			case 10 :	switch( Type ) ; Interior Walls 
																								case 2: 4 ; Concrete/ICF/ Brick -> MassLayer
																								case 3: 4 ; Hollow Unit Masonry -> MassLayer
																								case 4: 4 ; Adobe/Strawbale/Log -> MassLayer
																								default: 0		; Any Other  -> CavityLayer / FrameLayer
																							endswitch 
																			case 20 :	switch( Type ) ; Underground Walls 
																								case 2: 4 ; Concrete/ICF/ Brick -> MassLayer
																								case 3: 4 ; Hollow Unit Masonry -> MassLayer
																								case 4: 4 ; Adobe/Strawbale/Log -> MassLayer
																								default: 0		; Any Other  -> CavityLayer / FrameLayer
																							endswitch 
																			case  1 :	1		; Attic Roofs        -> RoofDeckLayer
																			case  2 :	1		; Cathedral Ceilings -> RoofDeckLayer
																			case  3 :	2		; Ceiling (blw attc) -> SheathInsulLayer
																			case  4 :	switch( Type ) ; Interior Floors
																								case 25 : 4		; Concrete/ICF/ Brick -> MassLayer
																								default : 3		; Any Other				 -> FloorDeckLayer
																							endswitch
																			case  5 :	switch( Type ) ; Exterior Floors
																								case 25 : 4		; Concrete/ICF/ Brick -> MassLayer
																								default : 3		; Any Other				 -> FloorDeckLayer
																							endswitch
																			case  6 :	switch( Type ) ; Interior Ceilings
																								case 25 : 4		; Concrete/ICF/ Brick -> MassLayer
																								default : 3		; Any Other				 -> FloorDeckLayer
																							endswitch
																			case  9 :	switch( Type ) ; Floors Over Crawlspace
																								case 25 : 4		; Concrete/ICF/ Brick -> MassLayer
																								default : 3		; Any Other				 -> FloorDeckLayer
																							endswitch
																			default : -1
																		endswitch  }

	"Set Cons:LayerLabels[4]"	Cons:LayerLabels[4] = {	switch( Local( CanAssignTo ) )
																			case  0 :	switch( Type ) ; Exterior Walls 
																								case 2: "Insulation/Furring:" ; Concrete/ICF/ Brick
																								case 3: "Insulation/Furring:" ; Hollow Unit Masonry
																								case 4: "Insulation/Furring:" ; Adobe/Strawbale/Log
																								default: "Sheathing / Insulation:"	; Any Other
																							endswitch
																			case 10 :	switch( Type ) ; Interior Walls 
																								case 2: "Insulation/Furring:" ; Concrete/ICF/ Brick
																								case 3: "Insulation/Furring:" ; Hollow Unit Masonry
																								case 4: "Insulation/Furring:" ; Adobe/Strawbale/Log
																								default: "Sheathing / Insulation:"	; Any Other
																							endswitch
																			case 20 :	switch( Type ) ; Underground Walls 
																								case 2: "Insulation/Furring:" ; Concrete/ICF/ Brick
																								case 3: "Insulation/Furring:" ; Hollow Unit Masonry
																								case 4: "Insulation/Furring:" ; Adobe/Strawbale/Log
																								default: "Sheathing / Insulation:"	; Any Other
																							endswitch
																			case  1 :	"Cavity / Frame:"          ; Attic Roofs
																			case  2 :	"Cavity / Frame:"          ; Cathedral Ceilings
																			case  3 :	"Inside Finish:"				; Ceiling (blw attc)
																			case  4 :	switch( Type ) ; Interior Floors
																								case 25 : "Insulation/Furring:"	; Concrete/ICF/ Brick
																								default : "Cavity / Frame:"		; Any Other
																							endswitch
																			case  5 :	switch( Type ) ; Exterior Floors
																								case 25 : "Insulation/Furring:"	; Concrete/ICF/ Brick
																								default : "Cavity / Frame:"		; Any Other
																							endswitch
																			case  6 :	switch( Type ) ; Interior Ceilings
																								case 25 : "Insulation/Furring:"	; Concrete/ICF/ Brick
																								default : "Cavity / Frame:"		; Any Other
																							endswitch
																			case  9 :	switch( Type ) ; Floors Over Crawlspace
																								case 25 : "Insulation/Furring:"	; Concrete/ICF/ Brick
																								default : "Cavity / Frame:"		; Any Other
																							endswitch
																			default : " "
																		endswitch  }
	"Set Cons:LayerVar[4]"		Cons:LayerVar[4] = {		switch( Local( CanAssignTo ) )
																			case  0 :	switch( Type ) ; Exterior Walls 
																								case 2: 4 ; Concrete/ICF/ Brick -> FurringInsulLayer
																								case 3: 4 ; Hollow Unit Masonry -> FurringInsulLayer
																								case 4: 4 ; Adobe/Strawbale/Log -> FurringInsulLayer
																								default: 0		; Any Other  -> SheathInsulLayer
																							endswitch  
																			case 10 :	switch( Type ) ; Interior Walls 
																								case 2: 4 ; Concrete/ICF/ Brick -> FurringInsulLayer
																								case 3: 4 ; Hollow Unit Masonry -> FurringInsulLayer
																								case 4: 4 ; Adobe/Strawbale/Log -> FurringInsulLayer
																								default: 0		; Any Other  -> SheathInsulLayer
																							endswitch  
																			case 20 :	switch( Type ) ; Underground Walls 
																								case 2: 4 ; Concrete/ICF/ Brick -> FurringInsulLayer
																								case 3: 4 ; Hollow Unit Masonry -> FurringInsulLayer
																								case 4: 4 ; Adobe/Strawbale/Log -> FurringInsulLayer
																								default: 0		; Any Other  -> SheathInsulLayer
																							endswitch  
																			case  1 :	1		; Attic Roofs        -> CavityLayer / FrameLayer
																			case  2 :	1		; Cathedral Ceilings -> CavityLayer / FrameLayer
																			case  3 :	2		; Ceiling (blw attc) -> InsideFinishLayer
																			case  4 :	switch( Type ) ; Interior Floors
																								case 25 : 4		; Concrete/ICF/ Brick -> FurringInsulLayer
																								default : 1		; Any Other				 -> CavityLayer / FrameLayer
																							endswitch
																			case  5 :	switch( Type ) ; Exterior Floors
																								case 25 : 4		; Concrete/ICF/ Brick -> FurringInsulLayer
																								default : 1		; Any Other				 -> CavityLayer / FrameLayer
																							endswitch
																			case  6 :	switch( Type ) ; Interior Ceilings
																								case 25 : 4		; Concrete/ICF/ Brick -> FurringInsulLayer
																								default : 1		; Any Other				 -> CavityLayer / FrameLayer
																							endswitch
																			case  9 :	switch( Type ) ; Floors Over Crawlspace
																								case 25 : 4		; Concrete/ICF/ Brick -> FurringInsulLayer
																								default : 1		; Any Other				 -> CavityLayer / FrameLayer
																							endswitch
																			default : -1
																		endswitch  }

	"Set Cons:LayerLabels[5]"	Cons:LayerLabels[5] = {	switch( Local( CanAssignTo ) )
																			case  0 :	"Exterior Finish:"			; Exterior Walls
																			case 10 :	"Other Side Finish:"			; Interior Walls
																			case 20 :	" "			         	   ; Underground Walls
																			case  1 :	"Inside Finish:"           ; Attic Roofs
																			case  2 :	"Sheathing / Insulation:"  ; Cathedral Ceilings
																			case  3 :	"none"							; Ceiling (blw attc)
																			case  4 :	switch( Type ) ; Interior Floors
																								case 25 : "Ceiling Below Finish:"		; Concrete/ICF/ Brick
																								default : "Sheathing / Insulation:"		; Any Other
																							endswitch
																			case  5 :	switch( Type ) ; Exterior Floors
																								case 25 : "Exterior Finish:"				; Concrete/ICF/ Brick
																								default : "Sheathing / Insulation:"		; Any Other
																							endswitch
																			case  6 :	switch( Type ) ; Interior Ceilings
																								case 25 : "Ceiling Below Finish:"		; Concrete/ICF/ Brick
																								default : "Sheathing / Insulation:"		; Any Other
																							endswitch
																			case  9 :	switch( Type ) ; Floors Over Crawlspace
																								case 25 : "Exterior Finish:"				; Concrete/ICF/ Brick
																								default : "Sheathing / Insulation:"		; Any Other
																							endswitch
																			default : " "
																		endswitch  }
	"Set Cons:LayerVar[5]"		Cons:LayerVar[5] = {		switch( Local( CanAssignTo ) )
																			case  0 :	0		  ; Exterior Walls     -> WallExtFinishLayer
																			case 10 :	1	  	; Interior Walls     -> OtherSideFinishLayer
																			case 20 :	 -1		; Underground Walls  -> n/a
																			case  1 :   2		; Attic Roofs        -> InsideFinishLayer
																			case  2 :	3		; Cathedral Ceilings -> SheathInsulLayer
																			case  3 :  -1		; Ceiling (blw attc) -> 
																			case  4 :	switch( Type ) ; Interior Floors
																								case 25 : 2		; Concrete/ICF/ Brick	-> InsideFinishLayer
																								default : 3		; Any Other					-> SheathInsulLayer
																							endswitch
																			case  5 :	switch( Type ) ; Exterior Floors
																								case 25 : 4		; Concrete/ICF/ Brick	-> FlrExtFinishLayer
																								default : 3		; Any Other					-> SheathInsulLayer
																							endswitch
																			case  6 :	switch( Type ) ; Interior Ceilings
																								case 25 : 2		; Concrete/ICF/ Brick	-> InsideFinishLayer
																								default : 3		; Any Other					-> SheathInsulLayer
																							endswitch
																			case  9 :	switch( Type ) ; Floors Over Crawlspace
																								case 25 : 4		; Concrete/ICF/ Brick	-> FlrExtFinishLayer
																								default : 3		; Any Other					-> SheathInsulLayer
																							endswitch
																			default : -1
																		endswitch  }

	"Set Cons:LayerLabels[6]"	Cons:LayerLabels[6] = {	switch( Local( CanAssignTo ) )
																			case  0 :	"none"                  	; Exterior Walls
																			case 10 :	"none"                  	; Interior Walls
																			case 20 :	"none"			              ; Underground Walls
																			case  1 :	"none"                  	; Attic Roofs
																			case  2 :	"Inside Finish:"         	; Cathedral Ceilings
																			case  3 :	"none"                  	; Ceiling (blw attc)
																			case  4 :	switch( Type ) ; Interior Floors
																								case 25 : "none"							; Concrete/ICF/ Brick
																								default : "Ceiling Below Finish:"	; Any Other
																							endswitch
																			case  5 :	switch( Type ) ; Exterior Floors
																								case 25 : "none"							; Concrete/ICF/ Brick
																								default : "Exterior Finish:"			; Any Other
																							endswitch
																			case  6 :	switch( Type ) ; Interior Ceilings
																								case 25 : "none"							; Concrete/ICF/ Brick
																								default : "Ceiling Below Finish:"	; Any Other
																							endswitch
																			case  9 :	switch( Type ) ; Floors Over Crawlspace
																								case 25 : "none"							; Concrete/ICF/ Brick
																								default : "Exterior Finish:"			; Any Other
																							endswitch
																			default : " "
																		endswitch  }
	"Set Cons:LayerVar[6]"		Cons:LayerVar[6] = {		switch( Local( CanAssignTo ) )
																			case  0 :  -1		; Exterior Walls     ->
																			case 10 :  -1		; Interior Walls     ->
																			case 20 :	 -1		; Underground Walls  -> n/a
																			case  1 :  -1		; Attic Roofs        -> 
																			case  2 :   0		; Cathedral Ceilings -> InsideFinishLayer
																			case  3 :  -1		; Ceiling (blw attc) -> 
																			case  4 :  switch( Type ) ; Interior Floors
																								case 25 : -1		; Concrete/ICF/ Brick
																								default :  0		; Any Other		-> InsideFinishLayer
																							endswitch
																			case  5 :  switch( Type ) ; Exterior Floors
																								case 25 : -1		; Concrete/ICF/ Brick
																								default :  1		; Any Other		-> FlrExtFinishLayer
																							endswitch
																			case  6 :  switch( Type ) ; Interior Ceilings
																								case 25 : -1		; Concrete/ICF/ Brick
																								default :  0		; Any Other		-> InsideFinishLayer
																							endswitch
																			case  9 :  switch( Type ) ; Floors Over Crawlspace
																								case 25 : -1		; Concrete/ICF/ Brick
																								default :  1		; Any Other		-> FlrExtFinishLayer
																							endswitch
																			default : -1
																		endswitch  }

; SAC 3/11/14 - moved these Mat assignments UP HERE from below since properties of these Mats are now referenced during defaulting
	"Import SoftWood Mat from library (if needed)"		Proj:LibMat_SoftWood		= {
   	if (LocalCompAssigned( LibMat_SoftWood )) then  UNCHANGED
      else  RuleLibrary( Mat, "SoftWood" )  endif  }
	"Import Steel Mat from library (if needed)"			Proj:LibMat_Steel			= {
   	if (LocalCompAssigned( LibMat_Steel )) then  UNCHANGED
		else  RuleLibrary( Mat, "Steel" )  endif  }
	"Import SIPSskin Mat from library (if needed)"		Proj:LibMat_SIPSskin		= {
   	if (LocalCompAssigned( LibMat_SIPSskin )) then  UNCHANGED
		else  RuleLibrary( Mat, "SIPSskin" )  endif  }
	"Import Ceiling Ins Mat from library (if needed)"	Proj:LibMat_CeilingIns	= {
      if (LocalCompAssigned( LibMat_CeilingIns )) then  UNCHANGED
      else  RuleLibrary( Mat, "Ceiling Insul" )  endif  }
	"Import Other Ins Mat from library (if needed)"		Proj:LibMat_OtherIns		= {	
      if (LocalCompAssigned( LibMat_OtherIns )) then  UNCHANGED
      else  RuleLibrary( Mat, "Other Insul" )  endif  }

; SAC 6/21/17 - added rules to initiate override of user input (or past default) for SIPS surfaces w/ lower cavity R-values than we currently support
   "Initiate reset of SIPS cavity R-values below current minimums"   Cons:Action  = {
         if (LocalStatus( CavityLayer ) < 7) then  UNCHANGED
         else if (Type == 5  .AND. (CavityLayer == 100401 .OR. CavityLayer < 14))
         then  EvalRulelist( "ForceDefault_SIPSWall_Cons_CavityLayer", 1 )
         else if (Type == 13 .AND.  CavityLayer < 14 )
         then  EvalRulelist( "ForceDefault_SIPSCeiling_Cons_CavityLayer", 1 )
         else if (Type == 24 .AND.  CavityLayer < 14 )
         then  EvalRulelist( "ForceDefault_SIPSFloor_Cons_CavityLayer", 1 )
         else  UNCHANGED  endif endif endif endif  }

   ; SAC 7/20/17 - added set of new properties related to application of QII (only to surfaces of New Zones (tic #775)
   ; SAC 5/9/18 - added logic to be evaluated for Cons objects referenced by one or more Attics (tic #775)
   "Set Cons:SurfacesOfNewZone"     Cons:SurfacesOfNewZone  = {
      switch (CanAssignTo)
         case  0 :  SumRevRef( ExtWall:Construction, ExtWall:ParentIsNewZone )		; Exterior Walls 
         case 10 :  SumRevRef( IntWall:Construction, IntWall:ParentIsNewZone )		; Interior Walls    
         case 20 :  SumRevRef( UndWall:Construction, UndWall:ParentIsNewZone )		; Underground Walls 
         case  1 :  SumRevRef( Attic:Construction,   Attic:IsNew )            		; Attic Roofs       
         case  2 :  SumRevRef( CathedralCeiling:Construction,  CathedralCeiling:ParentIsNewZone )		; Cathedral Ceilings
         case  3 :  SumRevRef( CeilingBelowAttic:Construction, CeilingBelowAttic:ParentIsNewZone )		; Ceiling (blw attc)
         case  4 :  SumRevRef( InteriorFloor:Construction,     InteriorFloor:ParentIsNewZone )        ; Interior Floors
         case  5 :  SumRevRef( ExteriorFloor:Construction,     ExteriorFloor:ParentIsNewZone )        ; Exterior Floors
         case  6 :  SumRevRef( InteriorCeiling:Construction,   InteriorCeiling:ParentIsNewZone )      ; Interior Ceilings
         case  9 :  SumRevRef( FloorOverCrawl:Construction,    FloorOverCrawl:ParentIsNewZone )       ; Floors Over Crawlspace
         default :  0
      endswitch  }
   "Set Cons:SurfacesOfNotNewZone"     Cons:SurfacesOfNotNewZone  = {
      switch (CanAssignTo)
         case  0 :  SumRevRef( ExtWall:Construction, ExtWall:ParentNotNewZone )		; Exterior Walls 
         case 10 :  SumRevRef( IntWall:Construction, IntWall:ParentNotNewZone )		; Interior Walls    
         case 20 :  SumRevRef( UndWall:Construction, UndWall:ParentNotNewZone )		; Underground Walls 
         case  1 :  SumRevRef( Attic:Construction,   Attic:IsAltered  ) +      		; Attic Roofs
                    SumRevRef( Attic:Construction,   Attic:IsExisting )
         case  2 :  SumRevRef( CathedralCeiling:Construction,  CathedralCeiling:ParentNotNewZone )     ; Cathedral Ceilings
         case  3 :  SumRevRef( CeilingBelowAttic:Construction, CeilingBelowAttic:ParentNotNewZone )    ; Ceiling (blw attc)
         case  4 :  SumRevRef( InteriorFloor:Construction,     InteriorFloor:ParentNotNewZone )        ; Interior Floors
         case  5 :  SumRevRef( ExteriorFloor:Construction,     ExteriorFloor:ParentNotNewZone )        ; Exterior Floors
         case  6 :  SumRevRef( InteriorCeiling:Construction,   InteriorCeiling:ParentNotNewZone )      ; Interior Ceilings
         case  9 :  SumRevRef( FloorOverCrawl:Construction,    FloorOverCrawl:ParentNotNewZone )       ; Floors Over Crawlspace
         default :  0
      endswitch  }

   ; SAC 5/18/18 - revised QII rules to accommodate ExtWall exception input (tic #798)
   "Set Cons:SurfacesQIIDegraded"      Cons:SurfacesQIIDegraded  = {
      if (CanAssignTo = 0)          ; ExtWall
      then  SumRevRef( ExtWall:Construction, ExtWall:QIIDegraded )
      else  SurfacesOfNotNewZone    ; other surface types still use (Not)NewZone logic
      endif  }
   "Set Cons:SurfacesQIINotDegraded"   Cons:SurfacesQIINotDegraded  = {
      if (CanAssignTo = 0)          ; ExtWall
      then  SumRevRef( ExtWall:Construction, ExtWall:QIINotDegraded )
      else  SurfacesOfNewZone       ; other surface types still use (Not)NewZone logic
      endif  }

	"Default Mat ConductivityQII"	Proj:Action	= {	EvalRulelist( "DefaultMatCondQII" )  }		; SAC 3/18/14
  ; SAC 5/7/12 - moved remaining Cons defaulting to separate rulelist to facilitate defaulting of Budget (and potentially other) models
	"Default Cons properties"		Cons:Action = {	EvalRulelist( "DefaultConsObject", 1 )  }
	; SAC 3/12/14 - consolidate rules to setup final cavity materials, LayerParams objects and call to ConsUFactoRes() call
	"Perform final Ufactor prep and call ConsUFactoRes()"		Proj:Action	= {
      EvalRulelist( "SetupCons_UValue_All" )  }

;  ; SAC 11/1/12 - added rulelists to initialize & set Attic Edge properties
;  ; SAC 5/22/14 - revised rule to prevent attic edge modeling when RoofRise < 2/12
;	"Setup Cons Attic Edge properties"		Cons:Action = {	if (CanAssignTo == 3 .AND. ComponentCount( Attic ) > 0.5)		; Ceiling (blw attc)
;																	;			then  if (Attic:RoofPitch > 0.01)
;																				then  if (Attic:RoofPitch > 1.999/12)
;																						then	EvalRulelist( "SetupCons_AtticEdge_Set" , 1 )
;																						else	EvalRulelist( "SetupCons_AtticEdge_Init", 1 )  endif
;																				else			EvalRulelist( "SetupCons_AtticEdge_Init", 1 )  endif  }
; SAC 10/15/14 - mods moving attic edge properties to CeilingBelowAttic (to support multiple attics)
	"Setup Cons Attic Edge properties"		CeilingBelowAttic:Action = {	
      if (IfValidAnd( AtticZone:RoofPitch > 1.999/12 ))
      then	EvalRulelist( "SetupCons_AtticEdge_Set" , 1 )
      else	EvalRulelist( "SetupCons_AtticEdge_Init", 1 )  endif  }


; SAC 2/17/15 - revised logic and moved up here to enable access when implementing Cons error messaging
	"Sum Cons Surface Areas"	Cons:AssignedSurfaceArea = {
      switch ( CanAssignTo )
			case  0: SumRevRef( ExtWall:Construction, ExtWall:Area ) + SumRevRef( ExtWall:exConstruction, ExtWall:Area )
			case 10: SumRevRef( IntWall:Construction, IntWall:Area ) + SumRevRef( IntWall:exConstruction, IntWall:Area )
			case 20: SumRevRef( UndWall:Construction, UndWall:Area ) + SumRevRef( UndWall:exConstruction, UndWall:Area )
			case  1: SumRevRef( Attic:Construction, Attic:FloorArea ) + SumRevRef( Attic:exConstruction, Attic:FloorArea )
			case  2: SumRevRef( CathedralCeiling:Construction, CathedralCeiling:Area ) + SumRevRef( CathedralCeiling:exConstruction, CathedralCeiling:Area )
			case  3: SumRevRef( CeilingBelowAttic:Construction, CeilingBelowAttic:Area ) + SumRevRef( CeilingBelowAttic:exConstruction, CeilingBelowAttic:Area )
			case  6: SumRevRef( InteriorCeiling:Construction, InteriorCeiling:Area ) + SumRevRef( InteriorCeiling:exConstruction, InteriorCeiling:Area )
			case  4: SumRevRef( InteriorFloor:Construction, InteriorFloor:Area ) + SumRevRef( InteriorFloor:exConstruction, InteriorFloor:Area )
			case  5: SumRevRef( ExteriorFloor:Construction, ExteriorFloor:Area ) + SumRevRef( ExteriorFloor:exConstruction, ExteriorFloor:Area )
			case  9: SumRevRef( FloorOverCrawl:Construction, FloorOverCrawl:Area ) + SumRevRef( FloorOverCrawl:exConstruction, FloorOverCrawl:Area )
			default: 0
		endswitch }

; SAC 2/17/15 - new error checking/reporting to catch scenarios where construction inputs cannot be simulated
	"Check for minimal Cons inputs"		Cons:InputErrMsg = { if (IfValidAnd( AssignedSurfaceArea > 1 )==0) then  UNDEFINED  else
		switch ( CanAssignTo )
			case  0: ; ExtWall
				if (Type == 0 .AND. InsideFinishLayer < 1 .AND. WallExtFinishLayer < 1 .AND.
                  (SheathInsul2Layer < 1 .OR. (SheathInsul2Layer = 99000 .AND. IfValidAnd( SheathInsul2LayerRVal > 0 )==0)) .AND. 
                  (SheathInsulLayer  < 1 .OR. (SheathInsulLayer  = 99000 .AND. IfValidAnd( SheathInsulLayerRVal  > 0 )==0)))
				then	"Cons invalid due to lack of wall inside or exterior finish layer."
				else	UNDEFINED  endif
			case 10: ; IntWall
				if (Type == 0 .AND. InsideFinishLayer < 1 .AND. OtherSideFinishLayer < 1 .AND.
                  (SheathInsul2Layer < 1 .OR. (SheathInsul2Layer = 99000 .AND. IfValidAnd( SheathInsul2LayerRVal > 0 )==0)) .AND. 
                  (SheathInsulLayer  < 1 .OR. (SheathInsulLayer  = 99000 .AND. IfValidAnd( SheathInsulLayerRVal  > 0 )==0)))
				then	"Cons invalid due to lack of wall inside or exterior finish layer."
				else	UNDEFINED  endif
			case 20: ; UndWall
				UNDEFINED
			case  1: ; Attic
				UNDEFINED
			case  2: ; CathedralCeiling
				UNDEFINED
			case  3: ; CeilingBelowAttic
				if (Type == 10 .AND. AtticFloorLayer < 1 .AND. InsideFinishLayer < 1 .AND. 
                  (SheathInsulLayer  < 1 .OR. (SheathInsulLayer  = 99000 .AND. IfValidAnd( SheathInsulLayerRVal  > 0 )==0)))
				then	"Cons invalid due to lack of inside finish or attic floor layer."
				else	UNDEFINED  endif
			case  6: ; InteriorCeiling
				if (Type == 10 .AND. FloorSurfaceLayer < 1 .AND. FloorDeckLayer < 1 .AND. InsideFinishLayer < 1 .AND. 
                  (SheathInsulLayer  < 1 .OR. (SheathInsulLayer  = 99000 .AND. IfValidAnd( SheathInsulLayerRVal  > 0 )==0)))
				then	"Cons invalid due to lack of ceiling inside finish, or floor deck or surface layer."
				else	UNDEFINED  endif
			case  4: ; InteriorFloor
				if (Type == 20 .AND. FloorSurfaceLayer < 1 .AND. FlrConcreteFillLayer < 1 .AND. FloorDeckLayer < 1 .AND. InsideFinishLayer < 1 .AND. 
                  (SheathInsulLayer  < 1 .OR. (SheathInsulLayer  = 99000 .AND. IfValidAnd( SheathInsulLayerRVal  > 0 )==0)))
				then	"Cons invalid due to lack of floor surface, fill, deck or finish layer."
				else	UNDEFINED  endif
			case  5: ; ExteriorFloor
				UNDEFINED
			case  9: ; FloorOverCrawl
				if (Type == 20 .AND. FloorSurfaceLayer < 1 .AND. FlrConcreteFillLayer < 1 .AND. FloorDeckLayer < 1 .AND. FlrExtFinishLayer < 1 .AND. 
                  (SheathInsulLayer  < 1 .OR. (SheathInsulLayer  = 99000 .AND. IfValidAnd( SheathInsulLayerRVal  > 0 )==0)))
				then	"Cons invalid due to lack of floor surface, fill, deck or finish layer."
				else	UNDEFINED  endif
			default:	UNDEFINED
		endswitch  endif  }
	"Set flag for displaying Cons InputErrMsg"	Cons:DisplayInpErrMsg = {
      if (LocalStatus( InputErrMsg ) > 0)
      then	if (strlen( InputErrMsg ) > 1) then  1
            else  0  endif
      else  0  endif  }

END
;*************************************************************************


;*************************************************************************
RULELIST "DefaultMatCondQII" 0 0 0 1
;*************************************************************************
	"Default Mat:ConductivityQII"		Mat:ConductivityQII	= {	Conductivity  }	; SAC 3/18/14 - defaulting Cond...QII prevents need to specify Cond...QII for each and every library Mat object...
END

;*************************************************************************
RULELIST "DefaultConsObject" 0 0 0 1
;*************************************************************************

	"Default Cons:InsideFinishLayer"		Cons:InsideFinishLayer = {	if (Local( CanAssignTo ) == 1)
																						then       0		; attic roofs -> no finish
																						else  100101		; all others  -> 1/2 in. Gypsum Wall Board
																						endif  }

   ; SAC 3/23/17 - implementing for 2016 & keeping default @ 1  /  SAC 3/10/17 - added for 2019 research
   ; SAC 5/10/17 - revised default to UNchecked (tic #753)
   "Default Cons:CavInsulOverFrame - whether cavity insulation that exceeds cavity depth extends over framing"
      Cons:CavInsulOverFrame  = {   if (CanAssignTo != 1) then  UNDEFINED
                                    else  0  endif  }

	; SAC 1/1/13 - switched default from No radiant barrier to radiant barrier present for any climate zone for which it is prescriptively required
	;"Default Cons:RadiantBarrier"			Cons:RadiantBarrier	= {	ClimateZoneTable( Global( Proj:ClimateZone ), 8 )  }
	; SAC 2/11/13 - revised to default radiant barrier only for attic roof (and related) surfaces (mainly just to avoid confusion)
	; mjb 1/12/15 - using new T24RClimateZoneCodeBase lookup table
	"Default Cons:RadiantBarrier for Attic Roofs"			
														Cons:RadiantBarrier			= {	if (CanAssignTo == 1)	
;																									then  ClimateZoneTable( Global( Proj:ClimateZone ), 8 )
																									then  T24RClimateZoneCodeBase:RadiantBarrier( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
																									else  0  endif  }

	"Default Cons:RaisedHeelTruss"			Cons:RaisedHeelTruss			= {	0   }
	"Default Cons:RaisedHeelTrussHeight"	Cons:RaisedHeelTrussHeight	= {	3.5 }

	"Set Cons:FrameWCanBeInput"				Cons:FrameWCanBeInput		= {	if ((Proj:AnalysisType == 0 .OR. Proj:BypassRuleLimits > 0.5) .AND.			; ("Research" mode OR BypassRuleLimits) AND ...
																											(Type == 1 .OR. Type == 12 .OR. Type == 23))									; any Steel Cons
																									then  1  else  0  endif  }
	"Default Cons:SpecifyFrameW"				Cons:SpecifyFrameW			= {	0   }		; SAC 3/12/14
	"Default Cons:FrameWInput"					Cons:FrameWInput				= {	0   } ; DD 2/21/14 - This default is a placeholder. Property is used for steel framed constructions.
	"Set Cons:FrameW"								Cons:FrameW						= {	if (FrameWCanBeInput && SpecifyFrameW && LocalStatus( FrameWInput ) > 0)
																									then  FrameWInput  else  UNDEFINED  endif  }

	"Set Cons:FrmFctrCanBeInput"				Cons:FrmFctrCanBeInput		= {	if ((Proj:AnalysisType == 0 .OR. Proj:BypassRuleLimits > 0.5) .AND.			; ("Research" mode OR BypassRuleLimits) AND ...
																											(Type == 0 .OR. Type == 1 .OR. Type == 10 .OR. Type == 12 .OR. Type == 20 .OR. Type == 23))   ; any Framed Cons
																									then  1  else  0  endif  }
	"Default Cons:SpecifyFrmFctr"				Cons:SpecifyFrmFctr			= {	0   }		; SAC 3/12/14

	; SAC 1/29/13 - added more defaults to override enumeration defaults
	; DD  2/19/14 - updated defaults to account for new constructions and removed redundant overrides
   ; SAC 6/21/17 - added logic to assign minimum of R-14 to cavity of SIPS constructions
	"Default Cons:CavityLayer"		Cons:CavityLayer	= {
         if (Type == 5 .OR. Type == 13 .OR. Type == 24) then  14     ; various SIPS types (wall/ceiling/floor)
         else if (CanAssignTo == 0 .OR. CanAssignTo == 10) then  100401   ; Exterior & Interior Walls
         else  0  endif endif  }
   "Default ExEDR Cons:CavityLayer"    Cons:Action  = {
         if (IfValidAnd( Proj:ExEDR_Defaults > 0 ) .AND. LocalStatus( CavityLayer ) < 6)
         then  EvalRulelist( "ExEDRDefault_Cons_CavityLayer", 1 )
         else  UNCHANGED  endif  }

	; SAC 2/20/14 - fix problem where '- no insulation -' options can get confused between different vertical and non-vertical values
	"Reset invalid '- no insulation -' Cons:CavityLayer"		Cons:Action	= {	if ( ((Type == 0 .OR.  Type == 1 .OR.  Type == 5) .AND. CavityLayer == 0) .OR.
																											  ( Type != 0 .AND. Type != 1 .AND. Type != 5  .AND. CavityLayer == 100401) )
																										then  EvalRulelist( "Cons_CavityLayer_SetValidNoInsulationOption", 1 )  else  UNCHANGED  endif  }
   ; SAC 5/15/17 - added compressed R-value selections - R-val = (SymVal-mod(SymVal,10))/100  (tic #761)
   "Set Cons:CavityLayerRVal (incl. compressed R-vals)"     Cons:CavityLayerRVal  = {
         if (CavityLayer = 100401) then  0
         else if (CavityLayer > 200 .AND. CavityLayer < 100001)
         then  (CavityLayer - mod( CavityLayer, 10 )) / 100
         else   CavityLayer  endif endif  }

	; SAC 5/11/16 - blast Cons:FrameLayer when the existing selection is invalid (for non-wood framed Cons:Types)
	"Blast Cons:FrameLayer when necessary"		Cons:Action	= {	if ( (Type == 2 .OR. Type == 3 .OR. Type == 4) .AND.		; "Concrete / ICF / Brick", "Hollow Unit Masonry" or "Adobe / Strawbale / Log"
																						  IfValidAnd( FrameLayer = 0 )==0 )  then  EvalRulelist( "ForceDefault_Cons_FrameLayer", 1 )  else  UNCHANGED  endif  }
	"Default Cons:FrameLayer"		Cons:FrameLayer	= {
            if ((CanAssignTo >= 4 .AND. CanAssignTo <= 6) .OR. CanAssignTo == 9) then   ; Interior/Exterior Floors, Interior Ceilings or Flrs over Crawlspc  ->  "2x12 @ 16 in. O.C." 
				 if ( Type == 24 ) then 70650  else 1216 endif 
			else  UNCHANGED endif  }   ; all others  ->  "2x4 @ 16 in. O.C."

	"Set Cons:NumPaths"		Cons:NumPaths = {		switch( Local( Type ) )
																	case  0 :  2	; "Wood Framed Wall"  
																	case  1 :  2	; "Steel Framed Wall"  ; DD 2/11/14
																	case  2 :  1	; "Concrete/ICF/ Brick"  ; DD 2/12/14
																	case  3 :  1	; "Hollow Unit Masonry"  ; DD 2/12/14
																	case  4 :  1	; "Adobe/Strawbale/Log"  ; DD 2/12/14
																	case  5 :  2   ; "SIPS Wall"
																	case 10 :  2	; "Wood Framed Ceiling"  
																	case 11 :  2	; "Built-up Roof"  
																	case 12 :  2	; "Steel Framed Ceiling" ; DD 2/11/14
																	case 13 :  2	; "SIPS Ceiling" ; DD 2/26/14
																	case 20 :  2	; "Wood Framed Floor"  
																	case 21 :  1	; "Floor Slab"  
																	case 22 :  1	; "Basement (underground) Floor"  
																	case 23 :  2	; "Steel Framed Floor"	; DD 2/11/14
																	case 24 :  2   ; "SIPS Floor"
																	case 25 :  1   ; "Concrete/ICF/ Brick" (floor)	; SAC 5/27/14
																	default :  0	
																endswitch  }

	"Set Cons:Path2Label"	Cons:Path2Label	= { switch( Type)  ; DD - 2/14/14 - Label for second path
																	case  2 :  "Furring" ; Concrete / ICF / Brick 
																	case  3 :  "Furring" ; Hollow Unit Masonry 
																	case  4 :  "Furring" ; Adobe / Strawbale / Log 
																	case 25 :  "Furring" ; Concrete / ICF / Brick  (floors)
																	default :	if (NumPaths < 2) then  " "
																					else  "Frame Path"  endif   ; All Others
																endswitch  }

   ; IF THE FOLLOWING VALUE IS MODIFIED, THEN ALL SUBSEQUENT RULES WHICH REFERENCE EACH
   ; POSSIBLE MATERIAL LAYER MUST ALSO CHANGE TO TAKE INTO ACCOUNT THE NEW MaxNumLayers
	"Set Cons:MaxNumLayers"		Cons:MaxNumLayers = {  8  }

	"Set Cons:NumLayers"		Cons:NumLayers = {	switch( Local( Type ) )
																	case  0 :  5	; "Wood Framed Wall"  
																	case  1 :  5	; "Steel Framed Wall"  
																	case  2 :  5   ; "Concrete/ICF/ Brick"
																	case  3 :  5	; "Hollow Unit Masonry"  ; DD 2/12/14
																	case  4 :  5	; "Adobe/Strawbale/Log"  ; DD 2/12/14
																	case  5 :  5   ; "SIPS Wall"
																	case 10 :  		; "Wood Framed Ceiling"  
																					switch( Local( CanAssignTo ) )
																						case  1 :  5     ; Attic Roofs       
																						case  2 :  6     ; Cathedral Ceilings
																						case  3 :  4     ; Ceiling (blw attc)
																						case  6 :  5     ; Interior Ceilings  (same as interior floors)
																						default :  0
																					endswitch
																	case 11 :  5	; "Built-up Roof"  
																	case 12 :      	; "Steel Framed Ceiling" ; DD 2/11/14 
																					switch( Local( CanAssignTo ) )
																						case  1 :  5     ; Attic Roofs       
																						case  2 :  6     ; Cathedral Ceilings
																						case  3 :  4     ; Ceiling (blw attc)
																						case  6 :  5     ; Interior Ceilings  (same as interior floors)
																						default :  0
																					endswitch
																	case 13 :      	; "SIPS Ceiling" ; DD 2/26/14 
																					switch( Local( CanAssignTo ) )
																						case  1 :  5     ; Attic Roofs       
																						case  2 :  6     ; Cathedral Ceilings
																						case  3 :  4     ; Ceiling (blw attc)
																						case  6 :  5     ; Interior Ceilings  (same as interior floors)
																						default :  0
																					endswitch
																	case 20 :  5	; "Wood Framed Floor"  
																	case 21 :  3	; "Floor Slab"  
																	case 22 :  3	; "Basement (underground) Floor" 
																	case 23 :  5	; "Steel Framed Floor" ; DD 2/11/14
																	case 24 :  5   ; "SIPS Floor"
																	case 25 :  5   ; "Concrete/ICF/ Brick" (floor)	; SAC 5/27/14
																	default :  0	
																endswitch  }

   ; SAC 11/29/17 - mod to max out steel frame thickness @ 2x6 (tic #929)
	"Set Cons:CavityThickness"				Cons:CavityThickness		= {
				if (FrameLayer < 1) then  0
				else if ((Type == 5 .OR. Type == 24) .AND. IfValidAnd( FrameLayer >= 70000 ) .AND. IfValidAnd( FrameLayer < 99999 ))
				then	mod( FrameLayer, 10000 ) / 100
            else if ((Type == 1 .OR. Type == 12 .OR. Type == 23) .AND. FrameLayer > 699 ) then  5.5    ; max out Steel Cons thickness @ 2x6
				else if (FrameLayer == 10424  .OR.        ; "2x4 Bottom Chord of Truss @ 24 in. O.C."  
				         FrameLayer == 20424) then  3.5   ; "2x4 Top Chord of Roof Truss @ 24 in. O.C."
				else if (FrameLayer >  400 .AND.
							FrameLayer < 3600)
				then	if (FrameLayer < 800)
						then	int( Local( FrameLayer ) / 100 ) - 0.5		; based on symbol values = (<thickness> * 100) + <# inches on center>
						else	int( Local( FrameLayer ) / 100 ) - 0.75
						endif
				else  0  endif endif endif endif endif  }

;   "Adjust Cons:CavityThickness for Attic Roofs w/ thick insulation that doesn't extend over framing"    ; SAC 3/10/17
;      Cons:CavityThickness  = {
;         if (CanAssignTo != 1 .OR. (Type != 10 .AND. Type != 11)) then  UNCHANGED     ; adjust only Wood Framed or Built Up Attic Roof cavities
;         else if (InsideFinishLayer > 0.1 .OR. Proj:InsulRValPerInch[2] <= 0) then  UNCHANGED
;         else if (IfValidAnd( CavInsulOverFrame = 0 )) then  CavityLayer / Proj:InsulRValPerInch[2]
;         else  UNCHANGED  endif endif endif  }

   ; SAC 7/20/17 - added logic to prevent application of QII for constructions assigned to surfaces that are NOT children of New Zones (tic #775)
   ; SAC 5/18/18 - revised logic slightly to accommodate wall exception input (tic #798)
	"Set Cons:CavityMatCondQII[1]"		Cons:CavityMatCondQII[1]	= {
         if (IfValidAnd( Proj:ICQEnclCavInsMult > 0 ) .AND.
             IfValidAnd( CavityThickness > 0 ) .AND.
             IfValidAnd( CavityLayerRVal > 0 ) .AND. IfValidAnd( CavityLayerRVal < 200 ))
         then  if (IfValidAnd( SurfacesQIIDegraded > 0 )==0)
               then  (CavityThickness / 12) / (CavityLayerRVal * Proj:ICQEnclCavInsMult)
               else  (CavityThickness / 12) / (CavityLayerRVal * Proj:StdICQEnclCavInsMult)
               endif
         else  0  endif  }
	"Set Cons:CavityMatCondQII[2]"		Cons:CavityMatCondQII[2]	= {	CavityMatCondQII[1]  }
	"Set Cons:CavityMatCondQII[3]"		Cons:CavityMatCondQII[3]	= {	CavityMatCondQII[1]  }
	"Set Cons:CavityMatCondQII[4]"		Cons:CavityMatCondQII[4]	= {	CavityMatCondQII[1]  }
	"Set Cons:CavityMatCondQII[5]"		Cons:CavityMatCondQII[5]	= {	CavityMatCondQII[1]  }
	"Set Cons:CavityMatCondQII[6]"		Cons:CavityMatCondQII[6]	= {	CavityMatCondQII[1]  }
	"Set Cons:CavityMatCondQII[7]"		Cons:CavityMatCondQII[7]	= {	CavityMatCondQII[1]  }
	"Set Cons:CavityMatCondQII[8]"		Cons:CavityMatCondQII[8]	= {	CavityMatCondQII[1]  }
	"Set Cons:CavityMatCond[1]"			Cons:CavityMatCond[1]		= {
         if (IfValidAnd( CavityThickness > 0 ) .AND.
             IfValidAnd( CavityLayerRVal > 0 ) .AND. IfValidAnd( CavityLayerRVal < 200 ))
         then  (CavityThickness / 12) / CavityLayerRVal
         else  0  endif  }
	"Set Cons:CavityMatCond[2]"			Cons:CavityMatCond[2]		= {	CavityMatCond[1]  }
	"Set Cons:CavityMatCond[3]"			Cons:CavityMatCond[3]		= {	CavityMatCond[1]  }
	"Set Cons:CavityMatCond[4]"			Cons:CavityMatCond[4]		= {	CavityMatCond[1]  }
	"Set Cons:CavityMatCond[5]"			Cons:CavityMatCond[5]		= {	CavityMatCond[1]  }
	"Set Cons:CavityMatCond[6]"			Cons:CavityMatCond[6]		= {	CavityMatCond[1]  }
	"Set Cons:CavityMatCond[7]"			Cons:CavityMatCond[7]		= {	CavityMatCond[1]  }
	"Set Cons:CavityMatCond[8]"			Cons:CavityMatCond[8]		= {	CavityMatCond[1]  }

   "Init Cons:AbvJoistInsulThick"		Cons:AbvJoistInsulThick		= {	0  }	; Thickness of insulation above attic floor joists
;   "Init Cons:AbvJoistInsMatCond"		Cons:AbvJoistInsMatCond		= {	0  }  ; Material conductance of insulation above attic floor joists
   "Init Cons:BlwJoistInsulThick"		Cons:BlwJoistInsulThick		= {	0  }	; Thickness of insulation below attic roof joists
   "Init Cons:ICQCeilingInsMult"			Cons:ICQCeilingInsMult		= {	0  }

;	"Init Cons:FrameCodeRValueX" 			Cons:FrameCodeRValueX   = {	-1  }
	"Init Cons:CavityCodeRValueX"			Cons:CavityCodeRValueX  = {	-1  }
	"Init Cons:FrameCodeUValueX" 			Cons:FrameCodeUValueX   = {	-1  }
	"Init Cons:CavityCodeUValueX"			Cons:CavityCodeUValueX  = {	-1  }
	"Init Cons:OverallCodeUValueX"		Cons:OverallCodeUValueX = {	-1  }

	"Default Cons:UfactorCalcMethod"		Cons:UfactorCalcMethod	= {
							switch( Type )
								case   0 :	 1		; "Wood Framed Wall"         ->  "Parallel Path"
								case   1 :	 3		; "Steel Framed Wall"        ->  "Modified Zone"
								case   2 :	 2		; "Concrete / ICF / Brick"	  ->  "Isothermal Planes"
								case   3 :	 2		; "Hollow Unit Masonry"		  ->  "Isothermal Planes"
								case   4 :	 2		; "Adobe / Strawbale / Log"  ->  "Isothermal Planes"
								case   5 :	 1		; "SIPS Wall"                ->  "Parallel Path"
								case   9 :	 2		; "No Frame (concrete/CMU)"  ->  "Isothermal Planes"
								case  10 :	 1		; "Wood Framed Ceiling"      ->  "Parallel Path"
								case  11 :	 1		; "Built-up Roof"            ->  "Parallel Path"
								case  12 :	 3		; "Steel Framed Ceiling" 	  ->  "Modified Zone"
								case  13 :	 1		; "SIPS Ceiling" 		        ->  "Parallel Path"
								case  20 :	 1		; "Wood Framed Floor"        ->  "Parallel Path"
								case  23 :	 3		; "Steel Framed Floor"	     ->  "Modified Zone"
								case  24 :	 1		; "SIPS Floor"               ->  "Parallel Path"
								case  25 :	 2		; "Concrete / ICF / Brick"	  ->  "Isothermal Planes" - mass floor - SAC 5/27/14
								default  :	 0		; ... otherwise ...          ->  "- not specified -"
							endswitch  }

	"Set Cons:InsideLayerFirst"	Cons:InsideLayerFirst = {	switch ( Local( CanAssignTo ) )
																					case  0 :	1		; Exterior Walls
																					case 10 :	1		; Interior Walls
																					case 20 :	1		; Underground Walls
																					case  1 :	0		; Attic Roofs
																					case  2 :	0		; Cathedral Ceilings
																					case  3 :	0		; Ceiling (blw attc)
																					case  4 :	1		; Interior Floors
																					case  5 :	1		; Exterior Floors
																					case  6 :	0		; Interior Ceilings
																					case  9 :	1		; Flrs over Crawlspc
																					default :   0
																				endswitch  }

  ; SAC 6/4/14 - added properties to be reported on CF1R
	"Set Cons:CavityLayerAbr"				Cons:CavityLayerAbr			= {	CavityLayer  }
	"Set Cons:FrameLayerAbr"				Cons:FrameLayerAbr			= {	FrameLayer   }
	"Set Cons:FurringInsulLayerAbr"		Cons:FurringInsulLayerAbr	= {	FurringInsulLayer   }
	"Set Cons:FurringInsul2LayerAbr"		Cons:FurringInsul2LayerAbr	= {	FurringInsul2Layer  }
   ; SAC 5/12/17 - new insul/furring reporting strings accounting for user-specified R-values
	"Set Cons:FurringInsulLayerStr"		Cons:FurringInsulLayerStr	= {	if (FurringInsulLayer == 900 .AND. IfValidAnd( FurringInsulLayerRVal >= 0 ))
                                                                        then  Format( "R-%s", FltToStr( FurringInsulLayerRVal, 1, 1, 0, 1 ) )
                                                                        else  EnumString( FurringInsulLayerAbr )  endif   }
	"Set Cons:FurringInsul2LayerStr"		Cons:FurringInsul2LayerStr	= {	if (FurringInsul2Layer == 900 .AND. IfValidAnd( FurringInsul2LayerRVal >= 0 ))
                                                                        then  Format( "R-%s", FltToStr( FurringInsul2LayerRVal, 1, 1, 0, 1 ) )
                                                                        else  EnumString( FurringInsul2LayerAbr )  endif  }
	"Set Cons:FurringLayerAbr"				Cons:FurringLayerAbr			= {	FurringLayer        }
	"Set Cons:Furring2LayerAbr"			Cons:Furring2LayerAbr		= {	Furring2Layer       }
	"Set Cons:AbvDeckInsulLayerRpt"		Cons:AbvDeckInsulLayerRpt	= {	AbvDeckInsulLayer  }       ; SAC 10/21/19 (tic #1121)
   "Set Cons:SheathInsulLayerRpt"      Cons:SheathInsulLayerRpt   = {   SheathInsulLayer   }       ; SAC 10/21/19 (tic #1121)
   "Set Cons:SheathInsul2LayerRpt"     Cons:SheathInsul2LayerRpt  = {   SheathInsul2Layer  }       ; SAC 10/21/19 (tic #1121)

	"Call subordinate rulelist to setup construction material"
		Cons:Action = {	switch (Local( CanAssignTo ))
									case  0 :	if (Type == 0 .OR. Type == 1)							; Exterior Walls
													then  EvalRulelist( "SetupCons_ExtWall_TwoPath"	   , 1 )		; Wood or Steel framed
													else if (Type == 5)
													then  EvalRulelist( "SetupCons_ExtWall_TwoPathSIPS", 1 )		; SIPS
													else  EvalRulelist( "SetupCons_ExtWall_SinglePath" , 1 )		; all others
													endif endif
									case 10 :	if (Type == 0 .OR. Type == 1 .OR. Type == 5)		; Interior Walls
													then  EvalRulelist( "SetupCons_IntWall_TwoPath"   , 1 )     ; Wood, Steel framed or SIPS
													else  EvalRulelist( "SetupCons_IntWall_SinglePath", 1 )     ; all others                
													endif
									case 20 :	EvalRulelist( "SetupCons_UndWall_SinglePath", 1 )
									case  1 :	EvalRulelist( "SetupCons_AtticRoof"			, 1 )	; Attic Roofs
									case  2 :	EvalRulelist( "SetupCons_CathedralCeiling", 1 )	; Cathedral Ceilings
									case  3 :	EvalRulelist( "SetupCons_CeilingBlwAttic"	, 1 )	; Ceiling (blw attc)
									case  4 :	if (Type == 25)											; Interior Floors
													then	EvalRulelist( "SetupCons_IntFloor_SinglePath", 1 )
													else	EvalRulelist( "SetupCons_IntFloor_TwoPath"	, 1 )  endif
									case  5 :	if (Type == 25)											; Exterior Floors
													then	EvalRulelist( "SetupCons_ExtFloor_SinglePath", 1 )
													else	EvalRulelist( "SetupCons_ExtFloor_TwoPath"   , 1 )  endif
									case  6 :	if (Type == 25)											; Interior Ceilings   - try using same defaulting rules as: Interior Floors
													then	EvalRulelist( "SetupCons_IntCeiling_SinglePath", 1 )
													else	EvalRulelist( "SetupCons_IntCeiling_TwoPath"	, 1 )  endif
									case  9 :	if (Type == 25)											; Floors ovr Crwlspc
													then	EvalRulelist( "SetupCons_ExtFloor_SinglePath", 1 )
													else	EvalRulelist( "SetupCons_ExtFloor_TwoPath"   , 1 )  endif
									default :	EvalRulelist( "SetupCons_none"				, 1 )
								endswitch  }

;	"Set Cons:WinterDesUValue"		Cons:WinterDesUValue = {	if (Local( OverallCodeUValue ) > 0.00001) then  Local( OverallCodeUValue )  else  UNDEFINED  endif  }


;	"Set Cons:LayerLabels[1]"	Cons:LayerLabels[1] = {	"Inside Finish:"  }
;	"Set Cons:LayerLabels[2]"	Cons:LayerLabels[2] = {	switch( Local( Type ) )
;																			case  0 :  "Cavity/Frame Layer:"		 ; "Wood Framed Wall"  
;																			case  1 :  "Cavity/Frame Layer:"		 ; "Steel Framed Wall"  
;																			case 10 :  "Framing:"					 ; "Wood Framed Ceiling"  
;																			case 11 :  "??? Layer:"					 ; "Built-up Roof"  
;																			case 20 :  "Cavity/Frame Layer:"		 ; "Wood Framed Floor"  
;																			case 21 :  "Concrete Layer:"			 ; "Floor Slab"  
;																			case 22 :  "Concrete Layer:"			 ; "Basement (underground) Floor"  
;																			default :  "  "
;																		endswitch  }
;	"Set Cons:LayerLabels[3]"	Cons:LayerLabels[3] = {	switch( Local( Type ) )
;																			case  0 :  "Sheathing/Insulation Layer:"	 ; "Wood Framed Wall"  
;																			case  1 :  "Sheathing/Insulation Layer:"	 ; "Steel Framed Wall"  
;																			case 10 :  "Insulation Layer:"				 ; "Wood Framed Ceiling"  
;																			case 11 :  "??? Layer:"							 ; "Built-up Roof"  
;																			case 20 :  "Sheathing/Insulation Layer:"	 ; "Wood Framed Floor"  
;																			case 21 :  "Insulation Layer:"				 ; "Floor Slab"  
;																			case 22 :  "Insulation Layer:"				 ; "Basement (underground) Floor"  
;																			default :  "  "
;																		endswitch  }
;	"Set Cons:LayerLabels[4]"	Cons:LayerLabels[4] = {	switch( Local( Type ) )
;																			case  0 :  "Exterior Finish Layer:"		; "Wood Framed Wall"  
;																			case  1 :  "Exterior Finish Layer:"		; "Steel Framed Wall"  
;																		;	case 10 :  "  "				 				; "Wood Framed Ceiling"  
;																			case 11 :  "??? Layer:"						; "Built-up Roof"  
;																			case 20 :  "Exterior Layer:"	 			; "Wood Framed Floor"  
;																		;	case 21 :  "  "				 				; "Floor Slab"  
;																		;	case 22 :  "  "				 				; "Basement (underground) Floor"  
;																			default :  "  "
;																		endswitch  }
;
;	"Set Cons:FramePathEditable[1]"		Cons:FramePathEditable[1]	= {	0  }  ; "Inside Finish:"
;	"Set Cons:FramePathEditable[2]"		Cons:FramePathEditable[2]	= {	switch( Local( Type ) )
;																									case  0 :  1	; "Cavity/Frame Layer:"		 ; "Wood Framed Wall"  
;																									case  1 :  1   ; "Cavity/Frame Layer:"		 ; "Steel Framed Wall"  
;																									case 10 :  1   ; "Framing:"					 ; "Wood Framed Ceiling"  
;																									case 11 :  0   ; "??? Layer:"					 ; "Built-up Roof"  
;																									case 20 :  1   ; "Cavity/Frame Layer:"		 ; "Wood Framed Floor"  
;																									case 21 :  0   ; "Concrete Layer:"			 ; "Floor Slab"  
;																									case 22 :  0   ; "Concrete Layer:"			 ; "Basement (underground) Floor"  
;																									default :  0
;																								endswitch  }
;	"Set Cons:FramePathEditable[3]"		Cons:FramePathEditable[3]	= {	switch( Local( Type ) )
;																									case  0 :  0   ; "Sheathing/Insulation Layer:"	 ; "Wood Framed Wall"  
;																									case  1 :  0   ; "Sheathing/Insulation Layer:"	 ; "Steel Framed Wall"  
;																									case 10 :  0   ; "Insulation Layer:"				 ; "Wood Framed Ceiling"  
;																									case 11 :  0   ; "??? Layer:"							 ; "Built-up Roof"  
;																									case 20 :  0   ; "Sheathing/Insulation Layer:"	 ; "Wood Framed Floor"  
;																									case 21 :  0   ; "Insulation Layer:"				 ; "Floor Slab"  
;																									case 22 :  0   ; "Insulation Layer:"				 ; "Basement (underground) Floor"  
;																									default :  0
;																								endswitch  }
;	"Set Cons:FramePathEditable[4]"		Cons:FramePathEditable[4]	= {	switch( Local( Type ) )
;																									case  0 :  0   ; "Exterior Finish Layer:"		; "Wood Framed Wall"  
;																									case  1 :  0   ; "Exterior Finish Layer:"		; "Steel Framed Wall"  
;																								;	case 10 :  0   ; "  "				 				; "Wood Framed Ceiling"  
;																									case 11 :  0   ; "??? Layer:"						; "Built-up Roof"  
;																									case 20 :  0   ; "Exterior Layer:"	 			; "Wood Framed Floor"  
;																								;	case 21 :  0   ; "  "				 				; "Floor Slab"  
;																								;	case 22 :  0   ; "  "				 				; "Basement (underground) Floor"  
;																									default :  0
;																								endswitch  }
;
;	"Set Cons:NumPaths"		Cons:NumPaths = {		switch( Local( Type ) )
;																	case  0 :  2	; "Wood Framed Wall"  
;																	case  1 :  2	; "Steel Framed Wall"  
;																	case 10 :  1	; "Wood Framed Ceiling"  
;																	case 11 :  2	; "Built-up Roof"  
;																	case 20 :  2	; "Wood Framed Floor"  
;																	case 21 :  1	; "Floor Slab"  
;																	case 22 :  1	; "Basement (underground) Floor"  
;																	default :  0	
;																endswitch  }
;
;; Cons:CavityPathLyr1,        Optional,   BEMP_Sym,  1,   "",    
;; Cons:CavityPathLyr2,        Optional,   BEMP_Sym,  1,   "",    
;; Cons:CavityPathLyr3,        Optional,   BEMP_Sym,  1,   "",    
;; Cons:CavityPathLyr4,        Optional,   BEMP_Sym,  1,   "",    
;; Cons:CavityPathMats[ALL],   Optional,   BEMP_Obj, 10,   "Mat", 
;; Cons:FramePathLyr1,         Optional,   BEMP_Sym,  1,   "",    
;; Cons:FramePathLyr2,         Optional,   BEMP_Sym,  1,   "",    
;; Cons:FramePathLyr3,         Optional,   BEMP_Sym,  1,   "",    
;; Cons:FramePathLyr4,         Optional,   BEMP_Sym,  1,   "",    
;; Cons:FramePathMats[ALL],    Optional,   BEMP_Obj, 10,   "Mat", 
;
;   ; IF THE FOLLOWING VALUE IS MODIFIED, THEN ALL SUBSEQUENT RULES WHICH REFERENCE EACH
;   ; POSSIBLE MATERIAL LAYER MUST ALSO CHANGE TO TAKE INTO ACCOUNT THE NEW MaxNumLayers
;	"Set Cons:MaxNumLayers"		Cons:MaxNumLayers = {  8  }
;
;	"Set Cons:NumLayers"		Cons:NumLayers = {	switch( Local( Type ) )
;																			case  0 :  4	; "Wood Framed Wall"  
;																			case  1 :  4	; "Steel Framed Wall"  
;																			case 10 :  3	; "Wood Framed Ceiling"  
;																			case 11 :  4	; "Built-up Roof"  
;																			case 20 :  4	; "Wood Framed Floor"  
;																			case 21 :  3	; "Floor Slab"  
;																			case 22 :  3	; "Basement (underground) Floor"  
;																			default :  0	
;																		endswitch  }
;;	"Calculate NumLayers"
;;      Cons:NumLayers = {
;;                 if      ( LocalRef( CavityPathMats[ 8]:Resistance  ) > 0 .OR. LocalRef( FramePathMats[ 8]:Resistance  ) > 0 ) then  8
;;                 else if ( LocalRef( CavityPathMats[ 7]:Resistance  ) > 0 .OR. LocalRef( FramePathMats[ 7]:Resistance  ) > 0 ) then  7
;;                 else if ( LocalRef( CavityPathMats[ 6]:Resistance  ) > 0 .OR. LocalRef( FramePathMats[ 6]:Resistance  ) > 0 ) then  6
;;                 else if ( LocalRef( CavityPathMats[ 5]:Resistance  ) > 0 .OR. LocalRef( FramePathMats[ 5]:Resistance  ) > 0 ) then  5
;;                 else if ( LocalRef( CavityPathMats[ 4]:Resistance  ) > 0 .OR. LocalRef( FramePathMats[ 4]:Resistance  ) > 0 ) then  4
;;                 else if ( LocalRef( CavityPathMats[ 3]:Resistance  ) > 0 .OR. LocalRef( FramePathMats[ 3]:Resistance  ) > 0 ) then  3
;;                 else if ( LocalRef( CavityPathMats[ 2]:Resistance  ) > 0 .OR. LocalRef( FramePathMats[ 2]:Resistance  ) > 0 ) then  2
;;                 else if ( LocalRef( CavityPathMats[ 1]:Resistance  ) > 0 .OR. LocalRef( FramePathMats[ 1]:Resistance  ) > 0 ) then  1
;;                 else  0  endif  endif  endif  endif  endif  endif  endif  endif  }
;;      Cons:NumLayers = {
;;                 if      ( LocalRef( Materials[ 8]:Resistance  ) > 0 .OR.
;;                           LocalRef( Materials[ 8]:RValPerInch ) > 0 ) then  8
;;                 else if ( LocalRef( Materials[ 7]:Resistance  ) > 0 .OR.
;;                           LocalRef( Materials[ 7]:RValPerInch ) > 0 ) then  7
;;                 else if ( LocalRef( Materials[ 6]:Resistance  ) > 0 .OR.
;;                           LocalRef( Materials[ 6]:RValPerInch ) > 0 ) then  6
;;                 else if ( LocalRef( Materials[ 5]:Resistance  ) > 0 .OR.
;;                           LocalRef( Materials[ 5]:RValPerInch ) > 0 ) then  5
;;                 else if ( LocalRef( Materials[ 4]:Resistance  ) > 0 .OR.
;;                           LocalRef( Materials[ 4]:RValPerInch ) > 0 ) then  4
;;                 else if ( LocalRef( Materials[ 3]:Resistance  ) > 0 .OR.
;;                           LocalRef( Materials[ 3]:RValPerInch ) > 0 ) then  3
;;                 else if ( LocalRef( Materials[ 2]:Resistance  ) > 0 .OR.
;;                           LocalRef( Materials[ 2]:RValPerInch ) > 0 ) then  2
;;                 else if ( LocalRef( Materials[ 1]:Resistance  ) > 0 .OR.
;;                           LocalRef( Materials[ 1]:RValPerInch ) > 0 ) then  1
;;                 else  0  endif  endif  endif  endif  endif  endif  endif  endif  }

; 	"Default Cons:FramePathLyr1 (based on CavityPathLyr1)"
; 			Cons:FramePathLyr1 = {	if (Local( NumPaths ) < 1.5) then  UNDEFINED
; 											else	switch( Local( Type ) )
; 														case  0 :  Local( CavityPathLyr1 )	; "Wood Framed Wall"  
; 														case  1 :  Local( CavityPathLyr1 )	; "Steel Framed Wall"  
; 														case 11 :  Local( CavityPathLyr1 )	; "Built-up Roof"  
; 														case 20 :  Local( CavityPathLyr1 )	; "Wood Framed Floor"  
; 														default :  UNDEFINED
; 													endswitch  endif  }
; 	"Default Cons:FramePathLyr2 (based on CavityPathLyr2)"
; 			Cons:FramePathLyr2 = {	UNDEFINED  }		; possibly update in future to default based on selected cavity layer??
; 	"Default Cons:FramePathLyr3 (based on CavityPathLyr3)"
; 			Cons:FramePathLyr3 = {	if (Local( NumPaths ) < 1.5) then  UNDEFINED
; 											else	switch( Local( Type ) )
; 														case  0 :  Local( CavityPathLyr3 )	; "Wood Framed Wall"  
; 														case  1 :  Local( CavityPathLyr3 )	; "Steel Framed Wall"  
; 														case 11 :  Local( CavityPathLyr3 )	; "Built-up Roof"  
; 														case 20 :  Local( CavityPathLyr3 )	; "Wood Framed Floor"  
; 														default :  UNDEFINED
; 													endswitch  endif  }
; 	"Default Cons:FramePathLyr4 (based on CavityPathLyr4)"
; 			Cons:FramePathLyr4 = {	if (Local( NumPaths ) < 1.5) then  UNDEFINED
; 											else	switch( Local( Type ) )
; 														case  0 :  Local( CavityPathLyr4 )	; "Wood Framed Wall"  
; 														case  1 :  Local( CavityPathLyr4 )	; "Steel Framed Wall"  
; 														case 11 :  Local( CavityPathLyr4 )	; "Built-up Roof"  
; 														case 20 :  Local( CavityPathLyr4 )	; "Wood Framed Floor"  
; 														default :  UNDEFINED
; 													endswitch  endif  }
; 
; 	"Default Cons:FramePathMats[1] (based on CavityPathMats[1])"
; 			Cons:FramePathMats[1] = {	if (Local( NumPaths ) < 1.5) then  UNDEFINED
; 												else	switch( Local( Type ) )
; 															case  0 :  Local( CavityPathMats[1] )	; "Wood Framed Wall"  
; 															case  1 :  Local( CavityPathMats[1] )	; "Steel Framed Wall"  
; 															case 11 :  Local( CavityPathMats[1] )	; "Built-up Roof"  
; 															case 20 :  Local( CavityPathMats[1] )	; "Wood Framed Floor"  
; 															default :  UNDEFINED
; 														endswitch  endif  }
; 	"Default Cons:FramePathMats[2] (based on CavityPathMats[2])"
; 			Cons:FramePathMats[2] = {	UNDEFINED  }		; possibly update in future to default based on selected cavity layer??
; 	"Default Cons:FramePathMats[3] (based on CavityPathMats[3])"
; 			Cons:FramePathMats[3] = {	if (Local( NumPaths ) < 1.5) then  UNDEFINED
; 												else	switch( Local( Type ) )
; 															case  0 :  Local( CavityPathMats[3] )	; "Wood Framed Wall"  
; 															case  1 :  Local( CavityPathMats[3] )	; "Steel Framed Wall"  
; 															case 11 :  Local( CavityPathMats[3] )	; "Built-up Roof"  
; 															case 20 :  Local( CavityPathMats[3] )	; "Wood Framed Floor"  
; 															default :  UNDEFINED
; 														endswitch  endif  }
; 	"Default Cons:FramePathMats[4] (based on CavityPathMats[4])"
; 			Cons:FramePathMats[4] = {	if (Local( NumPaths ) < 1.5) then  UNDEFINED
; 												else	switch( Local( Type ) )
; 															case  0 :  Local( CavityPathMats[4] )	; "Wood Framed Wall"  
; 															case  1 :  Local( CavityPathMats[4] )	; "Steel Framed Wall"  
; 															case 11 :  Local( CavityPathMats[4] )	; "Built-up Roof"  
; 															case 20 :  Local( CavityPathMats[4] )	; "Wood Framed Floor"  
; 															default :  UNDEFINED
; 														endswitch  endif  }

;    "Set Thickness[1] in Cons"		Cons:Thickness[1] = { max( LocalRef( CavityPathMats[1]:Thickness ), LocalRef( FramePathMats[1]:Thickness ) )  }
;    "Set Thickness[2] in Cons"		Cons:Thickness[2] = { max( LocalRef( CavityPathMats[2]:Thickness ), LocalRef( FramePathMats[2]:Thickness ) )  }
;    "Set Thickness[3] in Cons"		Cons:Thickness[3] = { max( LocalRef( CavityPathMats[3]:Thickness ), LocalRef( FramePathMats[3]:Thickness ) )  }
;    "Set Thickness[4] in Cons"		Cons:Thickness[4] = { max( LocalRef( CavityPathMats[4]:Thickness ), LocalRef( FramePathMats[4]:Thickness ) )  }
;    "Set Thickness[5] in Cons"		Cons:Thickness[5] = { max( LocalRef( CavityPathMats[5]:Thickness ), LocalRef( FramePathMats[5]:Thickness ) )  }
;    "Set Thickness[6] in Cons"		Cons:Thickness[6] = { max( LocalRef( CavityPathMats[6]:Thickness ), LocalRef( FramePathMats[6]:Thickness ) )  }
;    "Set Thickness[7] in Cons"		Cons:Thickness[7] = { max( LocalRef( CavityPathMats[7]:Thickness ), LocalRef( FramePathMats[7]:Thickness ) )  }
;    "Set Thickness[8] in Cons"		Cons:Thickness[8] = { max( LocalRef( CavityPathMats[8]:Thickness ), LocalRef( FramePathMats[8]:Thickness ) )  }

;    "Set Resistance[1] in Cons"		Cons:Resistance[1] = { LocalRef( Materials[1]:Resistance ) }
;    "Set Resistance[2] in Cons"		Cons:Resistance[2] = { LocalRef( Materials[2]:Resistance ) }
;    "Set Resistance[3] in Cons"		Cons:Resistance[3] = { LocalRef( Materials[3]:Resistance ) }
;    "Set Resistance[4] in Cons"		Cons:Resistance[4] = { LocalRef( Materials[4]:Resistance ) }
;    "Set Resistance[5] in Cons"		Cons:Resistance[5] = { LocalRef( Materials[5]:Resistance ) }
;    "Set Resistance[6] in Cons"		Cons:Resistance[6] = { LocalRef( Materials[6]:Resistance ) }
;    "Set Resistance[7] in Cons"		Cons:Resistance[7] = { LocalRef( Materials[7]:Resistance ) }
;    "Set Resistance[8] in Cons"		Cons:Resistance[8] = { LocalRef( Materials[8]:Resistance ) }

	"Default Cons:OverallThickness"	Cons:OverallThickness = {	Local( Thickness[1] ) + Local( Thickness[2] ) + Local( Thickness[3] ) + Local( Thickness[4] ) +
																					Local( Thickness[5] ) + Local( Thickness[6] ) + Local( Thickness[7] ) + Local( Thickness[8] )  }
END
;*************************************************************************



; SAC 11/1/12 - added rulelists to initialize & set Attic Edge properties
; SAC 10/15/14 - significantly modified when moving attic edge properties from Cons to CeilingBelowAttic (to support multiple attics)
;*************************************************************************
RULELIST "SetupCons_AtticEdge_Set"         0 0 0 0
;*************************************************************************
;"debugging" Proj:Action = { if (RunAbbrev == "s") then  MessageBox( "evaluating 'SetupCons_AtticEdge_Set' for %s:%s run", RunID, EnumString( StandardsVersion ) )  else  UNCHANGED  endif }
;"debugging" CeilingBelowAttic:Action = { if (RunAbbrev == "s") then  PostMessageToLog( "evaluating 'SetupCons_AtticEdge_Set' on CeilingBelowAttic '%s' in %s:%s run", Name, RunID, EnumString( StandardsVersion ) )  else  UNCHANGED  endif }
;"debugging" CeilingBelowAttic:Action = { if (RunAbbrev == "s" .AND. LocalCompAssigned( Construction )) then  PostMessageToLog( "      CeilingBelowAttic:Construction '%s', CavityLayerRVal %g", Construction:Name, ValidOr( Construction:CavityLayerRVal, -1 ) )  else  UNCHANGED  endif }
;"debugging" CeilingBelowAttic:Action = { if (RunAbbrev == "s" .AND. LocalCompAssigned( AtticZone    )) then  PostMessageToLog( "      CeilingBelowAttic:AtticZone '%s', RoofTilt %g", AtticZone:Name, ValidOr( AtticZone:RoofTilt, -1 ) )  else  UNCHANGED  endif }
;"debugging" CeilingBelowAttic:Action = { if (RunAbbrev == "s" .AND. LocalCompAssigned( AtticZone:Construction )) then  PostMessageToLog( "      CeilingBelowAttic:AtticZone:Construction '%s', CavityLayerRVal %g", AtticZone:Construction:Name, ValidOr( AtticZone:Construction:CavityLayerRVal, -1 ) )  else  UNCHANGED  endif }

	"Default CeilingBelowAttic:EdgCavityRTot"			CeilingBelowAttic:EdgCavityRTot     	= {	ValidOr( Construction:CavityLayerRVal, 0 )  }
  ; SAC 4/25/14 - added rule to ensure that roof deck insulation is included in attic edge calcs
	"Default CeilingBelowAttic:EdgCavityRTot-2"		CeilingBelowAttic:EdgCavityRTot     	= {	if (LocalCompAssigned( AtticZone:Construction ) == 0) then  UNCHANGED
																																else if (IfValidAnd( AtticZone:Construction:CavityLayerRVal > 0 ))
																																then  EdgCavityRTot + (AtticZone:Construction:CavityLayerRVal / cos( (AtticZone:RoofTilt * 3.14159265 / 180) ))
																																else  UNCHANGED  endif endif  }
	"Default CeilingBelowAttic:EdgInsulRValPerInch"	CeilingBelowAttic:EdgInsulRValPerInch	= {	Proj:InsulRValPerInch[1]  }

	"Set CeilingBelowAttic:AtcEdg_Yl"				CeilingBelowAttic:AtcEdg_Yl      	= {	(ValidOr( AtcEdg_ClgCons:CavityThickness, 0 ) / 12) * (1 + sqrt( 1 + (ValidOr( AtticZone:RoofPitch, 0 ) * ValidOr( AtticZone:RoofPitch, 0 )) ))  }
	"Set CeilingBelowAttic:AtcEdg_Xl"				CeilingBelowAttic:AtcEdg_Xl      	= {	if (IfValidAnd( AtticZone:RoofPitch > 0 ))
																														then	(AtcEdg_Yl - (ValidOr( AtcEdg_ClgCons:RaisedHeelTrussHeight, 0 ) / 12)) / AtticZone:RoofPitch
																														else	0	endif  }
	"Set CeilingBelowAttic:AtcEdg_Ym"				CeilingBelowAttic:AtcEdg_Ym      	= {	if (AtcEdg_Xl >= (ValidOr( AtcEdg_ClgCons:CavityThickness, 0 ) / 12))
																														then	AtcEdg_Yl
																														else	(((ValidOr( AtcEdg_ClgCons:CavityThickness, 0 ) / 12) - AtcEdg_Xl) * ValidOr( AtticZone:RoofPitch, 0 )) + AtcEdg_Yl  endif  }
	"Set CeilingBelowAttic:AtcEdg_InsulDepth"		CeilingBelowAttic:AtcEdg_InsulDepth = {	if (EdgInsulRValPerInch > 0.01)
																														then	EdgCavityRTot / (12 * EdgInsulRValPerInch)
																														else	0	endif  }
	"Set CeilingBelowAttic:AtcEdg_CalcPath"		CeilingBelowAttic:AtcEdg_CalcPath	= {	if (AtcEdg_InsulDepth >= AtcEdg_Ym) then  1   ; "D >= Ym"
																														else if (AtcEdg_InsulDepth < AtcEdg_Ym .AND. AtcEdg_InsulDepth > (ValidOr( AtcEdg_ClgCons:RaisedHeelTrussHeight, 0 ) / 12)) then  2   ; "D < Ym & D > Y"
																														else if (AtcEdg_InsulDepth <= (ValidOr( AtcEdg_ClgCons:RaisedHeelTrussHeight, 0 ) / 12)) then  3   ; "D <= Y"
																														else  0  endif endif endif  }
	"Set CeilingBelowAttic:AtcEdg_WA"		CeilingBelowAttic:AtcEdg_WA      = {	switch (AtcEdg_CalcPath)
																												case  1 :  max( AtcEdg_Xl, (ValidOr( AtcEdg_ClgCons:CavityThickness, 0 ) / 12) )     ; "D >= Ym"       
																												case  2 :  (AtcEdg_InsulDepth - (ValidOr( AtcEdg_ClgCons:RaisedHeelTrussHeight, 0 ) / 12)) / ValidOr( AtticZone:RoofPitch, 0.166 )     ; "D < Ym & D > Y"
																												case  3 :  0     ; "D <= Y"        
																												default :  0
																											endswitch  }
	"Set CeilingBelowAttic:AtcEdg_WB"		CeilingBelowAttic:AtcEdg_WB      = {	switch (AtcEdg_CalcPath)
																												case  1 :  (AtcEdg_InsulDepth - AtcEdg_Ym) / ValidOr( AtticZone:RoofPitch, 0.166 )     ; "D >= Ym"       
																												case  2 :  0     ; "D < Ym & D > Y"
																												case  3 :  0     ; "D <= Y"        
																												default :  0
																											endswitch  }
	"Set CeilingBelowAttic:AtcEdg_HA"		CeilingBelowAttic:AtcEdg_HA      = {	switch (AtcEdg_CalcPath)
																												case  1 :  (AtcEdg_Ym         + (ValidOr( AtcEdg_ClgCons:RaisedHeelTrussHeight, 0 ) / 12)) / 2     ; "D >= Ym"       
																												case  2 :  (AtcEdg_InsulDepth + (ValidOr( AtcEdg_ClgCons:RaisedHeelTrussHeight, 0 ) / 12)) / 2     ; "D < Ym & D > Y"
																												case  3 :  0     ; "D <= Y"        
																												default :  0
																											endswitch  }
	"Set CeilingBelowAttic:AtcEdg_HB"		CeilingBelowAttic:AtcEdg_HB      = {	switch (AtcEdg_CalcPath)
																												case  1 :  (AtcEdg_Ym + AtcEdg_InsulDepth) / 2     ; "D >= Ym"       
																												case  2 :  0     ; "D < Ym & D > Y"
																												case  3 :  0     ; "D <= Y"        
																												default :  0
																											endswitch  }
	"Set CeilingBelowAttic:AtcEdg_HB1"		CeilingBelowAttic:AtcEdg_HB1     = {	switch (AtcEdg_CalcPath)
																												case  1 :  AtcEdg_Yl      ; "D >= Ym"       
																												case  2 :  0     ; "D < Ym & D > Y"
																												case  3 :  0     ; "D <= Y"        
																												default :  0
																											endswitch  }
	"Set CeilingBelowAttic:AtcEdg_HB2"		CeilingBelowAttic:AtcEdg_HB2     = {	switch (AtcEdg_CalcPath)
																												case  1 :  AtcEdg_HB - AtcEdg_Yl     ; "D >= Ym"  
																												case  2 :  0     ; "D < Ym & D > Y" 
																												case  3 :  0     ; "D <= Y"         
																												default :  0
																											endswitch  }
	"Set CeilingBelowAttic:AtcEdg_HB3"		CeilingBelowAttic:AtcEdg_HB3 	   = {	switch (AtcEdg_CalcPath)
																												case  1 :  (ValidOr( AtcEdg_ClgCons:CavityThickness, 0 ) / 12)     ; "D >= Ym"       
																												case  2 :  0     ; "D < Ym & D > Y"
																												case  3 :  0     ; "D <= Y"        
																												default :  0
																											endswitch  }
	"Set CeilingBelowAttic:AtcEdg_ConsMsg[1]"	CeilingBelowAttic:AtcEdg_ConsMsg[1]	= {	Format( "Attic Edge:  RTot=%.1f / R/in=%.2f / w=%.3f / Y=%.3f / pitch=%.3f / Yl=%.3f / Xl=%.3f / YM=%.3f",
																								EdgCavityRTot, EdgInsulRValPerInch, (ValidOr( AtcEdg_ClgCons:CavityThickness, 0 )/12), (ValidOr( AtcEdg_ClgCons:RaisedHeelTrussHeight, 0 )/12),
																								AtticZone:RoofPitch, AtcEdg_Yl, AtcEdg_Xl, AtcEdg_Ym )  }
	"Set CeilingBelowAttic:AtcEdg_ConsMsg[2]"	CeilingBelowAttic:AtcEdg_ConsMsg[2]	= {	Format( "     D=%.3f => (%s) => WA=%.3f / WB=%.3f / HA=%.3f / HB=%.3f / HB2=%.3f",
																								AtcEdg_InsulDepth, EnumString(AtcEdg_CalcPath), AtcEdg_WA, AtcEdg_WB, AtcEdg_HA, AtcEdg_HB, AtcEdg_HB2 )  }
END

;*************************************************************************
RULELIST "SetupCons_AtticEdge_Init"         0 0 0 0
;*************************************************************************
	"Init CeilingBelowAttic:EdgCavityRTot"			CeilingBelowAttic:EdgCavityRTot     	= {	0  }
	"Init CeilingBelowAttic:EdgInsulRValPerInch"	CeilingBelowAttic:EdgInsulRValPerInch	= {	0  }
	"Init CeilingBelowAttic:AtcEdg_Yl"				CeilingBelowAttic:AtcEdg_Yl      	   = {	0  }
	"Init CeilingBelowAttic:AtcEdg_Xl"				CeilingBelowAttic:AtcEdg_Xl      	   = {	0  }
	"Init CeilingBelowAttic:AtcEdg_Ym"				CeilingBelowAttic:AtcEdg_Ym      	   = {	0  }
	"Init CeilingBelowAttic:AtcEdg_InsulDepth"	CeilingBelowAttic:AtcEdg_InsulDepth    = {	0  }
	"Init CeilingBelowAttic:AtcEdg_CalcPath"		CeilingBelowAttic:AtcEdg_CalcPath		= {	0  }
	"Init CeilingBelowAttic:AtcEdg_WA"				CeilingBelowAttic:AtcEdg_WA      	   = {	0  }
	"Init CeilingBelowAttic:AtcEdg_WB"				CeilingBelowAttic:AtcEdg_WB      	   = {	0  }
	"Init CeilingBelowAttic:AtcEdg_HA"				CeilingBelowAttic:AtcEdg_HA      	   = {	0  }
	"Init CeilingBelowAttic:AtcEdg_HB"				CeilingBelowAttic:AtcEdg_HB      	   = {	0  }
	"Init CeilingBelowAttic:AtcEdg_HB1"				CeilingBelowAttic:AtcEdg_HB1     	   = {	0  }
	"Init CeilingBelowAttic:AtcEdg_HB2"				CeilingBelowAttic:AtcEdg_HB2     	   = {	0  }
	"Init CeilingBelowAttic:AtcEdg_HB3"				CeilingBelowAttic:AtcEdg_HB3     	   = {	0  }
	"Init CeilingBelowAttic:AtcEdg_ConsMsg[1]"	CeilingBelowAttic:AtcEdg_ConsMsg[1]		= {	UNDEFINED  }
	"Init CeilingBelowAttic:AtcEdg_ConsMsg[2]"	CeilingBelowAttic:AtcEdg_ConsMsg[2]		= {	UNDEFINED  }
END
;*************************************************************************

;*************************************************************************
RULELIST "Cons_CavityLayer_SetValidNoInsulationOption" 1 0 1 1      ; SAC 2/20/14 - fix problem where '- no insulation -' options can get confused between different vertical and non-vertical values
;*************************************************************************
	"Set Cons:CavityLayer to valid 'no insulation' option"	Cons:CavityLayer	= {	if (Type == 0 .OR. Type == 1 .OR. Type == 5) then  100401  else  0  endif  }
END
;*************************************************************************


;*************************************************************************
RULELIST "CreateConsCavityInsulMat_All"         0 0 0 1
;*************************************************************************

;"debug" Cons:Action  = {  if (Name != "Attic RoofMain Floor") then  UNCHANGED  else  StoreBEMProc( "CavMatCr8", 0 )  endif  }
;"debug" Cons:Action  = {  if (Name != "Attic RoofMain Floor") then  UNCHANGED  else  MessageBox( "CavMatCr8 model written" )  endif  }

; SAC 10/28/17 - added logic to ensure insulation-only Mat created & assigned for mass walls w/ user-specified R-value and no furring (tic #913)
  ; Round #1 - create custom cavity insulation materials
	"Setup generic Cons insulation material properties"		Cons:Action	= {	EvalRulelist( "SetupDefaultConsCavityInsulMatProperties", 1 )  }
	"Assign or create Cons:CavityPathMats[1]"		Cons:CavityPathMats[1]	= {
						if (IfValidAnd( FrameCavityLayerMat[1] == 1 ) .OR. IfValidAnd( FrameCavityLayerMat[2] == 1 ))
						then	if (FrameLayerSymVal[1] >= 10000 .AND. FrameLayerSymVal[1] < 40000 .AND. FrameLayerSymVal[1] != 10424 .AND. FrameLayerSymVal[1] != 20424)
								then	; need to add a UNIQUE material here, consistent w/ cavity resistance - this Mat to be altered by ConsUFactorRes() routine
										if (	IfValidAnd( CavityPathMats[1]:ConductivityQII == CavityMatCondQII[1] ) .AND. IfValidAnd( CavityPathMats[1]:Density  == TempDensity  ) .AND.
												IfValidAnd( CavityPathMats[1]:ConductivityCT  == TempCondCT          ) .AND. IfValidAnd( CavityPathMats[1]:SpecHeat == TempSpecHeat ))
										then	UNCHANGED
										else if (LocalCompAssigned( CavityPathMats[1] ) == 0)
										then	if (IfValidAnd( CavityLayerSymVal[1] = 900 ) .AND. IfValidAnd( LayerUsrInpInsRVal[1] >= 0 ))
                                    then  CreateComp( Mat, Format( "%s InsFur1-R%s", Name, FltToStr( LayerUsrInpInsRVal[1], 1, 1, 0, 1 ) ), "MarkMatForDeletion" )
                                    else  CreateComp( Mat, Format( "%s InsFur1-R%s", Name, FltToStr( CavityLayerSymVal[1],  1, 1, 0, 1 ) ), "MarkMatForDeletion" )  endif
										else if (IfValidAnd( CavityPathMats[1]:Name == InsFurMatName[1] ))
										then	CreateComp( Mat, Format( "%s InsFur1-R%s", Name, FltToStr( CavityLayerSymVal[1], 1, 1, 0, 1 ) ), "MarkMatForDeletion" )  else  UNCHANGED  endif endif endif
								else if (IfValidAnd( CavityLayerSymVal[1] == 0 )) then  UNDEFINED
								else if (IfValidAnd( CavityLayerSymVal[1] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[1] < 201 ) .AND. TempDensity > 0)
								then	AssignOrCreateComp( Mat, Format( "Ins-R%s-D%s-SH%s-C%s", FltToStr( CavityLayerSymVal[1], 1, 1, 0, 1 ),
															FltToStr( TempDensity, 1, 1, 0, 1 ), FltToStr( TempSpecHeat, 2, 1, 0, 1 ), FltToStr( CavityMatCond[1], 5, 1, 0, 1 ) ),
															"Density", TempDensity, "SpecHeat", TempSpecHeat, "Conductivity", CavityMatCond[1], "ConductivityQII", CavityMatCondQII[1], "ConductivityCT", TempCondCT, "MarkForDeletion", UNDEFINED )
								else if (IfValidAnd( CavityLayerSymVal[1] = 900 ) .AND. IfValidAnd( LayerUsrInpInsRVal[1] >= 0 ) .AND. TempDensity > 0)
								then  AssignOrCreateComp( Mat, Format( "Ins-R%s-D%s-SH%s-C%s", FltToStr( LayerUsrInpInsRVal[1], 1, 1, 0, 1 ),
															FltToStr( TempDensity, 1, 1, 0, 1 ), FltToStr( TempSpecHeat, 2, 1, 0, 1 ), FltToStr( CavityMatCond[1], 5, 1, 0, 1 ) ),
															"Density", TempDensity, "SpecHeat", TempSpecHeat, "Conductivity", CavityMatCond[1], "ConductivityQII", CavityMatCondQII[1], "ConductivityCT", TempCondCT, "MarkForDeletion", UNDEFINED )
								else  UNCHANGED  endif endif endif endif
						else  UNCHANGED  endif  }
	"Setup unique Cavity/Ins/Furring material Cons:CavityPathMats[1]"		Cons:Action	= {
						if ((IfValidAnd( FrameCavityLayerMat[1] == 1 ) .OR. IfValidAnd( FrameCavityLayerMat[2] == 1 )) .AND. IfValidAnd( FrameLayerSymVal[1] >= 10000 ) .AND.
								IfValidAnd( FrameLayerSymVal[1] < 40000 ) .AND. FrameLayerSymVal[1] != 10424 .AND. FrameLayerSymVal[1] != 20424 .AND. LocalCompAssigned( CavityPathMats[1] ))
						then	EvalRulelist( "SetupUniqueCavityInsFurMat_1", 1 )  else  UNCHANGED  endif  }
	"Store name of Mat in Framing/Cavity slot for possible future replacement: Cons:InsFurMatName[1]"		Cons:InsFurMatName[1]	= {
						if ((IfValidAnd( FrameCavityLayerMat[1] == 1 ) .OR. IfValidAnd( FrameCavityLayerMat[2] == 1 )) .AND. LocalCompAssigned( CavityPathMats[1] )) then  CavityPathMats[1]:Name  else  UNCHANGED  endif  }

; SAC 3/17/14 - to be REMOVED
; "debugging"		Cons:Action = {  if (Name != "R15 R4 Stucco Wall") then  UNCHANGED  else  StoreBEMProc( "Before CavityPathMats-2 creation", 0 )  endif  }
;"debugging"  Cons:Action = {
;		if (IfValidAnd( FrameCavityLayerMat[1] == 2 ) .OR. IfValidAnd( FrameCavityLayerMat[2] == 2 ))
;		then  if (FrameLayerSymVal[2] >= 10000 .AND. FrameLayerSymVal[2] < 40000 .AND. FrameLayerSymVal[2] != 10424 .AND. FrameLayerSymVal[2] != 20424) then	UNCHANGED
;				else if (IfValidAnd( CavityLayerSymVal[2] == 0 )) then  UNCHANGED
;				else if (IfValidAnd( CavityLayerSymVal[2] > 0 ))
;            then  MessageBox( "Cons '%s' CavityLayerSymVal[2]=%g / TempDensity=%g / TempSpecHeat=%g / CavityMatCond[2]=%g / TempCondCT=%g", Name, CavityLayerSymVal[2], TempDensity, TempSpecHeat, CavityMatCond[2], TempCondCT )
;            else  UNCHANGED       endif endif endif    else  UNCHANGED   endif  }

	"Assign or create Cons:CavityPathMats[2]"		Cons:CavityPathMats[2]	= {
						if (IfValidAnd( FrameCavityLayerMat[1] == 2 ) .OR. IfValidAnd( FrameCavityLayerMat[2] == 2 ))
						then  if (FrameLayerSymVal[2] >= 10000 .AND. FrameLayerSymVal[2] < 40000 .AND. FrameLayerSymVal[2] != 10424 .AND. FrameLayerSymVal[2] != 20424)
								then	; need to add a UNIQUE material here, consistent w/ cavity resistance - this Mat to be altered by ConsUFactorRes() routine
										if (	IfValidAnd( CavityPathMats[2]:ConductivityQII == CavityMatCondQII[2] ) .AND. IfValidAnd( CavityPathMats[2]:Density  == TempDensity  ) .AND.
												IfValidAnd( CavityPathMats[2]:ConductivityCT  == TempCondCT          ) .AND. IfValidAnd( CavityPathMats[2]:SpecHeat == TempSpecHeat ))
										then	UNCHANGED
										else if (LocalCompAssigned( CavityPathMats[2] ) == 0)
										then	if (IfValidAnd( CavityLayerSymVal[2] = 900 ) .AND. IfValidAnd( LayerUsrInpInsRVal[2] >= 0 ))
                                    then  CreateComp( Mat, Format( "%s InsFur2-R%s", Name, FltToStr( LayerUsrInpInsRVal[2], 1, 1, 0, 1 ) ), "MarkMatForDeletion" )
                                    else  CreateComp( Mat, Format( "%s InsFur2-R%s", Name, FltToStr( CavityLayerSymVal[2],  1, 1, 0, 1 ) ), "MarkMatForDeletion" )  endif
										else if (IfValidAnd( CavityPathMats[2]:Name == InsFurMatName[2] ))
										then	CreateComp( Mat, Format( "%s InsFur2-R%s", Name, FltToStr( CavityLayerSymVal[2], 1, 1, 0, 1 ) ), "MarkMatForDeletion" )  else  UNCHANGED  endif endif endif
								else if (IfValidAnd( CavityLayerSymVal[2] == 0 )) then  UNDEFINED
								else if (IfValidAnd( CavityLayerSymVal[2] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[2] < 201 ) .AND. TempDensity > 0)
								then  AssignOrCreateComp( Mat, Format( "Ins-R%s-D%s-SH%s-C%s", FltToStr( CavityLayerSymVal[2], 1, 1, 0, 1 ),
															FltToStr( TempDensity, 1, 1, 0, 1 ), FltToStr( TempSpecHeat, 2, 1, 0, 1 ), FltToStr( CavityMatCond[2], 5, 1, 0, 1 ) ),
															"Density", TempDensity, "SpecHeat", TempSpecHeat, "Conductivity", CavityMatCond[2], "ConductivityQII", CavityMatCondQII[2], "ConductivityCT", TempCondCT, "MarkForDeletion", UNDEFINED )
								else if (IfValidAnd( CavityLayerSymVal[2] = 900 ) .AND. IfValidAnd( LayerUsrInpInsRVal[2] >= 0 ) .AND. TempDensity > 0)
								then  AssignOrCreateComp( Mat, Format( "Ins-R%s-D%s-SH%s-C%s", FltToStr( LayerUsrInpInsRVal[2], 1, 1, 0, 1 ),
															FltToStr( TempDensity, 1, 1, 0, 1 ), FltToStr( TempSpecHeat, 2, 1, 0, 1 ), FltToStr( CavityMatCond[2], 5, 1, 0, 1 ) ),
															"Density", TempDensity, "SpecHeat", TempSpecHeat, "Conductivity", CavityMatCond[2], "ConductivityQII", CavityMatCondQII[2], "ConductivityCT", TempCondCT, "MarkForDeletion", UNDEFINED )
								else  UNCHANGED  endif endif endif endif
						else  UNCHANGED  endif  }
	"Setup unique Cavity/Ins/Furring material Cons:CavityPathMats[2]"		Cons:Action	= {
						if ((IfValidAnd( FrameCavityLayerMat[1] == 2 ) .OR. IfValidAnd( FrameCavityLayerMat[2] == 2 )) .AND. IfValidAnd( FrameLayerSymVal[2] >= 10000 ) .AND.
								IfValidAnd( FrameLayerSymVal[2] < 40000 ) .AND. FrameLayerSymVal[2] != 10424 .AND. FrameLayerSymVal[2] != 20424 .AND. LocalCompAssigned( CavityPathMats[2] ))
						then	EvalRulelist( "SetupUniqueCavityInsFurMat_2", 1 )  else  UNCHANGED  endif  }
	"Store name of Mat in Framing/Cavity slot for possible future replacement: Cons:InsFurMatName[2]"		Cons:InsFurMatName[2]	= {
						if ((IfValidAnd( FrameCavityLayerMat[1] == 2 ) .OR. IfValidAnd( FrameCavityLayerMat[2] == 2 )) .AND. LocalCompAssigned( CavityPathMats[2] )) then  CavityPathMats[2]:Name  else  UNCHANGED  endif  }

; SAC 3/17/14 - to be REMOVED
; "debugging"		Cons:Action = {  if (Name != "R15 R4 Stucco Wall") then  UNCHANGED  else  StoreBEMProc( "After CavityPathMats-2 creation", 0 )  endif  }
; "debug"		Proj:Action	= {	MessageBox( "After CavityPathMats-2 creation." )  }

	"Assign or create Cons:CavityPathMats[3]"		Cons:CavityPathMats[3]	= {
						if (IfValidAnd( FrameCavityLayerMat[1] == 3 ) .OR. IfValidAnd( FrameCavityLayerMat[2] == 3 ))
						then  if (FrameLayerSymVal[3] >= 10000 .AND. FrameLayerSymVal[3] < 40000 .AND. FrameLayerSymVal[3] != 10424 .AND. FrameLayerSymVal[3] != 20424)
								then	; need to add a UNIQUE material here, consistent w/ cavity resistance - this Mat to be altered by ConsUFactorRes() routine
										if (	IfValidAnd( CavityPathMats[3]:ConductivityQII == CavityMatCondQII[3] ) .AND. IfValidAnd( CavityPathMats[3]:Density  == TempDensity  ) .AND.
												IfValidAnd( CavityPathMats[3]:ConductivityCT  == TempCondCT          ) .AND. IfValidAnd( CavityPathMats[3]:SpecHeat == TempSpecHeat ))
										then	UNCHANGED
										else if (LocalCompAssigned( CavityPathMats[3] ) == 0)
										then	if (IfValidAnd( CavityLayerSymVal[3] = 900 ) .AND. IfValidAnd( LayerUsrInpInsRVal[3] >= 0 ))
                                    then  CreateComp( Mat, Format( "%s InsFur3-R%s", Name, FltToStr( LayerUsrInpInsRVal[3], 1, 1, 0, 1 ) ), "MarkMatForDeletion" )
                                    else  CreateComp( Mat, Format( "%s InsFur3-R%s", Name, FltToStr( CavityLayerSymVal[3],  1, 1, 0, 1 ) ), "MarkMatForDeletion" )  endif
										else if (IfValidAnd( CavityPathMats[3]:Name == InsFurMatName[3] ))
										then	CreateComp( Mat, Format( "%s InsFur3-R%s", Name, FltToStr( CavityLayerSymVal[3], 1, 1, 0, 1 ) ), "MarkMatForDeletion" )  else  UNCHANGED  endif endif endif
								else if (IfValidAnd( CavityLayerSymVal[3] == 0 )) then  UNDEFINED
								else if (IfValidAnd( CavityLayerSymVal[3] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[3] < 201 ) .AND. TempDensity > 0)
								then  AssignOrCreateComp( Mat, Format( "Ins-R%s-D%s-SH%s-C%s", FltToStr( CavityLayerSymVal[3], 1, 1, 0, 1 ),
															FltToStr( TempDensity, 1, 1, 0, 1 ), FltToStr( TempSpecHeat, 2, 1, 0, 1 ), FltToStr( CavityMatCond[3], 5, 1, 0, 1 ) ),
															"Density", TempDensity, "SpecHeat", TempSpecHeat, "Conductivity", CavityMatCond[3], "ConductivityQII", CavityMatCondQII[3], "ConductivityCT", TempCondCT, "MarkForDeletion", UNDEFINED )
								else if (IfValidAnd( CavityLayerSymVal[3] = 900 ) .AND. IfValidAnd( LayerUsrInpInsRVal[3] >= 0 ) .AND. TempDensity > 0)
								then  AssignOrCreateComp( Mat, Format( "Ins-R%s-D%s-SH%s-C%s", FltToStr( LayerUsrInpInsRVal[3], 1, 1, 0, 1 ),
															FltToStr( TempDensity, 1, 1, 0, 1 ), FltToStr( TempSpecHeat, 2, 1, 0, 1 ), FltToStr( CavityMatCond[3], 5, 1, 0, 1 ) ),
															"Density", TempDensity, "SpecHeat", TempSpecHeat, "Conductivity", CavityMatCond[3], "ConductivityQII", CavityMatCondQII[3], "ConductivityCT", TempCondCT, "MarkForDeletion", UNDEFINED )
								else  UNCHANGED  endif endif endif endif
						else  UNCHANGED  endif  }
	"Setup unique Cavity/Ins/Furring material Cons:CavityPathMats[3]"		Cons:Action	= {
						if ((IfValidAnd( FrameCavityLayerMat[1] == 3 ) .OR. IfValidAnd( FrameCavityLayerMat[2] == 3 )) .AND. IfValidAnd( FrameLayerSymVal[3] >= 10000 ) .AND.
								IfValidAnd( FrameLayerSymVal[3] < 40000 ) .AND. FrameLayerSymVal[3] != 10424 .AND. FrameLayerSymVal[3] != 20424 .AND. LocalCompAssigned( CavityPathMats[3] ))
						then	EvalRulelist( "SetupUniqueCavityInsFurMat_3", 1 )  else  UNCHANGED  endif  }
	"Store name of Mat in Framing/Cavity slot for possible future replacement: Cons:InsFurMatName[3]"		Cons:InsFurMatName[3]	= {
						if ((IfValidAnd( FrameCavityLayerMat[1] == 3 ) .OR. IfValidAnd( FrameCavityLayerMat[2] == 3 )) .AND. LocalCompAssigned( CavityPathMats[3] )) then  CavityPathMats[3]:Name  else  UNCHANGED  endif  }

; SAC 3/16/14 - to be REMOVED
;"Log certain CavityPathMats selection"		Cons:Action = {  if (Name != "R15 R4 Stucco Wall") then  UNCHANGED
;			else if (LocalCompAssigned( CavityPathMats[3] )) then	PostMessageToLog( "Rule line:  7520 - Cons 'R15 R4 Stucco Wall' CavityPathMats[3] = '%s'", CavityPathMats[3]:Name )
;			else  PostMessageToLog( "Rule line:  7520 - Cons 'R15 R4 Stucco Wall' CavityPathMats[3]    UNDEFINED" )  endif endif  }

	"Assign or create Cons:CavityPathMats[4]"		Cons:CavityPathMats[4]	= {
						if (IfValidAnd( FrameCavityLayerMat[1] == 4 ) .OR. IfValidAnd( FrameCavityLayerMat[2] == 4 ))
						then  if (FrameLayerSymVal[4] >= 10000 .AND. FrameLayerSymVal[4] < 40000 .AND. FrameLayerSymVal[4] != 10424 .AND. FrameLayerSymVal[4] != 20424)
								then	; need to add a UNIQUE material here, consistent w/ cavity resistance - this Mat to be altered by ConsUFactorRes() routine
										if (	IfValidAnd( CavityPathMats[4]:ConductivityQII == CavityMatCondQII[4] ) .AND. IfValidAnd( CavityPathMats[4]:Density  == TempDensity  ) .AND.
												IfValidAnd( CavityPathMats[4]:ConductivityCT  == TempCondCT          ) .AND. IfValidAnd( CavityPathMats[4]:SpecHeat == TempSpecHeat ))
										then	UNCHANGED
										else if (LocalCompAssigned( CavityPathMats[4] ) == 0)
										then	if (IfValidAnd( CavityLayerSymVal[4] = 900 ) .AND. IfValidAnd( LayerUsrInpInsRVal[4] >= 0 ))
                                    then  CreateComp( Mat, Format( "%s InsFur4-R%s", Name, FltToStr( LayerUsrInpInsRVal[4], 1, 1, 0, 1 ) ), "MarkMatForDeletion" )
                                    else  CreateComp( Mat, Format( "%s InsFur4-R%s", Name, FltToStr( CavityLayerSymVal[4],  1, 1, 0, 1 ) ), "MarkMatForDeletion" )  endif
										else if (IfValidAnd( CavityPathMats[4]:Name == InsFurMatName[4] ))
										then	CreateComp( Mat, Format( "%s InsFur4-R%s", Name, FltToStr( CavityLayerSymVal[4], 1, 1, 0, 1 ) ), "MarkMatForDeletion" )  else  UNCHANGED  endif endif endif
								else if (IfValidAnd( CavityLayerSymVal[4] == 0 )) then  UNDEFINED
								else if (IfValidAnd( CavityLayerSymVal[4] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[4] < 201 ) .AND. TempDensity > 0)
								then  AssignOrCreateComp( Mat, Format( "Ins-R%s-D%s-SH%s-C%s", FltToStr( CavityLayerSymVal[4], 1, 1, 0, 1 ),
															FltToStr( TempDensity, 1, 1, 0, 1 ), FltToStr( TempSpecHeat, 2, 1, 0, 1 ), FltToStr( CavityMatCond[4], 5, 1, 0, 1 ) ),
															"Density", TempDensity, "SpecHeat", TempSpecHeat, "Conductivity", CavityMatCond[4], "ConductivityQII", CavityMatCondQII[4], "ConductivityCT", TempCondCT, "MarkForDeletion", UNDEFINED )
								else if (IfValidAnd( CavityLayerSymVal[4] = 900 ) .AND. IfValidAnd( LayerUsrInpInsRVal[4] >= 0 ) .AND. TempDensity > 0)
								then  AssignOrCreateComp( Mat, Format( "Ins-R%s-D%s-SH%s-C%s", FltToStr( LayerUsrInpInsRVal[4], 1, 1, 0, 1 ),
															FltToStr( TempDensity, 1, 1, 0, 1 ), FltToStr( TempSpecHeat, 2, 1, 0, 1 ), FltToStr( CavityMatCond[4], 5, 1, 0, 1 ) ),
															"Density", TempDensity, "SpecHeat", TempSpecHeat, "Conductivity", CavityMatCond[4], "ConductivityQII", CavityMatCondQII[4], "ConductivityCT", TempCondCT, "MarkForDeletion", UNDEFINED )
								else  UNCHANGED  endif endif endif endif
						else  UNCHANGED  endif  }
	"Setup unique Cavity/Ins/Furring material Cons:CavityPathMats[4]"		Cons:Action	= {
						if ((IfValidAnd( FrameCavityLayerMat[1] == 4 ) .OR. IfValidAnd( FrameCavityLayerMat[2] == 4 )) .AND. IfValidAnd( FrameLayerSymVal[4] >= 10000 ) .AND.
								IfValidAnd( FrameLayerSymVal[4] < 40000 ) .AND. FrameLayerSymVal[4] != 10424 .AND. FrameLayerSymVal[4] != 20424 .AND. LocalCompAssigned( CavityPathMats[4] ))
						then	EvalRulelist( "SetupUniqueCavityInsFurMat_4", 1 )  else  UNCHANGED  endif  }
	"Store name of Mat in Framing/Cavity slot for possible future replacement: Cons:InsFurMatName[4]"		Cons:InsFurMatName[4]	= {
						if ((IfValidAnd( FrameCavityLayerMat[1] == 4 ) .OR. IfValidAnd( FrameCavityLayerMat[2] == 4 )) .AND. LocalCompAssigned( CavityPathMats[4] )) then  CavityPathMats[4]:Name  else  UNCHANGED  endif  }

	"Assign or create Cons:CavityPathMats[5]"		Cons:CavityPathMats[5]	= {
						if (IfValidAnd( FrameCavityLayerMat[1] == 5 ) .OR. IfValidAnd( FrameCavityLayerMat[2] == 5 ))
						then  if (FrameLayerSymVal[5] >= 10000 .AND. FrameLayerSymVal[5] < 40000 .AND. FrameLayerSymVal[5] != 10424 .AND. FrameLayerSymVal[5] != 20424)
								then	; need to add a UNIQUE material here, consistent w/ cavity resistance - this Mat to be altered by ConsUFactorRes() routine
										if (	IfValidAnd( CavityPathMats[5]:ConductivityQII == CavityMatCondQII[5] ) .AND. IfValidAnd( CavityPathMats[5]:Density  == TempDensity  ) .AND.
												IfValidAnd( CavityPathMats[5]:ConductivityCT  == TempCondCT          ) .AND. IfValidAnd( CavityPathMats[5]:SpecHeat == TempSpecHeat ))
										then	UNCHANGED
										else if (LocalCompAssigned( CavityPathMats[5] ) == 0)
										then	if (IfValidAnd( CavityLayerSymVal[5] = 900 ) .AND. IfValidAnd( LayerUsrInpInsRVal[5] >= 0 ))
                                    then  CreateComp( Mat, Format( "%s InsFur5-R%s", Name, FltToStr( LayerUsrInpInsRVal[5], 1, 1, 0, 1 ) ), "MarkMatForDeletion" )
                                    else  CreateComp( Mat, Format( "%s InsFur5-R%s", Name, FltToStr( CavityLayerSymVal[5],  1, 1, 0, 1 ) ), "MarkMatForDeletion" )  endif
										else if (IfValidAnd( CavityPathMats[5]:Name == InsFurMatName[5] ))
										then	CreateComp( Mat, Format( "%s InsFur5-R%s", Name, FltToStr( CavityLayerSymVal[5], 1, 1, 0, 1 ) ), "MarkMatForDeletion" )  else  UNCHANGED  endif endif endif
								else if (IfValidAnd( CavityLayerSymVal[5] == 0 )) then  UNDEFINED
								else if (IfValidAnd( CavityLayerSymVal[5] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[5] < 201 ) .AND. TempDensity > 0)
								then  AssignOrCreateComp( Mat, Format( "Ins-R%s-D%s-SH%s-C%s", FltToStr( CavityLayerSymVal[5], 1, 1, 0, 1 ),
															FltToStr( TempDensity, 1, 1, 0, 1 ), FltToStr( TempSpecHeat, 2, 1, 0, 1 ), FltToStr( CavityMatCond[5], 5, 1, 0, 1 ) ),
															"Density", TempDensity, "SpecHeat", TempSpecHeat, "Conductivity", CavityMatCond[5], "ConductivityQII", CavityMatCondQII[5], "ConductivityCT", TempCondCT, "MarkForDeletion", UNDEFINED )
								else if (IfValidAnd( CavityLayerSymVal[5] = 900 ) .AND. IfValidAnd( LayerUsrInpInsRVal[5] >= 0 ) .AND. TempDensity > 0)
								then  AssignOrCreateComp( Mat, Format( "Ins-R%s-D%s-SH%s-C%s", FltToStr( LayerUsrInpInsRVal[5], 1, 1, 0, 1 ),
															FltToStr( TempDensity, 1, 1, 0, 1 ), FltToStr( TempSpecHeat, 2, 1, 0, 1 ), FltToStr( CavityMatCond[5], 5, 1, 0, 1 ) ),
															"Density", TempDensity, "SpecHeat", TempSpecHeat, "Conductivity", CavityMatCond[5], "ConductivityQII", CavityMatCondQII[5], "ConductivityCT", TempCondCT, "MarkForDeletion", UNDEFINED )
								else  UNCHANGED  endif endif endif endif
						else  UNCHANGED  endif  }
	"Setup unique Cavity/Ins/Furring material Cons:CavityPathMats[5]"		Cons:Action	= {
						if ((IfValidAnd( FrameCavityLayerMat[1] == 5 ) .OR. IfValidAnd( FrameCavityLayerMat[2] == 5 )) .AND. IfValidAnd( FrameLayerSymVal[5] >= 10000 ) .AND.
								IfValidAnd( FrameLayerSymVal[5] < 40000 ) .AND. FrameLayerSymVal[5] != 10424 .AND. FrameLayerSymVal[5] != 20424 .AND. LocalCompAssigned( CavityPathMats[5] ))
						then	EvalRulelist( "SetupUniqueCavityInsFurMat_5", 1 )  else  UNCHANGED  endif  }
	"Store name of Mat in Framing/Cavity slot for possible future replacement: Cons:InsFurMatName[5]"		Cons:InsFurMatName[5]	= {
						if ((IfValidAnd( FrameCavityLayerMat[1] == 5 ) .OR. IfValidAnd( FrameCavityLayerMat[2] == 5 )) .AND. LocalCompAssigned( CavityPathMats[5] )) then  CavityPathMats[5]:Name  else  UNCHANGED  endif  }

	"Assign or create Cons:CavityPathMats[6]"		Cons:CavityPathMats[6]	= {
						if (IfValidAnd( FrameCavityLayerMat[1] == 6 ) .OR. IfValidAnd( FrameCavityLayerMat[2] == 6 ))
						then  if (FrameLayerSymVal[6] >= 10000 .AND. FrameLayerSymVal[6] < 40000 .AND. FrameLayerSymVal[6] != 10424 .AND. FrameLayerSymVal[6] != 20424)
								then	; need to add a UNIQUE material here, consistent w/ cavity resistance - this Mat to be altered by ConsUFactorRes() routine
										if (	IfValidAnd( CavityPathMats[6]:ConductivityQII == CavityMatCondQII[6] ) .AND. IfValidAnd( CavityPathMats[6]:Density  == TempDensity  ) .AND.
												IfValidAnd( CavityPathMats[6]:ConductivityCT  == TempCondCT          ) .AND. IfValidAnd( CavityPathMats[6]:SpecHeat == TempSpecHeat ))
										then	UNCHANGED
										else if (LocalCompAssigned( CavityPathMats[6] ) == 0)
										then	if (IfValidAnd( CavityLayerSymVal[6] = 900 ) .AND. IfValidAnd( LayerUsrInpInsRVal[6] >= 0 ))
                                    then  CreateComp( Mat, Format( "%s InsFur6-R%s", Name, FltToStr( LayerUsrInpInsRVal[6], 1, 1, 0, 1 ) ), "MarkMatForDeletion" )
                                    else  CreateComp( Mat, Format( "%s InsFur6-R%s", Name, FltToStr( CavityLayerSymVal[6],  1, 1, 0, 1 ) ), "MarkMatForDeletion" )  endif
										else if (IfValidAnd( CavityPathMats[6]:Name == InsFurMatName[6] ))
										then	CreateComp( Mat, Format( "%s InsFur6-R%s", Name, FltToStr( CavityLayerSymVal[6], 1, 1, 0, 1 ) ), "MarkMatForDeletion" )  else  UNCHANGED  endif endif endif
								else if (IfValidAnd( CavityLayerSymVal[6] == 0 )) then  UNDEFINED
								else if (IfValidAnd( CavityLayerSymVal[6] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[6] < 201 ) .AND. TempDensity > 0)
								then  AssignOrCreateComp( Mat, Format( "Ins-R%s-D%s-SH%s-C%s", FltToStr( CavityLayerSymVal[6], 1, 1, 0, 1 ),
															FltToStr( TempDensity, 1, 1, 0, 1 ), FltToStr( TempSpecHeat, 2, 1, 0, 1 ), FltToStr( CavityMatCond[6], 5, 1, 0, 1 ) ),
															"Density", TempDensity, "SpecHeat", TempSpecHeat, "Conductivity", CavityMatCond[6], "ConductivityQII", CavityMatCondQII[6], "ConductivityCT", TempCondCT, "MarkForDeletion", UNDEFINED )
								else if (IfValidAnd( CavityLayerSymVal[6] = 900 ) .AND. IfValidAnd( LayerUsrInpInsRVal[6] >= 0 ) .AND. TempDensity > 0)
								then  AssignOrCreateComp( Mat, Format( "Ins-R%s-D%s-SH%s-C%s", FltToStr( LayerUsrInpInsRVal[6], 1, 1, 0, 1 ),
															FltToStr( TempDensity, 1, 1, 0, 1 ), FltToStr( TempSpecHeat, 2, 1, 0, 1 ), FltToStr( CavityMatCond[6], 5, 1, 0, 1 ) ),
															"Density", TempDensity, "SpecHeat", TempSpecHeat, "Conductivity", CavityMatCond[6], "ConductivityQII", CavityMatCondQII[6], "ConductivityCT", TempCondCT, "MarkForDeletion", UNDEFINED )
								else  UNCHANGED  endif endif endif endif
						else  UNCHANGED  endif  }
	"Setup unique Cavity/Ins/Furring material Cons:CavityPathMats[6]"		Cons:Action	= {
						if ((IfValidAnd( FrameCavityLayerMat[1] == 6 ) .OR. IfValidAnd( FrameCavityLayerMat[2] == 6 )) .AND. IfValidAnd( FrameLayerSymVal[6] >= 10000 ) .AND.
								IfValidAnd( FrameLayerSymVal[6] < 40000 ) .AND. FrameLayerSymVal[6] != 10424 .AND. FrameLayerSymVal[6] != 20424 .AND. LocalCompAssigned( CavityPathMats[6] ))
						then	EvalRulelist( "SetupUniqueCavityInsFurMat_6", 1 )  else  UNCHANGED  endif  }
	"Store name of Mat in Framing/Cavity slot for possible future replacement: Cons:InsFurMatName[6]"		Cons:InsFurMatName[6]	= {
						if ((IfValidAnd( FrameCavityLayerMat[1] == 6 ) .OR. IfValidAnd( FrameCavityLayerMat[2] == 6 )) .AND. LocalCompAssigned( CavityPathMats[6] )) then  CavityPathMats[6]:Name  else  UNCHANGED  endif  }

	"Assign or create Cons:CavityPathMats[7]"		Cons:CavityPathMats[7]	= {
						if (IfValidAnd( FrameCavityLayerMat[1] == 7 ) .OR. IfValidAnd( FrameCavityLayerMat[2] == 7 ))
						then  if (FrameLayerSymVal[7] >= 10000 .AND. FrameLayerSymVal[7] < 40000 .AND. FrameLayerSymVal[7] != 10424 .AND. FrameLayerSymVal[7] != 20424)
								then	; need to add a UNIQUE material here, consistent w/ cavity resistance - this Mat to be altered by ConsUFactorRes() routine
										if (	IfValidAnd( CavityPathMats[7]:ConductivityQII == CavityMatCondQII[7] ) .AND. IfValidAnd( CavityPathMats[7]:Density  == TempDensity  ) .AND.
												IfValidAnd( CavityPathMats[7]:ConductivityCT  == TempCondCT          ) .AND. IfValidAnd( CavityPathMats[7]:SpecHeat == TempSpecHeat ))
										then	UNCHANGED
										else if (LocalCompAssigned( CavityPathMats[7] ) == 0)
										then	if (IfValidAnd( CavityLayerSymVal[7] = 900 ) .AND. IfValidAnd( LayerUsrInpInsRVal[7] >= 0 ))
                                    then  CreateComp( Mat, Format( "%s InsFur7-R%s", Name, FltToStr( LayerUsrInpInsRVal[7], 1, 1, 0, 1 ) ), "MarkMatForDeletion" )
                                    else  CreateComp( Mat, Format( "%s InsFur7-R%s", Name, FltToStr( CavityLayerSymVal[7],  1, 1, 0, 1 ) ), "MarkMatForDeletion" )  endif
										else if (IfValidAnd( CavityPathMats[7]:Name == InsFurMatName[7] ))
										then	CreateComp( Mat, Format( "%s InsFur7-R%s", Name, FltToStr( CavityLayerSymVal[7], 1, 1, 0, 1 ) ), "MarkMatForDeletion" )  else  UNCHANGED  endif endif endif
								else if (IfValidAnd( CavityLayerSymVal[7] == 0 )) then  UNDEFINED
								else if (IfValidAnd( CavityLayerSymVal[7] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[7] < 201 ) .AND. TempDensity > 0)
								then  AssignOrCreateComp( Mat, Format( "Ins-R%s-D%s-SH%s-C%s", FltToStr( CavityLayerSymVal[7], 1, 1, 0, 1 ),
															FltToStr( TempDensity, 1, 1, 0, 1 ), FltToStr( TempSpecHeat, 2, 1, 0, 1 ), FltToStr( CavityMatCond[7], 5, 1, 0, 1 ) ),
															"Density", TempDensity, "SpecHeat", TempSpecHeat, "Conductivity", CavityMatCond[7], "ConductivityQII", CavityMatCondQII[7], "ConductivityCT", TempCondCT, "MarkForDeletion", UNDEFINED )
								else if (IfValidAnd( CavityLayerSymVal[7] = 900 ) .AND. IfValidAnd( LayerUsrInpInsRVal[7] >= 0 ) .AND. TempDensity > 0)
								then  AssignOrCreateComp( Mat, Format( "Ins-R%s-D%s-SH%s-C%s", FltToStr( LayerUsrInpInsRVal[7], 1, 1, 0, 1 ),
															FltToStr( TempDensity, 1, 1, 0, 1 ), FltToStr( TempSpecHeat, 2, 1, 0, 1 ), FltToStr( CavityMatCond[7], 5, 1, 0, 1 ) ),
															"Density", TempDensity, "SpecHeat", TempSpecHeat, "Conductivity", CavityMatCond[7], "ConductivityQII", CavityMatCondQII[7], "ConductivityCT", TempCondCT, "MarkForDeletion", UNDEFINED )
								else  UNCHANGED  endif endif endif endif
						else  UNCHANGED  endif  }
	"Setup unique Cavity/Ins/Furring material Cons:CavityPathMats[7]"		Cons:Action	= {
						if ((IfValidAnd( FrameCavityLayerMat[1] == 7 ) .OR. IfValidAnd( FrameCavityLayerMat[2] == 7 )) .AND. IfValidAnd( FrameLayerSymVal[7] >= 10000 ) .AND.
								IfValidAnd( FrameLayerSymVal[7] < 40000 ) .AND. FrameLayerSymVal[7] != 10424 .AND. FrameLayerSymVal[7] != 20424 .AND. LocalCompAssigned( CavityPathMats[7] ))
						then	EvalRulelist( "SetupUniqueCavityInsFurMat_7", 1 )  else  UNCHANGED  endif  }
	"Store name of Mat in Framing/Cavity slot for possible future replacement: Cons:InsFurMatName[7]"		Cons:InsFurMatName[7]	= {
						if ((IfValidAnd( FrameCavityLayerMat[1] == 7 ) .OR. IfValidAnd( FrameCavityLayerMat[2] == 7 )) .AND. LocalCompAssigned( CavityPathMats[7] )) then  CavityPathMats[7]:Name  else  UNCHANGED  endif  }

	"Assign or create Cons:CavityPathMats[8]"		Cons:CavityPathMats[8]	= {
						if (IfValidAnd( FrameCavityLayerMat[1] == 8 ) .OR. IfValidAnd( FrameCavityLayerMat[2] == 8 ))
						then  if (FrameLayerSymVal[8] >= 10000 .AND. FrameLayerSymVal[8] < 40000 .AND. FrameLayerSymVal[8] != 10424 .AND. FrameLayerSymVal[8] != 20424)
								then	; need to add a UNIQUE material here, consistent w/ cavity resistance - this Mat to be altered by ConsUFactorRes() routine
										if (	IfValidAnd( CavityPathMats[8]:ConductivityQII == CavityMatCondQII[8] ) .AND. IfValidAnd( CavityPathMats[8]:Density  == TempDensity  ) .AND.
												IfValidAnd( CavityPathMats[8]:ConductivityCT  == TempCondCT          ) .AND. IfValidAnd( CavityPathMats[8]:SpecHeat == TempSpecHeat ))
										then	UNCHANGED
										else if (LocalCompAssigned( CavityPathMats[8] ) == 0)
										then	if (IfValidAnd( CavityLayerSymVal[8] = 900 ) .AND. IfValidAnd( LayerUsrInpInsRVal[8] >= 0 ))
                                    then  CreateComp( Mat, Format( "%s InsFur8-R%s", Name, FltToStr( LayerUsrInpInsRVal[8], 1, 1, 0, 1 ) ), "MarkMatForDeletion" )
                                    else  CreateComp( Mat, Format( "%s InsFur8-R%s", Name, FltToStr( CavityLayerSymVal[8],  1, 1, 0, 1 ) ), "MarkMatForDeletion" )  endif
										else if (IfValidAnd( CavityPathMats[8]:Name == InsFurMatName[8] ))
										then	CreateComp( Mat, Format( "%s InsFur8-R%s", Name, FltToStr( CavityLayerSymVal[8], 1, 1, 0, 1 ) ), "MarkMatForDeletion" )  else  UNCHANGED  endif endif endif
								else if (IfValidAnd( CavityLayerSymVal[8] == 0 )) then  UNDEFINED
								else if (IfValidAnd( CavityLayerSymVal[8] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[8] < 201 ) .AND. TempDensity > 0)
								then  AssignOrCreateComp( Mat, Format( "Ins-R%s-D%s-SH%s-C%s", FltToStr( CavityLayerSymVal[8], 1, 1, 0, 1 ),
															FltToStr( TempDensity, 1, 1, 0, 1 ), FltToStr( TempSpecHeat, 2, 1, 0, 1 ), FltToStr( CavityMatCond[8], 5, 1, 0, 1 ) ),
															"Density", TempDensity, "SpecHeat", TempSpecHeat, "Conductivity", CavityMatCond[8], "ConductivityQII", CavityMatCondQII[8], "ConductivityCT", TempCondCT, "MarkForDeletion", UNDEFINED )
								else if (IfValidAnd( CavityLayerSymVal[8] = 900 ) .AND. IfValidAnd( LayerUsrInpInsRVal[8] >= 0 ) .AND. TempDensity > 0)
								then  AssignOrCreateComp( Mat, Format( "Ins-R%s-D%s-SH%s-C%s", FltToStr( LayerUsrInpInsRVal[8], 1, 1, 0, 1 ),
															FltToStr( TempDensity, 1, 1, 0, 1 ), FltToStr( TempSpecHeat, 2, 1, 0, 1 ), FltToStr( CavityMatCond[8], 5, 1, 0, 1 ) ),
															"Density", TempDensity, "SpecHeat", TempSpecHeat, "Conductivity", CavityMatCond[8], "ConductivityQII", CavityMatCondQII[8], "ConductivityCT", TempCondCT, "MarkForDeletion", UNDEFINED )
								else  UNCHANGED  endif endif endif endif
						else  UNCHANGED  endif  }
	"Setup unique Cavity/Ins/Furring material Cons:CavityPathMats[8]"		Cons:Action	= {
						if ((IfValidAnd( FrameCavityLayerMat[1] == 8 ) .OR. IfValidAnd( FrameCavityLayerMat[2] == 8 )) .AND. IfValidAnd( FrameLayerSymVal[8] >= 10000 ) .AND.
								IfValidAnd( FrameLayerSymVal[8] < 40000 ) .AND. FrameLayerSymVal[8] != 10424 .AND. FrameLayerSymVal[8] != 20424 .AND. LocalCompAssigned( CavityPathMats[8] ))
						then	EvalRulelist( "SetupUniqueCavityInsFurMat_8", 1 )  else  UNCHANGED  endif  }
	"Store name of Mat in Framing/Cavity slot for possible future replacement: Cons:InsFurMatName[8]"		Cons:InsFurMatName[8]	= {
						if ((IfValidAnd( FrameCavityLayerMat[1] == 8 ) .OR. IfValidAnd( FrameCavityLayerMat[2] == 8 )) .AND. LocalCompAssigned( CavityPathMats[8] )) then  CavityPathMats[8]:Name  else  UNCHANGED  endif  }

	"Assign or create Cons:CavityPathMats[9]"		Cons:CavityPathMats[9]	= {
						if (IfValidAnd( FrameCavityLayerMat[1] == 9 ) .OR. IfValidAnd( FrameCavityLayerMat[2] == 9 ))
						then  if (FrameLayerSymVal[9] >= 10000 .AND. FrameLayerSymVal[9] < 40000 .AND. FrameLayerSymVal[9] != 10424 .AND. FrameLayerSymVal[9] != 20424)
								then	; need to add a UNIQUE material here, consistent w/ cavity resistance - this Mat to be altered by ConsUFactorRes() routine
										if (	IfValidAnd( CavityPathMats[9]:ConductivityQII == CavityMatCondQII[9] ) .AND. IfValidAnd( CavityPathMats[9]:Density  == TempDensity  ) .AND.
												IfValidAnd( CavityPathMats[9]:ConductivityCT  == TempCondCT          ) .AND. IfValidAnd( CavityPathMats[9]:SpecHeat == TempSpecHeat ))
										then	UNCHANGED
										else if (LocalCompAssigned( CavityPathMats[9] ) == 0)
										then	if (IfValidAnd( CavityLayerSymVal[9] = 900 ) .AND. IfValidAnd( LayerUsrInpInsRVal[9] >= 0 ))
                                    then  CreateComp( Mat, Format( "%s InsFur9-R%s", Name, FltToStr( LayerUsrInpInsRVal[9], 1, 1, 0, 1 ) ), "MarkMatForDeletion" )
                                    else  CreateComp( Mat, Format( "%s InsFur9-R%s", Name, FltToStr( CavityLayerSymVal[9],  1, 1, 0, 1 ) ), "MarkMatForDeletion" )  endif
										else if (IfValidAnd( CavityPathMats[9]:Name == InsFurMatName[9] ))
										then	CreateComp( Mat, Format( "%s InsFur9-R%s", Name, FltToStr( CavityLayerSymVal[9], 1, 1, 0, 1 ) ), "MarkMatForDeletion" )  else  UNCHANGED  endif endif endif
								else if (IfValidAnd( CavityLayerSymVal[9] == 0 )) then  UNDEFINED
								else if (IfValidAnd( CavityLayerSymVal[9] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[9] < 201 ) .AND. TempDensity > 0)
								then  AssignOrCreateComp( Mat, Format( "Ins-R%s-D%s-SH%s-C%s", FltToStr( CavityLayerSymVal[9], 1, 1, 0, 1 ),
															FltToStr( TempDensity, 1, 1, 0, 1 ), FltToStr( TempSpecHeat, 2, 1, 0, 1 ), FltToStr( CavityMatCond[9], 5, 1, 0, 1 ) ),
															"Density", TempDensity, "SpecHeat", TempSpecHeat, "Conductivity", CavityMatCond[9], "ConductivityQII", CavityMatCondQII[9], "ConductivityCT", TempCondCT, "MarkForDeletion", UNDEFINED )
								else if (IfValidAnd( CavityLayerSymVal[9] = 900 ) .AND. IfValidAnd( LayerUsrInpInsRVal[9] >= 0 ) .AND. TempDensity > 0)
								then  AssignOrCreateComp( Mat, Format( "Ins-R%s-D%s-SH%s-C%s", FltToStr( LayerUsrInpInsRVal[9], 1, 1, 0, 1 ),
															FltToStr( TempDensity, 1, 1, 0, 1 ), FltToStr( TempSpecHeat, 2, 1, 0, 1 ), FltToStr( CavityMatCond[9], 5, 1, 0, 1 ) ),
															"Density", TempDensity, "SpecHeat", TempSpecHeat, "Conductivity", CavityMatCond[9], "ConductivityQII", CavityMatCondQII[9], "ConductivityCT", TempCondCT, "MarkForDeletion", UNDEFINED )
								else  UNCHANGED  endif endif endif endif
						else  UNCHANGED  endif  }
	"Setup unique Cavity/Ins/Furring material Cons:CavityPathMats[9]"		Cons:Action	= {
						if ((IfValidAnd( FrameCavityLayerMat[1] == 9 ) .OR. IfValidAnd( FrameCavityLayerMat[2] == 9 )) .AND. IfValidAnd( FrameLayerSymVal[9] >= 10000 ) .AND.
								IfValidAnd( FrameLayerSymVal[9] < 40000 ) .AND. FrameLayerSymVal[9] != 10424 .AND. FrameLayerSymVal[9] != 20424 .AND. LocalCompAssigned( CavityPathMats[9] ))
						then	EvalRulelist( "SetupUniqueCavityInsFurMat_9", 1 )  else  UNCHANGED  endif  }
	"Store name of Mat in Framing/Cavity slot for possible future replacement: Cons:InsFurMatName[9]"		Cons:InsFurMatName[9]	= {
						if ((IfValidAnd( FrameCavityLayerMat[1] == 9 ) .OR. IfValidAnd( FrameCavityLayerMat[2] == 9 )) .AND. LocalCompAssigned( CavityPathMats[9] )) then  CavityPathMats[9]:Name  else  UNCHANGED  endif  }


  ; Round #2 - set above joist material layer of cavity path to same material as that created above for the cavity itself
	"Create Cons:CavityPathMats[1]"		Cons:CavityPathMats[1]	= {
						if (	((IfValidAnd( AbvJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[1] == AbvJoistInsLyrMapIdx )) .OR.
								 (IfValidAnd( BlwJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[1] == BlwJoistInsLyrMapIdx ))) .AND. IfValidAnd( CavityLayerSymVal[1] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[1] < 201 ))
						then	switch (FrameCavityLayerMat[1])
									case 2 :  CavityPathMats[2]
									case 3 :  CavityPathMats[3]
									case 4 :  CavityPathMats[4]
									case 5 :  CavityPathMats[5]
									case 6 :  CavityPathMats[6]
									case 7 :  CavityPathMats[7]
									case 8 :  CavityPathMats[8]
									case 9 :  CavityPathMats[9]
									default:  UNCHANGED
								endswitch
						else  UNCHANGED  endif  }
	"Create Cons:CavityPathMats[2]"		Cons:CavityPathMats[2]	= {
						if (	((IfValidAnd( AbvJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[2] == AbvJoistInsLyrMapIdx )) .OR.
								 (IfValidAnd( BlwJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[2] == BlwJoistInsLyrMapIdx ))) .AND. IfValidAnd( CavityLayerSymVal[2] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[2] < 201 ))
						then	switch (FrameCavityLayerMat[1])
									case 1 :  CavityPathMats[1]
									case 3 :  CavityPathMats[3]
									case 4 :  CavityPathMats[4]
									case 5 :  CavityPathMats[5]
									case 6 :  CavityPathMats[6]
									case 7 :  CavityPathMats[7]
									case 8 :  CavityPathMats[8]
									case 9 :  CavityPathMats[9]
									default:  UNCHANGED
								endswitch
						else  UNCHANGED  endif  }
	"Create Cons:CavityPathMats[3]"		Cons:CavityPathMats[3]	= {
						if (	((IfValidAnd( AbvJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[3] == AbvJoistInsLyrMapIdx )) .OR.
								 (IfValidAnd( BlwJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[3] == BlwJoistInsLyrMapIdx ))) .AND. IfValidAnd( CavityLayerSymVal[3] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[3] < 201 ))
						then	switch (FrameCavityLayerMat[1])
									case 1 :  CavityPathMats[1]
									case 2 :  CavityPathMats[2]
									case 4 :  CavityPathMats[4]
									case 5 :  CavityPathMats[5]
									case 6 :  CavityPathMats[6]
									case 7 :  CavityPathMats[7]
									case 8 :  CavityPathMats[8]
									case 9 :  CavityPathMats[9]
									default:  UNCHANGED
								endswitch
						else  UNCHANGED  endif  }
; SAC 3/16/14 - to be REMOVED
;"Log certain CavityPathMats selection"		Cons:Action = {  if (Name != "R15 R4 Stucco Wall") then  UNCHANGED
;			else if (LocalCompAssigned( CavityPathMats[3] )) then	PostMessageToLog( "Rule line: 7677 - Cons 'R15 R4 Stucco Wall' CavityPathMats[3] = '%s'", CavityPathMats[3]:Name )
;			else  PostMessageToLog( "Rule line: 7677 - Cons 'R15 R4 Stucco Wall' CavityPathMats[3]    UNDEFINED" )  endif endif  }
	"Create Cons:CavityPathMats[4]"		Cons:CavityPathMats[4]	= {
						if (	((IfValidAnd( AbvJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[4] == AbvJoistInsLyrMapIdx )) .OR.
								 (IfValidAnd( BlwJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[4] == BlwJoistInsLyrMapIdx ))) .AND. IfValidAnd( CavityLayerSymVal[4] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[4] < 201 ))
						then	switch (FrameCavityLayerMat[1])
									case 1 :  CavityPathMats[1]
									case 2 :  CavityPathMats[2]
									case 3 :  CavityPathMats[3]
									case 5 :  CavityPathMats[5]
									case 6 :  CavityPathMats[6]
									case 7 :  CavityPathMats[7]
									case 8 :  CavityPathMats[8]
									case 9 :  CavityPathMats[9]
									default:  UNCHANGED
								endswitch
						else  UNCHANGED  endif  }
	"Create Cons:CavityPathMats[5]"		Cons:CavityPathMats[5]	= {
						if (	((IfValidAnd( AbvJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[5] == AbvJoistInsLyrMapIdx )) .OR.
								 (IfValidAnd( BlwJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[5] == BlwJoistInsLyrMapIdx ))) .AND. IfValidAnd( CavityLayerSymVal[5] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[5] < 201 ))
						then	switch (FrameCavityLayerMat[1])
									case 1 :  CavityPathMats[1]
									case 2 :  CavityPathMats[2]
									case 3 :  CavityPathMats[3]
									case 4 :  CavityPathMats[4]
									case 6 :  CavityPathMats[6]
									case 7 :  CavityPathMats[7]
									case 8 :  CavityPathMats[8]
									case 9 :  CavityPathMats[9]
									default:  UNCHANGED
								endswitch
						else  UNCHANGED  endif  }
	"Create Cons:CavityPathMats[6]"		Cons:CavityPathMats[6]	= {
						if (	((IfValidAnd( AbvJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[6] == AbvJoistInsLyrMapIdx )) .OR.
								 (IfValidAnd( BlwJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[6] == BlwJoistInsLyrMapIdx ))) .AND. IfValidAnd( CavityLayerSymVal[6] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[6] < 201 ))
						then	switch (FrameCavityLayerMat[1])
									case 1 :  CavityPathMats[1]
									case 2 :  CavityPathMats[2]
									case 3 :  CavityPathMats[3]
									case 4 :  CavityPathMats[4]
									case 5 :  CavityPathMats[5]
									case 7 :  CavityPathMats[7]
									case 8 :  CavityPathMats[8]
									case 9 :  CavityPathMats[9]
									default:  UNCHANGED
								endswitch
						else  UNCHANGED  endif  }
	"Create Cons:CavityPathMats[7]"		Cons:CavityPathMats[7]	= {
						if (	((IfValidAnd( AbvJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[7] == AbvJoistInsLyrMapIdx )) .OR.
								 (IfValidAnd( BlwJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[7] == BlwJoistInsLyrMapIdx ))) .AND. IfValidAnd( CavityLayerSymVal[7] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[7] < 201 ))
						then	switch (FrameCavityLayerMat[1])
									case 1 :  CavityPathMats[1]
									case 2 :  CavityPathMats[2]
									case 3 :  CavityPathMats[3]
									case 4 :  CavityPathMats[4]
									case 5 :  CavityPathMats[5]
									case 6 :  CavityPathMats[6]
									case 8 :  CavityPathMats[8]
									case 9 :  CavityPathMats[9]
									default:  UNCHANGED
								endswitch
						else  UNCHANGED  endif  }
	"Create Cons:CavityPathMats[8]"		Cons:CavityPathMats[8]	= {
						if (	((IfValidAnd( AbvJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[8] == AbvJoistInsLyrMapIdx )) .OR.
								 (IfValidAnd( BlwJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[8] == BlwJoistInsLyrMapIdx ))) .AND. IfValidAnd( CavityLayerSymVal[8] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[8] < 201 ))
						then	switch (FrameCavityLayerMat[1])
									case 1 :  CavityPathMats[1]
									case 2 :  CavityPathMats[2]
									case 3 :  CavityPathMats[3]
									case 4 :  CavityPathMats[4]
									case 5 :  CavityPathMats[5]
									case 6 :  CavityPathMats[6]
									case 7 :  CavityPathMats[7]
									case 9 :  CavityPathMats[9]
									default:  UNCHANGED
								endswitch
						else  UNCHANGED  endif  }
	"Create Cons:CavityPathMats[9]"		Cons:CavityPathMats[9]	= {
						if (	((IfValidAnd( AbvJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[9] == AbvJoistInsLyrMapIdx )) .OR.
								 (IfValidAnd( BlwJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[9] == BlwJoistInsLyrMapIdx ))) .AND. IfValidAnd( CavityLayerSymVal[9] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[9] < 201 ))
						then	switch (FrameCavityLayerMat[1])
									case 1 :  CavityPathMats[1]
									case 2 :  CavityPathMats[2]
									case 3 :  CavityPathMats[3]
									case 4 :  CavityPathMats[4]
									case 5 :  CavityPathMats[5]
									case 6 :  CavityPathMats[6]
									case 7 :  CavityPathMats[7]
									case 8 :  CavityPathMats[8]
									default:  UNCHANGED
								endswitch
						else  UNCHANGED  endif  }

  ; Round #2 - set frame layer material for insulation lying above ceiling joists to same material as cavity insulation
	"Set Cons:FramePathMats[1] (abv joist insul layer only)"		Cons:FramePathMats[1]	= {
						if (	((IfValidAnd( AbvJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[1] == AbvJoistInsLyrMapIdx )) .OR.
								 (IfValidAnd( BlwJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[1] == BlwJoistInsLyrMapIdx ))) .AND.
								IfValidAnd( CavityLayerSymVal[1] < 201 ) .AND. LocalCompAssigned( CavityPathMats[1] ))
						then  if (IfValidAnd( FrameLayerSymVal[1] = 0)) then  RuleLibrary( Mat, "FrameGap" )    ; no insulation under/over framing - SAC 3/10/17
                        else  CavityPathMats[1]  endif
                  else  UNCHANGED  endif  }
	"Set Cons:FramePathMats[2] (abv joist insul layer only)"		Cons:FramePathMats[2]	= {
						if (	((IfValidAnd( AbvJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[2] == AbvJoistInsLyrMapIdx )) .OR.
								 (IfValidAnd( BlwJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[2] == BlwJoistInsLyrMapIdx ))) .AND.
								IfValidAnd( CavityLayerSymVal[2] < 201 ) .AND. LocalCompAssigned( CavityPathMats[2] ))
						then  CavityPathMats[2]  else  UNCHANGED  endif  }
	"Set Cons:FramePathMats[3] (abv joist insul layer only)"		Cons:FramePathMats[3]	= {
						if (	((IfValidAnd( AbvJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[3] == AbvJoistInsLyrMapIdx )) .OR.
								 (IfValidAnd( BlwJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[3] == BlwJoistInsLyrMapIdx ))) .AND.
								IfValidAnd( CavityLayerSymVal[3] < 201 ) .AND. LocalCompAssigned( CavityPathMats[3] ))
						then  CavityPathMats[3]  else  UNCHANGED  endif  }
	"Set Cons:FramePathMats[4] (abv joist insul layer only)"		Cons:FramePathMats[4]	= {
						if (	((IfValidAnd( AbvJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[4] == AbvJoistInsLyrMapIdx )) .OR.
								 (IfValidAnd( BlwJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[4] == BlwJoistInsLyrMapIdx ))) .AND.
								IfValidAnd( CavityLayerSymVal[4] < 201 ) .AND. LocalCompAssigned( CavityPathMats[4] ))
						then  CavityPathMats[4]  else  UNCHANGED  endif  }
	"Set Cons:FramePathMats[5] (abv joist insul layer only)"		Cons:FramePathMats[5]	= {
						if (	((IfValidAnd( AbvJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[5] == AbvJoistInsLyrMapIdx )) .OR.
								 (IfValidAnd( BlwJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[5] == BlwJoistInsLyrMapIdx ))) .AND.
								IfValidAnd( CavityLayerSymVal[5] < 201 ) .AND. LocalCompAssigned( CavityPathMats[5] ))
						then  CavityPathMats[5]  else  UNCHANGED  endif  }
	"Set Cons:FramePathMats[6] (abv joist insul layer only)"		Cons:FramePathMats[6]	= {
						if (	((IfValidAnd( AbvJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[6] == AbvJoistInsLyrMapIdx )) .OR.
								 (IfValidAnd( BlwJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[6] == BlwJoistInsLyrMapIdx ))) .AND.
								IfValidAnd( CavityLayerSymVal[6] < 201 ) .AND. LocalCompAssigned( CavityPathMats[6] ))
						then  CavityPathMats[6]  else  UNCHANGED  endif  }
	"Set Cons:FramePathMats[7] (abv joist insul layer only)"		Cons:FramePathMats[7]	= {
						if (	((IfValidAnd( AbvJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[7] == AbvJoistInsLyrMapIdx )) .OR.
								 (IfValidAnd( BlwJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[7] == BlwJoistInsLyrMapIdx ))) .AND.
								IfValidAnd( CavityLayerSymVal[7] < 201 ) .AND. LocalCompAssigned( CavityPathMats[7] ))
						then  CavityPathMats[7]  else  UNCHANGED  endif  }
	"Set Cons:FramePathMats[8] (abv joist insul layer only)"		Cons:FramePathMats[8]	= {
						if (	((IfValidAnd( AbvJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[8] == AbvJoistInsLyrMapIdx )) .OR.
								 (IfValidAnd( BlwJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[8] == BlwJoistInsLyrMapIdx ))) .AND.
								IfValidAnd( CavityLayerSymVal[8] < 201 ) .AND. LocalCompAssigned( CavityPathMats[8] ))
						then  CavityPathMats[8]  else  UNCHANGED  endif  }
	"Set Cons:FramePathMats[9] (abv joist insul layer only)"		Cons:FramePathMats[9]	= {
						if (	((IfValidAnd( AbvJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[9] == AbvJoistInsLyrMapIdx )) .OR.
								 (IfValidAnd( BlwJoistInsLyrMapIdx > 0 ) .AND. IfValidAnd( LayerPropertyIndex[9] == BlwJoistInsLyrMapIdx ))) .AND.
								IfValidAnd( CavityLayerSymVal[9] < 201 ) .AND. LocalCompAssigned( CavityPathMats[9] ))
						then  CavityPathMats[9]  else  UNCHANGED  endif  }

; SAC 3/16/14 - to be REMOVED
;"store BEMProc details"		Cons:Action = {  if (Name != "R15 R4 Stucco Wall") then  UNCHANGED
;															else	StoreBEMProc( "Aftr CavityMat Assign-Create", 0 )  endif  }
;"debug"		Cons:Action	= {	if (Name != "R15 R4 Stucco Wall") then  UNCHANGED
;										else	MessageBox( "Post-CreateConsCavityInsulMat_All eval" )  endif  }
END

;*************************************************************************
RULELIST "SetupDefaultConsCavityInsulMatProperties"    1 0 0 0
;*************************************************************************
	"Set Cons:TempDensity"		Cons:TempDensity		= {	if (CanAssignTo == 2 .OR. CanAssignTo == 3)	; "Cathedral Ceilings" or "Ceilings (below attic)"  
																			then  Proj:LibMat_CeilingIns:Density
																			else  Proj:LibMat_OtherIns:Density  endif  }
	"Set Cons:TempSpecHeat"		Cons:TempSpecHeat		= {	if (CanAssignTo == 2 .OR. CanAssignTo == 3)	; "Cathedral Ceilings" or "Ceilings (below attic)"  
																			then  Proj:LibMat_CeilingIns:SpecHeat
																			else  Proj:LibMat_OtherIns:SpecHeat  endif  }
	"Set Cons:TempCondCT"		Cons:TempCondCT		= {	if (CanAssignTo == 2 .OR. CanAssignTo == 3)	; "Cathedral Ceilings" or "Ceilings (below attic)"  
																			then  Proj:LibMat_CeilingIns:ConductivityCT
																			else  Proj:LibMat_OtherIns:ConductivityCT  endif  }
END

;*************************************************************************
RULELIST "MarkMatForDeletion"       1 0 0 0
	"Mark Mat for deletion"		Mat:MarkForDeletion	= {	1  }
; SAC 3/17/14 - to be REMOVED
; "debugging"		Mat:Action	= {	MessageBox( "Marking Mat for deletion:  %s", Name )  }
END
;*************************************************************************
RULELIST "SetupUniqueCavityInsFurMat_1"     1 0 1 0
	"Set Cons:CavityPathMats[1]:Conductivity"			Cons:CavityPathMats[1]:Conductivity		= {	CavityMatCond[1]		}
	"Set Cons:CavityPathMats[1]:ConductivityQII"		Cons:CavityPathMats[1]:ConductivityQII	= {	CavityMatCondQII[1]	}
	"Set Cons:CavityPathMats[1]:Density"				Cons:CavityPathMats[1]:Density			= {	TempDensity				}
	"Set Cons:CavityPathMats[1]:SpecHeat"				Cons:CavityPathMats[1]:SpecHeat			= {	TempSpecHeat			}
	"Set Cons:CavityPathMats[1]:ConductivityCT"		Cons:CavityPathMats[1]:ConductivityCT	= {	TempCondCT				}
END
;*************************************************************************
RULELIST "SetupUniqueCavityInsFurMat_2"     1 0 1 0
	"Set Cons:CavityPathMats[2]:Conductivity"			Cons:CavityPathMats[2]:Conductivity		= {	CavityMatCond[2]		}
	"Set Cons:CavityPathMats[2]:ConductivityQII"		Cons:CavityPathMats[2]:ConductivityQII	= {	CavityMatCondQII[2]	}
	"Set Cons:CavityPathMats[2]:Density"				Cons:CavityPathMats[2]:Density			= {	TempDensity				}
	"Set Cons:CavityPathMats[2]:SpecHeat"				Cons:CavityPathMats[2]:SpecHeat			= {	TempSpecHeat			}
	"Set Cons:CavityPathMats[2]:ConductivityCT"		Cons:CavityPathMats[2]:ConductivityCT	= {	TempCondCT				}
END
;*************************************************************************
RULELIST "SetupUniqueCavityInsFurMat_3"     1 0 1 0
	"Set Cons:CavityPathMats[3]:Conductivity"			Cons:CavityPathMats[3]:Conductivity		= {	CavityMatCond[3]		}
	"Set Cons:CavityPathMats[3]:ConductivityQII"		Cons:CavityPathMats[3]:ConductivityQII	= {	CavityMatCondQII[3]	}
	"Set Cons:CavityPathMats[3]:Density"				Cons:CavityPathMats[3]:Density			= {	TempDensity				}
	"Set Cons:CavityPathMats[3]:SpecHeat"				Cons:CavityPathMats[3]:SpecHeat			= {	TempSpecHeat			}
	"Set Cons:CavityPathMats[3]:ConductivityCT"		Cons:CavityPathMats[3]:ConductivityCT	= {	TempCondCT				}
END
;*************************************************************************
RULELIST "SetupUniqueCavityInsFurMat_4"     1 0 1 0
	"Set Cons:CavityPathMats[4]:Conductivity"			Cons:CavityPathMats[4]:Conductivity		= {	CavityMatCond[4]		}
	"Set Cons:CavityPathMats[4]:ConductivityQII"		Cons:CavityPathMats[4]:ConductivityQII	= {	CavityMatCondQII[4]	}
	"Set Cons:CavityPathMats[4]:Density"				Cons:CavityPathMats[4]:Density			= {	TempDensity				}
	"Set Cons:CavityPathMats[4]:SpecHeat"				Cons:CavityPathMats[4]:SpecHeat			= {	TempSpecHeat			}
	"Set Cons:CavityPathMats[4]:ConductivityCT"		Cons:CavityPathMats[4]:ConductivityCT	= {	TempCondCT				}
END
;*************************************************************************
RULELIST "SetupUniqueCavityInsFurMat_5"     1 0 1 0
	"Set Cons:CavityPathMats[5]:Conductivity"			Cons:CavityPathMats[5]:Conductivity		= {	CavityMatCond[5]		}
	"Set Cons:CavityPathMats[5]:ConductivityQII"		Cons:CavityPathMats[5]:ConductivityQII	= {	CavityMatCondQII[5]	}
	"Set Cons:CavityPathMats[5]:Density"				Cons:CavityPathMats[5]:Density			= {	TempDensity				}
	"Set Cons:CavityPathMats[5]:SpecHeat"				Cons:CavityPathMats[5]:SpecHeat			= {	TempSpecHeat			}
	"Set Cons:CavityPathMats[5]:ConductivityCT"		Cons:CavityPathMats[5]:ConductivityCT	= {	TempCondCT				}
END
;*************************************************************************
RULELIST "SetupUniqueCavityInsFurMat_6"     1 0 1 0
	"Set Cons:CavityPathMats[6]:Conductivity"			Cons:CavityPathMats[6]:Conductivity		= {	CavityMatCond[6]		}
	"Set Cons:CavityPathMats[6]:ConductivityQII"		Cons:CavityPathMats[6]:ConductivityQII	= {	CavityMatCondQII[6]	}
	"Set Cons:CavityPathMats[6]:Density"				Cons:CavityPathMats[6]:Density			= {	TempDensity				}
	"Set Cons:CavityPathMats[6]:SpecHeat"				Cons:CavityPathMats[6]:SpecHeat			= {	TempSpecHeat			}
	"Set Cons:CavityPathMats[6]:ConductivityCT"		Cons:CavityPathMats[6]:ConductivityCT	= {	TempCondCT				}
END
;*************************************************************************
RULELIST "SetupUniqueCavityInsFurMat_7"     1 0 1 0
	"Set Cons:CavityPathMats[7]:Conductivity"			Cons:CavityPathMats[7]:Conductivity		= {	CavityMatCond[7]		}
	"Set Cons:CavityPathMats[7]:ConductivityQII"		Cons:CavityPathMats[7]:ConductivityQII	= {	CavityMatCondQII[7]	}
	"Set Cons:CavityPathMats[7]:Density"				Cons:CavityPathMats[7]:Density			= {	TempDensity				}
	"Set Cons:CavityPathMats[7]:SpecHeat"				Cons:CavityPathMats[7]:SpecHeat			= {	TempSpecHeat			}
	"Set Cons:CavityPathMats[7]:ConductivityCT"		Cons:CavityPathMats[7]:ConductivityCT	= {	TempCondCT				}
END
;*************************************************************************
RULELIST "SetupUniqueCavityInsFurMat_8"     1 0 1 0
	"Set Cons:CavityPathMats[8]:Conductivity"			Cons:CavityPathMats[8]:Conductivity		= {	CavityMatCond[8]		}
	"Set Cons:CavityPathMats[8]:ConductivityQII"		Cons:CavityPathMats[8]:ConductivityQII	= {	CavityMatCondQII[8]	}
	"Set Cons:CavityPathMats[8]:Density"				Cons:CavityPathMats[8]:Density			= {	TempDensity				}
	"Set Cons:CavityPathMats[8]:SpecHeat"				Cons:CavityPathMats[8]:SpecHeat			= {	TempSpecHeat			}
	"Set Cons:CavityPathMats[8]:ConductivityCT"		Cons:CavityPathMats[8]:ConductivityCT	= {	TempCondCT				}
END
;*************************************************************************
RULELIST "SetupUniqueCavityInsFurMat_9"     1 0 1 0
	"Set Cons:CavityPathMats[9]:Conductivity"			Cons:CavityPathMats[9]:Conductivity		= {	CavityMatCond[9]		}
	"Set Cons:CavityPathMats[9]:ConductivityQII"		Cons:CavityPathMats[9]:ConductivityQII	= {	CavityMatCondQII[9]	}
	"Set Cons:CavityPathMats[9]:Density"				Cons:CavityPathMats[9]:Density			= {	TempDensity				}
	"Set Cons:CavityPathMats[9]:SpecHeat"				Cons:CavityPathMats[9]:SpecHeat			= {	TempSpecHeat			}
	"Set Cons:CavityPathMats[9]:ConductivityCT"		Cons:CavityPathMats[9]:ConductivityCT	= {	TempCondCT				}
END
;*************************************************************************
RULELIST "SetupUniqueCavityInsFurMat_10"    1 0 1 0
	"Set Cons:CavityPathMats[10]:Conductivity"		Cons:CavityPathMats[10]:Conductivity	 ={	CavityMatCond[10]		}
	"Set Cons:CavityPathMats[10]:ConductivityQII"	Cons:CavityPathMats[10]:ConductivityQII ={	CavityMatCondQII[10]	}
	"Set Cons:CavityPathMats[10]:Density"				Cons:CavityPathMats[10]:Density			= {	TempDensity				}
	"Set Cons:CavityPathMats[10]:SpecHeat"				Cons:CavityPathMats[10]:SpecHeat			= {	TempSpecHeat			}
	"Set Cons:CavityPathMats[10]:ConductivityCT"		Cons:CavityPathMats[10]:ConductivityCT	= {	TempCondCT				}
END
;*************************************************************************


;*************************************************************************
;*************************************************************************
;   SURFACE CONSTRUCTION RULELISTS
;*************************************************************************
;*************************************************************************

;*************************************************************************
RULELIST "SetupCons_ExtWall_TwoPath"         0 0 0 1
;*************************************************************************
; INSIDE to OUTSIDE

	"Set Cons:FrameCavityLayerMat[1]"	Cons:FrameCavityLayerMat[1] = {	     if (Local( FrameLayer ) < 0.1) then  0     ; NO frame/cavity layer
																								else if (Local( InsideFinishLayer ) > 0.1 .AND. Local( SheathInsul2Layer ) > 0.1 .AND.
                                                                               (SheathInsul2Layer != 99000 .OR. IfValidAnd( SheathInsul2LayerRVal > 0 ))) then  3
																								else if (Local( InsideFinishLayer ) > 0.1 .OR. (Local( SheathInsul2Layer ) > 0.1 .AND.
                                                                               (SheathInsul2Layer != 99000 .OR. IfValidAnd( SheathInsul2LayerRVal > 0 )))) then  2
																								else  1  endif endif endif  }
	"Set Cons:FrameCavityLayerMat[2]"	Cons:FrameCavityLayerMat[2]	= {	0  }

	"Set Cons:NumLayerMats-1"		Cons:NumLayerMats = {	if (Local( InsideFinishLayer  ) > 0.1) then  1  else  0  endif  }
	"Set Cons:NumLayerMats-2"		Cons:NumLayerMats = {	if ((SheathInsul2Layer != 99000 .OR. IfValidAnd( SheathInsul2LayerRVal > 0 )) .AND.
                                                             Local( SheathInsul2Layer  ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-3"		Cons:NumLayerMats = {	if (Local( FrameLayer         ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-4"		Cons:NumLayerMats = {	if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                             Local( SheathInsulLayer   ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-5"		Cons:NumLayerMats = {	if (Local( WallExtFinishLayer ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }

; SAC 6/4/14 - added properties to be reported on CF1R
   "Set Cons:NumLayersRpt"		Cons:NumLayersRpt	= {	NumLayerMats  }
   "Set Cons:FramingRpt"		Cons:FramingRpt	= {	if (IfValidAnd( FrameLayer > 0 )) then  EnumString( FrameLayer )  else  " "  endif  }
   "Set Cons:CavityRRpt"		Cons:CavityRRpt	= {	if (IfValidAnd( CavityLayer > 0 ) .AND. IfValidAnd( CavityLayer < 100001 )) then  EnumString( CavityLayer )  else  "none"  endif  }

	; Mapping of this Index to Cons Properties:	1 =>	InsideFinishLayer 
	;															2 =>	SheathInsul2Layer 
	;															3 =>	FrameLayer  //  CavityLayer
	;															4 =>	SheathInsulLayer  
	;															5 =>	WallExtFinishLayer
	"Set Cons:FrameLayerMapIdx[1]"		Cons:FrameLayerMapIdx[1]   = {	3  }	; index of Frame/Cavity layer in mapping listed above
	"Set Cons:FrameLayerMapIdx[2]"		Cons:FrameLayerMapIdx[2]   = {	0  }
	"Set Cons:AbvJoistInsLyrMapIdx"		Cons:AbvJoistInsLyrMapIdx  = {	0  }	; index of insulation above ceiling joists layer in mapping listed above
	"Set Cons:BlwJoistInsLyrMapIdx"		Cons:BlwJoistInsLyrMapIdx  = {	0  }	; index of insulation below roof joists layer in mapping listed above
	"Set Cons:LayerPropertyIndex[1]"		Cons:LayerPropertyIndex[1] = {		  if (Local( InsideFinishLayer  ) > 0.1) then  1
																								else if ((SheathInsul2Layer != 99000 .OR. IfValidAnd( SheathInsul2LayerRVal > 0 )) .AND.
                                                                                 SheathInsul2Layer > 0.1) then  2
	                                                                     else if (Local( FrameLayer         ) > 0.1) then  3
	                                                                     else if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                 SheathInsulLayer > 0.1) then  4
	                                                                     else if (Local( WallExtFinishLayer ) > 0.1) then  5  else  0  endif endif endif endif endif  }
	"Set Cons:LayerPropertyIndex[2]"		Cons:LayerPropertyIndex[2] = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :		  if ((SheathInsul2Layer != 99000 .OR. IfValidAnd( SheathInsul2LayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsul2Layer  ) > 0.1) then  2
	                                                                     					else if (Local( FrameLayer         ) > 0.1) then  3
	                                                                     					else if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer   ) > 0.1) then  4
	                                                                     					else if (Local( WallExtFinishLayer ) > 0.1) then  5  else  0  endif endif endif endif
																									case  2 :		  if (Local( FrameLayer         ) > 0.1) then  3
	                                                                     					else if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer   ) > 0.1) then  4
	                                                                     					else if (Local( WallExtFinishLayer ) > 0.1) then  5  else  0  endif endif endif
																									case  3 :		  if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer   ) > 0.1) then  4
	                                                                     					else if (Local( WallExtFinishLayer ) > 0.1) then  5  else  0  endif endif
																									case  4 :		  if (Local( WallExtFinishLayer ) > 0.1) then  5  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[3]"		Cons:LayerPropertyIndex[3] = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :		  if (Local( FrameLayer         ) > 0.1) then  3
	                                                                     					else if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer   ) > 0.1) then  4
	                                                                     					else if (Local( WallExtFinishLayer ) > 0.1) then  5  else  0  endif endif endif
																									case  3 :		  if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer   ) > 0.1) then  4
	                                                                     					else if (Local( WallExtFinishLayer ) > 0.1) then  5  else  0  endif endif
																									case  4 :		  if (Local( WallExtFinishLayer ) > 0.1) then  5  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[4]"		Cons:LayerPropertyIndex[4] = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :		  if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer   ) > 0.1) then  4
	                                                                     					else if (Local( WallExtFinishLayer ) > 0.1) then  5  else  0  endif endif
																									case  4 :		  if (Local( WallExtFinishLayer ) > 0.1) then  5  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[5]"		Cons:LayerPropertyIndex[5] = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :		  if (Local( WallExtFinishLayer ) > 0.1) then  5  else  0  endif
																									default :   0
																								endswitch  }

	"Set Cons:FrameLayerSymVal[1]"		Cons:FrameLayerSymVal[1]   = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	Local( InsideFinishLayer  )
																									case  2 :	Local( SheathInsul2Layer  )
																									case  3 :	Local( FrameLayer         )
																									case  4 :	Local( SheathInsulLayer   )
																									case  5 :	Local( WallExtFinishLayer )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[2]"		Cons:FrameLayerSymVal[2]   = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	Local( SheathInsul2Layer  )
																									case  3 :	Local( FrameLayer         )
																									case  4 :	Local( SheathInsulLayer   )
																									case  5 :	Local( WallExtFinishLayer )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[3]"		Cons:FrameLayerSymVal[3]   = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	Local( FrameLayer         )
																									case  4 :	Local( SheathInsulLayer   )
																									case  5 :	Local( WallExtFinishLayer )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[4]"		Cons:FrameLayerSymVal[4]   = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	Local( SheathInsulLayer   )
																									case  5 :	Local( WallExtFinishLayer )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[5]"		Cons:FrameLayerSymVal[5]   = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :	Local( WallExtFinishLayer )
																									default : 0
																								endswitch  }
   ; SAC 5/15/17 - added compressed R-value selections - R-val = (SymVal-mod(SymVal,10))/100  (tic #761)
	"Set Cons:CavityLayerSymVal[1]"		Cons:CavityLayerSymVal[1]  = {	
         if (Local( LayerPropertyIndex[1] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[1] )  endif  }
	"Set Cons:CavityLayerSymVal[2]"		Cons:CavityLayerSymVal[2]  = {	
         if (Local( LayerPropertyIndex[2] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[2] )  endif  }
	"Set Cons:CavityLayerSymVal[3]"		Cons:CavityLayerSymVal[3]  = {	
         if (Local( LayerPropertyIndex[3] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[3] )  endif  }
	"Set Cons:CavityLayerSymVal[4]"		Cons:CavityLayerSymVal[4]  = {	
         if (Local( LayerPropertyIndex[4] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[4] )  endif  }
	"Set Cons:CavityLayerSymVal[5]"		Cons:CavityLayerSymVal[5]  = {	
         if (Local( LayerPropertyIndex[5] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[5] )  endif  }

   ; SAC 4/11/17 - related to user-defined sheating/insulation r-value
   "Set Cons:LayerUsrInpInsRVal[1]"    Cons:LayerUsrInpInsRVal[1]  = {
         if (LayerPropertyIndex[1] == 2 .AND. SheathInsul2Layer == 99000)
         then  SheathInsul2LayerRVal
         else if (LayerPropertyIndex[1] == 4 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal
         else  UNDEFINED  endif endif  }
   "Set Cons:LayerUsrInpInsRVal[2]"    Cons:LayerUsrInpInsRVal[2]  = {
         if (LayerPropertyIndex[2] == 2 .AND. SheathInsul2Layer == 99000)
         then  SheathInsul2LayerRVal
         else if (LayerPropertyIndex[2] == 4 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal
         else  UNDEFINED  endif endif  }
   "Set Cons:LayerUsrInpInsRVal[3]"    Cons:LayerUsrInpInsRVal[3]  = {
         if (LayerPropertyIndex[3] == 4 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal
         else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[4]"    Cons:LayerUsrInpInsRVal[4]  = {
         if (LayerPropertyIndex[4] == 4 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal
         else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[5]"    Cons:LayerUsrInpInsRVal[5]  = {
         if (LayerPropertyIndex[5] == 4 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal
         else  UNDEFINED  endif  }
   "Init Cons:LayerUsrInpInsRVal[6]"   Cons:LayerUsrInpInsRVal[6]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[9]"   Cons:LayerUsrInpInsRVal[9]  = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[7]"   Cons:LayerUsrInpInsRVal[7]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[10]"  Cons:LayerUsrInpInsRVal[10] = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[8]"   Cons:LayerUsrInpInsRVal[8]  = {  UNDEFINED  }

; SAC 6/4/14 - added properties to be reported on CF1R
      ; SAC 7/18/19 - fixed LayerLabels[] indices for case 2 in following rules (4->2) (tic #879) 
      ; SAC 10/21/19 - hyphenated R-values (R## -> R-##) (tic #1121)
	"Set Cons:AssemblyLayersRpt[1]"		Cons:AssemblyLayersRpt[1]   = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	Format( "%s %s",      LayerLabels[1], EnumString( InsideFinishLayer  ))
																									case  2 :	if (SheathInsul2Layer == 99000 .AND. IfValidAnd( SheathInsul2LayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[2], FltToStr( SheathInsul2LayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[2], EnumString( SheathInsul2LayerRpt  ))  endif
																									case  3 :	Format( "%s %s / %s", LayerLabels[3], EnumString( CavityLayerAbr     ), EnumString( FrameLayerAbr ))
																									case  4 :	if (SheathInsulLayer == 99000 .AND. IfValidAnd( SheathInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[4], FltToStr( SheathInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[4], EnumString( SheathInsulLayerRpt   ))  endif
																									case  5 :	Format( "%s %s",      LayerLabels[5], EnumString( WallExtFinishLayer ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[2]"		Cons:AssemblyLayersRpt[2]   = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	if (SheathInsul2Layer == 99000 .AND. IfValidAnd( SheathInsul2LayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[2], FltToStr( SheathInsul2LayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[2], EnumString( SheathInsul2LayerRpt  ))  endif
																									case  3 :	Format( "%s %s / %s", LayerLabels[3], EnumString( CavityLayerAbr     ), EnumString( FrameLayerAbr ))
																									case  4 :	if (SheathInsulLayer == 99000 .AND. IfValidAnd( SheathInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[4], FltToStr( SheathInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[4], EnumString( SheathInsulLayerRpt   ))  endif
																									case  5 :	Format( "%s %s",      LayerLabels[5], EnumString( WallExtFinishLayer ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[3]"		Cons:AssemblyLayersRpt[3]   = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	Format( "%s %s / %s", LayerLabels[3], EnumString( CavityLayerAbr     ), EnumString( FrameLayerAbr ))
																									case  4 :	if (SheathInsulLayer == 99000 .AND. IfValidAnd( SheathInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[4], FltToStr( SheathInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[4], EnumString( SheathInsulLayerRpt   ))  endif
																									case  5 :	Format( "%s %s",      LayerLabels[5], EnumString( WallExtFinishLayer ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[4]"		Cons:AssemblyLayersRpt[4]   = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	if (SheathInsulLayer == 99000 .AND. IfValidAnd( SheathInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[4], FltToStr( SheathInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s", LayerLabels[4], EnumString( SheathInsulLayerRpt   ))  endif
																									case  5 :	Format( "%s %s", LayerLabels[5], EnumString( WallExtFinishLayer ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[5]"		Cons:AssemblyLayersRpt[5]   = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :	Format( "%s %s", LayerLabels[5], EnumString( WallExtFinishLayer ))
																									default : UNDEFINED
																								endswitch  }
	"Blast Cons:AssemblyLayersRpt[6]"	Cons:AssemblyLayersRpt[6]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[7]"	Cons:AssemblyLayersRpt[7]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[8]"	Cons:AssemblyLayersRpt[8]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[9]"	Cons:AssemblyLayersRpt[9]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[10]"	Cons:AssemblyLayersRpt[10]  = {	UNDEFINED  }

	"Set Cons:FrameSpacing"	; SAC 2/14/12 - moved from ExtWall to facilitate wall splitting
		Cons:FrameSpacing		= {	if (Local( Type ) == 0 .OR. Local( Type ) == 1)		; "Wood Framed Wall" or "Steel Framed Wall"
											then	if (Local( FrameLayer ) > 0)
													then  mod( Local( FrameLayer ), 100 )
													else  16		; no frame layer specified, so use generic default (??)
													endif
											else	0				; NOT wood or steel framed, so no frame spacing used/valid (??)
											endif  }
		;Cons:FrameSpacing		= {	if (Local( CanAssignTo ) == 0 .OR. Local( CanAssignTo ) == 10 .OR. Local( CanAssignTo ) == 20)		; Ext, Int & UNderground Walls
		;									then	if (Local( Type ) == 0)					; "Wood Framed Wall"
		;											then	if (Local( FrameSpacing ) == 16)
		;													then  0.25    ; Wood - 16" OC
		;													else if (Local( FrameSpacing ) == 24)
		;													then  0.22    ; Wood - 24" OC
		;													else if (Local( FrameSpacing ) == 48)
		;													then  0.04    ; Wood - 48" OC						- from 2008 Joint App 4 - 4.1.6
		;													else  -1								; INVALID FRAME SPACING
		;													endif endif endif
		;											else if (Local( Type ) == 1)			; "Steel Framed Wall"
		;											then	if (Local( FrameSpacing ) == 16)
		;													then  0.15    ; Steel - 16" OC					- from 2008 Joint App 4 - 4.1.6
		;													else if (Local( FrameSpacing ) == 24)
		;													then  0.12    ; Steel - 24" OC					- from 2008 Joint App 4 - 4.1.6
		;													else  -1								; INVALID FRAME SPACING
		;													endif endif
		;											else  0  endif endif
		;									else if (Local( CanAssignTo ) == 1 .OR. Local( CanAssignTo ) == 2 .OR.
		;												Local( CanAssignTo ) == 3 .OR. Local( CanAssignTo ) == 6)			; All Roofs & Ceilings (exterior & interior)
		;									then	if (Local( Type ) == 10 .OR. Local( Type ) == 11)		; "Wood Framed Ceiling" -or- "Built-up Roof"
		;											then	if (Local( FrameSpacing ) == 16)
		;													then  0.10    ; Wood - 16" OC						- from 2008 Joint App 4 - 4.1.6
		;													else if (Local( FrameSpacing ) == 24)
		;													then  0.07    ; Wood - 24" OC						- from 2008 Joint App 4 - 4.1.6
		;													else if (Local( FrameSpacing ) == 48)
		;													then  0.04    ; Wood - 48" OC						- from 2008 Joint App 4 - 4.1.6
		;													else  -1								; INVALID FRAME SPACING
		;													endif endif endif
		;											else  0  endif
		;									else if (Local( CanAssignTo ) == 4 .OR. Local( CanAssignTo ) == 5 .OR.
		;												Local( CanAssignTo ) == 7 .OR. Local( CanAssignTo ) == 8)			; All types of Floors
		;									then	if (Local( Type ) == 20)						; "Wood Framed Floor"
		;											then	if (Local( FrameSpacing ) == 16)
		;													then  0.10    ; Wood - 16" OC						- from 2008 Joint App 4 - 4.1.6
		;													else if (Local( FrameSpacing ) == 24)
		;													then  0.07    ; Wood - 24" OC						- from 2008 Joint App 4 - 4.1.6
		;													else  -1								; INVALID FRAME SPACING
		;													endif endif
		;											else  0  endif
		;									else  -1												; UNRECOGNIZED CanAssignTo
		;									endif endif endif  }

	"Set Cons:FramingFactor => fraction of gross surface area that includes frame" 
		Cons:FramingFactor	= {	if (Local( Type ) == 0)					; "Wood Framed Wall"
											then	if (Local( FrameSpacing ) == 16)
													then  0.25    ; Wood - 16" OC
													else if (Local( FrameSpacing ) == 24)
													then  0.22    ; Wood - 24" OC
													else if (Local( FrameSpacing ) == 25)
													then  0.17    ; Wood - AWF (advanced wall framing)  - SAC 3/13/14 - based on data from Bruce
													else if (Local( FrameSpacing ) == 48)
													then  0.04    ; Wood - 48" OC						- from 2008 Joint App 4 - 4.1.6
													else  -1								; INVALID FRAME SPACING
													endif endif endif endif
											else if (Local( Type ) == 1)			; "Steel Framed Wall"
											then	if (Local( FrameSpacing ) == 16)
													then  0.15    ; Steel - 16" OC					- from 2008 Joint App 4 - 4.1.6
													else if (Local( FrameSpacing ) == 24)
													then  0.12    ; Steel - 24" OC					- from 2008 Joint App 4 - 4.1.6
													else  -1								; INVALID FRAME SPACING
													endif endif
											else  0  endif endif  }
	"Set Cons:PathFraction[1]"			Cons:PathFraction[1]	= {	if (IfValidAnd( FramingFactor >= 0 )) then  1 - FramingFactor  else  0  endif  }		; SAC 3/17/14
	"Set Cons:PathFraction[2]"			Cons:PathFraction[2]	= {	if (IfValidAnd( FramingFactor >= 0 )) then      FramingFactor  else  0  endif  }


; ; Setup Cavity/Frame Mat object references (typically through rule library imports)
;			; Mapping of CavityLayerSymVal[*] to Cons Properties:	1 =>	InsideFinishLayer 
;			;																		2 =>	SheathInsul2Layer 
;			;																		3 =>	FrameLayer  //  CavityLayer
;			;																		4 =>	SheathInsulLayer  
;			;																		5 =>	WallExtFinishLayer
;	"Set Cons:CavityPathMats[1]"		Cons:CavityPathMats[1]	= {
;				switch (Local( CavityLayerSymVal[1] ))
;					; InsideFinishLayer / SheathInsul2Layer
;						case 100101 :	RuleLibrary( Mat, "Gypsum Board" )		; "Gypsum Board"
;					; SheathInsul2Layer / SheathInsulLayer / WallExtFinishLayer
;						case 100102 :	RuleLibrary( Mat, "Wood layer" )			; "Wood Siding/sheathing/decking"
;						case  99001 :	RuleLibrary( Mat, "R1 Sheathing" )		; "R1 Sheathing"
;						case  99002 :	RuleLibrary( Mat, "R2 Sheathing" )		; "R2 Sheathing"
;						case  99003 :	RuleLibrary( Mat, "R3 Sheathing" )		; "R3 Sheathing"
;						case  99004 :	RuleLibrary( Mat, "R4 Sheathing" )		; "R4 Sheathing"
;						case  99005 :	RuleLibrary( Mat, "R5 Sheathing" )		; "R5 Sheathing"
;						case  99006 :	RuleLibrary( Mat, "R6 Sheathing" )		; "R6 Sheathing"
;						case  99007 :	RuleLibrary( Mat, "R7 Sheathing" )		; "R7 Sheathing"
;						case  99008 :	RuleLibrary( Mat, "R8 Sheathing" )		; "R8 Sheathing"
;					; WallExtFinishLayer
;						case 100104 :	RuleLibrary( Mat, "3 Coat Stucco" )		; "3 Coat Stucco"
;						case 100103 :	RuleLibrary( Mat, "R4 Synth Stucco" )	; "R4 Synthetic Stucco"
;					; CavityLayer (no library mat - assign via sim prep rulelist)
;						default     :	if (Local( CavityLayerSymVal[1] ) > 0 && Local( CavityLayerSymVal[1] ) < 61)
;											then	UNDEFINED
;											else  UNDEFINED		; No layer defined - should never be the case for layer #1
;											endif  endswitch  }
;	"Set Cons:CavityPathMats[2]"		Cons:CavityPathMats[2]	= {
;				switch (Local( CavityLayerSymVal[2] ))
;					; InsideFinishLayer / SheathInsul2Layer
;						case 100101 :	RuleLibrary( Mat, "Gypsum Board" )		; "Gypsum Board"
;					; SheathInsul2Layer / SheathInsulLayer / WallExtFinishLayer
;						case 100102 :	RuleLibrary( Mat, "Wood layer" )			; "Wood Siding/sheathing/decking"
;						case  99001 :	RuleLibrary( Mat, "R1 Sheathing" )		; "R1 Sheathing"
;						case  99002 :	RuleLibrary( Mat, "R2 Sheathing" )		; "R2 Sheathing"
;						case  99003 :	RuleLibrary( Mat, "R3 Sheathing" )		; "R3 Sheathing"
;						case  99004 :	RuleLibrary( Mat, "R4 Sheathing" )		; "R4 Sheathing"
;						case  99005 :	RuleLibrary( Mat, "R5 Sheathing" )		; "R5 Sheathing"
;						case  99006 :	RuleLibrary( Mat, "R6 Sheathing" )		; "R6 Sheathing"
;						case  99007 :	RuleLibrary( Mat, "R7 Sheathing" )		; "R7 Sheathing"
;						case  99008 :	RuleLibrary( Mat, "R8 Sheathing" )		; "R8 Sheathing"
;					; WallExtFinishLayer
;						case 100104 :	RuleLibrary( Mat, "3 Coat Stucco" )		; "3 Coat Stucco"
;						case 100103 :	RuleLibrary( Mat, "R4 Synth Stucco" )	; "R4 Synthetic Stucco"
;					; CavityLayer (no library mat - assign via sim prep rulelist)
;						default     :	if (Local( CavityLayerSymVal[2] ) > 0 && Local( CavityLayerSymVal[2] ) < 61)
;											then	UNDEFINED
;											else  UNDEFINED		; No layer defined - should never be the case for layer #1
;											endif  endswitch  }
;	"Set Cons:CavityPathMats[3]"		Cons:CavityPathMats[3]	= {
;				switch (Local( CavityLayerSymVal[3] ))
;					; InsideFinishLayer / SheathInsul2Layer
;						case 100101 :	RuleLibrary( Mat, "Gypsum Board" )		; "Gypsum Board"
;					; SheathInsul2Layer / SheathInsulLayer / WallExtFinishLayer
;						case 100102 :	RuleLibrary( Mat, "Wood layer" )			; "Wood Siding/sheathing/decking"
;						case  99001 :	RuleLibrary( Mat, "R1 Sheathing" )		; "R1 Sheathing"
;						case  99002 :	RuleLibrary( Mat, "R2 Sheathing" )		; "R2 Sheathing"
;						case  99003 :	RuleLibrary( Mat, "R3 Sheathing" )		; "R3 Sheathing"
;						case  99004 :	RuleLibrary( Mat, "R4 Sheathing" )		; "R4 Sheathing"
;						case  99005 :	RuleLibrary( Mat, "R5 Sheathing" )		; "R5 Sheathing"
;						case  99006 :	RuleLibrary( Mat, "R6 Sheathing" )		; "R6 Sheathing"
;						case  99007 :	RuleLibrary( Mat, "R7 Sheathing" )		; "R7 Sheathing"
;						case  99008 :	RuleLibrary( Mat, "R8 Sheathing" )		; "R8 Sheathing"
;					; WallExtFinishLayer
;						case 100104 :	RuleLibrary( Mat, "3 Coat Stucco" )		; "3 Coat Stucco"
;						case 100103 :	RuleLibrary( Mat, "R4 Synth Stucco" )	; "R4 Synthetic Stucco"
;					; CavityLayer (no library mat - assign via sim prep rulelist)
;						default     :	if (Local( CavityLayerSymVal[3] ) > 0 && Local( CavityLayerSymVal[3] ) < 61)
;											then	UNDEFINED
;											else  UNDEFINED		; No layer defined - should never be the case for layer #1
;											endif  endswitch  }
;	"Set Cons:CavityPathMats[4]"		Cons:CavityPathMats[4]	= {
;				switch (Local( CavityLayerSymVal[4] ))
;					; InsideFinishLayer / SheathInsul2Layer
;						case 100101 :	RuleLibrary( Mat, "Gypsum Board" )		; "Gypsum Board"
;					; SheathInsul2Layer / SheathInsulLayer / WallExtFinishLayer
;						case 100102 :	RuleLibrary( Mat, "Wood layer" )			; "Wood Siding/sheathing/decking"
;						case  99001 :	RuleLibrary( Mat, "R1 Sheathing" )		; "R1 Sheathing"
;						case  99002 :	RuleLibrary( Mat, "R2 Sheathing" )		; "R2 Sheathing"
;						case  99003 :	RuleLibrary( Mat, "R3 Sheathing" )		; "R3 Sheathing"
;						case  99004 :	RuleLibrary( Mat, "R4 Sheathing" )		; "R4 Sheathing"
;						case  99005 :	RuleLibrary( Mat, "R5 Sheathing" )		; "R5 Sheathing"
;						case  99006 :	RuleLibrary( Mat, "R6 Sheathing" )		; "R6 Sheathing"
;						case  99007 :	RuleLibrary( Mat, "R7 Sheathing" )		; "R7 Sheathing"
;						case  99008 :	RuleLibrary( Mat, "R8 Sheathing" )		; "R8 Sheathing"
;					; WallExtFinishLayer
;						case 100104 :	RuleLibrary( Mat, "3 Coat Stucco" )		; "3 Coat Stucco"
;						case 100103 :	RuleLibrary( Mat, "R4 Synth Stucco" )	; "R4 Synthetic Stucco"
;					; CavityLayer (no library mat - assign via sim prep rulelist)
;						default     :	if (Local( CavityLayerSymVal[4] ) > 0 && Local( CavityLayerSymVal[4] ) < 61)
;											then	UNDEFINED
;											else  UNDEFINED		; No layer defined - should never be the case for layer #1
;											endif  endswitch  }
;	"Set Cons:CavityPathMats[5]"		Cons:CavityPathMats[5]	= {
;				switch (Local( CavityLayerSymVal[5] ))
;					; InsideFinishLayer / SheathInsul2Layer
;						case 100101 :	RuleLibrary( Mat, "Gypsum Board" )		; "Gypsum Board"
;					; SheathInsul2Layer / SheathInsulLayer / WallExtFinishLayer
;						case 100102 :	RuleLibrary( Mat, "Wood layer" )			; "Wood Siding/sheathing/decking"
;						case  99001 :	RuleLibrary( Mat, "R1 Sheathing" )		; "R1 Sheathing"
;						case  99002 :	RuleLibrary( Mat, "R2 Sheathing" )		; "R2 Sheathing"
;						case  99003 :	RuleLibrary( Mat, "R3 Sheathing" )		; "R3 Sheathing"
;						case  99004 :	RuleLibrary( Mat, "R4 Sheathing" )		; "R4 Sheathing"
;						case  99005 :	RuleLibrary( Mat, "R5 Sheathing" )		; "R5 Sheathing"
;						case  99006 :	RuleLibrary( Mat, "R6 Sheathing" )		; "R6 Sheathing"
;						case  99007 :	RuleLibrary( Mat, "R7 Sheathing" )		; "R7 Sheathing"
;						case  99008 :	RuleLibrary( Mat, "R8 Sheathing" )		; "R8 Sheathing"
;					; WallExtFinishLayer
;						case 100104 :	RuleLibrary( Mat, "3 Coat Stucco" )		; "3 Coat Stucco"
;						case 100103 :	RuleLibrary( Mat, "R4 Synth Stucco" )	; "R4 Synthetic Stucco"
;					; CavityLayer (no library mat - assign via sim prep rulelist)
;						default     :	if (Local( CavityLayerSymVal[5] ) > 0 && Local( CavityLayerSymVal[5] ) < 61)
;											then	UNDEFINED
;											else  UNDEFINED		; No layer defined - should never be the case for layer #1
;											endif  endswitch  }
;	"Set Cons:CavityPathMats[6]"		Cons:CavityPathMats[6]	= {
;				switch (Local( CavityLayerSymVal[6] ))
;					; InsideFinishLayer / SheathInsul2Layer
;						case 100101 :	RuleLibrary( Mat, "Gypsum Board" )		; "Gypsum Board"
;					; SheathInsul2Layer / SheathInsulLayer / WallExtFinishLayer
;						case 100102 :	RuleLibrary( Mat, "Wood layer" )			; "Wood Siding/sheathing/decking"
;						case  99001 :	RuleLibrary( Mat, "R1 Sheathing" )		; "R1 Sheathing"
;						case  99002 :	RuleLibrary( Mat, "R2 Sheathing" )		; "R2 Sheathing"
;						case  99003 :	RuleLibrary( Mat, "R3 Sheathing" )		; "R3 Sheathing"
;						case  99004 :	RuleLibrary( Mat, "R4 Sheathing" )		; "R4 Sheathing"
;						case  99005 :	RuleLibrary( Mat, "R5 Sheathing" )		; "R5 Sheathing"
;						case  99006 :	RuleLibrary( Mat, "R6 Sheathing" )		; "R6 Sheathing"
;						case  99007 :	RuleLibrary( Mat, "R7 Sheathing" )		; "R7 Sheathing"
;						case  99008 :	RuleLibrary( Mat, "R8 Sheathing" )		; "R8 Sheathing"
;					; WallExtFinishLayer
;						case 100104 :	RuleLibrary( Mat, "3 Coat Stucco" )		; "3 Coat Stucco"
;						case 100103 :	RuleLibrary( Mat, "R4 Synth Stucco" )	; "R4 Synthetic Stucco"
;					; CavityLayer (no library mat - assign via sim prep rulelist)
;						default     :	if (Local( CavityLayerSymVal[6] ) > 0 && Local( CavityLayerSymVal[6] ) < 61)
;											then	UNDEFINED
;											else  UNDEFINED		; No layer defined - should never be the case for layer #1
;											endif  endswitch  }


; SAC 2/27/14 - now initialized in prior rulelist
;	"Init Cons:FrameCodeRValue"		Cons:FrameCodeRValue  = {	0.17 + 0.68  }   ; inside and outside film coeff. consistent w/ both ASHRAE fundamentals & ACM JA4




;									case  0 :	if (Type == 0 .OR. Type == 1 .OR. Type == 5)		; Exterior Walls
;													then  EvalRulelist( "SetupCons_ExtWall_TwoPath"	  , 1 )		; Wood, Steel framed or SIPS




	"Remaining construction, R-val & U-val calcs"	Cons:Action = {	EvalRulelist( "SetupCons_GenericFramed", 1 )  }
; mjb 1/12/15 - use new T24RClimateZoneCodeBase table to lookup code levels
	"Set Cons:CodeMaximumUValue"		Cons:CodeMaximumUValue	= {	if (Global( Proj:ClimateZone ) < 0.5) then  -1
;																						else  ClimateZoneTable( Global( Proj:ClimateZone ), 6 ) + 0.00049  endif  }  ; SAC 2/13/13 - added 0.00049 to allow for check taking into account rounding
																						else  T24RClimateZoneCodeBase:WallUval( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) + 0.00049  endif  }  ; SAC 2/13/13 - added 0.00049 to allow for check taking into account rounding

;	"Set Cons:CodeUValueLabel"			Cons:CodeUValueLabel		= {	if (Local( CodeMaximumUValue ) < 0) then  " "    ; no message - nothing to report
;																						else if (Local( CodeMaximumUValue ) < Local( OverallCodeUValue ))
;																						then  Format( "(doesn't meet max code %.3f U-value (%.3f))", Local( CodeMaximumUValue ), Local( OverallCodeUValue ) )
;																						else  Format( "(meets max code %.3f U-value (%.3f))", Local( CodeMaximumUValue ), Local( OverallCodeUValue ) )
;																						endif endif  }
END

;*************************************************************************
RULELIST "SetupCons_ExtWall_TwoPathSIPS"         0 0 0 1
;*************************************************************************
; INSIDE to OUTSIDE

	"Set Cons:FrameCavityLayerMat[1]"	Cons:FrameCavityLayerMat[1] = {	     if (Local( FrameLayer ) < 0.1) then  0     ; NO frame/cavity layer
																								else if (Local( InsideFinishLayer ) > 0.1 .AND. Local( SheathInsul2Layer ) > 0.1 .AND.
                                                                               (SheathInsul2Layer != 99000 .OR. IfValidAnd( SheathInsul2LayerRVal > 0 ))) then  4
																								else if (Local( InsideFinishLayer ) > 0.1 .OR. (Local( SheathInsul2Layer ) > 0.1 .AND.
                                                                               (SheathInsul2Layer != 99000 .OR. IfValidAnd( SheathInsul2LayerRVal > 0 )))) then  3
																								else  2  endif endif endif  }
	"Set Cons:FrameCavityLayerMat[2]"	Cons:FrameCavityLayerMat[2]	= {	0  }

	"Set Cons:NumLayerMats-1"		Cons:NumLayerMats = {	if (Local( InsideFinishLayer  ) > 0.1) then  3  else  2  endif  }
	"Set Cons:NumLayerMats-2"		Cons:NumLayerMats = {	if ((SheathInsul2Layer != 99000 .OR. IfValidAnd( SheathInsul2LayerRVal > 0 )) .AND.
                                                             Local( SheathInsul2Layer  ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-3"		Cons:NumLayerMats = {	if (Local( FrameLayer         ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-4"		Cons:NumLayerMats = {	if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                             Local( SheathInsulLayer   ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-5"		Cons:NumLayerMats = {	if (Local( WallExtFinishLayer ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }

; SAC 6/4/14 - added properties to be reported on CF1R
   "Set Cons:NumLayersRpt"		Cons:NumLayersRpt	= {	NumLayerMats-2  }
   "Set Cons:FramingRpt"		Cons:FramingRpt	= {	if (IfValidAnd( FrameLayer > 0 )) then  EnumString( FrameLayer )  else  " "  endif  }
   "Set Cons:CavityRRpt"		Cons:CavityRRpt	= {	if (IfValidAnd( CavityLayer > 0 ) .AND. IfValidAnd( CavityLayer < 100001 )) then  EnumString( CavityLayer )  else  "none"  endif  }

	; Mapping of this Index to Cons Properties:	1 =>	InsideFinishLayer 
	;															2 =>	SheathInsul2Layer 
	;														  *3 =>	SIPSskin                      98018
	;															4 =>	FrameLayer  //  CavityLayer
	;														  *5 =>	SIPSskin								98018
	;															6 =>	SheathInsulLayer  
	;															7 =>	WallExtFinishLayer
	"Set Cons:FrameLayerMapIdx[1]"		Cons:FrameLayerMapIdx[1]   = {	4  }	; index of Frame/Cavity layer in mapping listed above
	"Set Cons:FrameLayerMapIdx[2]"		Cons:FrameLayerMapIdx[2]   = {	0  }
	"Set Cons:AbvJoistInsLyrMapIdx"		Cons:AbvJoistInsLyrMapIdx  = {	0  }	; index of insulation above ceiling joists layer in mapping listed above
	"Set Cons:BlwJoistInsLyrMapIdx"		Cons:BlwJoistInsLyrMapIdx  = {	0  }	; index of insulation below roof joists layer in mapping listed above

; SAC 6/4/14 - FIRST round of rules to set LayerPropertyIndex[*] exclusively to setup AssemblyLayersRpt[*]
	"Set Cons:LayerPropertyIndex[1]"		Cons:LayerPropertyIndex[1] = {		  if (Local( InsideFinishLayer  ) > 0.1) then  1
																								else if ((SheathInsul2Layer != 99000 .OR. IfValidAnd( SheathInsul2LayerRVal > 0.01 )) .AND.
                                                                                 Local( SheathInsul2Layer  ) > 0.1) then  2
	                                                                     else if (Local( FrameLayer         ) > 0.1) then  3
	                                                                     else if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0.01 )) .AND.
                                                                                 Local( SheathInsulLayer   ) > 0.1) then  4
	                                                                     else if (Local( WallExtFinishLayer ) > 0.1) then  5  else  0  endif endif endif endif endif  }
	"Set Cons:LayerPropertyIndex[2]"		Cons:LayerPropertyIndex[2] = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :		  if ((SheathInsul2Layer != 99000 .OR. IfValidAnd( SheathInsul2LayerRVal > 0.01 )) .AND.
                                                                                                Local( SheathInsul2Layer  ) > 0.1) then  2
	                                                                     					else if (Local( FrameLayer         ) > 0.1) then  3
	                                                                     					else if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0.01 )) .AND.
                                                                                                Local( SheathInsulLayer   ) > 0.1) then  4
	                                                                     					else if (Local( WallExtFinishLayer ) > 0.1) then  5  else  0  endif endif endif endif
																									case  2 :		  if (Local( FrameLayer         ) > 0.1) then  3
	                                                                     					else if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0.01 )) .AND.
                                                                                                Local( SheathInsulLayer   ) > 0.1) then  4
	                                                                     					else if (Local( WallExtFinishLayer ) > 0.1) then  5  else  0  endif endif endif
																									case  3 :		  if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0.01 )) .AND.
                                                                                                Local( SheathInsulLayer   ) > 0.1) then  4
	                                                                     					else if (Local( WallExtFinishLayer ) > 0.1) then  5  else  0  endif endif
																									case  4 :		  if (Local( WallExtFinishLayer ) > 0.1) then  5  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[3]"		Cons:LayerPropertyIndex[3] = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :		  if (Local( FrameLayer         ) > 0.1) then  3
	                                                                     					else if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0.01 )) .AND.
                                                                                                Local( SheathInsulLayer   ) > 0.1) then  4
	                                                                     					else if (Local( WallExtFinishLayer ) > 0.1) then  5  else  0  endif endif endif
																									case  3 :		  if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0.01 )) .AND.
                                                                                                Local( SheathInsulLayer   ) > 0.1) then  4
	                                                                     					else if (Local( WallExtFinishLayer ) > 0.1) then  5  else  0  endif endif
																									case  4 :		  if (Local( WallExtFinishLayer ) > 0.1) then  5  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[4]"		Cons:LayerPropertyIndex[4] = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :		  if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0.01 )) .AND.
                                                                                                Local( SheathInsulLayer   ) > 0.1) then  4
	                                                                     					else if (Local( WallExtFinishLayer ) > 0.1) then  5  else  0  endif endif
																									case  4 :		  if (Local( WallExtFinishLayer ) > 0.1) then  5  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[5]"		Cons:LayerPropertyIndex[5] = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :		  if (Local( WallExtFinishLayer ) > 0.1) then  5  else  0  endif
																									default :   0
																								endswitch  }
; SAC 6/4/14 - added properties to be reported on CF1R
      ; SAC 7/18/19 - fixed LayerLabels[] indices for case 2 in following rules (4->2) (tic #879) 
      ; SAC 10/21/19 - hyphenated R-values (R## -> R-##) (tic #1121)
	"Set Cons:AssemblyLayersRpt[1]"		Cons:AssemblyLayersRpt[1]   = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	Format( "%s %s",      LayerLabels[1], EnumString( InsideFinishLayer  ))
																									case  2 :	if (SheathInsul2Layer == 99000 .AND. IfValidAnd( SheathInsul2LayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[2], FltToStr( SheathInsul2LayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[2], EnumString( SheathInsul2LayerRpt  ))  endif
																									case  3 :	Format( "%s %s",      LayerLabels[3], EnumString(   98018            ))
																									case  4 :	Format( "%s %s / %s", LayerLabels[4], EnumString( FrameLayer         ), EnumString( FrameLayerAbr ))
																									case  5 :	Format( "%s %s",      LayerLabels[5], EnumString(   98018            ))
																									case  6 :	if (SheathInsulLayer == 99000 .AND. IfValidAnd( SheathInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[4], FltToStr( SheathInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[6], EnumString( SheathInsulLayerRpt   ))  endif
																									case  7 :	Format( "%s %s",      LayerLabels[7], EnumString( WallExtFinishLayer ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[2]"		Cons:AssemblyLayersRpt[2]   = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	if (SheathInsul2Layer == 99000 .AND. IfValidAnd( SheathInsul2LayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[2], FltToStr( SheathInsul2LayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[2], EnumString( SheathInsul2LayerRpt  ))  endif
																									case  3 :	Format( "%s %s / %s", LayerLabels[3], EnumString( CavityLayerAbr     ), EnumString( FrameLayerAbr ))
																									case  4 :	if (SheathInsulLayer == 99000 .AND. IfValidAnd( SheathInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[4], FltToStr( SheathInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[4], EnumString( SheathInsulLayerRpt   ))  endif
																									case  5 :	Format( "%s %s",      LayerLabels[5], EnumString( WallExtFinishLayer ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[3]"		Cons:AssemblyLayersRpt[3]   = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	Format( "%s %s / %s", LayerLabels[3], EnumString( CavityLayerAbr     ), EnumString( FrameLayerAbr ))
																									case  4 :	if (SheathInsulLayer == 99000 .AND. IfValidAnd( SheathInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[4], FltToStr( SheathInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[4], EnumString( SheathInsulLayerRpt   ))  endif
																									case  5 :	Format( "%s %s",      LayerLabels[5], EnumString( WallExtFinishLayer ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[4]"		Cons:AssemblyLayersRpt[4]   = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	if (SheathInsulLayer == 99000 .AND. IfValidAnd( SheathInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[4], FltToStr( SheathInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s", LayerLabels[4], EnumString( SheathInsulLayerRpt   ))  endif
																									case  5 :	Format( "%s %s", LayerLabels[5], EnumString( WallExtFinishLayer ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[5]"		Cons:AssemblyLayersRpt[5]   = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :	Format( "%s %s", LayerLabels[5], EnumString( WallExtFinishLayer ))
																									default : UNDEFINED
																								endswitch  }
	"Blast Cons:AssemblyLayersRpt[6]"	Cons:AssemblyLayersRpt[6]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[7]"	Cons:AssemblyLayersRpt[7]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[8]"	Cons:AssemblyLayersRpt[8]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[9]"	Cons:AssemblyLayersRpt[9]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[10]"	Cons:AssemblyLayersRpt[10]  = {	UNDEFINED  }

  ; SAC 6/4/14 - REDO LayerPropertyIndex[*] to include SIPSskin layers
  ; SAC 11/3/17 - fixes to secondary LayerPropertyIndex[*] to account for user specified insul layers of R-val = 0
	"Set Cons:LayerPropertyIndex[1]"		Cons:LayerPropertyIndex[1] = {		  if (Local( InsideFinishLayer  ) > 0.1) then  1
																								else if ((SheathInsul2Layer != 99000 .OR. IfValidAnd( SheathInsul2LayerRVal > 0.01 )) .AND.
                                                                                 Local( SheathInsul2Layer  ) > 0.1) then  2  else  3  endif endif  }
	"Set Cons:LayerPropertyIndex[2]"		Cons:LayerPropertyIndex[2] = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	if ((SheathInsul2Layer != 99000 .OR. IfValidAnd( SheathInsul2LayerRVal > 0.01 )) .AND.
                                                                                           Local( SheathInsul2Layer  ) > 0.1) then  2  else  3  endif
																									case  2 :	3
																									case  3 :	4
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[3]"		Cons:LayerPropertyIndex[3] = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	3
																									case  3 :	4
																									case  4 :	5
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[4]"		Cons:LayerPropertyIndex[4] = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	4
																									case  4 :	5
																									case  5 :		  if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0.01 )) .AND.
                                                                                                Local( SheathInsulLayer   ) > 0.1) then  6
	                                                                     					else if (Local( WallExtFinishLayer ) > 0.1) then  7  else  0  endif endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[5]"		Cons:LayerPropertyIndex[5] = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	5
																									case  5 :		  if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0.01 )) .AND.
                                                                                                Local( SheathInsulLayer   ) > 0.1) then  6
	                                                                     					else if (Local( WallExtFinishLayer ) > 0.1) then  7  else  0  endif endif
																									case  6 :		  if (Local( WallExtFinishLayer ) > 0.1) then  7  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[6]"		Cons:LayerPropertyIndex[6] = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :		  if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0.01 )) .AND.
                                                                                                Local( SheathInsulLayer   ) > 0.1) then  6
	                                                                     					else if (Local( WallExtFinishLayer ) > 0.1) then  7  else  0  endif endif
																									case  6 :		  if (Local( WallExtFinishLayer ) > 0.1) then  7  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[7]"		Cons:LayerPropertyIndex[7] = {	switch (Local( LayerPropertyIndex[6] ))
																									case  6 :		  if (Local( WallExtFinishLayer ) > 0.1) then  7  else  0  endif
																									default :   0
																								endswitch  }

	"Set Cons:FrameLayerSymVal[1]"		Cons:FrameLayerSymVal[1]   = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	Local( InsideFinishLayer  )
																									case  2 :	Local( SheathInsul2Layer  )
																									case  3 :				98018						; SIPSskin
																									case  4 :	Local( FrameLayer         )
																									case  5 :				98018						; SIPSskin
																									case  6 :	Local( SheathInsulLayer   )
																									case  7 :	Local( WallExtFinishLayer )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[2]"		Cons:FrameLayerSymVal[2]   = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	Local( SheathInsul2Layer  )
																									case  3 :				98018						; SIPSskin
																									case  4 :	Local( FrameLayer         )
																									case  5 :				98018						; SIPSskin
																									case  6 :	Local( SheathInsulLayer   )
																									case  7 :	Local( WallExtFinishLayer )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[3]"		Cons:FrameLayerSymVal[3]   = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :				98018						; SIPSskin
																									case  4 :	Local( FrameLayer         )
																									case  5 :				98018						; SIPSskin
																									case  6 :	Local( SheathInsulLayer   )
																									case  7 :	Local( WallExtFinishLayer )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[4]"		Cons:FrameLayerSymVal[4]   = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	Local( FrameLayer         )
																									case  5 :				98018						; SIPSskin
																									case  6 :	Local( SheathInsulLayer   )
																									case  7 :	Local( WallExtFinishLayer )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[5]"		Cons:FrameLayerSymVal[5]   = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :				98018						; SIPSskin
																									case  6 :	Local( SheathInsulLayer   )
																									case  7 :	Local( WallExtFinishLayer )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[6]"		Cons:FrameLayerSymVal[6]   = {	switch (Local( LayerPropertyIndex[6] ))
																									case  6 :	Local( SheathInsulLayer   )
																									case  7 :	Local( WallExtFinishLayer )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[7]"		Cons:FrameLayerSymVal[7]   = {	switch (Local( LayerPropertyIndex[7] ))
																									case  7 :	Local( WallExtFinishLayer )
																									default : 0
																								endswitch  }

; SAC 3/15/14 - special logic added here to SUBTRACT the R-value of 2 layers of SIPSskin from the Cavity R-value selected by the user
   ; SAC 5/15/17 - added compressed R-value selections - R-val = (SymVal-mod(SymVal,10))/100  (tic #761)
	"Set Cons:CavityLayerSymVal[1]"		Cons:CavityLayerSymVal[1]  = {	Local( FrameLayerSymVal[1] )  }
	"Set Cons:CavityLayerSymVal[2]"		Cons:CavityLayerSymVal[2]  = {	if (Local( LayerPropertyIndex[2] ) == Local( FrameLayerMapIdx[1] ))
																								then	if (IfValidAnd( Proj:LibMat_SIPSskin:Thickness > 0 ) .AND. IfValidAnd( Proj:LibMat_SIPSskin:RValPerInch > 0 ))
																										then	CavityLayerRVal - (2 * Proj:LibMat_SIPSskin:Thickness * Proj:LibMat_SIPSskin:RValPerInch)
																										else  CavityLayerRVal  endif
																								else  Local( FrameLayerSymVal[2] )  endif  }
	"Set Cons:CavityLayerSymVal[3]"		Cons:CavityLayerSymVal[3]  = {	if (Local( LayerPropertyIndex[3] ) == Local( FrameLayerMapIdx[1] ))
																								then	if (IfValidAnd( Proj:LibMat_SIPSskin:Thickness > 0 ) .AND. IfValidAnd( Proj:LibMat_SIPSskin:RValPerInch > 0 ))
																										then	CavityLayerRVal - (2 * Proj:LibMat_SIPSskin:Thickness * Proj:LibMat_SIPSskin:RValPerInch)
																										else  CavityLayerRVal  endif
																								else  Local( FrameLayerSymVal[3] )  endif  }
	"Set Cons:CavityLayerSymVal[4]"		Cons:CavityLayerSymVal[4]  = {	if (Local( LayerPropertyIndex[4] ) == Local( FrameLayerMapIdx[1] ))
																								then	if (IfValidAnd( Proj:LibMat_SIPSskin:Thickness > 0 ) .AND. IfValidAnd( Proj:LibMat_SIPSskin:RValPerInch > 0 ))
																										then	CavityLayerRVal - (2 * Proj:LibMat_SIPSskin:Thickness * Proj:LibMat_SIPSskin:RValPerInch)
																										else  CavityLayerRVal  endif
																								else  Local( FrameLayerSymVal[4] )  endif  }
	"Set Cons:CavityLayerSymVal[5]"		Cons:CavityLayerSymVal[5]  = {	Local( FrameLayerSymVal[5] )  }
	"Set Cons:CavityLayerSymVal[6]"		Cons:CavityLayerSymVal[6]  = {	Local( FrameLayerSymVal[6] )  }
	"Set Cons:CavityLayerSymVal[7]"		Cons:CavityLayerSymVal[7]  = {	Local( FrameLayerSymVal[7] )  }

   ; SAC 4/11/17 - related to user-defined sheating/insulation r-value
   "Set Cons:LayerUsrInpInsRVal[1]"    Cons:LayerUsrInpInsRVal[1]  = {
         if (LayerPropertyIndex[1] == 2 .AND. SheathInsul2Layer == 99000)
         then  SheathInsul2LayerRVal
         else if (LayerPropertyIndex[1] == 6 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal
         else  UNDEFINED  endif endif  }
   "Set Cons:LayerUsrInpInsRVal[2]"    Cons:LayerUsrInpInsRVal[2]  = {
         if (LayerPropertyIndex[2] == 2 .AND. SheathInsul2Layer == 99000)
         then  SheathInsul2LayerRVal
         else if (LayerPropertyIndex[2] == 6 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal
         else  UNDEFINED  endif endif  }
   "Set Cons:LayerUsrInpInsRVal[3]"    Cons:LayerUsrInpInsRVal[3]  = {
         if (LayerPropertyIndex[3] == 6 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal
         else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[4]"    Cons:LayerUsrInpInsRVal[4]  = {
         if (LayerPropertyIndex[4] == 6 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal
         else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[5]"    Cons:LayerUsrInpInsRVal[5]  = {
         if (LayerPropertyIndex[5] == 6 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal
         else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[6]"    Cons:LayerUsrInpInsRVal[6]  = {
         if (LayerPropertyIndex[6] == 6 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal
         else  UNDEFINED  endif  }
   "Init Cons:LayerUsrInpInsRVal[7]"   Cons:LayerUsrInpInsRVal[7]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[9]"   Cons:LayerUsrInpInsRVal[9]  = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[8]"   Cons:LayerUsrInpInsRVal[8]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[10]"  Cons:LayerUsrInpInsRVal[10] = {  UNDEFINED  }

	; need to RE-calc CavityThickness & CavityMatCond for cavity/frame layer to take into account revised R-value and thickness
 ;	"RE-Set Cons:CavityThickness"			Cons:CavityThickness			= {	if (	IfValidAnd( FrameLayer >= 70000 ) .AND. IfValidAnd( FrameLayer < 99999 ) .AND.
 ;																										IfValidAnd( Proj:LibMat_SIPSskin:Thickness > 0 ) )
 ;																								then	(mod( FrameLayer, 10000 ) / 100) - (2 * Proj:LibMat_SIPSskin:Thickness)
 ;																								else	UNCHANGED  endif  }
 ; SAC 3/19/14 - revise cavity thickness rule to use conventional lumber dimensions for SIPS cavities
	"RE-Set Cons:CavityThickness"			Cons:CavityThickness			= {	if (	IfValidAnd( FrameLayer >= 70000 ) .AND. IfValidAnd( FrameLayer < 99999 ) )
																								then	switch (mod( FrameLayer, 10000 ))
																											case  450 :	 3.5 
																											case  650 :	 5.5 
																											case  825 :	 7.25
																											case 1025 :	 9.25
																											case 1225 :	11.25
																											default   :	 0		; ERROR !!
																										endswitch
																								else	UNCHANGED  endif  }

; SAC 3/18/14 - revised rules to REMOVED dependence on Proj:ICQEnclCavInsMult for SIPS cavity insulation (assumed to be styrofoam(-like))
; SAC 6/21/17 - reversed 3/14 mods that eliminated QII effect on SIPS walls (tic #750)
   ; SAC 7/20/17 - added logic to prevent application of QII for constructions assigned to surfaces that are NOT children of New Zones (tic #775)
   ; SAC 5/18/18 - revised logic slightly to accommodate wall exception input (tic #798)
	"Set Cons:CavityMatCondQII[1]"		Cons:CavityMatCondQII[1]	= {	0  }
	"Set Cons:CavityMatCondQII[2]"		Cons:CavityMatCondQII[2]	= {
         if (	IfValidAnd( Proj:ICQEnclCavInsMult > 0 ) .AND.
               IfValidAnd( LayerPropertyIndex[2] == FrameLayerMapIdx[1] ) .AND. IfValidAnd( CavityThickness > 0 ) .AND.
               IfValidAnd( CavityLayerSymVal[2] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[2] < 200 ) )
         then  if (IfValidAnd( SurfacesQIIDegraded > 0 )==0)
               then  (CavityThickness / 12) / (CavityLayerSymVal[2] * Proj:ICQEnclCavInsMult)
               else  (CavityThickness / 12) / (CavityLayerSymVal[2] * Proj:StdICQEnclCavInsMult)
               endif
         else  0  endif  }
	"Set Cons:CavityMatCondQII[3]"		Cons:CavityMatCondQII[3]	= {
         if (	IfValidAnd( Proj:ICQEnclCavInsMult > 0 ) .AND.
               IfValidAnd( LayerPropertyIndex[3] == FrameLayerMapIdx[1] ) .AND. IfValidAnd( CavityThickness > 0 ) .AND.
               IfValidAnd( CavityLayerSymVal[3] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[3] < 200 ) )
         then  if (IfValidAnd( SurfacesQIIDegraded > 0 )==0)
               then  (CavityThickness / 12) / (CavityLayerSymVal[3] * Proj:ICQEnclCavInsMult)
               else  (CavityThickness / 12) / (CavityLayerSymVal[3] * Proj:StdICQEnclCavInsMult)
               endif
         else  0  endif  }
	"Set Cons:CavityMatCondQII[4]"		Cons:CavityMatCondQII[4]	= {
         if (	IfValidAnd( Proj:ICQEnclCavInsMult > 0 ) .AND.
               IfValidAnd( LayerPropertyIndex[4] == FrameLayerMapIdx[1] ) .AND. IfValidAnd( CavityThickness > 0 ) .AND.
               IfValidAnd( CavityLayerSymVal[4] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[4] < 200 ) )
         then  if (IfValidAnd( SurfacesQIIDegraded > 0 )==0)
               then  (CavityThickness / 12) / (CavityLayerSymVal[4] * Proj:ICQEnclCavInsMult)
               else  (CavityThickness / 12) / (CavityLayerSymVal[4] * Proj:StdICQEnclCavInsMult)
               endif
         else  0  endif  }
	"Set Cons:CavityMatCondQII[5]"		Cons:CavityMatCondQII[5]	= {	0  }
	"Set Cons:CavityMatCondQII[6]"		Cons:CavityMatCondQII[6]	= {	0  }
	"Set Cons:CavityMatCondQII[7]"		Cons:CavityMatCondQII[7]	= {	0  }
	"Set Cons:CavityMatCondQII[8]"		Cons:CavityMatCondQII[8]	= {	0  }
   ; SAC 3/21/18 - switched from simply copying CavityMatCondQII[*] to setting these based on above formula but excluding ICQ multiplier (tic #999)
   ;                 (needed to ensure U-val displayed in UI and reported on CF1R is unchanged between QII & non-QII runs but still retaining sim differences)
	"Set Cons:CavityMatCond[1]"			Cons:CavityMatCond[1]		= {	0  }
	"Set Cons:CavityMatCond[2]"			Cons:CavityMatCond[2]		= {
         if (	IfValidAnd( Proj:ICQEnclCavInsMult > 0 ) .AND.
               IfValidAnd( LayerPropertyIndex[2] == FrameLayerMapIdx[1] ) .AND. IfValidAnd( CavityThickness > 0 ) .AND.
               IfValidAnd( CavityLayerSymVal[2] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[2] < 200 ) )
         then  (CavityThickness / 12) / CavityLayerSymVal[2]
         else  0  endif  }
	"Set Cons:CavityMatCond[3]"			Cons:CavityMatCond[3]		= {
         if (	IfValidAnd( Proj:ICQEnclCavInsMult > 0 ) .AND.
               IfValidAnd( LayerPropertyIndex[3] == FrameLayerMapIdx[1] ) .AND. IfValidAnd( CavityThickness > 0 ) .AND.
               IfValidAnd( CavityLayerSymVal[3] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[3] < 200 ) )
         then  (CavityThickness / 12) / CavityLayerSymVal[3]
         else  0  endif  }
	"Set Cons:CavityMatCond[4]"			Cons:CavityMatCond[4]		= {
         if (	IfValidAnd( Proj:ICQEnclCavInsMult > 0 ) .AND.
               IfValidAnd( LayerPropertyIndex[4] == FrameLayerMapIdx[1] ) .AND. IfValidAnd( CavityThickness > 0 ) .AND.
               IfValidAnd( CavityLayerSymVal[4] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[4] < 200 ) )
         then  (CavityThickness / 12) / CavityLayerSymVal[4]
         else  0  endif  }
	"Set Cons:CavityMatCond[5]"			Cons:CavityMatCond[5]		= {	0  }
	"Set Cons:CavityMatCond[6]"			Cons:CavityMatCond[6]		= {	0  }
	"Set Cons:CavityMatCond[7]"			Cons:CavityMatCond[7]		= {	0  }
	"Set Cons:CavityMatCond[8]"			Cons:CavityMatCond[8]		= {	0  }

	"Set Cons:FrameSpacing"			Cons:FrameSpacing		= {	48  }		; 4' just a estimate/placeholder

	"Set Cons:FramingFactor => fraction of gross surface area that includes frame" 
		Cons:FramingFactor	= {	if (FrameLayer < 90000)
											then  0.07		; OSB Spline
											else	0.13		; Not OSB Spline
											endif  }
	"Set Cons:PathFraction[1]"			Cons:PathFraction[1]	= {	if (IfValidAnd( FramingFactor >= 0 )) then  1 - FramingFactor  else  0  endif  }		; SAC 3/17/14
	"Set Cons:PathFraction[2]"			Cons:PathFraction[2]	= {	if (IfValidAnd( FramingFactor >= 0 )) then      FramingFactor  else  0  endif  }

; SAC 2/27/14 - now initialized in prior rulelist
;	"Init Cons:FrameCodeRValue"		Cons:FrameCodeRValue  = {	0.17 + 0.68  }   ; inside and outside film coeff. consistent w/ both ASHRAE fundamentals & ACM JA4

	"Remaining construction, R-val & U-val calcs"	Cons:Action = {	EvalRulelist( "SetupCons_GenericFramed", 1 )  }
; mjb 1/12/15 use new T24RClimateZoneCodeBase for code level lookups
	"Set Cons:CodeMaximumUValue"		Cons:CodeMaximumUValue	= {	if (Global( Proj:ClimateZone ) < 0.5) then  -1
;																						else  ClimateZoneTable( Global( Proj:ClimateZone ), 6 ) + 0.00049  endif  }  ; SAC 2/13/13 - added 0.00049 to allow for check taking into account rounding
																						else  T24RClimateZoneCodeBase:WallUval( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) + 0.00049  endif  }  ; SAC 2/13/13 - added 0.00049 to allow for check taking into account rounding
;	"Set Cons:CodeUValueLabel"			Cons:CodeUValueLabel		= {	if (Local( CodeMaximumUValue ) < 0) then  " "    ; no message - nothing to report
;																						else if (Local( CodeMaximumUValue ) < Local( OverallCodeUValue ))
;																						then  Format( "(doesn't meet max code %.3f U-value (%.3f))", Local( CodeMaximumUValue ), Local( OverallCodeUValue ) )
;																						else  Format( "(meets max code %.3f U-value (%.3f))", Local( CodeMaximumUValue ), Local( OverallCodeUValue ) )
;																						endif endif  }
END

;*************************************************************************
RULELIST "SetupCons_ExtWall_SinglePath"         0 0 0 1
;*************************************************************************
; INSIDE to OUTSIDE

	"Set Cons:FrameCavityLayerMat[1]"	Cons:FrameCavityLayerMat[1]	= {	if (Furring2Layer < 1 .AND. (FurringInsul2Layer < 1 .OR. FurringInsul2Layer == 100401 .OR.
                                                                                       (FurringInsul2Layer == 900 .AND. IfValidAnd( FurringInsul2LayerRVal > 0 )==0))) then  0
																									else if (InsideFinishLayer > 0.1) then  2
																									else  1  endif endif  }
	"Set Cons:FrameCavityLayerMat[2]"	Cons:FrameCavityLayerMat[2]	= {	if (FurringLayer < 1 .AND. (FurringInsulLayer < 1 .OR. FurringInsulLayer == 100401 .OR.
                                                                                      (FurringInsulLayer == 900 .AND. IfValidAnd( FurringInsulLayerRVal > 0 )==0))) then  0
																									else if (InsideFinishLayer > 0.1 .AND. FrameCavityLayerMat[1] > 0) then  4
																									else if (InsideFinishLayer > 0.1 .OR.  FrameCavityLayerMat[1] > 0) then  3
																									else  2  endif endif endif  }

	"Set Cons:NumLayerMats-1"		Cons:NumLayerMats = {	if (InsideFinishLayer  > 0.1) then  1  else  0  endif  }
	"Set Cons:NumLayerMats-2"		Cons:NumLayerMats = {	if (((FurringInsul2Layer != 900 .OR. IfValidAnd( FurringInsul2LayerRVal > 0 )) .AND.
                                                              FurringInsul2Layer != 100401 .AND. FurringInsul2Layer > 0) .OR. Furring2Layer > 0) then  NumLayerMats + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-3"		Cons:NumLayerMats = {	NumLayerMats + 1  }		; assumption here is that we will ALWAYS have a Mass/Adobe/... layer
	"Set Cons:NumLayerMats-4"		Cons:NumLayerMats = {	if (((FurringInsulLayer  != 900 .OR. IfValidAnd( FurringInsulLayerRVal  > 0 )) .AND.
                                                              FurringInsulLayer  != 100401 .AND. FurringInsulLayer  > 0) .OR. FurringLayer  > 0) then  NumLayerMats + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-5"		Cons:NumLayerMats = {	if (WallExtFinishLayer > 0.1) then                                                            NumLayerMats + 1  else  UNCHANGED  endif  }

; SAC 6/4/14 - added properties to be reported on CF1R
   "Set Cons:NumLayersRpt"		Cons:NumLayersRpt	= {	NumLayerMats  }
   "Set Cons:FramingRpt"		Cons:FramingRpt	= {	" "  }
   "Set Cons:CavityRRpt"		Cons:CavityRRpt	= {	" "  }

	; Mapping of this Index to Cons Properties:	1 =>	InsideFinishLayer 
	;															2 =>	FurringInsul2Layer // Furring2Layer
	;															3 =>	MassLayer  //  MassThickness
	;															4 =>	FurringInsulLayer // FurringLayer  
	;															5 =>	WallExtFinishLayer
	"Set Cons:FrameLayerMapIdx[1]"		Cons:FrameLayerMapIdx[1]   = {	2  }	; index of (possible) Cavity layers in mapping listed above
	"Set Cons:FrameLayerMapIdx[2]"		Cons:FrameLayerMapIdx[2]   = {	4  }
	"Set Cons:AbvJoistInsLyrMapIdx"		Cons:AbvJoistInsLyrMapIdx  = {	0  }	; index of insulation above ceiling joists layer in mapping listed above
	"Set Cons:BlwJoistInsLyrMapIdx"		Cons:BlwJoistInsLyrMapIdx  = {	0  }	; index of insulation below roof joists layer in mapping listed above
	"Set Cons:LayerPropertyIndex[1]"		Cons:LayerPropertyIndex[1] = {		  if (InsideFinishLayer  > 0.1) then  1
																								else if (((FurringInsul2Layer != 900 .OR. IfValidAnd( FurringInsul2LayerRVal > 0 )) .AND.
                                                                                  FurringInsul2Layer != 100401 .AND. FurringInsul2Layer > 0) .OR. Furring2Layer > 0) then  2
	                                                                     else  3  endif endif  }		; assumption here is that we will ALWAYS have a Mass/Adobe/... layer
	"Set Cons:LayerPropertyIndex[2]"		Cons:LayerPropertyIndex[2] = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :		  if (((FurringInsul2Layer != 900 .OR. IfValidAnd( FurringInsul2LayerRVal > 0 )) .AND.
                                                                                                 FurringInsul2Layer != 100401 .AND. FurringInsul2Layer > 0) .OR. Furring2Layer > 0) then  2
	                                                                     					else  3  endif
																									case  2 :      	3
																									case  3 :	if (((FurringInsulLayer != 900 .OR. IfValidAnd( FurringInsulLayerRVal > 0 )) .AND.
                                                                                            FurringInsulLayer  != 100401 .AND. FurringInsulLayer  > 0) .OR. FurringLayer  > 0) then  4
	                                                                     					else if (WallExtFinishLayer > 0.1) then  5  else  0  endif endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[3]"		Cons:LayerPropertyIndex[3] = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	3
																									case  3 :	if (((FurringInsulLayer != 900 .OR. IfValidAnd( FurringInsulLayerRVal > 0 )) .AND.
                                                                                            FurringInsulLayer  != 100401 .AND. FurringInsulLayer  > 0) .OR. FurringLayer  > 0) then  4
	                                                                     					else if (WallExtFinishLayer > 0.1) then  5  else  0  endif endif
																									case  4 :	if (WallExtFinishLayer > 0.1) then  5  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[4]"		Cons:LayerPropertyIndex[4] = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	if (((FurringInsulLayer != 900 .OR. IfValidAnd( FurringInsulLayerRVal > 0 )) .AND.
                                                                                            FurringInsulLayer  != 100401 .AND. FurringInsulLayer  > 0) .OR. FurringLayer  > 0) then  4
	                                                                     					else if (WallExtFinishLayer > 0.1) then  5  else  0  endif endif
																									case  4 :	if (WallExtFinishLayer > 0.1) then  5  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[5]"		Cons:LayerPropertyIndex[5] = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	if (WallExtFinishLayer > 0.1) then  5  else  0  endif
																									default :   0
																								endswitch  }

  ; assume 1" thickness of cavity insul (regardless of R-value)
;	"Set Cons:CavityMatCondQII[1]"		Cons:CavityMatCondQII[1]	= {	if (LayerPropertyIndex[1] == 2)
;																								then	if (IfValidAnd( Proj:ICQEnclCavInsMult > 0 ) .AND.
;																						 					 IfValidAnd(  FurringInsul2Layer > 0 ) .AND. IfValidAnd( FurringInsul2Layer < 200 ))
;																										then  (1/12) / ( FurringInsul2Layer * Proj:ICQEnclCavInsMult )
;																										else  0  endif
;																								else  0  endif  }
; SAC 3/27/14 - revised rules to DISREGARD Proj:ICQEnclCavInsMult when setting CavityMatCondQII[*] for mass walls (GC issue #290)
;					debugging
;						"log Cons data"	Cons:Action	= {	if (LayerPropertyIndex[1] != 2 .AND. LayerPropertyIndex[2] != 2 .AND. (IfValidAnd( FurringInsul2Layer > 0 )==0 .OR. IfValidAnd( FurringInsul2Layer < 200 )==0)) then  UNCHANGED
;																		else  PostMessageToLog( "Setting Cons:CavityMatCond* for Insul2Layer for '%s':  FurringInsul2Layer = %g / Furring2Layer = %g", Name, FurringInsul2Layer, Furring2Layer )  endif  }
;						"log Cons data"	Cons:Action	= {	if (LayerPropertyIndex[2] != 4 .AND. LayerPropertyIndex[3] != 4 .AND. LayerPropertyIndex[4] != 4 .AND. (IfValidAnd( FurringInsulLayer > 0 )==0 .OR. IfValidAnd( FurringInsulLayer < 200 )==0)) then  UNCHANGED
;																		else  PostMessageToLog( "Setting Cons:CavityMatCond* for InsulLayer for '%s':  FurringInsulLayer = %g / FurringLayer = %g", Name, FurringInsulLayer, FurringLayer )  endif  }
; SAC 11/22/14 - modified logic to take into account thickness of furring layer when calculating Cons:CavityMatCond*[*] (previous ver assumed 1" always) (GC issue #423)
; SAC 4/28/15 - added logic to address case where FurringInsul*Layer = 100401 => no insulation (issue 491)
; SAC 5/12/17 - added logic accommodating user-specified insul/furring R-value
	"Set Cons:CavityMatCondQII[1]"		Cons:CavityMatCondQII[1]	= {	if (LayerPropertyIndex[1] == 2)
																								then	if (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal > 0 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2LayerRVal
																												else	                              (1 / 12) /  FurringInsul2LayerRVal    endif
																										else if (IfValidAnd( FurringInsul2Layer > 0 ) .AND. IfValidAnd( FurringInsul2Layer < 200 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2Layer
																												else	                              (1 / 12) /  FurringInsul2Layer    endif
																										else if (IfValidAnd( FurringInsul2Layer = 100401 ) .OR. (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal = 0 )))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  0.92
																												else	                              (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif  }
	"Set Cons:CavityMatCondQII[2]"		Cons:CavityMatCondQII[2]	= {	if (LayerPropertyIndex[2] == 2)
																								then	if (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal > 0 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2LayerRVal
																												else	                              (1 / 12) /  FurringInsul2LayerRVal    endif
																										else if (IfValidAnd( FurringInsul2Layer > 0 ) .AND. IfValidAnd( FurringInsul2Layer < 200 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2Layer
																												else	                              (1 / 12) /  FurringInsul2Layer    endif
																										else if (IfValidAnd( FurringInsul2Layer = 100401 ) .OR. (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal = 0 )))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  0.92
																												else	                              (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else if (LayerPropertyIndex[2] == 4)
																								then	if (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal > 0 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayerRVal
																												else	                             (1 / 12) /  FurringInsulLayerRVal    endif
																										else if (IfValidAnd( FurringInsulLayer > 0 ) .AND. IfValidAnd( FurringInsulLayer < 200 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayer
																												else	                             (1 / 12) /  FurringInsulLayer    endif
																										else if (IfValidAnd( FurringInsulLayer = 100401 ) .OR. (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal = 0 )))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  0.92
																												else	                             (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif endif  }
	"Set Cons:CavityMatCondQII[3]"		Cons:CavityMatCondQII[3]	= {	if (LayerPropertyIndex[3] == 4)
																								then	if (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal > 0 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayerRVal
																												else	                             (1 / 12) /  FurringInsulLayerRVal    endif
																										else if (IfValidAnd( FurringInsulLayer > 0 ) .AND. IfValidAnd( FurringInsulLayer < 200 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayer
																												else	                             (1 / 12) /  FurringInsulLayer    endif
																										else if (IfValidAnd( FurringInsulLayer = 100401 ) .OR. (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal = 0 )))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  0.92
																												else	                             (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif  }
	"Set Cons:CavityMatCondQII[4]"		Cons:CavityMatCondQII[4]	= {	if (LayerPropertyIndex[4] == 4)
																								then	if (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal > 0 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayerRVal
																												else	                             (1 / 12) /  FurringInsulLayerRVal    endif
																										else if (IfValidAnd( FurringInsulLayer > 0 ) .AND. IfValidAnd( FurringInsulLayer < 200 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayer
																												else	                             (1 / 12) /  FurringInsulLayer    endif
																										else if (IfValidAnd( FurringInsulLayer = 100401 ) .OR. (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal = 0 )))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  0.92
																												else	                             (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif  }
	"Set Cons:CavityMatCondQII[5]"		Cons:CavityMatCondQII[5]	= {	0  }
	"Set Cons:CavityMatCondQII[6]"		Cons:CavityMatCondQII[6]	= {	0  }
	"Set Cons:CavityMatCondQII[7]"		Cons:CavityMatCondQII[7]	= {	0  }
	"Set Cons:CavityMatCondQII[8]"		Cons:CavityMatCondQII[8]	= {	0  }
; DEBUGGING
;	"log Cons data"	Cons:Action	= {	PostMessageToLog( "Setting Cons:CavityMatCond[2] for '%s' Thickness[2] = %g / Furring2Layer = %g", Name, Thickness[2], Furring2Layer )  }
	"Set Cons:CavityMatCond[1]"			Cons:CavityMatCond[1]		= {	if (LayerPropertyIndex[1] == 2)
																								then	if (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal > 0 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2LayerRVal
																												else	                              (1 / 12) /  FurringInsul2LayerRVal    endif
																										else if (IfValidAnd( FurringInsul2Layer > 0 ) .AND. IfValidAnd( FurringInsul2Layer < 200 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2Layer
																												else	                              (1 / 12) /  FurringInsul2Layer    endif
																										else if (IfValidAnd( FurringInsul2Layer = 100401 ) .OR. (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal = 0 )))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  0.92
																												else	                              (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif  }
	"Set Cons:CavityMatCond[2]"			Cons:CavityMatCond[2]		= {	if (LayerPropertyIndex[2] == 2)
																								then	if (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal > 0 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2LayerRVal
																												else	                              (1 / 12) /  FurringInsul2LayerRVal    endif
																										else if (IfValidAnd( FurringInsul2Layer > 0 ) .AND. IfValidAnd( FurringInsul2Layer < 200 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2Layer
																												else	                              (1 / 12) /  FurringInsul2Layer    endif
																										else if (IfValidAnd( FurringInsul2Layer = 100401 ) .OR. (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal = 0 )))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  0.92
																												else	                              (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else if (LayerPropertyIndex[2] == 4)
																								then	if (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal > 0 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayerRVal
																												else	                             (1 / 12) /  FurringInsulLayerRVal    endif
																										else if (IfValidAnd( FurringInsulLayer > 0 ) .AND. IfValidAnd( FurringInsulLayer < 200 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayer
																												else	                             (1 / 12) /  FurringInsulLayer    endif
																										else if (IfValidAnd( FurringInsulLayer = 100401 ) .OR. (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal = 0 )))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  0.92
																												else	                             (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif endif  }
	"Set Cons:CavityMatCond[3]"			Cons:CavityMatCond[3]		= {	if (LayerPropertyIndex[3] == 4)
																								then	if (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal > 0 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayerRVal
																												else	                             (1 / 12) /  FurringInsulLayerRVal    endif
																										else if (IfValidAnd( FurringInsulLayer > 0 ) .AND. IfValidAnd( FurringInsulLayer < 200 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayer
																												else	                             (1 / 12) /  FurringInsulLayer    endif
																										else if (IfValidAnd( FurringInsulLayer = 100401 ) .OR. (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal = 0 )))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  0.92
																												else	                             (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif  }
	"Set Cons:CavityMatCond[4]"			Cons:CavityMatCond[4]		= {	if (LayerPropertyIndex[4] == 4)
																								then	if (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal > 0 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayerRVal
																												else	                             (1 / 12) /  FurringInsulLayerRVal    endif
																										else if (IfValidAnd( FurringInsulLayer > 0 ) .AND. IfValidAnd( FurringInsulLayer < 200 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayer
																												else	                             (1 / 12) /  FurringInsulLayer    endif
																										else if (IfValidAnd( FurringInsulLayer = 100401 ) .OR. (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal = 0 )))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  0.92
																												else	                             (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif  }
	"Set Cons:CavityMatCond[5]"			Cons:CavityMatCond[5]		= {	0  }
	"Set Cons:CavityMatCond[6]"			Cons:CavityMatCond[6]		= {	0  }
	"Set Cons:CavityMatCond[7]"			Cons:CavityMatCond[7]		= {	0  }
	"Set Cons:CavityMatCond[8]"			Cons:CavityMatCond[8]		= {	0  }

; SAC 4/28/15 - mods to set CavityLayerSymVal[*] to 0 for FurringInsul*Layer = no insul...
	"Set Cons:CavityLayerSymVal[1]"		Cons:CavityLayerSymVal[1]   = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	InsideFinishLayer  
																									case  2 :	if (FurringInsul2Layer == 100401)
																													then	0
																													else	FurringInsul2Layer  endif
																									case  3 :	if (MassLayer < 10000)
																													then	(MassLayer * 100) + MassThickness
																													else	 MassLayer   endif
																									case  4 :	if (FurringInsulLayer == 100401)
																													then	0
																													else	FurringInsulLayer  endif  
																									case  5 :	WallExtFinishLayer 
																									default : 0
																								endswitch  }
	"Set Cons:CavityLayerSymVal[2]"		Cons:CavityLayerSymVal[2]   = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	if (FurringInsul2Layer == 100401)
																													then	0
																													else	FurringInsul2Layer  endif 
																									case  3 :	if (MassLayer < 10000)
																													then	(MassLayer * 100) + MassThickness
																													else	 MassLayer   endif          
																									case  4 :	if (FurringInsulLayer == 100401)
																													then	0
																													else	FurringInsulLayer  endif  
																									case  5 :	WallExtFinishLayer 
																									default : 0
																								endswitch  }
	"Set Cons:CavityLayerSymVal[3]"		Cons:CavityLayerSymVal[3]   = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	if (MassLayer < 10000)
																													then	(MassLayer * 100) + MassThickness
																													else	 MassLayer   endif          
																									case  4 :	if (FurringInsulLayer == 100401)
																													then	0
																													else	FurringInsulLayer  endif  
																									case  5 :	WallExtFinishLayer 
																									default : 0
																								endswitch  }
	"Set Cons:CavityLayerSymVal[4]"		Cons:CavityLayerSymVal[4]   = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	if (FurringInsulLayer == 100401)
																													then	0
																													else	FurringInsulLayer  endif  
																									case  5 :	WallExtFinishLayer 
																									default : 0
																								endswitch  }
	"Set Cons:CavityLayerSymVal[5]"		Cons:CavityLayerSymVal[5]   = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :	WallExtFinishLayer
																									default : 0
																								endswitch  }

	"Set Cons:FrameLayerSymVal[1]"		Cons:FrameLayerSymVal[1]  = {		switch (Local( LayerPropertyIndex[1] ))
																									case  2 :	Furring2Layer 
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[2]"		Cons:FrameLayerSymVal[2]  = {		switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	Furring2Layer 
																									case  4 :	FurringLayer  
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[3]"		Cons:FrameLayerSymVal[3]  = {		switch (Local( LayerPropertyIndex[3] ))
																									case  4 :	FurringLayer  
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[4]"		Cons:FrameLayerSymVal[4]  = {		switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	FurringLayer  
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[5]"		Cons:FrameLayerSymVal[5]  = {	0  }

   ; SAC 5/11/17 - related to user-defined furring insulation r-value
   "Set Cons:LayerUsrInpInsRVal[1]"    Cons:LayerUsrInpInsRVal[1]  = {
         if (LayerPropertyIndex[1] == 2 .AND. FurringInsul2Layer == 900)
         then  FurringInsul2LayerRVal
         else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[2]"    Cons:LayerUsrInpInsRVal[2]  = {
         if (LayerPropertyIndex[2] == 2 .AND. FurringInsul2Layer == 900)
         then  FurringInsul2LayerRVal
         else if (LayerPropertyIndex[2] == 4 .AND. FurringInsulLayer == 900)
         then  FurringInsulLayerRVal
         else  UNDEFINED  endif endif  }
   "Set Cons:LayerUsrInpInsRVal[3]"    Cons:LayerUsrInpInsRVal[3]  = {
         if (LayerPropertyIndex[3] == 4 .AND. FurringInsulLayer == 900)
         then  FurringInsulLayerRVal
         else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[4]"    Cons:LayerUsrInpInsRVal[4]  = {
         if (LayerPropertyIndex[4] == 4 .AND. FurringInsulLayer == 900)
         then  FurringInsulLayerRVal
         else  UNDEFINED  endif  }
   "Init Cons:LayerUsrInpInsRVal[5]"   Cons:LayerUsrInpInsRVal[5]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[8]"   Cons:LayerUsrInpInsRVal[8]  = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[6]"   Cons:LayerUsrInpInsRVal[6]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[9]"   Cons:LayerUsrInpInsRVal[9]  = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[7]"   Cons:LayerUsrInpInsRVal[7]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[10]"  Cons:LayerUsrInpInsRVal[10] = {  UNDEFINED  }

; SAC 6/4/14 - added properties to be reported on CF1R
	"Set Cons:AssemblyLayersRpt[1]"		Cons:AssemblyLayersRpt[1]   = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	Format( "%s %s",      LayerLabels[1], EnumString( InsideFinishLayer     ))
																									case  2 :	Format( "%s %s / %s", LayerLabels[2], EnumString( FurringInsul2LayerStr ), EnumString( Furring2LayerAbr )) 
																									case  3 :	Format( "%s %s %s",   LayerLabels[3], EnumString( MassThickness         ), EnumString( MassLayer ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[2]"		Cons:AssemblyLayersRpt[2]   = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	Format( "%s %s / %s", LayerLabels[2], EnumString( FurringInsul2LayerStr ), EnumString( Furring2LayerAbr )) 
																									case  3 :	Format( "%s %s %s",   LayerLabels[3], EnumString( MassThickness         ), EnumString( MassLayer ))        
																									case  4 :	Format( "%s %s / %s", LayerLabels[4], EnumString( FurringInsulLayerStr  ), EnumString( FurringLayerAbr ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[3]"		Cons:AssemblyLayersRpt[3]   = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	Format( "%s %s %s",   LayerLabels[3], EnumString( MassThickness         ), EnumString( MassLayer ))        
																									case  4 :	Format( "%s %s / %s", LayerLabels[4], EnumString( FurringInsulLayerStr  ), EnumString( FurringLayerAbr ))  
																									case  5 :	Format( "%s %s",      LayerLabels[5], EnumString( WallExtFinishLayer    ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[4]"		Cons:AssemblyLayersRpt[4]   = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	Format( "%s %s / %s", LayerLabels[4], EnumString( FurringInsulLayerStr  ), EnumString( FurringLayerAbr ))  
																									case  5 :	Format( "%s %s",      LayerLabels[5], EnumString( WallExtFinishLayer    )) 
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[5]"		Cons:AssemblyLayersRpt[5]   = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :	Format( "%s %s",      LayerLabels[5], EnumString( WallExtFinishLayer    )) 
																									default : UNDEFINED
																								endswitch  }
	"Blast Cons:AssemblyLayersRpt[6]"	Cons:AssemblyLayersRpt[6]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[7]"	Cons:AssemblyLayersRpt[7]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[8]"	Cons:AssemblyLayersRpt[8]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[9]"	Cons:AssemblyLayersRpt[9]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[10]"	Cons:AssemblyLayersRpt[10]  = {	UNDEFINED  }

;	"Set Cons:FrameSpacing"	; SAC 2/14/12 - moved from ExtWall to facilitate wall splitting
;		Cons:FrameSpacing		= {	if (Local( Type ) == 0 .OR. Local( Type ) == 1)		; "Wood Framed Wall" or "Steel Framed Wall"
;											then	if (Local( FrameLayer ) > 0)
;													then  mod( Local( FrameLayer ), 100 )
;													else  16		; no frame layer specified, so use generic default (??)
;													endif
;											else	0				; NOT wood or steel framed, so no frame spacing used/valid (??)
;											endif  }
;
	"Set Cons:FramingFactor => fraction of gross surface area that includes frame" 
		Cons:FramingFactor	= {	0  }
	"Set Cons:PathFraction[1]"			Cons:PathFraction[1]	= {	1  }		; SAC 3/17/14
	"Set Cons:PathFraction[2]"			Cons:PathFraction[2]	= {	0  }


; SAC 2/27/14 - now initialized in prior rulelist
;	"Init Cons:CavityCodeRValue"		Cons:CavityCodeRValue  = {	0.17 + 0.68  }   ; inside and outside film coeff. consistent w/ both ASHRAE fundamentals & ACM JA4

	"Remaining construction, R-val & U-val calcs"	Cons:Action = {	EvalRulelist( "SetupCons_SinglePath", 1 )  }

; mjb 1/12/15 use new T24RClimateZoneCodeBase for code level lookups
	"Set Cons:CodeMaximumUValue"		Cons:CodeMaximumUValue	= {	if (Global( Proj:ClimateZone ) < 0.5) then  -1
;																						else  ClimateZoneTable( Global( Proj:ClimateZone ), 6 ) + 0.00049  endif  }  ; SAC 2/13/13 - added 0.00049 to allow for check taking into account rounding
																						else  T24RClimateZoneCodeBase:WallUval( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) + 0.00049  endif  }  ; SAC 2/13/13 - added 0.00049 to allow for check taking into account rounding

;	"Set Cons:CodeUValueLabel"			Cons:CodeUValueLabel		= {	if (Local( CodeMaximumUValue ) < 0) then  " "    ; no message - nothing to report
;																						else if (Local( CodeMaximumUValue ) < Local( OverallCodeUValue ))
;																						then  Format( "(doesn't meet max code %.3f U-value (%.3f))", Local( CodeMaximumUValue ), Local( OverallCodeUValue ) )
;																						else  Format( "(meets max code %.3f U-value (%.3f))", Local( CodeMaximumUValue ), Local( OverallCodeUValue ) )
;																						endif endif  }
END

;*************************************************************************
RULELIST "SetupCons_IntWall_TwoPath"         0 0 0 1
;*************************************************************************
; INSIDE to OUTSIDE

	"Set Cons:FrameCavityLayerMat[1]"	Cons:FrameCavityLayerMat[1] = {	     if (Local( FrameLayer ) < 0.1) then  0     ; NO frame/cavity layer
																								else if (Local( InsideFinishLayer ) > 0.1 .AND. Local( SheathInsul2Layer ) > 0.1 .AND.
                                                                               (SheathInsul2Layer != 99000 .OR. IfValidAnd( SheathInsul2LayerRVal > 0 ))) then  3
																								else if (Local( InsideFinishLayer ) > 0.1 .OR. (Local( SheathInsul2Layer ) > 0.1 .AND.
                                                                               (SheathInsul2Layer != 99000 .OR. IfValidAnd( SheathInsul2LayerRVal > 0 )))) then  2
																								else  1  endif endif endif  }
	"Set Cons:FrameCavityLayerMat[2]"	Cons:FrameCavityLayerMat[2]	= {	0  }

	"Set Cons:NumLayerMats-1"		Cons:NumLayerMats = {	if (Local( InsideFinishLayer    ) > 0.1) then  1  else  0  endif  }
	"Set Cons:NumLayerMats-2"		Cons:NumLayerMats = {	if ((SheathInsul2Layer != 99000 .OR. IfValidAnd( SheathInsul2LayerRVal > 0 )) .AND.
                                                             Local( SheathInsul2Layer    ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-3"		Cons:NumLayerMats = {	if (Local( FrameLayer           ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-4"		Cons:NumLayerMats = {	if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                             Local( SheathInsulLayer     ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-5"		Cons:NumLayerMats = {	if (Local( OtherSideFinishLayer ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }

; SAC 6/4/14 - added properties to be reported on CF1R
   "Set Cons:NumLayersRpt"		Cons:NumLayersRpt	= {	NumLayerMats  }
   "Set Cons:FramingRpt"		Cons:FramingRpt	= {	if (IfValidAnd( FrameLayer > 0 )) then  EnumString( FrameLayer )  else  " "  endif  }
   "Set Cons:CavityRRpt"		Cons:CavityRRpt	= {	if (IfValidAnd( CavityLayer > 0 ) .AND. IfValidAnd( CavityLayer < 100001 )) then  EnumString( CavityLayer )  else  "none"  endif  }

	; Mapping of this Index to Cons Properties:	1 =>	InsideFinishLayer 
	;															2 =>	SheathInsul2Layer 
	;															3 =>	FrameLayer  //  CavityLayer
	;															4 =>	SheathInsulLayer  
	;															5 =>	OtherSideFinishLayer
	"Set Cons:FrameLayerMapIdx[1]"		Cons:FrameLayerMapIdx[1]   = {	3  }	; index of Frame/Cavity layer in mapping listed above
	"Set Cons:FrameLayerMapIdx[2]"		Cons:FrameLayerMapIdx[2]   = {	0  }
	"Set Cons:AbvJoistInsLyrMapIdx"		Cons:AbvJoistInsLyrMapIdx  = {	0  }	; index of insulation above ceiling joists layer in mapping listed above
	"Set Cons:BlwJoistInsLyrMapIdx"		Cons:BlwJoistInsLyrMapIdx  = {	0  }	; index of insulation below roof joists layer in mapping listed above
	"Set Cons:LayerPropertyIndex[1]"		Cons:LayerPropertyIndex[1] = {		  if (Local( InsideFinishLayer    ) > 0.1) then  1
																								else if ((SheathInsul2Layer != 99000 .OR. IfValidAnd( SheathInsul2LayerRVal > 0 )) .AND.
                                                                                 Local( SheathInsul2Layer    ) > 0.1) then  2
	                                                                     else if (Local( FrameLayer           ) > 0.1) then  3
	                                                                     else if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                 Local( SheathInsulLayer     ) > 0.1) then  4
	                                                                     else if (Local( OtherSideFinishLayer ) > 0.1) then  5  else  0  endif endif endif endif endif  }
	"Set Cons:LayerPropertyIndex[2]"		Cons:LayerPropertyIndex[2] = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :		  if ((SheathInsul2Layer != 99000 .OR. IfValidAnd( SheathInsul2LayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsul2Layer    ) > 0.1) then  2
	                                                                     					else if (Local( FrameLayer           ) > 0.1) then  3
	                                                                     					else if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer     ) > 0.1) then  4
	                                                                     					else if (Local( OtherSideFinishLayer ) > 0.1) then  5  else  0  endif endif endif endif
																									case  2 :		  if (Local( FrameLayer           ) > 0.1) then  3
	                                                                     					else if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer     ) > 0.1) then  4
	                                                                     					else if (Local( OtherSideFinishLayer ) > 0.1) then  5  else  0  endif endif endif
																									case  3 :		  if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer     ) > 0.1) then  4
	                                                                     					else if (Local( OtherSideFinishLayer ) > 0.1) then  5  else  0  endif endif
																									case  4 :		  if (Local( OtherSideFinishLayer ) > 0.1) then  5  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[3]"		Cons:LayerPropertyIndex[3] = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :		  if (Local( FrameLayer           ) > 0.1) then  3
	                                                                     					else if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer     ) > 0.1) then  4
	                                                                     					else if (Local( OtherSideFinishLayer ) > 0.1) then  5  else  0  endif endif endif
																									case  3 :		  if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer     ) > 0.1) then  4
	                                                                     					else if (Local( OtherSideFinishLayer ) > 0.1) then  5  else  0  endif endif
																									case  4 :		  if (Local( OtherSideFinishLayer ) > 0.1) then  5  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[4]"		Cons:LayerPropertyIndex[4] = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :		  if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer     ) > 0.1) then  4
	                                                                     					else if (Local( OtherSideFinishLayer ) > 0.1) then  5  else  0  endif endif
																									case  4 :		  if (Local( OtherSideFinishLayer ) > 0.1) then  5  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[5]"		Cons:LayerPropertyIndex[5] = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :		  if (Local( OtherSideFinishLayer ) > 0.1) then  5  else  0  endif
																									default :   0
																								endswitch  }

	"Set Cons:FrameLayerSymVal[1]"		Cons:FrameLayerSymVal[1]   = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	Local( InsideFinishLayer    )
																									case  2 :	Local( SheathInsul2Layer    )
																									case  3 :	Local( FrameLayer           )
																									case  4 :	Local( SheathInsulLayer     )
																									case  5 :	Local( OtherSideFinishLayer )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[2]"		Cons:FrameLayerSymVal[2]   = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	Local( SheathInsul2Layer    )
																									case  3 :	Local( FrameLayer           )
																									case  4 :	Local( SheathInsulLayer     )
																									case  5 :	Local( OtherSideFinishLayer )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[3]"		Cons:FrameLayerSymVal[3]   = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	Local( FrameLayer           )
																									case  4 :	Local( SheathInsulLayer     )
																									case  5 :	Local( OtherSideFinishLayer )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[4]"		Cons:FrameLayerSymVal[4]   = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	Local( SheathInsulLayer     )
																									case  5 :	Local( OtherSideFinishLayer )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[5]"		Cons:FrameLayerSymVal[5]   = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :	Local( OtherSideFinishLayer )
																									default : 0
																								endswitch  }

   ; SAC 5/15/17 - added compressed R-value selections - R-val = (SymVal-mod(SymVal,10))/100  (tic #761)
	"Set Cons:CavityLayerSymVal[1]"		Cons:CavityLayerSymVal[1]  = {
         if (Local( LayerPropertyIndex[1] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[1] )  endif  }
	"Set Cons:CavityLayerSymVal[2]"		Cons:CavityLayerSymVal[2]  = {
         if (Local( LayerPropertyIndex[2] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[2] )  endif  }
	"Set Cons:CavityLayerSymVal[3]"		Cons:CavityLayerSymVal[3]  = {
         if (Local( LayerPropertyIndex[3] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[3] )  endif  }
	"Set Cons:CavityLayerSymVal[4]"		Cons:CavityLayerSymVal[4]  = {
         if (Local( LayerPropertyIndex[4] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[4] )  endif  }
	"Set Cons:CavityLayerSymVal[5]"		Cons:CavityLayerSymVal[5]  = {
         if (Local( LayerPropertyIndex[5] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[5] )  endif  }

   ; SAC 4/11/17 - related to user-defined sheating/insulation r-value
   "Set Cons:LayerUsrInpInsRVal[1]"    Cons:LayerUsrInpInsRVal[1]  = {
         if (LayerPropertyIndex[1] == 2 .AND. SheathInsul2Layer == 99000)
         then  SheathInsul2LayerRVal
         else if (LayerPropertyIndex[1] == 4 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal
         else  UNDEFINED  endif endif  }
   "Set Cons:LayerUsrInpInsRVal[2]"    Cons:LayerUsrInpInsRVal[2]  = {
         if (LayerPropertyIndex[2] == 2 .AND. SheathInsul2Layer == 99000)
         then  SheathInsul2LayerRVal
         else if (LayerPropertyIndex[2] == 4 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal
         else  UNDEFINED  endif endif  }
   "Set Cons:LayerUsrInpInsRVal[3]"    Cons:LayerUsrInpInsRVal[3]  = {
         if (LayerPropertyIndex[3] == 4 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal
         else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[4]"    Cons:LayerUsrInpInsRVal[4]  = {
         if (LayerPropertyIndex[4] == 4 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal
         else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[5]"    Cons:LayerUsrInpInsRVal[5]  = {
         if (LayerPropertyIndex[5] == 4 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal
         else  UNDEFINED  endif  }
   "Init Cons:LayerUsrInpInsRVal[6]"   Cons:LayerUsrInpInsRVal[6]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[9]"   Cons:LayerUsrInpInsRVal[9]  = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[7]"   Cons:LayerUsrInpInsRVal[7]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[10]"  Cons:LayerUsrInpInsRVal[10] = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[8]"   Cons:LayerUsrInpInsRVal[8]  = {  UNDEFINED  }

; SAC 6/4/14 - added properties to be reported on CF1R
      ; SAC 7/18/19 - fixed LayerLabels[] indices for case 2 in following rules (4->2) (tic #879) 
      ; SAC 10/21/19 - hyphenated R-values (R## -> R-##) (tic #1121)
	"Set Cons:AssemblyLayersRpt[1]"		Cons:AssemblyLayersRpt[1]   = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	Format( "%s %s",      LayerLabels[1], EnumString( InsideFinishLayer  ))
																									case  2 :	if (SheathInsul2Layer == 99000 .AND. IfValidAnd( SheathInsul2LayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[2], FltToStr( SheathInsul2LayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[2], EnumString( SheathInsul2LayerRpt  ))  endif
																									case  3 :	Format( "%s %s / %s", LayerLabels[3], EnumString( CavityLayerAbr     ), EnumString( FrameLayerAbr ))
																									case  4 :	if (SheathInsulLayer == 99000 .AND. IfValidAnd( SheathInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[4], FltToStr( SheathInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[4], EnumString( SheathInsulLayerRpt   ))  endif
																									case  5 :	Format( "%s %s",      LayerLabels[5], EnumString( OtherSideFinishLayer ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[2]"		Cons:AssemblyLayersRpt[2]   = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	if (SheathInsul2Layer == 99000 .AND. IfValidAnd( SheathInsul2LayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[2], FltToStr( SheathInsul2LayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[2], EnumString( SheathInsul2LayerRpt  ))  endif
																									case  3 :	Format( "%s %s / %s", LayerLabels[3], EnumString( CavityLayerAbr     ), EnumString( FrameLayerAbr ))
																									case  4 :	if (SheathInsulLayer == 99000 .AND. IfValidAnd( SheathInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[4], FltToStr( SheathInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[4], EnumString( SheathInsulLayerRpt   ))  endif
																									case  5 :	Format( "%s %s",      LayerLabels[5], EnumString( OtherSideFinishLayer ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[3]"		Cons:AssemblyLayersRpt[3]   = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	Format( "%s %s / %s", LayerLabels[3], EnumString( CavityLayerAbr     ), EnumString( FrameLayerAbr ))
																									case  4 :	if (SheathInsulLayer == 99000 .AND. IfValidAnd( SheathInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[4], FltToStr( SheathInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[4], EnumString( SheathInsulLayerRpt   ))  endif
																									case  5 :	Format( "%s %s",      LayerLabels[5], EnumString( OtherSideFinishLayer ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[4]"		Cons:AssemblyLayersRpt[4]   = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	if (SheathInsulLayer == 99000 .AND. IfValidAnd( SheathInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[4], FltToStr( SheathInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s", LayerLabels[4], EnumString( SheathInsulLayerRpt   ))  endif
																									case  5 :	Format( "%s %s", LayerLabels[5], EnumString( OtherSideFinishLayer ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[5]"		Cons:AssemblyLayersRpt[5]   = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :	Format( "%s %s", LayerLabels[5], EnumString( OtherSideFinishLayer ))
																									default : UNDEFINED
																								endswitch  }
	"Blast Cons:AssemblyLayersRpt[6]"	Cons:AssemblyLayersRpt[6]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[7]"	Cons:AssemblyLayersRpt[7]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[8]"	Cons:AssemblyLayersRpt[8]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[9]"	Cons:AssemblyLayersRpt[9]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[10]"	Cons:AssemblyLayersRpt[10]  = {	UNDEFINED  }

	"Set Cons:FrameSpacing"	; SAC 2/14/12 - moved from ExtWall to facilitate wall splitting
		Cons:FrameSpacing		= {	if (Local( Type ) == 0 .OR. Local( Type ) == 1)		; "Wood Framed Wall" or "Steel Framed Wall"
											then	if (Local( FrameLayer ) > 0)
													then  mod( Local( FrameLayer ), 100 )
													else  16		; no frame layer specified, so use generic default (??)
													endif
											else	0				; NOT wood or steel framed, so no frame spacing used/valid (??)
											endif  }

	"Set Cons:FramingFactor => fraction of gross surface area that includes frame" 
		Cons:FramingFactor	= {	if (Local( Type ) == 0)					; "Wood Framed Wall"
											then	if (Local( FrameSpacing ) == 16)
													then  0.25    ; Wood - 16" OC
													else if (Local( FrameSpacing ) == 24)
													then  0.22    ; Wood - 24" OC
													else if (Local( FrameSpacing ) == 25)
													then  0.17    ; Wood - AWF (advanced wall framing)  - SAC 3/13/14 - based on data from Bruce
												else if (Local( FrameSpacing ) == 48)
													then  0.04    ; Wood - 48" OC						- from 2008 Joint App 4 - 4.1.6
													else  -1								; INVALID FRAME SPACING
													endif endif endif endif
											else if (Local( Type ) == 1)			; "Steel Framed Wall"
											then	if (Local( FrameSpacing ) == 16)
													then  0.15    ; Steel - 16" OC					- from 2008 Joint App 4 - 4.1.6
													else if (Local( FrameSpacing ) == 24)
													then  0.12    ; Steel - 24" OC					- from 2008 Joint App 4 - 4.1.6
													else  -1								; INVALID FRAME SPACING
													endif endif
											else  0  endif endif  }
	"Set Cons:PathFraction[1]"			Cons:PathFraction[1]	= {	if (IfValidAnd( FramingFactor >= 0 )) then  1 - FramingFactor  else  0  endif  }		; SAC 3/17/14
	"Set Cons:PathFraction[2]"			Cons:PathFraction[2]	= {	if (IfValidAnd( FramingFactor >= 0 )) then      FramingFactor  else  0  endif  }

; SAC 2/27/14 - now initialized in prior rulelist
;	"Init Cons:FrameCodeRValue"		Cons:FrameCodeRValue  = {	0.68 + 0.68  }   ; inside film coeff. for ext walls (x2 for each side)

	"Remaining construction, R-val & U-val calcs"	Cons:Action = {	EvalRulelist( "SetupCons_GenericFramed", 1 )  }

;	"Set Cons:CodeMaximumUValue"		Cons:CodeMaximumUValue	= {	if (Global( Proj:ClimateZone ) < 0.5) then  -1
;																						else  ClimateZoneTable( Global( Proj:ClimateZone ), 6 ) + 0.00049  endif  }  ; SAC 2/13/13 - added 0.00049 to allow for check taking into account rounding
;
;	"Set Cons:CodeUValueLabel"			Cons:CodeUValueLabel		= {	if (Local( CodeMaximumUValue ) < 0) then  " "    ; no message - nothing to report
;																						else if (Local( CodeMaximumUValue ) < Local( OverallCodeUValue ))
;																						then  Format( "(doesn't meet max code %.3f U-value (%.3f))", Local( CodeMaximumUValue ), Local( OverallCodeUValue ) )
;																						else  Format( "(meets max code %.3f U-value (%.3f))", Local( CodeMaximumUValue ), Local( OverallCodeUValue ) )
;																						endif endif  }

END

; SAC 3/12/14 - created based on 'SetupCons_ExtWall_SinglePath'
;*************************************************************************
RULELIST "SetupCons_IntWall_SinglePath"         0 0 0 1
;*************************************************************************
; INSIDE to OUTSIDE

	"Set Cons:FrameCavityLayerMat[1]"	Cons:FrameCavityLayerMat[1]	= {	if (Furring2Layer < 1 .AND. (FurringInsul2Layer < 1 .OR. FurringInsul2Layer == 100401 .OR.
                                                                                       (FurringInsul2Layer == 900 .AND. IfValidAnd( FurringInsul2LayerRVal > 0 )==0))) then  0
																									else if (InsideFinishLayer > 0.1) then  2
																									else  1  endif endif  }
	"Set Cons:FrameCavityLayerMat[2]"	Cons:FrameCavityLayerMat[2]	= {	if (FurringLayer < 1 .AND. (FurringInsulLayer < 1 .OR. FurringInsulLayer == 100401 .OR.
                                                                                      (FurringInsulLayer == 900 .AND. IfValidAnd( FurringInsulLayerRVal > 0 )==0))) then  0
																									else if (InsideFinishLayer > 0.1 .AND. FrameCavityLayerMat[1] > 0) then  4
																									else if (InsideFinishLayer > 0.1 .OR.  FrameCavityLayerMat[1] > 0) then  3
																									else  2  endif endif endif  }

	"Set Cons:NumLayerMats-1"		Cons:NumLayerMats = {	if (InsideFinishLayer  > 0.1) then  1  else  0  endif  }
	"Set Cons:NumLayerMats-2"		Cons:NumLayerMats = {	if (((FurringInsul2Layer != 900 .OR. IfValidAnd( FurringInsul2LayerRVal > 0 )) .AND.
                                                              FurringInsul2Layer != 100401 .AND. FurringInsul2Layer > 0) .OR. Furring2Layer > 0) then  NumLayerMats + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-3"		Cons:NumLayerMats = {	NumLayerMats + 1  }		; assumption here is that we will ALWAYS have a Mass/Adobe/... layer
	"Set Cons:NumLayerMats-4"		Cons:NumLayerMats = {	if (((FurringInsulLayer  != 900 .OR. IfValidAnd( FurringInsulLayerRVal  > 0 )) .AND.
                                                              FurringInsulLayer  != 100401 .AND. FurringInsulLayer  > 0) .OR. FurringLayer  > 0) then  NumLayerMats + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-5"		Cons:NumLayerMats = {	if (OtherSideFinishLayer > 0.1) then                                                          NumLayerMats + 1  else  UNCHANGED  endif  }

; SAC 6/4/14 - added properties to be reported on CF1R
   "Set Cons:NumLayersRpt"		Cons:NumLayersRpt	= {	NumLayerMats  }
   "Set Cons:FramingRpt"		Cons:FramingRpt	= {	" "  }
   "Set Cons:CavityRRpt"		Cons:CavityRRpt	= {	" "  }

	; Mapping of this Index to Cons Properties:	1 =>	InsideFinishLayer 
	;															2 =>	FurringInsul2Layer // Furring2Layer
	;															3 =>	MassLayer  //  MassThickness
	;															4 =>	FurringInsulLayer // FurringLayer  
	;															5 =>	OtherSideFinishLayer
	"Set Cons:FrameLayerMapIdx[1]"		Cons:FrameLayerMapIdx[1]   = {	2  }	; index of (possible) Cavity layers in mapping listed above
	"Set Cons:FrameLayerMapIdx[2]"		Cons:FrameLayerMapIdx[2]   = {	4  }
	"Set Cons:AbvJoistInsLyrMapIdx"		Cons:AbvJoistInsLyrMapIdx  = {	0  }	; index of insulation above ceiling joists layer in mapping listed above
	"Set Cons:BlwJoistInsLyrMapIdx"		Cons:BlwJoistInsLyrMapIdx  = {	0  }	; index of insulation below roof joists layer in mapping listed above
	"Set Cons:LayerPropertyIndex[1]"		Cons:LayerPropertyIndex[1] = {		  if (InsideFinishLayer  > 0.1) then  1
																								else if (((FurringInsul2Layer != 900 .OR. IfValidAnd( FurringInsul2LayerRVal > 0 )) .AND.
                                                                                  FurringInsul2Layer != 100401 .AND. FurringInsul2Layer > 0) .OR. Furring2Layer > 0) then  2
	                                                                     else  3  endif endif  }		; assumption here is that we will ALWAYS have a Mass/Adobe/... layer
	"Set Cons:LayerPropertyIndex[2]"		Cons:LayerPropertyIndex[2] = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :		  if (((FurringInsul2Layer != 900 .OR. IfValidAnd( FurringInsul2LayerRVal > 0 )) .AND.
                                                                                                 FurringInsul2Layer != 100401 .AND. FurringInsul2Layer > 0) .OR. Furring2Layer > 0) then  2
	                                                                     					else  3  endif
																									case  2 :      	3
																									case  3 :	if (((FurringInsulLayer != 900 .OR. IfValidAnd( FurringInsulLayerRVal > 0 )) .AND.
                                                                                            FurringInsulLayer  != 100401 .AND. FurringInsulLayer  > 0) .OR. FurringLayer  > 0) then  4
	                                                                     					else if (OtherSideFinishLayer > 0.1) then  5  else  0  endif endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[3]"		Cons:LayerPropertyIndex[3] = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	3
																									case  3 :	if (((FurringInsulLayer != 900 .OR. IfValidAnd( FurringInsulLayerRVal > 0 )) .AND.
                                                                                            FurringInsulLayer  != 100401 .AND. FurringInsulLayer  > 0) .OR. FurringLayer  > 0) then  4
	                                                                     					else if (OtherSideFinishLayer > 0.1) then  5  else  0  endif endif
																									case  4 :	if (OtherSideFinishLayer > 0.1) then  5  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[4]"		Cons:LayerPropertyIndex[4] = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	if (((FurringInsulLayer != 900 .OR. IfValidAnd( FurringInsulLayerRVal > 0 )) .AND.
                                                                                            FurringInsulLayer  != 100401 .AND. FurringInsulLayer  > 0) .OR. FurringLayer  > 0) then  4
	                                                                     					else if (OtherSideFinishLayer > 0.1) then  5  else  0  endif endif
																									case  4 :	if (OtherSideFinishLayer > 0.1) then  5  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[5]"		Cons:LayerPropertyIndex[5] = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	if (OtherSideFinishLayer > 0.1) then  5  else  0  endif
																									default :   0
																								endswitch  }

  ; assume 1" thickness of cavity insul (regardless of R-value)
;	"Set Cons:CavityMatCondQII[1]"		Cons:CavityMatCondQII[1]	= {	if (LayerPropertyIndex[1] == 2)
;																								then	if (IfValidAnd( Proj:ICQEnclCavInsMult > 0 ) .AND.
;																						 					 IfValidAnd(  FurringInsul2Layer > 0 ) .AND. IfValidAnd( FurringInsul2Layer < 200 ))
;																										then  (1/12) / ( FurringInsul2Layer * Proj:ICQEnclCavInsMult )
;																										else  0  endif
;																								else  0  endif  }
; SAC 3/27/14 - revised rules to DISREGARD Proj:ICQEnclCavInsMult when setting CavityMatCondQII[*] for mass walls (GC issue #290)
;					debugging
;						"log Cons data"	Cons:Action	= {	if (LayerPropertyIndex[1] != 2 .AND. LayerPropertyIndex[2] != 2 .AND. (IfValidAnd( FurringInsul2Layer > 0 )==0 .OR. IfValidAnd( FurringInsul2Layer < 200 )==0)) then  UNCHANGED
;																		else  PostMessageToLog( "Setting Cons:CavityMatCond* for Insul2Layer for '%s':  FurringInsul2Layer = %g / Furring2Layer = %g", Name, FurringInsul2Layer, Furring2Layer )  endif  }
;						"log Cons data"	Cons:Action	= {	if (LayerPropertyIndex[2] != 4 .AND. LayerPropertyIndex[3] != 4 .AND. LayerPropertyIndex[4] != 4 .AND. (IfValidAnd( FurringInsulLayer > 0 )==0 .OR. IfValidAnd( FurringInsulLayer < 200 )==0)) then  UNCHANGED
;																		else  PostMessageToLog( "Setting Cons:CavityMatCond* for InsulLayer for '%s':  FurringInsulLayer = %g / FurringLayer = %g", Name, FurringInsulLayer, FurringLayer )  endif  }
; SAC 11/22/14 - modified logic to take into account thickness of furring layer when calculating Cons:CavityMatCond*[*] (previous ver assumed 1" always) (GC issue #423)
; SAC 4/28/15 - added logic to address case where FurringInsul*Layer = 100401 => no insulation (issue 491)
; SAC 5/12/17 - added logic accommodating user-specified insul/furring R-value
	"Set Cons:CavityMatCondQII[1]"		Cons:CavityMatCondQII[1]	= {	if (LayerPropertyIndex[1] == 2)
																								then	if (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal > 0 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2LayerRVal
																												else	                              (1 / 12) /  FurringInsul2LayerRVal    endif
																										else if (IfValidAnd( FurringInsul2Layer > 0 ) .AND. IfValidAnd( FurringInsul2Layer < 200 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2Layer
																												else	                              (1 / 12) /  FurringInsul2Layer    endif
																										else if (IfValidAnd( FurringInsul2Layer = 100401 ) .OR. (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal = 0 )))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  0.92
																												else	                              (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif  }
	"Set Cons:CavityMatCondQII[2]"		Cons:CavityMatCondQII[2]	= {	if (LayerPropertyIndex[2] == 2)
																								then	if (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal > 0 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2LayerRVal
																												else	                              (1 / 12) /  FurringInsul2LayerRVal    endif
																										else if (IfValidAnd( FurringInsul2Layer > 0 ) .AND. IfValidAnd( FurringInsul2Layer < 200 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2Layer
																												else	                              (1 / 12) /  FurringInsul2Layer    endif
																										else if (IfValidAnd( FurringInsul2Layer = 100401 ) .OR. (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal = 0 )))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  0.92
																												else	                              (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else if (LayerPropertyIndex[2] == 4)
																								then	if (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal > 0 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayerRVal
																												else	                             (1 / 12) /  FurringInsulLayerRVal    endif
																										else if (IfValidAnd( FurringInsulLayer > 0 ) .AND. IfValidAnd( FurringInsulLayer < 200 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayer
																												else	                             (1 / 12) /  FurringInsulLayer    endif
																										else if (IfValidAnd( FurringInsulLayer = 100401 ) .OR. (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal = 0 )))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  0.92
																												else	                             (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif endif  }
	"Set Cons:CavityMatCondQII[3]"		Cons:CavityMatCondQII[3]	= {	if (LayerPropertyIndex[3] == 4)
																								then	if (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal > 0 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayerRVal
																												else	                             (1 / 12) /  FurringInsulLayerRVal    endif
																										else if (IfValidAnd( FurringInsulLayer > 0 ) .AND. IfValidAnd( FurringInsulLayer < 200 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayer
																												else	                             (1 / 12) /  FurringInsulLayer    endif
																										else if (IfValidAnd( FurringInsulLayer = 100401 ) .OR. (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal = 0 )))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  0.92
																												else	                             (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif  }
	"Set Cons:CavityMatCondQII[4]"		Cons:CavityMatCondQII[4]	= {	if (LayerPropertyIndex[4] == 4)
																								then	if (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal > 0 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayerRVal
																												else	                             (1 / 12) /  FurringInsulLayerRVal    endif
																										else if (IfValidAnd( FurringInsulLayer > 0 ) .AND. IfValidAnd( FurringInsulLayer < 200 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayer
																												else	                             (1 / 12) /  FurringInsulLayer    endif
																										else if (IfValidAnd( FurringInsulLayer = 100401 ) .OR. (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal = 0 )))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  0.92
																												else	                             (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif  }
	"Set Cons:CavityMatCondQII[5]"		Cons:CavityMatCondQII[5]	= {	0  }
	"Set Cons:CavityMatCondQII[6]"		Cons:CavityMatCondQII[6]	= {	0  }
	"Set Cons:CavityMatCondQII[7]"		Cons:CavityMatCondQII[7]	= {	0  }
	"Set Cons:CavityMatCondQII[8]"		Cons:CavityMatCondQII[8]	= {	0  }

	"Set Cons:CavityMatCond[1]"			Cons:CavityMatCond[1]		= {	if (LayerPropertyIndex[1] == 2)
																								then	if (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal > 0 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2LayerRVal
																												else	                              (1 / 12) /  FurringInsul2LayerRVal    endif
																										else if (IfValidAnd( FurringInsul2Layer > 0 ) .AND. IfValidAnd( FurringInsul2Layer < 200 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2Layer
																												else	                              (1 / 12) /  FurringInsul2Layer    endif
																										else if (IfValidAnd( FurringInsul2Layer = 100401 ) .OR. (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal = 0 )))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  0.92
																												else	                              (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif  }
	"Set Cons:CavityMatCond[2]"			Cons:CavityMatCond[2]		= {	if (LayerPropertyIndex[2] == 2)
																								then	if (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal > 0 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2LayerRVal
																												else	                              (1 / 12) /  FurringInsul2LayerRVal    endif
																										else if (IfValidAnd( FurringInsul2Layer > 0 ) .AND. IfValidAnd( FurringInsul2Layer < 200 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2Layer
																												else	                              (1 / 12) /  FurringInsul2Layer    endif
																										else if (IfValidAnd( FurringInsul2Layer = 100401 ) .OR. (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal = 0 )))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  0.92
																												else	                              (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else if (LayerPropertyIndex[2] == 4)
																								then	if (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal > 0 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayerRVal
																												else	                             (1 / 12) /  FurringInsulLayerRVal    endif
																										else if (IfValidAnd( FurringInsulLayer > 0 ) .AND. IfValidAnd( FurringInsulLayer < 200 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayer
																												else	                             (1 / 12) /  FurringInsulLayer    endif
																										else if (IfValidAnd( FurringInsulLayer = 100401 ) .OR. (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal = 0 )))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  0.92
																												else	                             (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif endif  }
	"Set Cons:CavityMatCond[3]"			Cons:CavityMatCond[3]		= {	if (LayerPropertyIndex[3] == 4)
																								then	if (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal > 0 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayerRVal
																												else	                             (1 / 12) /  FurringInsulLayerRVal    endif
																										else if (IfValidAnd( FurringInsulLayer > 0 ) .AND. IfValidAnd( FurringInsulLayer < 200 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayer
																												else	                             (1 / 12) /  FurringInsulLayer    endif
																										else if (IfValidAnd( FurringInsulLayer = 100401 ) .OR. (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal = 0 )))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  0.92
																												else	                             (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif  }
	"Set Cons:CavityMatCond[4]"			Cons:CavityMatCond[4]		= {	if (LayerPropertyIndex[4] == 4)
																								then	if (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal > 0 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayerRVal
																												else	                             (1 / 12) /  FurringInsulLayerRVal    endif
																										else if (IfValidAnd( FurringInsulLayer > 0 ) .AND. IfValidAnd( FurringInsulLayer < 200 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayer
																												else	                             (1 / 12) /  FurringInsulLayer    endif
																										else if (IfValidAnd( FurringInsulLayer = 100401 ) .OR. (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal = 0 )))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  0.92
																												else	                             (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif  }
	"Set Cons:CavityMatCond[5]"			Cons:CavityMatCond[5]		= {	0  }
	"Set Cons:CavityMatCond[6]"			Cons:CavityMatCond[6]		= {	0  }
	"Set Cons:CavityMatCond[7]"			Cons:CavityMatCond[7]		= {	0  }
	"Set Cons:CavityMatCond[8]"			Cons:CavityMatCond[8]		= {	0  }

; SAC 4/28/15 - mods to set CavityLayerSymVal[*] to 0 for FurringInsul*Layer = no insul...
	"Set Cons:CavityLayerSymVal[1]"		Cons:CavityLayerSymVal[1]   = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	InsideFinishLayer  
																									case  2 :	if (FurringInsul2Layer == 100401)
																													then	0
																													else	FurringInsul2Layer  endif 
																									case  3 :	if (MassLayer < 10000)
																													then	(MassLayer * 100) + MassThickness
																													else	 MassLayer   endif
																									default : 0
																								endswitch  }
	"Set Cons:CavityLayerSymVal[2]"		Cons:CavityLayerSymVal[2]   = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	if (FurringInsul2Layer == 100401)
																													then	0
																													else	FurringInsul2Layer  endif 
																									case  3 :	if (MassLayer < 10000)
																													then	(MassLayer * 100) + MassThickness
																													else	 MassLayer   endif          
																									case  4 :	if (FurringInsulLayer == 100401)
																													then	0
																													else	FurringInsulLayer  endif  
																									default : 0
																								endswitch  }
	"Set Cons:CavityLayerSymVal[3]"		Cons:CavityLayerSymVal[3]   = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	if (MassLayer < 10000)
																													then	(MassLayer * 100) + MassThickness
																													else	 MassLayer   endif          
																									case  4 :	if (FurringInsulLayer == 100401)
																													then	0
																													else	FurringInsulLayer  endif  
																									case  5 :	OtherSideFinishLayer 
																									default : 0
																								endswitch  }
	"Set Cons:CavityLayerSymVal[4]"		Cons:CavityLayerSymVal[4]   = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	if (FurringInsulLayer == 100401)
																													then	0
																													else	FurringInsulLayer  endif  
																									case  5 :	OtherSideFinishLayer 
																									default : 0
																								endswitch  }
	"Set Cons:CavityLayerSymVal[5]"		Cons:CavityLayerSymVal[5]   = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :	OtherSideFinishLayer
																									default : 0
																								endswitch  }

	"Set Cons:FrameLayerSymVal[1]"		Cons:FrameLayerSymVal[1]  = {		switch (Local( LayerPropertyIndex[1] ))
																									case  2 :	Furring2Layer 
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[2]"		Cons:FrameLayerSymVal[2]  = {		switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	Furring2Layer 
																									case  4 :	FurringLayer  
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[3]"		Cons:FrameLayerSymVal[3]  = {		switch (Local( LayerPropertyIndex[3] ))
																									case  4 :	FurringLayer  
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[4]"		Cons:FrameLayerSymVal[4]  = {		switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	FurringLayer  
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[5]"		Cons:FrameLayerSymVal[5]  = {	0  }

   ; SAC 5/11/17 - related to user-defined furring insulation r-value
   "Set Cons:LayerUsrInpInsRVal[1]"    Cons:LayerUsrInpInsRVal[1]  = {
         if (LayerPropertyIndex[1] == 2 .AND. FurringInsul2Layer == 900)
         then  FurringInsul2LayerRVal
         else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[2]"    Cons:LayerUsrInpInsRVal[2]  = {
         if (LayerPropertyIndex[2] == 2 .AND. FurringInsul2Layer == 900)
         then  FurringInsul2LayerRVal
         else if (LayerPropertyIndex[2] == 4 .AND. FurringInsulLayer == 900)
         then  FurringInsulLayerRVal
         else  UNDEFINED  endif endif  }
   "Set Cons:LayerUsrInpInsRVal[3]"    Cons:LayerUsrInpInsRVal[3]  = {
         if (LayerPropertyIndex[3] == 4 .AND. FurringInsulLayer == 900)
         then  FurringInsulLayerRVal
         else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[4]"    Cons:LayerUsrInpInsRVal[4]  = {
         if (LayerPropertyIndex[4] == 4 .AND. FurringInsulLayer == 900)
         then  FurringInsulLayerRVal
         else  UNDEFINED  endif  }
   "Init Cons:LayerUsrInpInsRVal[5]"   Cons:LayerUsrInpInsRVal[5]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[8]"   Cons:LayerUsrInpInsRVal[8]  = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[6]"   Cons:LayerUsrInpInsRVal[6]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[9]"   Cons:LayerUsrInpInsRVal[9]  = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[7]"   Cons:LayerUsrInpInsRVal[7]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[10]"  Cons:LayerUsrInpInsRVal[10] = {  UNDEFINED  }

; SAC 6/4/14 - added properties to be reported on CF1R
	"Set Cons:AssemblyLayersRpt[1]"		Cons:AssemblyLayersRpt[1]   = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	Format( "%s %s",      LayerLabels[1], EnumString( InsideFinishLayer     ))
																									case  2 :	Format( "%s %s / %s", LayerLabels[2], EnumString( FurringInsul2LayerStr ), EnumString( Furring2LayerAbr )) 
																									case  3 :	Format( "%s %s %s",   LayerLabels[3], EnumString( MassThickness         ), EnumString( MassLayer ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[2]"		Cons:AssemblyLayersRpt[2]   = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	Format( "%s %s / %s", LayerLabels[2], EnumString( FurringInsul2LayerStr ), EnumString( Furring2LayerAbr )) 
																									case  3 :	Format( "%s %s %s",   LayerLabels[3], EnumString( MassThickness         ), EnumString( MassLayer ))        
																									case  4 :	Format( "%s %s / %s", LayerLabels[4], EnumString( FurringInsulLayerStr  ), EnumString( FurringLayerAbr )) 
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[3]"		Cons:AssemblyLayersRpt[3]   = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	Format( "%s %s %s",   LayerLabels[3], EnumString( MassThickness         ), EnumString( MassLayer ))        
																									case  4 :	Format( "%s %s / %s", LayerLabels[4], EnumString( FurringInsulLayerStr  ), EnumString( FurringLayerAbr ))  
																									case  5 :	Format( "%s %s",      LayerLabels[5], EnumString( OtherSideFinishLayer  ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[4]"		Cons:AssemblyLayersRpt[4]   = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	Format( "%s %s / %s", LayerLabels[4], EnumString( FurringInsulLayerStr  ), EnumString( FurringLayerAbr ))  
																									case  5 :	Format( "%s %s",      LayerLabels[5], EnumString( OtherSideFinishLayer  )) 
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[5]"		Cons:AssemblyLayersRpt[5]   = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :	Format( "%s %s",      LayerLabels[5], EnumString( OtherSideFinishLayer  )) 
																									default : UNDEFINED
																								endswitch  }
	"Blast Cons:AssemblyLayersRpt[6]"	Cons:AssemblyLayersRpt[6]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[7]"	Cons:AssemblyLayersRpt[7]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[8]"	Cons:AssemblyLayersRpt[8]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[9]"	Cons:AssemblyLayersRpt[9]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[10]"	Cons:AssemblyLayersRpt[10]  = {	UNDEFINED  }


;	"Set Cons:FrameSpacing"	; SAC 2/14/12 - moved from ExtWall to facilitate wall splitting
;		Cons:FrameSpacing		= {	if (Local( Type ) == 0 .OR. Local( Type ) == 1)		; "Wood Framed Wall" or "Steel Framed Wall"
;											then	if (Local( FrameLayer ) > 0)
;													then  mod( Local( FrameLayer ), 100 )
;													else  16		; no frame layer specified, so use generic default (??)
;													endif
;											else	0				; NOT wood or steel framed, so no frame spacing used/valid (??)
;											endif  }
;
	"Set Cons:FramingFactor => fraction of gross surface area that includes frame" 
		Cons:FramingFactor	= {	0  }
	"Set Cons:PathFraction[1]"			Cons:PathFraction[1]	= {	1  }		; SAC 3/17/14
	"Set Cons:PathFraction[2]"			Cons:PathFraction[2]	= {	0  }


; SAC 2/27/14 - now initialized in prior rulelist
;	"Init Cons:FrameCodeRValue"		Cons:FrameCodeRValue  = {	0.68 + 0.68  }   ; inside film coeff. for ext walls (x2 for each side)

	"Remaining construction, R-val & U-val calcs"	Cons:Action = {	EvalRulelist( "SetupCons_SinglePath", 1 )  }

;	"Set Cons:CodeMaximumUValue"		Cons:CodeMaximumUValue	= {	if (Global( Proj:ClimateZone ) < 0.5) then  -1
;																						else  ClimateZoneTable( Global( Proj:ClimateZone ), 6 ) + 0.00049  endif  }  ; SAC 2/13/13 - added 0.00049 to allow for check taking into account rounding
;
;	"Set Cons:CodeUValueLabel"			Cons:CodeUValueLabel		= {	if (Local( CodeMaximumUValue ) < 0) then  " "    ; no message - nothing to report
;																						else if (Local( CodeMaximumUValue ) < Local( OverallCodeUValue ))
;																						then  Format( "(doesn't meet max code %.3f U-value (%.3f))", Local( CodeMaximumUValue ), Local( OverallCodeUValue ) )
;																						else  Format( "(meets max code %.3f U-value (%.3f))", Local( CodeMaximumUValue ), Local( OverallCodeUValue ) )
;																						endif endif  }
END

;*************************************************************************
RULELIST "SetupCons_UndWall_SinglePath"         0 0 0 1
;*************************************************************************
; INSIDE to OUTSIDE

	"Set Cons:FrameCavityLayerMat[1]"	Cons:FrameCavityLayerMat[1]	= {	if (Furring2Layer < 1 .AND. (FurringInsul2Layer < 1 .OR. FurringInsul2Layer == 100401 .OR.
                                                                                       (FurringInsul2Layer == 900 .AND. IfValidAnd( FurringInsul2LayerRVal > 0 )==0))) then  0
																									else if (InsideFinishLayer > 0.1) then  2
																									else  1  endif endif  }
	"Set Cons:FrameCavityLayerMat[2]"	Cons:FrameCavityLayerMat[2]	= {	if (FurringLayer < 1 .AND. (FurringInsulLayer < 1 .OR. FurringInsulLayer == 100401 .OR.
                                                                                      (FurringInsulLayer == 900 .AND. IfValidAnd( FurringInsulLayerRVal > 0 )==0))) then  0
																									else if (InsideFinishLayer > 0.1 .AND. FrameCavityLayerMat[1] > 0) then  4
																									else if (InsideFinishLayer > 0.1 .OR.  FrameCavityLayerMat[1] > 0) then  3
																									else  2  endif endif endif  }

	"Set Cons:NumLayerMats-1"		Cons:NumLayerMats = {	if (InsideFinishLayer  > 0.1) then  1  else  0  endif  }
	"Set Cons:NumLayerMats-2"		Cons:NumLayerMats = {	if (((FurringInsul2Layer != 900 .OR. IfValidAnd( FurringInsul2LayerRVal > 0 )) .AND.
                                                              FurringInsul2Layer != 100401 .AND. FurringInsul2Layer > 0) .OR. Furring2Layer > 0) then  NumLayerMats + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-3"		Cons:NumLayerMats = {	NumLayerMats + 1  }		; assumption here is that we will ALWAYS have a Mass/Adobe/... layer
	"Set Cons:NumLayerMats-4"		Cons:NumLayerMats = {	if (((FurringInsulLayer  != 900 .OR. IfValidAnd( FurringInsulLayerRVal  > 0 )) .AND.
                                                              FurringInsulLayer  != 100401 .AND. FurringInsulLayer  > 0) .OR. FurringLayer  > 0) then  NumLayerMats + 1  else  UNCHANGED  endif  }
;	"Set Cons:NumLayerMats-5"		Cons:NumLayerMats = {	if (WallExtFinishLayer > 0.1) then                                                            NumLayerMats + 1  else  UNCHANGED  endif  }

; SAC 6/4/14 - added properties to be reported on CF1R
   "Set Cons:NumLayersRpt"		Cons:NumLayersRpt	= {	NumLayerMats  }
   "Set Cons:FramingRpt"		Cons:FramingRpt	= {	" "  }
   "Set Cons:CavityRRpt"		Cons:CavityRRpt	= {	" "  }

	; Mapping of this Index to Cons Properties:	1 =>	InsideFinishLayer 
	;															2 =>	FurringInsul2Layer // Furring2Layer
	;															3 =>	MassLayer  //  MassThickness
	;															4 =>	FurringInsulLayer // FurringLayer  
	"Set Cons:FrameLayerMapIdx[1]"		Cons:FrameLayerMapIdx[1]   = {	2  }	; index of (possible) Cavity layers in mapping listed above
	"Set Cons:FrameLayerMapIdx[2]"		Cons:FrameLayerMapIdx[2]   = {	4  }
	"Set Cons:AbvJoistInsLyrMapIdx"		Cons:AbvJoistInsLyrMapIdx  = {	0  }	; index of insulation above ceiling joists layer in mapping listed above
	"Set Cons:BlwJoistInsLyrMapIdx"		Cons:BlwJoistInsLyrMapIdx  = {	0  }	; index of insulation below roof joists layer in mapping listed above
	"Set Cons:LayerPropertyIndex[1]"		Cons:LayerPropertyIndex[1] = {		  if (InsideFinishLayer  > 0.1) then  1
																								else if (((FurringInsul2Layer != 900 .OR. IfValidAnd( FurringInsul2LayerRVal > 0 )) .AND.
                                                                                  FurringInsul2Layer != 100401 .AND. FurringInsul2Layer > 0) .OR. Furring2Layer > 0) then  2
	                                                                     else  3  endif endif  }		; assumption here is that we will ALWAYS have a Mass/Adobe/... layer
	"Set Cons:LayerPropertyIndex[2]"		Cons:LayerPropertyIndex[2] = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :		  if (((FurringInsul2Layer != 900 .OR. IfValidAnd( FurringInsul2LayerRVal > 0 )) .AND.
                                                                                                 FurringInsul2Layer != 100401 .AND. FurringInsul2Layer > 0) .OR. Furring2Layer > 0) then  2
	                                                                     					else  3  endif
																									case  2 :      	3
																									case  3 :	if (((FurringInsulLayer != 900 .OR. IfValidAnd( FurringInsulLayerRVal > 0 )) .AND.
                                                                                            FurringInsulLayer  != 100401 .AND. FurringInsulLayer  > 0) .OR. FurringLayer  > 0) then  4  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[3]"		Cons:LayerPropertyIndex[3] = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	3
																									case  3 :	if (((FurringInsulLayer != 900 .OR. IfValidAnd( FurringInsulLayerRVal > 0 )) .AND.
                                                                                            FurringInsulLayer  != 100401 .AND. FurringInsulLayer  > 0) .OR. FurringLayer  > 0) then  4  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[4]"		Cons:LayerPropertyIndex[4] = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	if (((FurringInsulLayer != 900 .OR. IfValidAnd( FurringInsulLayerRVal > 0 )) .AND.
                                                                                            FurringInsulLayer  != 100401 .AND. FurringInsulLayer  > 0) .OR. FurringLayer  > 0) then  4  else  0  endif
																									default :   0
																								endswitch  }

  ; assume 1" thickness of cavity insul (regardless of R-value)
;	"Set Cons:CavityMatCondQII[1]"		Cons:CavityMatCondQII[1]	= {	if (LayerPropertyIndex[1] == 2)
;																								then	if (IfValidAnd( Proj:ICQEnclCavInsMult > 0 ) .AND.
;																						 					 IfValidAnd(  FurringInsul2Layer > 0 ) .AND. IfValidAnd( FurringInsul2Layer < 200 ))
;																										then  (1/12) / ( FurringInsul2Layer * Proj:ICQEnclCavInsMult )
;																										else  0  endif
;																								else  0  endif  }
; SAC 3/27/14 - revised rules to DISREGARD Proj:ICQEnclCavInsMult when setting CavityMatCondQII[*] for mass walls (GC issue #290)
;					debugging
;						"log Cons data"	Cons:Action	= {	if (LayerPropertyIndex[1] != 2 .AND. LayerPropertyIndex[2] != 2 .AND. (IfValidAnd( FurringInsul2Layer > 0 )==0 .OR. IfValidAnd( FurringInsul2Layer < 200 )==0)) then  UNCHANGED
;																		else  PostMessageToLog( "Setting Cons:CavityMatCond* for Insul2Layer for '%s':  FurringInsul2Layer = %g / Furring2Layer = %g", Name, FurringInsul2Layer, Furring2Layer )  endif  }
;						"log Cons data"	Cons:Action	= {	if (LayerPropertyIndex[2] != 4 .AND. LayerPropertyIndex[3] != 4 .AND. LayerPropertyIndex[4] != 4 .AND. (IfValidAnd( FurringInsulLayer > 0 )==0 .OR. IfValidAnd( FurringInsulLayer < 200 )==0)) then  UNCHANGED
;																		else  PostMessageToLog( "Setting Cons:CavityMatCond* for InsulLayer for '%s':  FurringInsulLayer = %g / FurringLayer = %g", Name, FurringInsulLayer, FurringLayer )  endif  }
; SAC 11/22/14 - modified logic to take into account thickness of furring layer when calculating Cons:CavityMatCond*[*] (previous ver assumed 1" always) (GC issue #423)
; SAC 4/28/15 - added logic to address case where FurringInsul*Layer = 100401 => no insulation (issue 491)
; SAC 5/12/17 - added logic accommodating user-specified insul/furring R-value
	"Set Cons:CavityMatCondQII[1]"		Cons:CavityMatCondQII[1]	= {	if (LayerPropertyIndex[1] == 2)
																								then	if (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal > 0 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2LayerRVal
																												else	                              (1 / 12) /  FurringInsul2LayerRVal    endif
																										else if (IfValidAnd( FurringInsul2Layer > 0 ) .AND. IfValidAnd( FurringInsul2Layer < 200 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2Layer
																												else	                              (1 / 12) /  FurringInsul2Layer    endif
																										else if (IfValidAnd( FurringInsul2Layer = 100401 ) .OR. (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal = 0 )))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  0.92
																												else	                              (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif  }
	"Set Cons:CavityMatCondQII[2]"		Cons:CavityMatCondQII[2]	= {	if (LayerPropertyIndex[2] == 2)
																								then	if (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal > 0 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2LayerRVal
																												else	                              (1 / 12) /  FurringInsul2LayerRVal    endif
																										else if (IfValidAnd( FurringInsul2Layer > 0 ) .AND. IfValidAnd( FurringInsul2Layer < 200 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2Layer
																												else	                              (1 / 12) /  FurringInsul2Layer    endif
																										else if (IfValidAnd( FurringInsul2Layer = 100401 ) .OR. (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal = 0 )))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  0.92
																												else	                              (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else if (LayerPropertyIndex[2] == 4)
																								then	if (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal > 0 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayerRVal
																												else	                             (1 / 12) /  FurringInsulLayerRVal    endif
																										else if (IfValidAnd( FurringInsulLayer > 0 ) .AND. IfValidAnd( FurringInsulLayer < 200 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayer
																												else	                             (1 / 12) /  FurringInsulLayer    endif
																										else if (IfValidAnd( FurringInsulLayer = 100401 ) .OR. (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal = 0 )))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  0.92
																												else	                             (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif endif  }
	"Set Cons:CavityMatCondQII[3]"		Cons:CavityMatCondQII[3]	= {	if (LayerPropertyIndex[3] == 4)
																								then	if (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal > 0 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayerRVal
																												else	                             (1 / 12) /  FurringInsulLayerRVal    endif
																										else if (IfValidAnd( FurringInsulLayer > 0 ) .AND. IfValidAnd( FurringInsulLayer < 200 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayer
																												else	                             (1 / 12) /  FurringInsulLayer    endif
																										else if (IfValidAnd( FurringInsulLayer = 100401 ) .OR. (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal = 0 )))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  0.92
																												else	                             (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif  }
	"Set Cons:CavityMatCondQII[4]"		Cons:CavityMatCondQII[4]	= {	if (LayerPropertyIndex[4] == 4)
																								then	if (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal > 0 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayerRVal
																												else	                             (1 / 12) /  FurringInsulLayerRVal    endif
																										else if (IfValidAnd( FurringInsulLayer > 0 ) .AND. IfValidAnd( FurringInsulLayer < 200 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayer
																												else	                             (1 / 12) /  FurringInsulLayer    endif
																										else if (IfValidAnd( FurringInsulLayer = 100401 ) .OR. (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal = 0 )))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  0.92
																												else	                             (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif  }
	"Set Cons:CavityMatCondQII[5]"		Cons:CavityMatCondQII[5]	= {	0  }
	"Set Cons:CavityMatCondQII[6]"		Cons:CavityMatCondQII[6]	= {	0  }
	"Set Cons:CavityMatCondQII[7]"		Cons:CavityMatCondQII[7]	= {	0  }
	"Set Cons:CavityMatCondQII[8]"		Cons:CavityMatCondQII[8]	= {	0  }
	"Set Cons:CavityMatCond[1]"			Cons:CavityMatCond[1]		= {	if (LayerPropertyIndex[1] == 2)
																								then	if (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal > 0 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2LayerRVal
																												else	                              (1 / 12) /  FurringInsul2LayerRVal    endif
																										else if (IfValidAnd( FurringInsul2Layer > 0 ) .AND. IfValidAnd( FurringInsul2Layer < 200 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2Layer
																												else	                              (1 / 12) /  FurringInsul2Layer    endif
																										else if (IfValidAnd( FurringInsul2Layer = 100401 ) .OR. (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal = 0 )))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  0.92
																												else	                              (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif  }
	"Set Cons:CavityMatCond[2]"			Cons:CavityMatCond[2]		= {	if (LayerPropertyIndex[2] == 2)
																								then	if (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal > 0 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2LayerRVal
																												else	                              (1 / 12) /  FurringInsul2LayerRVal    endif
																										else if (IfValidAnd( FurringInsul2Layer > 0 ) .AND. IfValidAnd( FurringInsul2Layer < 200 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2Layer
																												else	                              (1 / 12) /  FurringInsul2Layer    endif
																										else if (IfValidAnd( FurringInsul2Layer = 100401 ) .OR. (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal = 0 )))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  0.92
																												else	                              (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else if (LayerPropertyIndex[2] == 4)
																								then	if (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal > 0 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayerRVal
																												else	                             (1 / 12) /  FurringInsulLayerRVal    endif
																										else if (IfValidAnd( FurringInsulLayer > 0 ) .AND. IfValidAnd( FurringInsulLayer < 200 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayer
																												else	                             (1 / 12) /  FurringInsulLayer    endif
																										else if (IfValidAnd( FurringInsulLayer = 100401 ) .OR. (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal = 0 )))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  0.92
																												else	                             (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif endif  }
	"Set Cons:CavityMatCond[3]"			Cons:CavityMatCond[3]		= {	if (LayerPropertyIndex[3] == 4)
																								then	if (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal > 0 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayerRVal
																												else	                             (1 / 12) /  FurringInsulLayerRVal    endif
																										else if (IfValidAnd( FurringInsulLayer > 0 ) .AND. IfValidAnd( FurringInsulLayer < 200 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayer
																												else	                             (1 / 12) /  FurringInsulLayer    endif
																										else if (IfValidAnd( FurringInsulLayer = 100401 ) .OR. (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal = 0 )))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  0.92
																												else	                             (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif  }
	"Set Cons:CavityMatCond[4]"			Cons:CavityMatCond[4]		= {	if (LayerPropertyIndex[4] == 4)
																								then	if (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal > 0 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayerRVal
																												else	                             (1 / 12) /  FurringInsulLayerRVal    endif
																										else if (IfValidAnd( FurringInsulLayer > 0 ) .AND. IfValidAnd( FurringInsulLayer < 200 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayer
																												else	                             (1 / 12) /  FurringInsulLayer    endif
																										else if (IfValidAnd( FurringInsulLayer = 100401 ) .OR. (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal = 0 )))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  0.92
																												else	                             (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif  }
	"Set Cons:CavityMatCond[5]"			Cons:CavityMatCond[5]		= {	0  }
	"Set Cons:CavityMatCond[6]"			Cons:CavityMatCond[6]		= {	0  }
	"Set Cons:CavityMatCond[7]"			Cons:CavityMatCond[7]		= {	0  }
	"Set Cons:CavityMatCond[8]"			Cons:CavityMatCond[8]		= {	0  }

; SAC 4/28/15 - mods to set CavityLayerSymVal[*] to 0 for FurringInsul*Layer = no insul...
	"Set Cons:CavityLayerSymVal[1]"		Cons:CavityLayerSymVal[1]   = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	InsideFinishLayer  
																									case  2 :	if (FurringInsul2Layer == 100401)
																													then	0
																													else	FurringInsul2Layer  endif 
																									case  3 :	if (MassLayer < 10000)
																													then	(MassLayer * 100) + MassThickness
																													else	 MassLayer   endif
																									default : 0
																								endswitch  }
	"Set Cons:CavityLayerSymVal[2]"		Cons:CavityLayerSymVal[2]   = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	if (FurringInsul2Layer == 100401)
																													then	0
																													else	FurringInsul2Layer  endif 
																									case  3 :	if (MassLayer < 10000)
																													then	(MassLayer * 100) + MassThickness
																													else	 MassLayer   endif          
																									case  4 :	if (FurringInsulLayer == 100401)
																													then	0
																													else	FurringInsulLayer  endif  
																									default : 0
																								endswitch  }
	"Set Cons:CavityLayerSymVal[3]"		Cons:CavityLayerSymVal[3]   = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	if (MassLayer < 10000)
																													then	(MassLayer * 100) + MassThickness
																													else	 MassLayer   endif          
																									case  4 :	if (FurringInsulLayer == 100401)
																													then	0
																													else	FurringInsulLayer  endif  
																									default : 0
																								endswitch  }
	"Set Cons:CavityLayerSymVal[4]"		Cons:CavityLayerSymVal[4]   = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	if (FurringInsulLayer == 100401)
																													then	0
																													else	FurringInsulLayer  endif  
																									default : 0
																								endswitch  }

	"Set Cons:FrameLayerSymVal[1]"		Cons:FrameLayerSymVal[1]  = {		switch (Local( LayerPropertyIndex[1] ))
																									case  2 :	Furring2Layer 
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[2]"		Cons:FrameLayerSymVal[2]  = {		switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	Furring2Layer 
																									case  4 :	FurringLayer  
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[3]"		Cons:FrameLayerSymVal[3]  = {		switch (Local( LayerPropertyIndex[3] ))
																									case  4 :	FurringLayer  
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[4]"		Cons:FrameLayerSymVal[4]  = {		switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	FurringLayer  
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[5]"		Cons:FrameLayerSymVal[5]  = {	0  }

   ; SAC 5/11/17 - related to user-defined furring insulation r-value
   "Set Cons:LayerUsrInpInsRVal[1]"    Cons:LayerUsrInpInsRVal[1]  = {
         if (LayerPropertyIndex[1] == 2 .AND. FurringInsul2Layer == 900)
         then  FurringInsul2LayerRVal
         else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[2]"    Cons:LayerUsrInpInsRVal[2]  = {
         if (LayerPropertyIndex[2] == 2 .AND. FurringInsul2Layer == 900)
         then  FurringInsul2LayerRVal
         else if (LayerPropertyIndex[2] == 4 .AND. FurringInsulLayer == 900)
         then  FurringInsulLayerRVal
         else  UNDEFINED  endif endif  }
   "Set Cons:LayerUsrInpInsRVal[3]"    Cons:LayerUsrInpInsRVal[3]  = {
         if (LayerPropertyIndex[3] == 4 .AND. FurringInsulLayer == 900)
         then  FurringInsulLayerRVal
         else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[4]"    Cons:LayerUsrInpInsRVal[4]  = {
         if (LayerPropertyIndex[4] == 4 .AND. FurringInsulLayer == 900)
         then  FurringInsulLayerRVal
         else  UNDEFINED  endif  }
   "Init Cons:LayerUsrInpInsRVal[5]"   Cons:LayerUsrInpInsRVal[5]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[8]"   Cons:LayerUsrInpInsRVal[8]  = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[6]"   Cons:LayerUsrInpInsRVal[6]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[9]"   Cons:LayerUsrInpInsRVal[9]  = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[7]"   Cons:LayerUsrInpInsRVal[7]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[10]"  Cons:LayerUsrInpInsRVal[10] = {  UNDEFINED  }

; SAC 6/4/14 - added properties to be reported on CF1R
	"Set Cons:AssemblyLayersRpt[1]"		Cons:AssemblyLayersRpt[1]   = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	Format( "%s %s",      LayerLabels[1], EnumString( InsideFinishLayer     ))
																									case  2 :	Format( "%s %s / %s", LayerLabels[2], EnumString( FurringInsul2LayerStr ), EnumString( Furring2LayerAbr )) 
																									case  3 :	Format( "%s %s %s",   LayerLabels[3], EnumString( MassThickness         ), EnumString( MassLayer ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[2]"		Cons:AssemblyLayersRpt[2]   = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	Format( "%s %s / %s", LayerLabels[2], EnumString( FurringInsul2LayerStr ), EnumString( Furring2LayerAbr )) 
																									case  3 :	Format( "%s %s %s",   LayerLabels[3], EnumString( MassThickness         ), EnumString( MassLayer ))        
																									case  4 :	Format( "%s %s / %s", LayerLabels[4], EnumString( FurringInsulLayerStr  ), EnumString( FurringLayerAbr )) 
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[3]"		Cons:AssemblyLayersRpt[3]   = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	Format( "%s %s %s",   LayerLabels[3], EnumString( MassThickness         ), EnumString( MassLayer ))        
																									case  4 :	Format( "%s %s / %s", LayerLabels[4], EnumString( FurringInsulLayerStr  ), EnumString( FurringLayerAbr ))  
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[4]"		Cons:AssemblyLayersRpt[4]   = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	Format( "%s %s / %s", LayerLabels[4], EnumString( FurringInsulLayerStr  ), EnumString( FurringLayerAbr ))  
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[5]"		Cons:AssemblyLayersRpt[5]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[6]"	Cons:AssemblyLayersRpt[6]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[7]"	Cons:AssemblyLayersRpt[7]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[8]"	Cons:AssemblyLayersRpt[8]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[9]"	Cons:AssemblyLayersRpt[9]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[10]"	Cons:AssemblyLayersRpt[10]  = {	UNDEFINED  }

;	"Set Cons:FrameSpacing"	; SAC 2/14/12 - moved from ExtWall to facilitate wall splitting
;		Cons:FrameSpacing		= {	if (Local( Type ) == 0 .OR. Local( Type ) == 1)		; "Wood Framed Wall" or "Steel Framed Wall"
;											then	if (Local( FrameLayer ) > 0)
;													then  mod( Local( FrameLayer ), 100 )
;													else  16		; no frame layer specified, so use generic default (??)
;													endif
;											else	0				; NOT wood or steel framed, so no frame spacing used/valid (??)
;											endif  }
;
	"Set Cons:FramingFactor => fraction of gross surface area that includes frame" 
		Cons:FramingFactor	= {	0  }
	"Set Cons:PathFraction[1]"			Cons:PathFraction[1]	= {	1  }		; SAC 3/17/14
	"Set Cons:PathFraction[2]"			Cons:PathFraction[2]	= {	0  }


; SAC 2/27/14 - now initialized in prior rulelist
;	"Init Cons:CavityCodeRValue"		Cons:CavityCodeRValue  = {	0.17 + 0.68  }   ; inside and outside film coeff. consistent w/ both ASHRAE fundamentals & ACM JA4

	"Remaining construction, R-val & U-val calcs"	Cons:Action = {	EvalRulelist( "SetupCons_SinglePath", 1 )  }

; mjb 1/12/15 use new T24RClimateZoneCodeBase for code level lookups
	"Set Cons:CodeMaximumUValue"		Cons:CodeMaximumUValue	= {	if (Global( Proj:ClimateZone ) < 0.5) then  -1
;																						else  ClimateZoneTable( Global( Proj:ClimateZone ), 6 ) + 0.00049  endif  }  ; SAC 2/13/13 - added 0.00049 to allow for check taking into account rounding
																						else  T24RClimateZoneCodeBase:WallUval( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) + 0.00049  endif  }  ; SAC 2/13/13 - added 0.00049 to allow for check taking into account rounding

;	"Set Cons:CodeUValueLabel"			Cons:CodeUValueLabel		= {	if (Local( CodeMaximumUValue ) < 0) then  " "    ; no message - nothing to report
;																						else if (Local( CodeMaximumUValue ) < Local( OverallCodeUValue ))
;																						then  Format( "(doesn't meet max code %.3f U-value (%.3f))", Local( CodeMaximumUValue ), Local( OverallCodeUValue ) )
;																						else  Format( "(meets max code %.3f U-value (%.3f))", Local( CodeMaximumUValue ), Local( OverallCodeUValue ) )
;																						endif endif  }
END

;*************************************************************************
RULELIST "SetupCons_AtticRoof"         0 0 0 1
;*************************************************************************
; INSIDE to OUTSIDE
  ; SAC 6/15/17 - mods throughout to enable compressed insulation options for attic roof constructions (tic #761)

  ; SAC 8/1/14 - fixes to U-value calcs and construction object definitions for roof surfaces where continuous insulation may be present below roof joists
   "Set Cons:BlwJoistInsulThick"		Cons:BlwJoistInsulThick		= {	if (InsideFinishLayer > 0.1 .OR. Proj:InsulRValPerInch[2] <= 0) then  0		; Thickness of insulation below attic roof joists
                                                                     else if (CavityLayer > 200) then  0    ; assume no insul below joists for compressed insul cavity options - SAC 6/15/17
                                                                     else  max( 0, ((CavityLayer / Proj:InsulRValPerInch[2]) - CavityThickness) )  endif endif  }

  ; SAC 8/15/14 - fix to roof cavity ins MatCond to ensure that cavities w/ R-val < (InsulRValPerInch * CavityThickness) doesn't end up w/ equivalent of full cavity ins (GC #360)
  ; SAC 5/9/18 - added logic to prevent application of QII for constructions assigned to surfaces that are NOT children of New Zones(Attics) (tic #775)
  ; SAC 5/18/18 - revised logic slightly to accommodate wall exception input (tic #798)
	"Set Cons:CavityMatCondQII[1]"		Cons:CavityMatCondQII[1]	= {
         if (CavityLayerRVal < 0.1 .OR. Proj:InsulRValPerInch[2] < 0.1 .OR. Proj:ICQEnclCavInsMult < 0.01) then  0
			else if (InsideFinishLayer < 0.1 .AND. BlwJoistInsulThick > 0)
			then  if (IfValidAnd( SurfacesQIIDegraded > 0 )==0)
               then  ((CavityLayerRVal / Proj:InsulRValPerInch[2]) / 12) / (CavityLayerRVal * Proj:ICQEnclCavInsMult)
               else  ((CavityLayerRVal / Proj:InsulRValPerInch[2]) / 12) / (CavityLayerRVal * Proj:StdICQEnclCavInsMult)
               endif
			else  if (IfValidAnd( SurfacesQIIDegraded > 0 )==0)
               then  ( CavityThickness                             / 12) / (CavityLayerRVal * Proj:ICQEnclCavInsMult)
               else  ( CavityThickness                             / 12) / (CavityLayerRVal * Proj:StdICQEnclCavInsMult)
               endif
			endif endif  }
	"Set Cons:CavityMatCondQII[2]"		Cons:CavityMatCondQII[2]	= {	CavityMatCondQII[1]  }
	"Set Cons:CavityMatCondQII[3]"		Cons:CavityMatCondQII[3]	= {	CavityMatCondQII[1]  }
	"Set Cons:CavityMatCond[1]"			Cons:CavityMatCond[1]		= {	if (CavityLayerRVal < 0.1 .OR. Proj:InsulRValPerInch[2] < 0.1) then  0
																								else if (InsideFinishLayer < 0.1 .AND. BlwJoistInsulThick > 0)
																								then  ((CavityLayerRVal / Proj:InsulRValPerInch[2]) / 12) / CavityLayerRVal
																								else  ( CavityThickness                             / 12) / CavityLayerRVal
																								endif endif  }
	"Set Cons:CavityMatCond[2]"			Cons:CavityMatCond[2]		= {	CavityMatCond[1]  }
	"Set Cons:CavityMatCond[3]"			Cons:CavityMatCond[3]		= {	CavityMatCond[1]  }

	"Set Cons:FrameCavityLayerMat[1]"	Cons:FrameCavityLayerMat[1] = {	     if (Local( FrameLayer ) < 0.1) then  0     ; NO frame/cavity layer
																								else if (Local( InsideFinishLayer ) > 0.1 .OR. BlwJoistInsulThick > 0) then  2
																								else  1  endif endif  }
	"Set Cons:FrameCavityLayerMat[2]"	Cons:FrameCavityLayerMat[2]	= {	0  }

	"Set Cons:NumLayerMats-1"		Cons:NumLayerMats = {	if (Local( InsideFinishLayer  ) > 0.1 .OR. BlwJoistInsulThick > 0) then  1  else  0  endif  }
	"Set Cons:NumLayerMats-2"		Cons:NumLayerMats = {	if (Local( FrameLayer         ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-3"		Cons:NumLayerMats = {	if (Local( RoofDeckLayer      ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-4"		Cons:NumLayerMats = {	if (AbvDeckInsulLayer == 99000 .AND. IfValidAnd( AbvDeckInsulLayerRVal > 0 )==0) then  UNCHANGED
                                                         else if (Local( AbvDeckInsulLayer  ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif endif  }
	"Set Cons:NumLayerMats-5"		Cons:NumLayerMats = {	if (Local( RoofingType        ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-6"		Cons:NumLayerMats = {	if (Local( RoofingLayer       ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }

; SAC 6/4/14 - added properties to be reported on CF1R
   "Set Cons:NumLayersRpt"		Cons:NumLayersRpt	= {	NumLayerMats  }
   "Set Cons:FramingRpt"		Cons:FramingRpt	= {	if (IfValidAnd( FrameLayer > 0 )) then  EnumString( FrameLayer )  else  " "  endif  }
   "Set Cons:CavityRRpt"		Cons:CavityRRpt	= {	if (IfValidAnd( CavityLayer > 0 ) .AND. IfValidAnd( CavityLayer < 100001 )) then  EnumString( CavityLayer )  else  "none"  endif  }

	; Mapping of this Index to Cons Properties:	1 =>	continuous insulation below attic roof joists     (SAC 8/1/14 - changes to reflect insulation under joists when no inside finish layer exists)
	;															2 =>	InsideFinishLayer 
	;															3 =>	FrameLayer  //  CavityLayer 
	;															4 =>	RoofDeckLayer
	;															5 =>	AbvDeckInsulLayer  
	;															6 =>	RoofingType (presence or absence of TileGap layer)
	;															7 =>	RoofingLayer
	"Set Cons:FrameLayerMapIdx[1]"		Cons:FrameLayerMapIdx[1]   = {	3  }	; index of Frame/Cavity layer in mapping listed above
	"Set Cons:FrameLayerMapIdx[2]"		Cons:FrameLayerMapIdx[2]   = {	0  }
	"Set Cons:AbvJoistInsLyrMapIdx"		Cons:AbvJoistInsLyrMapIdx  = {	0  }	; index of insulation above ceiling joists layer in mapping listed above
	"Set Cons:BlwJoistInsLyrMapIdx"		Cons:BlwJoistInsLyrMapIdx  = {	if (InsideFinishLayer < 0.1) then  1  else  0  endif  }	; index of insulation below roof joists layer in mapping listed above
	"Set Cons:LayerPropertyIndex[1]"		Cons:LayerPropertyIndex[1] = {		  if (BlwJoistInsulThick > 0 ) then  1
																								else if (InsideFinishLayer > 0.1) then  2
																								else if (FrameLayer        > 0.1) then  3
	                                                                     else if (RoofDeckLayer     > 0.1) then  4
	                                                                     else if ((AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                 AbvDeckInsulLayer > 0.1) then  5
	                                                                     else if (RoofingType       > 0.1) then  6
	                                                                     else if (RoofingLayer      > 0.1) then  7  else  0  endif endif endif endif endif endif endif  }
	"Set Cons:LayerPropertyIndex[2]"		Cons:LayerPropertyIndex[2] = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :		  if (InsideFinishLayer > 0.1) then  2
	                                                                     					else if (FrameLayer        > 0.1) then  3
	                                                                     					else if (RoofDeckLayer     > 0.1) then  4
	                                                                     					else if ((AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AbvDeckInsulLayer > 0.1) then  5
	                                                                     					else if (RoofingType       > 0.1) then  6
	                                                                     					else if (RoofingLayer      > 0.1) then  7  else  0  endif endif endif endif endif endif
																									case  2 :		  if (FrameLayer        > 0.1) then  3
	                                                                     					else if (RoofDeckLayer     > 0.1) then  4
	                                                                     					else if ((AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AbvDeckInsulLayer > 0.1) then  5
	                                                                     					else if (RoofingType       > 0.1) then  6
	                                                                     					else if (RoofingLayer      > 0.1) then  7  else  0  endif endif endif endif endif
																									case  3 :		  if (RoofDeckLayer     > 0.1) then  4
	                                                                     					else if ((AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AbvDeckInsulLayer > 0.1) then  5
	                                                                     					else if (RoofingType       > 0.1) then  6
	                                                                     					else if (RoofingLayer      > 0.1) then  7  else  0  endif endif endif endif
																									case  4 :		  if ((AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AbvDeckInsulLayer > 0.1) then  5
	                                                                     					else if (RoofingType       > 0.1) then  6
	                                                                     					else if (RoofingLayer      > 0.1) then  7  else  0  endif endif endif
																									case  5 :		  if (RoofingType       > 0.1) then  6
	                                                                     					else if (RoofingLayer      > 0.1) then  7  else  0  endif endif
	                                                                     	case  6 :		  if (RoofingLayer      > 0.1) then  7  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[3]"		Cons:LayerPropertyIndex[3] = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :		  if (FrameLayer        > 0.1) then  3
	                                                                     					else if (RoofDeckLayer     > 0.1) then  4
	                                                                     					else if ((AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AbvDeckInsulLayer > 0.1) then  5
	                                                                     					else if (RoofingType       > 0.1) then  6
	                                                                     					else if (RoofingLayer      > 0.1) then  7  else  0  endif endif endif endif endif
																									case  3 :		  if (RoofDeckLayer     > 0.1) then  4
	                                                                     					else if ((AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AbvDeckInsulLayer > 0.1) then  5
	                                                                     					else if (RoofingType       > 0.1) then  6
	                                                                     					else if (RoofingLayer      > 0.1) then  7  else  0  endif endif endif endif
																									case  4 :		  if ((AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AbvDeckInsulLayer > 0.1) then  5
	                                                                     					else if (RoofingType       > 0.1) then  6
	                                                                     					else if (RoofingLayer      > 0.1) then  7  else  0  endif endif endif
																									case  5 :		  if (RoofingType       > 0.1) then  6
	                                                                     					else if (RoofingLayer      > 0.1) then  7  else  0  endif endif
	                                                                     	case  6 :		  if (RoofingLayer      > 0.1) then  7  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[4]"		Cons:LayerPropertyIndex[4] = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :		  if (RoofDeckLayer     > 0.1) then  4
	                                                                     					else if ((AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AbvDeckInsulLayer > 0.1) then  5
	                                                                     					else if (RoofingType       > 0.1) then  6
	                                                                     					else if (RoofingLayer      > 0.1) then  7  else  0  endif endif endif endif
																									case  4 :		  if ((AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AbvDeckInsulLayer > 0.1) then  5
	                                                                     					else if (RoofingType       > 0.1) then  6
	                                                                     					else if (RoofingLayer      > 0.1) then  7  else  0  endif endif endif
																									case  5 :		  if (RoofingType       > 0.1) then  6
	                                                                     					else if (RoofingLayer      > 0.1) then  7  else  0  endif endif
	                                                                     	case  6 :		  if (RoofingLayer      > 0.1) then  7  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[5]"		Cons:LayerPropertyIndex[5] = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :		  if ((AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AbvDeckInsulLayer > 0.1) then  5
	                                                                     					else if (RoofingType       > 0.1) then  6
	                                                                     					else if (RoofingLayer      > 0.1) then  7  else  0  endif endif endif
																									case  5 :		  if (RoofingType       > 0.1) then  6
	                                                                     					else if (RoofingLayer      > 0.1) then  7  else  0  endif endif
	                                                                     	case  6 :		  if (RoofingLayer      > 0.1) then  7  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[6]"		Cons:LayerPropertyIndex[6] = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :		  if (RoofingType       > 0.1) then  6
	                                                                     					else if (RoofingLayer      > 0.1) then  7  else  0  endif endif
																									case  6 :		  if (RoofingLayer      > 0.1) then  7  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[7]"		Cons:LayerPropertyIndex[7] = {	switch (Local( LayerPropertyIndex[6] ))
																									case  6 :		  if (RoofingLayer      > 0.1) then  7  else  0  endif
																									default :   0
																								endswitch  }

; SAC 5/13/15 - added to facilitate Green Hybrid Roofing (GHR) tile options, which in some cases replace the conventional TileGap w/ wedge-shaped insulation
	"Set Cons:RoofTileGapVal"		Cons:RoofTileGapVal	= {	switch ( RoofingLayer )
																					case  100208 :  100208			; "GHR Tile with ENSOPRO"      -> "ENSOPRO"
																					case  100209 :  100209			; "GHR Tile with ENSOPRO Plus" -> "ENSOPRO Plus"
																					default      :  RoofingType
																				endswitch  }
	"Set Cons:RoofTileGapStr"		Cons:RoofTileGapStr	= {	switch ( RoofingLayer )
																					case  100208 :  "ENSOPRO insulation"			; "GHR Tile with ENSOPRO"    
																					case  100209 :  "ENSOPRO Plus insulation"		; "GHR Tile with ENSOPRO Plus"
																					default      :  "present"
																				endswitch  }
	"Set Cons:RoofingLayerVal"		Cons:RoofingLayerVal	= {	switch ( RoofingLayer )
																					case  100208 :  100207			; "GHR Tile with ENSOPRO"      -> "GHR"
																					case  100209 :  100207			; "GHR Tile with ENSOPRO Plus" -> "GHR"
																					default      :  RoofingLayer
																				endswitch  }
	"Set Cons:RoofingLayerStr"		Cons:RoofingLayerStr	= {	switch ( RoofingLayer )
																					case  100208 :  "Green Hybrid Roofing Tile"	; "GHR Tile with ENSOPRO"  
																					case  100209 :  "Green Hybrid Roofing Tile"	; "GHR Tile with ENSOPRO Plus" 
																					default      :  EnumString( RoofingLayer )
																				endswitch  }

	"Set Cons:FrameLayerSymVal[1]"		Cons:FrameLayerSymVal[1]   = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	if (IfValidAnd( CavInsulOverFrame = 0 )) then  0   ; no insulation over framing - SAC 3/10/17
                                                                                       else  BlwJoistInsulThick * Proj:InsulRValPerInch[2]  endif
																					;				case  1 :	BlwJoistInsulThick * Proj:InsulRValPerInch[2]
																									case  2 :	Local( InsideFinishLayer  )
																									case  3 :	Local( FrameLayer         )
																									case  4 :	Local( RoofDeckLayer      )
																									case  5 :	Local( AbvDeckInsulLayer  )
																									case  6 :			 RoofTileGapVal			; SAC 5/13/15 - was:  Local( RoofingType        )
																									case  7 :			 RoofingLayerVal			; SAC 5/13/15 - was:  Local( RoofingLayer       )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[2]"		Cons:FrameLayerSymVal[2]   = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	Local( InsideFinishLayer  )
																									case  3 :	Local( FrameLayer         )
																									case  4 :	Local( RoofDeckLayer      )
																									case  5 :	Local( AbvDeckInsulLayer  )
																									case  6 :			 RoofTileGapVal			; SAC 5/13/15 - was:  Local( RoofingType        )
																									case  7 :			 RoofingLayerVal			; SAC 5/13/15 - was:  Local( RoofingLayer       )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[3]"		Cons:FrameLayerSymVal[3]   = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	Local( FrameLayer         )
																									case  4 :	Local( RoofDeckLayer      )
																									case  5 :	Local( AbvDeckInsulLayer  )
																									case  6 :			 RoofTileGapVal			; SAC 5/13/15 - was:  Local( RoofingType        )
																									case  7 :			 RoofingLayerVal			; SAC 5/13/15 - was:  Local( RoofingLayer       )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[4]"		Cons:FrameLayerSymVal[4]   = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	Local( RoofDeckLayer      )
																									case  5 :	Local( AbvDeckInsulLayer  )
																									case  6 :			 RoofTileGapVal			; SAC 5/13/15 - was:  Local( RoofingType        )
																									case  7 :			 RoofingLayerVal			; SAC 5/13/15 - was:  Local( RoofingLayer       )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[5]"		Cons:FrameLayerSymVal[5]   = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :	Local( AbvDeckInsulLayer  )
																									case  6 :			 RoofTileGapVal			; SAC 5/13/15 - was:  Local( RoofingType        )
																									case  7 :			 RoofingLayerVal			; SAC 5/13/15 - was:  Local( RoofingLayer       )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[6]"		Cons:FrameLayerSymVal[6]   = {	switch (Local( LayerPropertyIndex[6] ))
																									case  6 :			 RoofTileGapVal			; SAC 5/13/15 - was:  Local( RoofingType        )
																									case  7 :			 RoofingLayerVal			; SAC 5/13/15 - was:  Local( RoofingLayer       )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[7]"		Cons:FrameLayerSymVal[7]   = {	switch (Local( LayerPropertyIndex[7] ))
																									case  7 :			 RoofingLayerVal			; SAC 5/13/15 - was:  Local( RoofingLayer       )
																									default : 0
																								endswitch  }
  ; replace "2x4 Top Chord of Roof Truss @ 24 in. O.C." with "2x4 @ 24 in. O.C."
	"Set Cons:FrameLayerSymVal[1]"		Cons:FrameLayerSymVal[1]   = {	if (Local( LayerPropertyIndex[1] ) == FrameLayerMapIdx[1] .AND. Local( FrameLayerSymVal[1] ) == 20424)
																								then  424  else  UNCHANGED  endif  }
	"Set Cons:FrameLayerSymVal[2]"		Cons:FrameLayerSymVal[2]   = {	if (Local( LayerPropertyIndex[2] ) == FrameLayerMapIdx[1] .AND. Local( FrameLayerSymVal[2] ) == 20424)
																								then  424  else  UNCHANGED  endif  }
	"Set Cons:FrameLayerSymVal[3]"		Cons:FrameLayerSymVal[3]   = {	if (Local( LayerPropertyIndex[3] ) == FrameLayerMapIdx[1] .AND. Local( FrameLayerSymVal[3] ) == 20424)
																								then  424  else  UNCHANGED  endif  }

   ; SAC 8/1/14 - DIFFERENT adjustment here vs. attic floor - only reduce cavity insulation if we are adding a continuous layer of insulation below roof joists
   ; SAC 5/15/17 - added compressed R-value selections - R-val = (SymVal-mod(SymVal,10))/100  (tic #761)
   ; SAC 5/16/17 - fixed bug where InsideFinishLayer being ignored since addition of CavInsulOverFrame (reported by 360)
	"Set Cons:CavityLayerSymVal[1]"		Cons:CavityLayerSymVal[1]  = {	if (Local( LayerPropertyIndex[1] ) == Local( FrameLayerMapIdx[1] ))
																								then  if (BlwJoistInsulThick > 0) then  min( CavityLayerRVal, CavityThickness * Proj:InsulRValPerInch[2] )
																										else  CavityLayerRVal  endif
																								else  if (LayerPropertyIndex[1] == 1 .AND. IfValidAnd( CavInsulOverFrame = 0 ))
                                                                              then  BlwJoistInsulThick * Proj:InsulRValPerInch[2]   ; no insulation over framing - SAC 3/10/17
                                                                              else  Local( FrameLayerSymVal[1] )  endif  endif  }
	"Set Cons:CavityLayerSymVal[2]"		Cons:CavityLayerSymVal[2]  = {	if (Local( LayerPropertyIndex[2] ) == Local( FrameLayerMapIdx[1] ))
																								then  if (BlwJoistInsulThick > 0) then  min( CavityLayerRVal, CavityThickness * Proj:InsulRValPerInch[2] )
																										else  CavityLayerRVal  endif
																								else  Local( FrameLayerSymVal[2] )  endif  }
	"Set Cons:CavityLayerSymVal[3]"		Cons:CavityLayerSymVal[3]  = {	if (Local( LayerPropertyIndex[3] ) == Local( FrameLayerMapIdx[1] ))
																								then  if (BlwJoistInsulThick > 0) then  min( CavityLayerRVal, CavityThickness * Proj:InsulRValPerInch[2] )
																										else  CavityLayerRVal  endif
																								else  Local( FrameLayerSymVal[3] )  endif  }
	"Set Cons:CavityLayerSymVal[4]"		Cons:CavityLayerSymVal[4]  = {	if (Local( LayerPropertyIndex[4] ) == Local( FrameLayerMapIdx[1] ))
																								then  if (BlwJoistInsulThick > 0) then  min( CavityLayerRVal, CavityThickness * Proj:InsulRValPerInch[2] )
																										else  CavityLayerRVal  endif
																								else  Local( FrameLayerSymVal[4] )  endif  }
	"Set Cons:CavityLayerSymVal[5]"		Cons:CavityLayerSymVal[5]  = {	if (Local( LayerPropertyIndex[5] ) == Local( FrameLayerMapIdx[1] ))
																								then  if (BlwJoistInsulThick > 0) then  min( CavityLayerRVal, CavityThickness * Proj:InsulRValPerInch[2] )
																										else  CavityLayerRVal  endif
																								else  Local( FrameLayerSymVal[5] )  endif  }
	"Set Cons:CavityLayerSymVal[6]"		Cons:CavityLayerSymVal[6]  = {	if (Local( LayerPropertyIndex[6] ) == Local( FrameLayerMapIdx[1] ))
																								then  if (BlwJoistInsulThick > 0) then  min( CavityLayerRVal, CavityThickness * Proj:InsulRValPerInch[2] )
																										else  CavityLayerRVal  endif
																								else  Local( FrameLayerSymVal[6] )  endif  }

   ; SAC 5/11/17 - related to user-defined above-deck insulation r-value
   "Set Cons:LayerUsrInpInsRVal[1]"    Cons:LayerUsrInpInsRVal[1]  = {
         if (LayerPropertyIndex[1] == 5 .AND. AbvDeckInsulLayer == 99000)
         then  AbvDeckInsulLayerRVal
         else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[2]"    Cons:LayerUsrInpInsRVal[2]  = {
         if (LayerPropertyIndex[2] == 5 .AND. AbvDeckInsulLayer == 99000)
         then  AbvDeckInsulLayerRVal
         else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[3]"    Cons:LayerUsrInpInsRVal[3]  = {
         if (LayerPropertyIndex[3] == 5 .AND. AbvDeckInsulLayer == 99000)
         then  AbvDeckInsulLayerRVal
         else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[4]"    Cons:LayerUsrInpInsRVal[4]  = {
         if (LayerPropertyIndex[4] == 5 .AND. AbvDeckInsulLayer == 99000)
         then  AbvDeckInsulLayerRVal
         else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[5]"    Cons:LayerUsrInpInsRVal[5]  = {
         if (LayerPropertyIndex[5] == 5 .AND. AbvDeckInsulLayer == 99000)
         then  AbvDeckInsulLayerRVal
         else  UNDEFINED  endif  }
   "Init Cons:LayerUsrInpInsRVal[6]"   Cons:LayerUsrInpInsRVal[6]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[9]"   Cons:LayerUsrInpInsRVal[9]  = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[7]"   Cons:LayerUsrInpInsRVal[7]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[10]"  Cons:LayerUsrInpInsRVal[10] = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[8]"   Cons:LayerUsrInpInsRVal[8]  = {  UNDEFINED  }

; SAC 6/4/14 - added properties to be reported on CF1R
; SAC 8/1/14 - updated to handle below roof joist continuous insulation
      ; SAC 10/21/19 - hyphenated R-values (R## -> R-##) (tic #1121)
	"Set Cons:AssemblyLayersRpt[1]"		Cons:AssemblyLayersRpt[1]   = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	if (IfValidAnd( CavInsulOverFrame = 0 ))
                                                                                       then  Format( "Around Roof Joists: R-%.1f insul.", CavityLayerSymVal[1] )   ; no insulation over framing - SAC 3/10/17
                                                                                       else  Format(  "Under Roof Joists: R-%.1f insul.", FrameLayerSymVal[1] )  endif
																									case  2 :	Format( "%s %s",      LayerLabels[5], EnumString( InsideFinishLayer  ))
																						;			case  3 :	Format( "%s %s / %s", LayerLabels[4], EnumString( CavityLayerAbr     ), EnumString( FrameLayerAbr ))
																									case  3 :	if (BlwJoistInsulThick > 0)
																													then	Format( "%s R-%.1f / %s",  LayerLabels[4], min( CavityLayerRVal, CavityThickness * Proj:InsulRValPerInch[2] ), EnumString( FrameLayerAbr ))
																													else	Format( "%s %s / %s",      LayerLabels[4], EnumString( CavityLayerAbr ), EnumString( FrameLayerAbr ))  endif
																									case  4 :	Format( "%s %s",      LayerLabels[3], EnumString( RoofDeckLayer      ))
																									case  5 :	if (AbvDeckInsulLayer == 99000 .AND. IfValidAnd( AbvDeckInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[2], FltToStr( AbvDeckInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[2], EnumString( AbvDeckInsulLayerRpt  ))  endif
																									case  6 :	Format( "Tile Gap: %s",               RoofTileGapStr )			; SAC 5/13/15 - was:         "Tile Gap: present"
																									case  7 :	Format( "%s %s",      LayerLabels[1], RoofingLayerStr )			; SAC 5/13/15 - was:  EnumString( RoofingLayer       ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[2]"		Cons:AssemblyLayersRpt[2]   = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	Format( "%s %s",      LayerLabels[5], EnumString( InsideFinishLayer  ))
																						;			case  3 :	Format( "%s %s / %s", LayerLabels[4], EnumString( CavityLayerAbr     ), EnumString( FrameLayerAbr ))
																									case  3 :	if (BlwJoistInsulThick > 0)
																													then	Format( "%s R-%.1f / %s",  LayerLabels[4], min( CavityLayerRVal, CavityThickness * Proj:InsulRValPerInch[2] ), EnumString( FrameLayerAbr ))
																													else	Format( "%s %s / %s",      LayerLabels[4], EnumString( CavityLayerAbr ), EnumString( FrameLayerAbr ))  endif
																									case  4 :	Format( "%s %s",      LayerLabels[3], EnumString( RoofDeckLayer      ))
																									case  5 :	if (AbvDeckInsulLayer == 99000 .AND. IfValidAnd( AbvDeckInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[2], FltToStr( AbvDeckInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[2], EnumString( AbvDeckInsulLayerRpt  ))  endif
																									case  6 :	Format( "Tile Gap: %s",               RoofTileGapStr )			; SAC 5/13/15 - was:          "Tile Gap: present"
																									case  7 :	Format( "%s %s",      LayerLabels[1], RoofingLayerStr )			; SAC 5/13/15 - was:  EnumString( RoofingLayer       ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[3]"		Cons:AssemblyLayersRpt[3]   = {	switch (Local( LayerPropertyIndex[3] ))
																						;			case  3 :	Format( "%s %s / %s", LayerLabels[4], EnumString( CavityLayerAbr     ), EnumString( FrameLayerAbr ))
																									case  3 :	if (BlwJoistInsulThick > 0)
																													then	Format( "%s R-%.1f / %s",  LayerLabels[4], min( CavityLayerRVal, CavityThickness * Proj:InsulRValPerInch[2] ), EnumString( FrameLayerAbr ))
																													else	Format( "%s %s / %s",      LayerLabels[4], EnumString( CavityLayerAbr ), EnumString( FrameLayerAbr ))  endif
																									case  4 :	Format( "%s %s",      LayerLabels[3], EnumString( RoofDeckLayer      ))
																									case  5 :	if (AbvDeckInsulLayer == 99000 .AND. IfValidAnd( AbvDeckInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[2], FltToStr( AbvDeckInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[2], EnumString( AbvDeckInsulLayerRpt  ))  endif
																									case  6 :	Format( "Tile Gap: %s",               RoofTileGapStr )			; SAC 5/13/15 - was:          "Tile Gap: present"
																									case  7 :	Format( "%s %s",      LayerLabels[1], RoofingLayerStr )			; SAC 5/13/15 - was:  EnumString( RoofingLayer       ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[4]"		Cons:AssemblyLayersRpt[4]   = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	Format( "%s %s",      LayerLabels[3], EnumString( RoofDeckLayer      ))
																									case  5 :	if (AbvDeckInsulLayer == 99000 .AND. IfValidAnd( AbvDeckInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[2], FltToStr( AbvDeckInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[2], EnumString( AbvDeckInsulLayerRpt  ))  endif
																									case  6 :	Format( "Tile Gap: %s",               RoofTileGapStr )			; SAC 5/13/15 - was:          "Tile Gap: present"
																									case  7 :	Format( "%s %s",      LayerLabels[1], RoofingLayerStr )			; SAC 5/13/15 - was:  EnumString( RoofingLayer       ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[5]"		Cons:AssemblyLayersRpt[5]   = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :	if (AbvDeckInsulLayer == 99000 .AND. IfValidAnd( AbvDeckInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[2], FltToStr( AbvDeckInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[2], EnumString( AbvDeckInsulLayerRpt  ))  endif
																									case  6 :	Format( "Tile Gap: %s",               RoofTileGapStr )			; SAC 5/13/15 - was:          "Tile Gap: present"
																									case  7 :	Format( "%s %s",      LayerLabels[1], RoofingLayerStr )			; SAC 5/13/15 - was:  EnumString( RoofingLayer       ))
																									default : UNDEFINED
																								endswitch  }
	"Blast Cons:AssemblyLayersRpt[6]"	Cons:AssemblyLayersRpt[6]   = {	switch (Local( LayerPropertyIndex[6] ))
																									case  6 :	Format( "Tile Gap: %s",               RoofTileGapStr )			; SAC 5/13/15 - was:          "Tile Gap: present"
																									case  7 :	Format( "%s %s",      LayerLabels[1], RoofingLayerStr )			; SAC 5/13/15 - was:  EnumString( RoofingLayer       ))
																									default : UNDEFINED
																								endswitch  }
	"Blast Cons:AssemblyLayersRpt[7]"	Cons:AssemblyLayersRpt[7]   = {	switch (Local( LayerPropertyIndex[7] ))
																									case  7 :	Format( "%s %s",      LayerLabels[1], RoofingLayerStr )			; SAC 5/13/15 - was:  EnumString( RoofingLayer       ))
																									default : UNDEFINED
																								endswitch  }
	"Blast Cons:AssemblyLayersRpt[8]"	Cons:AssemblyLayersRpt[8]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[9]"	Cons:AssemblyLayersRpt[9]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[10]"	Cons:AssemblyLayersRpt[10]  = {	UNDEFINED  }

   ; SAC 10/22/19 - REVERSE the order of layers reported to CF1R (tic #1121)
   "Reverse assembly reporting order"     Cons:Action =
      {  if (IfValidAnd( NumLayersRpt > 1 )==0) then  UNCHANGED
         else  EvalRulelist( "SetupCons_ReverseAssemblyLayersRpt", 1 )  endif  }

	"Set Cons:FrameSpacing"	; SAC 2/14/12 - moved from ExtWall to facilitate wall splitting
		Cons:FrameSpacing		= {	if (Local( Type ) == 10 .OR. Local( Type ) == 11)		; "Wood Framed Ceiling" -or- "Built-up Roof"
											then	if (Local( FrameLayer ) > 0)
													then  mod( Local( FrameLayer ), 100 )
													else  16		; no frame layer specified, so use generic default (??)
													endif
											else	0				; NOT "Wood Framed Ceiling" or "Built-up Roof", so no frame spacing used/valid (??)
											endif  }

	"Set Cons:FramingFactor => fraction of gross surface area that includes frame" 
		Cons:FramingFactor	= {	; All Roofs & Ceilings (exterior & interior)
											if (Local( Type ) == 10 .OR. Local( Type ) == 11)		; "Wood Framed Ceiling" -or- "Built-up Roof"
											then	if (Local( FrameSpacing ) == 16)
													then  0.10    ; Wood - 16" OC						- from 2008 Joint App 4 - 4.1.6
													else if (Local( FrameSpacing ) == 24)
													then  0.07    ; Wood - 24" OC						- from 2008 Joint App 4 - 4.1.6
													else if (Local( FrameSpacing ) == 48)
													then  0.04    ; Wood - 48" OC						- from 2008 Joint App 4 - 4.1.6
													else  -1								; INVALID FRAME SPACING
													endif endif endif
											else  0  endif  }
	"Set Cons:PathFraction[1]"			Cons:PathFraction[1]	= {	if (IfValidAnd( FramingFactor >= 0 )) then  1 - FramingFactor  else  0  endif  }		; SAC 3/17/14
	"Set Cons:PathFraction[2]"			Cons:PathFraction[2]	= {	if (IfValidAnd( FramingFactor >= 0 )) then      FramingFactor  else  0  endif  }


; ; Setup Cavity/Frame Mat object references (typically through rule library imports)
;			; Mapping of CavityLayerSymVal[*] to Cons Properties:	1 =>	InsideFinishLayer          
;			;																		2 =>	FrameLayer  //  CavityLayer
;			;																		3 =>	RoofDeckLayer              
;			;																		4 =>	AbvDeckInsulLayer          
;			;																		5 =>	RoofingLayer               
;	"Set Cons:CavityPathMats[1]"		Cons:CavityPathMats[1]	= {
;				switch (Local( CavityLayerSymVal[1] ))
;					; InsideFinishLayer
;						case 100101 :	RuleLibrary( Mat, "Gypsum Board" )		; "Gypsum Board"
;					; RoofDeckLayer
;						case 100102 :	RuleLibrary( Mat, "Wood layer" )			; "Wood Siding/sheathing/decking"
;					; AbvDeckInsulLayer
;						case  99001 :	RuleLibrary( Mat, "R1 Sheathing" )		; "R1 Sheathing"
;						case  99002 :	RuleLibrary( Mat, "R2 Sheathing" )		; "R2 Sheathing"
;						case  99003 :	RuleLibrary( Mat, "R3 Sheathing" )		; "R3 Sheathing"
;						case  99004 :	RuleLibrary( Mat, "R4 Sheathing" )		; "R4 Sheathing"
;						case  99005 :	RuleLibrary( Mat, "R5 Sheathing" )		; "R5 Sheathing"
;						case  99006 :	RuleLibrary( Mat, "R6 Sheathing" )		; "R6 Sheathing"
;						case  99007 :	RuleLibrary( Mat, "R7 Sheathing" )		; "R7 Sheathing"
;						case  99008 :	RuleLibrary( Mat, "R8 Sheathing" )		; "R8 Sheathing"
;					; RoofingLayer
;						case 100201 :	RuleLibrary( Mat, "Light Roof"  )		; "Light Roof (Asphalt Shingle)"
;						case 100202 :	RuleLibrary( Mat, "5 PSF Roof"  )		; "5 PSF (Normal Gravel)"
;						case 100203 :	RuleLibrary( Mat, "10 PSF Roof" )		; "10 PSF (RoofTile)"
;						case 100204 :	RuleLibrary( Mat, "15 PSF Roof" )		; "15 PSF (Heavy Ballast or Pavers)"
;						case 100205 :	RuleLibrary( Mat, "25 PSF Roof" )		; "25 PSF (Very Heavy Ballast or Pavers)"
;					; CavityLayer (no library mat - assign via sim prep rulelist)
;						default     :	if (Local( CavityLayerSymVal[1] ) > 0 && Local( CavityLayerSymVal[1] ) < 61)
;											then	UNDEFINED
;											else  UNDEFINED		; No layer defined - should never be the case for layer #1
;											endif  endswitch  }
;	"Set Cons:CavityPathMats[2]"		Cons:CavityPathMats[2]	= {
;				switch (Local( CavityLayerSymVal[2] ))
;					; InsideFinishLayer
;						case 100101 :	RuleLibrary( Mat, "Gypsum Board" )		; "Gypsum Board"
;					; RoofDeckLayer
;						case 100102 :	RuleLibrary( Mat, "Wood layer" )			; "Wood Siding/sheathing/decking"
;					; AbvDeckInsulLayer
;						case  99001 :	RuleLibrary( Mat, "R1 Sheathing" )		; "R1 Sheathing"
;						case  99002 :	RuleLibrary( Mat, "R2 Sheathing" )		; "R2 Sheathing"
;						case  99003 :	RuleLibrary( Mat, "R3 Sheathing" )		; "R3 Sheathing"
;						case  99004 :	RuleLibrary( Mat, "R4 Sheathing" )		; "R4 Sheathing"
;						case  99005 :	RuleLibrary( Mat, "R5 Sheathing" )		; "R5 Sheathing"
;						case  99006 :	RuleLibrary( Mat, "R6 Sheathing" )		; "R6 Sheathing"
;						case  99007 :	RuleLibrary( Mat, "R7 Sheathing" )		; "R7 Sheathing"
;						case  99008 :	RuleLibrary( Mat, "R8 Sheathing" )		; "R8 Sheathing"
;					; RoofingLayer
;						case 100201 :	RuleLibrary( Mat, "Light Roof"  )		; "Light Roof (Asphalt Shingle)"
;						case 100202 :	RuleLibrary( Mat, "5 PSF Roof"  )		; "5 PSF (Normal Gravel)"
;						case 100203 :	RuleLibrary( Mat, "10 PSF Roof" )		; "10 PSF (RoofTile)"
;						case 100204 :	RuleLibrary( Mat, "15 PSF Roof" )		; "15 PSF (Heavy Ballast or Pavers)"
;						case 100205 :	RuleLibrary( Mat, "25 PSF Roof" )		; "25 PSF (Very Heavy Ballast or Pavers)"
;					; CavityLayer (no library mat - assign via sim prep rulelist)
;						default     :	if (Local( CavityLayerSymVal[2] ) > 0 && Local( CavityLayerSymVal[2] ) < 61)
;											then	UNDEFINED
;											else  UNDEFINED		; No layer defined - should never be the case for layer #1
;											endif  endswitch  }
;	"Set Cons:CavityPathMats[3]"		Cons:CavityPathMats[3]	= {
;				switch (Local( CavityLayerSymVal[3] ))
;					; InsideFinishLayer
;						case 100101 :	RuleLibrary( Mat, "Gypsum Board" )		; "Gypsum Board"
;					; RoofDeckLayer
;						case 100102 :	RuleLibrary( Mat, "Wood layer" )			; "Wood Siding/sheathing/decking"
;					; AbvDeckInsulLayer
;						case  99001 :	RuleLibrary( Mat, "R1 Sheathing" )		; "R1 Sheathing"
;						case  99002 :	RuleLibrary( Mat, "R2 Sheathing" )		; "R2 Sheathing"
;						case  99003 :	RuleLibrary( Mat, "R3 Sheathing" )		; "R3 Sheathing"
;						case  99004 :	RuleLibrary( Mat, "R4 Sheathing" )		; "R4 Sheathing"
;						case  99005 :	RuleLibrary( Mat, "R5 Sheathing" )		; "R5 Sheathing"
;						case  99006 :	RuleLibrary( Mat, "R6 Sheathing" )		; "R6 Sheathing"
;						case  99007 :	RuleLibrary( Mat, "R7 Sheathing" )		; "R7 Sheathing"
;						case  99008 :	RuleLibrary( Mat, "R8 Sheathing" )		; "R8 Sheathing"
;					; RoofingLayer
;						case 100201 :	RuleLibrary( Mat, "Light Roof"  )		; "Light Roof (Asphalt Shingle)"
;						case 100202 :	RuleLibrary( Mat, "5 PSF Roof"  )		; "5 PSF (Normal Gravel)"
;						case 100203 :	RuleLibrary( Mat, "10 PSF Roof" )		; "10 PSF (RoofTile)"
;						case 100204 :	RuleLibrary( Mat, "15 PSF Roof" )		; "15 PSF (Heavy Ballast or Pavers)"
;						case 100205 :	RuleLibrary( Mat, "25 PSF Roof" )		; "25 PSF (Very Heavy Ballast or Pavers)"
;					; CavityLayer (no library mat - assign via sim prep rulelist)
;						default     :	if (Local( CavityLayerSymVal[3] ) > 0 && Local( CavityLayerSymVal[3] ) < 61)
;											then	UNDEFINED
;											else  UNDEFINED		; No layer defined - should never be the case for layer #1
;											endif  endswitch  }
;	"Set Cons:CavityPathMats[4]"		Cons:CavityPathMats[4]	= {
;				switch (Local( CavityLayerSymVal[4] ))
;					; InsideFinishLayer
;						case 100101 :	RuleLibrary( Mat, "Gypsum Board" )		; "Gypsum Board"
;					; RoofDeckLayer
;						case 100102 :	RuleLibrary( Mat, "Wood layer" )			; "Wood Siding/sheathing/decking"
;					; AbvDeckInsulLayer
;						case  99001 :	RuleLibrary( Mat, "R1 Sheathing" )		; "R1 Sheathing"
;						case  99002 :	RuleLibrary( Mat, "R2 Sheathing" )		; "R2 Sheathing"
;						case  99003 :	RuleLibrary( Mat, "R3 Sheathing" )		; "R3 Sheathing"
;						case  99004 :	RuleLibrary( Mat, "R4 Sheathing" )		; "R4 Sheathing"
;						case  99005 :	RuleLibrary( Mat, "R5 Sheathing" )		; "R5 Sheathing"
;						case  99006 :	RuleLibrary( Mat, "R6 Sheathing" )		; "R6 Sheathing"
;						case  99007 :	RuleLibrary( Mat, "R7 Sheathing" )		; "R7 Sheathing"
;						case  99008 :	RuleLibrary( Mat, "R8 Sheathing" )		; "R8 Sheathing"
;					; RoofingLayer
;						case 100201 :	RuleLibrary( Mat, "Light Roof"  )		; "Light Roof (Asphalt Shingle)"
;						case 100202 :	RuleLibrary( Mat, "5 PSF Roof"  )		; "5 PSF (Normal Gravel)"
;						case 100203 :	RuleLibrary( Mat, "10 PSF Roof" )		; "10 PSF (RoofTile)"
;						case 100204 :	RuleLibrary( Mat, "15 PSF Roof" )		; "15 PSF (Heavy Ballast or Pavers)"
;						case 100205 :	RuleLibrary( Mat, "25 PSF Roof" )		; "25 PSF (Very Heavy Ballast or Pavers)"
;					; CavityLayer (no library mat - assign via sim prep rulelist)
;						default     :	if (Local( CavityLayerSymVal[4] ) > 0 && Local( CavityLayerSymVal[4] ) < 61)
;											then	UNDEFINED
;											else  UNDEFINED		; No layer defined - should never be the case for layer #1
;											endif  endswitch  }
;	"Set Cons:CavityPathMats[5]"		Cons:CavityPathMats[5]	= {
;				switch (Local( CavityLayerSymVal[5] ))
;					; InsideFinishLayer
;						case 100101 :	RuleLibrary( Mat, "Gypsum Board" )		; "Gypsum Board"
;					; RoofDeckLayer
;						case 100102 :	RuleLibrary( Mat, "Wood layer" )			; "Wood Siding/sheathing/decking"
;					; AbvDeckInsulLayer
;						case  99001 :	RuleLibrary( Mat, "R1 Sheathing" )		; "R1 Sheathing"
;						case  99002 :	RuleLibrary( Mat, "R2 Sheathing" )		; "R2 Sheathing"
;						case  99003 :	RuleLibrary( Mat, "R3 Sheathing" )		; "R3 Sheathing"
;						case  99004 :	RuleLibrary( Mat, "R4 Sheathing" )		; "R4 Sheathing"
;						case  99005 :	RuleLibrary( Mat, "R5 Sheathing" )		; "R5 Sheathing"
;						case  99006 :	RuleLibrary( Mat, "R6 Sheathing" )		; "R6 Sheathing"
;						case  99007 :	RuleLibrary( Mat, "R7 Sheathing" )		; "R7 Sheathing"
;						case  99008 :	RuleLibrary( Mat, "R8 Sheathing" )		; "R8 Sheathing"
;					; RoofingLayer
;						case 100201 :	RuleLibrary( Mat, "Light Roof"  )		; "Light Roof (Asphalt Shingle)"
;						case 100202 :	RuleLibrary( Mat, "5 PSF Roof"  )		; "5 PSF (Normal Gravel)"
;						case 100203 :	RuleLibrary( Mat, "10 PSF Roof" )		; "10 PSF (RoofTile)"
;						case 100204 :	RuleLibrary( Mat, "15 PSF Roof" )		; "15 PSF (Heavy Ballast or Pavers)"
;						case 100205 :	RuleLibrary( Mat, "25 PSF Roof" )		; "25 PSF (Very Heavy Ballast or Pavers)"
;					; CavityLayer (no library mat - assign via sim prep rulelist)
;						default     :	if (Local( CavityLayerSymVal[5] ) > 0 && Local( CavityLayerSymVal[5] ) < 61)
;											then	UNDEFINED
;											else  UNDEFINED		; No layer defined - should never be the case for layer #1
;											endif  endswitch  }
;	"Set Cons:CavityPathMats[6]"		Cons:CavityPathMats[6]	= {
;				switch (Local( CavityLayerSymVal[6] ))
;					; InsideFinishLayer
;						case 100101 :	RuleLibrary( Mat, "Gypsum Board" )		; "Gypsum Board"
;					; RoofDeckLayer
;						case 100102 :	RuleLibrary( Mat, "Wood layer" )			; "Wood Siding/sheathing/decking"
;					; AbvDeckInsulLayer
;						case  99001 :	RuleLibrary( Mat, "R1 Sheathing" )		; "R1 Sheathing"
;						case  99002 :	RuleLibrary( Mat, "R2 Sheathing" )		; "R2 Sheathing"
;						case  99003 :	RuleLibrary( Mat, "R3 Sheathing" )		; "R3 Sheathing"
;						case  99004 :	RuleLibrary( Mat, "R4 Sheathing" )		; "R4 Sheathing"
;						case  99005 :	RuleLibrary( Mat, "R5 Sheathing" )		; "R5 Sheathing"
;						case  99006 :	RuleLibrary( Mat, "R6 Sheathing" )		; "R6 Sheathing"
;						case  99007 :	RuleLibrary( Mat, "R7 Sheathing" )		; "R7 Sheathing"
;						case  99008 :	RuleLibrary( Mat, "R8 Sheathing" )		; "R8 Sheathing"
;					; RoofingLayer
;						case 100201 :	RuleLibrary( Mat, "Light Roof"  )		; "Light Roof (Asphalt Shingle)"
;						case 100202 :	RuleLibrary( Mat, "5 PSF Roof"  )		; "5 PSF (Normal Gravel)"
;						case 100203 :	RuleLibrary( Mat, "10 PSF Roof" )		; "10 PSF (RoofTile)"
;						case 100204 :	RuleLibrary( Mat, "15 PSF Roof" )		; "15 PSF (Heavy Ballast or Pavers)"
;						case 100205 :	RuleLibrary( Mat, "25 PSF Roof" )		; "25 PSF (Very Heavy Ballast or Pavers)"
;					; CavityLayer (no library mat - assign via sim prep rulelist)
;						default     :	if (Local( CavityLayerSymVal[6] ) > 0 && Local( CavityLayerSymVal[6] ) < 61)
;											then	UNDEFINED
;											else  UNDEFINED		; No layer defined - should never be the case for layer #1
;											endif  endswitch  }


; SAC 2/27/14 - now initialized in prior rulelist
;	"Init Cons:FrameCodeRValue"		Cons:FrameCodeRValue  = {	0.17 + 0.61  }   ; outside and inside film coeff. consistent w/ ACM JA4 (& ASHRAE fundamentals ??)

	"Remaining construction, R-val & U-val calcs"	Cons:Action = {	EvalRulelist( "SetupCons_GenericFramed", 1 )  }

	"Set Cons:CodeMaximumUValue"		Cons:CodeMaximumUValue	= {	0  }
;	"Set Cons:CodeMaximumUValue"		Cons:CodeMaximumUValue	= {	if (Global( Proj:ClimateZone ) < 0.5) then  -1
;																						else  ClimateZoneTable( Global( Proj:ClimateZone ), 6 ) + 0.00049  endif  }  ; SAC 2/13/13 - added 0.00049 to allow for check taking into account rounding

	"Set Cons:CodeUValueLabel"			Cons:CodeUValueLabel		= {	" "  }
;	"Set Cons:CodeUValueLabel"			Cons:CodeUValueLabel		= {	if (Local( CodeMaximumUValue ) < 0) then  " "    ; no message - nothing to report
;																						else if (Local( CodeMaximumUValue ) < Local( OverallCodeUValue ))
;																						then  Format( "(doesn't meet max code %.3f U-value (%.3f))", Local( CodeMaximumUValue ), Local( OverallCodeUValue ) )
;																						else  Format( "(meets max code %.3f U-value (%.3f))", Local( CodeMaximumUValue ), Local( OverallCodeUValue ) )
;																						endif endif  }
END

;*************************************************************************
RULELIST "SetupCons_CathedralCeiling"   0 0 0 1
;*************************************************************************
; INSIDE to OUTSIDE

	"Set Cons:FrameCavityLayerMat[1]"	Cons:FrameCavityLayerMat[1] = {	     if (Local( FrameLayer ) < 0.1) then  0     ; NO frame/cavity layer
																								else if (Local( InsideFinishLayer ) > 0.1 .AND. Local( SheathInsulLayer ) > 0.1 .AND.
                                                                                (SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 ))) then  3
																								else if (Local( InsideFinishLayer ) > 0.1 .OR. (Local( SheathInsulLayer ) > 0.1 .AND.
                                                                               (SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )))) then  2
																								else  1  endif endif endif  }
	"Set Cons:FrameCavityLayerMat[2]"	Cons:FrameCavityLayerMat[2]	= {	0  }

	"Set Cons:NumLayerMats-1"		Cons:NumLayerMats = {	if (Local( InsideFinishLayer  ) > 0.1) then  1  else  0  endif  }
	"Set Cons:NumLayerMats-2"		Cons:NumLayerMats = {	if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                             Local( SheathInsulLayer   ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-3"		Cons:NumLayerMats = {	if (Local( FrameLayer         ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-4"		Cons:NumLayerMats = {	if (IfValidAnd( RadiantBarrier  > 0 )) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }     ; radiant barrier - SAC 08/24/20 (tic #72)
	"Set Cons:NumLayerMats-5"		Cons:NumLayerMats = {	if (Local( RoofDeckLayer      ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-6"		Cons:NumLayerMats = {	if (AbvDeckInsulLayer == 99000 .AND. IfValidAnd( AbvDeckInsulLayerRVal > 0 )==0) then  UNCHANGED
                                                         else if (Local( AbvDeckInsulLayer  ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif endif  }
	"Set Cons:NumLayerMats-7"		Cons:NumLayerMats = {	if (Local( RoofingType        ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-8"		Cons:NumLayerMats = {	if (Local( RoofingLayer       ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }

; SAC 6/4/14 - added properties to be reported on CF1R
   "Set Cons:NumLayersRpt"		Cons:NumLayersRpt	= {	NumLayerMats  }
   "Set Cons:FramingRpt"		Cons:FramingRpt	= {	if (IfValidAnd( FrameLayer > 0 )) then  EnumString( FrameLayer )  else  " "  endif  }
   "Set Cons:CavityRRpt"		Cons:CavityRRpt	= {	if (IfValidAnd( CavityLayer > 0 ) .AND. IfValidAnd( CavityLayer < 100001 )) then  EnumString( CavityLayer )  else  "none"  endif  }

	; Mapping of this Index to Cons Properties:	1 =>	InsideFinishLayer 
	;															2 =>	SheathInsulLayer
	;															3 =>	FrameLayer  //  CavityLayer 
	;															4 =>	RadiantBarrier                      ; SAC 08/24/20 (tic #72)
	;															5 =>	RoofDeckLayer
	;															6 =>	AbvDeckInsulLayer  
	;															7 =>	RoofingType (presence or absence of TileGap layer)
	;															8 =>	RoofingLayer
	"Set Cons:FrameLayerMapIdx[1]"		Cons:FrameLayerMapIdx[1]   = {	3  }	; index of Frame/Cavity layer in mapping listed above
	"Set Cons:FrameLayerMapIdx[2]"		Cons:FrameLayerMapIdx[2]   = {	0  }
	"Set Cons:AbvJoistInsLyrMapIdx"		Cons:AbvJoistInsLyrMapIdx  = {	0  }	; index of insulation above ceiling joists layer in mapping listed above
	"Set Cons:BlwJoistInsLyrMapIdx"		Cons:BlwJoistInsLyrMapIdx  = {	0  }	; index of insulation below roof joists layer in mapping listed above
	"Set Cons:LayerPropertyIndex[1]"		Cons:LayerPropertyIndex[1] = {		  if (Local( InsideFinishLayer  ) > 0.1) then  1
																								else if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                 Local( SheathInsulLayer   ) > 0.1) then  2
																								else if (Local( FrameLayer         ) > 0.1) then  3
	                                                                     else if (IfValidAnd( RadiantBarrier  > 0 )) then  4
	                                                                     else if (Local( RoofDeckLayer      ) > 0.1) then  5
	                                                                     else if ((AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                 Local( AbvDeckInsulLayer  ) > 0.1) then  6
	                                                                     else if (Local( RoofingType        ) > 0.1) then  7
	                                                                     else if (Local( RoofingLayer       ) > 0.1) then  8  else  0  endif endif endif endif endif endif endif endif  }
	"Set Cons:LayerPropertyIndex[2]"		Cons:LayerPropertyIndex[2] = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :		  if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer   ) > 0.1) then  2
	                                                                     					else if (Local( FrameLayer         ) > 0.1) then  3
	                                                                     					else if (IfValidAnd( RadiantBarrier  > 0 )) then  4
	                                                                     					else if (Local( RoofDeckLayer      ) > 0.1) then  5
	                                                                     					else if ((AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                Local( AbvDeckInsulLayer  ) > 0.1) then  6
	                                                                     					else if (Local( RoofingType        ) > 0.1) then  7
	                                                                     					else if (Local( RoofingLayer       ) > 0.1) then  8  else  0  endif endif endif endif endif endif endif
																									case  2 :		  if (Local( FrameLayer         ) > 0.1) then  3
	                                                                     					else if (IfValidAnd( RadiantBarrier  > 0 )) then  4
	                                                                     					else if (Local( RoofDeckLayer      ) > 0.1) then  5
	                                                                     					else if ((AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                Local( AbvDeckInsulLayer  ) > 0.1) then  6
	                                                                     					else if (Local( RoofingType        ) > 0.1) then  7
	                                                                     					else if (Local( RoofingLayer       ) > 0.1) then  8  else  0  endif endif endif endif endif endif
																									case  3 :		  if (IfValidAnd( RadiantBarrier  > 0 )) then  4
	                                                                     					else if (Local( RoofDeckLayer      ) > 0.1) then  5
	                                                                     					else if ((AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                Local( AbvDeckInsulLayer  ) > 0.1) then  6
	                                                                     					else if (Local( RoofingType        ) > 0.1) then  7
	                                                                     					else if (Local( RoofingLayer       ) > 0.1) then  8  else  0  endif endif endif endif endif
																									case  4 :		  if (Local( RoofDeckLayer      ) > 0.1) then  5
	                                                                     					else if ((AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                Local( AbvDeckInsulLayer  ) > 0.1) then  6
	                                                                     					else if (Local( RoofingType        ) > 0.1) then  7
	                                                                     					else if (Local( RoofingLayer       ) > 0.1) then  8  else  0  endif endif endif endif
																									case  5 :		  if ((AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                Local( AbvDeckInsulLayer  ) > 0.1) then  6
	                                                                     					else if (Local( RoofingType        ) > 0.1) then  7
	                                                                     					else if (Local( RoofingLayer       ) > 0.1) then  8  else  0  endif endif endif
																									case  6 :		  if (Local( RoofingType        ) > 0.1) then  7
	                                                                     					else if (Local( RoofingLayer       ) > 0.1) then  8  else  0  endif endif
																									case  7 :		  if (Local( RoofingLayer       ) > 0.1) then  8  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[3]"		Cons:LayerPropertyIndex[3] = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :		  if (Local( FrameLayer         ) > 0.1) then  3
	                                                                     					else if (IfValidAnd( RadiantBarrier  > 0 )) then  4
	                                                                     					else if (Local( RoofDeckLayer      ) > 0.1) then  5
	                                                                     					else if ((AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                Local( AbvDeckInsulLayer  ) > 0.1) then  6
	                                                                     					else if (Local( RoofingType        ) > 0.1) then  7
	                                                                     					else if (Local( RoofingLayer       ) > 0.1) then  8  else  0  endif endif endif endif endif endif
																									case  3 :		  if (IfValidAnd( RadiantBarrier  > 0 )) then  4
	                                                                     					else if (Local( RoofDeckLayer      ) > 0.1) then  5
	                                                                     					else if ((AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                Local( AbvDeckInsulLayer  ) > 0.1) then  6
	                                                                     					else if (Local( RoofingType        ) > 0.1) then  7
	                                                                     					else if (Local( RoofingLayer       ) > 0.1) then  8  else  0  endif endif endif endif endif
																									case  4 :		  if (Local( RoofDeckLayer      ) > 0.1) then  5
	                                                                     					else if ((AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                Local( AbvDeckInsulLayer  ) > 0.1) then  6
	                                                                     					else if (Local( RoofingType        ) > 0.1) then  7
	                                                                     					else if (Local( RoofingLayer       ) > 0.1) then  8  else  0  endif endif endif endif
																									case  5 :		  if ((AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                Local( AbvDeckInsulLayer  ) > 0.1) then  6
	                                                                     					else if (Local( RoofingType        ) > 0.1) then  7
	                                                                     					else if (Local( RoofingLayer       ) > 0.1) then  8  else  0  endif endif endif
																									case  6 :		  if (Local( RoofingType        ) > 0.1) then  7
	                                                                     					else if (Local( RoofingLayer       ) > 0.1) then  8  else  0  endif endif
																									case  7 :		  if (Local( RoofingLayer       ) > 0.1) then  8  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[4]"		Cons:LayerPropertyIndex[4] = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :		  if (IfValidAnd( RadiantBarrier  > 0 )) then  4
	                                                                     					else if (Local( RoofDeckLayer      ) > 0.1) then  5
	                                                                     					else if ((AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                Local( AbvDeckInsulLayer  ) > 0.1) then  6
	                                                                     					else if (Local( RoofingType        ) > 0.1) then  7
	                                                                     					else if (Local( RoofingLayer       ) > 0.1) then  8  else  0  endif endif endif endif endif
																									case  4 :		  if (Local( RoofDeckLayer      ) > 0.1) then  5
	                                                                     					else if ((AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                Local( AbvDeckInsulLayer  ) > 0.1) then  6
	                                                                     					else if (Local( RoofingType        ) > 0.1) then  7
	                                                                     					else if (Local( RoofingLayer       ) > 0.1) then  8  else  0  endif endif endif endif
																									case  5 :		  if ((AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                Local( AbvDeckInsulLayer  ) > 0.1) then  6
	                                                                     					else if (Local( RoofingType        ) > 0.1) then  7
	                                                                     					else if (Local( RoofingLayer       ) > 0.1) then  8  else  0  endif endif endif
																									case  6 :		  if (Local( RoofingType        ) > 0.1) then  7
	                                                                     					else if (Local( RoofingLayer       ) > 0.1) then  8  else  0  endif endif
																									case  7 :		  if (Local( RoofingLayer       ) > 0.1) then  8  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[5]"		Cons:LayerPropertyIndex[5] = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :		  if (Local( RoofDeckLayer      ) > 0.1) then  5
	                                                                     					else if ((AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                Local( AbvDeckInsulLayer  ) > 0.1) then  6
	                                                                     					else if (Local( RoofingType        ) > 0.1) then  7
	                                                                     					else if (Local( RoofingLayer       ) > 0.1) then  8  else  0  endif endif endif endif
																									case  5 :		  if ((AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                Local( AbvDeckInsulLayer  ) > 0.1) then  6
	                                                                     					else if (Local( RoofingType        ) > 0.1) then  7
	                                                                     					else if (Local( RoofingLayer       ) > 0.1) then  8  else  0  endif endif endif
																									case  6 :		  if (Local( RoofingType        ) > 0.1) then  7
	                                                                     					else if (Local( RoofingLayer       ) > 0.1) then  8  else  0  endif endif
																									case  7 :		  if (Local( RoofingLayer       ) > 0.1) then  8  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[6]"		Cons:LayerPropertyIndex[6] = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :		  if ((AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                Local( AbvDeckInsulLayer  ) > 0.1) then  6
	                                                                     					else if (Local( RoofingType        ) > 0.1) then  7
	                                                                     					else if (Local( RoofingLayer       ) > 0.1) then  8  else  0  endif endif endif
																									case  6 :		  if (Local( RoofingType        ) > 0.1) then  7
	                                                                     					else if (Local( RoofingLayer       ) > 0.1) then  8  else  0  endif endif
																									case  7 :		  if (Local( RoofingLayer       ) > 0.1) then  8  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[7]"		Cons:LayerPropertyIndex[7] = {	switch (Local( LayerPropertyIndex[6] ))
																									case  6 :		  if (Local( RoofingType        ) > 0.1) then  7
	                                                                     					else if (Local( RoofingLayer       ) > 0.1) then  8  else  0  endif endif
																									case  7 :		  if (Local( RoofingLayer       ) > 0.1) then  8  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[8]"		Cons:LayerPropertyIndex[8] = {	switch (Local( LayerPropertyIndex[7] ))
																									case  7 :		  if (Local( RoofingLayer       ) > 0.1) then  8  else  0  endif
																									default :   0
																								endswitch  }
  ; replace "2x4 Top Chord of Roof Truss @ 24 in. O.C." with "2x4 @ 24 in. O.C."
	"Set Cons:FrameLayerSymVal[1]"		Cons:FrameLayerSymVal[1]   = {	if (Local( LayerPropertyIndex[1] ) == 3 .AND. Local( FrameLayerSymVal[1] ) == 20424)
																								then  424  else  UNCHANGED  endif  }
	"Set Cons:FrameLayerSymVal[2]"		Cons:FrameLayerSymVal[2]   = {	if (Local( LayerPropertyIndex[2] ) == 3 .AND. Local( FrameLayerSymVal[2] ) == 20424)
																								then  424  else  UNCHANGED  endif  }
	"Set Cons:FrameLayerSymVal[3]"		Cons:FrameLayerSymVal[3]   = {	if (Local( LayerPropertyIndex[3] ) == 3 .AND. Local( FrameLayerSymVal[3] ) == 20424)
																								then  424  else  UNCHANGED  endif  }

; SAC 5/13/15 - added to facilitate Green Hybrid Roofing (GHR) tile options, which in some cases replace the conventional TileGap w/ wedge-shaped insulation
	"Set Cons:RoofTileGapVal"		Cons:RoofTileGapVal	= {	switch ( RoofingLayer )
																					case  100208 :  100208			; "GHR Tile with ENSOPRO"      -> "ENSOPRO"
																					case  100209 :  100209			; "GHR Tile with ENSOPRO Plus" -> "ENSOPRO Plus"
																					default      :  RoofingType
																				endswitch  }
	"Set Cons:RoofTileGapStr"		Cons:RoofTileGapStr	= {	switch ( RoofingLayer )
																					case  100208 :  "ENSOPRO insulation"			; "GHR Tile with ENSOPRO"    
																					case  100209 :  "ENSOPRO Plus insulation"		; "GHR Tile with ENSOPRO Plus"
																					default      :  "present"
																				endswitch  }
	"Set Cons:RoofingLayerVal"		Cons:RoofingLayerVal	= {	switch ( RoofingLayer )
																					case  100208 :  100207			; "GHR Tile with ENSOPRO"      -> "GHR"
																					case  100209 :  100207			; "GHR Tile with ENSOPRO Plus" -> "GHR"
																					default      :  RoofingLayer
																				endswitch  }
	"Set Cons:RoofingLayerStr"		Cons:RoofingLayerStr	= {	switch ( RoofingLayer )
																					case  100208 :  "Green Hybrid Roofing Tile"	; "GHR Tile with ENSOPRO"  
																					case  100209 :  "Green Hybrid Roofing Tile"	; "GHR Tile with ENSOPRO Plus" 
																					default      :  EnumString( RoofingLayer )
																				endswitch  }

	"Set Cons:FrameLayerSymVal[1]"		Cons:FrameLayerSymVal[1]   = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	Local( InsideFinishLayer  )
																									case  2 :	Local( SheathInsulLayer   )
																									case  3 :	Local( FrameLayer         )
																									case  4 :	         100210               ; "CathClg RadBarrier" - SAC 08/24/20 (tic #72)
																									case  5 :	Local( RoofDeckLayer      )
																									case  6 :	Local( AbvDeckInsulLayer  )
																									case  7 :			 RoofTileGapVal			; SAC 5/13/15 - was:  Local( RoofingType        )
																									case  8 :			 RoofingLayerVal			; SAC 5/13/15 - was:  Local( RoofingLayer       )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[2]"		Cons:FrameLayerSymVal[2]   = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	Local( SheathInsulLayer   )
																									case  3 :	Local( FrameLayer         )
																									case  4 :	         100210               ; "CathClg RadBarrier" - SAC 08/24/20 (tic #72)
																									case  5 :	Local( RoofDeckLayer      )
																									case  6 :	Local( AbvDeckInsulLayer  )
																									case  7 :			 RoofTileGapVal			; SAC 5/13/15 - was:  Local( RoofingType        )
																									case  8 :			 RoofingLayerVal			; SAC 5/13/15 - was:  Local( RoofingLayer       )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[3]"		Cons:FrameLayerSymVal[3]   = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	Local( FrameLayer         )
																									case  4 :	         100210               ; "CathClg RadBarrier" - SAC 08/24/20 (tic #72)
																									case  5 :	Local( RoofDeckLayer      )
																									case  6 :	Local( AbvDeckInsulLayer  )
																									case  7 :			 RoofTileGapVal			; SAC 5/13/15 - was:  Local( RoofingType        )
																									case  8 :			 RoofingLayerVal			; SAC 5/13/15 - was:  Local( RoofingLayer       )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[4]"		Cons:FrameLayerSymVal[4]   = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	         100210               ; "CathClg RadBarrier" - SAC 08/24/20 (tic #72)
																									case  5 :	Local( RoofDeckLayer      )
																									case  6 :	Local( AbvDeckInsulLayer  )
																									case  7 :			 RoofTileGapVal			; SAC 5/13/15 - was:  Local( RoofingType        )
																									case  8 :			 RoofingLayerVal			; SAC 5/13/15 - was:  Local( RoofingLayer       )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[5]"		Cons:FrameLayerSymVal[5]   = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :	Local( RoofDeckLayer      )
																									case  6 :	Local( AbvDeckInsulLayer  )
																									case  7 :			 RoofTileGapVal			; SAC 5/13/15 - was:  Local( RoofingType        )
																									case  8 :			 RoofingLayerVal			; SAC 5/13/15 - was:  Local( RoofingLayer       )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[6]"		Cons:FrameLayerSymVal[6]   = {	switch (Local( LayerPropertyIndex[6] ))
																									case  6 :	Local( AbvDeckInsulLayer  )
																									case  7 :			 RoofTileGapVal			; SAC 5/13/15 - was:  Local( RoofingType        )
																									case  8 :			 RoofingLayerVal			; SAC 5/13/15 - was:  Local( RoofingLayer       )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[7]"		Cons:FrameLayerSymVal[7]   = {	switch (Local( LayerPropertyIndex[7] ))
																									case  7 :			 RoofTileGapVal			; SAC 5/13/15 - was:  Local( RoofingType        )
																									case  8 :			 RoofingLayerVal			; SAC 5/13/15 - was:  Local( RoofingLayer       )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[8]"		Cons:FrameLayerSymVal[8]   = {	switch (Local( LayerPropertyIndex[8] ))
																									case  8 :			 RoofingLayerVal			; SAC 5/13/15 - was:  Local( RoofingLayer       )
																									default : 0
																								endswitch  }

   ; SAC 5/15/17 - added compressed R-value selections - R-val = (SymVal-mod(SymVal,10))/100  (tic #761)
	"Set Cons:CavityLayerSymVal[1]"		Cons:CavityLayerSymVal[1]  = {
         if (Local( LayerPropertyIndex[1] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[1] )  endif  }
	"Set Cons:CavityLayerSymVal[2]"		Cons:CavityLayerSymVal[2]  = {
         if (Local( LayerPropertyIndex[2] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[2] )  endif  }
	"Set Cons:CavityLayerSymVal[3]"		Cons:CavityLayerSymVal[3]  = {
         if (Local( LayerPropertyIndex[3] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[3] )  endif  }
	"Set Cons:CavityLayerSymVal[4]"		Cons:CavityLayerSymVal[4]  = {
         if (Local( LayerPropertyIndex[4] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[4] )  endif  }
	"Set Cons:CavityLayerSymVal[5]"		Cons:CavityLayerSymVal[5]  = {
         if (Local( LayerPropertyIndex[5] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[5] )  endif  }
	"Set Cons:CavityLayerSymVal[6]"		Cons:CavityLayerSymVal[6]  = {
         if (Local( LayerPropertyIndex[6] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[6] )  endif  }
	"Set Cons:CavityLayerSymVal[7]"		Cons:CavityLayerSymVal[7]  = {
         if (Local( LayerPropertyIndex[7] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[7] )  endif  }

   ; switch Framing layer 'CathClg RadBarrier' (100210) to 'CathClg NoRadBarrier' (100211) to prevent RadBarrier from being modeled in Framing path - SAC 08/28/20 (tic #72)
   "Set Cons:FrameLayerSymVal[1]"   Cons:FrameLayerSymVal[1]  = {  if (FrameLayerSymVal[1] == 100210) then  100211  else  UNCHANGED  endif  }
   "Set Cons:FrameLayerSymVal[2]"   Cons:FrameLayerSymVal[2]  = {  if (FrameLayerSymVal[2] == 100210) then  100211  else  UNCHANGED  endif  }
   "Set Cons:FrameLayerSymVal[3]"   Cons:FrameLayerSymVal[3]  = {  if (FrameLayerSymVal[3] == 100210) then  100211  else  UNCHANGED  endif  }
   "Set Cons:FrameLayerSymVal[4]"   Cons:FrameLayerSymVal[4]  = {  if (FrameLayerSymVal[4] == 100210) then  100211  else  UNCHANGED  endif  }
   "Set Cons:FrameLayerSymVal[5]"   Cons:FrameLayerSymVal[5]  = {  if (FrameLayerSymVal[5] == 100210) then  100211  else  UNCHANGED  endif  }
   "Set Cons:FrameLayerSymVal[6]"   Cons:FrameLayerSymVal[6]  = {  if (FrameLayerSymVal[6] == 100210) then  100211  else  UNCHANGED  endif  }

   ; SAC 4/11/17 - related to user-defined sheating/insulation r-value
   ; SAC 5/11/17 - added logic for user-defined above-deck insulation r-value
   "Set Cons:LayerUsrInpInsRVal[1]"    Cons:LayerUsrInpInsRVal[1]  = {
         if (LayerPropertyIndex[1] == 2 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal
         else if (LayerPropertyIndex[1] == 6 .AND. AbvDeckInsulLayer == 99000)
         then  AbvDeckInsulLayerRVal  else  UNDEFINED  endif endif  }
   "Set Cons:LayerUsrInpInsRVal[2]"    Cons:LayerUsrInpInsRVal[2]  = {
         if (LayerPropertyIndex[2] == 2 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal
         else if (LayerPropertyIndex[2] == 6 .AND. AbvDeckInsulLayer == 99000)
         then  AbvDeckInsulLayerRVal  else  UNDEFINED  endif endif  }
   "Set Cons:LayerUsrInpInsRVal[3]"    Cons:LayerUsrInpInsRVal[3]  = {
         if (LayerPropertyIndex[3] == 6 .AND. AbvDeckInsulLayer == 99000)
         then  AbvDeckInsulLayerRVal  else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[4]"    Cons:LayerUsrInpInsRVal[4]  = {
         if (LayerPropertyIndex[4] == 6 .AND. AbvDeckInsulLayer == 99000)
         then  AbvDeckInsulLayerRVal  else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[5]"    Cons:LayerUsrInpInsRVal[5]  = {
         if (LayerPropertyIndex[5] == 6 .AND. AbvDeckInsulLayer == 99000)
         then  AbvDeckInsulLayerRVal  else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[6]"    Cons:LayerUsrInpInsRVal[6]  = {
         if (LayerPropertyIndex[6] == 6 .AND. AbvDeckInsulLayer == 99000)
         then  AbvDeckInsulLayerRVal  else  UNDEFINED  endif  }
   "Init Cons:LayerUsrInpInsRVal[7]"   Cons:LayerUsrInpInsRVal[7]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[9]"   Cons:LayerUsrInpInsRVal[9]  = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[8]"   Cons:LayerUsrInpInsRVal[8]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[10]"  Cons:LayerUsrInpInsRVal[10] = {  UNDEFINED  }

; SAC 6/4/14 - added properties to be reported on CF1R
      ; SAC 10/21/19 - hyphenated R-values (R## -> R-##) (tic #1121)
	"Set Cons:AssemblyLayersRpt[1]"		Cons:AssemblyLayersRpt[1]   = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	Format( "%s %s",      LayerLabels[6], EnumString( InsideFinishLayer  ))
																									case  2 :	if (SheathInsulLayer == 99000 .AND. IfValidAnd( SheathInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[5], FltToStr( SheathInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[5], EnumString( SheathInsulLayerRpt   ))  endif
																									case  3 :	Format( "%s %s / %s", LayerLabels[4], EnumString( CavityLayerAbr     ), EnumString( FrameLayerAbr ))
																									case  4 :	"Radiant Barrier"       ; SAC 08/24/20 (tic #72)
																									case  5 :	Format( "%s %s",      LayerLabels[3], EnumString( RoofDeckLayer      ))
																									case  6 :	if (AbvDeckInsulLayer == 99000 .AND. IfValidAnd( AbvDeckInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[2], FltToStr( AbvDeckInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[2], EnumString( AbvDeckInsulLayerRpt  ))  endif
																									case  7 :	Format( "Tile Gap: %s",               RoofTileGapStr )			; SAC 5/13/15 - was:          "Tile Gap: present"
																									case  8 :	Format( "%s %s",      LayerLabels[1], RoofingLayerStr )			; SAC 5/13/15 - was:  EnumString( RoofingLayer       ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[2]"		Cons:AssemblyLayersRpt[2]   = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	if (SheathInsulLayer == 99000 .AND. IfValidAnd( SheathInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[5], FltToStr( SheathInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[5], EnumString( SheathInsulLayerRpt   ))  endif
																									case  3 :	Format( "%s %s / %s", LayerLabels[4], EnumString( CavityLayerAbr     ), EnumString( FrameLayerAbr ))
																									case  4 :	"Radiant Barrier"       ; SAC 08/24/20 (tic #72)
																									case  5 :	Format( "%s %s",      LayerLabels[3], EnumString( RoofDeckLayer      ))
																									case  6 :	if (AbvDeckInsulLayer == 99000 .AND. IfValidAnd( AbvDeckInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[2], FltToStr( AbvDeckInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[2], EnumString( AbvDeckInsulLayerRpt  ))  endif
																									case  7 :	Format( "Tile Gap: %s",               RoofTileGapStr )			; SAC 5/13/15 - was:          "Tile Gap: present"
																									case  8 :	Format( "%s %s",      LayerLabels[1], RoofingLayerStr )			; SAC 5/13/15 - was:  EnumString( RoofingLayer       ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[3]"		Cons:AssemblyLayersRpt[3]   = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	Format( "%s %s / %s", LayerLabels[4], EnumString( CavityLayerAbr     ), EnumString( FrameLayerAbr ))
																									case  4 :	"Radiant Barrier"       ; SAC 08/24/20 (tic #72)
																									case  5 :	Format( "%s %s",      LayerLabels[3], EnumString( RoofDeckLayer      ))
																									case  6 :	if (AbvDeckInsulLayer == 99000 .AND. IfValidAnd( AbvDeckInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[2], FltToStr( AbvDeckInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[2], EnumString( AbvDeckInsulLayerRpt  ))  endif
																									case  7 :	Format( "Tile Gap: %s",               RoofTileGapStr )			; SAC 5/13/15 - was:          "Tile Gap: present"
																									case  8 :	Format( "%s %s",      LayerLabels[1], RoofingLayerStr )			; SAC 5/13/15 - was:  EnumString( RoofingLayer       ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[4]"		Cons:AssemblyLayersRpt[4]   = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	"Radiant Barrier"       ; SAC 08/24/20 (tic #72)
																									case  5 :	Format( "%s %s",      LayerLabels[3], EnumString( RoofDeckLayer      ))
																									case  6 :	if (AbvDeckInsulLayer == 99000 .AND. IfValidAnd( AbvDeckInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[2], FltToStr( AbvDeckInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[2], EnumString( AbvDeckInsulLayerRpt  ))  endif
																									case  7 :	Format( "Tile Gap: %s",               RoofTileGapStr )			; SAC 5/13/15 - was:          "Tile Gap: present"
																									case  8 :	Format( "%s %s",      LayerLabels[1], RoofingLayerStr )			; SAC 5/13/15 - was:  EnumString( RoofingLayer       ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[5]"		Cons:AssemblyLayersRpt[5]   = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :	Format( "%s %s",      LayerLabels[3], EnumString( RoofDeckLayer      ))
																									case  6 :	if (AbvDeckInsulLayer == 99000 .AND. IfValidAnd( AbvDeckInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[2], FltToStr( AbvDeckInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[2], EnumString( AbvDeckInsulLayerRpt  ))  endif
																									case  7 :	Format( "Tile Gap: %s",               RoofTileGapStr )			; SAC 5/13/15 - was:          "Tile Gap: present"
																									case  8 :	Format( "%s %s",      LayerLabels[1], RoofingLayerStr )			; SAC 5/13/15 - was:  EnumString( RoofingLayer       ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[6]"	   Cons:AssemblyLayersRpt[6]   = {	switch (Local( LayerPropertyIndex[6] ))
																									case  6 :	if (AbvDeckInsulLayer == 99000 .AND. IfValidAnd( AbvDeckInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[2], FltToStr( AbvDeckInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[2], EnumString( AbvDeckInsulLayerRpt  ))  endif
																									case  7 :	Format( "Tile Gap: %s",               RoofTileGapStr )			; SAC 5/13/15 - was:          "Tile Gap: present"
																									case  8 :	Format( "%s %s",      LayerLabels[1], RoofingLayerStr )			; SAC 5/13/15 - was:  EnumString( RoofingLayer       ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[7]"	   Cons:AssemblyLayersRpt[7]   = {	switch (Local( LayerPropertyIndex[7] ))
																									case  7 :	Format( "Tile Gap: %s",               RoofTileGapStr )			; SAC 5/13/15 - was:          "Tile Gap: present"
																									case  8 :	Format( "%s %s",      LayerLabels[1], RoofingLayerStr )			; SAC 5/13/15 - was:  EnumString( RoofingLayer       ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[8]"	   Cons:AssemblyLayersRpt[8]   = {	switch (Local( LayerPropertyIndex[8] ))
																									case  8 :	Format( "%s %s",      LayerLabels[1], RoofingLayerStr )			; SAC 5/13/15 - was:  EnumString( RoofingLayer       ))
																									default : UNDEFINED
																								endswitch  }
	"Blast Cons:AssemblyLayersRpt[9]"	Cons:AssemblyLayersRpt[9]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[10]"	Cons:AssemblyLayersRpt[10]  = {	UNDEFINED  }

   ; SAC 10/22/19 - REVERSE the order of layers reported to CF1R (tic #1121)
   "Reverse assembly reporting order"     Cons:Action =
      {  if (IfValidAnd( NumLayersRpt > 1 )==0) then  UNCHANGED
         else  EvalRulelist( "SetupCons_ReverseAssemblyLayersRpt", 1 )  endif  }

	"Set Cons:FrameSpacing"	; SAC 2/14/12 - moved from ExtWall to facilitate wall splitting
		Cons:FrameSpacing		= {	if (Local( Type ) == 10 .OR. Local( Type ) == 11)		; "Wood Framed Ceiling" -or- "Built-up Roof"
											then	if (Local( FrameLayer ) > 0)
													then  mod( Local( FrameLayer ), 100 )
													else  16		; no frame layer specified, so use generic default (??)
													endif
											else	0				; NOT "Wood Framed Ceiling" or "Built-up Roof", so no frame spacing used/valid (??)
											endif  }

	"Set Cons:FramingFactor => fraction of gross surface area that includes frame" 
		Cons:FramingFactor	= {	; All Roofs & Ceilings (exterior & interior)
											if (Local( Type ) == 10 .OR. Local( Type ) == 11)		; "Wood Framed Ceiling" -or- "Built-up Roof"
											then	if (Local( FrameSpacing ) == 16)
													then  0.10    ; Wood - 16" OC						- from 2008 Joint App 4 - 4.1.6
													else if (Local( FrameSpacing ) == 24)
													then  0.07    ; Wood - 24" OC						- from 2008 Joint App 4 - 4.1.6
													else if (Local( FrameSpacing ) == 48)
													then  0.04    ; Wood - 48" OC						- from 2008 Joint App 4 - 4.1.6
													else  -1								; INVALID FRAME SPACING
													endif endif endif
											else  0  endif  }
	"Set Cons:PathFraction[1]"			Cons:PathFraction[1]	= {	if (IfValidAnd( FramingFactor >= 0 )) then  1 - FramingFactor  else  0  endif  }		; SAC 3/17/14
	"Set Cons:PathFraction[2]"			Cons:PathFraction[2]	= {	if (IfValidAnd( FramingFactor >= 0 )) then      FramingFactor  else  0  endif  }


; SAC 2/27/14 - now initialized in prior rulelist
;	"Init Cons:FrameCodeRValue"		Cons:FrameCodeRValue  = {	0.17 + 0.61  }   ; outside and inside film coeff. consistent w/ ACM JA4 (& ASHRAE fundamentals ??)

	"Remaining construction, R-val & U-val calcs"	Cons:Action = {	EvalRulelist( "SetupCons_GenericFramed", 1 )  }

	"Set Cons:CodeMaximumUValue"		Cons:CodeMaximumUValue	= {	0  }
;	"Set Cons:CodeMaximumUValue"		Cons:CodeMaximumUValue	= {	if (Global( Proj:ClimateZone ) < 0.5) then  -1
;																						else  ClimateZoneTable( Global( Proj:ClimateZone ), 6 ) + 0.00049  endif  }  ; SAC 2/13/13 - added 0.00049 to allow for check taking into account rounding

	"Set Cons:CodeUValueLabel"			Cons:CodeUValueLabel		= {	" "  }
;	"Set Cons:CodeUValueLabel"			Cons:CodeUValueLabel		= {	if (Local( CodeMaximumUValue ) < 0) then  " "    ; no message - nothing to report
;																						else if (Local( CodeMaximumUValue ) < Local( OverallCodeUValue ))
;																						then  Format( "(doesn't meet max code %.3f U-value (%.3f))", Local( CodeMaximumUValue ), Local( OverallCodeUValue ) )
;																						else  Format( "(meets max code %.3f U-value (%.3f))", Local( CodeMaximumUValue ), Local( OverallCodeUValue ) )
;																						endif endif  }
END

;*************************************************************************
RULELIST "SetupCons_CathedralCeiling_WA"   0 0 0 1
;*************************************************************************
; INSIDE to OUTSIDE

	"Default Cons:UfactorCalcMethod"		Cons:UfactorCalcMethod	= {	1	}	; "Wood Framed Ceiling"      ->  "Parallel Path"
	"Set Cons:InsideLayerFirst"			Cons:InsideLayerFirst 	= {	0	}	; Cathedral Ceilings
	"Set Cons:Type"							Cons:Type				 	= {	10	}	; "Wood Framed Ceiling"  
	"Set Cons:NumPaths"						Cons:NumPaths 				= {	2	}	; "Wood Framed Ceiling"  
	"Set Cons:NumLayers"						Cons:NumLayers 			= {	7	}	; "Wood Framed Ceiling"  - attic edge WA

	"Set Cons:FrameCavityLayerMat[1]"	Cons:FrameCavityLayerMat[1] = {	     if (AtcEdg_ClgCons:InsideFinishLayer > 0.1 .AND. AtcEdg_ClgCons:SheathInsulLayer > 0.1 .AND.
                                                                               (AtcEdg_ClgCons:SheathInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_ClgCons:SheathInsulLayerRVal > 0 ))) then  3
																								else if (AtcEdg_ClgCons:InsideFinishLayer > 0.1 .OR. (AtcEdg_ClgCons:SheathInsulLayer > 0.1 .AND.
                                                                               (AtcEdg_ClgCons:SheathInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_ClgCons:SheathInsulLayerRVal > 0 )))) then  2
																								else  1  endif endif  }
	"Set Cons:FrameCavityLayerMat[2]"	Cons:FrameCavityLayerMat[2]	= {	0  }

   "Set Cons:AbvJoistInsulThick"		Cons:AbvJoistInsulThick		= {	0  }    ; = HB2 for WB construction

  ; SAC 1/13/13 - revised Improved multiplier to 1.0
  ; SAC 4/25/14 - revised rules to take into account ATTIC ROOF DECK insulation
  ; SAC 5/9/18 - added logic to prevent application of QII for constructions assigned to surfaces that are NOT children of New Zones (tic #775)
  ; SAC 5/18/18 - revised logic slightly to accommodate wall exception input (tic #798)
   "Set Cons:ICQCeilingInsMult"		Cons:ICQCeilingInsMult		= {
         if (IfValidAnd( AtcEdg_AtcCons:CavityLayerRVal > 0.1 ))
			then	if (IfValidAnd( AtcEdg_AtcCons:SurfacesQIIDegraded > 0 ))   ; prevent Improved QII for Cons assigned to Existing/Altered (or exception) surfaces 
               then               0.96  - (0.00347 * (AtcEdg_ClgCons:CavityLayerRVal + (AtcEdg_AtcCons:CavityLayerRVal / cos( (ValidOr( AtcEdg_Attic:RoofTilt, 0.166 ) * 3.14159265 / 180) ))))
               else  switch (Proj:InsulConsQuality)
						      case 2 :  1.0						; 0.987 - (0.0017  * AtcEdg_ClgCons:CavityLayerRVal)
						      default:  0.96  - (0.00347 * (AtcEdg_ClgCons:CavityLayerRVal + (AtcEdg_AtcCons:CavityLayerRVal / cos( (ValidOr( AtcEdg_Attic:RoofTilt, 0.166 ) * 3.14159265 / 180) ))))
					      endswitch  endif
			else	if (AtcEdg_ClgCons:CavityLayerRVal < 0.1) then  0
               else if (IfValidAnd( AtcEdg_ClgCons:SurfacesQIIDegraded > 0 ))   ; prevent Improved QII for Cons assigned to Existing/Altered (or exception) surfaces
               then               0.96  - (0.00347 * AtcEdg_ClgCons:CavityLayerRVal)
					else  switch (Proj:InsulConsQuality)
								case 2 :  1.0						; 0.987 - (0.0017  * AtcEdg_ClgCons:CavityLayerRVal)
								default:  0.96  - (0.00347 * AtcEdg_ClgCons:CavityLayerRVal)
							endswitch  endif endif  endif  }    ; SAC 10/11/17 - ConductivityQII fix enabling selection of compressed insulation options (CavityLayer -> CavityLayerRVal)
	"Set Cons:CavityMatCondQII[1]"	Cons:CavityMatCondQII[1]	= {	if (ICQCeilingInsMult < 0.0001 .OR. Proj:InsulRValPerInch[1] < 0.1) then  0
																							else if (IfValidAnd( AtcEdg_AtcCons:CavityLayerRVal > 0.1 ))
																							then	(((AtcEdg_ClgCons:CavityLayerRVal + (AtcEdg_AtcCons:CavityLayerRVal / cos( (ValidOr( AtcEdg_Attic:RoofTilt, 0.166 ) * 3.14159265 / 180) ))) / Proj:InsulRValPerInch[1]) / 12) /
																									 ((AtcEdg_ClgCons:CavityLayerRVal + (AtcEdg_AtcCons:CavityLayerRVal / cos( (ValidOr( AtcEdg_Attic:RoofTilt, 0.166 ) * 3.14159265 / 180) ))) * ICQCeilingInsMult)
																							else if (AtcEdg_ClgCons:CavityLayerRVal < 0.1) then  0
																							else   ((AtcEdg_ClgCons:CavityLayerRVal / Proj:InsulRValPerInch[1]) / 12) / (AtcEdg_ClgCons:CavityLayerRVal * ICQCeilingInsMult)
																							endif endif endif  }    ; SAC 10/11/17 - ConductivityQII fix enabling selection of compressed insulation options (CavityLayer -> CavityLayerRVal)
	"Set Cons:CavityMatCondQII[2]"	Cons:CavityMatCondQII[2]	= {	CavityMatCondQII[1]  }
	"Set Cons:CavityMatCondQII[3]"	Cons:CavityMatCondQII[3]	= {	CavityMatCondQII[1]  }
	"Set Cons:CavityMatCond[1]"		Cons:CavityMatCond[1]		= {	if (Proj:InsulRValPerInch[1] < 0.1) then  0
																							else if (IfValidAnd( AtcEdg_AtcCons:CavityLayerRVal > 0.1 ))
																							then	(((AtcEdg_ClgCons:CavityLayerRVal + (AtcEdg_AtcCons:CavityLayerRVal / cos( (ValidOr( AtcEdg_Attic:RoofTilt, 0.166 ) * 3.14159265 / 180) ))) / Proj:InsulRValPerInch[1]) / 12) /
																									  (AtcEdg_ClgCons:CavityLayerRVal + (AtcEdg_AtcCons:CavityLayerRVal / cos( (ValidOr( AtcEdg_Attic:RoofTilt, 0.166 ) * 3.14159265 / 180) )))
																							else if (AtcEdg_ClgCons:CavityLayerRVal < 0.1) then  0
																							else  ((AtcEdg_ClgCons:CavityLayerRVal / Proj:InsulRValPerInch[1]) / 12) / AtcEdg_ClgCons:CavityLayerRVal
																							endif endif endif  }    ; SAC 10/11/17 - ConductivityQII fix enabling selection of compressed insulation options (CavityLayer -> CavityLayerRVal)
	"Set Cons:CavityMatCond[2]"		Cons:CavityMatCond[2]		= {	CavityMatCond[1]  }
	"Set Cons:CavityMatCond[3]"		Cons:CavityMatCond[3]		= {	CavityMatCond[1]  }

	"Set Cons:NumLayerMats-1"		Cons:NumLayerMats = {	if (IfValidAnd( AtcEdg_ClgCons:InsideFinishLayer   > 0.1)) then  1  else  0  endif  }
	"Set Cons:NumLayerMats-2"		Cons:NumLayerMats = {	if ((AtcEdg_ClgCons:SheathInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_ClgCons:SheathInsulLayerRVal > 0 )) .AND.
                                                             IfValidAnd( AtcEdg_ClgCons:SheathInsulLayer    > 0.1)) then  NumLayerMats + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-3"		Cons:NumLayerMats = {	if (IfValidAnd( AtcEdg_ClgBlwAtc:AtcEdg_HA       > 0.001)) then  NumLayerMats + 1  else  UNCHANGED  endif  }   ; WA cav/frm layer
	"Set Cons:NumLayerMats-4"		Cons:NumLayerMats = {	if (IfValidAnd( AtcEdg_AtcCons:RoofDeckLayer      > 0.1 )) then  NumLayerMats + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-5"		Cons:NumLayerMats = {	if (IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayer == 99000 ) .AND. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )==0) then  UNCHANGED
                                                         else if (IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1 )) then  NumLayerMats + 1  else  UNCHANGED  endif endif  }
	"Set Cons:NumLayerMats-6"		Cons:NumLayerMats = {	if (IfValidAnd( AtcEdg_AtcCons:RoofingType        > 0.1 )) then  NumLayerMats + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-7"		Cons:NumLayerMats = {	if (IfValidAnd( AtcEdg_AtcCons:RoofingLayer       > 0.1 )) then  NumLayerMats + 1  else  UNCHANGED  endif  }

	; Mapping of this Index to Cons Properties:	1 =>	(clg blw attic)  InsideFinishLayer 
	;															2 =>	(clg blw attic)  SheathInsulLayer
	;															3 =>	(attic edge WA)  FrameLayer  //  CavityLayer   - WA cav/frm layer
	;															4 =>	(attic roof)     RoofDeckLayer
	;															5 =>	(attic roof)     AbvDeckInsulLayer  
	;															6 =>	(attic roof)     RoofingType (presence or absence of TileGap layer)
	;															7 =>	(attic roof)     RoofingLayer

	"Set Cons:FrameLayerMapIdx[1]"		Cons:FrameLayerMapIdx[1]   = {	3  }	; index of Frame/Cavity layer in mapping listed above
	"Set Cons:FrameLayerMapIdx[2]"		Cons:FrameLayerMapIdx[2]   = {	0  }
	"Set Cons:AbvJoistInsLyrMapIdx"		Cons:AbvJoistInsLyrMapIdx  = {	0  }	; index of insulation above ceiling joists layer in mapping listed above  -> needs revision for WB cons
	"Set Cons:BlwJoistInsLyrMapIdx"		Cons:BlwJoistInsLyrMapIdx  = {	0  }	; index of insulation below roof joists layer in mapping listed above
	"Set Cons:LayerPropertyIndex[1]"		Cons:LayerPropertyIndex[1] = {		  if (AtcEdg_ClgCons:InsideFinishLayer     > 0.1) then  1
																								else if ((AtcEdg_ClgCons:SheathInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_ClgCons:SheathInsulLayerRVal > 0 )) .AND.
                                                                                 AtcEdg_ClgCons:SheathInsulLayer      > 0.1) then  2
																								else if (AtcEdg_ClgBlwAtc:AtcEdg_HA         > 0.001) then  3
	                                                                     else if (AtcEdg_AtcCons:RoofDeckLayer      > 0.1) then  4
	                                                                     else if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                 AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  5
	                                                                     else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  6
	                                                                     else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  7  else  0  endif endif endif endif endif endif endif  }
	"Set Cons:LayerPropertyIndex[2]"		Cons:LayerPropertyIndex[2] = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :		  if ((AtcEdg_ClgCons:SheathInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_ClgCons:SheathInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_ClgCons:SheathInsulLayer   > 0.1) then  2
	                                                                     					else if (AtcEdg_ClgBlwAtc:AtcEdg_HA      > 0.001) then  3
	                                                                     					else if (AtcEdg_AtcCons:RoofDeckLayer      > 0.1) then  4
	                                                                     					else if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  5
	                                                                     					else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  6
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  7  else  0  endif endif endif endif endif endif
																									case  2 :		  if (AtcEdg_ClgBlwAtc:AtcEdg_HA      > 0.001) then  3
	                                                                     					else if (AtcEdg_AtcCons:RoofDeckLayer      > 0.1) then  4
	                                                                     					else if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  5
	                                                                     					else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  6
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  7  else  0  endif endif endif endif endif
																									case  3 :		  if (AtcEdg_AtcCons:RoofDeckLayer      > 0.1) then  4
																													else if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  5
																													else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  6
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  7  else  0  endif endif endif endif
																									case  4 :		  if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  5
																													else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  6
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  7  else  0  endif endif endif
																									case  5 :		  if (AtcEdg_AtcCons:RoofingType        > 0.1) then  6
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  7  else  0  endif endif
																									case  6 :		  if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  7  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[3]"		Cons:LayerPropertyIndex[3] = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :		  if (AtcEdg_ClgBlwAtc:AtcEdg_HA      > 0.001) then  3
	                                                                     					else if (AtcEdg_AtcCons:RoofDeckLayer      > 0.1) then  4
	                                                                     					else if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  5
	                                                                     					else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  6
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  7  else  0  endif endif endif endif endif
																									case  3 :		  if (AtcEdg_AtcCons:RoofDeckLayer      > 0.1) then  4
																													else if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  5
																													else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  6
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  7  else  0  endif endif endif endif
																									case  4 :		  if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  5
																													else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  6
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  7  else  0  endif endif endif
																									case  5 :		  if (AtcEdg_AtcCons:RoofingType        > 0.1) then  6
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  7  else  0  endif endif
																									case  6 :		  if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  7  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[4]"		Cons:LayerPropertyIndex[4] = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :		  if (AtcEdg_AtcCons:RoofDeckLayer      > 0.1) then  4
																													else if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  5
																													else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  6
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  7  else  0  endif endif endif endif
																									case  4 :		  if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  5
																													else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  6
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  7  else  0  endif endif endif
																									case  5 :		  if (AtcEdg_AtcCons:RoofingType        > 0.1) then  6
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  7  else  0  endif endif
																									case  6 :		  if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  7  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[5]"		Cons:LayerPropertyIndex[5] = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :		  if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  5
																													else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  6
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  7  else  0  endif endif endif
																									case  5 :		  if (AtcEdg_AtcCons:RoofingType        > 0.1) then  6
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  7  else  0  endif endif
																									case  6 :		  if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  7  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[6]"		Cons:LayerPropertyIndex[6] = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :		  if (AtcEdg_AtcCons:RoofingType        > 0.1) then  6
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  7  else  0  endif endif
																									case  6 :		  if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  7  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[7]"		Cons:LayerPropertyIndex[7] = {	switch (Local( LayerPropertyIndex[6] ))
																									case  6 :		  if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  7  else  0  endif
																									default :   0
																								endswitch  }

; SAC 5/13/15 - added to facilitate Green Hybrid Roofing (GHR) tile options, which in some cases replace the conventional TileGap w/ wedge-shaped insulation
	"Set Cons:RoofTileGapVal"		Cons:RoofTileGapVal	= {	switch ( RoofingLayer )
																					case  100208 :  100208			; "GHR Tile with ENSOPRO"      -> "ENSOPRO"
																					case  100209 :  100209			; "GHR Tile with ENSOPRO Plus" -> "ENSOPRO Plus"
																					default      :  RoofingType
																				endswitch  }
	"Set Cons:RoofingLayerVal"		Cons:RoofingLayerVal	= {	switch ( RoofingLayer )
																					case  100208 :  100207			; "GHR Tile with ENSOPRO"      -> "GHR"
																					case  100209 :  100207			; "GHR Tile with ENSOPRO Plus" -> "GHR"
																					default      :  RoofingLayer
																				endswitch  }
                                                                                            
	"Set Cons:FrameLayerSymVal[1]"		Cons:FrameLayerSymVal[1]   = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	AtcEdg_ClgCons:InsideFinishLayer    
																									case  2 :	AtcEdg_ClgCons:SheathInsulLayer     
																									case  3 :	AtcEdg_ClgCons:FrameLayer           
																									case  4 :	AtcEdg_AtcCons:RoofDeckLayer      
																									case  5 :	AtcEdg_AtcCons:AbvDeckInsulLayer  
																									case  6 :	AtcEdg_AtcCons:RoofTileGapVal			; SAC 5/13/15 - was:  RoofingType        
																									case  7 :	AtcEdg_AtcCons:RoofingLayerVal		; SAC 5/13/15 - was:  RoofingLayer       
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[2]"		Cons:FrameLayerSymVal[2]   = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	AtcEdg_ClgCons:SheathInsulLayer     
																									case  3 :	AtcEdg_ClgCons:FrameLayer           
																									case  4 :	AtcEdg_AtcCons:RoofDeckLayer      
																									case  5 :	AtcEdg_AtcCons:AbvDeckInsulLayer  
																									case  6 :	AtcEdg_AtcCons:RoofTileGapVal			; SAC 5/13/15 - was:  RoofingType        
																									case  7 :	AtcEdg_AtcCons:RoofingLayerVal		; SAC 5/13/15 - was:  RoofingLayer       
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[3]"		Cons:FrameLayerSymVal[3]   = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	AtcEdg_ClgCons:FrameLayer           
																									case  4 :	AtcEdg_AtcCons:RoofDeckLayer      
																									case  5 :	AtcEdg_AtcCons:AbvDeckInsulLayer  
																									case  6 :	AtcEdg_AtcCons:RoofTileGapVal			; SAC 5/13/15 - was:  RoofingType        
																									case  7 :	AtcEdg_AtcCons:RoofingLayerVal		; SAC 5/13/15 - was:  RoofingLayer       
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[4]"		Cons:FrameLayerSymVal[4]   = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	AtcEdg_AtcCons:RoofDeckLayer      
																									case  5 :	AtcEdg_AtcCons:AbvDeckInsulLayer  
																									case  6 :	AtcEdg_AtcCons:RoofTileGapVal			; SAC 5/13/15 - was:  RoofingType        
																									case  7 :	AtcEdg_AtcCons:RoofingLayerVal		; SAC 5/13/15 - was:  RoofingLayer       
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[5]"		Cons:FrameLayerSymVal[5]   = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :	AtcEdg_AtcCons:AbvDeckInsulLayer  
																									case  6 :	AtcEdg_AtcCons:RoofTileGapVal			; SAC 5/13/15 - was:  RoofingType        
																									case  7 :	AtcEdg_AtcCons:RoofingLayerVal		; SAC 5/13/15 - was:  RoofingLayer       
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[6]"		Cons:FrameLayerSymVal[6]   = {	switch (Local( LayerPropertyIndex[6] ))
																									case  6 :	AtcEdg_AtcCons:RoofTileGapVal			; SAC 5/13/15 - was:  RoofingType    
																									case  7 :	AtcEdg_AtcCons:RoofingLayerVal		; SAC 5/13/15 - was:  RoofingLayer   
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[7]"		Cons:FrameLayerSymVal[7]   = {	switch (Local( LayerPropertyIndex[7] ))
																									case  7 :	AtcEdg_AtcCons:RoofingLayerVal		; SAC 5/13/15 - was:  RoofingLayer  
																									default : 0
																								endswitch  }

  ; replace "2x4 Top Chord of Roof Truss @ 24 in. O.C." with "2x4 @ 24 in. O.C."
	"Set Cons:FrameLayerSymVal[1]"		Cons:FrameLayerSymVal[1]   = {	if ( LayerPropertyIndex[1] == 3 .AND. FrameLayerSymVal[1] == 20424)
																								then  424  else  UNCHANGED  endif  }
	"Set Cons:FrameLayerSymVal[2]"		Cons:FrameLayerSymVal[2]   = {	if ( LayerPropertyIndex[2] == 3 .AND. FrameLayerSymVal[2] == 20424)
																								then  424  else  UNCHANGED  endif  }
	"Set Cons:FrameLayerSymVal[3]"		Cons:FrameLayerSymVal[3]   = {	if ( LayerPropertyIndex[3] == 3 .AND. FrameLayerSymVal[3] == 20424)
																								then  424  else  UNCHANGED  endif  }

	"Set Cons:CavityLayerSymVal[1]"		Cons:CavityLayerSymVal[1]  = {	if (LayerPropertyIndex[1] == FrameLayerMapIdx[1]) then  AtcEdg_ClgBlwAtc:AtcEdg_HA * 12 * Proj:InsulRValPerInch[1]
																								else  FrameLayerSymVal[1]  endif  }
	"Set Cons:CavityLayerSymVal[2]"		Cons:CavityLayerSymVal[2]  = {	if (LayerPropertyIndex[2] == FrameLayerMapIdx[1]) then  AtcEdg_ClgBlwAtc:AtcEdg_HA * 12 * Proj:InsulRValPerInch[1]
																								else  FrameLayerSymVal[2]  endif  }
	"Set Cons:CavityLayerSymVal[3]"		Cons:CavityLayerSymVal[3]  = {	if (LayerPropertyIndex[3] == FrameLayerMapIdx[1]) then  AtcEdg_ClgBlwAtc:AtcEdg_HA * 12 * Proj:InsulRValPerInch[1]
																								else  FrameLayerSymVal[3]  endif  }
	"Set Cons:CavityLayerSymVal[4]"		Cons:CavityLayerSymVal[4]  = {	FrameLayerSymVal[4]  }
	"Set Cons:CavityLayerSymVal[5]"		Cons:CavityLayerSymVal[5]  = {	FrameLayerSymVal[5]  }
	"Set Cons:CavityLayerSymVal[6]"		Cons:CavityLayerSymVal[6]  = {	FrameLayerSymVal[6]  }
	"Set Cons:CavityLayerSymVal[7]"		Cons:CavityLayerSymVal[7]  = {	FrameLayerSymVal[7]  }

   ; SAC 4/11/17 - related to user-defined sheating/insulation r-value
   ; SAC 5/11/17 - added logic for user-defined above-deck insulation r-value
   "Set Cons:LayerUsrInpInsRVal[1]"    Cons:LayerUsrInpInsRVal[1]  = {
         if (LayerPropertyIndex[1] == 2 .AND. AtcEdg_ClgCons:SheathInsulLayer == 99000)
         then  AtcEdg_ClgCons:SheathInsulLayerRVal
         else if (LayerPropertyIndex[1] == 5 .AND. AtcEdg_AtcCons:AbvDeckInsulLayer == 99000)
         then  AtcEdg_AtcCons:AbvDeckInsulLayerRVal  else  UNDEFINED  endif endif  }
   "Set Cons:LayerUsrInpInsRVal[2]"    Cons:LayerUsrInpInsRVal[2]  = {
         if (LayerPropertyIndex[2] == 2 .AND. AtcEdg_ClgCons:SheathInsulLayer == 99000)
         then  AtcEdg_ClgCons:SheathInsulLayerRVal
         else if (LayerPropertyIndex[2] == 5 .AND. AtcEdg_AtcCons:AbvDeckInsulLayer == 99000)
         then  AtcEdg_AtcCons:AbvDeckInsulLayerRVal  else  UNDEFINED  endif endif  }
   "Set Cons:LayerUsrInpInsRVal[3]"    Cons:LayerUsrInpInsRVal[3]  = {
         if (LayerPropertyIndex[3] == 5 .AND. AtcEdg_AtcCons:AbvDeckInsulLayer == 99000)
         then  AtcEdg_AtcCons:AbvDeckInsulLayerRVal  else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[4]"    Cons:LayerUsrInpInsRVal[4]  = {
         if (LayerPropertyIndex[4] == 5 .AND. AtcEdg_AtcCons:AbvDeckInsulLayer == 99000)
         then  AtcEdg_AtcCons:AbvDeckInsulLayerRVal  else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[5]"    Cons:LayerUsrInpInsRVal[5]  = {
         if (LayerPropertyIndex[5] == 5 .AND. AtcEdg_AtcCons:AbvDeckInsulLayer == 99000)
         then  AtcEdg_AtcCons:AbvDeckInsulLayerRVal  else  UNDEFINED  endif  }
   "Init Cons:LayerUsrInpInsRVal[6]"   Cons:LayerUsrInpInsRVal[6]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[9]"   Cons:LayerUsrInpInsRVal[9]  = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[7]"   Cons:LayerUsrInpInsRVal[7]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[10]"  Cons:LayerUsrInpInsRVal[10] = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[8]"   Cons:LayerUsrInpInsRVal[8]  = {  UNDEFINED  }

	"Set Cons:FrameSpacing"
		Cons:FrameSpacing		= {	if (AtcEdg_ClgCons:Type == 10 .OR. AtcEdg_ClgCons:Type == 11)		; "Wood Framed Ceiling" -or- "Built-up Roof"
											then	if (AtcEdg_ClgCons:FrameLayer > 0)
													then  mod( AtcEdg_ClgCons:FrameLayer, 100 )
													else  16		; no frame layer specified, so use generic default (??)
													endif
											else	0				; NOT "Wood Framed Ceiling", so no frame spacing used/valid (??)
											endif  }

	"Set Cons:FramingFactor => fraction of gross surface area that includes frame" 
		Cons:FramingFactor	= {	; All Roofs & Ceilings (exterior & interior)
											if (AtcEdg_ClgCons:Type == 10 .OR. AtcEdg_ClgCons:Type == 11)		; "Wood Framed Ceiling" -or- "Built-up Roof"
											then	if (FrameSpacing == 16)			then  0.10		; Wood - 16" OC						- from 2008 Joint App 4 - 4.1.6
													else if (FrameSpacing == 24)	then  0.07		; Wood - 24" OC						- from 2008 Joint App 4 - 4.1.6
													else if (FrameSpacing == 48)	then  0.04		; Wood - 48" OC						- from 2008 Joint App 4 - 4.1.6
													else  -1													; INVALID FRAME SPACING
													endif endif endif
											else  0  endif  }
	"Set Cons:PathFraction[1]"			Cons:PathFraction[1]	= {	if (IfValidAnd( FramingFactor >= 0 )) then  1 - FramingFactor  else  0  endif  }		; SAC 3/17/14
	"Set Cons:PathFraction[2]"			Cons:PathFraction[2]	= {	if (IfValidAnd( FramingFactor >= 0 )) then      FramingFactor  else  0  endif  }

; SAC 2/27/14 - now initialized in prior rulelist
;	"Init Cons:FrameCodeRValue"		Cons:FrameCodeRValue  = {	0.17 + 0.61  }   ; outside and inside film coeff. consistent w/ ACM JA4 (& ASHRAE fundamentals ??)

	"Remaining construction, R-val & U-val calcs"	Cons:Action = {	EvalRulelist( "SetupCons_GenericFramed", 1 )  }

	"Set Cons:CodeMaximumUValue"		Cons:CodeMaximumUValue	= {	0  }
	"Set Cons:CodeUValueLabel"			Cons:CodeUValueLabel		= {	" "  }
END


;*************************************************************************
RULELIST "SetupCons_CathedralCeiling_WB"   0 0 0 1
;*************************************************************************
; INSIDE to OUTSIDE

	"Default Cons:UfactorCalcMethod"		Cons:UfactorCalcMethod	= {	1	}	; "Wood Framed Ceiling"      ->  "Parallel Path"
	"Set Cons:InsideLayerFirst"			Cons:InsideLayerFirst 	= {	0	}	; Cathedral Ceilings
	"Set Cons:Type"							Cons:Type				 	= {	10	}	; "Wood Framed Ceiling"  
	"Set Cons:NumPaths"						Cons:NumPaths 				= {	2	}	; "Wood Framed Ceiling"  
	"Set Cons:NumLayers"						Cons:NumLayers 			= {	9	}	; "Wood Framed Ceiling"  - attic edge WB

	"Set Cons:FrameCavityLayerMat[1]"	Cons:FrameCavityLayerMat[1] 	= {	if (IfValidAnd(	AtcEdg_ClgBlwAtc:AtcEdg_WACons:FrameCavityLayerMat >= 0 ))
																									then					AtcEdg_ClgBlwAtc:AtcEdg_WACons:FrameCavityLayerMat   else  0  endif  }
	"Set Cons:FrameCavityLayerMat[2]"	Cons:FrameCavityLayerMat[2]	= {	if (IfValidAnd( FrameCavityLayerMat[1] > 0 )) then  FrameCavityLayerMat[1] + 2  else  0  endif  }

   "Set Cons:AbvJoistInsulThick"		Cons:AbvJoistInsulThick		= {	AtcEdg_ClgBlwAtc:AtcEdg_HB2 * 12  }    ; = HB2 for WB construction
   "Set Cons:ICQCeilingInsMult"		Cons:ICQCeilingInsMult		= {	AtcEdg_ClgBlwAtc:AtcEdg_WACons:ICQCeilingInsMult  }
	"Set Cons:CavityMatCondQII[1]"	Cons:CavityMatCondQII[1]	= {	AtcEdg_ClgBlwAtc:AtcEdg_WACons:CavityMatCondQII  }
	"Set Cons:CavityMatCondQII[2]"	Cons:CavityMatCondQII[2]	= {	CavityMatCondQII[1]  }
	"Set Cons:CavityMatCondQII[3]"	Cons:CavityMatCondQII[3]	= {	CavityMatCondQII[1]  }
	"Set Cons:CavityMatCondQII[4]"	Cons:CavityMatCondQII[4]	= {	CavityMatCondQII[1]  }
	"Set Cons:CavityMatCondQII[5]"	Cons:CavityMatCondQII[5]	= {	CavityMatCondQII[1]  }
	"Set Cons:CavityMatCond[1]"		Cons:CavityMatCond[1]		= {	AtcEdg_ClgBlwAtc:AtcEdg_WACons:CavityMatCond  }
	"Set Cons:CavityMatCond[2]"		Cons:CavityMatCond[2]		= {	CavityMatCond[1]  }
	"Set Cons:CavityMatCond[3]"		Cons:CavityMatCond[3]		= {	CavityMatCond[1]  }
	"Set Cons:CavityMatCond[4]"		Cons:CavityMatCond[4]		= {	CavityMatCond[1]  }
	"Set Cons:CavityMatCond[5]"		Cons:CavityMatCond[5]		= {	CavityMatCond[1]  }

	"Set Cons:NumLayerMats"			Cons:NumLayerMats = {	if (IfValidAnd(	AtcEdg_ClgBlwAtc:AtcEdg_WACons:NumLayerMats >= 0 ))
																			then					AtcEdg_ClgBlwAtc:AtcEdg_WACons:NumLayerMats + 2   else  2  endif  }

	; Mapping of this Index to Cons Properties:	1 =>	(clg blw attic)  InsideFinishLayer 
	;															2 =>	(clg blw attic)  SheathInsulLayer
	;															3 =>	(attic edge WB)  FrameLayer  //  CavityLayer   - WB (HB3) cav/frm layer - @ attic floor
	;															4 =>	(attic edge WB)  WB Insulation Layer           - WB (HB2) insulation layer
	;															5 =>	(attic edge WB)  FrameLayer  //  CavityLayer   - WB (HB1) cav/frm layer - @ roof deck
	;															6 =>	(attic roof)     RoofDeckLayer
	;															7 =>	(attic roof)     AbvDeckInsulLayer  
	;															8 =>	(attic roof)     RoofingType (presence or absence of TileGap layer)
	;															9 =>	(attic roof)     RoofingLayer

	"Set Cons:FrameLayerMapIdx[1]"		Cons:FrameLayerMapIdx[1]   = {	3  }	; index of ATTIC FLOOR Frame/Cavity layer in mapping listed above
	"Set Cons:FrameLayerMapIdx[2]"		Cons:FrameLayerMapIdx[2]   = {	5  }  ; index of ROOF DECK Frame/Cavity layer in mapping listed above
	"Set Cons:AbvJoistInsLyrMapIdx"		Cons:AbvJoistInsLyrMapIdx  = {	4  }	; index of insulation above ceiling joists layer in mapping listed above  -> used for WB cons
	"Set Cons:BlwJoistInsLyrMapIdx"		Cons:BlwJoistInsLyrMapIdx  = {	0  }	; index of insulation below roof joists layer in mapping listed above

	"Set Cons:LayerPropertyIndex[1]"		Cons:LayerPropertyIndex[1] = {		  if (AtcEdg_ClgCons:InsideFinishLayer     > 0.1) then  1
																								else if ((AtcEdg_ClgCons:SheathInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_ClgCons:SheathInsulLayerRVal > 0 )) .AND.
                                                                                 AtcEdg_ClgCons:SheathInsulLayer      > 0.1) then  2
																								else if (AtcEdg_ClgBlwAtc:AtcEdg_HB3        > 0.001) then  3
																								else if (AtcEdg_ClgBlwAtc:AtcEdg_HB2        > 0.001) then  4
																								else if (AtcEdg_ClgBlwAtc:AtcEdg_HB1        > 0.001) then  5
	                                                                     else if (AtcEdg_AtcCons:RoofDeckLayer      > 0.1) then  6
	                                                                     else if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                 AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  7
	                                                                     else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  8
	                                                                     else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif endif endif endif endif endif endif endif endif  }
	"Set Cons:LayerPropertyIndex[2]"		Cons:LayerPropertyIndex[2] = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :		  if ((AtcEdg_ClgCons:SheathInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_ClgCons:SheathInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_ClgCons:SheathInsulLayer      > 0.1) then  2
	                                                                     					else if (AtcEdg_ClgBlwAtc:AtcEdg_HB3          > 0.001) then  3
																													else if (AtcEdg_ClgBlwAtc:AtcEdg_HB2          > 0.001) then  4
																													else if (AtcEdg_ClgBlwAtc:AtcEdg_HB1          > 0.001) then  5
	                                                                     					else if (AtcEdg_AtcCons:RoofDeckLayer      > 0.1) then  6
	                                                                     					else if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  7
	                                                                     					else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  8
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif endif endif endif endif endif endif endif
																									case  2 :		  if (AtcEdg_ClgBlwAtc:AtcEdg_HB3          > 0.001) then  3
																													else if (AtcEdg_ClgBlwAtc:AtcEdg_HB2          > 0.001) then  4
																													else if (AtcEdg_ClgBlwAtc:AtcEdg_HB1          > 0.001) then  5
	                                                                     					else if (AtcEdg_AtcCons:RoofDeckLayer      > 0.1) then  6
	                                                                     					else if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  7
	                                                                     					else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  8
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif endif endif endif endif endif endif
																									case  3 :		  if (AtcEdg_ClgBlwAtc:AtcEdg_HB2          > 0.001) then  4
																													else if (AtcEdg_ClgBlwAtc:AtcEdg_HB1          > 0.001) then  5
	                                                                     					else if (AtcEdg_AtcCons:RoofDeckLayer      > 0.1) then  6
																													else if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  7
																													else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  8
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif endif endif endif endif endif
																									case  4 :		  if (AtcEdg_ClgBlwAtc:AtcEdg_HB1          > 0.001) then  5
	                                                                     					else if (AtcEdg_AtcCons:RoofDeckLayer      > 0.1) then  6
	                                                                     					else if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  7
																													else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  8
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif endif endif endif endif
																									case  5 :		  if (AtcEdg_AtcCons:RoofDeckLayer      > 0.1) then  6
	                                                                     					else if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  7
																													else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  8
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif endif endif endif
																									case  6 :		  if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  7
																													else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  8
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif endif endif
																									case  7 :		  if (AtcEdg_AtcCons:RoofingType        > 0.1) then  8
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif endif
																									case  8 :		  if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[3]"		Cons:LayerPropertyIndex[3] = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :		  if (AtcEdg_ClgBlwAtc:AtcEdg_HB3          > 0.001) then  3
																													else if (AtcEdg_ClgBlwAtc:AtcEdg_HB2          > 0.001) then  4
																													else if (AtcEdg_ClgBlwAtc:AtcEdg_HB1          > 0.001) then  5
	                                                                     					else if (AtcEdg_AtcCons:RoofDeckLayer      > 0.1) then  6
	                                                                     					else if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  7
	                                                                     					else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  8
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif endif endif endif endif endif endif
																									case  3 :		  if (AtcEdg_ClgBlwAtc:AtcEdg_HB2          > 0.001) then  4
																													else if (AtcEdg_ClgBlwAtc:AtcEdg_HB1          > 0.001) then  5
	                                                                     					else if (AtcEdg_AtcCons:RoofDeckLayer      > 0.1) then  6
																													else if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  7
																													else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  8
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif endif endif endif endif endif
																									case  4 :		  if (AtcEdg_ClgBlwAtc:AtcEdg_HB1          > 0.001) then  5
	                                                                     					else if (AtcEdg_AtcCons:RoofDeckLayer      > 0.1) then  6
	                                                                     					else if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  7
																													else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  8
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif endif endif endif endif
																									case  5 :		  if (AtcEdg_AtcCons:RoofDeckLayer      > 0.1) then  6
	                                                                     					else if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  7
																													else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  8
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif endif endif endif
																									case  6 :		  if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  7
																													else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  8
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif endif endif
																									case  7 :		  if (AtcEdg_AtcCons:RoofingType        > 0.1) then  8
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif endif
																									case  8 :		  if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[4]"		Cons:LayerPropertyIndex[4] = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :		  if (AtcEdg_ClgBlwAtc:AtcEdg_HB2          > 0.001) then  4
																													else if (AtcEdg_ClgBlwAtc:AtcEdg_HB1          > 0.001) then  5
	                                                                     					else if (AtcEdg_AtcCons:RoofDeckLayer      > 0.1) then  6
																													else if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  7
																													else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  8
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif endif endif endif endif endif
																									case  4 :		  if (AtcEdg_ClgBlwAtc:AtcEdg_HB1          > 0.001) then  5
	                                                                     					else if (AtcEdg_AtcCons:RoofDeckLayer      > 0.1) then  6
	                                                                     					else if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  7
																													else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  8
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif endif endif endif endif
																									case  5 :		  if (AtcEdg_AtcCons:RoofDeckLayer      > 0.1) then  6
	                                                                     					else if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  7
																													else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  8
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif endif endif endif
																									case  6 :		  if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  7
																													else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  8
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif endif endif
																									case  7 :		  if (AtcEdg_AtcCons:RoofingType        > 0.1) then  8
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif endif
																									case  8 :		  if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[5]"		Cons:LayerPropertyIndex[5] = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :		  if (AtcEdg_ClgBlwAtc:AtcEdg_HB1          > 0.001) then  5
	                                                                     					else if (AtcEdg_AtcCons:RoofDeckLayer      > 0.1) then  6
	                                                                     					else if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  7
																													else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  8
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif endif endif endif endif
																									case  5 :		  if (AtcEdg_AtcCons:RoofDeckLayer      > 0.1) then  6
	                                                                     					else if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  7
																													else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  8
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif endif endif endif
																									case  6 :		  if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  7
																													else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  8
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif endif endif
																									case  7 :		  if (AtcEdg_AtcCons:RoofingType        > 0.1) then  8
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif endif
																									case  8 :		  if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[6]"		Cons:LayerPropertyIndex[6] = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :		  if (AtcEdg_AtcCons:RoofDeckLayer      > 0.1) then  6
	                                                                     					else if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  7
																													else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  8
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif endif endif endif
																									case  6 :		  if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  7
																													else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  8
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif endif endif
																									case  7 :		  if (AtcEdg_AtcCons:RoofingType        > 0.1) then  8
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif endif
																									case  8 :		  if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[7]"		Cons:LayerPropertyIndex[7] = {	switch (Local( LayerPropertyIndex[6] ))
																									case  6 :		  if ((AtcEdg_AtcCons:AbvDeckInsulLayer != 99000 .OR. IfValidAnd( AtcEdg_AtcCons:AbvDeckInsulLayerRVal > 0 )) .AND.
                                                                                                AtcEdg_AtcCons:AbvDeckInsulLayer  > 0.1) then  7
																													else if (AtcEdg_AtcCons:RoofingType        > 0.1) then  8
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif endif endif
																									case  7 :		  if (AtcEdg_AtcCons:RoofingType        > 0.1) then  8
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif endif
																									case  8 :		  if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[8]"		Cons:LayerPropertyIndex[8] = {	switch (Local( LayerPropertyIndex[7] ))
																									case  7 :		  if (AtcEdg_AtcCons:RoofingType        > 0.1) then  8
																													else if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif endif
																									case  8 :		  if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[9]"		Cons:LayerPropertyIndex[9] = {	switch (Local( LayerPropertyIndex[8] ))
																									case  8 :		  if (AtcEdg_AtcCons:RoofingLayer       > 0.1) then  9  else  0  endif
																									default :   0
																								endswitch  }

; SAC 5/13/15 - added to facilitate Green Hybrid Roofing (GHR) tile options, which in some cases replace the conventional TileGap w/ wedge-shaped insulation
	"Set Cons:RoofTileGapVal"		Cons:RoofTileGapVal	= {	switch ( RoofingLayer )
																					case  100208 :  100208			; "GHR Tile with ENSOPRO"      -> "ENSOPRO"
																					case  100209 :  100209			; "GHR Tile with ENSOPRO Plus" -> "ENSOPRO Plus"
																					default      :  RoofingType
																				endswitch  }
	"Set Cons:RoofingLayerVal"		Cons:RoofingLayerVal	= {	switch ( RoofingLayer )
																					case  100208 :  100207			; "GHR Tile with ENSOPRO"      -> "GHR"
																					case  100209 :  100207			; "GHR Tile with ENSOPRO Plus" -> "GHR"
																					default      :  RoofingLayer
																				endswitch  }

	"Set Cons:FrameLayerSymVal[1]"		Cons:FrameLayerSymVal[1]   = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	AtcEdg_ClgCons:InsideFinishLayer    
																									case  2 :	AtcEdg_ClgCons:SheathInsulLayer     
																									case  3 :	AtcEdg_ClgCons:FrameLayer           
																									case  4 :	AtcEdg_ClgBlwAtc:AtcEdg_HB2 * 12 * Proj:InsulRValPerInch[1]
																									case  5 :	AtcEdg_ClgCons:FrameLayer           
																									case  6 :	AtcEdg_AtcCons:RoofDeckLayer      
																									case  7 :	AtcEdg_AtcCons:AbvDeckInsulLayer  
																									case  8 :	AtcEdg_AtcCons:RoofTileGapVal			; SAC 5/13/15 - was:  RoofingType        
																									case  9 :	AtcEdg_AtcCons:RoofingLayerVal		; SAC 5/13/15 - was:  RoofingLayer       
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[2]"		Cons:FrameLayerSymVal[2]   = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	AtcEdg_ClgCons:SheathInsulLayer     
																									case  3 :	AtcEdg_ClgCons:FrameLayer           
																									case  4 :	AtcEdg_ClgBlwAtc:AtcEdg_HB2 * 12 * Proj:InsulRValPerInch[1]
																									case  5 :	AtcEdg_ClgCons:FrameLayer           
																									case  6 :	AtcEdg_AtcCons:RoofDeckLayer      
																									case  7 :	AtcEdg_AtcCons:AbvDeckInsulLayer  
																									case  8 :	AtcEdg_AtcCons:RoofTileGapVal			; SAC 5/13/15 - was:  RoofingType        
																									case  9 :	AtcEdg_AtcCons:RoofingLayerVal		; SAC 5/13/15 - was:  RoofingLayer       
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[3]"		Cons:FrameLayerSymVal[3]   = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	AtcEdg_ClgCons:FrameLayer           
																									case  4 :	AtcEdg_ClgBlwAtc:AtcEdg_HB2 * 12 * Proj:InsulRValPerInch[1]
																									case  5 :	AtcEdg_ClgCons:FrameLayer           
																									case  6 :	AtcEdg_AtcCons:RoofDeckLayer      
																									case  7 :	AtcEdg_AtcCons:AbvDeckInsulLayer  
																									case  8 :	AtcEdg_AtcCons:RoofTileGapVal			; SAC 5/13/15 - was:  RoofingType        
																									case  9 :	AtcEdg_AtcCons:RoofingLayerVal		; SAC 5/13/15 - was:  RoofingLayer       
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[4]"		Cons:FrameLayerSymVal[4]   = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	AtcEdg_ClgBlwAtc:AtcEdg_HB2 * 12 * Proj:InsulRValPerInch[1]
																									case  5 :	AtcEdg_ClgCons:FrameLayer           
																									case  6 :	AtcEdg_AtcCons:RoofDeckLayer      
																									case  7 :	AtcEdg_AtcCons:AbvDeckInsulLayer  
																									case  8 :	AtcEdg_AtcCons:RoofTileGapVal			; SAC 5/13/15 - was:  RoofingType        
																									case  9 :	AtcEdg_AtcCons:RoofingLayerVal		; SAC 5/13/15 - was:  RoofingLayer       
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[5]"		Cons:FrameLayerSymVal[5]   = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :	AtcEdg_ClgCons:FrameLayer           
																									case  6 :	AtcEdg_AtcCons:RoofDeckLayer      
																									case  7 :	AtcEdg_AtcCons:AbvDeckInsulLayer  
																									case  8 :	AtcEdg_AtcCons:RoofTileGapVal			; SAC 5/13/15 - was:  RoofingType        
																									case  9 :	AtcEdg_AtcCons:RoofingLayerVal		; SAC 5/13/15 - was:  RoofingLayer       
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[6]"		Cons:FrameLayerSymVal[6]   = {	switch (Local( LayerPropertyIndex[6] ))
																									case  6 :	AtcEdg_AtcCons:RoofDeckLayer      
																									case  7 :	AtcEdg_AtcCons:AbvDeckInsulLayer  
																									case  8 :	AtcEdg_AtcCons:RoofTileGapVal			; SAC 5/13/15 - was:  RoofingType        
																									case  9 :	AtcEdg_AtcCons:RoofingLayerVal		; SAC 5/13/15 - was:  RoofingLayer       
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[7]"		Cons:FrameLayerSymVal[7]   = {	switch (Local( LayerPropertyIndex[7] ))
																									case  7 :	AtcEdg_AtcCons:AbvDeckInsulLayer  
																									case  8 :	AtcEdg_AtcCons:RoofTileGapVal			; SAC 5/13/15 - was:  RoofingType        
																									case  9 :	AtcEdg_AtcCons:RoofingLayerVal		; SAC 5/13/15 - was:  RoofingLayer       
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[8]"		Cons:FrameLayerSymVal[8]   = {	switch (Local( LayerPropertyIndex[8] ))
																									case  8 :	AtcEdg_AtcCons:RoofTileGapVal			; SAC 5/13/15 - was:  RoofingType   
																									case  9 :	AtcEdg_AtcCons:RoofingLayerVal		; SAC 5/13/15 - was:  RoofingLayer  
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[9]"		Cons:FrameLayerSymVal[9]   = {	switch (Local( LayerPropertyIndex[9] ))
																									case  9 :	AtcEdg_AtcCons:RoofingLayerVal		; SAC 5/13/15 - was:  RoofingLayer  
																									default : 0
																								endswitch  }

  ; replace "2x4 Top Chord of Roof Truss @ 24 in. O.C." with "2x4 @ 24 in. O.C."
	"Set Cons:FrameLayerSymVal[1]"		Cons:FrameLayerSymVal[1]   = {	if ( (LayerPropertyIndex[1] == FrameLayerMapIdx[1] .OR. LayerPropertyIndex[1] == FrameLayerMapIdx[2]) .AND. FrameLayerSymVal[1] == 20424)
																								then  424  else  UNCHANGED  endif  }
	"Set Cons:FrameLayerSymVal[2]"		Cons:FrameLayerSymVal[2]   = {	if ( (LayerPropertyIndex[2] == FrameLayerMapIdx[1] .OR. LayerPropertyIndex[2] == FrameLayerMapIdx[2]) .AND. FrameLayerSymVal[2] == 20424)
																								then  424  else  UNCHANGED  endif  }
	"Set Cons:FrameLayerSymVal[3]"		Cons:FrameLayerSymVal[3]   = {	if ( (LayerPropertyIndex[3] == FrameLayerMapIdx[1] .OR. LayerPropertyIndex[3] == FrameLayerMapIdx[2]) .AND. FrameLayerSymVal[3] == 20424)
																								then  424  else  UNCHANGED  endif  }
	"Set Cons:FrameLayerSymVal[4]"		Cons:FrameLayerSymVal[4]   = {	if ( (LayerPropertyIndex[4] == FrameLayerMapIdx[1] .OR. LayerPropertyIndex[4] == FrameLayerMapIdx[2]) .AND. FrameLayerSymVal[3] == 20424)
																								then  424  else  UNCHANGED  endif  }
	"Set Cons:FrameLayerSymVal[5]"		Cons:FrameLayerSymVal[5]   = {	if ( (LayerPropertyIndex[5] == FrameLayerMapIdx[1] .OR. LayerPropertyIndex[5] == FrameLayerMapIdx[2]) .AND. FrameLayerSymVal[3] == 20424)
																								then  424  else  UNCHANGED  endif  }

	"Set Cons:CavityLayerSymVal[1]"		Cons:CavityLayerSymVal[1]  = {	     if (LayerPropertyIndex[1] == FrameLayerMapIdx[1]) then  AtcEdg_ClgBlwAtc:AtcEdg_HB3 * 12 * Proj:InsulRValPerInch[1]
																								else if (LayerPropertyIndex[1] == FrameLayerMapIdx[2]) then  AtcEdg_ClgBlwAtc:AtcEdg_HB1 * 12 * Proj:InsulRValPerInch[1]
																								else  FrameLayerSymVal[1]  endif endif  }
	"Set Cons:CavityLayerSymVal[2]"		Cons:CavityLayerSymVal[2]  = {	     if (LayerPropertyIndex[2] == FrameLayerMapIdx[1]) then  AtcEdg_ClgBlwAtc:AtcEdg_HB3 * 12 * Proj:InsulRValPerInch[1]
																								else if (LayerPropertyIndex[2] == FrameLayerMapIdx[2]) then  AtcEdg_ClgBlwAtc:AtcEdg_HB1 * 12 * Proj:InsulRValPerInch[1]
																								else  FrameLayerSymVal[2]  endif endif  }
	"Set Cons:CavityLayerSymVal[3]"		Cons:CavityLayerSymVal[3]  = {	     if (LayerPropertyIndex[3] == FrameLayerMapIdx[1]) then  AtcEdg_ClgBlwAtc:AtcEdg_HB3 * 12 * Proj:InsulRValPerInch[1]
																								else if (LayerPropertyIndex[3] == FrameLayerMapIdx[2]) then  AtcEdg_ClgBlwAtc:AtcEdg_HB1 * 12 * Proj:InsulRValPerInch[1]
																								else  FrameLayerSymVal[3]  endif endif  }
	"Set Cons:CavityLayerSymVal[4]"		Cons:CavityLayerSymVal[4]  = {	     if (LayerPropertyIndex[4] == FrameLayerMapIdx[1]) then  AtcEdg_ClgBlwAtc:AtcEdg_HB3 * 12 * Proj:InsulRValPerInch[1]
																								else if (LayerPropertyIndex[4] == FrameLayerMapIdx[2]) then  AtcEdg_ClgBlwAtc:AtcEdg_HB1 * 12 * Proj:InsulRValPerInch[1]
																								else  FrameLayerSymVal[4]  endif endif  }
	"Set Cons:CavityLayerSymVal[5]"		Cons:CavityLayerSymVal[5]  = {	     if (LayerPropertyIndex[5] == FrameLayerMapIdx[1]) then  AtcEdg_ClgBlwAtc:AtcEdg_HB3 * 12 * Proj:InsulRValPerInch[1]
																								else if (LayerPropertyIndex[5] == FrameLayerMapIdx[2]) then  AtcEdg_ClgBlwAtc:AtcEdg_HB1 * 12 * Proj:InsulRValPerInch[1]
																								else  FrameLayerSymVal[5]  endif endif  }
	"Set Cons:CavityLayerSymVal[6]"		Cons:CavityLayerSymVal[6]  = {	FrameLayerSymVal[6]  }
	"Set Cons:CavityLayerSymVal[7]"		Cons:CavityLayerSymVal[7]  = {	FrameLayerSymVal[7]  }
	"Set Cons:CavityLayerSymVal[8]"		Cons:CavityLayerSymVal[8]  = {	FrameLayerSymVal[8]  }
	"Set Cons:CavityLayerSymVal[9]"		Cons:CavityLayerSymVal[9]  = {	FrameLayerSymVal[9]  }

   ; SAC 4/11/17 - related to user-defined sheating/insulation r-value
   ; SAC 5/11/17 - added logic for user-defined above-deck insulation r-value
   "Set Cons:LayerUsrInpInsRVal[1]"    Cons:LayerUsrInpInsRVal[1]  = {
         if (LayerPropertyIndex[1] == 2 .AND. AtcEdg_ClgCons:SheathInsulLayer == 99000)
         then  AtcEdg_ClgCons:SheathInsulLayerRVal
         else if (LayerPropertyIndex[1] == 7 .AND. AtcEdg_AtcCons:AbvDeckInsulLayer == 99000)
         then  AtcEdg_AtcCons:AbvDeckInsulLayerRVal  else  UNDEFINED  endif endif  }
   "Set Cons:LayerUsrInpInsRVal[2]"    Cons:LayerUsrInpInsRVal[2]  = {
         if (LayerPropertyIndex[2] == 2 .AND. AtcEdg_ClgCons:SheathInsulLayer == 99000)
         then  AtcEdg_ClgCons:SheathInsulLayerRVal
         else if (LayerPropertyIndex[2] == 7 .AND. AtcEdg_AtcCons:AbvDeckInsulLayer == 99000)
         then  AtcEdg_AtcCons:AbvDeckInsulLayerRVal  else  UNDEFINED  endif endif  }
   "Set Cons:LayerUsrInpInsRVal[3]"    Cons:LayerUsrInpInsRVal[3]  = {
         if (LayerPropertyIndex[3] == 7 .AND. AtcEdg_AtcCons:AbvDeckInsulLayer == 99000)
         then  AtcEdg_AtcCons:AbvDeckInsulLayerRVal  else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[4]"    Cons:LayerUsrInpInsRVal[4]  = {
         if (LayerPropertyIndex[4] == 7 .AND. AtcEdg_AtcCons:AbvDeckInsulLayer == 99000)
         then  AtcEdg_AtcCons:AbvDeckInsulLayerRVal  else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[5]"    Cons:LayerUsrInpInsRVal[5]  = {
         if (LayerPropertyIndex[5] == 7 .AND. AtcEdg_AtcCons:AbvDeckInsulLayer == 99000)
         then  AtcEdg_AtcCons:AbvDeckInsulLayerRVal  else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[6]"    Cons:LayerUsrInpInsRVal[6]  = {
         if (LayerPropertyIndex[6] == 7 .AND. AtcEdg_AtcCons:AbvDeckInsulLayer == 99000)
         then  AtcEdg_AtcCons:AbvDeckInsulLayerRVal  else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[7]"    Cons:LayerUsrInpInsRVal[7]  = {
         if (LayerPropertyIndex[7] == 7 .AND. AtcEdg_AtcCons:AbvDeckInsulLayer == 99000)
         then  AtcEdg_AtcCons:AbvDeckInsulLayerRVal  else  UNDEFINED  endif  }
   "Init Cons:LayerUsrInpInsRVal[8]"   Cons:LayerUsrInpInsRVal[8]  = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[9]"   Cons:LayerUsrInpInsRVal[9]  = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[10]"  Cons:LayerUsrInpInsRVal[10] = {  UNDEFINED  }

	"Set Cons:FrameSpacing"
		Cons:FrameSpacing		= {	AtcEdg_ClgBlwAtc:AtcEdg_WACons:FrameSpacing  }

	"Set Cons:FramingFactor => fraction of gross surface area that includes frame" 
		Cons:FramingFactor	= {	AtcEdg_ClgBlwAtc:AtcEdg_WACons:FramingFactor  }
	"Set Cons:PathFraction[1]"			Cons:PathFraction[1]	= {	if (IfValidAnd( FramingFactor >= 0 )) then  1 - FramingFactor  else  0  endif  }		; SAC 3/17/14
	"Set Cons:PathFraction[2]"			Cons:PathFraction[2]	= {	if (IfValidAnd( FramingFactor >= 0 )) then      FramingFactor  else  0  endif  }

; SAC 2/27/14 - now initialized in prior rulelist
;	"Init Cons:FrameCodeRValue"		Cons:FrameCodeRValue  = {	0.17 + 0.61  }   ; outside and inside film coeff. consistent w/ ACM JA4 (& ASHRAE fundamentals ??)

	"Remaining construction, R-val & U-val calcs"	Cons:Action = {	EvalRulelist( "SetupCons_GenericFramed", 1 )  }

	"Set Cons:CodeMaximumUValue"		Cons:CodeMaximumUValue	= {	0  }
	"Set Cons:CodeUValueLabel"			Cons:CodeUValueLabel		= {	" "  }
END

;*************************************************************************
RULELIST "SetupCons_CeilingBlwAttic"   0 0 0 1
;*************************************************************************
; INSIDE to OUTSIDE

	"Set Cons:FrameCavityLayerMat[1]"	Cons:FrameCavityLayerMat[1] = {	     if (Local( FrameLayer ) < 0.1) then  0     ; NO frame/cavity layer
																								else if (Local( InsideFinishLayer ) > 0.1 .AND. Local( SheathInsulLayer ) > 0.1 .AND.
                                                                                (SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 ))) then  3
																								else if (Local( InsideFinishLayer ) > 0.1 .OR. (Local( SheathInsulLayer ) > 0.1 .AND.
                                                                                (SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )))) then  2
																								else  1  endif endif endif  }
	"Set Cons:FrameCavityLayerMat[2]"	Cons:FrameCavityLayerMat[2]	= {	0  }

  ; SAC 9/4/12 - fixes to U-value calcs and construction object definitions for ceilings where blown in insulation sits atop attic floor joists
   "Set Cons:AbvJoistInsulThick"		Cons:AbvJoistInsulThick		= {	if (AtticFloorLayer > 0.1 .OR. Proj:InsulRValPerInch[1] <= 0) then  0		; Thickness of insulation above attic floor joists
																							else  max( 0, ((CavityLayerRVal / Proj:InsulRValPerInch[1]) - CavityThickness) )  endif  }    ; SAC 10/10/17 - ConductivityQII fix enabling selection of compressed insulation options (CavityLayer -> CavityLayerRVal)
  ; SAC 1/13/13 - revised Improved multiplier to 1.0
   	;  if (AtticFloorLayer > 0.1 .OR. CavityLayer < 0.1) then  0   - SAC 6/7/13 - removed condition where presence of attic floor layer caused ICQCeilingInsMult to get set to 0 - Google Code issue #113
  ; SAC 5/9/18 - added logic to prevent application of QII for constructions assigned to surfaces that are NOT children of New Zones (tic #775)
  ; SAC 5/18/18 - revised logic slightly to accommodate wall exception input (tic #798)
   "Set Cons:ICQCeilingInsMult"		Cons:ICQCeilingInsMult		= {
         if (CavityLayerRVal < 0.1) then  0
         else if (IfValidAnd( SurfacesQIIDegraded > 0 ))
         then               0.96  - (0.00347 * CavityLayerRVal)   ; prevent Improved QII for Cons assigned to Existing/Altered surfaces
			else  switch (Proj:InsulConsQuality)
						case 2 :  1.0						; 0.987 - (0.0017  * CavityLayer)
						default:  0.96  - (0.00347 * CavityLayerRVal)
					endswitch  endif endif  }    ; SAC 10/10/17 - ConductivityQII fix enabling selection of compressed insulation options (CavityLayer -> CavityLayerRVal)
;   "Set Cons:AbvJoistInsMatCond"		Cons:AbvJoistInsMatCond		= {	if (AbvJoistInsulThick < 0.0001) then  0
;																								else  Proj:ICQCeilingInsAddr + ((AbvJoistInsulThick / 12) / (AbvJoistInsulThick * Proj:InsulRValPerInch[1]))  endif  }		; Material conductance of insulation above attic floor joists
;	"Revise Cons:CavityMatCondQII"		Cons:CavityMatCondQII		= {	if (AbvJoistInsulThick <= 0) then  UNCHANGED
;																								else  Proj:ICQCeilingInsAddr + ((CavityThickness / 12) / (CavityThickness * Proj:InsulRValPerInch[1]))  endif  }     "dbg" Cons:Action = { PostMessageToLog( "   setting CavityMatCondQII[1] based on:   CavityLayer = %g   CavityLayerRVal = %g    for Cons '%s'", ValidOr( CavityLayer, -999 ), ValidOr( CavityLayerRVal, -999 ), Name )  }
	"Set Cons:CavityMatCondQII[1]"		Cons:CavityMatCondQII[1]	= {	if (CavityLayerRVal < 0.1 .OR. ICQCeilingInsMult < 0.0001 .OR. Proj:InsulRValPerInch[1] < 0.1) then  0
																								else  ((CavityLayerRVal / Proj:InsulRValPerInch[1]) / 12) / (CavityLayerRVal * ICQCeilingInsMult)
																								endif  }    ; SAC 10/10/17 - ConductivityQII fix enabling selection of compressed insulation options (CavityLayer -> CavityLayerRVal)
	"Set Cons:CavityMatCondQII[2]"		Cons:CavityMatCondQII[2]	= {	CavityMatCondQII[1]  }
	"Set Cons:CavityMatCondQII[3]"		Cons:CavityMatCondQII[3]	= {	CavityMatCondQII[1]  }
	"Set Cons:CavityMatCond[1]"			Cons:CavityMatCond[1]		= {	if (CavityLayerRVal < 0.1 .OR. Proj:InsulRValPerInch[1] < 0.1) then  0
																								else  ((CavityLayerRVal / Proj:InsulRValPerInch[1]) / 12) / CavityLayerRVal
																								endif  }    ; SAC 10/10/17 - ConductivityQII fix enabling selection of compressed insulation options (CavityLayer -> CavityLayerRVal)
	"Set Cons:CavityMatCond[2]"			Cons:CavityMatCond[2]		= {	CavityMatCond[1]  }
	"Set Cons:CavityMatCond[3]"			Cons:CavityMatCond[3]		= {	CavityMatCond[1]  }

	"Set Cons:NumLayerMats-1"		Cons:NumLayerMats = {	if (Local( InsideFinishLayer  ) > 0.1) then  1  else  0  endif  }
	"Set Cons:NumLayerMats-2"		Cons:NumLayerMats = {	if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                             Local( SheathInsulLayer   ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-3"		Cons:NumLayerMats = {	if (Local( FrameLayer         ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-4"		Cons:NumLayerMats = {	if (Local( AtticFloorLayer    ) > 0.1) then  Local( NumLayerMats ) + 1
																			else if (AbvJoistInsulThick     > 0  ) then	Local( NumLayerMats ) + 1	else  UNCHANGED  endif endif  }

; SAC 6/4/14 - added properties to be reported on CF1R
   "Set Cons:NumLayersRpt"		Cons:NumLayersRpt	= {	NumLayerMats  }
   ; SAC 4/25/17 - added raised heel truss info when selected (tic #823)
   "Set Cons:FramingRpt"		Cons:FramingRpt	= {	if (IfValidAnd( FrameLayer > 0 ))
                                                      then  if (IfValidAnd( RaisedHeelTruss > 0 ) .AND. IfValidAnd( RaisedHeelTrussHeight > 0 ))
                                                            then  Format( "%s with Raised Heel Truss Height %g in", EnumString( FrameLayer ), RaisedHeelTrussHeight )
                                                            else  EnumString( FrameLayer )  endif
                                                      else  " "  endif  }
   "Set Cons:CavityRRpt"		Cons:CavityRRpt	= {	if (IfValidAnd( CavityLayer > 0 ) .AND. IfValidAnd( CavityLayer < 100001 )) then  EnumString( CavityLayer )  else  "none"  endif  }

	; Mapping of this Index to Cons Properties:	1 =>	InsideFinishLayer 
	;															2 =>	SheathInsulLayer
	;															3 =>	FrameLayer  //  CavityLayer 
	;															4 =>	AtticFloorLayer
	;															5 =>	continuous insulation over attic floor joists     (SAC 9/4/12 - changes to reflect insulation over joists when no attic floor layer exists)
	"Set Cons:FrameLayerMapIdx[1]"		Cons:FrameLayerMapIdx[1]   = {	3  }	; index of Frame/Cavity layer in mapping listed above
	"Set Cons:FrameLayerMapIdx[2]"		Cons:FrameLayerMapIdx[2]   = {	0  }
	"Set Cons:AbvJoistInsLyrMapIdx"		Cons:AbvJoistInsLyrMapIdx  = {	if (AtticFloorLayer < 0.1) then  5  else  0  endif  }	; index of insulation above ceiling joists layer in mapping listed above
	"Set Cons:BlwJoistInsLyrMapIdx"		Cons:BlwJoistInsLyrMapIdx  = {	0  }	; index of insulation below roof joists layer in mapping listed above
	"Set Cons:LayerPropertyIndex[1]"		Cons:LayerPropertyIndex[1] = {		  if (InsideFinishLayer  > 0.1) then  1
																								else if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                 SheathInsulLayer   > 0.1) then  2
																								else if (FrameLayer         > 0.1) then  3
	                                                                     else if (AtticFloorLayer    > 0.1) then  4
																								else if (AbvJoistInsulThick > 0  ) then  5  else  0  endif endif endif endif endif  }
	"Set Cons:LayerPropertyIndex[2]"		Cons:LayerPropertyIndex[2] = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :		  if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                SheathInsulLayer   > 0.1) then  2
	                                                                     					else if (FrameLayer         > 0.1) then  3
	                                                                     					else if (AtticFloorLayer    > 0.1) then  4
																													else if (AbvJoistInsulThick > 0  ) then  5  else  0  endif endif endif endif
																									case  2 :		  if (FrameLayer         > 0.1) then  3
	                                                                     					else if (AtticFloorLayer    > 0.1) then  4
																													else if (AbvJoistInsulThick > 0  ) then  5  else  0  endif endif endif
																									case  3 :		  if (AtticFloorLayer    > 0.1) then  4
																													else if (AbvJoistInsulThick > 0  ) then  5  else  0  endif endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[3]"		Cons:LayerPropertyIndex[3] = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :		  if (FrameLayer         > 0.1) then  3
	                                                                     					else if (AtticFloorLayer    > 0.1) then  4
																													else if (AbvJoistInsulThick > 0  ) then  5  else  0  endif endif endif
																									case  3 :		  if (AtticFloorLayer    > 0.1) then  4
																													else if (AbvJoistInsulThick > 0  ) then  5  else  0  endif endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[4]"		Cons:LayerPropertyIndex[4] = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :		  if (AtticFloorLayer    > 0.1) then  4
																													else if (AbvJoistInsulThick > 0  ) then  5  else  0  endif endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[5]"		Cons:LayerPropertyIndex[5] = {	0  }
	"Set Cons:LayerPropertyIndex[6]"		Cons:LayerPropertyIndex[6] = {	0  }
	"Set Cons:LayerPropertyIndex[7]"		Cons:LayerPropertyIndex[7] = {	0  }

	"Set Cons:FrameLayerSymVal[1]"		Cons:FrameLayerSymVal[1]   = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	Local( InsideFinishLayer  )
																									case  2 :	Local( SheathInsulLayer   )
																									case  3 :	Local( FrameLayer         )
																									case  4 :	Local( AtticFloorLayer    )
																									case  5 :	AbvJoistInsulThick * Proj:InsulRValPerInch[1]
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[2]"		Cons:FrameLayerSymVal[2]   = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	Local( SheathInsulLayer   )
																									case  3 :	Local( FrameLayer         )
																									case  4 :	Local( AtticFloorLayer    )
																									case  5 :	AbvJoistInsulThick * Proj:InsulRValPerInch[1]
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[3]"		Cons:FrameLayerSymVal[3]   = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	Local( FrameLayer         )
																									case  4 :	Local( AtticFloorLayer    )
																									case  5 :	AbvJoistInsulThick * Proj:InsulRValPerInch[1]
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[4]"		Cons:FrameLayerSymVal[4]   = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	Local( AtticFloorLayer    )
																									case  5 :	AbvJoistInsulThick * Proj:InsulRValPerInch[1]
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[5]"		Cons:FrameLayerSymVal[5]   = {	0  }
	"Set Cons:FrameLayerSymVal[6]"		Cons:FrameLayerSymVal[6]   = {	0  }
	"Set Cons:FrameLayerSymVal[7]"		Cons:FrameLayerSymVal[7]   = {	0  }

  ; replace "2x4 Bottom Chord of Truss @ 24 in. O.C." with "2x4 @ 24 in. O.C."
	"Set Cons:FrameLayerSymVal[1]"		Cons:FrameLayerSymVal[1]   = {	if (Local( LayerPropertyIndex[1] ) == FrameLayerMapIdx[1] .AND. Local( FrameLayerSymVal[1] ) == 10424)
																								then  424  else  UNCHANGED  endif  }
	"Set Cons:FrameLayerSymVal[2]"		Cons:FrameLayerSymVal[2]   = {	if (Local( LayerPropertyIndex[2] ) == FrameLayerMapIdx[1] .AND. Local( FrameLayerSymVal[2] ) == 10424)
																								then  424  else  UNCHANGED  endif  }
	"Set Cons:FrameLayerSymVal[3]"		Cons:FrameLayerSymVal[3]   = {	if (Local( LayerPropertyIndex[3] ) == FrameLayerMapIdx[1] .AND. Local( FrameLayerSymVal[3] ) == 10424)
																								then  424  else  UNCHANGED  endif  }

  ; SAC 1/31/13 - revised rules to prevent CavityLayerSymVal[*] from exceeding the value of CavityLayer (caused CSE error when CavityLayer = 0)
  ; SAC 10/11/17 - CavityLayer -> CavityLayerRVal to handle compressed insulation options (tic #902)
	"Set Cons:CavityLayerSymVal[1]"		Cons:CavityLayerSymVal[1]  = {	if (Local( LayerPropertyIndex[1] ) == Local( FrameLayerMapIdx[1] ))
																								then  min( CavityLayerRVal, CavityThickness * Proj:InsulRValPerInch[1] )
																								else  Local( FrameLayerSymVal[1] )  endif  }
	"Set Cons:CavityLayerSymVal[2]"		Cons:CavityLayerSymVal[2]  = {	if (Local( LayerPropertyIndex[2] ) == Local( FrameLayerMapIdx[1] ))
																								then  min( CavityLayerRVal, CavityThickness * Proj:InsulRValPerInch[1] )
																								else  Local( FrameLayerSymVal[2] )  endif  }
	"Set Cons:CavityLayerSymVal[3]"		Cons:CavityLayerSymVal[3]  = {	if (Local( LayerPropertyIndex[3] ) == Local( FrameLayerMapIdx[1] ))
																								then  min( CavityLayerRVal, CavityThickness * Proj:InsulRValPerInch[1] )
																								else  Local( FrameLayerSymVal[3] )  endif  }
	"Set Cons:CavityLayerSymVal[4]"		Cons:CavityLayerSymVal[4]  = {	if (Local( LayerPropertyIndex[4] ) == Local( FrameLayerMapIdx[1] ))
																								then  min( CavityLayerRVal, CavityThickness * Proj:InsulRValPerInch[1] )
																								else  Local( FrameLayerSymVal[4] )  endif  }
	"Set Cons:CavityLayerSymVal[5]"		Cons:CavityLayerSymVal[5]  = {	0  }
	"Set Cons:CavityLayerSymVal[6]"		Cons:CavityLayerSymVal[6]  = {	0  }
	"Set Cons:CavityLayerSymVal[7]"		Cons:CavityLayerSymVal[7]  = {	0  }

   ; SAC 4/11/17 - related to user-defined sheating/insulation r-value
   "Set Cons:LayerUsrInpInsRVal[1]"    Cons:LayerUsrInpInsRVal[1]  = {
         if (LayerPropertyIndex[1] == 2 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal  else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[2]"    Cons:LayerUsrInpInsRVal[2]  = {
         if (LayerPropertyIndex[2] == 2 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal  else  UNDEFINED  endif  }
   "Init Cons:LayerUsrInpInsRVal[3]"   Cons:LayerUsrInpInsRVal[3]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[7]"   Cons:LayerUsrInpInsRVal[7]  = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[4]"   Cons:LayerUsrInpInsRVal[4]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[8]"   Cons:LayerUsrInpInsRVal[8]  = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[5]"   Cons:LayerUsrInpInsRVal[5]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[9]"   Cons:LayerUsrInpInsRVal[9]  = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[6]"   Cons:LayerUsrInpInsRVal[6]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[10]"  Cons:LayerUsrInpInsRVal[10] = {  UNDEFINED  }

  ; SAC 6/4/14 - added properties to be reported on CF1R
  ; SAC 10/11/17 - CavityLayer -> CavityLayerRVal to handle compressed insulation options (tic #902)
      ; SAC 7/18/19 - fixed LayerLabels[] indices for case 2 in following rules (5->3) (tic #879) 
      ; SAC 10/21/19 - hyphenated R-values (R## -> R-##) (tic #1121)
	"Set Cons:AssemblyLayersRpt[1]"		Cons:AssemblyLayersRpt[1]   = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	Format( "%s %s",  LayerLabels[4], EnumString( InsideFinishLayer  ))
																									case  2 :	if (SheathInsulLayer == 99000 .AND. IfValidAnd( SheathInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[3], FltToStr( SheathInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",  LayerLabels[3], EnumString( SheathInsulLayerRpt   ))  endif
																									case  3 :	if (IfValidAnd( CavityLayerAbr > 0 ) .AND. IfValidAnd( CavityLayerAbr < 1000 ))
																													then	Format( "%s R-%.1f / %s",  LayerLabels[2], min( CavityLayerRVal, CavityThickness * Proj:InsulRValPerInch[1] ), EnumString( FrameLayerAbr ))
																													else	Format( "%s %s / %s",      LayerLabels[2], EnumString( CavityLayerAbr ), EnumString( FrameLayerAbr ))  endif
																									case  4 :	Format( "%s %s",  LayerLabels[1], EnumString( AtticFloorLayer    ))
																									case  5 :	Format( "Over Ceiling Joists: R-%.1f insul.", FrameLayerSymVal[1] )
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[2]"		Cons:AssemblyLayersRpt[2]   = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	if (SheathInsulLayer == 99000 .AND. IfValidAnd( SheathInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[3], FltToStr( SheathInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",  LayerLabels[3], EnumString( SheathInsulLayerRpt   ))  endif
																									case  3 :	if (IfValidAnd( CavityLayerAbr > 0 ) .AND. IfValidAnd( CavityLayerAbr < 1000 ))
																													then	Format( "%s R-%.1f / %s",  LayerLabels[2], min( CavityLayerRVal, CavityThickness * Proj:InsulRValPerInch[1] ), EnumString( FrameLayerAbr ))
																													else	Format( "%s %s / %s",      LayerLabels[2], EnumString( CavityLayerAbr ), EnumString( FrameLayerAbr ))  endif
																									case  4 :	Format( "%s %s",  LayerLabels[1], EnumString( AtticFloorLayer    ))
																									case  5 :	Format( "Over Ceiling Joists: R-%.1f insul.", FrameLayerSymVal[2] )
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[3]"		Cons:AssemblyLayersRpt[3]   = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	if (IfValidAnd( CavityLayerAbr > 0 ) .AND. IfValidAnd( CavityLayerAbr < 1000 ))
																													then	Format( "%s R-%.1f / %s",  LayerLabels[2], min( CavityLayerRVal, CavityThickness * Proj:InsulRValPerInch[1] ), EnumString( FrameLayerAbr ))
																													else	Format( "%s %s / %s",      LayerLabels[2], EnumString( CavityLayerAbr ), EnumString( FrameLayerAbr ))  endif
																									case  4 :	Format( "%s %s",  LayerLabels[1], EnumString( AtticFloorLayer    ))
																									case  5 :	Format( "Over Ceiling Joists: R-%.1f insul.", FrameLayerSymVal[3] )
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[4]"		Cons:AssemblyLayersRpt[4]   = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	Format( "%s %s",  LayerLabels[1], EnumString( AtticFloorLayer    ))
																									case  5 :	Format( "Over Ceiling Joists: R-%.1f insul.", FrameLayerSymVal[4] )
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[5]"		Cons:AssemblyLayersRpt[5]   = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :	Format( "Over Ceiling Joists: R-%.1f insul.", FrameLayerSymVal[5] )
																									default : UNDEFINED
																								endswitch  }
	"Blast Cons:AssemblyLayersRpt[6]"	Cons:AssemblyLayersRpt[6]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[7]"	Cons:AssemblyLayersRpt[7]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[8]"	Cons:AssemblyLayersRpt[8]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[9]"	Cons:AssemblyLayersRpt[9]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[10]"	Cons:AssemblyLayersRpt[10]  = {	UNDEFINED  }

   ; SAC 10/22/19 - REVERSE the order of layers reported to CF1R (tic #1121)
   "Reverse assembly reporting order"     Cons:Action =
      {  if (IfValidAnd( NumLayersRpt > 1 )==0) then  UNCHANGED
         else  EvalRulelist( "SetupCons_ReverseAssemblyLayersRpt", 1 )  endif  }

	"Set Cons:FrameSpacing"	; SAC 2/14/12 - moved from ExtWall to facilitate wall splitting
		Cons:FrameSpacing		= {	if (Local( Type ) == 10)		; "Wood Framed Ceiling"
											then	if (Local( FrameLayer ) > 0)
													then  mod( Local( FrameLayer ), 100 )
													else  16		; no frame layer specified, so use generic default (??)
													endif
											else	0				; NOT "Wood Framed Ceiling", so no frame spacing used/valid (??)
											endif  }

	"Set Cons:FramingFactor => fraction of gross surface area that includes frame" 
		Cons:FramingFactor	= {	; All Roofs & Ceilings (exterior & interior)
											if (Local( Type ) == 10)		; "Wood Framed Ceiling"
											then	if (Local( FrameSpacing ) == 16)
													then  0.10    ; Wood - 16" OC						- from 2008 Joint App 4 - 4.1.6
													else if (Local( FrameSpacing ) == 24)
													then  0.07    ; Wood - 24" OC						- from 2008 Joint App 4 - 4.1.6
													else if (Local( FrameSpacing ) == 48)
													then  0.04    ; Wood - 48" OC						- from 2008 Joint App 4 - 4.1.6
													else  -1								; INVALID FRAME SPACING
													endif endif endif
											else  0  endif  }
	"Set Cons:PathFraction[1]"			Cons:PathFraction[1]	= {	if (IfValidAnd( FramingFactor >= 0 )) then  1 - FramingFactor  else  0  endif  }		; SAC 3/17/14
	"Set Cons:PathFraction[2]"			Cons:PathFraction[2]	= {	if (IfValidAnd( FramingFactor >= 0 )) then      FramingFactor  else  0  endif  }


; SAC 2/27/14 - now initialized in prior rulelist
;	"Init Cons:FrameCodeRValue"		Cons:FrameCodeRValue  = {	0.92 + 0.61  }   ; outside and inside film coeff. consistent w/ ACM JA4 (& ASHRAE fundamentals ??)

	"Remaining construction, R-val & U-val calcs"	Cons:Action = {	EvalRulelist( "SetupCons_GenericFramed", 1 )  }

	"Set Cons:CodeMaximumUValue"		Cons:CodeMaximumUValue	= {	0  }
;	"Set Cons:CodeMaximumUValue"		Cons:CodeMaximumUValue	= {	if (Global( Proj:ClimateZone ) < 0.5) then  -1
;																						else  ClimateZoneTable( Global( Proj:ClimateZone ), 6 ) + 0.00049  endif  }  ; SAC 2/13/13 - added 0.00049 to allow for check taking into account rounding

	"Set Cons:CodeUValueLabel"			Cons:CodeUValueLabel		= {	" "  }
;	"Set Cons:CodeUValueLabel"			Cons:CodeUValueLabel		= {	if (Local( CodeMaximumUValue ) < 0) then  " "    ; no message - nothing to report
;																						else if (Local( CodeMaximumUValue ) < Local( OverallCodeUValue ))
;																						then  Format( "(doesn't meet max code %.3f U-value (%.3f))", Local( CodeMaximumUValue ), Local( OverallCodeUValue ) )
;																						else  Format( "(meets max code %.3f U-value (%.3f))", Local( CodeMaximumUValue ), Local( OverallCodeUValue ) )
;																						endif endif  }
END

;*************************************************************************
RULELIST "SetupCons_IntCeiling_TwoPath"   0 0 0 1
;*************************************************************************
; INSIDE to OUTSIDE

	"Set Cons:FrameCavityLayerMat[1]"	Cons:FrameCavityLayerMat[1] = {	     if (Local( FrameLayer ) < 0.1) then  0     ; NO frame/cavity layer
																								else if (Local( InsideFinishLayer ) > 0.1 .AND. Local( SheathInsulLayer ) > 0.1 .AND.
                                                                                (SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 ))) then  3
																								else if (Local( InsideFinishLayer ) > 0.1 .OR. (Local( SheathInsulLayer ) > 0.1 .AND.
                                                                                (SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )))) then  2
																								else  1  endif endif endif  }
	"Set Cons:FrameCavityLayerMat[2]"	Cons:FrameCavityLayerMat[2]	= {	0  }

	"Set Cons:NumLayerMats-1"		Cons:NumLayerMats = {	if (Local( FloorSurfaceLayer    ) > 0.1) then  1  else  0  endif  }
	"Set Cons:NumLayerMats-2"		Cons:NumLayerMats = {	if (Local( FlrConcreteFillLayer ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-3"		Cons:NumLayerMats = {	if (Local( FloorDeckLayer       ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-4"		Cons:NumLayerMats = {	if (Local( FrameLayer           ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-5"		Cons:NumLayerMats = {	if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                             Local( SheathInsulLayer     ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-6"		Cons:NumLayerMats = {	if (Local( InsideFinishLayer    ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }

; SAC 6/4/14 - added properties to be reported on CF1R
   "Set Cons:NumLayersRpt"		Cons:NumLayersRpt	= {	NumLayerMats  }
   "Set Cons:FramingRpt"		Cons:FramingRpt	= {	if (IfValidAnd( FrameLayer > 0 )) then  EnumString( FrameLayer )  else  " "  endif  }
   "Set Cons:CavityRRpt"		Cons:CavityRRpt	= {	if (IfValidAnd( CavityLayer > 0 ) .AND. IfValidAnd( CavityLayer < 100001 )) then  EnumString( CavityLayer )  else  "none"  endif  }

	; Mapping of this Index to Cons Properties:	1 =>	InsideFinishLayer
	;															2 =>	SheathInsulLayer
	;															3 =>	FrameLayer  //  CavityLayer
	;															4 =>	FloorDeckLayer
	;															5 =>	FlrConcreteFillLayer
	;															6 =>	FloorSurfaceLayer
	"Set Cons:FrameLayerMapIdx[1]"		Cons:FrameLayerMapIdx[1]   = {	3  }	; index of Frame/Cavity layer in mapping listed above
	"Set Cons:FrameLayerMapIdx[2]"		Cons:FrameLayerMapIdx[2]   = {	0  }
	"Set Cons:AbvJoistInsLyrMapIdx"		Cons:AbvJoistInsLyrMapIdx  = {	0  }	; index of insulation above ceiling joists layer in mapping listed above
	"Set Cons:BlwJoistInsLyrMapIdx"		Cons:BlwJoistInsLyrMapIdx  = {	0  }	; index of insulation below roof joists layer in mapping listed above
	"Set Cons:LayerPropertyIndex[1]"		Cons:LayerPropertyIndex[1] = {		  if (Local( InsideFinishLayer    ) > 0.1) then  1
																								else if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                 Local( SheathInsulLayer     ) > 0.1) then  2
																								else if (Local( FrameLayer           ) > 0.1) then  3
	                                                                     else if (Local( FloorDeckLayer       ) > 0.1) then  4
	                                                                     else if (Local( FlrConcreteFillLayer ) > 0.1) then  5
	                                                                     else if (Local( FloorSurfaceLayer    ) > 0.1) then  6  else  0  endif endif endif endif endif endif  }
	"Set Cons:LayerPropertyIndex[2]"		Cons:LayerPropertyIndex[2] = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :		  if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer     ) > 0.1) then  2
	                                                                     					else if (Local( FrameLayer           ) > 0.1) then  3
	                                                                     					else if (Local( FloorDeckLayer       ) > 0.1) then  4
	                                                                     					else if (Local( FlrConcreteFillLayer ) > 0.1) then  5
	                                                                     					else if (Local( FloorSurfaceLayer    ) > 0.1) then  6  else  0  endif endif endif endif endif
																									case  2 :		  if (Local( FrameLayer           ) > 0.1) then  3
	                                                                     					else if (Local( FloorDeckLayer       ) > 0.1) then  4
	                                                                     					else if (Local( FlrConcreteFillLayer ) > 0.1) then  5
	                                                                     					else if (Local( FloorSurfaceLayer    ) > 0.1) then  6  else  0  endif endif endif endif
																									case  3 :		  if (Local( FloorDeckLayer       ) > 0.1) then  4
	                                                                     					else if (Local( FlrConcreteFillLayer ) > 0.1) then  5
	                                                                     					else if (Local( FloorSurfaceLayer    ) > 0.1) then  6  else  0  endif endif endif
																									case  4 :		  if (Local( FlrConcreteFillLayer ) > 0.1) then  5
	                                                                     					else if (Local( FloorSurfaceLayer    ) > 0.1) then  6  else  0  endif endif
	                                                                     	case  5 :		  if (Local( FloorSurfaceLayer    ) > 0.1) then  6  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[3]"		Cons:LayerPropertyIndex[3] = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :		  if (Local( FrameLayer           ) > 0.1) then  3
	                                                                     					else if (Local( FloorDeckLayer       ) > 0.1) then  4
	                                                                     					else if (Local( FlrConcreteFillLayer ) > 0.1) then  5
	                                                                     					else if (Local( FloorSurfaceLayer    ) > 0.1) then  6  else  0  endif endif endif endif
																									case  3 :		  if (Local( FloorDeckLayer       ) > 0.1) then  4
	                                                                     					else if (Local( FlrConcreteFillLayer ) > 0.1) then  5
	                                                                     					else if (Local( FloorSurfaceLayer    ) > 0.1) then  6  else  0  endif endif endif
																									case  4 :		  if (Local( FlrConcreteFillLayer ) > 0.1) then  5
	                                                                     					else if (Local( FloorSurfaceLayer    ) > 0.1) then  6  else  0  endif endif
	                                                                     	case  5 :		  if (Local( FloorSurfaceLayer    ) > 0.1) then  6  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[4]"		Cons:LayerPropertyIndex[4] = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :		  if (Local( FloorDeckLayer       ) > 0.1) then  4
	                                                                     					else if (Local( FlrConcreteFillLayer ) > 0.1) then  5
	                                                                     					else if (Local( FloorSurfaceLayer    ) > 0.1) then  6  else  0  endif endif endif
																									case  4 :		  if (Local( FlrConcreteFillLayer ) > 0.1) then  5
	                                                                     					else if (Local( FloorSurfaceLayer    ) > 0.1) then  6  else  0  endif endif
	                                                                     	case  5 :		  if (Local( FloorSurfaceLayer    ) > 0.1) then  6  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[5]"		Cons:LayerPropertyIndex[5] = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :		  if (Local( FlrConcreteFillLayer ) > 0.1) then  5
	                                                                     					else if (Local( FloorSurfaceLayer    ) > 0.1) then  6  else  0  endif endif
	                                                                     	case  5 :		  if (Local( FloorSurfaceLayer    ) > 0.1) then  6  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[6]"		Cons:LayerPropertyIndex[6] = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :		  if (Local( FloorSurfaceLayer    ) > 0.1) then  6  else  0  endif
																									default :   0
																								endswitch  }

	"Set Cons:FrameLayerSymVal[1]"		Cons:FrameLayerSymVal[1]   = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	Local( InsideFinishLayer    )
																									case  2 :	Local( SheathInsulLayer     )
																									case  3 :	Local( FrameLayer           )
																									case  4 :	Local( FloorDeckLayer       )
																									case  5 :	Local( FlrConcreteFillLayer )
																									case  6 :	Local( FloorSurfaceLayer    )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[2]"		Cons:FrameLayerSymVal[2]   = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	Local( SheathInsulLayer     )
																									case  3 :	Local( FrameLayer           )
																									case  4 :	Local( FloorDeckLayer       )
																									case  5 :	Local( FlrConcreteFillLayer )
																									case  6 :	Local( FloorSurfaceLayer    )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[3]"		Cons:FrameLayerSymVal[3]   = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	Local( FrameLayer           )
																									case  4 :	Local( FloorDeckLayer       )
																									case  5 :	Local( FlrConcreteFillLayer )
																									case  6 :	Local( FloorSurfaceLayer    )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[4]"		Cons:FrameLayerSymVal[4]   = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	Local( FloorDeckLayer       )
																									case  5 :	Local( FlrConcreteFillLayer )
																									case  6 :	Local( FloorSurfaceLayer    )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[5]"		Cons:FrameLayerSymVal[5]   = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :	Local( FlrConcreteFillLayer )
																									case  6 :	Local( FloorSurfaceLayer    )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[6]"		Cons:FrameLayerSymVal[6]   = {	switch (Local( LayerPropertyIndex[6] ))
																									case  6 :	Local( FloorSurfaceLayer    )
																									default : 0
																								endswitch  }

   ; SAC 5/15/17 - added compressed R-value selections - R-val = (SymVal-mod(SymVal,10))/100  (tic #761)
	"Set Cons:CavityLayerSymVal[1]"		Cons:CavityLayerSymVal[1]  = {
         if (Local( LayerPropertyIndex[1] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[1] )  endif  }
	"Set Cons:CavityLayerSymVal[2]"		Cons:CavityLayerSymVal[2]  = {
         if (Local( LayerPropertyIndex[2] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[2] )  endif  }
	"Set Cons:CavityLayerSymVal[3]"		Cons:CavityLayerSymVal[3]  = {
         if (Local( LayerPropertyIndex[3] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[3] )  endif  }
	"Set Cons:CavityLayerSymVal[4]"		Cons:CavityLayerSymVal[4]  = {
         if (Local( LayerPropertyIndex[4] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[4] )  endif  }
	"Set Cons:CavityLayerSymVal[5]"		Cons:CavityLayerSymVal[5]  = {
         if (Local( LayerPropertyIndex[5] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[5] )  endif  }
	"Set Cons:CavityLayerSymVal[6]"		Cons:CavityLayerSymVal[6]  = {
         if (Local( LayerPropertyIndex[6] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[6] )  endif  }

   ; SAC 4/11/17 - related to user-defined sheating/insulation r-value
   "Set Cons:LayerUsrInpInsRVal[1]"    Cons:LayerUsrInpInsRVal[1]  = {
         if (LayerPropertyIndex[1] == 2 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal  else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[2]"    Cons:LayerUsrInpInsRVal[2]  = {
         if (LayerPropertyIndex[2] == 2 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal  else  UNDEFINED  endif  }
   "Init Cons:LayerUsrInpInsRVal[3]"   Cons:LayerUsrInpInsRVal[3]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[7]"   Cons:LayerUsrInpInsRVal[7]  = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[4]"   Cons:LayerUsrInpInsRVal[4]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[8]"   Cons:LayerUsrInpInsRVal[8]  = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[5]"   Cons:LayerUsrInpInsRVal[5]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[9]"   Cons:LayerUsrInpInsRVal[9]  = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[6]"   Cons:LayerUsrInpInsRVal[6]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[10]"  Cons:LayerUsrInpInsRVal[10] = {  UNDEFINED  }

; SAC 6/4/14 - added properties to be reported on CF1R	; SAC 1/8/15 - revisions to align LayerLabels[] w/ proper mat layers (GC issue 448)
	"Set Cons:AssemblyLayersRpt[1]"		Cons:AssemblyLayersRpt[1]   = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	Format( "%s %s",      LayerLabels[6], EnumString( InsideFinishLayer    ))
																									case  2 :	if (SheathInsulLayer == 99000 .AND. IfValidAnd( SheathInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[5], FltToStr( SheathInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[5], EnumString( SheathInsulLayerRpt     ))  endif
																									case  3 :	Format( "%s %s / %s", LayerLabels[4], EnumString( CavityLayerAbr       ), EnumString( FrameLayerAbr ))
																									case  4 :	Format( "%s %s",      LayerLabels[3], EnumString( FloorDeckLayer       ))
																									case  5 :	Format( "%s %s",      LayerLabels[2], EnumString( FlrConcreteFillLayer ))
																									case  6 :	Format( "%s %s",      LayerLabels[1], EnumString( FloorSurfaceLayer    ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[2]"		Cons:AssemblyLayersRpt[2]   = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	if (SheathInsulLayer == 99000 .AND. IfValidAnd( SheathInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[5], FltToStr( SheathInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[5], EnumString( SheathInsulLayerRpt     ))  endif
																									case  3 :	Format( "%s %s / %s", LayerLabels[4], EnumString( CavityLayerAbr       ), EnumString( FrameLayerAbr ))
																									case  4 :	Format( "%s %s",      LayerLabels[3], EnumString( FloorDeckLayer       ))
																									case  5 :	Format( "%s %s",      LayerLabels[2], EnumString( FlrConcreteFillLayer ))
																									case  6 :	Format( "%s %s",      LayerLabels[1], EnumString( FloorSurfaceLayer    ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[3]"		Cons:AssemblyLayersRpt[3]   = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	Format( "%s %s / %s", LayerLabels[4], EnumString( CavityLayerAbr       ), EnumString( FrameLayerAbr ))
																									case  4 :	Format( "%s %s",      LayerLabels[3], EnumString( FloorDeckLayer       ))
																									case  5 :	Format( "%s %s",      LayerLabels[2], EnumString( FlrConcreteFillLayer ))
																									case  6 :	Format( "%s %s",      LayerLabels[1], EnumString( FloorSurfaceLayer    ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[4]"		Cons:AssemblyLayersRpt[4]   = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	Format( "%s %s",      LayerLabels[3], EnumString( FloorDeckLayer       ))
																									case  5 :	Format( "%s %s",      LayerLabels[2], EnumString( FlrConcreteFillLayer ))
																									case  6 :	Format( "%s %s",      LayerLabels[1], EnumString( FloorSurfaceLayer    ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[5]"		Cons:AssemblyLayersRpt[5]   = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :	Format( "%s %s",      LayerLabels[2], EnumString( FlrConcreteFillLayer ))
																									case  6 :	Format( "%s %s",      LayerLabels[1], EnumString( FloorSurfaceLayer    ))
																									default : UNDEFINED
																								endswitch  }
	"Blast Cons:AssemblyLayersRpt[6]"	Cons:AssemblyLayersRpt[6]   = {	switch (Local( LayerPropertyIndex[6] ))
																									case  6 :	Format( "%s %s",      LayerLabels[1], EnumString( FloorSurfaceLayer    ))
																									default : UNDEFINED
																								endswitch  }
	"Blast Cons:AssemblyLayersRpt[7]"	Cons:AssemblyLayersRpt[7]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[8]"	Cons:AssemblyLayersRpt[8]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[9]"	Cons:AssemblyLayersRpt[9]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[10]"	Cons:AssemblyLayersRpt[10]  = {	UNDEFINED  }

   ; SAC 10/22/19 - REVERSE the order of layers reported to CF1R (tic #1121)
   "Reverse assembly reporting order"     Cons:Action =
      {  if (IfValidAnd( NumLayersRpt > 1 )==0) then  UNCHANGED
         else  EvalRulelist( "SetupCons_ReverseAssemblyLayersRpt", 1 )  endif  }

	"Set Cons:FrameSpacing"	; SAC 2/14/12 - moved from ExtWall to facilitate wall splitting
		Cons:FrameSpacing		= {	if (Local( Type ) == 10)			; "Wood Framed Ceiling"
											then	if (Local( FrameLayer ) > 0)
													then  mod( Local( FrameLayer ), 100 )
													else  16		; no frame layer specified, so use generic default (??)
													endif
											else	0				; NOT "Wood Framed Floor", so no frame spacing used/valid (??)
											endif  }

	"Set Cons:FramingFactor => fraction of gross surface area that includes frame" 
		Cons:FramingFactor	= {	; Exterior Floors
											if (Local( Type ) == 10)			; "Wood Framed Ceiling"
											then	if (Local( FrameSpacing ) == 16)
													then  0.10    ; Wood - 16" OC						- from 2008 Joint App 4 - 4.1.6
													else if (Local( FrameSpacing ) == 24)
													then  0.07    ; Wood - 24" OC						- from 2008 Joint App 4 - 4.1.6
													else  -1								; INVALID FRAME SPACING
													endif endif
											else  0  endif  }
	"Set Cons:PathFraction[1]"			Cons:PathFraction[1]	= {	if (IfValidAnd( FramingFactor >= 0 )) then  1 - FramingFactor  else  0  endif  }		; SAC 3/17/14
	"Set Cons:PathFraction[2]"			Cons:PathFraction[2]	= {	if (IfValidAnd( FramingFactor >= 0 )) then      FramingFactor  else  0  endif  }

; SAC 2/27/14 - now initialized in prior rulelist
;	"Init Cons:FrameCodeRValue"		Cons:FrameCodeRValue  = {	0.92 + 0.61  }   ; outside and inside film coeff. consistent w/ ACM JA4 (& ASHRAE fundamentals ??)

	"Remaining construction, R-val & U-val calcs"	Cons:Action = {	EvalRulelist( "SetupCons_GenericFramed", 1 )  }

	"Set Cons:CodeMaximumUValue"		Cons:CodeMaximumUValue	= {	0  }
;	"Set Cons:CodeMaximumUValue"		Cons:CodeMaximumUValue	= {	if (Global( Proj:ClimateZone ) < 0.5) then  -1
;																						else  ClimateZoneTable( Global( Proj:ClimateZone ), 6 ) + 0.00049  endif  }  ; SAC 2/13/13 - added 0.00049 to allow for check taking into account rounding

	"Set Cons:CodeUValueLabel"			Cons:CodeUValueLabel		= {	" "  }
;	"Set Cons:CodeUValueLabel"			Cons:CodeUValueLabel		= {	if (Local( CodeMaximumUValue ) < 0) then  " "    ; no message - nothing to report
;																						else if (Local( CodeMaximumUValue ) < Local( OverallCodeUValue ))
;																						then  Format( "(doesn't meet max code %.3f U-value (%.3f))", Local( CodeMaximumUValue ), Local( OverallCodeUValue ) )
;																						else  Format( "(meets max code %.3f U-value (%.3f))", Local( CodeMaximumUValue ), Local( OverallCodeUValue ) )
;																						endif endif  }
END

;*************************************************************************
RULELIST "SetupCons_IntFloor_TwoPath"   0 0 0 1
;*************************************************************************
; INSIDE to OUTSIDE

	"Set Cons:FrameCavityLayerMat[1]"	Cons:FrameCavityLayerMat[1] = {	     if (Local( FrameLayer ) < 0.1) then  0     ; NO frame/cavity layer
																								else if (Local( FloorSurfaceLayer ) > 0.1 .AND. Local( FlrConcreteFillLayer ) > 0.1 .AND. Local( FloorDeckLayer ) > 0.1) then  4
																								else if ( (Local( FloorSurfaceLayer    ) > 0.1 .AND. Local( FlrConcreteFillLayer ) > 0.1) .OR.
																											 (Local( FlrConcreteFillLayer ) > 0.1 .AND. Local( FloorDeckLayer       ) > 0.1) .OR.
																											 (Local( FloorSurfaceLayer    ) > 0.1 .AND. Local( FloorDeckLayer       ) > 0.1) ) then  3
																								else if (Local( FloorSurfaceLayer ) > 0.1 .OR.  Local( FlrConcreteFillLayer ) > 0.1 .OR.  Local( FloorDeckLayer ) > 0.1) then  2
																								else  1  endif endif endif endif  }
	"Set Cons:FrameCavityLayerMat[2]"	Cons:FrameCavityLayerMat[2]	= {	0  }

	"Set Cons:NumLayerMats-1"		Cons:NumLayerMats = {	if (Local( FloorSurfaceLayer    ) > 0.1) then  1  else  0  endif  }
	"Set Cons:NumLayerMats-2"		Cons:NumLayerMats = {	if (Local( FlrConcreteFillLayer ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-3"		Cons:NumLayerMats = {	if (Local( FloorDeckLayer       ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-4"		Cons:NumLayerMats = {	if (Local( FrameLayer           ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-5"		Cons:NumLayerMats = {	if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                             Local( SheathInsulLayer     ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-6"		Cons:NumLayerMats = {	if (Local( InsideFinishLayer    ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }

; SAC 6/4/14 - added properties to be reported on CF1R
   "Set Cons:NumLayersRpt"		Cons:NumLayersRpt	= {	NumLayerMats  }
   "Set Cons:FramingRpt"		Cons:FramingRpt	= {	if (IfValidAnd( FrameLayer > 0 )) then  EnumString( FrameLayer )  else  " "  endif  }
   "Set Cons:CavityRRpt"		Cons:CavityRRpt	= {	if (IfValidAnd( CavityLayer > 0 ) .AND. IfValidAnd( CavityLayer < 100001 )) then  EnumString( CavityLayer )  else  "none"  endif  }

	; Mapping of this Index to Cons Properties:	1 =>	FloorSurfaceLayer    
	;															2 =>	FlrConcreteFillLayer 
	;															3 =>	FloorDeckLayer       
	;															4 =>	FrameLayer  //  CavityLayer 
	;															5 =>	SheathInsulLayer 
	;															6 =>	InsideFinishLayer
	"Set Cons:FrameLayerMapIdx[1]"		Cons:FrameLayerMapIdx[1]   = {	4  }	; index of Frame/Cavity layer in mapping listed above
	"Set Cons:FrameLayerMapIdx[2]"		Cons:FrameLayerMapIdx[2]   = {	0  }
	"Set Cons:AbvJoistInsLyrMapIdx"		Cons:AbvJoistInsLyrMapIdx  = {	0  }	; index of insulation above ceiling joists layer in mapping listed above
	"Set Cons:BlwJoistInsLyrMapIdx"		Cons:BlwJoistInsLyrMapIdx  = {	0  }	; index of insulation below roof joists layer in mapping listed above
	"Set Cons:LayerPropertyIndex[1]"		Cons:LayerPropertyIndex[1] = {		  if (Local( FloorSurfaceLayer    ) > 0.1) then  1
																								else if (Local( FlrConcreteFillLayer ) > 0.1) then  2
																								else if (Local( FloorDeckLayer       ) > 0.1) then  3
	                                                                     else if (Local( FrameLayer           ) > 0.1) then  4
	                                                                     else if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                 Local( SheathInsulLayer     ) > 0.1) then  5
	                                                                     else if (Local( InsideFinishLayer    ) > 0.1) then  6  else  0  endif endif endif endif endif endif  }
	"Set Cons:LayerPropertyIndex[2]"		Cons:LayerPropertyIndex[2] = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :		  if (Local( FlrConcreteFillLayer ) > 0.1) then  2
	                                                                     					else if (Local( FloorDeckLayer       ) > 0.1) then  3
	                                                                     					else if (Local( FrameLayer           ) > 0.1) then  4
	                                                                     					else if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer     ) > 0.1) then  5
	                                                                     					else if (Local( InsideFinishLayer    ) > 0.1) then  6  else  0  endif endif endif endif endif
																									case  2 :		  if (Local( FloorDeckLayer       ) > 0.1) then  3
	                                                                     					else if (Local( FrameLayer           ) > 0.1) then  4
	                                                                     					else if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer     ) > 0.1) then  5
	                                                                     					else if (Local( InsideFinishLayer    ) > 0.1) then  6  else  0  endif endif endif endif
																									case  3 :		  if (Local( FrameLayer           ) > 0.1) then  4
	                                                                     					else if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer     ) > 0.1) then  5
	                                                                     					else if (Local( InsideFinishLayer    ) > 0.1) then  6  else  0  endif endif endif
																									case  4 :		  if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer     ) > 0.1) then  5
	                                                                     					else if (Local( InsideFinishLayer    ) > 0.1) then  6  else  0  endif endif
	                                                                     	case  5 :		  if (Local( InsideFinishLayer    ) > 0.1) then  6  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[3]"		Cons:LayerPropertyIndex[3] = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :		  if (Local( FloorDeckLayer       ) > 0.1) then  3
	                                                                     					else if (Local( FrameLayer           ) > 0.1) then  4
	                                                                     					else if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer     ) > 0.1) then  5
	                                                                     					else if (Local( InsideFinishLayer    ) > 0.1) then  6  else  0  endif endif endif endif
																									case  3 :		  if (Local( FrameLayer           ) > 0.1) then  4
	                                                                     					else if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer     ) > 0.1) then  5
	                                                                     					else if (Local( InsideFinishLayer    ) > 0.1) then  6  else  0  endif endif endif
																									case  4 :		  if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer     ) > 0.1) then  5
	                                                                     					else if (Local( InsideFinishLayer    ) > 0.1) then  6  else  0  endif endif
	                                                                     	case  5 :		  if (Local( InsideFinishLayer    ) > 0.1) then  6  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[4]"		Cons:LayerPropertyIndex[4] = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :		  if (Local( FrameLayer           ) > 0.1) then  4
	                                                                     					else if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer     ) > 0.1) then  5
	                                                                     					else if (Local( InsideFinishLayer    ) > 0.1) then  6  else  0  endif endif endif
																									case  4 :		  if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer     ) > 0.1) then  5
	                                                                     					else if (Local( InsideFinishLayer    ) > 0.1) then  6  else  0  endif endif
	                                                                     	case  5 :		  if (Local( InsideFinishLayer    ) > 0.1) then  6  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[5]"		Cons:LayerPropertyIndex[5] = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :		  if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer     ) > 0.1) then  5
	                                                                     					else if (Local( InsideFinishLayer    ) > 0.1) then  6  else  0  endif endif
	                                                                     	case  5 :		  if (Local( InsideFinishLayer    ) > 0.1) then  6  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[6]"		Cons:LayerPropertyIndex[6] = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :		  if (Local( InsideFinishLayer    ) > 0.1) then  6  else  0  endif
																									default :   0
																								endswitch  }

	"Set Cons:FrameLayerSymVal[1]"		Cons:FrameLayerSymVal[1]   = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	Local( FloorSurfaceLayer    )
																									case  2 :	Local( FlrConcreteFillLayer )
																									case  3 :	Local( FloorDeckLayer       )
																									case  4 :	Local( FrameLayer           )
																									case  5 :	Local( SheathInsulLayer     )
																									case  6 :	Local( InsideFinishLayer    )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[2]"		Cons:FrameLayerSymVal[2]   = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	Local( FlrConcreteFillLayer )
																									case  3 :	Local( FloorDeckLayer       )
																									case  4 :	Local( FrameLayer           )
																									case  5 :	Local( SheathInsulLayer     )
																									case  6 :	Local( InsideFinishLayer    )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[3]"		Cons:FrameLayerSymVal[3]   = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	Local( FloorDeckLayer       )
																									case  4 :	Local( FrameLayer           )
																									case  5 :	Local( SheathInsulLayer     )
																									case  6 :	Local( InsideFinishLayer    )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[4]"		Cons:FrameLayerSymVal[4]   = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	Local( FrameLayer           )
																									case  5 :	Local( SheathInsulLayer     )
																									case  6 :	Local( InsideFinishLayer    )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[5]"		Cons:FrameLayerSymVal[5]   = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :	Local( SheathInsulLayer     )
																									case  6 :	Local( InsideFinishLayer    )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[6]"		Cons:FrameLayerSymVal[6]   = {	switch (Local( LayerPropertyIndex[6] ))
																									case  6 :	Local( InsideFinishLayer    )
																									default : 0
																								endswitch  }

   ; SAC 5/15/17 - added compressed R-value selections - R-val = (SymVal-mod(SymVal,10))/100  (tic #761)
	"Set Cons:CavityLayerSymVal[1]"		Cons:CavityLayerSymVal[1]  = {
         if (Local( LayerPropertyIndex[1] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[1] )  endif  }
	"Set Cons:CavityLayerSymVal[2]"		Cons:CavityLayerSymVal[2]  = {
         if (Local( LayerPropertyIndex[2] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[2] )  endif  }
	"Set Cons:CavityLayerSymVal[3]"		Cons:CavityLayerSymVal[3]  = {
         if (Local( LayerPropertyIndex[3] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[3] )  endif  }
	"Set Cons:CavityLayerSymVal[4]"		Cons:CavityLayerSymVal[4]  = {
         if (Local( LayerPropertyIndex[4] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[4] )  endif  }
	"Set Cons:CavityLayerSymVal[5]"		Cons:CavityLayerSymVal[5]  = {
         if (Local( LayerPropertyIndex[5] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[5] )  endif  }
	"Set Cons:CavityLayerSymVal[6]"		Cons:CavityLayerSymVal[6]  = {
         if (Local( LayerPropertyIndex[6] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[6] )  endif  }

   ; SAC 4/11/17 - related to user-defined sheating/insulation r-value
   "Set Cons:LayerUsrInpInsRVal[1]"    Cons:LayerUsrInpInsRVal[1]  = {
         if (LayerPropertyIndex[1] == 5 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal  else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[2]"    Cons:LayerUsrInpInsRVal[2]  = {
         if (LayerPropertyIndex[2] == 5 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal  else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[3]"    Cons:LayerUsrInpInsRVal[3]  = {
         if (LayerPropertyIndex[3] == 5 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal  else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[4]"    Cons:LayerUsrInpInsRVal[4]  = {
         if (LayerPropertyIndex[4] == 5 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal  else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[5]"    Cons:LayerUsrInpInsRVal[5]  = {
         if (LayerPropertyIndex[5] == 5 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal  else  UNDEFINED  endif  }
   "Init Cons:LayerUsrInpInsRVal[6]"   Cons:LayerUsrInpInsRVal[6]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[9]"   Cons:LayerUsrInpInsRVal[9]  = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[7]"   Cons:LayerUsrInpInsRVal[7]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[10]"  Cons:LayerUsrInpInsRVal[10] = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[8]"   Cons:LayerUsrInpInsRVal[8]  = {  UNDEFINED  }

; SAC 6/4/14 - added properties to be reported on CF1R
      ; SAC 10/21/19 - hyphenated R-values (R## -> R-##) (tic #1121)
	"Set Cons:AssemblyLayersRpt[1]"		Cons:AssemblyLayersRpt[1]   = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	Format( "%s %s",      LayerLabels[1], EnumString( FloorSurfaceLayer    ))
																									case  2 :	Format( "%s %s",      LayerLabels[2], EnumString( FlrConcreteFillLayer ))
																									case  3 :	Format( "%s %s",      LayerLabels[3], EnumString( FloorDeckLayer       ))
																									case  4 :	Format( "%s %s / %s", LayerLabels[4], EnumString( CavityLayerAbr       ), EnumString( FrameLayerAbr ))
																									case  5 :	if (SheathInsulLayer == 99000 .AND. IfValidAnd( SheathInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[5], FltToStr( SheathInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[5], EnumString( SheathInsulLayerRpt     ))  endif
																									case  6 :	Format( "%s %s",      LayerLabels[6], EnumString( InsideFinishLayer    ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[2]"		Cons:AssemblyLayersRpt[2]   = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	Format( "%s %s",      LayerLabels[2], EnumString( FlrConcreteFillLayer ))
																									case  3 :	Format( "%s %s",      LayerLabels[3], EnumString( FloorDeckLayer       ))
																									case  4 :	Format( "%s %s / %s", LayerLabels[4], EnumString( CavityLayerAbr       ), EnumString( FrameLayerAbr ))
																									case  5 :	if (SheathInsulLayer == 99000 .AND. IfValidAnd( SheathInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[5], FltToStr( SheathInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[5], EnumString( SheathInsulLayerRpt     ))  endif
																									case  6 :	Format( "%s %s",      LayerLabels[6], EnumString( InsideFinishLayer    ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[3]"		Cons:AssemblyLayersRpt[3]   = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	Format( "%s %s",      LayerLabels[3], EnumString( FloorDeckLayer       ))
																									case  4 :	Format( "%s %s / %s", LayerLabels[4], EnumString( CavityLayerAbr       ), EnumString( FrameLayerAbr ))
																									case  5 :	if (SheathInsulLayer == 99000 .AND. IfValidAnd( SheathInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[5], FltToStr( SheathInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[5], EnumString( SheathInsulLayerRpt     ))  endif
																									case  6 :	Format( "%s %s",      LayerLabels[6], EnumString( InsideFinishLayer    ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[4]"		Cons:AssemblyLayersRpt[4]   = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	Format( "%s %s / %s", LayerLabels[4], EnumString( CavityLayerAbr       ), EnumString( FrameLayerAbr ))
																									case  5 :	if (SheathInsulLayer == 99000 .AND. IfValidAnd( SheathInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[5], FltToStr( SheathInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[5], EnumString( SheathInsulLayerRpt     ))  endif
																									case  6 :	Format( "%s %s",      LayerLabels[6], EnumString( InsideFinishLayer    ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[5]"		Cons:AssemblyLayersRpt[5]   = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :	if (SheathInsulLayer == 99000 .AND. IfValidAnd( SheathInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[5], FltToStr( SheathInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[5], EnumString( SheathInsulLayerRpt     ))  endif
																									case  6 :	Format( "%s %s",      LayerLabels[6], EnumString( InsideFinishLayer    ))
																									default : UNDEFINED
																								endswitch  }
	"Blast Cons:AssemblyLayersRpt[6]"	Cons:AssemblyLayersRpt[6]   = {	switch (Local( LayerPropertyIndex[6] ))
																									case  6 :	Format( "%s %s",      LayerLabels[6], EnumString( InsideFinishLayer    ))
																									default : UNDEFINED
																								endswitch  }
	"Blast Cons:AssemblyLayersRpt[7]"	Cons:AssemblyLayersRpt[7]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[8]"	Cons:AssemblyLayersRpt[8]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[9]"	Cons:AssemblyLayersRpt[9]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[10]"	Cons:AssemblyLayersRpt[10]  = {	UNDEFINED  }

	"Set Cons:FrameSpacing"	; SAC 2/14/12 - moved from ExtWall to facilitate wall splitting
		Cons:FrameSpacing		= {	if (Local( Type ) == 20)			; "Wood Framed Floor"
											then	if (Local( FrameLayer ) > 0)
													then  mod( Local( FrameLayer ), 100 )
													else  16		; no frame layer specified, so use generic default (??)
													endif
											else	0				; NOT "Wood Framed Floor", so no frame spacing used/valid (??)
											endif  }

	"Set Cons:FramingFactor => fraction of gross surface area that includes frame" 
		Cons:FramingFactor	= {	; Exterior Floors
											if (Local( Type ) == 20)			; "Wood Framed Floor"
											then	if (Local( FrameSpacing ) == 16)
													then  0.10    ; Wood - 16" OC						- from 2008 Joint App 4 - 4.1.6
													else if (Local( FrameSpacing ) == 24)
													then  0.07    ; Wood - 24" OC						- from 2008 Joint App 4 - 4.1.6
													else  -1								; INVALID FRAME SPACING
													endif endif
											else  0  endif  }
	"Set Cons:PathFraction[1]"			Cons:PathFraction[1]	= {	if (IfValidAnd( FramingFactor >= 0 )) then  1 - FramingFactor  else  0  endif  }		; SAC 3/17/14
	"Set Cons:PathFraction[2]"			Cons:PathFraction[2]	= {	if (IfValidAnd( FramingFactor >= 0 )) then      FramingFactor  else  0  endif  }

; SAC 2/27/14 - now initialized in prior rulelist
;	"Init Cons:FrameCodeRValue"		Cons:FrameCodeRValue  = {	0.92 + 0.61  }   ; outside and inside film coeff. consistent w/ ACM JA4 (& ASHRAE fundamentals ??)

	"Remaining construction, R-val & U-val calcs"	Cons:Action = {	EvalRulelist( "SetupCons_GenericFramed", 1 )  }

	"Set Cons:CodeMaximumUValue"		Cons:CodeMaximumUValue	= {	0  }
;	"Set Cons:CodeMaximumUValue"		Cons:CodeMaximumUValue	= {	if (Global( Proj:ClimateZone ) < 0.5) then  -1
;																						else  ClimateZoneTable( Global( Proj:ClimateZone ), 6 ) + 0.00049  endif  }  ; SAC 2/13/13 - added 0.00049 to allow for check taking into account rounding

	"Set Cons:CodeUValueLabel"			Cons:CodeUValueLabel		= {	" "  }
;	"Set Cons:CodeUValueLabel"			Cons:CodeUValueLabel		= {	if (Local( CodeMaximumUValue ) < 0) then  " "    ; no message - nothing to report
;																						else if (Local( CodeMaximumUValue ) < Local( OverallCodeUValue ))
;																						then  Format( "(doesn't meet max code %.3f U-value (%.3f))", Local( CodeMaximumUValue ), Local( OverallCodeUValue ) )
;																						else  Format( "(meets max code %.3f U-value (%.3f))", Local( CodeMaximumUValue ), Local( OverallCodeUValue ) )
;																						endif endif  }
END

;*************************************************************************
RULELIST "SetupCons_IntFloor_SinglePath"   0 0 0 1		; SAC 5/27/14 - added based on 'SetupCons_ExtWall_SinglePath'
;*************************************************************************
; INSIDE to OUTSIDE

	"Set Cons:FrameCavityLayerMat[1]"	Cons:FrameCavityLayerMat[1]	= {	if (Furring2Layer < 1 .AND. (FurringInsul2Layer < 1 .OR. FurringInsul2Layer == 100401 .OR.
                                                                                       (FurringInsul2Layer == 900 .AND. IfValidAnd( FurringInsul2LayerRVal > 0 )==0))) then  0
																									else if (FloorSurfaceLayer > 0.1) then  2
																									else  1  endif endif  }
	"Set Cons:FrameCavityLayerMat[2]"	Cons:FrameCavityLayerMat[2]	= {	if (FurringLayer < 1 .AND. (FurringInsulLayer < 1 .OR. FurringInsulLayer == 100401 .OR.
                                                                                      (FurringInsulLayer == 900 .AND. IfValidAnd( FurringInsulLayerRVal > 0 )==0))) then  0
																									else if (FloorSurfaceLayer > 0.1 .AND. FrameCavityLayerMat[1] > 0) then  4
																									else if (FloorSurfaceLayer > 0.1 .OR.  FrameCavityLayerMat[1] > 0) then  3
																									else  2  endif endif endif  }

	"Set Cons:NumLayerMats-1"		Cons:NumLayerMats = {	if (FloorSurfaceLayer  > 0.1) then  1  else  0  endif  }
	"Set Cons:NumLayerMats-2"		Cons:NumLayerMats = {	if (((FurringInsul2Layer != 900 .OR. IfValidAnd( FurringInsul2LayerRVal > 0 )) .AND.
                                                              FurringInsul2Layer != 100401 .AND. FurringInsul2Layer > 0) .OR. Furring2Layer > 0) then  NumLayerMats + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-3"		Cons:NumLayerMats = {	NumLayerMats + 1  }		; assumption here is that we will ALWAYS have a Mass/Adobe/... layer
	"Set Cons:NumLayerMats-4"		Cons:NumLayerMats = {	if (((FurringInsulLayer  != 900 .OR. IfValidAnd( FurringInsulLayerRVal  > 0 )) .AND.
                                                              FurringInsulLayer  != 100401 .AND. FurringInsulLayer  > 0) .OR. FurringLayer  > 0) then  NumLayerMats + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-5"		Cons:NumLayerMats = {	if (InsideFinishLayer  > 0.1) then                                                            NumLayerMats + 1  else  UNCHANGED  endif  }

; SAC 6/4/14 - added properties to be reported on CF1R
   "Set Cons:NumLayersRpt"		Cons:NumLayersRpt	= {	NumLayerMats  }
   "Set Cons:FramingRpt"		Cons:FramingRpt	= {	" "  }
   "Set Cons:CavityRRpt"		Cons:CavityRRpt	= {	" "  }

	; Mapping of this Index to Cons Properties:	1 =>	FloorSurfaceLayer
	;															2 =>	FurringInsul2Layer // Furring2Layer
	;															3 =>	MassLayer  //  MassThickness
	;															4 =>	FurringInsulLayer // FurringLayer  
	;															5 =>	InsideFinishLayer
	"Set Cons:FrameLayerMapIdx[1]"		Cons:FrameLayerMapIdx[1]   = {	2  }	; index of (possible) Cavity layers in mapping listed above
	"Set Cons:FrameLayerMapIdx[2]"		Cons:FrameLayerMapIdx[2]   = {	4  }
	"Set Cons:AbvJoistInsLyrMapIdx"		Cons:AbvJoistInsLyrMapIdx  = {	0  }	; index of insulation above ceiling joists layer in mapping listed above
	"Set Cons:BlwJoistInsLyrMapIdx"		Cons:BlwJoistInsLyrMapIdx  = {	0  }	; index of insulation below roof joists layer in mapping listed above
	"Set Cons:LayerPropertyIndex[1]"		Cons:LayerPropertyIndex[1] = {		  if (FloorSurfaceLayer  > 0.1) then  1
																								else if (((FurringInsul2Layer != 900 .OR. IfValidAnd( FurringInsul2LayerRVal > 0 )) .AND.
                                                                                  FurringInsul2Layer != 100401 .AND. FurringInsul2Layer > 0) .OR. Furring2Layer > 0) then  2
	                                                                     else  3  endif endif  }		; assumption here is that we will ALWAYS have a Mass/Adobe/... layer
	"Set Cons:LayerPropertyIndex[2]"		Cons:LayerPropertyIndex[2] = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :		  if (((FurringInsul2Layer != 900 .OR. IfValidAnd( FurringInsul2LayerRVal > 0 )) .AND.
                                                                                                 FurringInsul2Layer != 100401 .AND. FurringInsul2Layer > 0) .OR. Furring2Layer > 0) then  2
	                                                                     					else  3  endif
																									case  2 :      	3
																									case  3 :	if (((FurringInsulLayer != 900 .OR. IfValidAnd( FurringInsulLayerRVal > 0 )) .AND.
                                                                                            FurringInsulLayer  != 100401 .AND. FurringInsulLayer  > 0) .OR. FurringLayer  > 0) then  4
	                                                                     					else if (InsideFinishLayer > 0.1) then  5  else  0  endif endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[3]"		Cons:LayerPropertyIndex[3] = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	3
																									case  3 :	if (((FurringInsulLayer != 900 .OR. IfValidAnd( FurringInsulLayerRVal > 0 )) .AND.
                                                                                            FurringInsulLayer  != 100401 .AND. FurringInsulLayer  > 0) .OR. FurringLayer  > 0) then  4
	                                                                     					else if (InsideFinishLayer > 0.1) then  5  else  0  endif endif
																									case  4 :	if (InsideFinishLayer > 0.1) then  5  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[4]"		Cons:LayerPropertyIndex[4] = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	if (((FurringInsulLayer != 900 .OR. IfValidAnd( FurringInsulLayerRVal > 0 )) .AND.
                                                                                            FurringInsulLayer  != 100401 .AND. FurringInsulLayer  > 0) .OR. FurringLayer  > 0) then  4
	                                                                     					else if (InsideFinishLayer > 0.1) then  5  else  0  endif endif
																									case  4 :	if (InsideFinishLayer > 0.1) then  5  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[5]"		Cons:LayerPropertyIndex[5] = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	if (InsideFinishLayer > 0.1) then  5  else  0  endif
																									default :   0
																								endswitch  }

  ; assume 1" thickness of cavity insul (regardless of R-value)
;	"Set Cons:CavityMatCondQII[1]"		Cons:CavityMatCondQII[1]	= {	if (LayerPropertyIndex[1] == 2)
;																								then	if (IfValidAnd( Proj:ICQEnclCavInsMult > 0 ) .AND.
;																						 					 IfValidAnd(  FurringInsul2Layer > 0 ) .AND. IfValidAnd( FurringInsul2Layer < 200 ))
;																										then  (1/12) / ( FurringInsul2Layer * Proj:ICQEnclCavInsMult )
;																										else  0  endif
;																								else  0  endif  }
; SAC 3/27/14 - revised rules to DISREGARD Proj:ICQEnclCavInsMult when setting CavityMatCondQII[*] for mass walls (GC issue #290)
;					debugging
;						"log Cons data"	Cons:Action	= {	if (LayerPropertyIndex[1] != 2 .AND. LayerPropertyIndex[2] != 2 .AND. (IfValidAnd( FurringInsul2Layer > 0 )==0 .OR. IfValidAnd( FurringInsul2Layer < 200 )==0)) then  UNCHANGED
;																		else  PostMessageToLog( "Setting Cons:CavityMatCond* for Insul2Layer for '%s':  FurringInsul2Layer = %g / Furring2Layer = %g", Name, FurringInsul2Layer, Furring2Layer )  endif  }
;						"log Cons data"	Cons:Action	= {	if (LayerPropertyIndex[2] != 4 .AND. LayerPropertyIndex[3] != 4 .AND. LayerPropertyIndex[4] != 4 .AND. (IfValidAnd( FurringInsulLayer > 0 )==0 .OR. IfValidAnd( FurringInsulLayer < 200 )==0)) then  UNCHANGED
;																		else  PostMessageToLog( "Setting Cons:CavityMatCond* for InsulLayer for '%s':  FurringInsulLayer = %g / FurringLayer = %g", Name, FurringInsulLayer, FurringLayer )  endif  }
; SAC 11/22/14 - modified logic to take into account thickness of furring layer when calculating Cons:CavityMatCond*[*] (previous ver assumed 1" always) (GC issue #423)
; SAC 4/28/15 - added logic to address case where FurringInsul*Layer = 100401 => no insulation (issue 491)
; SAC 5/12/17 - added logic accommodating user-specified insul/furring R-value
	"Set Cons:CavityMatCondQII[1]"		Cons:CavityMatCondQII[1]	= {	if (LayerPropertyIndex[1] == 2)
																								then	if (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal > 0 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2LayerRVal
																												else	                              (1 / 12) /  FurringInsul2LayerRVal    endif
																										else if (IfValidAnd( FurringInsul2Layer > 0 ) .AND. IfValidAnd( FurringInsul2Layer < 200 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2Layer
																												else	                              (1 / 12) /  FurringInsul2Layer    endif
																										else if (IfValidAnd( FurringInsul2Layer = 100401 ) .OR. (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal = 0 )))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  0.92
																												else	                              (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif  }
	"Set Cons:CavityMatCondQII[2]"		Cons:CavityMatCondQII[2]	= {	if (LayerPropertyIndex[2] == 2)
																								then	if (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal > 0 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2LayerRVal
																												else	                              (1 / 12) /  FurringInsul2LayerRVal    endif
																										else if (IfValidAnd( FurringInsul2Layer > 0 ) .AND. IfValidAnd( FurringInsul2Layer < 200 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2Layer
																												else	                              (1 / 12) /  FurringInsul2Layer    endif
																										else if (IfValidAnd( FurringInsul2Layer = 100401 ) .OR. (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal = 0 )))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  0.92
																												else	                              (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else if (LayerPropertyIndex[2] == 4)
																								then	if (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal > 0 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayerRVal
																												else	                             (1 / 12) /  FurringInsulLayerRVal    endif
																										else if (IfValidAnd( FurringInsulLayer > 0 ) .AND. IfValidAnd( FurringInsulLayer < 200 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayer
																												else	                             (1 / 12) /  FurringInsulLayer    endif
																										else if (IfValidAnd( FurringInsulLayer = 100401 ) .OR. (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal = 0 )))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  0.92
																												else	                             (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif endif  }
	"Set Cons:CavityMatCondQII[3]"		Cons:CavityMatCondQII[3]	= {	if (LayerPropertyIndex[3] == 4)
																								then	if (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal > 0 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayerRVal
																												else	                             (1 / 12) /  FurringInsulLayerRVal    endif
																										else if (IfValidAnd( FurringInsulLayer > 0 ) .AND. IfValidAnd( FurringInsulLayer < 200 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayer
																												else	                             (1 / 12) /  FurringInsulLayer    endif
																										else if (IfValidAnd( FurringInsulLayer = 100401 ) .OR. (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal = 0 )))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  0.92
																												else	                             (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif  }
	"Set Cons:CavityMatCondQII[4]"		Cons:CavityMatCondQII[4]	= {	if (LayerPropertyIndex[4] == 4)
																								then	if (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal > 0 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayerRVal
																												else	                             (1 / 12) /  FurringInsulLayerRVal    endif
																										else if (IfValidAnd( FurringInsulLayer > 0 ) .AND. IfValidAnd( FurringInsulLayer < 200 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayer
																												else	                             (1 / 12) /  FurringInsulLayer    endif
																										else if (IfValidAnd( FurringInsulLayer = 100401 ) .OR. (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal = 0 )))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  0.92
																												else	                             (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif  }
	"Set Cons:CavityMatCondQII[5]"		Cons:CavityMatCondQII[5]	= {	0  }
	"Set Cons:CavityMatCondQII[6]"		Cons:CavityMatCondQII[6]	= {	0  }
	"Set Cons:CavityMatCondQII[7]"		Cons:CavityMatCondQII[7]	= {	0  }
	"Set Cons:CavityMatCondQII[8]"		Cons:CavityMatCondQII[8]	= {	0  }
	"Set Cons:CavityMatCond[1]"			Cons:CavityMatCond[1]		= {	if (LayerPropertyIndex[1] == 2)
																								then	if (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal > 0 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2LayerRVal
																												else	                              (1 / 12) /  FurringInsul2LayerRVal    endif
																										else if (IfValidAnd( FurringInsul2Layer > 0 ) .AND. IfValidAnd( FurringInsul2Layer < 200 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2Layer
																												else	                              (1 / 12) /  FurringInsul2Layer    endif
																										else if (IfValidAnd( FurringInsul2Layer = 100401 ) .OR. (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal = 0 )))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  0.92
																												else	                              (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif  }
	"Set Cons:CavityMatCond[2]"			Cons:CavityMatCond[2]		= {	if (LayerPropertyIndex[2] == 2)
																								then	if (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal > 0 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2LayerRVal
																												else	                              (1 / 12) /  FurringInsul2LayerRVal    endif
																										else if (IfValidAnd( FurringInsul2Layer > 0 ) .AND. IfValidAnd( FurringInsul2Layer < 200 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2Layer
																												else	                              (1 / 12) /  FurringInsul2Layer    endif
																										else if (IfValidAnd( FurringInsul2Layer = 100401 ) .OR. (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal = 0 )))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  0.92
																												else	                              (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else if (LayerPropertyIndex[2] == 4)
																								then	if (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal > 0 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayerRVal
																												else	                             (1 / 12) /  FurringInsulLayerRVal    endif
																										else if (IfValidAnd( FurringInsulLayer > 0 ) .AND. IfValidAnd( FurringInsulLayer < 200 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayer
																												else	                             (1 / 12) /  FurringInsulLayer    endif
																										else if (IfValidAnd( FurringInsulLayer = 100401 ) .OR. (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal = 0 )))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  0.92
																												else	                             (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif endif  }
	"Set Cons:CavityMatCond[3]"			Cons:CavityMatCond[3]		= {	if (LayerPropertyIndex[3] == 4)
																								then	if (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal > 0 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayerRVal
																												else	                             (1 / 12) /  FurringInsulLayerRVal    endif
																										else if (IfValidAnd( FurringInsulLayer > 0 ) .AND. IfValidAnd( FurringInsulLayer < 200 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayer
																												else	                             (1 / 12) /  FurringInsulLayer    endif
																										else if (IfValidAnd( FurringInsulLayer = 100401 ) .OR. (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal = 0 )))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  0.92
																												else	                             (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif  }
	"Set Cons:CavityMatCond[4]"			Cons:CavityMatCond[4]		= {	if (LayerPropertyIndex[4] == 4)
																								then	if (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal > 0 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayerRVal
																												else	                             (1 / 12) /  FurringInsulLayerRVal    endif
																										else if (IfValidAnd( FurringInsulLayer > 0 ) .AND. IfValidAnd( FurringInsulLayer < 200 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayer
																												else	                             (1 / 12) /  FurringInsulLayer    endif
																										else if (IfValidAnd( FurringInsulLayer = 100401 ) .OR. (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal = 0 )))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  0.92
																												else	                             (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif  }
	"Set Cons:CavityMatCond[5]"			Cons:CavityMatCond[5]		= {	0  }
	"Set Cons:CavityMatCond[6]"			Cons:CavityMatCond[6]		= {	0  }
	"Set Cons:CavityMatCond[7]"			Cons:CavityMatCond[7]		= {	0  }
	"Set Cons:CavityMatCond[8]"			Cons:CavityMatCond[8]		= {	0  }

; SAC 4/28/15 - mods to set CavityLayerSymVal[*] to 0 for FurringInsul*Layer = no insul...
	"Set Cons:CavityLayerSymVal[1]"		Cons:CavityLayerSymVal[1]   = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	FloorSurfaceLayer  
																									case  2 :	if (FurringInsul2Layer == 100401)
																													then	0
																													else	FurringInsul2Layer  endif 
																									case  3 :	if (MassLayer < 10000)
																													then	(MassLayer * 100) + MassThickness
																													else	 MassLayer   endif
																									default : 0
																								endswitch  }
	"Set Cons:CavityLayerSymVal[2]"		Cons:CavityLayerSymVal[2]   = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	if (FurringInsul2Layer == 100401)
																													then	0
																													else	FurringInsul2Layer  endif 
																									case  3 :	if (MassLayer < 10000)
																													then	(MassLayer * 100) + MassThickness
																													else	 MassLayer   endif          
																									case  4 :	if (FurringInsulLayer == 100401)
																													then	0
																													else	FurringInsulLayer  endif  
																									default : 0
																								endswitch  }
	"Set Cons:CavityLayerSymVal[3]"		Cons:CavityLayerSymVal[3]   = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	if (MassLayer < 10000)
																													then	(MassLayer * 100) + MassThickness
																													else	 MassLayer   endif          
																									case  4 :	if (FurringInsulLayer == 100401)
																													then	0
																													else	FurringInsulLayer  endif  
																									case  5 :	InsideFinishLayer 
																									default : 0
																								endswitch  }
	"Set Cons:CavityLayerSymVal[4]"		Cons:CavityLayerSymVal[4]   = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	if (FurringInsulLayer == 100401)
																													then	0
																													else	FurringInsulLayer  endif  
																									case  5 :	InsideFinishLayer 
																									default : 0
																								endswitch  }
	"Set Cons:CavityLayerSymVal[5]"		Cons:CavityLayerSymVal[5]   = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :	InsideFinishLayer
																									default : 0
																								endswitch  }

	"Set Cons:FrameLayerSymVal[1]"		Cons:FrameLayerSymVal[1]  = {		switch (Local( LayerPropertyIndex[1] ))
																									case  2 :	Furring2Layer 
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[2]"		Cons:FrameLayerSymVal[2]  = {		switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	Furring2Layer 
																									case  4 :	FurringLayer  
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[3]"		Cons:FrameLayerSymVal[3]  = {		switch (Local( LayerPropertyIndex[3] ))
																									case  4 :	FurringLayer  
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[4]"		Cons:FrameLayerSymVal[4]  = {		switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	FurringLayer  
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[5]"		Cons:FrameLayerSymVal[5]  = {	0  }

   ; SAC 5/11/17 - related to user-defined furring insulation r-value
   "Set Cons:LayerUsrInpInsRVal[1]"    Cons:LayerUsrInpInsRVal[1]  = {
         if (LayerPropertyIndex[1] == 2 .AND. FurringInsul2Layer == 900)
         then  FurringInsul2LayerRVal
         else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[2]"    Cons:LayerUsrInpInsRVal[2]  = {
         if (LayerPropertyIndex[2] == 2 .AND. FurringInsul2Layer == 900)
         then  FurringInsul2LayerRVal
         else if (LayerPropertyIndex[2] == 4 .AND. FurringInsulLayer == 900)
         then  FurringInsulLayerRVal
         else  UNDEFINED  endif endif  }
   "Set Cons:LayerUsrInpInsRVal[3]"    Cons:LayerUsrInpInsRVal[3]  = {
         if (LayerPropertyIndex[3] == 4 .AND. FurringInsulLayer == 900)
         then  FurringInsulLayerRVal
         else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[4]"    Cons:LayerUsrInpInsRVal[4]  = {
         if (LayerPropertyIndex[4] == 4 .AND. FurringInsulLayer == 900)
         then  FurringInsulLayerRVal
         else  UNDEFINED  endif  }
   "Init Cons:LayerUsrInpInsRVal[5]"   Cons:LayerUsrInpInsRVal[5]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[8]"   Cons:LayerUsrInpInsRVal[8]  = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[6]"   Cons:LayerUsrInpInsRVal[6]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[9]"   Cons:LayerUsrInpInsRVal[9]  = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[7]"   Cons:LayerUsrInpInsRVal[7]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[10]"  Cons:LayerUsrInpInsRVal[10] = {  UNDEFINED  }

; SAC 6/4/14 - added properties to be reported on CF1R
	"Set Cons:AssemblyLayersRpt[1]"		Cons:AssemblyLayersRpt[1]   = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	Format( "%s %s",      LayerLabels[1], EnumString( FloorSurfaceLayer     ))
																									case  2 :	Format( "%s %s / %s", LayerLabels[2], EnumString( FurringInsul2LayerStr ), EnumString( Furring2LayerAbr )) 
																									case  3 :	Format( "%s %s %s",   LayerLabels[3], EnumString( MassThickness         ), EnumString( MassLayer ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[2]"		Cons:AssemblyLayersRpt[2]   = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	Format( "%s %s / %s", LayerLabels[2], EnumString( FurringInsul2LayerStr ), EnumString( Furring2LayerAbr )) 
																									case  3 :	Format( "%s %s %s",   LayerLabels[3], EnumString( MassThickness         ), EnumString( MassLayer ))        
																									case  4 :	Format( "%s %s / %s", LayerLabels[4], EnumString( FurringInsulLayerStr  ), EnumString( FurringLayerAbr )) 
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[3]"		Cons:AssemblyLayersRpt[3]   = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	Format( "%s %s %s",   LayerLabels[3], EnumString( MassThickness         ), EnumString( MassLayer ))        
																									case  4 :	Format( "%s %s / %s", LayerLabels[4], EnumString( FurringInsulLayerStr  ), EnumString( FurringLayerAbr ))  
																									case  5 :	Format( "%s %s",      LayerLabels[5], EnumString( InsideFinishLayer     ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[4]"		Cons:AssemblyLayersRpt[4]   = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	Format( "%s %s / %s", LayerLabels[4], EnumString( FurringInsulLayerStr  ), EnumString( FurringLayerAbr ))  
																									case  5 :	Format( "%s %s",      LayerLabels[5], EnumString( InsideFinishLayer     )) 
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[5]"		Cons:AssemblyLayersRpt[5]   = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :	Format( "%s %s",      LayerLabels[5], EnumString( InsideFinishLayer     )) 
																									default : UNDEFINED
																								endswitch  }
	"Blast Cons:AssemblyLayersRpt[6]"	Cons:AssemblyLayersRpt[6]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[7]"	Cons:AssemblyLayersRpt[7]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[8]"	Cons:AssemblyLayersRpt[8]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[9]"	Cons:AssemblyLayersRpt[9]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[10]"	Cons:AssemblyLayersRpt[10]  = {	UNDEFINED  }

;	"Set Cons:FrameSpacing"	; SAC 2/14/12 - moved from ExtWall to facilitate wall splitting
;		Cons:FrameSpacing		= {	if (Local( Type ) == 0 .OR. Local( Type ) == 1)		; "Wood Framed Wall" or "Steel Framed Wall"
;											then	if (Local( FrameLayer ) > 0)
;													then  mod( Local( FrameLayer ), 100 )
;													else  16		; no frame layer specified, so use generic default (??)
;													endif
;											else	0				; NOT wood or steel framed, so no frame spacing used/valid (??)
;											endif  }
;
	"Set Cons:FramingFactor => fraction of gross surface area that includes frame" 
		Cons:FramingFactor	= {	0  }
	"Set Cons:PathFraction[1]"			Cons:PathFraction[1]	= {	1  }		; SAC 3/17/14
	"Set Cons:PathFraction[2]"			Cons:PathFraction[2]	= {	0  }


; SAC 2/27/14 - now initialized in prior rulelist
;	"Init Cons:CavityCodeRValue"		Cons:CavityCodeRValue  = {	0.17 + 0.68  }   ; inside and outside film coeff. consistent w/ both ASHRAE fundamentals & ACM JA4

	"Remaining construction, R-val & U-val calcs"	Cons:Action = {	EvalRulelist( "SetupCons_SinglePath", 1 )  }

	"Set Cons:CodeMaximumUValue"		Cons:CodeMaximumUValue	= {	0  }
;	"Set Cons:CodeMaximumUValue"		Cons:CodeMaximumUValue	= {	if (Global( Proj:ClimateZone ) < 0.5) then  -1
;																						else  ClimateZoneTable( Global( Proj:ClimateZone ), 6 ) + 0.00049  endif  }  ; SAC 2/13/13 - added 0.00049 to allow for check taking into account rounding

	"Set Cons:CodeUValueLabel"			Cons:CodeUValueLabel		= {	" "  }
;	"Set Cons:CodeUValueLabel"			Cons:CodeUValueLabel		= {	if (Local( CodeMaximumUValue ) < 0) then  " "    ; no message - nothing to report
;																						else if (Local( CodeMaximumUValue ) < Local( OverallCodeUValue ))
;																						then  Format( "(doesn't meet max code %.3f U-value (%.3f))", Local( CodeMaximumUValue ), Local( OverallCodeUValue ) )
;																						else  Format( "(meets max code %.3f U-value (%.3f))", Local( CodeMaximumUValue ), Local( OverallCodeUValue ) )
;																						endif endif  }
END

;*************************************************************************
RULELIST "SetupCons_ExtFloor_TwoPath"   0 0 0 1
;*************************************************************************
; INSIDE to OUTSIDE

	"Set Cons:FrameCavityLayerMat[1]"	Cons:FrameCavityLayerMat[1] = {	     if (Local( FrameLayer ) < 0.1) then  0     ; NO frame/cavity layer
																								else if (Local( FloorSurfaceLayer ) > 0.1 .AND. Local( FlrConcreteFillLayer ) > 0.1 .AND. Local( FloorDeckLayer ) > 0.1) then  4
																								else if ( (Local( FloorSurfaceLayer    ) > 0.1 .AND. Local( FlrConcreteFillLayer ) > 0.1) .OR.
																											 (Local( FlrConcreteFillLayer ) > 0.1 .AND. Local( FloorDeckLayer       ) > 0.1) .OR.
																											 (Local( FloorSurfaceLayer    ) > 0.1 .AND. Local( FloorDeckLayer       ) > 0.1) ) then  3
																								else if (Local( FloorSurfaceLayer ) > 0.1 .OR.  Local( FlrConcreteFillLayer ) > 0.1 .OR.  Local( FloorDeckLayer ) > 0.1) then  2
																								else  1  endif endif endif endif  }
	"Set Cons:FrameCavityLayerMat[2]"	Cons:FrameCavityLayerMat[2]	= {	0  }

	"Set Cons:NumLayerMats-1"		Cons:NumLayerMats = {	if (Local( FloorSurfaceLayer    ) > 0.1) then  1  else  0  endif  }
	"Set Cons:NumLayerMats-2"		Cons:NumLayerMats = {	if (Local( FlrConcreteFillLayer ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-3"		Cons:NumLayerMats = {	if (Local( FloorDeckLayer       ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-4"		Cons:NumLayerMats = {	if (Local( FrameLayer           ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-5"		Cons:NumLayerMats = {	if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                             Local( SheathInsulLayer     ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-6"		Cons:NumLayerMats = {	if (Local( FlrExtFinishLayer    ) > 0.1) then  Local( NumLayerMats ) + 1  else  UNCHANGED  endif  }

; SAC 6/4/14 - added properties to be reported on CF1R
   "Set Cons:NumLayersRpt"		Cons:NumLayersRpt	= {	NumLayerMats  }
   "Set Cons:FramingRpt"		Cons:FramingRpt	= {	if (IfValidAnd( FrameLayer > 0 )) then  EnumString( FrameLayer )  else  " "  endif  }
   "Set Cons:CavityRRpt"		Cons:CavityRRpt	= {	if (IfValidAnd( CavityLayer > 0 ) .AND. IfValidAnd( CavityLayer < 100001 )) then  EnumString( CavityLayer )  else  "none"  endif  }

	; Mapping of this Index to Cons Properties:	1 =>	FloorSurfaceLayer    
	;															2 =>	FlrConcreteFillLayer 
	;															3 =>	FloorDeckLayer       
	;															4 =>	FrameLayer  //  CavityLayer 
	;															5 =>	SheathInsulLayer 
	;															6 =>	FlrExtFinishLayer
	"Set Cons:FrameLayerMapIdx[1]"		Cons:FrameLayerMapIdx[1]   = {	4  }	; index of Frame/Cavity layer in mapping listed above
	"Set Cons:FrameLayerMapIdx[2]"		Cons:FrameLayerMapIdx[2]   = {	0  }
	"Set Cons:AbvJoistInsLyrMapIdx"		Cons:AbvJoistInsLyrMapIdx  = {	0  }	; index of insulation above ceiling joists layer in mapping listed above
	"Set Cons:BlwJoistInsLyrMapIdx"		Cons:BlwJoistInsLyrMapIdx  = {	0  }	; index of insulation below roof joists layer in mapping listed above
	"Set Cons:LayerPropertyIndex[1]"		Cons:LayerPropertyIndex[1] = {		  if (Local( FloorSurfaceLayer    ) > 0.1) then  1
																								else if (Local( FlrConcreteFillLayer ) > 0.1) then  2
																								else if (Local( FloorDeckLayer       ) > 0.1) then  3
	                                                                     else if (Local( FrameLayer           ) > 0.1) then  4
	                                                                     else if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                 Local( SheathInsulLayer     ) > 0.1) then  5
	                                                                     else if (Local( FlrExtFinishLayer    ) > 0.1) then  6  else  0  endif endif endif endif endif endif  }
	"Set Cons:LayerPropertyIndex[2]"		Cons:LayerPropertyIndex[2] = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :		  if (Local( FlrConcreteFillLayer ) > 0.1) then  2
	                                                                     					else if (Local( FloorDeckLayer       ) > 0.1) then  3
	                                                                     					else if (Local( FrameLayer           ) > 0.1) then  4
	                                                                     					else if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer     ) > 0.1) then  5
	                                                                     					else if (Local( FlrExtFinishLayer    ) > 0.1) then  6  else  0  endif endif endif endif endif
																									case  2 :		  if (Local( FloorDeckLayer       ) > 0.1) then  3
	                                                                     					else if (Local( FrameLayer           ) > 0.1) then  4
	                                                                     					else if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer     ) > 0.1) then  5
	                                                                     					else if (Local( FlrExtFinishLayer    ) > 0.1) then  6  else  0  endif endif endif endif
																									case  3 :		  if (Local( FrameLayer           ) > 0.1) then  4
	                                                                     					else if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer     ) > 0.1) then  5
	                                                                     					else if (Local( FlrExtFinishLayer    ) > 0.1) then  6  else  0  endif endif endif
																									case  4 :		  if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer     ) > 0.1) then  5
	                                                                     					else if (Local( FlrExtFinishLayer    ) > 0.1) then  6  else  0  endif endif
	                                                                     	case  5 :		  if (Local( FlrExtFinishLayer    ) > 0.1) then  6  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[3]"		Cons:LayerPropertyIndex[3] = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :		  if (Local( FloorDeckLayer       ) > 0.1) then  3
	                                                                     					else if (Local( FrameLayer           ) > 0.1) then  4
	                                                                     					else if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer     ) > 0.1) then  5
	                                                                     					else if (Local( FlrExtFinishLayer    ) > 0.1) then  6  else  0  endif endif endif endif
																									case  3 :		  if (Local( FrameLayer           ) > 0.1) then  4
	                                                                     					else if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer     ) > 0.1) then  5
	                                                                     					else if (Local( FlrExtFinishLayer    ) > 0.1) then  6  else  0  endif endif endif
																									case  4 :		  if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer     ) > 0.1) then  5
	                                                                     					else if (Local( FlrExtFinishLayer    ) > 0.1) then  6  else  0  endif endif
	                                                                     	case  5 :		  if (Local( FlrExtFinishLayer    ) > 0.1) then  6  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[4]"		Cons:LayerPropertyIndex[4] = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :		  if (Local( FrameLayer           ) > 0.1) then  4
	                                                                     					else if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer     ) > 0.1) then  5
	                                                                     					else if (Local( FlrExtFinishLayer    ) > 0.1) then  6  else  0  endif endif endif
																									case  4 :		  if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer     ) > 0.1) then  5
	                                                                     					else if (Local( FlrExtFinishLayer    ) > 0.1) then  6  else  0  endif endif
	                                                                     	case  5 :		  if (Local( FlrExtFinishLayer    ) > 0.1) then  6  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[5]"		Cons:LayerPropertyIndex[5] = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :		  if ((SheathInsulLayer != 99000 .OR. IfValidAnd( SheathInsulLayerRVal > 0 )) .AND.
                                                                                                Local( SheathInsulLayer     ) > 0.1) then  5
	                                                                     					else if (Local( FlrExtFinishLayer    ) > 0.1) then  6  else  0  endif endif
	                                                                     	case  5 :		  if (Local( FlrExtFinishLayer    ) > 0.1) then  6  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[6]"		Cons:LayerPropertyIndex[6] = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :		  if (Local( FlrExtFinishLayer    ) > 0.1) then  6  else  0  endif
																									default :   0
																								endswitch  }

	"Set Cons:FrameLayerSymVal[1]"		Cons:FrameLayerSymVal[1]   = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	Local( FloorSurfaceLayer    )
																									case  2 :	Local( FlrConcreteFillLayer )
																									case  3 :	Local( FloorDeckLayer       )
																									case  4 :	Local( FrameLayer           )
																									case  5 :	Local( SheathInsulLayer     )
																									case  6 :	Local( FlrExtFinishLayer    )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[2]"		Cons:FrameLayerSymVal[2]   = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	Local( FlrConcreteFillLayer )
																									case  3 :	Local( FloorDeckLayer       )
																									case  4 :	Local( FrameLayer           )
																									case  5 :	Local( SheathInsulLayer     )
																									case  6 :	Local( FlrExtFinishLayer    )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[3]"		Cons:FrameLayerSymVal[3]   = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	Local( FloorDeckLayer       )
																									case  4 :	Local( FrameLayer           )
																									case  5 :	Local( SheathInsulLayer     )
																									case  6 :	Local( FlrExtFinishLayer    )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[4]"		Cons:FrameLayerSymVal[4]   = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	Local( FrameLayer           )
																									case  5 :	Local( SheathInsulLayer     )
																									case  6 :	Local( FlrExtFinishLayer    )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[5]"		Cons:FrameLayerSymVal[5]   = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :	Local( SheathInsulLayer     )
																									case  6 :	Local( FlrExtFinishLayer    )
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[6]"		Cons:FrameLayerSymVal[6]   = {	switch (Local( LayerPropertyIndex[6] ))
																									case  6 :	Local( FlrExtFinishLayer    )
																									default : 0
																								endswitch  }

   ; SAC 5/15/17 - added compressed R-value selections - R-val = (SymVal-mod(SymVal,10))/100  (tic #761)
	"Set Cons:CavityLayerSymVal[1]"		Cons:CavityLayerSymVal[1]  = {
         if (Local( LayerPropertyIndex[1] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[1] )  endif  }
	"Set Cons:CavityLayerSymVal[2]"		Cons:CavityLayerSymVal[2]  = {
         if (Local( LayerPropertyIndex[2] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[2] )  endif  }
	"Set Cons:CavityLayerSymVal[3]"		Cons:CavityLayerSymVal[3]  = {
         if (Local( LayerPropertyIndex[3] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[3] )  endif  }
	"Set Cons:CavityLayerSymVal[4]"		Cons:CavityLayerSymVal[4]  = {
         if (Local( LayerPropertyIndex[4] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[4] )  endif  }
	"Set Cons:CavityLayerSymVal[5]"		Cons:CavityLayerSymVal[5]  = {
         if (Local( LayerPropertyIndex[5] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[5] )  endif  }
	"Set Cons:CavityLayerSymVal[6]"		Cons:CavityLayerSymVal[6]  = {
         if (Local( LayerPropertyIndex[6] ) == Local( FrameLayerMapIdx[1] ))
         then  if (CavityLayer = 100401) then  CavityLayer
               else  CavityLayerRVal  endif
         else  Local( FrameLayerSymVal[6] )  endif  }

   ; SAC 4/11/17 - related to user-defined sheating/insulation r-value
   "Set Cons:LayerUsrInpInsRVal[1]"    Cons:LayerUsrInpInsRVal[1]  = {
         if (LayerPropertyIndex[1] == 5 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal  else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[2]"    Cons:LayerUsrInpInsRVal[2]  = {
         if (LayerPropertyIndex[2] == 5 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal  else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[3]"    Cons:LayerUsrInpInsRVal[3]  = {
         if (LayerPropertyIndex[3] == 5 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal  else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[4]"    Cons:LayerUsrInpInsRVal[4]  = {
         if (LayerPropertyIndex[4] == 5 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal  else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[5]"    Cons:LayerUsrInpInsRVal[5]  = {
         if (LayerPropertyIndex[5] == 5 .AND. SheathInsulLayer == 99000)
         then  SheathInsulLayerRVal  else  UNDEFINED  endif  }
   "Init Cons:LayerUsrInpInsRVal[6]"   Cons:LayerUsrInpInsRVal[6]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[9]"   Cons:LayerUsrInpInsRVal[9]  = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[7]"   Cons:LayerUsrInpInsRVal[7]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[10]"  Cons:LayerUsrInpInsRVal[10] = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[8]"   Cons:LayerUsrInpInsRVal[8]  = {  UNDEFINED  }

; SAC 6/4/14 - added properties to be reported on CF1R
      ; SAC 10/21/19 - hyphenated R-values (R## -> R-##) (tic #1121)
	"Set Cons:AssemblyLayersRpt[1]"		Cons:AssemblyLayersRpt[1]   = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	Format( "%s %s",      LayerLabels[1], EnumString( FloorSurfaceLayer    ))
																									case  2 :	Format( "%s %s",      LayerLabels[2], EnumString( FlrConcreteFillLayer ))
																									case  3 :	Format( "%s %s",      LayerLabels[3], EnumString( FloorDeckLayer       ))
																									case  4 :	Format( "%s %s / %s", LayerLabels[4], EnumString( CavityLayerAbr       ), EnumString( FrameLayerAbr ))
																									case  5 :	if (SheathInsulLayer == 99000 .AND. IfValidAnd( SheathInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[5], FltToStr( SheathInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[5], EnumString( SheathInsulLayerRpt     ))  endif
																									case  6 :	Format( "%s %s",      LayerLabels[6], EnumString( FlrExtFinishLayer    ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[2]"		Cons:AssemblyLayersRpt[2]   = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	Format( "%s %s",      LayerLabels[2], EnumString( FlrConcreteFillLayer ))
																									case  3 :	Format( "%s %s",      LayerLabels[3], EnumString( FloorDeckLayer       ))
																									case  4 :	Format( "%s %s / %s", LayerLabels[4], EnumString( CavityLayerAbr       ), EnumString( FrameLayerAbr ))
																									case  5 :	if (SheathInsulLayer == 99000 .AND. IfValidAnd( SheathInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[5], FltToStr( SheathInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[5], EnumString( SheathInsulLayerRpt     ))  endif
																									case  6 :	Format( "%s %s",      LayerLabels[6], EnumString( FlrExtFinishLayer    ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[3]"		Cons:AssemblyLayersRpt[3]   = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	Format( "%s %s",      LayerLabels[3], EnumString( FloorDeckLayer       ))
																									case  4 :	Format( "%s %s / %s", LayerLabels[4], EnumString( CavityLayerAbr       ), EnumString( FrameLayerAbr ))
																									case  5 :	if (SheathInsulLayer == 99000 .AND. IfValidAnd( SheathInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[5], FltToStr( SheathInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[5], EnumString( SheathInsulLayerRpt     ))  endif
																									case  6 :	Format( "%s %s",      LayerLabels[6], EnumString( FlrExtFinishLayer    ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[4]"		Cons:AssemblyLayersRpt[4]   = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	Format( "%s %s / %s", LayerLabels[4], EnumString( CavityLayerAbr       ), EnumString( FrameLayerAbr ))
																									case  5 :	if (SheathInsulLayer == 99000 .AND. IfValidAnd( SheathInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[5], FltToStr( SheathInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[5], EnumString( SheathInsulLayerRpt     ))  endif
																									case  6 :	Format( "%s %s",      LayerLabels[6], EnumString( FlrExtFinishLayer    ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[5]"		Cons:AssemblyLayersRpt[5]   = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :	if (SheathInsulLayer == 99000 .AND. IfValidAnd( SheathInsulLayerRVal >= 0 ))
                                                                                       then  Format( "%s R-%s Sheathing", LayerLabels[5], FltToStr( SheathInsulLayerRVal, 1, 1, 0, 1 ))
                                                                                       else  Format( "%s %s",      LayerLabels[5], EnumString( SheathInsulLayerRpt     ))  endif
																									case  6 :	Format( "%s %s",      LayerLabels[6], EnumString( FlrExtFinishLayer    ))
																									default : UNDEFINED
																								endswitch  }
	"Blast Cons:AssemblyLayersRpt[6]"	Cons:AssemblyLayersRpt[6]   = {	switch (Local( LayerPropertyIndex[6] ))
																									case  6 :	Format( "%s %s",      LayerLabels[6], EnumString( FlrExtFinishLayer    ))
																									default : UNDEFINED
																								endswitch  }
	"Blast Cons:AssemblyLayersRpt[7]"	Cons:AssemblyLayersRpt[7]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[8]"	Cons:AssemblyLayersRpt[8]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[9]"	Cons:AssemblyLayersRpt[9]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[10]"	Cons:AssemblyLayersRpt[10]  = {	UNDEFINED  }

	"Set Cons:FrameSpacing"	; SAC 2/14/12 - moved from ExtWall to facilitate wall splitting
		Cons:FrameSpacing		= {	if (Local( Type ) == 20)		; "Wood Framed Floor"
											then	if (Local( FrameLayer ) > 0)
													then  mod( Local( FrameLayer ), 100 )
													else  16		; no frame layer specified, so use generic default (??)
													endif
											else	0				; NOT "Wood Framed Floor", so no frame spacing used/valid (??)
											endif  }

	"Set Cons:FramingFactor => fraction of gross surface area that includes frame" 
		Cons:FramingFactor	= {	; Exterior Floors
											if (Local( Type ) == 20)		; "Wood Framed Floor"
											then	if (Local( FrameSpacing ) == 16)
													then  0.10    ; Wood - 16" OC						- from 2008 Joint App 4 - 4.1.6
													else if (Local( FrameSpacing ) == 24)
													then  0.07    ; Wood - 24" OC						- from 2008 Joint App 4 - 4.1.6
													else  -1								; INVALID FRAME SPACING
													endif endif
											else  0  endif  }
	"Set Cons:PathFraction[1]"			Cons:PathFraction[1]	= {	if (IfValidAnd( FramingFactor >= 0 )) then  1 - FramingFactor  else  0  endif  }		; SAC 3/17/14
	"Set Cons:PathFraction[2]"			Cons:PathFraction[2]	= {	if (IfValidAnd( FramingFactor >= 0 )) then      FramingFactor  else  0  endif  }

; SAC 2/27/14 - now initialized in prior rulelist
;;	"Init Cons:FrameCodeRValue"		Cons:FrameCodeRValue  = {	if (FlrExtConditions > 0)   ; above crawl space
;	"Init Cons:FrameCodeRValue"		Cons:FrameCodeRValue  = {	if (CanAssignTo == 9)   ; above crawl space
;																					then  0.61 + 0.92
;																					else  0.17 + 0.92  endif  }   ; outside and inside film coeff. consistent w/ ACM JA4 (& ASHRAE fundamentals ??)

	"Remaining construction, R-val & U-val calcs"	Cons:Action = {	EvalRulelist( "SetupCons_GenericFramed", 1 )  }

	"Set Cons:CodeMaximumUValue"		Cons:CodeMaximumUValue	= {	0  }
;	"Set Cons:CodeMaximumUValue"		Cons:CodeMaximumUValue	= {	if (Global( Proj:ClimateZone ) < 0.5) then  -1
;																						else  ClimateZoneTable( Global( Proj:ClimateZone ), 6 ) + 0.00049  endif  }  ; SAC 2/13/13 - added 0.00049 to allow for check taking into account rounding

	"Set Cons:CodeUValueLabel"			Cons:CodeUValueLabel		= {	" "  }
;	"Set Cons:CodeUValueLabel"			Cons:CodeUValueLabel		= {	if (Local( CodeMaximumUValue ) < 0) then  " "    ; no message - nothing to report
;																						else if (Local( CodeMaximumUValue ) < Local( OverallCodeUValue ))
;																						then  Format( "(doesn't meet max code %.3f U-value (%.3f))", Local( CodeMaximumUValue ), Local( OverallCodeUValue ) )
;																						else  Format( "(meets max code %.3f U-value (%.3f))", Local( CodeMaximumUValue ), Local( OverallCodeUValue ) )
;																						endif endif  }
END

;*************************************************************************
RULELIST "SetupCons_ExtFloor_SinglePath"   0 0 0 1		; SAC 5/27/14 - added based on 'SetupCons_IntFloor_SinglePath'
;*************************************************************************
; INSIDE to OUTSIDE

	"Set Cons:FrameCavityLayerMat[1]"	Cons:FrameCavityLayerMat[1]	= {	if (Furring2Layer < 1 .AND. (FurringInsul2Layer < 1 .OR. FurringInsul2Layer == 100401 .OR.
                                                                                       (FurringInsul2Layer == 900 .AND. IfValidAnd( FurringInsul2LayerRVal > 0 )==0))) then  0
																									else if (FloorSurfaceLayer > 0.1) then  2
																									else  1  endif endif  }
	"Set Cons:FrameCavityLayerMat[2]"	Cons:FrameCavityLayerMat[2]	= {	if (FurringLayer < 1 .AND. (FurringInsulLayer < 1 .OR. FurringInsulLayer == 100401 .OR.
                                                                                      (FurringInsulLayer == 900 .AND. IfValidAnd( FurringInsulLayerRVal > 0 )==0))) then  0
																									else if (FloorSurfaceLayer > 0.1 .AND. FrameCavityLayerMat[1] > 0) then  4
																									else if (FloorSurfaceLayer > 0.1 .OR.  FrameCavityLayerMat[1] > 0) then  3
																									else  2  endif endif endif  }

	"Set Cons:NumLayerMats-1"		Cons:NumLayerMats = {	if (FloorSurfaceLayer  > 0.1) then  1  else  0  endif  }
	"Set Cons:NumLayerMats-2"		Cons:NumLayerMats = {	if (((FurringInsul2Layer != 900 .OR. IfValidAnd( FurringInsul2LayerRVal > 0 )) .AND.
                                                              FurringInsul2Layer != 100401 .AND. FurringInsul2Layer > 0) .OR. Furring2Layer > 0) then  NumLayerMats + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-3"		Cons:NumLayerMats = {	NumLayerMats + 1  }		; assumption here is that we will ALWAYS have a Mass/Adobe/... layer
	"Set Cons:NumLayerMats-4"		Cons:NumLayerMats = {	if (((FurringInsulLayer  != 900 .OR. IfValidAnd( FurringInsulLayerRVal  > 0 )) .AND.
                                                              FurringInsulLayer  != 100401 .AND. FurringInsulLayer  > 0) .OR. FurringLayer  > 0) then  NumLayerMats + 1  else  UNCHANGED  endif  }
	"Set Cons:NumLayerMats-5"		Cons:NumLayerMats = {	if (FlrExtFinishLayer  > 0.1) then                                                            NumLayerMats + 1  else  UNCHANGED  endif  }

; SAC 6/4/14 - added properties to be reported on CF1R
   "Set Cons:NumLayersRpt"		Cons:NumLayersRpt	= {	NumLayerMats  }
   "Set Cons:FramingRpt"		Cons:FramingRpt	= {	" "  }
   "Set Cons:CavityRRpt"		Cons:CavityRRpt	= {	" "  }

	; Mapping of this Index to Cons Properties:	1 =>	FloorSurfaceLayer
	;															2 =>	FurringInsul2Layer // Furring2Layer
	;															3 =>	MassLayer  //  MassThickness
	;															4 =>	FurringInsulLayer // FurringLayer  
	;															5 =>	FlrExtFinishLayer
	"Set Cons:FrameLayerMapIdx[1]"		Cons:FrameLayerMapIdx[1]   = {	2  }	; index of (possible) Cavity layers in mapping listed above
	"Set Cons:FrameLayerMapIdx[2]"		Cons:FrameLayerMapIdx[2]   = {	4  }
	"Set Cons:AbvJoistInsLyrMapIdx"		Cons:AbvJoistInsLyrMapIdx  = {	0  }	; index of insulation above ceiling joists layer in mapping listed above
	"Set Cons:BlwJoistInsLyrMapIdx"		Cons:BlwJoistInsLyrMapIdx  = {	0  }	; index of insulation below roof joists layer in mapping listed above
	"Set Cons:LayerPropertyIndex[1]"		Cons:LayerPropertyIndex[1] = {		  if (FloorSurfaceLayer  > 0.1) then  1
																								else if (((FurringInsul2Layer != 900 .OR. IfValidAnd( FurringInsul2LayerRVal > 0 )) .AND.
                                                                                  FurringInsul2Layer != 100401 .AND. FurringInsul2Layer > 0) .OR. Furring2Layer > 0) then  2
	                                                                     else  3  endif endif  }		; assumption here is that we will ALWAYS have a Mass/Adobe/... layer
	"Set Cons:LayerPropertyIndex[2]"		Cons:LayerPropertyIndex[2] = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :		  if (((FurringInsul2Layer != 900 .OR. IfValidAnd( FurringInsul2LayerRVal > 0 )) .AND.
                                                                                                 FurringInsul2Layer != 100401 .AND. FurringInsul2Layer > 0) .OR. Furring2Layer > 0) then  2
	                                                                     					else  3  endif
																									case  2 :      	3
																									case  3 :	if (((FurringInsulLayer != 900 .OR. IfValidAnd( FurringInsulLayerRVal > 0 )) .AND.
                                                                                            FurringInsulLayer  != 100401 .AND. FurringInsulLayer  > 0) .OR. FurringLayer  > 0) then  4
	                                                                     					else if (FlrExtFinishLayer > 0.1) then  5  else  0  endif endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[3]"		Cons:LayerPropertyIndex[3] = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	3
																									case  3 :	if (((FurringInsulLayer != 900 .OR. IfValidAnd( FurringInsulLayerRVal > 0 )) .AND.
                                                                                            FurringInsulLayer  != 100401 .AND. FurringInsulLayer  > 0) .OR. FurringLayer  > 0) then  4
	                                                                     					else if (FlrExtFinishLayer > 0.1) then  5  else  0  endif endif
																									case  4 :	if (FlrExtFinishLayer > 0.1) then  5  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[4]"		Cons:LayerPropertyIndex[4] = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	if (((FurringInsulLayer != 900 .OR. IfValidAnd( FurringInsulLayerRVal > 0 )) .AND.
                                                                                            FurringInsulLayer  != 100401 .AND. FurringInsulLayer  > 0) .OR. FurringLayer  > 0) then  4
	                                                                     					else if (FlrExtFinishLayer > 0.1) then  5  else  0  endif endif
																									case  4 :	if (FlrExtFinishLayer > 0.1) then  5  else  0  endif
																									default :   0
																								endswitch  }
	"Set Cons:LayerPropertyIndex[5]"		Cons:LayerPropertyIndex[5] = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	if (FlrExtFinishLayer > 0.1) then  5  else  0  endif
																									default :   0
																								endswitch  }

  ; assume 1" thickness of cavity insul (regardless of R-value)
;	"Set Cons:CavityMatCondQII[1]"		Cons:CavityMatCondQII[1]	= {	if (LayerPropertyIndex[1] == 2)
;																								then	if (IfValidAnd( Proj:ICQEnclCavInsMult > 0 ) .AND.
;																						 					 IfValidAnd(  FurringInsul2Layer > 0 ) .AND. IfValidAnd( FurringInsul2Layer < 200 ))
;																										then  (1/12) / ( FurringInsul2Layer * Proj:ICQEnclCavInsMult )
;																										else  0  endif
;																								else  0  endif  }
; SAC 3/27/14 - revised rules to DISREGARD Proj:ICQEnclCavInsMult when setting CavityMatCondQII[*] for mass walls (GC issue #290)
;					debugging
;						"log Cons data"	Cons:Action	= {	if (LayerPropertyIndex[1] != 2 .AND. LayerPropertyIndex[2] != 2 .AND. (IfValidAnd( FurringInsul2Layer > 0 )==0 .OR. IfValidAnd( FurringInsul2Layer < 200 )==0)) then  UNCHANGED
;																		else  PostMessageToLog( "Setting Cons:CavityMatCond* for Insul2Layer for '%s':  FurringInsul2Layer = %g / Furring2Layer = %g", Name, FurringInsul2Layer, Furring2Layer )  endif  }
;						"log Cons data"	Cons:Action	= {	if (LayerPropertyIndex[2] != 4 .AND. LayerPropertyIndex[3] != 4 .AND. LayerPropertyIndex[4] != 4 .AND. (IfValidAnd( FurringInsulLayer > 0 )==0 .OR. IfValidAnd( FurringInsulLayer < 200 )==0)) then  UNCHANGED
;																		else  PostMessageToLog( "Setting Cons:CavityMatCond* for InsulLayer for '%s':  FurringInsulLayer = %g / FurringLayer = %g", Name, FurringInsulLayer, FurringLayer )  endif  }
; SAC 11/22/14 - modified logic to take into account thickness of furring layer when calculating Cons:CavityMatCond*[*] (previous ver assumed 1" always) (GC issue #423)
; SAC 4/28/15 - added logic to address case where FurringInsul*Layer = 100401 => no insulation (issue 491)
; SAC 5/12/17 - added logic accommodating user-specified insul/furring R-value
	"Set Cons:CavityMatCondQII[1]"		Cons:CavityMatCondQII[1]	= {	if (LayerPropertyIndex[1] == 2)
																								then	if (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal > 0 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2LayerRVal
																												else	                              (1 / 12) /  FurringInsul2LayerRVal    endif
																										else if (IfValidAnd( FurringInsul2Layer > 0 ) .AND. IfValidAnd( FurringInsul2Layer < 200 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2Layer
																												else	                              (1 / 12) /  FurringInsul2Layer    endif
																										else if (IfValidAnd( FurringInsul2Layer = 100401 ) .OR. (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal = 0 )))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  0.92
																												else	                              (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif  }
	"Set Cons:CavityMatCondQII[2]"		Cons:CavityMatCondQII[2]	= {	if (LayerPropertyIndex[2] == 2)
																								then	if (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal > 0 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2LayerRVal
																												else	                              (1 / 12) /  FurringInsul2LayerRVal    endif
																										else if (IfValidAnd( FurringInsul2Layer > 0 ) .AND. IfValidAnd( FurringInsul2Layer < 200 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2Layer
																												else	                              (1 / 12) /  FurringInsul2Layer    endif
																										else if (IfValidAnd( FurringInsul2Layer = 100401 ) .OR. (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal = 0 )))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  0.92
																												else	                              (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else if (LayerPropertyIndex[2] == 4)
																								then	if (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal > 0 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayerRVal
																												else	                             (1 / 12) /  FurringInsulLayerRVal    endif
																										else if (IfValidAnd( FurringInsulLayer > 0 ) .AND. IfValidAnd( FurringInsulLayer < 200 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayer
																												else	                             (1 / 12) /  FurringInsulLayer    endif
																										else if (IfValidAnd( FurringInsulLayer = 100401 ) .OR. (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal = 0 )))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  0.92
																												else	                             (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif endif  }
	"Set Cons:CavityMatCondQII[3]"		Cons:CavityMatCondQII[3]	= {	if (LayerPropertyIndex[3] == 4)
																								then	if (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal > 0 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayerRVal
																												else	                             (1 / 12) /  FurringInsulLayerRVal    endif
																										else if (IfValidAnd( FurringInsulLayer > 0 ) .AND. IfValidAnd( FurringInsulLayer < 200 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayer
																												else	                             (1 / 12) /  FurringInsulLayer    endif
																										else if (IfValidAnd( FurringInsulLayer = 100401 ) .OR. (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal = 0 )))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  0.92
																												else	                             (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif  }
	"Set Cons:CavityMatCondQII[4]"		Cons:CavityMatCondQII[4]	= {	if (LayerPropertyIndex[4] == 4)
																								then	if (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal > 0 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayerRVal
																												else	                             (1 / 12) /  FurringInsulLayerRVal    endif
																										else if (IfValidAnd( FurringInsulLayer > 0 ) .AND. IfValidAnd( FurringInsulLayer < 200 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayer
																												else	                             (1 / 12) /  FurringInsulLayer    endif
																										else if (IfValidAnd( FurringInsulLayer = 100401 ) .OR. (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal = 0 )))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  0.92
																												else	                             (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif  }
	"Set Cons:CavityMatCondQII[5]"		Cons:CavityMatCondQII[5]	= {	0  }
	"Set Cons:CavityMatCondQII[6]"		Cons:CavityMatCondQII[6]	= {	0  }
	"Set Cons:CavityMatCondQII[7]"		Cons:CavityMatCondQII[7]	= {	0  }
	"Set Cons:CavityMatCondQII[8]"		Cons:CavityMatCondQII[8]	= {	0  }
	"Set Cons:CavityMatCond[1]"			Cons:CavityMatCond[1]		= {	if (LayerPropertyIndex[1] == 2)
																								then	if (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal > 0 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2LayerRVal
																												else	                              (1 / 12) /  FurringInsul2LayerRVal    endif
																										else if (IfValidAnd( FurringInsul2Layer > 0 ) .AND. IfValidAnd( FurringInsul2Layer < 200 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2Layer
																												else	                              (1 / 12) /  FurringInsul2Layer    endif
																										else if (IfValidAnd( FurringInsul2Layer = 100401 ) .OR. (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal = 0 )))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  0.92
																												else	                              (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif  }
	"Set Cons:CavityMatCond[2]"			Cons:CavityMatCond[2]		= {	if (LayerPropertyIndex[2] == 2)
																								then	if (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal > 0 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2LayerRVal
																												else	                              (1 / 12) /  FurringInsul2LayerRVal    endif
																										else if (IfValidAnd( FurringInsul2Layer > 0 ) .AND. IfValidAnd( FurringInsul2Layer < 200 ))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  FurringInsul2Layer
																												else	                              (1 / 12) /  FurringInsul2Layer    endif
																										else if (IfValidAnd( FurringInsul2Layer = 100401 ) .OR. (IfValidAnd( FurringInsul2Layer = 900 ) .AND. IfValidAnd( FurringInsul2LayerRVal = 0 )))
																										then  if (IfValidAnd( Furring2Layer > 10000 ))
																												then	(mod(Furring2Layer, 10000) / 100 / 12) /  0.92
																												else	                              (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else if (LayerPropertyIndex[2] == 4)
																								then	if (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal > 0 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayerRVal
																												else	                             (1 / 12) /  FurringInsulLayerRVal    endif
																										else if (IfValidAnd( FurringInsulLayer > 0 ) .AND. IfValidAnd( FurringInsulLayer < 200 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayer
																												else	                             (1 / 12) /  FurringInsulLayer    endif
																										else if (IfValidAnd( FurringInsulLayer = 100401 ) .OR. (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal = 0 )))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  0.92
																												else	                             (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif endif  }
	"Set Cons:CavityMatCond[3]"			Cons:CavityMatCond[3]		= {	if (LayerPropertyIndex[3] == 4)
																								then	if (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal > 0 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayerRVal
																												else	                             (1 / 12) /  FurringInsulLayerRVal    endif
																										else if (IfValidAnd( FurringInsulLayer > 0 ) .AND. IfValidAnd( FurringInsulLayer < 200 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayer
																												else	                             (1 / 12) /  FurringInsulLayer    endif
																										else if (IfValidAnd( FurringInsulLayer = 100401 ) .OR. (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal = 0 )))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  0.92
																												else	                             (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif  }
	"Set Cons:CavityMatCond[4]"			Cons:CavityMatCond[4]		= {	if (LayerPropertyIndex[4] == 4)
																								then	if (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal > 0 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayerRVal
																												else	                             (1 / 12) /  FurringInsulLayerRVal    endif
																										else if (IfValidAnd( FurringInsulLayer > 0 ) .AND. IfValidAnd( FurringInsulLayer < 200 ))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  FurringInsulLayer
																												else	                             (1 / 12) /  FurringInsulLayer    endif
																										else if (IfValidAnd( FurringInsulLayer = 100401 ) .OR. (IfValidAnd( FurringInsulLayer = 900 ) .AND. IfValidAnd( FurringInsulLayerRVal = 0 )))
																										then  if (IfValidAnd( FurringLayer > 10000 ))
																												then	(mod(FurringLayer, 10000) / 100 / 12) /  0.92
																												else	                             (1 / 12) /  0.92    endif
																										else  0  endif endif endif
																								else  0  endif  }
	"Set Cons:CavityMatCond[5]"			Cons:CavityMatCond[5]		= {	0  }
	"Set Cons:CavityMatCond[6]"			Cons:CavityMatCond[6]		= {	0  }
	"Set Cons:CavityMatCond[7]"			Cons:CavityMatCond[7]		= {	0  }
	"Set Cons:CavityMatCond[8]"			Cons:CavityMatCond[8]		= {	0  }

; SAC 4/28/15 - mods to set CavityLayerSymVal[*] to 0 for FurringInsul*Layer = no insul...
	"Set Cons:CavityLayerSymVal[1]"		Cons:CavityLayerSymVal[1]   = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	FloorSurfaceLayer  
																									case  2 :	if (FurringInsul2Layer == 100401)
																													then	0
																													else	FurringInsul2Layer  endif 
																									case  3 :	if (MassLayer < 10000)
																													then	(MassLayer * 100) + MassThickness
																													else	 MassLayer   endif
																									default : 0
																								endswitch  }
	"Set Cons:CavityLayerSymVal[2]"		Cons:CavityLayerSymVal[2]   = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	if (FurringInsul2Layer == 100401)
																													then	0
																													else	FurringInsul2Layer  endif 
																									case  3 :	if (MassLayer < 10000)
																													then	(MassLayer * 100) + MassThickness
																													else	 MassLayer   endif          
																									case  4 :	if (FurringInsulLayer == 100401)
																													then	0
																													else	FurringInsulLayer  endif  
																									default : 0
																								endswitch  }
	"Set Cons:CavityLayerSymVal[3]"		Cons:CavityLayerSymVal[3]   = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	if (MassLayer < 10000)
																													then	(MassLayer * 100) + MassThickness
																													else	 MassLayer   endif          
																									case  4 :	if (FurringInsulLayer == 100401)
																													then	0
																													else	FurringInsulLayer  endif  
																									case  5 :	FlrExtFinishLayer 
																									default : 0
																								endswitch  }
	"Set Cons:CavityLayerSymVal[4]"		Cons:CavityLayerSymVal[4]   = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	if (FurringInsulLayer == 100401)
																													then	0
																													else	FurringInsulLayer  endif  
																									case  5 :	FlrExtFinishLayer 
																									default : 0
																								endswitch  }
	"Set Cons:CavityLayerSymVal[5]"		Cons:CavityLayerSymVal[5]   = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :	FlrExtFinishLayer
																									default : 0
																								endswitch  }

	"Set Cons:FrameLayerSymVal[1]"		Cons:FrameLayerSymVal[1]  = {		switch (Local( LayerPropertyIndex[1] ))
																									case  2 :	Furring2Layer 
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[2]"		Cons:FrameLayerSymVal[2]  = {		switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	Furring2Layer 
																									case  4 :	FurringLayer  
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[3]"		Cons:FrameLayerSymVal[3]  = {		switch (Local( LayerPropertyIndex[3] ))
																									case  4 :	FurringLayer  
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[4]"		Cons:FrameLayerSymVal[4]  = {		switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	FurringLayer  
																									default : 0
																								endswitch  }
	"Set Cons:FrameLayerSymVal[5]"		Cons:FrameLayerSymVal[5]  = {	0  }

   ; SAC 5/11/17 - related to user-defined furring insulation r-value
   "Set Cons:LayerUsrInpInsRVal[1]"    Cons:LayerUsrInpInsRVal[1]  = {
         if (LayerPropertyIndex[1] == 2 .AND. FurringInsul2Layer == 900)
         then  FurringInsul2LayerRVal
         else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[2]"    Cons:LayerUsrInpInsRVal[2]  = {
         if (LayerPropertyIndex[2] == 2 .AND. FurringInsul2Layer == 900)
         then  FurringInsul2LayerRVal
         else if (LayerPropertyIndex[2] == 4 .AND. FurringInsulLayer == 900)
         then  FurringInsulLayerRVal
         else  UNDEFINED  endif endif  }
   "Set Cons:LayerUsrInpInsRVal[3]"    Cons:LayerUsrInpInsRVal[3]  = {
         if (LayerPropertyIndex[3] == 4 .AND. FurringInsulLayer == 900)
         then  FurringInsulLayerRVal
         else  UNDEFINED  endif  }
   "Set Cons:LayerUsrInpInsRVal[4]"    Cons:LayerUsrInpInsRVal[4]  = {
         if (LayerPropertyIndex[4] == 4 .AND. FurringInsulLayer == 900)
         then  FurringInsulLayerRVal
         else  UNDEFINED  endif  }
   "Init Cons:LayerUsrInpInsRVal[5]"   Cons:LayerUsrInpInsRVal[5]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[8]"   Cons:LayerUsrInpInsRVal[8]  = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[6]"   Cons:LayerUsrInpInsRVal[6]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[9]"   Cons:LayerUsrInpInsRVal[9]  = {  UNDEFINED  }
   "Init Cons:LayerUsrInpInsRVal[7]"   Cons:LayerUsrInpInsRVal[7]  = {  UNDEFINED  }      "Init Cons:LayerUsrInpInsRVal[10]"  Cons:LayerUsrInpInsRVal[10] = {  UNDEFINED  }

; SAC 6/4/14 - added properties to be reported on CF1R
	"Set Cons:AssemblyLayersRpt[1]"		Cons:AssemblyLayersRpt[1]   = {	switch (Local( LayerPropertyIndex[1] ))
																									case  1 :	Format( "%s %s",      LayerLabels[1], EnumString( FloorSurfaceLayer     ))
																									case  2 :	Format( "%s %s / %s", LayerLabels[2], EnumString( FurringInsul2LayerStr ), EnumString( Furring2LayerAbr )) 
																									case  3 :	Format( "%s %s %s",   LayerLabels[3], EnumString( MassThickness         ), EnumString( MassLayer ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[2]"		Cons:AssemblyLayersRpt[2]   = {	switch (Local( LayerPropertyIndex[2] ))
																									case  2 :	Format( "%s %s / %s", LayerLabels[2], EnumString( FurringInsul2LayerStr ), EnumString( Furring2LayerAbr )) 
																									case  3 :	Format( "%s %s %s",   LayerLabels[3], EnumString( MassThickness         ), EnumString( MassLayer ))        
																									case  4 :	Format( "%s %s / %s", LayerLabels[4], EnumString( FurringInsulLayerStr  ), EnumString( FurringLayerAbr )) 
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[3]"		Cons:AssemblyLayersRpt[3]   = {	switch (Local( LayerPropertyIndex[3] ))
																									case  3 :	Format( "%s %s %s",   LayerLabels[3], EnumString( MassThickness         ), EnumString( MassLayer ))        
																									case  4 :	Format( "%s %s / %s", LayerLabels[4], EnumString( FurringInsulLayerStr  ), EnumString( FurringLayerAbr ))  
																									case  5 :	Format( "%s %s",      LayerLabels[5], EnumString( FlrExtFinishLayer     ))
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[4]"		Cons:AssemblyLayersRpt[4]   = {	switch (Local( LayerPropertyIndex[4] ))
																									case  4 :	Format( "%s %s / %s", LayerLabels[4], EnumString( FurringInsulLayerStr  ), EnumString( FurringLayerAbr ))  
																									case  5 :	Format( "%s %s",      LayerLabels[5], EnumString( FlrExtFinishLayer     )) 
																									default : UNDEFINED
																								endswitch  }
	"Set Cons:AssemblyLayersRpt[5]"		Cons:AssemblyLayersRpt[5]   = {	switch (Local( LayerPropertyIndex[5] ))
																									case  5 :	Format( "%s %s",      LayerLabels[5], EnumString( FlrExtFinishLayer     )) 
																									default : UNDEFINED
																								endswitch  }
	"Blast Cons:AssemblyLayersRpt[6]"	Cons:AssemblyLayersRpt[6]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[7]"	Cons:AssemblyLayersRpt[7]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[8]"	Cons:AssemblyLayersRpt[8]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[9]"	Cons:AssemblyLayersRpt[9]   = {	UNDEFINED  }
	"Blast Cons:AssemblyLayersRpt[10]"	Cons:AssemblyLayersRpt[10]  = {	UNDEFINED  }

;	"Set Cons:FrameSpacing"	; SAC 2/14/12 - moved from ExtWall to facilitate wall splitting
;		Cons:FrameSpacing		= {	if (Local( Type ) == 0 .OR. Local( Type ) == 1)		; "Wood Framed Wall" or "Steel Framed Wall"
;											then	if (Local( FrameLayer ) > 0)
;													then  mod( Local( FrameLayer ), 100 )
;													else  16		; no frame layer specified, so use generic default (??)
;													endif
;											else	0				; NOT wood or steel framed, so no frame spacing used/valid (??)
;											endif  }
;
	"Set Cons:FramingFactor => fraction of gross surface area that includes frame" 
		Cons:FramingFactor	= {	0  }
	"Set Cons:PathFraction[1]"			Cons:PathFraction[1]	= {	1  }		; SAC 3/17/14
	"Set Cons:PathFraction[2]"			Cons:PathFraction[2]	= {	0  }


; SAC 2/27/14 - now initialized in prior rulelist
;	"Init Cons:CavityCodeRValue"		Cons:CavityCodeRValue  = {	0.17 + 0.68  }   ; inside and outside film coeff. consistent w/ both ASHRAE fundamentals & ACM JA4

	"Remaining construction, R-val & U-val calcs"	Cons:Action = {	EvalRulelist( "SetupCons_SinglePath", 1 )  }

	"Set Cons:CodeMaximumUValue"		Cons:CodeMaximumUValue	= {	0  }
;	"Set Cons:CodeMaximumUValue"		Cons:CodeMaximumUValue	= {	if (Global( Proj:ClimateZone ) < 0.5) then  -1
;																						else  ClimateZoneTable( Global( Proj:ClimateZone ), 6 ) + 0.00049  endif  }  ; SAC 2/13/13 - added 0.00049 to allow for check taking into account rounding

	"Set Cons:CodeUValueLabel"			Cons:CodeUValueLabel		= {	" "  }
;	"Set Cons:CodeUValueLabel"			Cons:CodeUValueLabel		= {	if (Local( CodeMaximumUValue ) < 0) then  " "    ; no message - nothing to report
;																						else if (Local( CodeMaximumUValue ) < Local( OverallCodeUValue ))
;																						then  Format( "(doesn't meet max code %.3f U-value (%.3f))", Local( CodeMaximumUValue ), Local( OverallCodeUValue ) )
;																						else  Format( "(meets max code %.3f U-value (%.3f))", Local( CodeMaximumUValue ), Local( OverallCodeUValue ) )
;																						endif endif  }
END

;*************************************************************************   SAC 10/22/19 - rulelist to REVERSE to order of Cons layer reporting
RULELIST "SetupCons_ReverseAssemblyLayersRpt"    0 0 0 1
;*************************************************************************
; store reverse order
   "Set Cons:AssemblyLayersRev[1]"     Cons:AssemblyLayersRev[1]  =
      {  switch (NumLayersRpt)
            case  2 : AssemblyLayersRpt[2]    case  3 : AssemblyLayersRpt[3]    case  4 : AssemblyLayersRpt[4]    case  5 : AssemblyLayersRpt[5]
            case  6 : AssemblyLayersRpt[6]    case  7 : AssemblyLayersRpt[7]    case  8 : AssemblyLayersRpt[8]    case  9 : AssemblyLayersRpt[9]
            case 10 : AssemblyLayersRpt[10]   default : UNDEFINED               endswitch  }
   "Set Cons:AssemblyLayersRev[2]"     Cons:AssemblyLayersRev[2]  =
      {  switch (NumLayersRpt)
            case  2 : AssemblyLayersRpt[1]    case  3 : AssemblyLayersRpt[2]    case  4 : AssemblyLayersRpt[3]    case  5 : AssemblyLayersRpt[4]
            case  6 : AssemblyLayersRpt[5]    case  7 : AssemblyLayersRpt[6]    case  8 : AssemblyLayersRpt[7]    case  9 : AssemblyLayersRpt[8]
            case 10 : AssemblyLayersRpt[9]    default : UNDEFINED               endswitch  }
   "Set Cons:AssemblyLayersRev[3]"     Cons:AssemblyLayersRev[3]  =
      {  switch (NumLayersRpt)
            case  3 : AssemblyLayersRpt[1]    case  4 : AssemblyLayersRpt[2]    case  5 : AssemblyLayersRpt[3]    case  6 : AssemblyLayersRpt[4]
            case  7 : AssemblyLayersRpt[5]    case  8 : AssemblyLayersRpt[6]    case  9 : AssemblyLayersRpt[7]    case 10 : AssemblyLayersRpt[8]
            default : UNDEFINED               endswitch  }
   "Set Cons:AssemblyLayersRev[4]"     Cons:AssemblyLayersRev[4]  =
      {  switch (NumLayersRpt)
            case  4 : AssemblyLayersRpt[1]    case  5 : AssemblyLayersRpt[2]    case  6 : AssemblyLayersRpt[3]    case  7 : AssemblyLayersRpt[4]
            case  8 : AssemblyLayersRpt[5]    case  9 : AssemblyLayersRpt[6]    case 10 : AssemblyLayersRpt[7]    default : UNDEFINED
            endswitch  }
   "Set Cons:AssemblyLayersRev[5]"     Cons:AssemblyLayersRev[5]  =
      {  switch (NumLayersRpt)
            case  5 : AssemblyLayersRpt[1]    case  6 : AssemblyLayersRpt[2]    case  7 : AssemblyLayersRpt[3]    case  8 : AssemblyLayersRpt[4]
            case  9 : AssemblyLayersRpt[5]    case 10 : AssemblyLayersRpt[6]    default : UNDEFINED               endswitch  }
   "Set Cons:AssemblyLayersRev[6]"     Cons:AssemblyLayersRev[6]  =
      {  switch (NumLayersRpt)
            case  6 : AssemblyLayersRpt[1]    case  7 : AssemblyLayersRpt[2]    case  8 : AssemblyLayersRpt[3]    case  9 : AssemblyLayersRpt[4]
            case 10 : AssemblyLayersRpt[5]    default : UNDEFINED               endswitch  }
   "Set Cons:AssemblyLayersRev[7]"     Cons:AssemblyLayersRev[7]  =
      {  switch (NumLayersRpt)
            case  7 : AssemblyLayersRpt[1]    case  8 : AssemblyLayersRpt[2]    case  9 : AssemblyLayersRpt[3]    case 10 : AssemblyLayersRpt[4]
            default : UNDEFINED               endswitch  }
   "Set Cons:AssemblyLayersRev[8]"     Cons:AssemblyLayersRev[8]  =
      {  switch (NumLayersRpt)
            case  8 : AssemblyLayersRpt[1]    case  9 : AssemblyLayersRpt[2]    case 10 : AssemblyLayersRpt[3]
            default : UNDEFINED               endswitch  }
   "Set Cons:AssemblyLayersRev[9]"     Cons:AssemblyLayersRev[9]  =
      {  switch (NumLayersRpt)
            case  9 : AssemblyLayersRpt[1]    case 10 : AssemblyLayersRpt[2]    default : UNDEFINED               endswitch  }
   "Set Cons:AssemblyLayersRev[10]"    Cons:AssemblyLayersRev[10]  =
      {  switch (NumLayersRpt)
            case 10 : AssemblyLayersRpt[1]    default : UNDEFINED               endswitch  }
; copy reverse order to reporting data
   "Set Cons:AssemblyLayersRpt[1]"     Cons:AssemblyLayersRpt[1]  = {  AssemblyLayersRev[1]  }
   "Set Cons:AssemblyLayersRpt[2]"     Cons:AssemblyLayersRpt[2]  = {  AssemblyLayersRev[2]  }
   "Set Cons:AssemblyLayersRpt[3]"     Cons:AssemblyLayersRpt[3]  = {  AssemblyLayersRev[3]  }
   "Set Cons:AssemblyLayersRpt[4]"     Cons:AssemblyLayersRpt[4]  = {  AssemblyLayersRev[4]  }
   "Set Cons:AssemblyLayersRpt[5]"     Cons:AssemblyLayersRpt[5]  = {  AssemblyLayersRev[5]  }
   "Set Cons:AssemblyLayersRpt[6]"     Cons:AssemblyLayersRpt[6]  = {  AssemblyLayersRev[6]  }
   "Set Cons:AssemblyLayersRpt[7]"     Cons:AssemblyLayersRpt[7]  = {  AssemblyLayersRev[7]  }
   "Set Cons:AssemblyLayersRpt[8]"     Cons:AssemblyLayersRpt[8]  = {  AssemblyLayersRev[8]  }
   "Set Cons:AssemblyLayersRpt[9]"     Cons:AssemblyLayersRpt[9]  = {  AssemblyLayersRev[9]  }
   "Set Cons:AssemblyLayersRpt[10]"    Cons:AssemblyLayersRpt[10] = {  AssemblyLayersRev[10] }
; blast reverse order copy
   "Blast Cons:AssemblyLayersRev[1]"   Cons:AssemblyLayersRev[1]  = {  UNDEFINED  }
   "Blast Cons:AssemblyLayersRev[2]"   Cons:AssemblyLayersRev[2]  = {  UNDEFINED  }
   "Blast Cons:AssemblyLayersRev[3]"   Cons:AssemblyLayersRev[3]  = {  UNDEFINED  }
   "Blast Cons:AssemblyLayersRev[4]"   Cons:AssemblyLayersRev[4]  = {  UNDEFINED  }
   "Blast Cons:AssemblyLayersRev[5]"   Cons:AssemblyLayersRev[5]  = {  UNDEFINED  }
   "Blast Cons:AssemblyLayersRev[6]"   Cons:AssemblyLayersRev[6]  = {  UNDEFINED  }
   "Blast Cons:AssemblyLayersRev[7]"   Cons:AssemblyLayersRev[7]  = {  UNDEFINED  }
   "Blast Cons:AssemblyLayersRev[8]"   Cons:AssemblyLayersRev[8]  = {  UNDEFINED  }
   "Blast Cons:AssemblyLayersRev[9]"   Cons:AssemblyLayersRev[9]  = {  UNDEFINED  }
   "Blast Cons:AssemblyLayersRev[10]"  Cons:AssemblyLayersRev[10] = {  UNDEFINED  }
END
;*************************************************************************

;*************************************************************************
RULELIST "SetupCons_CavityMaterials"         0 0 0 1
;*************************************************************************

; SAC 6/24/13 - expanded sheathing options to include R-9 thru R-12
; SAC 3/12/14 - migrated mapping of CavityLayerSymVal[*] to T24RMatLibrary table w/ addition of hollow masonry unit selections
; SAC 3/13/14 - revised logic to prevent UN-referencing of Mat objects created to model combined insulation/furring layer
; SAC 5/11/17 - updated first portion of created insulation name from "Shthg" -> "Insul"
 ; Setup Cavity/Frame Mat object references (typically through rule library imports)
	"Set Cons:CavityPathMats[1]"		Cons:CavityPathMats[1]	= {
				if ((IfValidAnd( FrameCavityLayerMat[1] == 1 ) .OR.  IfValidAnd( FrameCavityLayerMat[2] == 1 )) .AND. IfValidAnd( FrameLayerSymVal[1] >= 10000 ) .AND.
					  IfValidAnd( FrameLayerSymVal[1] < 40000 ) .AND. IfValidAnd( CavityPathMats[1]:ConductivityQII == CavityMatCondQII[1] )) then	UNCHANGED
				else if (IfValidAnd( CavityLayerSymVal[1] = 0 )) then  UNDEFINED
				else if (IfValidAnd( CavityLayerSymVal[1] > 1000 ) == 0) then  UNCHANGED
				else if (T24RMatLibrary:HaveEntry( "LayerSymVal", CavityLayerSymVal[1] ))
				then	RuleLibrary( Mat, T24RMatLibrary:MatName( "LayerSymVal", CavityLayerSymVal[1] ) )
				else if (IfValidAnd( CavityLayerSymVal[1] = 99000 ) .AND. IfValidAnd( LayerUsrInpInsRVal[1] > 0 ))
				then	AssignOrCreateComp( Mat, Format( "Insul-R%g-D1.5-SH0.35-C%s", LayerUsrInpInsRVal[1],
											FltToStr( (0.08333 / LayerUsrInpInsRVal[1]), 5, 1, 0, 1 ) ), "Density", 1.5, "SpecHeat", 0.35, "Thickness", 1,
											"Conductivity", (0.08333 / LayerUsrInpInsRVal[1]), "ConductivityQII", (0.08333 / LayerUsrInpInsRVal[1]), "ConductivityCT", 0.00175, "MarkForDeletion", UNDEFINED )
				else if (IfValidAnd( CavityLayerSymVal[1] > 99000 ) .AND. IfValidAnd( CavityLayerSymVal[1] <= 99300 ))
				then	AssignOrCreateComp( Mat, Format( "Insul-R%s-D1.5-SH0.35-C%s", FltToStr( (CavityLayerSymVal[1]-99000), 1, 1, 0, 1 ),
											FltToStr( (0.08333 / (CavityLayerSymVal[1]-99000)), 5, 1, 0, 1 ) ), "Density", 1.5, "SpecHeat", 0.35, "Thickness", 1,
											"Conductivity", (0.08333 / (CavityLayerSymVal[1]-99000)), "ConductivityQII", (0.08333 / (CavityLayerSymVal[1]-99000)), "ConductivityCT", 0.00175, "MarkForDeletion", UNDEFINED )
				else	UNDEFINED  endif endif endif endif endif endif  }
		;		switch (Local( CavityLayerSymVal[1] ))
		;				case  99001 :	RuleLibrary( Mat, "R1 Sheathing" )		; "R1 Sheathing"
		;				case  99002 :	RuleLibrary( Mat, "R2 Sheathing" )		; "R2 Sheathing"
		;				case  99003 :	RuleLibrary( Mat, "R3 Sheathing" )		; "R3 Sheathing"
		;				case  99004 :	RuleLibrary( Mat, "R4 Sheathing" )		; "R4 Sheathing"
		;				case  99005 :	RuleLibrary( Mat, "R5 Sheathing" )		; "R5 Sheathing"
		;				case  99006 :	RuleLibrary( Mat, "R6 Sheathing" )		; "R6 Sheathing"
		;				case  99007 :	RuleLibrary( Mat, "R7 Sheathing" )		; "R7 Sheathing"
		;				case  99008 :	RuleLibrary( Mat, "R8 Sheathing" )		; "R8 Sheathing"
		;				case  99009 :	RuleLibrary( Mat, "R9 Sheathing" )		; "R9 Sheathing"
		;				case  99010 :	RuleLibrary( Mat, "R10 Sheathing" )		; "R10 Sheathing"
		;				case  99011 :	RuleLibrary( Mat, "R11 Sheathing" )		; "R11 Sheathing"
		;				case  99012 :	RuleLibrary( Mat, "R12 Sheathing" )		; "R12 Sheathing"
		;				case 100101 :	RuleLibrary( Mat, "Gypsum Board" )		; "Gypsum Board"
		;				case 100102 :	RuleLibrary( Mat, "Wood layer" )			; "Wood Siding/sheathing/decking"
		;				case 100103 :	RuleLibrary( Mat, "R4 Synth Stucco" )	; "R4 Synthetic Stucco"
		;				case 100104 :	RuleLibrary( Mat, "3 Coat Stucco" )		; "3 Coat Stucco"
		;				case 100105 :	RuleLibrary( Mat, "Carpet" )
		;				case 100106 :	RuleLibrary( Mat, "SoftWood" )
		;				case 100107 :	RuleLibrary( Mat, "Concrete" )
		;				case 100108 :	RuleLibrary( Mat, "Hardwood" )
		;				case 100109 :	RuleLibrary( Mat, "FloorTile" )
		;				case 100110 :   RuleLibrary( Mat, "FloorVinyl")
		;				case 100111 :	RuleLibrary( Mat, "Brick" )				; Brick  - SAC 2/26/14
		;				case 100201 :	RuleLibrary( Mat, "Light Roof"  )		; "Light Roof (Asphalt Shingle)"
		;				case 100202 :	RuleLibrary( Mat, "5 PSF Roof"  )		; "5 PSF (Normal Gravel)"
		;				case 100203 :	RuleLibrary( Mat, "10 PSF Roof" )		; "10 PSF (RoofTile)"
		;				case 100204 :	RuleLibrary( Mat, "15 PSF Roof" )		; "15 PSF (Heavy Ballast or Pavers)"
		;				case 100205 :	RuleLibrary( Mat, "25 PSF Roof" )		; "25 PSF (Very Heavy Ballast or Pavers)"
		;				case 100206 :	RuleLibrary( Mat, "TileGap" )				; present when RoofingType = "Steep Slope Roof tile, metal tile, or wood shakes"
		;				case 100301 :	RuleLibrary( Mat, "SlabOnGrade" )
		;				case 100302 :	RuleLibrary( Mat, "Earth" )
		;				case 100303 :	RuleLibrary( Mat, "Crawl" )
		;				case 100401 :	RuleLibrary( Mat, "VertWallCavity" )	; SAC 1/28/13
		;				case 98017  :   RuleLibrary( Mat, "16 in. StrawBale" ) ; DD 2/14/14
		;			; CavityLayer (no library mat - assign via sim prep rulelist)
		;				default     :	UNDEFINED		; EITHER no layer is defined here -OR- this maps to valid Cavity (empty or R-val) layer -> wait until simulation prep ...  EvalRulelist( "CreateConsCavityInsulMat_1", 1 )
		;									endswitch  }

;	from BESTEST runs:
;	 MATERIAL	"R18Insulation"		matCond      = 0.0255	        matSpHt  = 0.20	  matDens = 0.68
;	 MATERIAL   "R19Insulation"		matCond      = 0.0274	        matSpHt  = 0.20	  matDens = 0.6   matCondCT =0.00418 //BAW 120310
;	 MATERIAL   "R38Insulation"		matCond      = 0.0263	        matSpHt  = 0.20	  matDens = 0.6
;	; Mat  "BlownInsul"              Conductivity = 0.032051282/RCQ  SpecHeat = 0.2    Density = 0.5    RValPerInch =   ..   ; Certainteed InsulSafeSP Fiber Glass   R=2.6/in for R30-38

	"Set Cons:CavityPathMats[2]"		Cons:CavityPathMats[2]	= {
				if ((IfValidAnd( FrameCavityLayerMat[1] == 2 ) .OR.  IfValidAnd( FrameCavityLayerMat[2] == 2 )) .AND. IfValidAnd( FrameLayerSymVal[2] >= 10000 ) .AND.
					  IfValidAnd( FrameLayerSymVal[2] < 40000 ) .AND. IfValidAnd( CavityPathMats[2]:ConductivityQII == CavityMatCondQII[2] )) then	UNCHANGED
				else if (IfValidAnd( CavityLayerSymVal[2] = 0 )) then  UNDEFINED
				else if (IfValidAnd( CavityLayerSymVal[2] > 1000 ) == 0) then  UNCHANGED
				else if (T24RMatLibrary:HaveEntry( "LayerSymVal", CavityLayerSymVal[2] ))
				then	RuleLibrary( Mat, T24RMatLibrary:MatName( "LayerSymVal", CavityLayerSymVal[2] ) )
				else if (IfValidAnd( CavityLayerSymVal[2] = 99000 ) .AND. IfValidAnd( LayerUsrInpInsRVal[2] > 0 ))
				then	AssignOrCreateComp( Mat, Format( "Insul-R%g-D1.5-SH0.35-C%s", LayerUsrInpInsRVal[2],
											FltToStr( (0.08333 / LayerUsrInpInsRVal[2]), 5, 1, 0, 1 ) ), "Density", 1.5, "SpecHeat", 0.35, "Thickness", 1,
											"Conductivity", (0.08333 / LayerUsrInpInsRVal[2]), "ConductivityQII", (0.08333 / LayerUsrInpInsRVal[2]), "ConductivityCT", 0.00175, "MarkForDeletion", UNDEFINED )
				else if (IfValidAnd( CavityLayerSymVal[2] > 99000 ) .AND. IfValidAnd( CavityLayerSymVal[2] <= 99300 ))
				then	AssignOrCreateComp( Mat, Format( "Insul-R%s-D1.5-SH0.35-C%s", FltToStr( (CavityLayerSymVal[2]-99000), 1, 1, 0, 1 ),
											FltToStr( (0.08333 / (CavityLayerSymVal[2]-99000)), 5, 1, 0, 1 ) ), "Density", 1.5, "SpecHeat", 0.35, "Thickness", 1,
											"Conductivity", (0.08333 / (CavityLayerSymVal[2]-99000)), "ConductivityQII", (0.08333 / (CavityLayerSymVal[2]-99000)), "ConductivityCT", 0.00175, "MarkForDeletion", UNDEFINED )
				else	UNDEFINED  endif endif endif endif endif endif  }
; SAC 3/16/14 - to be REMOVED
;"store BEMProc details"		Cons:Action = {  if (Name != "R15 R4 Stucco Wall") then  UNCHANGED  else	StoreBEMProc( "Befor CavityPathMats-3 to undef", 0 )  endif  }
;"debug"		Cons:Action	= {	if (Name != "R15 R4 Stucco Wall") then  UNCHANGED	else	MessageBox( "Befor CavityPathMats-3 to undef @ line 22710" )  endif  }
	"Set Cons:CavityPathMats[3]"		Cons:CavityPathMats[3]	= {
				if ((IfValidAnd( FrameCavityLayerMat[1] == 3 ) .OR.  IfValidAnd( FrameCavityLayerMat[2] == 3 )) .AND. IfValidAnd( FrameLayerSymVal[3] >= 10000 ) .AND.
					  IfValidAnd( FrameLayerSymVal[3] < 40000 ) .AND. IfValidAnd( CavityPathMats[3]:ConductivityQII == CavityMatCondQII[3] )) then	UNCHANGED
				else if (IfValidAnd( CavityLayerSymVal[3] = 0 )) then  UNDEFINED
				else if (IfValidAnd( CavityLayerSymVal[3] > 1000 ) == 0) then  UNCHANGED
				else if (T24RMatLibrary:HaveEntry( "LayerSymVal", CavityLayerSymVal[3] ))
				then	RuleLibrary( Mat, T24RMatLibrary:MatName( "LayerSymVal", CavityLayerSymVal[3] ) )
				else if (IfValidAnd( CavityLayerSymVal[3] = 99000 ) .AND. IfValidAnd( LayerUsrInpInsRVal[3] > 0 ))
				then	AssignOrCreateComp( Mat, Format( "Insul-R%g-D1.5-SH0.35-C%s", LayerUsrInpInsRVal[3],
											FltToStr( (0.08333 / LayerUsrInpInsRVal[3]), 5, 1, 0, 1 ) ), "Density", 1.5, "SpecHeat", 0.35, "Thickness", 1,
											"Conductivity", (0.08333 / LayerUsrInpInsRVal[3]), "ConductivityQII", (0.08333 / LayerUsrInpInsRVal[3]), "ConductivityCT", 0.00175, "MarkForDeletion", UNDEFINED )
				else if (IfValidAnd( CavityLayerSymVal[3] > 99000 ) .AND. IfValidAnd( CavityLayerSymVal[3] <= 99300 ))
				then	AssignOrCreateComp( Mat, Format( "Insul-R%s-D1.5-SH0.35-C%s", FltToStr( (CavityLayerSymVal[3]-99000), 1, 1, 0, 1 ),
											FltToStr( (0.08333 / (CavityLayerSymVal[3]-99000)), 5, 1, 0, 1 ) ), "Density", 1.5, "SpecHeat", 0.35, "Thickness", 1,
											"Conductivity", (0.08333 / (CavityLayerSymVal[3]-99000)), "ConductivityQII", (0.08333 / (CavityLayerSymVal[3]-99000)), "ConductivityCT", 0.00175, "MarkForDeletion", UNDEFINED )
				else	UNDEFINED  endif endif endif endif endif endif  }
; SAC 3/16/14 - to be REMOVED
;"Log certain CavityPathMats selection"		Cons:Action = {  if (Name != "R15 R4 Stucco Wall") then  UNCHANGED
;			else if (LocalCompAssigned( CavityPathMats[3] )) then	PostMessageToLog( "Rule line: 22716 - Cons 'R15 R4 Stucco Wall' CavityPathMats[3] = '%s'", CavityPathMats[3]:Name )
;			else  PostMessageToLog( "Rule line: 22716 - Cons 'R15 R4 Stucco Wall' CavityPathMats[3]    UNDEFINED" )  endif endif  }
	"Set Cons:CavityPathMats[4]"		Cons:CavityPathMats[4]	= {
				if ((IfValidAnd( FrameCavityLayerMat[1] == 4 ) .OR.  IfValidAnd( FrameCavityLayerMat[2] == 4 )) .AND. IfValidAnd( FrameLayerSymVal[4] >= 10000 ) .AND.
					  IfValidAnd( FrameLayerSymVal[4] < 40000 ) .AND. IfValidAnd( CavityPathMats[4]:ConductivityQII == CavityMatCondQII[4] )) then	UNCHANGED
				else if (IfValidAnd( CavityLayerSymVal[4] = 0 )) then  UNDEFINED
				else if (IfValidAnd( CavityLayerSymVal[4] > 1000 ) == 0) then  UNCHANGED
				else if (T24RMatLibrary:HaveEntry( "LayerSymVal", CavityLayerSymVal[4] ))
				then	RuleLibrary( Mat, T24RMatLibrary:MatName( "LayerSymVal", CavityLayerSymVal[4] ) )
				else if (IfValidAnd( CavityLayerSymVal[4] = 99000 ) .AND. IfValidAnd( LayerUsrInpInsRVal[4] > 0 ))
				then	AssignOrCreateComp( Mat, Format( "Insul-R%g-D1.5-SH0.35-C%s", LayerUsrInpInsRVal[4],
											FltToStr( (0.08333 / LayerUsrInpInsRVal[4]), 5, 1, 0, 1 ) ), "Density", 1.5, "SpecHeat", 0.35, "Thickness", 1,
											"Conductivity", (0.08333 / LayerUsrInpInsRVal[4]), "ConductivityQII", (0.08333 / LayerUsrInpInsRVal[4]), "ConductivityCT", 0.00175, "MarkForDeletion", UNDEFINED )
				else if (IfValidAnd( CavityLayerSymVal[4] > 99000 ) .AND. IfValidAnd( CavityLayerSymVal[4] <= 99300 ))
				then	AssignOrCreateComp( Mat, Format( "Insul-R%s-D1.5-SH0.35-C%s", FltToStr( (CavityLayerSymVal[4]-99000), 1, 1, 0, 1 ),
											FltToStr( (0.08333 / (CavityLayerSymVal[4]-99000)), 5, 1, 0, 1 ) ), "Density", 1.5, "SpecHeat", 0.35, "Thickness", 1,
											"Conductivity", (0.08333 / (CavityLayerSymVal[4]-99000)), "ConductivityQII", (0.08333 / (CavityLayerSymVal[4]-99000)), "ConductivityCT", 0.00175, "MarkForDeletion", UNDEFINED )
				else	UNDEFINED  endif endif endif endif endif endif  }
	"Set Cons:CavityPathMats[5]"		Cons:CavityPathMats[5]	= {
				if ((IfValidAnd( FrameCavityLayerMat[1] == 5 ) .OR.  IfValidAnd( FrameCavityLayerMat[2] == 5 )) .AND. IfValidAnd( FrameLayerSymVal[5] >= 10000 ) .AND.
					  IfValidAnd( FrameLayerSymVal[5] < 40000 ) .AND. IfValidAnd( CavityPathMats[5]:ConductivityQII == CavityMatCondQII[5] )) then	UNCHANGED
				else if (IfValidAnd( CavityLayerSymVal[5] = 0 )) then  UNDEFINED
				else if (IfValidAnd( CavityLayerSymVal[5] > 1000 ) == 0) then  UNCHANGED
				else if (T24RMatLibrary:HaveEntry( "LayerSymVal", CavityLayerSymVal[5] ))
				then	RuleLibrary( Mat, T24RMatLibrary:MatName( "LayerSymVal", CavityLayerSymVal[5] ) )
				else if (IfValidAnd( CavityLayerSymVal[5] = 99000 ) .AND. IfValidAnd( LayerUsrInpInsRVal[5] > 0 ))
				then	AssignOrCreateComp( Mat, Format( "Insul-R%g-D1.5-SH0.35-C%s", LayerUsrInpInsRVal[5],
											FltToStr( (0.08333 / LayerUsrInpInsRVal[5]), 5, 1, 0, 1 ) ), "Density", 1.5, "SpecHeat", 0.35, "Thickness", 1,
											"Conductivity", (0.08333 / LayerUsrInpInsRVal[5]), "ConductivityQII", (0.08333 / LayerUsrInpInsRVal[5]), "ConductivityCT", 0.00175, "MarkForDeletion", UNDEFINED )
				else if (IfValidAnd( CavityLayerSymVal[5] > 99000 ) .AND. IfValidAnd( CavityLayerSymVal[5] <= 99300 ))
				then	AssignOrCreateComp( Mat, Format( "Insul-R%s-D1.5-SH0.35-C%s", FltToStr( (CavityLayerSymVal[5]-99000), 1, 1, 0, 1 ),
											FltToStr( (0.08333 / (CavityLayerSymVal[5]-99000)), 5, 1, 0, 1 ) ), "Density", 1.5, "SpecHeat", 0.35, "Thickness", 1,
											"Conductivity", (0.08333 / (CavityLayerSymVal[5]-99000)), "ConductivityQII", (0.08333 / (CavityLayerSymVal[5]-99000)), "ConductivityCT", 0.00175, "MarkForDeletion", UNDEFINED )
				else	UNDEFINED  endif endif endif endif endif endif  }
	"Set Cons:CavityPathMats[6]"		Cons:CavityPathMats[6]	= {
				if ((IfValidAnd( FrameCavityLayerMat[1] == 6 ) .OR.  IfValidAnd( FrameCavityLayerMat[2] == 6 )) .AND. IfValidAnd( FrameLayerSymVal[6] >= 10000 ) .AND.
					  IfValidAnd( FrameLayerSymVal[6] < 40000 ) .AND. IfValidAnd( CavityPathMats[6]:ConductivityQII == CavityMatCondQII[6] )) then	UNCHANGED
				else if (IfValidAnd( CavityLayerSymVal[6] = 0 )) then  UNDEFINED
				else if (IfValidAnd( CavityLayerSymVal[6] > 1000 ) == 0) then  UNCHANGED
				else if (T24RMatLibrary:HaveEntry( "LayerSymVal", CavityLayerSymVal[6] ))
				then	RuleLibrary( Mat, T24RMatLibrary:MatName( "LayerSymVal", CavityLayerSymVal[6] ) )
				else if (IfValidAnd( CavityLayerSymVal[6] = 99000 ) .AND. IfValidAnd( LayerUsrInpInsRVal[6] > 0 ))
				then	AssignOrCreateComp( Mat, Format( "Insul-R%g-D1.5-SH0.35-C%s", LayerUsrInpInsRVal[6],
											FltToStr( (0.08333 / LayerUsrInpInsRVal[6]), 5, 1, 0, 1 ) ), "Density", 1.5, "SpecHeat", 0.35, "Thickness", 1,
											"Conductivity", (0.08333 / LayerUsrInpInsRVal[6]), "ConductivityQII", (0.08333 / LayerUsrInpInsRVal[6]), "ConductivityCT", 0.00175, "MarkForDeletion", UNDEFINED )
				else if (IfValidAnd( CavityLayerSymVal[6] > 99000 ) .AND. IfValidAnd( CavityLayerSymVal[6] <= 99300 ))
				then	AssignOrCreateComp( Mat, Format( "Insul-R%s-D1.5-SH0.35-C%s", FltToStr( (CavityLayerSymVal[6]-99000), 1, 1, 0, 1 ),
											FltToStr( (0.08333 / (CavityLayerSymVal[6]-99000)), 5, 1, 0, 1 ) ), "Density", 1.5, "SpecHeat", 0.35, "Thickness", 1,
											"Conductivity", (0.08333 / (CavityLayerSymVal[6]-99000)), "ConductivityQII", (0.08333 / (CavityLayerSymVal[6]-99000)), "ConductivityCT", 0.00175, "MarkForDeletion", UNDEFINED )
				else	UNDEFINED  endif endif endif endif endif endif  }
	"Set Cons:CavityPathMats[7]"		Cons:CavityPathMats[7]	= {
				if ((IfValidAnd( FrameCavityLayerMat[1] == 7 ) .OR.  IfValidAnd( FrameCavityLayerMat[2] == 7 )) .AND. IfValidAnd( FrameLayerSymVal[7] >= 10000 ) .AND.
					  IfValidAnd( FrameLayerSymVal[7] < 40000 ) .AND. IfValidAnd( CavityPathMats[7]:ConductivityQII == CavityMatCondQII[7] )) then	UNCHANGED
				else if (IfValidAnd( CavityLayerSymVal[7] = 0 )) then  UNDEFINED
				else if (IfValidAnd( CavityLayerSymVal[7] > 1000 ) == 0) then  UNCHANGED
				else if (T24RMatLibrary:HaveEntry( "LayerSymVal", CavityLayerSymVal[7] ))
				then	RuleLibrary( Mat, T24RMatLibrary:MatName( "LayerSymVal", CavityLayerSymVal[7] ) )
				else if (IfValidAnd( CavityLayerSymVal[7] = 99000 ) .AND. IfValidAnd( LayerUsrInpInsRVal[7] > 0 ))
				then	AssignOrCreateComp( Mat, Format( "Insul-R%g-D1.5-SH0.35-C%s", LayerUsrInpInsRVal[7],
											FltToStr( (0.08333 / LayerUsrInpInsRVal[7]), 5, 1, 0, 1 ) ), "Density", 1.5, "SpecHeat", 0.35, "Thickness", 1,
											"Conductivity", (0.08333 / LayerUsrInpInsRVal[7]), "ConductivityQII", (0.08333 / LayerUsrInpInsRVal[7]), "ConductivityCT", 0.00175, "MarkForDeletion", UNDEFINED )
				else if (IfValidAnd( CavityLayerSymVal[7] > 99000 ) .AND. IfValidAnd( CavityLayerSymVal[7] <= 99300 ))
				then	AssignOrCreateComp( Mat, Format( "Insul-R%s-D1.5-SH0.35-C%s", FltToStr( (CavityLayerSymVal[7]-99000), 1, 1, 0, 1 ),
											FltToStr( (0.08333 / (CavityLayerSymVal[7]-99000)), 5, 1, 0, 1 ) ), "Density", 1.5, "SpecHeat", 0.35, "Thickness", 1,
											"Conductivity", (0.08333 / (CavityLayerSymVal[7]-99000)), "ConductivityQII", (0.08333 / (CavityLayerSymVal[7]-99000)), "ConductivityCT", 0.00175, "MarkForDeletion", UNDEFINED )
				else	UNDEFINED  endif endif endif endif endif endif  }
	"Set Cons:CavityPathMats[8]"		Cons:CavityPathMats[8]	= {
				if ((IfValidAnd( FrameCavityLayerMat[1] == 8 ) .OR.  IfValidAnd( FrameCavityLayerMat[2] == 8 )) .AND. IfValidAnd( FrameLayerSymVal[8] >= 10000 ) .AND.
					  IfValidAnd( FrameLayerSymVal[8] < 40000 ) .AND. IfValidAnd( CavityPathMats[8]:ConductivityQII == CavityMatCondQII[8] )) then	UNCHANGED
				else if (IfValidAnd( CavityLayerSymVal[8] = 0 )) then  UNDEFINED
				else if (IfValidAnd( CavityLayerSymVal[8] > 1000 ) == 0) then  UNCHANGED
				else if (T24RMatLibrary:HaveEntry( "LayerSymVal", CavityLayerSymVal[8] ))
				then	RuleLibrary( Mat, T24RMatLibrary:MatName( "LayerSymVal", CavityLayerSymVal[8] ) )
				else if (IfValidAnd( CavityLayerSymVal[8] = 99000 ) .AND. IfValidAnd( LayerUsrInpInsRVal[8] > 0 ))
				then	AssignOrCreateComp( Mat, Format( "Insul-R%g-D1.5-SH0.35-C%s", LayerUsrInpInsRVal[8],
											FltToStr( (0.08333 / LayerUsrInpInsRVal[8]), 5, 1, 0, 1 ) ), "Density", 1.5, "SpecHeat", 0.35, "Thickness", 1,
											"Conductivity", (0.08333 / LayerUsrInpInsRVal[8]), "ConductivityQII", (0.08333 / LayerUsrInpInsRVal[8]), "ConductivityCT", 0.00175, "MarkForDeletion", UNDEFINED )
				else if (IfValidAnd( CavityLayerSymVal[8] > 99000 ) .AND. IfValidAnd( CavityLayerSymVal[8] <= 99300 ))
				then	AssignOrCreateComp( Mat, Format( "Insul-R%s-D1.5-SH0.35-C%s", FltToStr( (CavityLayerSymVal[8]-99000), 1, 1, 0, 1 ),
											FltToStr( (0.08333 / (CavityLayerSymVal[8]-99000)), 5, 1, 0, 1 ) ), "Density", 1.5, "SpecHeat", 0.35, "Thickness", 1,
											"Conductivity", (0.08333 / (CavityLayerSymVal[8]-99000)), "ConductivityQII", (0.08333 / (CavityLayerSymVal[8]-99000)), "ConductivityCT", 0.00175, "MarkForDeletion", UNDEFINED )
				else	UNDEFINED  endif endif endif endif endif endif  }
	"Set Cons:CavityPathMats[9]"		Cons:CavityPathMats[9]	= {
				if ((IfValidAnd( FrameCavityLayerMat[1] == 9 ) .OR.  IfValidAnd( FrameCavityLayerMat[2] == 9 )) .AND. IfValidAnd( FrameLayerSymVal[9] >= 10000 ) .AND.
					  IfValidAnd( FrameLayerSymVal[9] < 40000 ) .AND. IfValidAnd( CavityPathMats[9]:ConductivityQII == CavityMatCondQII[9] )) then	UNCHANGED
				else if (IfValidAnd( CavityLayerSymVal[9] = 0 )) then  UNDEFINED
				else if (IfValidAnd( CavityLayerSymVal[9] > 1000 ) == 0) then  UNCHANGED
				else if (T24RMatLibrary:HaveEntry( "LayerSymVal", CavityLayerSymVal[9] ))
				then	RuleLibrary( Mat, T24RMatLibrary:MatName( "LayerSymVal", CavityLayerSymVal[9] ) )
				else if (IfValidAnd( CavityLayerSymVal[9] = 99000 ) .AND. IfValidAnd( LayerUsrInpInsRVal[9] > 0 ))
				then	AssignOrCreateComp( Mat, Format( "Insul-R%g-D1.5-SH0.35-C%s", LayerUsrInpInsRVal[9],
											FltToStr( (0.08333 / LayerUsrInpInsRVal[9]), 5, 1, 0, 1 ) ), "Density", 1.5, "SpecHeat", 0.35, "Thickness", 1,
											"Conductivity", (0.08333 / LayerUsrInpInsRVal[9]), "ConductivityQII", (0.08333 / LayerUsrInpInsRVal[9]), "ConductivityCT", 0.00175, "MarkForDeletion", UNDEFINED )
				else if (IfValidAnd( CavityLayerSymVal[9] > 99000 ) .AND. IfValidAnd( CavityLayerSymVal[9] <= 99300 ))
				then	AssignOrCreateComp( Mat, Format( "Insul-R%s-D1.5-SH0.35-C%s", FltToStr( (CavityLayerSymVal[9]-99000), 1, 1, 0, 1 ),
											FltToStr( (0.08333 / (CavityLayerSymVal[9]-99000)), 5, 1, 0, 1 ) ), "Density", 1.5, "SpecHeat", 0.35, "Thickness", 1,
											"Conductivity", (0.08333 / (CavityLayerSymVal[9]-99000)), "ConductivityQII", (0.08333 / (CavityLayerSymVal[9]-99000)), "ConductivityCT", 0.00175, "MarkForDeletion", UNDEFINED )
				else	UNDEFINED  endif endif endif endif endif endif  }
END

;*************************************************************************
RULELIST "SetupCons_GenericFramed"         0 0 0 1
;*************************************************************************

	"Setup Cavity path materials first"		Cons:Action	= {	EvalRulelist( "SetupCons_CavityMaterials", 1 )  }

   ; added logic to assign 'NoRadBarrier' to frame path materials (which differ from cavity path) - SAC 08/28/20 (tic #72)
	"Set Cons:FramePathMats[1]"		Cons:FramePathMats[1]	= {
				if (IfValidAnd( FrameLayerSymVal[1] = 100211 )) then  RuleLibrary( Mat, T24RMatLibrary:MatName( "LayerSymVal", 100211 ) )
				else if (LayerPropertyIndex[1] != FrameLayerMapIdx[1] .AND. LayerPropertyIndex[1] != FrameLayerMapIdx[2]) then  Local( CavityPathMats[1] )
				else if (Local( FrameLayerSymVal[1] ) < 1) then  UNDEFINED		; Error - frame layer not specified
				else if (Type == 1 .OR. Type == 12 .OR. Type == 23) then  RuleLibrary( Mat, "Steel", 1 )		; <any type of steel framing>
				else  RuleLibrary( Mat, "SoftWood" )		; <any type of wood framing>
				endif endif endif endif  }
	"Set Cons:FramePathMats[2]"		Cons:FramePathMats[2]	= {
				if (IfValidAnd( FrameLayerSymVal[2] = 100211 )) then  RuleLibrary( Mat, T24RMatLibrary:MatName( "LayerSymVal", 100211 ) )
				else if (LayerPropertyIndex[2] != FrameLayerMapIdx[1] .AND. LayerPropertyIndex[2] != FrameLayerMapIdx[2]) then  Local( CavityPathMats[2] )
				else if (Local( FrameLayerSymVal[2] ) < 1) then  UNDEFINED		; Error - frame layer not specified
				else if (Type == 1 .OR. Type == 12 .OR. Type == 23) then  RuleLibrary( Mat, "Steel", 1 )		; <any type of steel framing>
				else  RuleLibrary( Mat, "SoftWood" )		; <any type of wood framing>
				endif endif endif endif  }
	"Set Cons:FramePathMats[3]"		Cons:FramePathMats[3]	= {
				if (IfValidAnd( FrameLayerSymVal[3] = 100211 )) then  RuleLibrary( Mat, T24RMatLibrary:MatName( "LayerSymVal", 100211 ) )
				else if (LayerPropertyIndex[3] != FrameLayerMapIdx[1] .AND. LayerPropertyIndex[3] != FrameLayerMapIdx[2]) then  Local( CavityPathMats[3] )
				else if (Local( FrameLayerSymVal[3] ) < 1) then  UNDEFINED		; Error - frame layer not specified
				else if (Type == 1 .OR. Type == 12 .OR. Type == 23) then  RuleLibrary( Mat, "Steel", 1 )		; <any type of steel framing>
				else  RuleLibrary( Mat, "SoftWood" )		; <any type of wood framing>
				endif endif endif endif  }
	"Set Cons:FramePathMats[4]"		Cons:FramePathMats[4]	= {
				if (IfValidAnd( FrameLayerSymVal[4] = 100211 )) then  RuleLibrary( Mat, T24RMatLibrary:MatName( "LayerSymVal", 100211 ) )
				else if (LayerPropertyIndex[4] != FrameLayerMapIdx[1] .AND. LayerPropertyIndex[4] != FrameLayerMapIdx[2]) then  Local( CavityPathMats[4] )
				else if (Local( FrameLayerSymVal[4] ) < 1) then  UNDEFINED		; Error - frame layer not specified
				else if (Type == 1 .OR. Type == 12 .OR. Type == 23) then  RuleLibrary( Mat, "Steel", 1 )		; <any type of steel framing>
				else  RuleLibrary( Mat, "SoftWood" )		; <any type of wood framing>
				endif endif endif endif  }
	"Set Cons:FramePathMats[5]"		Cons:FramePathMats[5]	= {
				if (IfValidAnd( FrameLayerSymVal[5] = 100211 )) then  RuleLibrary( Mat, T24RMatLibrary:MatName( "LayerSymVal", 100211 ) )
				else if (LayerPropertyIndex[5] != FrameLayerMapIdx[1] .AND. LayerPropertyIndex[5] != FrameLayerMapIdx[2]) then  Local( CavityPathMats[5] )
				else if (Local( FrameLayerSymVal[5] ) < 1) then  UNDEFINED		; Error - frame layer not specified
				else if (Type == 1 .OR. Type == 12 .OR. Type == 23) then  RuleLibrary( Mat, "Steel", 1 )		; <any type of steel framing>
				else  RuleLibrary( Mat, "SoftWood" )		; <any type of wood framing>
				endif endif endif endif  }
	"Set Cons:FramePathMats[6]"		Cons:FramePathMats[6]	= {
				if (IfValidAnd( FrameLayerSymVal[6] = 100211 )) then  RuleLibrary( Mat, T24RMatLibrary:MatName( "LayerSymVal", 100211 ) )
				else if (LayerPropertyIndex[6] != FrameLayerMapIdx[1] .AND. LayerPropertyIndex[6] != FrameLayerMapIdx[2]) then  Local( CavityPathMats[6] )
				else if (Local( FrameLayerSymVal[6] ) < 1) then  UNDEFINED		; Error - frame layer not specified
				else if (Type == 1 .OR. Type == 12 .OR. Type == 23) then  RuleLibrary( Mat, "Steel", 1 )		; <any type of steel framing>
				else  RuleLibrary( Mat, "SoftWood" )		; <any type of wood framing>
				endif endif endif endif  }
	"Set Cons:FramePathMats[7]"		Cons:FramePathMats[7]	= {
				if (IfValidAnd( FrameLayerSymVal[7] = 100211 )) then  RuleLibrary( Mat, T24RMatLibrary:MatName( "LayerSymVal", 100211 ) )
				else if (LayerPropertyIndex[7] != FrameLayerMapIdx[1] .AND. LayerPropertyIndex[7] != FrameLayerMapIdx[2]) then  Local( CavityPathMats[7] )
				else if (Local( FrameLayerSymVal[7] ) < 1) then  UNDEFINED		; Error - frame layer not specified
				else if (Type == 1 .OR. Type == 12 .OR. Type == 23) then  RuleLibrary( Mat, "Steel", 1 )		; <any type of steel framing>
				else  RuleLibrary( Mat, "SoftWood" )		; <any type of wood framing>
				endif endif endif endif  }
	"Set Cons:FramePathMats[8]"		Cons:FramePathMats[8]	= {
				if (IfValidAnd( FrameLayerSymVal[8] = 100211 )) then  RuleLibrary( Mat, T24RMatLibrary:MatName( "LayerSymVal", 100211 ) )
				else if (LayerPropertyIndex[8] != FrameLayerMapIdx[1] .AND. LayerPropertyIndex[8] != FrameLayerMapIdx[2]) then  Local( CavityPathMats[8] )
				else if (Local( FrameLayerSymVal[8] ) < 1) then  UNDEFINED		; Error - frame layer not specified
				else if (Type == 1 .OR. Type == 12 .OR. Type == 23) then  RuleLibrary( Mat, "Steel", 1 )		; <any type of steel framing>
				else  RuleLibrary( Mat, "SoftWood" )		; <any type of wood framing>
				endif endif endif endif  }
	"Set Cons:FramePathMats[9]"		Cons:FramePathMats[9]	= {
				if (IfValidAnd( FrameLayerSymVal[9] = 100211 )) then  RuleLibrary( Mat, T24RMatLibrary:MatName( "LayerSymVal", 100211 ) )
				else if (LayerPropertyIndex[9] != FrameLayerMapIdx[1] .AND. LayerPropertyIndex[9] != FrameLayerMapIdx[2]) then  Local( CavityPathMats[9] )
				else if (Local( FrameLayerSymVal[9] ) < 1) then  UNDEFINED		; Error - frame layer not specified
				else if (Type == 1 .OR. Type == 12 .OR. Type == 23) then  RuleLibrary( Mat, "Steel", 1 )		; <any type of steel framing>
				else  RuleLibrary( Mat, "SoftWood" )		; <any type of wood framing>
				endif endif endif endif  }

; SAC 3/21/14 - Mark steel framed material reference for deletion, so that it isn't re-generated and manipulated each time through rules
	"Set Cons:FramePathMats[1]:MarkForDeletion (if Steel)"		Cons:FramePathMats[1]:MarkForDeletion	= {
				if ( (LayerPropertyIndex[1] == FrameLayerMapIdx[1] .OR. LayerPropertyIndex[1] == FrameLayerMapIdx[2]) .AND.
					  Local( FrameLayerSymVal[1] ) > 0 .AND. (Type == 1 .OR. Type == 12 .OR. Type == 23)) then  1	else  UNCHANGED  endif  }
	"Set Cons:FramePathMats[2]:MarkForDeletion (if Steel)"		Cons:FramePathMats[2]:MarkForDeletion	= {
				if ( (LayerPropertyIndex[2] == FrameLayerMapIdx[1] .OR. LayerPropertyIndex[2] == FrameLayerMapIdx[2]) .AND.
					  Local( FrameLayerSymVal[2] ) > 0 .AND. (Type == 1 .OR. Type == 12 .OR. Type == 23)) then  1	else  UNCHANGED  endif  }
	"Set Cons:FramePathMats[3]:MarkForDeletion (if Steel)"		Cons:FramePathMats[3]:MarkForDeletion	= {
				if ( (LayerPropertyIndex[3] == FrameLayerMapIdx[1] .OR. LayerPropertyIndex[3] == FrameLayerMapIdx[2]) .AND.
					  Local( FrameLayerSymVal[3] ) > 0 .AND. (Type == 1 .OR. Type == 12 .OR. Type == 23)) then  1	else  UNCHANGED  endif  }
	"Set Cons:FramePathMats[4]:MarkForDeletion (if Steel)"		Cons:FramePathMats[4]:MarkForDeletion	= {
				if ( (LayerPropertyIndex[4] == FrameLayerMapIdx[1] .OR. LayerPropertyIndex[4] == FrameLayerMapIdx[2]) .AND.
					  Local( FrameLayerSymVal[4] ) > 0 .AND. (Type == 1 .OR. Type == 12 .OR. Type == 23)) then  1	else  UNCHANGED  endif  }
	"Set Cons:FramePathMats[5]:MarkForDeletion (if Steel)"		Cons:FramePathMats[5]:MarkForDeletion	= {
				if ( (LayerPropertyIndex[5] == FrameLayerMapIdx[1] .OR. LayerPropertyIndex[5] == FrameLayerMapIdx[2]) .AND.
					  Local( FrameLayerSymVal[5] ) > 0 .AND. (Type == 1 .OR. Type == 12 .OR. Type == 23)) then  1	else  UNCHANGED  endif  }
	"Set Cons:FramePathMats[6]:MarkForDeletion (if Steel)"		Cons:FramePathMats[6]:MarkForDeletion	= {
				if ( (LayerPropertyIndex[6] == FrameLayerMapIdx[1] .OR. LayerPropertyIndex[6] == FrameLayerMapIdx[2]) .AND.
					  Local( FrameLayerSymVal[6] ) > 0 .AND. (Type == 1 .OR. Type == 12 .OR. Type == 23)) then  1	else  UNCHANGED  endif  }
	"Set Cons:FramePathMats[7]:MarkForDeletion (if Steel)"		Cons:FramePathMats[7]:MarkForDeletion	= {
				if ( (LayerPropertyIndex[7] == FrameLayerMapIdx[1] .OR. LayerPropertyIndex[7] == FrameLayerMapIdx[2]) .AND.
					  Local( FrameLayerSymVal[7] ) > 0 .AND. (Type == 1 .OR. Type == 12 .OR. Type == 23)) then  1	else  UNCHANGED  endif  }
	"Set Cons:FramePathMats[8]:MarkForDeletion (if Steel)"		Cons:FramePathMats[8]:MarkForDeletion	= {
				if ( (LayerPropertyIndex[8] == FrameLayerMapIdx[1] .OR. LayerPropertyIndex[8] == FrameLayerMapIdx[2]) .AND.
					  Local( FrameLayerSymVal[8] ) > 0 .AND. (Type == 1 .OR. Type == 12 .OR. Type == 23)) then  1	else  UNCHANGED  endif  }
	"Set Cons:FramePathMats[9]:MarkForDeletion (if Steel)"		Cons:FramePathMats[9]:MarkForDeletion	= {
				if ( (LayerPropertyIndex[9] == FrameLayerMapIdx[1] .OR. LayerPropertyIndex[9] == FrameLayerMapIdx[2]) .AND.
					  Local( FrameLayerSymVal[9] ) > 0 .AND. (Type == 1 .OR. Type == 12 .OR. Type == 23)) then  1	else  UNCHANGED  endif  }

   ; SAC 11/29/17 - mod to max out steel frame thickness @ 2x6 (tic #929)
    "Set Thickness[1] in Cons"		Cons:Thickness[1]		= {
				if (IfValidAnd( AbvJoistInsLyrMapIdx > 0 ) .AND. LayerPropertyIndex[1] == AbvJoistInsLyrMapIdx .AND. IfValidAnd( AbvJoistInsulThick > 0 ))
				then	AbvJoistInsulThick
				else if (IfValidAnd( BlwJoistInsLyrMapIdx > 0 ) .AND. LayerPropertyIndex[1] == BlwJoistInsLyrMapIdx .AND. IfValidAnd( BlwJoistInsulThick > 0 ))
				then	BlwJoistInsulThick
				else if (Local( LayerPropertyIndex[1] ) == Local( FrameLayerMapIdx[1] ) .AND. AtcEdg_ConsType > 0 .AND. Local( FrameLayerMapIdx[1] ) > 0)
				then	switch (AtcEdg_ConsType)
							case  1 :	12 * AtcEdg_ClgBlwAtc:AtcEdg_HA		; WA
							case  2 :	12 * AtcEdg_ClgBlwAtc:AtcEdg_HB3		; WB
							default :	3.5		; ERROR !!
						endswitch
				else if (Local( LayerPropertyIndex[1] ) == Local( FrameLayerMapIdx[2] ) .AND. AtcEdg_ConsType == 2 .AND. Local( FrameLayerMapIdx[2] ) > 0)
				then	12 * AtcEdg_ClgBlwAtc:AtcEdg_HB1							; WB
	 			else if (LocalCompAssigned( CavityPathMats[1] ) .AND. LocalCompAssigned( FramePathMats[1] ))
				then	if (LocalStatus( CavityPathMats[1]:Thickness ) > 0 .AND. LocalStatus( FramePathMats[1]:Thickness ) > 0)
						then	max( LocalRef( CavityPathMats[1]:Thickness ), LocalRef( FramePathMats[1]:Thickness ) )
						else if (LocalStatus( FramePathMats[1]:Thickness  ) > 0) then  LocalRef( FramePathMats[1]:Thickness  )
						else if ((Local( LayerPropertyIndex[1] ) == Local( FrameLayerMapIdx[1] ) .OR. 
									(Local( LayerPropertyIndex[1] ) == Local( FrameLayerMapIdx[2] ) .AND. Local( FrameLayerMapIdx[2] ) > 0)) .AND. Local( FrameLayer ) > 0)
						then  if ( (Type == 1 .OR. Type == 12 .OR. Type == 23) .AND. FrameLayer > 699 ) then  5.5    ; max out Steel Cons thickness @ 2x6
                        else  switch (mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 ))
   									case  4 :  3.5
	   								case  6 :  5.5
		   							case  8 :  7.25
			   						case 10 :  9.25
				   					case 12 : 11.25
					   				default :	; ERROR??? - unrecognized framing depth
						   							(mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 )) - 0.75
							   	endswitch  endif
						else if (LocalStatus( CavityPathMats[1]:Thickness ) > 0) then  LocalRef( CavityPathMats[1]:Thickness )
						else if ((CanAssignTo == 4 .OR. CanAssignTo == 5 .OR. CanAssignTo == 9 .OR. CanAssignTo == 6) .AND. CavityLayerSymVal[1] == 100107) then  1.5		; SAC 4/7/13 - 1.5" Concrete Fill in exterior floors (GC Issue #62)  - SAC 3/18/14 - extended to incl. int & crwlspc flrs
						else  0		; ERROR - no valid material thickness available
						endif endif endif endif endif
				else if ((Local( LayerPropertyIndex[1] ) == Local( FrameLayerMapIdx[1] ) .OR. 
							(Local( LayerPropertyIndex[1] ) == Local( FrameLayerMapIdx[2] ) .AND. Local( FrameLayerMapIdx[2] ) > 0)) .AND. Local( FrameLayer ) > 0)
				then  if ( (Type == 1 .OR. Type == 12 .OR. Type == 23) .AND. FrameLayer > 699 ) then  5.5    ; max out Steel Cons thickness @ 2x6
                  else  switch (mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 ))
   							case  4 :  3.5
	   						case  6 :  5.5
		   					case  8 :  7.25
			   				case 10 :  9.25
				   			case 12 : 11.25
					   		default :	; ERROR??? - unrecognized framing depth
						   					(mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 )) - 0.75
						   endswitch  endif
				else  0		; ERROR - one or the other path material assignments missing
				endif endif endif endif endif endif  }
; DEBUGGING
;	"store BEMProc details"		Cons:Action = {	if (Name != "Construction Assembly 2") then  UNCHANGED
;																else	StoreBEMProc( Format( "b4 Cons_Thickness2 rule %s", Name ), 0 )  endif  }
;	"Post messagebox"				Cons:Action = {	if (Name != "Construction Assembly 2") then  UNCHANGED
;																else	MessageBox( Format( "Cons Assm 2:\n   CompAssigned( CavityPathMats[2] ) = %g\n   CompAssigned( FramePathMats[2] ) = %g\n   Status( CavityPathMats[2]:Thickness ) = %g\n   Status( FramePathMats[2]:Thickness ) = %g",
;																							LocalCompAssigned( CavityPathMats[2] ), LocalCompAssigned( FramePathMats[2] ), LocalStatus( CavityPathMats[2]:Thickness ), LocalStatus( FramePathMats[2]:Thickness ) ) )  endif  }
;"log Cons data"	Cons:Action	= {	PostMessageToLog( "Setting Cons:Thickness[2] for '%s' CavityPathMats[2]:Thickness = %g / FramePathMats[2]:Thickness = %g", Name, ValidOr( CavityPathMats[2]:Thickness, -1 ),
;																				ValidOr( FramePathMats[2]:Thickness, -1 ) )  }
; DEBUGGING
    "Set Thickness[2] in Cons"		Cons:Thickness[2]		= {
				if (IfValidAnd( AbvJoistInsLyrMapIdx > 0 ) .AND. LayerPropertyIndex[2] == AbvJoistInsLyrMapIdx .AND. IfValidAnd( AbvJoistInsulThick > 0 ))
				then	AbvJoistInsulThick
				else if (IfValidAnd( BlwJoistInsLyrMapIdx > 0 ) .AND. LayerPropertyIndex[2] == BlwJoistInsLyrMapIdx .AND. IfValidAnd( BlwJoistInsulThick > 0 ))
				then	BlwJoistInsulThick
				else if (Local( LayerPropertyIndex[2] ) == Local( FrameLayerMapIdx[1] ) .AND. AtcEdg_ConsType > 0 .AND. Local( FrameLayerMapIdx[1] ) > 0)
				then	switch (AtcEdg_ConsType)
							case  1 :	12 * AtcEdg_ClgBlwAtc:AtcEdg_HA		; WA
							case  2 :	12 * AtcEdg_ClgBlwAtc:AtcEdg_HB3		; WB
							default :	3.5		; ERROR !!
						endswitch
				else if (Local( LayerPropertyIndex[2] ) == Local( FrameLayerMapIdx[2] ) .AND. AtcEdg_ConsType == 2 .AND. Local( FrameLayerMapIdx[2] ) > 0)
				then	12 * AtcEdg_ClgBlwAtc:AtcEdg_HB1							; WB
	 			else if (LocalCompAssigned( CavityPathMats[2] ) .AND. LocalCompAssigned( FramePathMats[2] ))
				then	if (LocalStatus( CavityPathMats[2]:Thickness ) > 0 .AND. LocalStatus( FramePathMats[2]:Thickness ) > 0)
						then	max( LocalRef( CavityPathMats[2]:Thickness ), LocalRef( FramePathMats[2]:Thickness ) )
						else if (LocalStatus( FramePathMats[2]:Thickness  ) > 0) then  LocalRef( FramePathMats[2]:Thickness  )
						else if ((Local( LayerPropertyIndex[2] ) == Local( FrameLayerMapIdx[1] ) .OR. 
									(Local( LayerPropertyIndex[2] ) == Local( FrameLayerMapIdx[2] ) .AND. Local( FrameLayerMapIdx[2] ) > 0)) .AND. Local( FrameLayer ) > 0)
						then	if (IfValidAnd( FrameLayerSymVal[2] >= 70000 ) .AND. IfValidAnd( FrameLayerSymVal[2] < 99999 ))
								then	switch (mod( FrameLayerSymVal[2], 10000 ))
											case  450 :	 3.5 
											case  650 :	 5.5 
											case  825 :	 7.25
											case 1025 :	 9.25
											case 1225 :	11.25
											default   :	 0		; ERROR !!
										endswitch
								else if ( (Type == 1 .OR. Type == 12 .OR. Type == 23) .AND. FrameLayer > 699 ) then  5.5    ; max out Steel Cons thickness @ 2x6
                        else  switch (mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 ))
   										case  4 :  3.5
	   									case  6 :  5.5
		   								case  8 :  7.25
			   							case 10 :  9.25
				   						case 12 : 11.25
					   					default :	; ERROR??? - unrecognized framing depth
						   								(mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 )) - 0.75
							   		endswitch  endif endif
						else if (LocalStatus( CavityPathMats[2]:Thickness ) > 0) then  LocalRef( CavityPathMats[2]:Thickness )
						else if ((CanAssignTo == 4 .OR. CanAssignTo == 5 .OR. CanAssignTo == 9 .OR. CanAssignTo == 6) .AND. CavityLayerSymVal[2] == 100107) then  1.5		; SAC 4/7/13 - 1.5" Concrete Fill in exterior floors (GC Issue #62)  - SAC 3/18/14 - extended to incl. int & crwlspc flrs
						else  0		; ERROR - no valid material thickness available
						endif endif endif endif endif
				else if ((Local( LayerPropertyIndex[2] ) == Local( FrameLayerMapIdx[1] ) .OR. 
							(Local( LayerPropertyIndex[2] ) == Local( FrameLayerMapIdx[2] ) .AND. Local( FrameLayerMapIdx[2] ) > 0)) .AND. Local( FrameLayer ) > 0)
				then	if ( (Type == 1 .OR. Type == 12 .OR. Type == 23) .AND. FrameLayer > 699 ) then  5.5    ; max out Steel Cons thickness @ 2x6
                  else  switch (mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 ))
      							case  4 :  3.5
		      					case  6 :  5.5
				      			case  8 :  7.25
						      	case 10 :  9.25
      							case 12 : 11.25
		      					default :	; ERROR??? - unrecognized framing depth
				      							(mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 )) - 0.75
						      endswitch  endif
				else  0		; ERROR - one or the other path material assignments missing (iff this is a valid layer)
				endif endif endif endif endif endif  }
;"store BEMProc details"		Cons:Action = {	if (Name != "R15 R4 Stucco Wall") then  UNCHANGED
;															else	StoreBEMProc( "Befr Thickness[3] set", 0 )  endif  }
    "Set Thickness[3] in Cons"		Cons:Thickness[3]		= {
				if (IfValidAnd( AbvJoistInsLyrMapIdx > 0 ) .AND. LayerPropertyIndex[3] == AbvJoistInsLyrMapIdx .AND. IfValidAnd( AbvJoistInsulThick > 0 ))
				then	AbvJoistInsulThick
				else if (IfValidAnd( BlwJoistInsLyrMapIdx > 0 ) .AND. LayerPropertyIndex[3] == BlwJoistInsLyrMapIdx .AND. IfValidAnd( BlwJoistInsulThick > 0 ))
				then	BlwJoistInsulThick
				else if (Local( LayerPropertyIndex[3] ) == Local( FrameLayerMapIdx[1] ) .AND. AtcEdg_ConsType > 0 .AND. Local( FrameLayerMapIdx[1] ) > 0)
				then	switch (AtcEdg_ConsType)
							case  1 :	12 * AtcEdg_ClgBlwAtc:AtcEdg_HA		; WA
							case  2 :	12 * AtcEdg_ClgBlwAtc:AtcEdg_HB3		; WB
							default :	3.5		; ERROR !!
						endswitch
				else if (Local( LayerPropertyIndex[3] ) == Local( FrameLayerMapIdx[2] ) .AND. AtcEdg_ConsType == 2 .AND. Local( FrameLayerMapIdx[2] ) > 0)
				then	12 * AtcEdg_ClgBlwAtc:AtcEdg_HB1							; WB
	 			else if (LocalCompAssigned( CavityPathMats[3] ) .AND. LocalCompAssigned( FramePathMats[3] ))
				then	if (LocalStatus( CavityPathMats[3]:Thickness ) > 0 .AND. LocalStatus( FramePathMats[3]:Thickness ) > 0)
						then	max( LocalRef( CavityPathMats[3]:Thickness ), LocalRef( FramePathMats[3]:Thickness ) )
						else if (LocalStatus( FramePathMats[3]:Thickness  ) > 0) then  LocalRef( FramePathMats[3]:Thickness  )
						else if ((Local( LayerPropertyIndex[3] ) == Local( FrameLayerMapIdx[1] ) .OR. 
									(Local( LayerPropertyIndex[3] ) == Local( FrameLayerMapIdx[2] ) .AND. Local( FrameLayerMapIdx[2] ) > 0)) .AND. Local( FrameLayer ) > 0)
			;			then	if (IfValidAnd( FrameLayerSymVal[3] >= 70000 ) .AND. IfValidAnd( FrameLayerSymVal[3] < 99999 ) .AND. IfValidAnd( Proj:LibMat_SIPSskin:Thickness > 0 ))
			;					then	(mod( FrameLayerSymVal[3], 10000 ) / 100) - (2 * Proj:LibMat_SIPSskin:Thickness)
						then	if (IfValidAnd( FrameLayerSymVal[3] >= 70000 ) .AND. IfValidAnd( FrameLayerSymVal[3] < 99999 ))
								then	switch (mod( FrameLayerSymVal[3], 10000 ))
											case  450 :	 3.5 
											case  650 :	 5.5 
											case  825 :	 7.25
											case 1025 :	 9.25
											case 1225 :	11.25
											default   :	 0		; ERROR !!
										endswitch
								else if ( (Type == 1 .OR. Type == 12 .OR. Type == 23) .AND. FrameLayer > 699 ) then  5.5    ; max out Steel Cons thickness @ 2x6
								else	switch (mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 ))
											case  4 :  3.5
											case  6 :  5.5
											case  8 :  7.25
											case 10 :  9.25
											case 12 : 11.25
											default :	; ERROR??? - unrecognized framing depth
															(mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 )) - 0.75
										endswitch  endif endif
						else if (LocalStatus( CavityPathMats[3]:Thickness ) > 0) then  LocalRef( CavityPathMats[3]:Thickness )
						else if ((CanAssignTo == 4 .OR. CanAssignTo == 5 .OR. CanAssignTo == 9 .OR. CanAssignTo == 6) .AND. CavityLayerSymVal[3] == 100107) then  1.5		; SAC 4/7/13 - 1.5" Concrete Fill in exterior floors (GC Issue #62)  - SAC 3/18/14 - extended to incl. int & crwlspc flrs
						else  0		; ERROR - no valid material thickness available
						endif endif endif endif endif
				else if ((Local( LayerPropertyIndex[3] ) == Local( FrameLayerMapIdx[1] ) .OR. 
							(Local( LayerPropertyIndex[3] ) == Local( FrameLayerMapIdx[2] ) .AND. Local( FrameLayerMapIdx[2] ) > 0)) .AND. Local( FrameLayer ) > 0)
				then	if ( (Type == 1 .OR. Type == 12 .OR. Type == 23) .AND. FrameLayer > 699 ) then  5.5    ; max out Steel Cons thickness @ 2x6
                  else  switch (mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 ))
      							case  4 :  3.5
		      					case  6 :  5.5
				      			case  8 :  7.25
						      	case 10 :  9.25
      							case 12 : 11.25
		      					default :	; ERROR??? - unrecognized framing depth
				      							(mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 )) - 0.75
						      endswitch  endif
				else  0		; ERROR - one or the other path material assignments missing (iff this is a valid layer)
				endif endif endif endif endif endif  }
; SAC 3/16/14 - to be REMOVED
;"Log certain CavityPathMats selection"		Cons:Action = {  if (Name != "R15 R4 Stucco Wall") then  UNCHANGED
;			else if (LocalStatus( Thickness[3] ) > 0) then	PostMessageToLog( "Rule line: 22971 - Cons 'R15 R4 Stucco Wall' Thickness[3] = %g", Thickness[3] )
;			else  PostMessageToLog( "Rule line: 22971 - Cons 'R15 R4 Stucco Wall' Thickness[3]    UNDEFINED" )  endif endif  }
; SAC 3/6/14 - to be REMOVED
;"store BEMProc details"		Cons:Action = {  if (Name != "R15 R4 Stucco Wall") then  UNCHANGED
;															else	StoreBEMProc( "Aftr Thickness[3] set", 0 )  endif  }
;"debug"		Cons:Action	= {	if (Name != "R15 R4 Stucco Wall") then  UNCHANGED
;										else	MessageBox( "Post-ConsUFactorRes input details stored" )  endif  }
    "Set Thickness[4] in Cons"		Cons:Thickness[4]		= {
				if (IfValidAnd( AbvJoistInsLyrMapIdx > 0 ) .AND. LayerPropertyIndex[4] == AbvJoistInsLyrMapIdx .AND. IfValidAnd( AbvJoistInsulThick > 0 ))
				then	AbvJoistInsulThick
				else if (IfValidAnd( BlwJoistInsLyrMapIdx > 0 ) .AND. LayerPropertyIndex[4] == BlwJoistInsLyrMapIdx .AND. IfValidAnd( BlwJoistInsulThick > 0 ))
				then	BlwJoistInsulThick
				else if (Local( LayerPropertyIndex[4] ) == Local( FrameLayerMapIdx[1] ) .AND. AtcEdg_ConsType > 0 .AND. Local( FrameLayerMapIdx[1] ) > 0)
				then	switch (AtcEdg_ConsType)
							case  1 :	12 * AtcEdg_ClgBlwAtc:AtcEdg_HA		; WA
							case  2 :	12 * AtcEdg_ClgBlwAtc:AtcEdg_HB3		; WB
							default :	3.5		; ERROR !!
						endswitch
				else if (Local( LayerPropertyIndex[4] ) == Local( FrameLayerMapIdx[2] ) .AND. AtcEdg_ConsType == 2 .AND. Local( FrameLayerMapIdx[2] ) > 0)
				then	12 * AtcEdg_ClgBlwAtc:AtcEdg_HB1							; WB
	 			else if (LocalCompAssigned( CavityPathMats[4] ) .AND. LocalCompAssigned( FramePathMats[4] ))
				then	if (LocalStatus( CavityPathMats[4]:Thickness ) > 0 .AND. LocalStatus( FramePathMats[4]:Thickness ) > 0)
						then	max( LocalRef( CavityPathMats[4]:Thickness ), LocalRef( FramePathMats[4]:Thickness ) )
						else if (LocalStatus( FramePathMats[4]:Thickness  ) > 0) then  LocalRef( FramePathMats[4]:Thickness  )
						else if ((Local( LayerPropertyIndex[4] ) == Local( FrameLayerMapIdx[1] ) .OR. 
									(Local( LayerPropertyIndex[4] ) == Local( FrameLayerMapIdx[2] ) .AND. Local( FrameLayerMapIdx[2] ) > 0)) .AND. Local( FrameLayer ) > 0)
						then	if (IfValidAnd( FrameLayerSymVal[4] >= 70000 ) .AND. IfValidAnd( FrameLayerSymVal[4] < 99999 ))
								then	switch (mod( FrameLayerSymVal[4], 10000 ))
											case  450 :	 3.5 
											case  650 :	 5.5 
											case  825 :	 7.25
											case 1025 :	 9.25
											case 1225 :	11.25
											default   :	 0		; ERROR !!
										endswitch
								else if ( (Type == 1 .OR. Type == 12 .OR. Type == 23) .AND. FrameLayer > 699 ) then  5.5    ; max out Steel Cons thickness @ 2x6
								else	switch (mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 ))
											case  4 :  3.5
											case  6 :  5.5
											case  8 :  7.25
											case 10 :  9.25
											case 12 : 11.25
											default :	; ERROR??? - unrecognized framing depth
															(mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 )) - 0.75
										endswitch  endif endif
						else if (LocalStatus( CavityPathMats[4]:Thickness ) > 0) then  LocalRef( CavityPathMats[4]:Thickness )
						else if ((CanAssignTo == 4 .OR. CanAssignTo == 5 .OR. CanAssignTo == 9 .OR. CanAssignTo == 6) .AND. CavityLayerSymVal[4] == 100107) then  1.5		; SAC 4/7/13 - 1.5" Concrete Fill in exterior floors (GC Issue #62)  - SAC 3/18/14 - extended to incl. int & crwlspc flrs
						else  0		; ERROR - no valid material thickness available
						endif endif endif endif endif
				else if ((Local( LayerPropertyIndex[4] ) == Local( FrameLayerMapIdx[1] ) .OR. 
							(Local( LayerPropertyIndex[4] ) == Local( FrameLayerMapIdx[2] ) .AND. Local( FrameLayerMapIdx[2] ) > 0)) .AND. Local( FrameLayer ) > 0)
				then	if ( (Type == 1 .OR. Type == 12 .OR. Type == 23) .AND. FrameLayer > 699 ) then  5.5    ; max out Steel Cons thickness @ 2x6
                  else  switch (mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 ))
      							case  4 :  3.5
		      					case  6 :  5.5
				      			case  8 :  7.25
						      	case 10 :  9.25
      							case 12 : 11.25
		      					default :	; ERROR??? - unrecognized framing depth
				      							(mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 )) - 0.75
						      endswitch  endif
				else  0		; ERROR - one or the other path material assignments missing (iff this is a valid layer)
				endif endif endif endif endif endif  }
    "Set Thickness[5] in Cons"		Cons:Thickness[5]		= {
				if (IfValidAnd( AbvJoistInsLyrMapIdx > 0 ) .AND. LayerPropertyIndex[5] == AbvJoistInsLyrMapIdx .AND. IfValidAnd( AbvJoistInsulThick > 0 ))
				then	AbvJoistInsulThick
				else if (IfValidAnd( BlwJoistInsLyrMapIdx > 0 ) .AND. LayerPropertyIndex[5] == BlwJoistInsLyrMapIdx .AND. IfValidAnd( BlwJoistInsulThick > 0 ))
				then	BlwJoistInsulThick
				else if (Local( LayerPropertyIndex[5] ) == Local( FrameLayerMapIdx[1] ) .AND. AtcEdg_ConsType > 0 .AND. Local( FrameLayerMapIdx[1] ) > 0)
				then	switch (AtcEdg_ConsType)
							case  1 :	12 * AtcEdg_ClgBlwAtc:AtcEdg_HA		; WA
							case  2 :	12 * AtcEdg_ClgBlwAtc:AtcEdg_HB3		; WB
							default :	3.5		; ERROR !!
						endswitch
				else if (Local( LayerPropertyIndex[5] ) == Local( FrameLayerMapIdx[2] ) .AND. AtcEdg_ConsType == 2 .AND. Local( FrameLayerMapIdx[2] ) > 0)
				then	12 * AtcEdg_ClgBlwAtc:AtcEdg_HB1							; WB
	 			else if (LocalCompAssigned( CavityPathMats[5] ) .AND. LocalCompAssigned( FramePathMats[5] ))
				then	if (LocalStatus( CavityPathMats[5]:Thickness ) > 0 .AND. LocalStatus( FramePathMats[5]:Thickness ) > 0)
						then	max( LocalRef( CavityPathMats[5]:Thickness ), LocalRef( FramePathMats[5]:Thickness ) )
						else if (LocalStatus( FramePathMats[5]:Thickness  ) > 0) then  LocalRef( FramePathMats[5]:Thickness  )
						else if ((Local( LayerPropertyIndex[5] ) == Local( FrameLayerMapIdx[1] ) .OR. 
									(Local( LayerPropertyIndex[5] ) == Local( FrameLayerMapIdx[2] ) .AND. Local( FrameLayerMapIdx[2] ) > 0)) .AND. Local( FrameLayer ) > 0)
						then	if (IfValidAnd( FrameLayerSymVal[5] >= 70000 ) .AND. IfValidAnd( FrameLayerSymVal[5] < 99999 ))
								then	switch (mod( FrameLayerSymVal[5], 10000 ))
											case  450 :	 3.5 
											case  650 :	 5.5 
											case  825 :	 7.25
											case 1025 :	 9.25
											case 1225 :	11.25
											default   :	 0		; ERROR !!
										endswitch
								else if ( (Type == 1 .OR. Type == 12 .OR. Type == 23) .AND. FrameLayer > 699 ) then  5.5    ; max out Steel Cons thickness @ 2x6
								else	switch (mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 ))
											case  4 :  3.5
											case  6 :  5.5
											case  8 :  7.25
											case 10 :  9.25
											case 12 : 11.25
											default :	; ERROR??? - unrecognized framing depth
															(mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 )) - 0.75
										endswitch  endif endif
						else if (LocalStatus( CavityPathMats[5]:Thickness ) > 0) then  LocalRef( CavityPathMats[5]:Thickness )
						else if ((CanAssignTo == 4 .OR. CanAssignTo == 5 .OR. CanAssignTo == 9 .OR. CanAssignTo == 6) .AND. CavityLayerSymVal[5] == 100107) then  1.5		; SAC 4/7/13 - 1.5" Concrete Fill in exterior floors (GC Issue #62)  - SAC 3/18/14 - extended to incl. int & crwlspc flrs
						else  0		; ERROR - no valid material thickness available
						endif endif endif endif endif
				else if ((Local( LayerPropertyIndex[5] ) == Local( FrameLayerMapIdx[1] ) .OR. 
							(Local( LayerPropertyIndex[5] ) == Local( FrameLayerMapIdx[2] ) .AND. Local( FrameLayerMapIdx[2] ) > 0)) .AND. Local( FrameLayer ) > 0)
				then	if ( (Type == 1 .OR. Type == 12 .OR. Type == 23) .AND. FrameLayer > 699 ) then  5.5    ; max out Steel Cons thickness @ 2x6
                  else  switch (mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 ))
      							case  4 :  3.5
		      					case  6 :  5.5
				      			case  8 :  7.25
						      	case 10 :  9.25
      							case 12 : 11.25
		      					default :	; ERROR??? - unrecognized framing depth
				      							(mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 )) - 0.75
						      endswitch  endif
				else  0		; ERROR - one or the other path material assignments missing (iff this is a valid layer)
				endif endif endif endif endif endif  }
    "Set Thickness[6] in Cons"		Cons:Thickness[6]		= {
				if (IfValidAnd( AbvJoistInsLyrMapIdx > 0 ) .AND. LayerPropertyIndex[6] == AbvJoistInsLyrMapIdx .AND. IfValidAnd( AbvJoistInsulThick > 0 ))
				then	AbvJoistInsulThick
				else if (IfValidAnd( BlwJoistInsLyrMapIdx > 0 ) .AND. LayerPropertyIndex[6] == BlwJoistInsLyrMapIdx .AND. IfValidAnd( BlwJoistInsulThick > 0 ))
				then	BlwJoistInsulThick
				else if (Local( LayerPropertyIndex[6] ) == Local( FrameLayerMapIdx[1] ) .AND. AtcEdg_ConsType > 0 .AND. Local( FrameLayerMapIdx[1] ) > 0)
				then	switch (AtcEdg_ConsType)
							case  1 :	12 * AtcEdg_ClgBlwAtc:AtcEdg_HA		; WA
							case  2 :	12 * AtcEdg_ClgBlwAtc:AtcEdg_HB3		; WB
							default :	3.5		; ERROR !!
						endswitch
				else if (Local( LayerPropertyIndex[6] ) == Local( FrameLayerMapIdx[2] ) .AND. AtcEdg_ConsType == 2 .AND. Local( FrameLayerMapIdx[2] ) > 0)
				then	12 * AtcEdg_ClgBlwAtc:AtcEdg_HB1							; WB
	 			else if (LocalCompAssigned( CavityPathMats[6] ) .AND. LocalCompAssigned( FramePathMats[6] ))
				then	if (LocalStatus( CavityPathMats[6]:Thickness ) > 0 .AND. LocalStatus( FramePathMats[6]:Thickness ) > 0)
						then	max( LocalRef( CavityPathMats[6]:Thickness ), LocalRef( FramePathMats[6]:Thickness ) )
						else if (LocalStatus( FramePathMats[6]:Thickness  ) > 0) then  LocalRef( FramePathMats[6]:Thickness  )
						else if ((Local( LayerPropertyIndex[6] ) == Local( FrameLayerMapIdx[1] ) .OR. 
									(Local( LayerPropertyIndex[6] ) == Local( FrameLayerMapIdx[2] ) .AND. Local( FrameLayerMapIdx[2] ) > 0)) .AND. Local( FrameLayer ) > 0)
						then	if (IfValidAnd( FrameLayerSymVal[6] >= 70000 ) .AND. IfValidAnd( FrameLayerSymVal[6] < 99999 ))
								then	switch (mod( FrameLayerSymVal[6], 10000 ))
											case  450 :	 3.5 
											case  650 :	 5.5 
											case  825 :	 7.25
											case 1025 :	 9.25
											case 1225 :	11.25
											default   :	 0		; ERROR !!
										endswitch
								else if ( (Type == 1 .OR. Type == 12 .OR. Type == 23) .AND. FrameLayer > 699 ) then  5.5    ; max out Steel Cons thickness @ 2x6
								else	switch (mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 ))
											case  4 :  3.5
											case  6 :  5.5
											case  8 :  7.25
											case 10 :  9.25
											case 12 : 11.25
											default :	; ERROR??? - unrecognized framing depth
															(mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 )) - 0.75
										endswitch  endif endif
						else if (LocalStatus( CavityPathMats[6]:Thickness ) > 0) then  LocalRef( CavityPathMats[6]:Thickness )
						else if ((CanAssignTo == 4 .OR. CanAssignTo == 5 .OR. CanAssignTo == 9 .OR. CanAssignTo == 6) .AND. CavityLayerSymVal[6] == 100107) then  1.5		; SAC 4/7/13 - 1.5" Concrete Fill in exterior floors (GC Issue #62)  - SAC 3/18/14 - extended to incl. int & crwlspc flrs
						else  0		; ERROR - no valid material thickness available
						endif endif endif endif endif
				else if ((Local( LayerPropertyIndex[6] ) == Local( FrameLayerMapIdx[1] ) .OR. 
							(Local( LayerPropertyIndex[6] ) == Local( FrameLayerMapIdx[2] ) .AND. Local( FrameLayerMapIdx[2] ) > 0)) .AND. Local( FrameLayer ) > 0)
				then	if ( (Type == 1 .OR. Type == 12 .OR. Type == 23) .AND. FrameLayer > 699 ) then  5.5    ; max out Steel Cons thickness @ 2x6
                  else  switch (mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 ))
      							case  4 :  3.5
		      					case  6 :  5.5
				      			case  8 :  7.25
						      	case 10 :  9.25
      							case 12 : 11.25
		      					default :	; ERROR??? - unrecognized framing depth
				      							(mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 )) - 0.75
						      endswitch  endif
				else  0		; ERROR - one or the other path material assignments missing (iff this is a valid layer)
				endif endif endif endif endif endif  }
    "Set Thickness[7] in Cons"		Cons:Thickness[7]		= {
				if (IfValidAnd( AbvJoistInsLyrMapIdx > 0 ) .AND. LayerPropertyIndex[7] == AbvJoistInsLyrMapIdx .AND. IfValidAnd( AbvJoistInsulThick > 0 ))
				then	AbvJoistInsulThick
				else if (IfValidAnd( BlwJoistInsLyrMapIdx > 0 ) .AND. LayerPropertyIndex[7] == BlwJoistInsLyrMapIdx .AND. IfValidAnd( BlwJoistInsulThick > 0 ))
				then	BlwJoistInsulThick
				else if (Local( LayerPropertyIndex[7] ) == Local( FrameLayerMapIdx[1] ) .AND. AtcEdg_ConsType > 0 .AND. Local( FrameLayerMapIdx[1] ) > 0)
				then	switch (AtcEdg_ConsType)
							case  1 :	12 * AtcEdg_ClgBlwAtc:AtcEdg_HA		; WA
							case  2 :	12 * AtcEdg_ClgBlwAtc:AtcEdg_HB3		; WB
							default :	3.5		; ERROR !!
						endswitch
				else if (Local( LayerPropertyIndex[7] ) == Local( FrameLayerMapIdx[2] ) .AND. AtcEdg_ConsType == 2 .AND. Local( FrameLayerMapIdx[2] ) > 0)
				then	12 * AtcEdg_ClgBlwAtc:AtcEdg_HB1							; WB
	 			else if (LocalCompAssigned( CavityPathMats[7] ) .AND. LocalCompAssigned( FramePathMats[7] ))
				then	if (LocalStatus( CavityPathMats[7]:Thickness ) > 0 .AND. LocalStatus( FramePathMats[7]:Thickness ) > 0)
						then	max( LocalRef( CavityPathMats[7]:Thickness ), LocalRef( FramePathMats[7]:Thickness ) )
						else if (LocalStatus( FramePathMats[7]:Thickness  ) > 0) then  LocalRef( FramePathMats[7]:Thickness  )
						else if ((Local( LayerPropertyIndex[7] ) == Local( FrameLayerMapIdx[1] ) .OR. 
									(Local( LayerPropertyIndex[7] ) == Local( FrameLayerMapIdx[2] ) .AND. Local( FrameLayerMapIdx[2] ) > 0)) .AND. Local( FrameLayer ) > 0)
						then	if (IfValidAnd( FrameLayerSymVal[7] >= 70000 ) .AND. IfValidAnd( FrameLayerSymVal[7] < 99999 ))
								then	switch (mod( FrameLayerSymVal[7], 10000 ))
											case  450 :	 3.5 
											case  650 :	 5.5 
											case  825 :	 7.25
											case 1025 :	 9.25
											case 1225 :	11.25
											default   :	 0		; ERROR !!
										endswitch
								else if ( (Type == 1 .OR. Type == 12 .OR. Type == 23) .AND. FrameLayer > 699 ) then  5.5    ; max out Steel Cons thickness @ 2x6
								else	switch (mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 ))
											case  4 :  3.5
											case  6 :  5.5
											case  8 :  7.25
											case 10 :  9.25
											case 12 : 11.25
											default :	; ERROR??? - unrecognized framing depth
															(mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 )) - 0.75
										endswitch  endif endif
						else if (LocalStatus( CavityPathMats[7]:Thickness ) > 0) then  LocalRef( CavityPathMats[7]:Thickness )
						else if ((CanAssignTo == 4 .OR. CanAssignTo == 5 .OR. CanAssignTo == 9 .OR. CanAssignTo == 6) .AND. CavityLayerSymVal[7] == 100107) then  1.5		; SAC 4/7/13 - 1.5" Concrete Fill in exterior floors (GC Issue #62)  - SAC 3/18/14 - extended to incl. int & crwlspc flrs
						else  0		; ERROR - no valid material thickness available
						endif endif endif endif endif
				else if ((Local( LayerPropertyIndex[7] ) == Local( FrameLayerMapIdx[1] ) .OR. 
							(Local( LayerPropertyIndex[7] ) == Local( FrameLayerMapIdx[2] ) .AND. Local( FrameLayerMapIdx[2] ) > 0)) .AND. Local( FrameLayer ) > 0)
				then	if ( (Type == 1 .OR. Type == 12 .OR. Type == 23) .AND. FrameLayer > 699 ) then  5.5    ; max out Steel Cons thickness @ 2x6
                  else  switch (mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 ))
      							case  4 :  3.5
		      					case  6 :  5.5
				      			case  8 :  7.25
						      	case 10 :  9.25
      							case 12 : 11.25
		      					default :	; ERROR??? - unrecognized framing depth
				      							(mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 )) - 0.75
						      endswitch  endif
				else  0		; ERROR - one or the other path material assignments missing (iff this is a valid layer)
				endif endif endif endif endif endif  }
    "Set Thickness[8] in Cons"		Cons:Thickness[8]		= {
				if (IfValidAnd( AbvJoistInsLyrMapIdx > 0 ) .AND. LayerPropertyIndex[8] == AbvJoistInsLyrMapIdx .AND. IfValidAnd( AbvJoistInsulThick > 0 ))
				then	AbvJoistInsulThick
				else if (IfValidAnd( BlwJoistInsLyrMapIdx > 0 ) .AND. LayerPropertyIndex[8] == BlwJoistInsLyrMapIdx .AND. IfValidAnd( BlwJoistInsulThick > 0 ))
				then	BlwJoistInsulThick
				else if (Local( LayerPropertyIndex[8] ) == Local( FrameLayerMapIdx[1] ) .AND. AtcEdg_ConsType > 0 .AND. Local( FrameLayerMapIdx[1] ) > 0)
				then	switch (AtcEdg_ConsType)
							case  1 :	12 * AtcEdg_ClgBlwAtc:AtcEdg_HA		; WA
							case  2 :	12 * AtcEdg_ClgBlwAtc:AtcEdg_HB3		; WB
							default :	3.5		; ERROR !!
						endswitch
				else if (Local( LayerPropertyIndex[8] ) == Local( FrameLayerMapIdx[2] ) .AND. AtcEdg_ConsType == 2 .AND. Local( FrameLayerMapIdx[2] ) > 0)
				then	12 * AtcEdg_ClgBlwAtc:AtcEdg_HB1							; WB
	 			else if (LocalCompAssigned( CavityPathMats[8] ) .AND. LocalCompAssigned( FramePathMats[8] ))
				then	if (LocalStatus( CavityPathMats[8]:Thickness ) > 0 .AND. LocalStatus( FramePathMats[8]:Thickness ) > 0)
						then	max( LocalRef( CavityPathMats[8]:Thickness ), LocalRef( FramePathMats[8]:Thickness ) )
						else if (LocalStatus( FramePathMats[8]:Thickness  ) > 0) then  LocalRef( FramePathMats[8]:Thickness  )
						else if ((Local( LayerPropertyIndex[8] ) == Local( FrameLayerMapIdx[1] ) .OR. 
									(Local( LayerPropertyIndex[8] ) == Local( FrameLayerMapIdx[2] ) .AND. Local( FrameLayerMapIdx[2] ) > 0)) .AND. Local( FrameLayer ) > 0)
						then	if (IfValidAnd( FrameLayerSymVal[8] >= 70000 ) .AND. IfValidAnd( FrameLayerSymVal[8] < 99999 ))
								then	switch (mod( FrameLayerSymVal[8], 10000 ))
											case  450 :	 3.5 
											case  650 :	 5.5 
											case  825 :	 7.25
											case 1025 :	 9.25
											case 1225 :	11.25
											default   :	 0		; ERROR !!
										endswitch
								else if ( (Type == 1 .OR. Type == 12 .OR. Type == 23) .AND. FrameLayer > 699 ) then  5.5    ; max out Steel Cons thickness @ 2x6
								else	switch (mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 ))
											case  4 :  3.5
											case  6 :  5.5
											case  8 :  7.25
											case 10 :  9.25
											case 12 : 11.25
											default :	; ERROR??? - unrecognized framing depth
															(mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 )) - 0.75
										endswitch  endif endif
						else if (LocalStatus( CavityPathMats[8]:Thickness ) > 0) then  LocalRef( CavityPathMats[8]:Thickness )
						else if ((CanAssignTo == 4 .OR. CanAssignTo == 5 .OR. CanAssignTo == 9 .OR. CanAssignTo == 6) .AND. CavityLayerSymVal[8] == 100107) then  1.5		; SAC 4/7/13 - 1.5" Concrete Fill in exterior floors (GC Issue #62)  - SAC 3/18/14 - extended to incl. int & crwlspc flrs
						else  0		; ERROR - no valid material thickness available
						endif endif endif endif endif
				else if ((Local( LayerPropertyIndex[8] ) == Local( FrameLayerMapIdx[1] ) .OR. 
							(Local( LayerPropertyIndex[8] ) == Local( FrameLayerMapIdx[2] ) .AND. Local( FrameLayerMapIdx[2] ) > 0)) .AND. Local( FrameLayer ) > 0)
				then	if ( (Type == 1 .OR. Type == 12 .OR. Type == 23) .AND. FrameLayer > 699 ) then  5.5    ; max out Steel Cons thickness @ 2x6
                  else  switch (mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 ))
      							case  4 :  3.5
		      					case  6 :  5.5
				      			case  8 :  7.25
						      	case 10 :  9.25
      							case 12 : 11.25
		      					default :	; ERROR??? - unrecognized framing depth
				      							(mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 )) - 0.75
						      endswitch  endif
				else  0		; ERROR - one or the other path material assignments missing (iff this is a valid layer)
				endif endif endif endif endif endif  }
    "Set Thickness[9] in Cons"		Cons:Thickness[9]		= {
				if (IfValidAnd( AbvJoistInsLyrMapIdx > 0 ) .AND. LayerPropertyIndex[9] == AbvJoistInsLyrMapIdx .AND. IfValidAnd( AbvJoistInsulThick > 0 ))
				then	AbvJoistInsulThick
				else if (IfValidAnd( BlwJoistInsLyrMapIdx > 0 ) .AND. LayerPropertyIndex[9] == BlwJoistInsLyrMapIdx .AND. IfValidAnd( BlwJoistInsulThick > 0 ))
				then	BlwJoistInsulThick
				else if (Local( LayerPropertyIndex[9] ) == Local( FrameLayerMapIdx[1] ) .AND. AtcEdg_ConsType > 0 .AND. Local( FrameLayerMapIdx[1] ) > 0)
				then	switch (AtcEdg_ConsType)
							case  1 :	12 * AtcEdg_ClgBlwAtc:AtcEdg_HA		; WA
							case  2 :	12 * AtcEdg_ClgBlwAtc:AtcEdg_HB3		; WB
							default :	3.5		; ERROR !!
						endswitch
				else if (Local( LayerPropertyIndex[9] ) == Local( FrameLayerMapIdx[2] ) .AND. AtcEdg_ConsType == 2 .AND. Local( FrameLayerMapIdx[2] ) > 0)
				then	12 * AtcEdg_ClgBlwAtc:AtcEdg_HB1							; WB
	 			else if (LocalCompAssigned( CavityPathMats[9] ) .AND. LocalCompAssigned( FramePathMats[9] ))
				then	if (LocalStatus( CavityPathMats[9]:Thickness ) > 0 .AND. LocalStatus( FramePathMats[9]:Thickness ) > 0)
						then	max( LocalRef( CavityPathMats[9]:Thickness ), LocalRef( FramePathMats[9]:Thickness ) )
						else if (LocalStatus( FramePathMats[9]:Thickness  ) > 0) then  LocalRef( FramePathMats[9]:Thickness  )
						else if ((Local( LayerPropertyIndex[9] ) == Local( FrameLayerMapIdx[1] ) .OR. 
									(Local( LayerPropertyIndex[9] ) == Local( FrameLayerMapIdx[2] ) .AND. Local( FrameLayerMapIdx[2] ) > 0)) .AND. Local( FrameLayer ) > 0)
						then  if ( (Type == 1 .OR. Type == 12 .OR. Type == 23) .AND. FrameLayer > 699 ) then  5.5    ; max out Steel Cons thickness @ 2x6
						      else  switch (mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 ))
   									case  4 :  3.5
	   								case  6 :  5.5
		   							case  8 :  7.25
			   						case 10 :  9.25
				   					case 12 : 11.25
					   				default :	; ERROR??? - unrecognized framing depth
						   							(mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 )) - 0.75
							   	endswitch  endif
						else if (LocalStatus( CavityPathMats[9]:Thickness ) > 0) then  LocalRef( CavityPathMats[9]:Thickness )
						else if ((CanAssignTo == 4 .OR. CanAssignTo == 5 .OR. CanAssignTo == 9 .OR. CanAssignTo == 6) .AND. CavityLayerSymVal[9] == 100107) then  1.5		; SAC 4/7/13 - 1.5" Concrete Fill in exterior floors (GC Issue #62)  - SAC 3/18/14 - extended to incl. int & crwlspc flrs
						else  0		; ERROR - no valid material thickness available
						endif endif endif endif endif
				else if ((Local( LayerPropertyIndex[9] ) == Local( FrameLayerMapIdx[1] ) .OR. 
							(Local( LayerPropertyIndex[9] ) == Local( FrameLayerMapIdx[2] ) .AND. Local( FrameLayerMapIdx[2] ) > 0)) .AND. Local( FrameLayer ) > 0)
				then	if ( (Type == 1 .OR. Type == 12 .OR. Type == 23) .AND. FrameLayer > 699 ) then  5.5    ; max out Steel Cons thickness @ 2x6
                  else  switch (mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 ))
      							case  4 :  3.5
		      					case  6 :  5.5
				      			case  8 :  7.25
						      	case 10 :  9.25
      							case 12 : 11.25
		      					default :	; ERROR??? - unrecognized framing depth
				      							(mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 )) - 0.75
						      endswitch  endif
				else  0		; ERROR - one or the other path material assignments missing (iff this is a valid layer)
				endif endif endif endif endif endif  }
    "Set Thickness[10] in Cons"		Cons:Thickness[10]	= {	0  }

  ; SAC 1/17/13 - call subordinate rulelist to calculate overall U-factor (via parallel path) now that all layers are setup
    "Calculate Cons overall U-factor"		Cons:Action	= {	EvalRulelist( "SetupCons_UValue_TwoPath", 1 )  }

END

;*************************************************************************
RULELIST "SetupCons_SinglePath"         0 0 0 1
;*************************************************************************

	"Setup Cavity path materials first"		Cons:Action	= {	EvalRulelist( "SetupCons_CavityMaterials", 1 )  }

; SAC 3/13/14 - modified rules to ensure that FURRING material objects are present as FramePathMats[*] (for access in creating combined cavity/insulation/furring materials via ConsUFactorRes())
	"Set Cons:FramePathMats[1]"		Cons:FramePathMats[1]	= {
				if (LayerPropertyIndex[1] != FrameLayerMapIdx[1] .AND. LayerPropertyIndex[1] != FrameLayerMapIdx[2]) then  UNDEFINED
				else if (IfValidAnd( FrameLayerSymVal[1] > 0 ) == 0) then  UNDEFINED		; Error - furring layer not specified
				else if (FrameLayerSymVal[1] >= 10000 .AND. FrameLayerSymVal[1] < 20000 .AND. GlobalCompAssigned( Proj:LibMat_SoftWood ))		; WOOD furred
				then	Proj:LibMat_SoftWood
				else if (FrameLayerSymVal[1] >= 20000 .AND. FrameLayerSymVal[1] < 30000 .AND. GlobalCompAssigned( Proj:LibMat_Steel ))			; STEEL furred
				then	Proj:LibMat_Steel
				else if (FrameLayerSymVal[1] >= 30000 .AND. FrameLayerSymVal[1] < 40000)			; EIFS furred
				then	UNDEFINED																						; - ??? how to handle EIFS ???
				else	UNDEFINED  endif endif endif endif endif  }
; SAC 3/13/14 - instead of creating NEW material w/ thickness consistent w/ 
;				then	AssignOrCreateComp( Mat, Format( "Furring-D%s-SH%s-C%s-Cct%s-RVpI%s-T%s", FltToStr( Proj:LibMat_SoftWood:Density, 1, 1, 0, 1 ), FltToStr( Proj:LibMat_SoftWood:SpecHeat, 2, 1, 0, 1 ),
;															FltToStr( Proj:LibMat_SoftWood:Conductivity, 5, 1, 0, 1 ), FltToStr( Proj:LibMat_SoftWood:ConductivityCT, 4, 1, 0, 1 ),
;															FltToStr( Proj:LibMat_SoftWood:RValPerInch, 2, 1, 0, 1 ), FltToStr( (mod(FrameLayerSymVal[1], 10000) / 100), 2, 1, 0, 1 ) ),
;														"ConductivityQII", Proj:LibMat_SoftWood:ConductivityQII, "ConductivityCT", Proj:LibMat_SoftWood:ConductivityCT, "SpecHeat", Proj:LibMat_SoftWood:SpecHeat,
;														"Density", Proj:LibMat_SoftWood:Density, "RValPerInch", Proj:LibMat_SoftWood:RValPerInch, "Thickness", (mod(FrameLayerSymVal[1], 10000) / 100) )
;		Mat  "SoftWood"         	                   Conductivity = 0.08167   ConductivityCT = 0.0012     SpecHeat = 0.39   Density = 35      RValPerInch = 1.0204   	..   ; 2009 HOF 26.6 Douglas fir/larch     CT from BSC paper 140206
;		Mat  "Steel"               Thickness = 1      Conductivity = 26.2                                  SpecHeat = 0.12   Density = 489     RValPerInch = 0.00318   ..   ; data from Chip 3/12/14

	"Set Cons:FramePathMats[2]"		Cons:FramePathMats[2]	= {
				if (LayerPropertyIndex[2] != FrameLayerMapIdx[1] .AND. LayerPropertyIndex[2] != FrameLayerMapIdx[2]) then  UNDEFINED
				else if (IfValidAnd( FrameLayerSymVal[2] > 0 ) == 0) then  UNDEFINED		; Error - furring layer not specified
				else if (FrameLayerSymVal[2] >= 10000 .AND. FrameLayerSymVal[2] < 20000 .AND. GlobalCompAssigned( Proj:LibMat_SoftWood ))		; WOOD furred
				then	Proj:LibMat_SoftWood
				else if (FrameLayerSymVal[2] >= 20000 .AND. FrameLayerSymVal[2] < 30000 .AND. GlobalCompAssigned( Proj:LibMat_Steel ))			; STEEL furred
				then	Proj:LibMat_Steel
				else if (FrameLayerSymVal[2] >= 30000 .AND. FrameLayerSymVal[2] < 40000)			; EIFS furred
				then	UNDEFINED																						; - ??? how to handle EIFS ???
				else	UNDEFINED  endif endif endif endif endif  }
	"Set Cons:FramePathMats[3]"		Cons:FramePathMats[3]	= {
				if (LayerPropertyIndex[3] != FrameLayerMapIdx[1] .AND. LayerPropertyIndex[3] != FrameLayerMapIdx[2]) then  UNDEFINED
				else if (IfValidAnd( FrameLayerSymVal[3] > 0 ) == 0) then  UNDEFINED		; Error - furring layer not specified
				else if (FrameLayerSymVal[3] >= 10000 .AND. FrameLayerSymVal[3] < 20000 .AND. GlobalCompAssigned( Proj:LibMat_SoftWood ))		; WOOD furred
				then	Proj:LibMat_SoftWood
				else if (FrameLayerSymVal[3] >= 20000 .AND. FrameLayerSymVal[3] < 30000 .AND. GlobalCompAssigned( Proj:LibMat_Steel ))			; STEEL furred
				then	Proj:LibMat_Steel
				else if (FrameLayerSymVal[3] >= 30000 .AND. FrameLayerSymVal[3] < 40000)			; EIFS furred
				then	UNDEFINED																						; - ??? how to handle EIFS ???
				else	UNDEFINED  endif endif endif endif endif  }
	"Set Cons:FramePathMats[4]"		Cons:FramePathMats[4]	= {
				if (LayerPropertyIndex[4] != FrameLayerMapIdx[1] .AND. LayerPropertyIndex[4] != FrameLayerMapIdx[2]) then  UNDEFINED
				else if (IfValidAnd( FrameLayerSymVal[4] > 0 ) == 0) then  UNDEFINED		; Error - furring layer not specified
				else if (FrameLayerSymVal[4] >= 10000 .AND. FrameLayerSymVal[4] < 20000 .AND. GlobalCompAssigned( Proj:LibMat_SoftWood ))		; WOOD furred
				then	Proj:LibMat_SoftWood
				else if (FrameLayerSymVal[4] >= 20000 .AND. FrameLayerSymVal[4] < 30000 .AND. GlobalCompAssigned( Proj:LibMat_Steel ))			; STEEL furred
				then	Proj:LibMat_Steel
				else if (FrameLayerSymVal[4] >= 30000 .AND. FrameLayerSymVal[4] < 40000)			; EIFS furred
				then	UNDEFINED																						; - ??? how to handle EIFS ???
				else	UNDEFINED  endif endif endif endif endif  }
	"Set Cons:FramePathMats[5]"		Cons:FramePathMats[5]	= {
				if (LayerPropertyIndex[5] != FrameLayerMapIdx[1] .AND. LayerPropertyIndex[5] != FrameLayerMapIdx[2]) then  UNDEFINED
				else if (IfValidAnd( FrameLayerSymVal[5] > 0 ) == 0) then  UNDEFINED		; Error - furring layer not specified
				else if (FrameLayerSymVal[5] >= 10000 .AND. FrameLayerSymVal[5] < 20000 .AND. GlobalCompAssigned( Proj:LibMat_SoftWood ))		; WOOD furred
				then	Proj:LibMat_SoftWood
				else if (FrameLayerSymVal[5] >= 20000 .AND. FrameLayerSymVal[5] < 30000 .AND. GlobalCompAssigned( Proj:LibMat_Steel ))			; STEEL furred
				then	Proj:LibMat_Steel
				else if (FrameLayerSymVal[5] >= 30000 .AND. FrameLayerSymVal[5] < 40000)			; EIFS furred
				then	UNDEFINED																						; - ??? how to handle EIFS ???
				else	UNDEFINED  endif endif endif endif endif  }
	"Set Cons:FramePathMats[6]"		Cons:FramePathMats[6]	= {
				if (LayerPropertyIndex[6] != FrameLayerMapIdx[1] .AND. LayerPropertyIndex[6] != FrameLayerMapIdx[2]) then  UNDEFINED
				else if (IfValidAnd( FrameLayerSymVal[6] > 0 ) == 0) then  UNDEFINED		; Error - furring layer not specified
				else if (FrameLayerSymVal[6] >= 10000 .AND. FrameLayerSymVal[6] < 20000 .AND. GlobalCompAssigned( Proj:LibMat_SoftWood ))		; WOOD furred
				then	Proj:LibMat_SoftWood
				else if (FrameLayerSymVal[6] >= 20000 .AND. FrameLayerSymVal[6] < 30000 .AND. GlobalCompAssigned( Proj:LibMat_Steel ))			; STEEL furred
				then	Proj:LibMat_Steel
				else if (FrameLayerSymVal[6] >= 30000 .AND. FrameLayerSymVal[6] < 40000)			; EIFS furred
				then	UNDEFINED																						; - ??? how to handle EIFS ???
				else	UNDEFINED  endif endif endif endif endif  }
	"Set Cons:FramePathMats[7]"		Cons:FramePathMats[7]	= {
				if (LayerPropertyIndex[7] != FrameLayerMapIdx[1] .AND. LayerPropertyIndex[7] != FrameLayerMapIdx[2]) then  UNDEFINED
				else if (IfValidAnd( FrameLayerSymVal[7] > 0 ) == 0) then  UNDEFINED		; Error - furring layer not specified
				else if (FrameLayerSymVal[7] >= 10000 .AND. FrameLayerSymVal[7] < 20000 .AND. GlobalCompAssigned( Proj:LibMat_SoftWood ))		; WOOD furred
				then	Proj:LibMat_SoftWood
				else if (FrameLayerSymVal[7] >= 20000 .AND. FrameLayerSymVal[7] < 30000 .AND. GlobalCompAssigned( Proj:LibMat_Steel ))			; STEEL furred
				then	Proj:LibMat_Steel
				else if (FrameLayerSymVal[7] >= 30000 .AND. FrameLayerSymVal[7] < 40000)			; EIFS furred
				then	UNDEFINED																						; - ??? how to handle EIFS ???
				else	UNDEFINED  endif endif endif endif endif  }
	"Set Cons:FramePathMats[8]"		Cons:FramePathMats[8]	= {
				if (LayerPropertyIndex[8] != FrameLayerMapIdx[1] .AND. LayerPropertyIndex[8] != FrameLayerMapIdx[2]) then  UNDEFINED
				else if (IfValidAnd( FrameLayerSymVal[8] > 0 ) == 0) then  UNDEFINED		; Error - furring layer not specified
				else if (FrameLayerSymVal[8] >= 10000 .AND. FrameLayerSymVal[8] < 20000 .AND. GlobalCompAssigned( Proj:LibMat_SoftWood ))		; WOOD furred
				then	Proj:LibMat_SoftWood
				else if (FrameLayerSymVal[8] >= 20000 .AND. FrameLayerSymVal[8] < 30000 .AND. GlobalCompAssigned( Proj:LibMat_Steel ))			; STEEL furred
				then	Proj:LibMat_Steel
				else if (FrameLayerSymVal[8] >= 30000 .AND. FrameLayerSymVal[8] < 40000)			; EIFS furred
				then	UNDEFINED																						; - ??? how to handle EIFS ???
				else	UNDEFINED  endif endif endif endif endif  }
	"Set Cons:FramePathMats[9]"		Cons:FramePathMats[9]	= {
				if (LayerPropertyIndex[9] != FrameLayerMapIdx[1] .AND. LayerPropertyIndex[9] != FrameLayerMapIdx[2]) then  UNDEFINED
				else if (IfValidAnd( FrameLayerSymVal[9] > 0 ) == 0) then  UNDEFINED		; Error - furring layer not specified
				else if (FrameLayerSymVal[9] >= 10000 .AND. FrameLayerSymVal[9] < 20000 .AND. GlobalCompAssigned( Proj:LibMat_SoftWood ))		; WOOD furred
				then	Proj:LibMat_SoftWood
				else if (FrameLayerSymVal[9] >= 20000 .AND. FrameLayerSymVal[9] < 30000 .AND. GlobalCompAssigned( Proj:LibMat_Steel ))			; STEEL furred
				then	Proj:LibMat_Steel
				else if (FrameLayerSymVal[9] >= 30000 .AND. FrameLayerSymVal[9] < 40000)			; EIFS furred
				then	UNDEFINED																						; - ??? how to handle EIFS ???
				else	UNDEFINED  endif endif endif endif endif  }


    "Set Thickness[1] in Cons"		Cons:Thickness[1]		= {
	 			if (IfValidAnd( LayerPropertyIndex[1] > 0 ) .AND. (IfValidAnd( LayerPropertyIndex[1] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[1] == FrameLayerMapIdx[2] )) .AND.
	 				 IfValidAnd( FrameLayerSymVal[1] >= 10000 ) .AND. IfValidAnd( FrameLayerSymVal[1] < 30000 ))
				then  mod(FrameLayerSymVal[1], 10000) / 100
	 			else if (LocalCompAssigned( CavityPathMats[1] ) < 1)
				then	if (IfValidAnd( CavityLayerSymVal[1] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[1] < 201 )) then  1		; covers cavity insulation
						else  0  endif
				else if(IfValidAnd( CavityPathMats[1]:Thickness > 0 )) then  CavityPathMats[1]:Thickness
	 			else if(	IfValidAnd( LayerPropertyIndex[1] > 0 ) .AND. (IfValidAnd( LayerPropertyIndex[1] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[1] == FrameLayerMapIdx[2] )) .AND.
							LocalCompAssigned( CavityPathMats[1] ) .AND. LocalStatus( CavityPathMats[1]:Thickness ) < 1) then  1    ; covers cavity insulation
				else if(IfValidAnd( MassLayer > 0 ) .AND. IfValidAnd( MassThickness > 0 )) then  MassThickness
				else  0		; ERROR - no valid material thickness available
				endif endif endif endif endif  }
; DEBUGGING
;	"store BEMProc details"		Cons:Action = {	if (Name != "Construction Assembly 2") then  UNCHANGED
;																else	StoreBEMProc( Format( "b4 Cons_Thickness2 rule %s", Name ), 0 )  endif  }
;	"Post messagebox"				Cons:Action = {	if (Name != "Construction Assembly 2") then  UNCHANGED
;																else	MessageBox( Format( "Cons Assm 2:\n   CompAssigned( CavityPathMats[2] ) = %g\n   CompAssigned( FramePathMats[2] ) = %g\n   Status( CavityPathMats[2]:Thickness ) = %g\n   Status( FramePathMats[2]:Thickness ) = %g",
;																							LocalCompAssigned( CavityPathMats[2] ), LocalCompAssigned( FramePathMats[2] ), LocalStatus( CavityPathMats[2]:Thickness ), LocalStatus( FramePathMats[2]:Thickness ) ) )  endif  }
;"log Cons data"	Cons:Action	= {	PostMessageToLog( "Setting Cons:Thickness[2] for '%s' CavityPathMats[2]:Thickness = %g / FramePathMats[2]:Thickness = %g", Name, ValidOr( CavityPathMats[2]:Thickness, -1 ),
;																				ValidOr( FramePathMats[2]:Thickness, -1 ) )  }
; DEBUGGING
    "Set Thickness[2] in Cons"		Cons:Thickness[2]		= {
	 			if (IfValidAnd( LayerPropertyIndex[2] > 0 ) .AND. (IfValidAnd( LayerPropertyIndex[2] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[2] == FrameLayerMapIdx[2] )) .AND.
	 				 IfValidAnd( FrameLayerSymVal[2] >= 10000 ) .AND. IfValidAnd( FrameLayerSymVal[2] < 30000 ))
				then  mod(FrameLayerSymVal[2], 10000) / 100
	 			else if (LocalCompAssigned( CavityPathMats[2] ) < 1)
				then	if (IfValidAnd( CavityLayerSymVal[2] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[2] < 201 )) then  1		; covers cavity insulation
						else  0  endif
				else if(IfValidAnd( CavityPathMats[2]:Thickness > 0 )) then  CavityPathMats[2]:Thickness
	 			else if(	IfValidAnd( LayerPropertyIndex[2] > 0 ) .AND. (IfValidAnd( LayerPropertyIndex[2] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[2] == FrameLayerMapIdx[2] )) .AND.
							LocalCompAssigned( CavityPathMats[2] ) .AND. LocalStatus( CavityPathMats[2]:Thickness ) < 1) then  1    ; covers cavity insulation
				else if(IfValidAnd( MassLayer > 0 ) .AND. IfValidAnd( MassThickness > 0 )) then  MassThickness
				else  0		; ERROR - no valid material thickness available
				endif endif endif endif endif  }
    "Set Thickness[3] in Cons"		Cons:Thickness[3]		= {
	 			if (IfValidAnd( LayerPropertyIndex[3] > 0 ) .AND. (IfValidAnd( LayerPropertyIndex[3] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[3] == FrameLayerMapIdx[2] )) .AND.
	 				 IfValidAnd( FrameLayerSymVal[3] >= 10000 ) .AND. IfValidAnd( FrameLayerSymVal[3] < 30000 ))
				then  mod(FrameLayerSymVal[3], 10000) / 100
	 			else if (LocalCompAssigned( CavityPathMats[3] ) < 1)
				then	if (IfValidAnd( CavityLayerSymVal[3] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[3] < 201 )) then  1		; covers cavity insulation
						else  0  endif
				else if(IfValidAnd( CavityPathMats[3]:Thickness > 0 )) then  CavityPathMats[3]:Thickness
	 			else if(	IfValidAnd( LayerPropertyIndex[3] > 0 ) .AND. (IfValidAnd( LayerPropertyIndex[3] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[3] == FrameLayerMapIdx[2] )) .AND.
							LocalCompAssigned( CavityPathMats[3] ) .AND. LocalStatus( CavityPathMats[3]:Thickness ) < 1) then  1    ; covers cavity insulation
				else if(IfValidAnd( MassLayer > 0 ) .AND. IfValidAnd( MassThickness > 0 )) then  MassThickness
				else  0		; ERROR - no valid material thickness available
				endif endif endif endif endif  }
; SAC 3/16/14 - to be REMOVED
;"Log certain CavityPathMats selection"		Cons:Action = {  if (Name != "R15 R4 Stucco Wall") then  UNCHANGED
;			else if (LocalStatus( Thickness[3] ) > 0) then	PostMessageToLog( "Rule line: 23393 - Cons 'R15 R4 Stucco Wall' Thickness[3] = %g", Thickness[3] )
;			else  PostMessageToLog( "Rule line: 23393 - Cons 'R15 R4 Stucco Wall' Thickness[3]    UNDEFINED" )  endif endif  }
    "Set Thickness[4] in Cons"		Cons:Thickness[4]		= {
	 			if (IfValidAnd( LayerPropertyIndex[4] > 0 ) .AND. (IfValidAnd( LayerPropertyIndex[4] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[4] == FrameLayerMapIdx[2] )) .AND.
	 				 IfValidAnd( FrameLayerSymVal[4] >= 10000 ) .AND. IfValidAnd( FrameLayerSymVal[4] < 30000 ))
				then  mod(FrameLayerSymVal[4], 10000) / 100
	 			else if (LocalCompAssigned( CavityPathMats[4] ) < 1)
				then	if (IfValidAnd( CavityLayerSymVal[4] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[4] < 201 )) then  1		; covers cavity insulation
						else  0  endif
				else if(IfValidAnd( CavityPathMats[4]:Thickness > 0 )) then  CavityPathMats[4]:Thickness
	 			else if(	IfValidAnd( LayerPropertyIndex[4] > 0 ) .AND. (IfValidAnd( LayerPropertyIndex[4] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[4] == FrameLayerMapIdx[2] )) .AND.
							LocalCompAssigned( CavityPathMats[4] ) .AND. LocalStatus( CavityPathMats[4]:Thickness ) < 1) then  1    ; covers cavity insulation
				else if(IfValidAnd( MassLayer > 0 ) .AND. IfValidAnd( MassThickness > 0 )) then  MassThickness
				else  0		; ERROR - no valid material thickness available
				endif endif endif endif endif  }
    "Set Thickness[5] in Cons"		Cons:Thickness[5]		= {
	 			if (IfValidAnd( LayerPropertyIndex[5] > 0 ) .AND. (IfValidAnd( LayerPropertyIndex[5] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[5] == FrameLayerMapIdx[2] )) .AND.
	 				 IfValidAnd( FrameLayerSymVal[5] >= 10000 ) .AND. IfValidAnd( FrameLayerSymVal[5] < 30000 ))
				then  mod(FrameLayerSymVal[5], 10000) / 100
	 			else if (LocalCompAssigned( CavityPathMats[5] ) < 1)
				then	if (IfValidAnd( CavityLayerSymVal[5] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[5] < 201 )) then  1		; covers cavity insulation
						else  0  endif
				else if(IfValidAnd( CavityPathMats[5]:Thickness > 0 )) then  CavityPathMats[5]:Thickness
	 			else if(	IfValidAnd( LayerPropertyIndex[4] > 0 ) .AND. (IfValidAnd( LayerPropertyIndex[4] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[4] == FrameLayerMapIdx[2] )) .AND.
							LocalCompAssigned( CavityPathMats[4] ) .AND. LocalStatus( CavityPathMats[4]:Thickness ) < 1) then  1    ; covers cavity insulation
				else if(IfValidAnd( MassLayer > 0 ) .AND. IfValidAnd( MassThickness > 0 )) then  MassThickness
				else  0		; ERROR - no valid material thickness available
				endif endif endif endif endif  }
    "Set Thickness[6] in Cons"		Cons:Thickness[6]		= {
	 			if (IfValidAnd( LayerPropertyIndex[6] > 0 ) .AND. (IfValidAnd( LayerPropertyIndex[6] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[6] == FrameLayerMapIdx[2] )) .AND.
	 				 IfValidAnd( FrameLayerSymVal[6] >= 10000 ) .AND. IfValidAnd( FrameLayerSymVal[6] < 30000 ))
				then  mod(FrameLayerSymVal[6], 10000) / 100
	 			else if (LocalCompAssigned( CavityPathMats[6] ) < 1)
				then	if (IfValidAnd( CavityLayerSymVal[6] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[6] < 201 )) then  1		; covers cavity insulation
						else  0  endif
				else if(IfValidAnd( CavityPathMats[6]:Thickness > 0 )) then  CavityPathMats[6]:Thickness
	 			else if(	IfValidAnd( LayerPropertyIndex[6] > 0 ) .AND. (IfValidAnd( LayerPropertyIndex[6] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[6] == FrameLayerMapIdx[2] )) .AND.
							LocalCompAssigned( CavityPathMats[6] ) .AND. LocalStatus( CavityPathMats[6]:Thickness ) < 1) then  1    ; covers cavity insulation
				else if(IfValidAnd( MassLayer > 0 ) .AND. IfValidAnd( MassThickness > 0 )) then  MassThickness
				else  0		; ERROR - no valid material thickness available
				endif endif endif endif endif  }
    "Set Thickness[7] in Cons"		Cons:Thickness[7]		= {
	 			if (IfValidAnd( LayerPropertyIndex[7] > 0 ) .AND. (IfValidAnd( LayerPropertyIndex[7] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[7] == FrameLayerMapIdx[2] )) .AND.
	 				 IfValidAnd( FrameLayerSymVal[7] >= 10000 ) .AND. IfValidAnd( FrameLayerSymVal[7] < 30000 ))
				then  mod(FrameLayerSymVal[7], 10000) / 100
	 			else if (LocalCompAssigned( CavityPathMats[7] ) < 1)
				then	if (IfValidAnd( CavityLayerSymVal[7] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[7] < 201 )) then  1		; covers cavity insulation
						else  0  endif
				else if(IfValidAnd( CavityPathMats[7]:Thickness > 0 )) then  CavityPathMats[7]:Thickness
	 			else if(	IfValidAnd( LayerPropertyIndex[7] > 0 ) .AND. (IfValidAnd( LayerPropertyIndex[7] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[7] == FrameLayerMapIdx[2] )) .AND.
							LocalCompAssigned( CavityPathMats[7] ) .AND. LocalStatus( CavityPathMats[7]:Thickness ) < 1) then  1    ; covers cavity insulation
				else if(IfValidAnd( MassLayer > 0 ) .AND. IfValidAnd( MassThickness > 0 )) then  MassThickness
				else  0		; ERROR - no valid material thickness available
				endif endif endif endif endif  }
    "Set Thickness[8] in Cons"		Cons:Thickness[8]		= {
	 			if (IfValidAnd( LayerPropertyIndex[8] > 0 ) .AND. (IfValidAnd( LayerPropertyIndex[8] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[8] == FrameLayerMapIdx[2] )) .AND.
	 				 IfValidAnd( FrameLayerSymVal[8] >= 10000 ) .AND. IfValidAnd( FrameLayerSymVal[8] < 30000 ))
				then  mod(FrameLayerSymVal[8], 10000) / 100
	 			else if (LocalCompAssigned( CavityPathMats[8] ) < 1)
				then	if (IfValidAnd( CavityLayerSymVal[8] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[8] < 201 )) then  1		; covers cavity insulation
						else  0  endif
				else if(IfValidAnd( CavityPathMats[8]:Thickness > 0 )) then  CavityPathMats[8]:Thickness
	 			else if(	IfValidAnd( LayerPropertyIndex[8] > 0 ) .AND. (IfValidAnd( LayerPropertyIndex[8] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[8] == FrameLayerMapIdx[2] )) .AND.
							LocalCompAssigned( CavityPathMats[8] ) .AND. LocalStatus( CavityPathMats[8]:Thickness ) < 1) then  1    ; covers cavity insulation
				else if(IfValidAnd( MassLayer > 0 ) .AND. IfValidAnd( MassThickness > 0 )) then  MassThickness
				else  0		; ERROR - no valid material thickness available
				endif endif endif endif endif  }
    "Set Thickness[9] in Cons"		Cons:Thickness[9]		= {
	 			if (IfValidAnd( LayerPropertyIndex[9] > 0 ) .AND. (IfValidAnd( LayerPropertyIndex[9] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[9] == FrameLayerMapIdx[2] )) .AND.
	 				 IfValidAnd( FrameLayerSymVal[9] >= 10000 ) .AND. IfValidAnd( FrameLayerSymVal[9] < 30000 ))
				then  mod(FrameLayerSymVal[9], 10000) / 100
	 			else if (LocalCompAssigned( CavityPathMats[9] ) < 1)
				then	if (IfValidAnd( CavityLayerSymVal[9] > 0 ) .AND. IfValidAnd( CavityLayerSymVal[9] < 201 )) then  1		; covers cavity insulation
						else  0  endif
				else if(IfValidAnd( CavityPathMats[9]:Thickness > 0 )) then  CavityPathMats[9]:Thickness
	 			else if(	IfValidAnd( LayerPropertyIndex[9] > 0 ) .AND. (IfValidAnd( LayerPropertyIndex[9] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[9] == FrameLayerMapIdx[2] )) .AND.
							LocalCompAssigned( CavityPathMats[9] ) .AND. LocalStatus( CavityPathMats[9]:Thickness ) < 1) then  1    ; covers cavity insulation
				else if(IfValidAnd( MassLayer > 0 ) .AND. IfValidAnd( MassThickness > 0 )) then  MassThickness
				else  0		; ERROR - no valid material thickness available
				endif endif endif endif endif  }
    "Set Thickness[10] in Cons"		Cons:Thickness[10]	= {	0  }

  ; SAC 1/17/13 - call subordinate rulelist to calculate overall U-factor (via parallel path) now that all layers are setup
    "Calculate Cons overall U-factor"		Cons:Action	= {	EvalRulelist( "SetupCons_UValue_SinglePath", 1 )  }

END

;*************************************************************************
RULELIST "SetupCons_FilmCoefficients"    0 0 0 0
;*************************************************************************
; SAC 2/27/14 - added new properties to represent inside & outside air film coefficients, and incorporate those into R-value initialization
	"Set Cons:OutsdAirFilmR based on CanAssignTo"		Cons:OutsdAirFilmR	= {
			switch( CanAssignTo )
				case  0 :	0.17	; Exterior Walls
				case 10 :	0.68	; Interior Walls
				case  1 :	0.17	; Attic Roofs
				case  2 :	0.17	; Cathedral Ceilings
				case  3 :	0.92	; Ceiling (blw attc)
				case  6 :	0.92	; Interior Ceilings
				case  4 :	0.61	; Interior Floors
				case  5 :	0.17	; Exterior Floors
				case  9 :	0.61	; Floors ovr Crwlspc
				;    20 :   0.0   ; Underground Walls
				;     7 :   0.0   ; Slab Floors
				;     8 :   0.0   ; Underground Floors
				default :	0		; ERROR
			endswitch  }
	"Set Cons:InsdAirFilmR based on CanAssignTo"		Cons:InsdAirFilmR		= {
			switch( CanAssignTo )
				case  0 :	0.68	; Exterior Walls
				case 10 :	0.68	; Interior Walls
				case  1 :	0.61	; Attic Roofs
				case  2 :	0.61	; Cathedral Ceilings
				case  3 :	0.61	; Ceiling (blw attc)
				case  6 :	0.61	; Interior Ceilings
				case  4 :	0.92	; Interior Floors
				case  5 :	0.92	; Exterior Floors
				case  9 :	0.92	; Floors ovr Crwlspc
				;    20 :	0.68	; Underground Walls
				;     7 :	0.92	; Slab Floors
				;     8 :	0.92	; Underground Floors
				default :	0		; ERROR
			endswitch  }
END

;*************************************************************************
RULELIST "SetupCons_UValue_TwoPath"         0 0 0 1
;*************************************************************************
 ; Begin calcs of overall cons R-value

	"Init Cons:OutsdAirFilmR & InsdAirFilmR"		Cons:Action  = {	EvalRulelist( "SetupCons_FilmCoefficients", 1 )  }
	"Init Cons:FrameCodeRValueX to air films"		Cons:FrameCodeRValueX  = {	OutsdAirFilmR + InsdAirFilmR  }

; "Debug FrameCodeRValue msg"	Cons:Action	= {
; 	if (LocalStatus( FrameCodeRValue ) < 1)
; 	then	PostMessageToLog( "   Cons '%s' FrameCodeRValue is UNDEFINED", Name )
; 	else	PostMessageToLog( "   Cons '%s' FrameCodeRValue = %g  (status: %g)", Name, FrameCodeRValue, LocalStatus( FrameCodeRValue ) )    endif  }

 	; Cons:FrameCodeRValueX should ALREADY be initialized to the outside + inside film coefficients based on surface type (prior to this rulelist being evaluated)
	"Revise Cons:FrameCodeRValueX-1"	Cons:FrameCodeRValueX  = {
					if (IfValidAnd( FrameLayerSymVal[1] < 0.01 ) .OR. IfValidAnd( LayerPropertyIndex[1] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[1] == FrameLayerMapIdx[2] )) then  UNCHANGED
					else if (LocalCompAssigned( FramePathMats[1] ) .AND. LocalStatus( FramePathMats[1]:RValPerInch ) > 0)
					then	if (LocalStatus( FramePathMats[1]:Thickness ) > 0)
							then  (LocalRef( FramePathMats[1]:Thickness ) * LocalRef( FramePathMats[1]:RValPerInch )) + Local( FrameCodeRValueX )
							else  (Local(                  Thickness[1] ) * LocalRef( FramePathMats[1]:RValPerInch )) + Local( FrameCodeRValueX )  endif
					else if ((IfValidAnd( FrameLayerSymVal[1] = 99000 ) .OR. IfValidAnd( FrameLayerSymVal[1] = 900 )) .AND. IfValidAnd( LayerUsrInpInsRVal[1] > 0 ))
               then               LayerUsrInpInsRVal[1] + FrameCodeRValueX
					else if (IfValidAnd( FrameLayerSymVal[1] > 99000 ) .AND. IfValidAnd( FrameLayerSymVal[1] < 99300 ))
					then         (Local( FrameLayerSymVal[1] ) - 99000) + Local( FrameCodeRValueX )
					else if (IfValidAnd( FrameLayerSymVal[1] < 100))
					then          Local( FrameLayerSymVal[1] ) + Local( FrameCodeRValueX )
					else  UNCHANGED  endif endif endif endif endif  }
	"Revise Cons:FrameCodeRValueX-2"	Cons:FrameCodeRValueX  = {
					if (IfValidAnd( FrameLayerSymVal[2] < 0.01 ) .OR. IfValidAnd( LayerPropertyIndex[2] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[2] == FrameLayerMapIdx[2] )) then  UNCHANGED
					else if (LocalCompAssigned( FramePathMats[2] ) .AND. LocalStatus( FramePathMats[2]:RValPerInch ) > 0)
					then	if (LocalStatus( FramePathMats[2]:Thickness ) > 0)
							then  (LocalRef( FramePathMats[2]:Thickness ) * LocalRef( FramePathMats[2]:RValPerInch )) + Local( FrameCodeRValueX )
							else  (Local(                  Thickness[2] ) * LocalRef( FramePathMats[2]:RValPerInch )) + Local( FrameCodeRValueX )  endif
					else if ((IfValidAnd( FrameLayerSymVal[2] = 99000 ) .OR. IfValidAnd( FrameLayerSymVal[2] = 900 )) .AND. IfValidAnd( LayerUsrInpInsRVal[2] > 0 ))
               then               LayerUsrInpInsRVal[2] + FrameCodeRValueX
					else if (IfValidAnd( FrameLayerSymVal[2] > 99000 ) .AND. IfValidAnd( FrameLayerSymVal[2] < 99300 ))
					then         (Local( FrameLayerSymVal[2] ) - 99000) + Local( FrameCodeRValueX )
					else if (IfValidAnd( FrameLayerSymVal[2] < 100 ))
					then          Local( FrameLayerSymVal[2] ) + Local( FrameCodeRValueX )
					else  UNCHANGED  endif endif endif endif endif  }
	"Revise Cons:FrameCodeRValueX-3"	Cons:FrameCodeRValueX  = {
					if (IfValidAnd( FrameLayerSymVal[3] < 0.01 ) .OR. IfValidAnd( LayerPropertyIndex[3] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[3] == FrameLayerMapIdx[2] )) then  UNCHANGED
					else if (LocalCompAssigned( FramePathMats[3] ) .AND. LocalStatus( FramePathMats[3]:RValPerInch ) > 0)
					then	if (LocalStatus( FramePathMats[3]:Thickness ) > 0)
							then  (LocalRef( FramePathMats[3]:Thickness ) * LocalRef( FramePathMats[3]:RValPerInch )) + Local( FrameCodeRValueX )
							else  (Local(                  Thickness[3] ) * LocalRef( FramePathMats[3]:RValPerInch )) + Local( FrameCodeRValueX )  endif
					else if ((IfValidAnd( FrameLayerSymVal[3] = 99000 ) .OR. IfValidAnd( FrameLayerSymVal[3] = 900 )) .AND. IfValidAnd( LayerUsrInpInsRVal[3] > 0 ))
               then               LayerUsrInpInsRVal[3] + FrameCodeRValueX
					else if (IfValidAnd( FrameLayerSymVal[3] > 99000 ) .AND. IfValidAnd( FrameLayerSymVal[3] < 99300 ))
					then         (Local( FrameLayerSymVal[3] ) - 99000) + Local( FrameCodeRValueX )
					else if (IfValidAnd( FrameLayerSymVal[3] < 100 ))
					then          Local( FrameLayerSymVal[3] ) + Local( FrameCodeRValueX )
					else  UNCHANGED  endif endif endif endif endif  }
	"Revise Cons:FrameCodeRValueX-4"	Cons:FrameCodeRValueX  = {
					if (IfValidAnd( FrameLayerSymVal[4] < 0.01 ) .OR. IfValidAnd( LayerPropertyIndex[4] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[4] == FrameLayerMapIdx[2] )) then  UNCHANGED
					else if (LocalCompAssigned( FramePathMats[4] ) .AND. LocalStatus( FramePathMats[4]:RValPerInch ) > 0)
					then	if (LocalStatus( FramePathMats[4]:Thickness ) > 0)
							then  (LocalRef( FramePathMats[4]:Thickness ) * LocalRef( FramePathMats[4]:RValPerInch )) + Local( FrameCodeRValueX )
							else  (Local(                  Thickness[4] ) * LocalRef( FramePathMats[4]:RValPerInch )) + Local( FrameCodeRValueX )  endif
					else if ((IfValidAnd( FrameLayerSymVal[4] = 99000 ) .OR. IfValidAnd( FrameLayerSymVal[4] = 900 )) .AND. IfValidAnd( LayerUsrInpInsRVal[4] > 0 ))
               then               LayerUsrInpInsRVal[4] + FrameCodeRValueX
					else if (IfValidAnd( FrameLayerSymVal[4] > 99000 ) .AND. IfValidAnd( FrameLayerSymVal[4] < 99300 ))
					then         (Local( FrameLayerSymVal[4] ) - 99000) + Local( FrameCodeRValueX )
					else if (IfValidAnd( FrameLayerSymVal[4] < 100 ))
					then          Local( FrameLayerSymVal[4] ) + Local( FrameCodeRValueX )
					else  UNCHANGED  endif endif endif endif endif  }
	"Revise Cons:FrameCodeRValueX-5"	Cons:FrameCodeRValueX  = {
					if (IfValidAnd( FrameLayerSymVal[5] < 0.01 ) .OR. IfValidAnd( LayerPropertyIndex[5] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[5] == FrameLayerMapIdx[2] )) then  UNCHANGED
					else if (LocalCompAssigned( FramePathMats[5] ) .AND. LocalStatus( FramePathMats[5]:RValPerInch ) > 0)
					then	if (LocalStatus( FramePathMats[5]:Thickness ) > 0)
							then  (LocalRef( FramePathMats[5]:Thickness ) * LocalRef( FramePathMats[5]:RValPerInch )) + Local( FrameCodeRValueX )
							else  (Local(                  Thickness[5] ) * LocalRef( FramePathMats[5]:RValPerInch )) + Local( FrameCodeRValueX )  endif
					else if ((IfValidAnd( FrameLayerSymVal[5] = 99000 ) .OR. IfValidAnd( FrameLayerSymVal[5] = 900 )) .AND. IfValidAnd( LayerUsrInpInsRVal[5] > 0 ))
               then               LayerUsrInpInsRVal[5] + FrameCodeRValueX
					else if (IfValidAnd( FrameLayerSymVal[5] > 99000 ) .AND. IfValidAnd( FrameLayerSymVal[5] < 99300 ))
					then         (Local( FrameLayerSymVal[5] ) - 99000) + Local( FrameCodeRValueX )
					else if (IfValidAnd( FrameLayerSymVal[5] < 100 ))
					then          Local( FrameLayerSymVal[5] ) + Local( FrameCodeRValueX )
					else  UNCHANGED  endif endif endif endif endif  }
	"Revise Cons:FrameCodeRValueX-6"	Cons:FrameCodeRValueX  = {
					if (IfValidAnd( FrameLayerSymVal[6] < 0.01 ) .OR. IfValidAnd( LayerPropertyIndex[6] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[6] == FrameLayerMapIdx[2] )) then  UNCHANGED
					else if (LocalCompAssigned( FramePathMats[6] ) .AND. LocalStatus( FramePathMats[6]:RValPerInch ) > 0)
					then	if (LocalStatus( FramePathMats[6]:Thickness ) > 0)
							then  (LocalRef( FramePathMats[6]:Thickness ) * LocalRef( FramePathMats[6]:RValPerInch )) + Local( FrameCodeRValueX )
							else  (Local(                  Thickness[6] ) * LocalRef( FramePathMats[6]:RValPerInch )) + Local( FrameCodeRValueX )  endif
					else if ((IfValidAnd( FrameLayerSymVal[6] = 99000 ) .OR. IfValidAnd( FrameLayerSymVal[6] = 900 )) .AND. IfValidAnd( LayerUsrInpInsRVal[6] > 0 ))
               then               LayerUsrInpInsRVal[6] + FrameCodeRValueX
					else if (IfValidAnd( FrameLayerSymVal[6] > 99000 ) .AND. IfValidAnd( FrameLayerSymVal[6] < 99300 ))
					then         (Local( FrameLayerSymVal[6] ) - 99000) + Local( FrameCodeRValueX )
					else if (IfValidAnd( FrameLayerSymVal[6] < 100 ))
					then          Local( FrameLayerSymVal[6] ) + Local( FrameCodeRValueX )
					else  UNCHANGED  endif endif endif endif endif  }
	"Revise Cons:FrameCodeRValueX-7"	Cons:FrameCodeRValueX  = {
					if (IfValidAnd( FrameLayerSymVal[7] < 0.01 ) .OR. IfValidAnd( LayerPropertyIndex[7] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[7] == FrameLayerMapIdx[2] )) then  UNCHANGED
					else if (LocalCompAssigned( FramePathMats[7] ) .AND. LocalStatus( FramePathMats[7]:RValPerInch ) > 0)
					then	if (LocalStatus( FramePathMats[7]:Thickness ) > 0)
							then  (LocalRef( FramePathMats[7]:Thickness ) * LocalRef( FramePathMats[7]:RValPerInch )) + Local( FrameCodeRValueX )
							else  (Local(                  Thickness[7] ) * LocalRef( FramePathMats[7]:RValPerInch )) + Local( FrameCodeRValueX )  endif
					else if ((IfValidAnd( FrameLayerSymVal[7] = 99000 ) .OR. IfValidAnd( FrameLayerSymVal[7] = 900 )) .AND. IfValidAnd( LayerUsrInpInsRVal[7] > 0 ))
               then               LayerUsrInpInsRVal[7] + FrameCodeRValueX
					else if (IfValidAnd( FrameLayerSymVal[7] > 99000 ) .AND. IfValidAnd( FrameLayerSymVal[7] < 99300 ))
					then         (Local( FrameLayerSymVal[7] ) - 99000) + Local( FrameCodeRValueX )
					else if (IfValidAnd( FrameLayerSymVal[7] < 100 ))
					then          Local( FrameLayerSymVal[7] ) + Local( FrameCodeRValueX )
					else  UNCHANGED  endif endif endif endif endif  }
	"Revise Cons:FrameCodeRValueX-8"	Cons:FrameCodeRValueX  = {
					if (IfValidAnd( FrameLayerSymVal[8] < 0.01 ) .OR. IfValidAnd( LayerPropertyIndex[8] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[8] == FrameLayerMapIdx[2] )) then  UNCHANGED
					else if (LocalCompAssigned( FramePathMats[8] ) .AND. LocalStatus( FramePathMats[8]:RValPerInch ) > 0)
					then	if (LocalStatus( FramePathMats[8]:Thickness ) > 0)
							then  (LocalRef( FramePathMats[8]:Thickness ) * LocalRef( FramePathMats[8]:RValPerInch )) + Local( FrameCodeRValueX )
							else  (Local(                  Thickness[8] ) * LocalRef( FramePathMats[8]:RValPerInch )) + Local( FrameCodeRValueX )  endif
					else if ((IfValidAnd( FrameLayerSymVal[8] = 99000 ) .OR. IfValidAnd( FrameLayerSymVal[8] = 900 )) .AND. IfValidAnd( LayerUsrInpInsRVal[8] > 0 ))
               then               LayerUsrInpInsRVal[8] + FrameCodeRValueX
					else if (IfValidAnd( FrameLayerSymVal[8] > 99000 ) .AND. IfValidAnd( FrameLayerSymVal[8] < 99300 ))
					then         (Local( FrameLayerSymVal[8] ) - 99000) + Local( FrameCodeRValueX )
					else if (IfValidAnd( FrameLayerSymVal[8] < 100 ))
					then          Local( FrameLayerSymVal[8] ) + Local( FrameCodeRValueX )
					else  UNCHANGED  endif endif endif endif endif  }
	"Revise Cons:FrameCodeRValueX-9"	Cons:FrameCodeRValueX  = {
					if (IfValidAnd( FrameLayerSymVal[9] < 0.01 ) .OR. IfValidAnd( LayerPropertyIndex[9] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[9] == FrameLayerMapIdx[2] )) then  UNCHANGED
					else if (LocalCompAssigned( FramePathMats[9] ) .AND. LocalStatus( FramePathMats[9]:RValPerInch ) > 0)
					then	if (LocalStatus( FramePathMats[9]:Thickness ) > 0)
							then  (LocalRef( FramePathMats[9]:Thickness ) * LocalRef( FramePathMats[9]:RValPerInch )) + Local( FrameCodeRValueX )
							else  (Local(                  Thickness[9] ) * LocalRef( FramePathMats[9]:RValPerInch )) + Local( FrameCodeRValueX )  endif
					else if ((IfValidAnd( FrameLayerSymVal[9] = 99000 ) .OR. IfValidAnd( FrameLayerSymVal[9] = 900 )) .AND. IfValidAnd( LayerUsrInpInsRVal[9] > 0 ))
               then               LayerUsrInpInsRVal[9] + FrameCodeRValueX
					else if (IfValidAnd( FrameLayerSymVal[9] > 99000 ) .AND. IfValidAnd( FrameLayerSymVal[9] < 99300 ))
					then         (Local( FrameLayerSymVal[9] ) - 99000) + Local( FrameCodeRValueX )
					else if (IfValidAnd( FrameLayerSymVal[9] < 100 ))
					then          Local( FrameLayerSymVal[9] ) + Local( FrameCodeRValueX )
					else  UNCHANGED  endif endif endif endif endif  }


	; now FrameCodeRValueX is populated w/ entire cons R-val minus frame layer, so set that to Cavity path R-value and then revise each frame & cavity for that individual layer
	"Init Cons:CavityCodeRValueX"		Cons:CavityCodeRValueX = {	Local( FrameCodeRValueX )  }

	"Final Cons:FrameCodeRValueX"		Cons:FrameCodeRValueX  = {
						if (AtcEdg_ConsType > 0)
						then	switch (AtcEdg_ConsType)
									case  1 :	(1.0204 * 12 * (AtcEdg_ClgBlwAtc:AtcEdg_HA											)) + FrameCodeRValueX		; WA
									case  2 :	(1.0204 * 12 * (AtcEdg_ClgBlwAtc:AtcEdg_HB1 + AtcEdg_ClgBlwAtc:AtcEdg_HB3	)) + FrameCodeRValueX		; WB
									default :	(1.0204 *       3.5 ) + Local( FrameCodeRValueX )																; ERROR !!
								endswitch
						else	switch (mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 ))
									case  4 :	(1.0204 *  3.5 ) + Local( FrameCodeRValueX )
									case  6 :	(1.0204 *  5.5 ) + Local( FrameCodeRValueX )
									case  8 :	(1.0204 *  7.25) + Local( FrameCodeRValueX ) 
									case 10 :	(1.0204 *  9.25) + Local( FrameCodeRValueX ) 
									case 12 :	(1.0204 * 11.25) + Local( FrameCodeRValueX ) 
									default :	; ERROR??? - unrecognized framing depth
													(1.0204 * ((mod( ((Local( FrameLayer ) - mod( Local( FrameLayer ), 100 )) / 100), 100 )) - 0.75)) + Local( FrameCodeRValueX )
								endswitch  endif  }
;	"Final Cons:CavityCodeRValue"		Cons:CavityCodeRValue = {	Local( CavityLayer ) + Local( CavityCodeRValue )  }
   ; SAC 5/15/17 - added compressed R-value selections - R-val = (SymVal-mod(SymVal,10))/100  (tic #761)
	"Final Cons:CavityCodeRValueX"		Cons:CavityCodeRValueX = {
         if (AtcEdg_ConsType > 0)
			then	switch (AtcEdg_ConsType)
						case  1 :	((AtcEdg_ClgBlwAtc:AtcEdg_HA											) * 12 * Proj:InsulRValPerInch[1]) + FrameCodeRValueX		; WA
						case  2 :	((AtcEdg_ClgBlwAtc:AtcEdg_HB1 + AtcEdg_ClgBlwAtc:AtcEdg_HB3	) * 12 * Proj:InsulRValPerInch[1]) + FrameCodeRValueX		; WB
						default :	 (3.5 * Proj:InsulRValPerInch[1]) + FrameCodeRValueX																; ERROR !!
					endswitch
			else if (AbvJoistInsLyrMapIdx > 0)
			then	min( (CavityThickness * Proj:InsulRValPerInch[1]), CavityLayerRVal ) + CavityCodeRValueX
			else if (BlwJoistInsLyrMapIdx > 0)
			then	min( (CavityThickness * Proj:InsulRValPerInch[2]), CavityLayerRVal ) + CavityCodeRValueX
			else if (CavityLayer == 100401)
			then	UNCHANGED     ; 3.5" empty cavity - or perhaps add 0.929 to R-value (?)
			else  CavityLayerRVal + CavityCodeRValueX   endif endif endif endif  }

	"Set Cons:FrameCodeUValueX"		Cons:FrameCodeUValueX	= {	if (Local( FrameCodeRValueX  ) < 0.0001) then  0
																						else  1 / Local( FrameCodeRValueX  )  endif  }
	"Set Cons:CavityCodeUValueX"     Cons:CavityCodeUValueX	= {	if (Local( CavityCodeRValueX ) < 0.0001) then  0
																						else  1 / Local( CavityCodeRValueX )  endif  }

	"Set Cons:OverallCodeUValueX based on Parallel Path method"
			Cons:OverallCodeUValueX = {	(Local( FrameCodeUValueX ) * Local( FramingFactor )) + (Local( CavityCodeUValueX ) * (1 - Local( FramingFactor )))  }
END

;*************************************************************************
RULELIST "SetupCons_UValue_SinglePath"         0 0 0 1
;*************************************************************************
 ; Begin calcs of overall cons R-value

	"Init Cons:OutsdAirFilmR & InsdAirFilmR"		Cons:Action  = {	EvalRulelist( "SetupCons_FilmCoefficients", 1 )  }

; SAC 2/27/14 - now initialized in prior rulelist
;	"Init Cons:FrameCodeRValue"		Cons:FrameCodeRValue  = {	0  }

 	; Cons:CavityCodeRValueX should ALREADY be initialized to the outside + inside film coefficients based on surface type (prior to this rulelist being evaluated)
	"Revise Cons:CavityCodeRValueX-1"	Cons:CavityCodeRValueX  = {
					if (IfValidAnd( CavityLayerSymVal[1] < 0.01 ) .OR. IfValidAnd( LayerPropertyIndex[1] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[1] == FrameLayerMapIdx[2] )) then  UNCHANGED
					else if (LocalCompAssigned( CavityPathMats[1] ) .AND. LocalStatus( CavityPathMats[1]:RValPerInch ) > 0)
					then	if (LocalStatus( CavityPathMats[1]:Thickness ) > 0)
							then  (LocalRef( CavityPathMats[1]:Thickness ) * LocalRef( CavityPathMats[1]:RValPerInch )) + Local( CavityCodeRValueX )
							else  (Local(                   Thickness[1] ) * LocalRef( CavityPathMats[1]:RValPerInch )) + Local( CavityCodeRValueX )  endif
					else if ((IfValidAnd( CavityLayerSymVal[1] = 99000 ) .OR. IfValidAnd( CavityLayerSymVal[1] = 900 )) .AND. IfValidAnd( LayerUsrInpInsRVal[1] > 0 ))
               then                LayerUsrInpInsRVal[1] + CavityCodeRValueX
					else if (IfValidAnd( CavityLayerSymVal[1] > 99000 ) .AND. IfValidAnd( CavityLayerSymVal[1] < 99300 ))
					then         (Local( CavityLayerSymVal[1] ) - 99000) + Local( CavityCodeRValueX )
					else if (IfValidAnd( CavityLayerSymVal[1] < 100))
					then          Local( CavityLayerSymVal[1] ) + Local( CavityCodeRValueX )
					else  UNCHANGED  endif endif endif endif endif  }
	"Revise Cons:CavityCodeRValueX-2"	Cons:CavityCodeRValueX  = {
					if (IfValidAnd( CavityLayerSymVal[2] < 0.01 ) .OR. IfValidAnd( LayerPropertyIndex[2] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[2] == FrameLayerMapIdx[2] )) then  UNCHANGED
					else if (LocalCompAssigned( CavityPathMats[2] ) .AND. LocalStatus( CavityPathMats[2]:RValPerInch ) > 0)
					then	if (LocalStatus( CavityPathMats[2]:Thickness ) > 0)
							then  (LocalRef( CavityPathMats[2]:Thickness ) * LocalRef( CavityPathMats[2]:RValPerInch )) + Local( CavityCodeRValueX )
							else  (Local(                   Thickness[2] ) * LocalRef( CavityPathMats[2]:RValPerInch )) + Local( CavityCodeRValueX )  endif
					else if ((IfValidAnd( CavityLayerSymVal[2] = 99000 ) .OR. IfValidAnd( CavityLayerSymVal[2] = 900 )) .AND. IfValidAnd( LayerUsrInpInsRVal[2] > 0 ))
               then                LayerUsrInpInsRVal[2] + CavityCodeRValueX
					else if (IfValidAnd( CavityLayerSymVal[2] > 99000 ) .AND. IfValidAnd( CavityLayerSymVal[2] < 99300 ))
					then         (Local( CavityLayerSymVal[2] ) - 99000) + Local( CavityCodeRValueX )
					else if (IfValidAnd( CavityLayerSymVal[2] < 100 ))
					then          Local( CavityLayerSymVal[2] ) + Local( CavityCodeRValueX )
					else  UNCHANGED  endif endif endif endif endif  }
	"Revise Cons:CavityCodeRValueX-3"	Cons:CavityCodeRValueX  = {
					if (IfValidAnd( CavityLayerSymVal[3] < 0.01 ) .OR. IfValidAnd( LayerPropertyIndex[3] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[3] == FrameLayerMapIdx[2] )) then  UNCHANGED
					else if (LocalCompAssigned( CavityPathMats[3] ) .AND. LocalStatus( CavityPathMats[3]:RValPerInch ) > 0)
					then	if (LocalStatus( CavityPathMats[3]:Thickness ) > 0)
							then  (LocalRef( CavityPathMats[3]:Thickness ) * LocalRef( CavityPathMats[3]:RValPerInch )) + Local( CavityCodeRValueX )
							else  (Local(                   Thickness[3] ) * LocalRef( CavityPathMats[3]:RValPerInch )) + Local( CavityCodeRValueX )  endif
					else if ((IfValidAnd( CavityLayerSymVal[3] = 99000 ) .OR. IfValidAnd( CavityLayerSymVal[3] = 900 )) .AND. IfValidAnd( LayerUsrInpInsRVal[3] > 0 ))
               then                LayerUsrInpInsRVal[3] + CavityCodeRValueX
					else if (IfValidAnd( CavityLayerSymVal[3] > 99000 ) .AND. IfValidAnd( CavityLayerSymVal[3] < 99300 ))
					then         (Local( CavityLayerSymVal[3] ) - 99000) + Local( CavityCodeRValueX )
					else if (IfValidAnd( CavityLayerSymVal[3] < 100 ))
					then          Local( CavityLayerSymVal[3] ) + Local( CavityCodeRValueX )
					else  UNCHANGED  endif endif endif endif endif  }
	"Revise Cons:CavityCodeRValueX-4"	Cons:CavityCodeRValueX  = {
					if (IfValidAnd( CavityLayerSymVal[4] < 0.01 ) .OR. IfValidAnd( LayerPropertyIndex[4] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[4] == FrameLayerMapIdx[2] )) then  UNCHANGED
					else if (LocalCompAssigned( CavityPathMats[4] ) .AND. LocalStatus( CavityPathMats[4]:RValPerInch ) > 0)
					then	if (LocalStatus( CavityPathMats[4]:Thickness ) > 0)
							then  (LocalRef( CavityPathMats[4]:Thickness ) * LocalRef( CavityPathMats[4]:RValPerInch )) + Local( CavityCodeRValueX )
							else  (Local(                   Thickness[4] ) * LocalRef( CavityPathMats[4]:RValPerInch )) + Local( CavityCodeRValueX )  endif
					else if ((IfValidAnd( CavityLayerSymVal[4] = 99000 ) .OR. IfValidAnd( CavityLayerSymVal[4] = 900 )) .AND. IfValidAnd( LayerUsrInpInsRVal[4] > 0 ))
               then                LayerUsrInpInsRVal[4] + CavityCodeRValueX
					else if (IfValidAnd( CavityLayerSymVal[4] > 99000 ) .AND. IfValidAnd( CavityLayerSymVal[4] < 99300 ))
					then         (Local( CavityLayerSymVal[4] ) - 99000) + Local( CavityCodeRValueX )
					else if (IfValidAnd( CavityLayerSymVal[4] < 100 ))
					then          Local( CavityLayerSymVal[4] ) + Local( CavityCodeRValueX )
					else  UNCHANGED  endif endif endif endif endif  }
	"Revise Cons:CavityCodeRValueX-5"	Cons:CavityCodeRValueX  = {
					if (IfValidAnd( CavityLayerSymVal[5] < 0.01 ) .OR. IfValidAnd( LayerPropertyIndex[5] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[5] == FrameLayerMapIdx[2] )) then  UNCHANGED
					else if (LocalCompAssigned( CavityPathMats[5] ) .AND. LocalStatus( CavityPathMats[5]:RValPerInch ) > 0)
					then	if (LocalStatus( CavityPathMats[5]:Thickness ) > 0)
							then  (LocalRef( CavityPathMats[5]:Thickness ) * LocalRef( CavityPathMats[5]:RValPerInch )) + Local( CavityCodeRValueX )
							else  (Local(                   Thickness[5] ) * LocalRef( CavityPathMats[5]:RValPerInch )) + Local( CavityCodeRValueX )  endif
					else if ((IfValidAnd( CavityLayerSymVal[5] = 99000 ) .OR. IfValidAnd( CavityLayerSymVal[5] = 900 )) .AND. IfValidAnd( LayerUsrInpInsRVal[5] > 0 ))
               then                LayerUsrInpInsRVal[5] + CavityCodeRValueX
					else if (IfValidAnd( CavityLayerSymVal[5] > 99000 ) .AND. IfValidAnd( CavityLayerSymVal[5] < 99300 ))
					then         (Local( CavityLayerSymVal[5] ) - 99000) + Local( CavityCodeRValueX )
					else if (IfValidAnd( CavityLayerSymVal[5] < 100 ))
					then          Local( CavityLayerSymVal[5] ) + Local( CavityCodeRValueX )
					else  UNCHANGED  endif endif endif endif endif  }
	"Revise Cons:CavityCodeRValueX-6"	Cons:CavityCodeRValueX  = {
					if (IfValidAnd( CavityLayerSymVal[6] < 0.01 ) .OR. IfValidAnd( LayerPropertyIndex[6] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[6] == FrameLayerMapIdx[2] )) then  UNCHANGED
					else if (LocalCompAssigned( CavityPathMats[6] ) .AND. LocalStatus( CavityPathMats[6]:RValPerInch ) > 0)
					then	if (LocalStatus( CavityPathMats[6]:Thickness ) > 0)
							then  (LocalRef( CavityPathMats[6]:Thickness ) * LocalRef( CavityPathMats[6]:RValPerInch )) + Local( CavityCodeRValueX )
							else  (Local(                   Thickness[6] ) * LocalRef( CavityPathMats[6]:RValPerInch )) + Local( CavityCodeRValueX )  endif
					else if ((IfValidAnd( CavityLayerSymVal[6] = 99000 ) .OR. IfValidAnd( CavityLayerSymVal[6] = 900 )) .AND. IfValidAnd( LayerUsrInpInsRVal[6] > 0 ))
               then                LayerUsrInpInsRVal[6] + CavityCodeRValueX
					else if (IfValidAnd( CavityLayerSymVal[6] > 99000 ) .AND. IfValidAnd( CavityLayerSymVal[6] < 99300 ))
					then         (Local( CavityLayerSymVal[6] ) - 99000) + Local( CavityCodeRValueX )
					else if (IfValidAnd( CavityLayerSymVal[6] < 100 ))
					then          Local( CavityLayerSymVal[6] ) + Local( CavityCodeRValueX )
					else  UNCHANGED  endif endif endif endif endif  }
	"Revise Cons:CavityCodeRValueX-7"	Cons:CavityCodeRValueX  = {
					if (IfValidAnd( CavityLayerSymVal[7] < 0.01 ) .OR. IfValidAnd( LayerPropertyIndex[7] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[7] == FrameLayerMapIdx[2] )) then  UNCHANGED
					else if (LocalCompAssigned( CavityPathMats[7] ) .AND. LocalStatus( CavityPathMats[7]:RValPerInch ) > 0)
					then	if (LocalStatus( CavityPathMats[7]:Thickness ) > 0)
							then  (LocalRef( CavityPathMats[7]:Thickness ) * LocalRef( CavityPathMats[7]:RValPerInch )) + Local( CavityCodeRValueX )
							else  (Local(                   Thickness[7] ) * LocalRef( CavityPathMats[7]:RValPerInch )) + Local( CavityCodeRValueX )  endif
					else if ((IfValidAnd( CavityLayerSymVal[7] = 99000 ) .OR. IfValidAnd( CavityLayerSymVal[7] = 900 )) .AND. IfValidAnd( LayerUsrInpInsRVal[7] > 0 ))
               then                LayerUsrInpInsRVal[7] + CavityCodeRValueX
					else if (IfValidAnd( CavityLayerSymVal[7] > 99000 ) .AND. IfValidAnd( CavityLayerSymVal[7] < 99300 ))
					then         (Local( CavityLayerSymVal[7] ) - 99000) + Local( CavityCodeRValueX )
					else if (IfValidAnd( CavityLayerSymVal[7] < 100 ))
					then          Local( CavityLayerSymVal[7] ) + Local( CavityCodeRValueX )
					else  UNCHANGED  endif endif endif endif endif  }
	"Revise Cons:CavityCodeRValueX-8"	Cons:CavityCodeRValueX  = {
					if (IfValidAnd( CavityLayerSymVal[8] < 0.01 ) .OR. IfValidAnd( LayerPropertyIndex[8] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[8] == FrameLayerMapIdx[2] )) then  UNCHANGED
					else if (LocalCompAssigned( CavityPathMats[8] ) .AND. LocalStatus( CavityPathMats[8]:RValPerInch ) > 0)
					then	if (LocalStatus( CavityPathMats[8]:Thickness ) > 0)
							then  (LocalRef( CavityPathMats[8]:Thickness ) * LocalRef( CavityPathMats[8]:RValPerInch )) + Local( CavityCodeRValueX )
							else  (Local(                   Thickness[8] ) * LocalRef( CavityPathMats[8]:RValPerInch )) + Local( CavityCodeRValueX )  endif
					else if ((IfValidAnd( CavityLayerSymVal[8] = 99000 ) .OR. IfValidAnd( CavityLayerSymVal[8] = 900 )) .AND. IfValidAnd( LayerUsrInpInsRVal[8] > 0 ))
               then                LayerUsrInpInsRVal[8] + CavityCodeRValueX
					else if (IfValidAnd( CavityLayerSymVal[8] > 99000 ) .AND. IfValidAnd( CavityLayerSymVal[8] < 99300 ))
					then         (Local( CavityLayerSymVal[8] ) - 99000) + Local( CavityCodeRValueX )
					else if (IfValidAnd( CavityLayerSymVal[8] < 100 ))
					then          Local( CavityLayerSymVal[8] ) + Local( CavityCodeRValueX )
					else  UNCHANGED  endif endif endif endif endif  }
	"Revise Cons:CavityCodeRValueX-9"	Cons:CavityCodeRValueX  = {
					if (IfValidAnd( CavityLayerSymVal[9] < 0.01 ) .OR. IfValidAnd( LayerPropertyIndex[9] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[9] == FrameLayerMapIdx[2] )) then  UNCHANGED
					else if (LocalCompAssigned( CavityPathMats[9] ) .AND. LocalStatus( CavityPathMats[9]:RValPerInch ) > 0)
					then	if (LocalStatus( CavityPathMats[9]:Thickness ) > 0)
							then  (LocalRef( CavityPathMats[9]:Thickness ) * LocalRef( CavityPathMats[9]:RValPerInch )) + Local( CavityCodeRValueX )
							else  (Local(                   Thickness[9] ) * LocalRef( CavityPathMats[9]:RValPerInch )) + Local( CavityCodeRValueX )  endif
					else if ((IfValidAnd( CavityLayerSymVal[9] = 99000 ) .OR. IfValidAnd( CavityLayerSymVal[9] = 900 )) .AND. IfValidAnd( LayerUsrInpInsRVal[9] > 0 ))
               then                LayerUsrInpInsRVal[9] + CavityCodeRValueX
					else if (IfValidAnd( CavityLayerSymVal[9] > 99000 ) .AND. IfValidAnd( CavityLayerSymVal[9] < 99300 ))
					then         (Local( CavityLayerSymVal[9] ) - 99000) + Local( CavityCodeRValueX )
					else if (IfValidAnd( CavityLayerSymVal[9] < 100 ))
					then          Local( CavityLayerSymVal[9] ) + Local( CavityCodeRValueX )
					else  UNCHANGED  endif endif endif endif endif  }


;	"Final Cons:CavityCodeRValueX"		Cons:CavityCodeRValueX = {	if (AbvJoistInsLyrMapIdx > 0)
;																					then	UNCHANGED   ; ??? min( (CavityThickness * Proj:InsulRValPerInch), CavityLayer ) + CavityCodeRValueX
;																					else if (CavityLayer == 100401)
;																					then	UNCHANGED     ; 3.5" empty cavity - or perhaps add 0.929 to R-value (?)
;																					else  CavityLayer + CavityCodeRValueX   endif endif endif  }

	"Set Cons:FrameCodeUValueX"		Cons:FrameCodeUValueX	= {	0  }
	"Set Cons:CavityCodeUValueX"     Cons:CavityCodeUValueX 	= {	if (Local( CavityCodeRValueX ) < 0.0001) then  0
																						else  1 / Local( CavityCodeRValueX )  endif  }

	"Set Cons:OverallCodeUValueX (equal to CavityUValue)"
			Cons:OverallCodeUValueX = {	Local( CavityCodeUValueX )  }

END

;*************************************************************************
RULELIST "SetupCons_none"         0 0 0 1
;*************************************************************************

; initialize material layers here - overall, frame & cavity R-values already initialized
	"Set Cons:FramingFactor"			Cons:FramingFactor	= {	0  }
	"Set Cons:NumPaths"					Cons:NumPaths			= {	0  }
	"Set Cons:PathFraction[1]"			Cons:PathFraction[1]	= {	0  }		; SAC 3/17/14
	"Set Cons:PathFraction[2]"			Cons:PathFraction[2]	= {	0  }

END


;*************************************************************************
RULELIST "SetupCons_UValue_All"    1 0 0 0
;*************************************************************************

	"Create materials to model insulation in construction cavities"
		Cons:Action	= {	EvalRulelist( "CreateConsCavityInsulMat_All", 1 )  }
; SAC 3/6/14 - to be REMOVED
; "store BEMProc details"		Proj:Action = {  StoreBEMProc( "Aftr MatCr8 call", 0 )  }
; "debug"		Proj:Action	= {	MessageBox( "Post-MatCr8 input details stored" )  }

	"Delete unnecessary Cons:LayerParameters[1]"		Cons:LayerParameters[1]	= {
		if (LocalCompAssigned( Cons:LayerParameters[1] ) .AND. (IfValidAnd( LayerPropertyIndex[1] > 0 )==0 .OR. (IfValidAnd( LayerPropertyIndex[1] == FrameLayerMapIdx[1] )==0 .AND. IfValidAnd( LayerPropertyIndex[1] == FrameLayerMapIdx[2] )==0))) then  DeleteComp()  else  UNCHANGED  endif  }
	"Create needed Cons:LayerParameters[1]"	Cons:LayerParameters[1]	= {
		if (LocalCompAssigned( Cons:LayerParameters[1] ) == 0 .AND. IfValidAnd( LayerPropertyIndex[1] > 0 ) .AND. (IfValidAnd( LayerPropertyIndex[1] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[1] == FrameLayerMapIdx[2] ))) then  CreateComp( LayerParams, Format( "%s - LyrPrm-1", Name ) )  else  UNCHANGED  endif  }
	"Set Cons:LayerParameters[1]:SourceCons"		Cons:LayerParameters[1]:SourceCons	= {	Name  }
	"Set Cons:LayerParameters[1]:LayerIndex"		Cons:LayerParameters[1]:LayerIndex	= {	1  }

	"Delete unnecessary Cons:LayerParameters[2]"		Cons:LayerParameters[2]	= {
		if (LocalCompAssigned( Cons:LayerParameters[2] ) .AND. (IfValidAnd( LayerPropertyIndex[2] > 0 )==0 .OR. (IfValidAnd( LayerPropertyIndex[2] == FrameLayerMapIdx[1] )==0 .AND. IfValidAnd( LayerPropertyIndex[2] == FrameLayerMapIdx[2] )==0))) then  DeleteComp()  else  UNCHANGED  endif  }
	"Create needed Cons:LayerParameters[2]"	Cons:LayerParameters[2]	= {
		if (LocalCompAssigned( Cons:LayerParameters[2] ) == 0 .AND. IfValidAnd( LayerPropertyIndex[2] > 0 ) .AND. (IfValidAnd( LayerPropertyIndex[2] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[2] == FrameLayerMapIdx[2] ))) then  CreateComp( LayerParams, Format( "%s - LyrPrm-2", Name ) )  else  UNCHANGED  endif  }
	"Set Cons:LayerParameters[2]:SourceCons"		Cons:LayerParameters[2]:SourceCons	= {	Name  }
	"Set Cons:LayerParameters[2]:LayerIndex"		Cons:LayerParameters[2]:LayerIndex	= {	2  }

	"Delete unnecessary Cons:LayerParameters[3]"		Cons:LayerParameters[3]	= {
		if (LocalCompAssigned( Cons:LayerParameters[3] ) .AND. (IfValidAnd( LayerPropertyIndex[3] > 0 )==0 .OR. (IfValidAnd( LayerPropertyIndex[3] == FrameLayerMapIdx[1] )==0 .AND. IfValidAnd( LayerPropertyIndex[3] == FrameLayerMapIdx[2] )==0))) then  DeleteComp()  else  UNCHANGED  endif  }
	"Create needed Cons:LayerParameters[3]"	Cons:LayerParameters[3]	= {
		if (LocalCompAssigned( Cons:LayerParameters[3] ) == 0 .AND. IfValidAnd( LayerPropertyIndex[3] > 0 ) .AND. (IfValidAnd( LayerPropertyIndex[3] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[3] == FrameLayerMapIdx[2] ))) then  CreateComp( LayerParams, Format( "%s - LyrPrm-3", Name ) )  else  UNCHANGED  endif  }
	"Set Cons:LayerParameters[3]:SourceCons"		Cons:LayerParameters[3]:SourceCons	= {	Name  }
	"Set Cons:LayerParameters[3]:LayerIndex"		Cons:LayerParameters[3]:LayerIndex	= {	3  }

	"Delete unnecessary Cons:LayerParameters[4]"		Cons:LayerParameters[4]	= {
		if (LocalCompAssigned( Cons:LayerParameters[4] ) .AND. (IfValidAnd( LayerPropertyIndex[4] > 0 )==0 .OR. (IfValidAnd( LayerPropertyIndex[4] == FrameLayerMapIdx[1] )==0 .AND. IfValidAnd( LayerPropertyIndex[4] == FrameLayerMapIdx[2] )==0))) then  DeleteComp()  else  UNCHANGED  endif  }
	"Create needed Cons:LayerParameters[4]"	Cons:LayerParameters[4]	= {
		if (LocalCompAssigned( Cons:LayerParameters[4] ) == 0 .AND. IfValidAnd( LayerPropertyIndex[4] > 0 ) .AND. (IfValidAnd( LayerPropertyIndex[4] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[4] == FrameLayerMapIdx[2] ))) then  CreateComp( LayerParams, Format( "%s - LyrPrm-4", Name ) )  else  UNCHANGED  endif  }
	"Set Cons:LayerParameters[4]:SourceCons"		Cons:LayerParameters[4]:SourceCons	= {	Name  }
	"Set Cons:LayerParameters[4]:LayerIndex"		Cons:LayerParameters[4]:LayerIndex	= {	4  }

	"Delete unnecessary Cons:LayerParameters[5]"		Cons:LayerParameters[5]	= {
		if (LocalCompAssigned( Cons:LayerParameters[5] ) .AND. (IfValidAnd( LayerPropertyIndex[5] > 0 )==0 .OR. (IfValidAnd( LayerPropertyIndex[5] == FrameLayerMapIdx[1] )==0 .AND. IfValidAnd( LayerPropertyIndex[5] == FrameLayerMapIdx[2] )==0))) then  DeleteComp()  else  UNCHANGED  endif  }
	"Create needed Cons:LayerParameters[5]"	Cons:LayerParameters[5]	= {
		if (LocalCompAssigned( Cons:LayerParameters[5] ) == 0 .AND. IfValidAnd( LayerPropertyIndex[5] > 0 ) .AND. (IfValidAnd( LayerPropertyIndex[5] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[5] == FrameLayerMapIdx[2] ))) then  CreateComp( LayerParams, Format( "%s - LyrPrm-5", Name ) )  else  UNCHANGED  endif  }
	"Set Cons:LayerParameters[5]:SourceCons"		Cons:LayerParameters[5]:SourceCons	= {	Name  }
	"Set Cons:LayerParameters[5]:LayerIndex"		Cons:LayerParameters[5]:LayerIndex	= {	5  }

	"Delete unnecessary Cons:LayerParameters[6]"		Cons:LayerParameters[6]	= {
		if (LocalCompAssigned( Cons:LayerParameters[6] ) .AND. (IfValidAnd( LayerPropertyIndex[6] > 0 )==0 .OR. (IfValidAnd( LayerPropertyIndex[6] == FrameLayerMapIdx[1] )==0 .AND. IfValidAnd( LayerPropertyIndex[6] == FrameLayerMapIdx[2] )==0))) then  DeleteComp()  else  UNCHANGED  endif  }
	"Create needed Cons:LayerParameters[6]"	Cons:LayerParameters[6]	= {
		if (LocalCompAssigned( Cons:LayerParameters[6] ) == 0 .AND. IfValidAnd( LayerPropertyIndex[6] > 0 ) .AND. (IfValidAnd( LayerPropertyIndex[6] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[6] == FrameLayerMapIdx[2] ))) then  CreateComp( LayerParams, Format( "%s - LyrPrm-6", Name ) )  else  UNCHANGED  endif  }
	"Set Cons:LayerParameters[6]:SourceCons"		Cons:LayerParameters[6]:SourceCons	= {	Name  }
	"Set Cons:LayerParameters[6]:LayerIndex"		Cons:LayerParameters[6]:LayerIndex	= {	6  }

	"Delete unnecessary Cons:LayerParameters[7]"		Cons:LayerParameters[7]	= {
		if (LocalCompAssigned( Cons:LayerParameters[7] ) .AND. (IfValidAnd( LayerPropertyIndex[7] > 0 )==0 .OR. (IfValidAnd( LayerPropertyIndex[7] == FrameLayerMapIdx[1] )==0 .AND. IfValidAnd( LayerPropertyIndex[7] == FrameLayerMapIdx[2] )==0))) then  DeleteComp()  else  UNCHANGED  endif  }
	"Create needed Cons:LayerParameters[7]"	Cons:LayerParameters[7]	= {
		if (LocalCompAssigned( Cons:LayerParameters[7] ) == 0 .AND. IfValidAnd( LayerPropertyIndex[7] > 0 ) .AND. (IfValidAnd( LayerPropertyIndex[7] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[7] == FrameLayerMapIdx[2] ))) then  CreateComp( LayerParams, Format( "%s - LyrPrm-7", Name ) )  else  UNCHANGED  endif  }
	"Set Cons:LayerParameters[7]:SourceCons"		Cons:LayerParameters[7]:SourceCons	= {	Name  }
	"Set Cons:LayerParameters[7]:LayerIndex"		Cons:LayerParameters[7]:LayerIndex	= {	7  }

	"Delete unnecessary Cons:LayerParameters[8]"		Cons:LayerParameters[8]	= {
		if (LocalCompAssigned( Cons:LayerParameters[8] ) .AND. (IfValidAnd( LayerPropertyIndex[8] > 0 )==0 .OR. (IfValidAnd( LayerPropertyIndex[8] == FrameLayerMapIdx[1] )==0 .AND. IfValidAnd( LayerPropertyIndex[8] == FrameLayerMapIdx[2] )==0))) then  DeleteComp()  else  UNCHANGED  endif  }
	"Create needed Cons:LayerParameters[8]"	Cons:LayerParameters[8]	= {
		if (LocalCompAssigned( Cons:LayerParameters[8] ) == 0 .AND. IfValidAnd( LayerPropertyIndex[8] > 0 ) .AND. (IfValidAnd( LayerPropertyIndex[8] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[8] == FrameLayerMapIdx[2] ))) then  CreateComp( LayerParams, Format( "%s - LyrPrm-8", Name ) )  else  UNCHANGED  endif  }
	"Set Cons:LayerParameters[8]:SourceCons"		Cons:LayerParameters[8]:SourceCons	= {	Name  }
	"Set Cons:LayerParameters[8]:LayerIndex"		Cons:LayerParameters[8]:LayerIndex	= {	8  }

	"Delete unnecessary Cons:LayerParameters[9]"		Cons:LayerParameters[9]	= {
		if (LocalCompAssigned( Cons:LayerParameters[9] ) .AND. (IfValidAnd( LayerPropertyIndex[9] > 0 )==0 .OR. (IfValidAnd( LayerPropertyIndex[9] == FrameLayerMapIdx[1] )==0 .AND. IfValidAnd( LayerPropertyIndex[9] == FrameLayerMapIdx[2] )==0))) then  DeleteComp()  else  UNCHANGED  endif  }
	"Create needed Cons:LayerParameters[9]"	Cons:LayerParameters[9]	= {
		if (LocalCompAssigned( Cons:LayerParameters[9] ) == 0 .AND. IfValidAnd( LayerPropertyIndex[9] > 0 ) .AND. (IfValidAnd( LayerPropertyIndex[9] == FrameLayerMapIdx[1] ) .OR. IfValidAnd( LayerPropertyIndex[9] == FrameLayerMapIdx[2] ))) then  CreateComp( LayerParams, Format( "%s - LyrPrm-9", Name ) )  else  UNCHANGED  endif  }
	"Set Cons:LayerParameters[9]:SourceCons"		Cons:LayerParameters[9]:SourceCons	= {	Name  }
	"Set Cons:LayerParameters[9]:LayerIndex"		Cons:LayerParameters[9]:LayerIndex	= {	9  }


	"Set remaining LayerParams properties"
		LayerParams:Action	= {	EvalRulelist( "SetupCons_LayerParams", 1 )  }


; "debug"		Proj:Action	= {	MessageBox( "Number of LayerParams objects @ end of 'SetupCons_UValue_All' rulelist = %.0f", ComponentCount( LayerParams ) )  }

; SAC 3/17/14 - to be REMOVED
; "store BEMProc details"		Proj:Action = {  StoreBEMProc( "Before ConsUFactorRes call", 0 )  }
; "debug"		Proj:Action	= {	MessageBox( "About to call ConsUFactorRes()" )  }

    "Set Cons::OverallCodeUValue using ConsUFactorRes"
		Cons:OverallCodeUValue = {	ConsUFactorRes( 0) }

; SAC 3/17/14 - to be REMOVED
; "store BEMProc details"		Proj:Action = {  StoreBEMProc( "After ConsUFactorRes call", 0 )  }
; "debug"		Proj:Action	= {	MessageBox( "Back from ConsUFactorRes() call" )  }


	"Set Cons:WinterDesUValue"		Cons:WinterDesUValue = {	if (IfValidAnd( OverallCodeUValue > 0.00001 )) then  OverallCodeUValue  else  UNDEFINED  endif  }
;	"debug ExtWall Cons"				ExtWAll:Action = { if (ParentType == 1 .AND. IsAltered) then PostWarning( "ExtWall Cons after ConsUFactorRes call: '%s' OverallCodeUValue = %g", Construction:Name, Construction:OverallCodeUValue) else UNCHANGED endif }

   ; SAC 1/17/18 - updated labels (tic #963)
	"Set Cons:CodeUValueLabel"		Cons:CodeUValueLabel	= {	if (LocalStatus( CodeMaximumUValue ) < 1 .OR. LocalStatus( OverallCodeUValue ) < 1 .OR.
																						IfValidAnd( CodeMaximumUValue <= 0 )) then  " "    ; no message - nothing to report
																				else if (CodeMaximumUValue < OverallCodeUValue)
																				then  Format( "(doesn't meet prescriptive %.3f U-factor reqmnt. (%.3f))", CodeMaximumUValue, OverallCodeUValue )
																				else  Format( "(meets prescriptive %.3f U-factor reqmnt. (%.3f))",        CodeMaximumUValue, OverallCodeUValue )
																				endif endif  }
															; was:			then  Format( "(doesn't meet max code %.3f U-value (%.3f))", CodeMaximumUValue, OverallCodeUValue )
															;					else  Format( "(meets max code %.3f U-value (%.3f))",        CodeMaximumUValue, OverallCodeUValue )
END

;*************************************************************************
RULELIST "SetupCons_LayerParams"    1 0 0 0
;*************************************************************************

	;	LayerParams:Type,  0
	;	             0,    "- no action required -" 
	;	             1,    "Wood Framed Layer" 
	;	             2,    "Steel Framed Layer" 
	;	            11,    "Wood Furring Layer" 
	;	            12,    "Steel Furring Layer" 
	;	            13,    "EIFS Furring Layer"     - REMOVED

	"Set LayerParams:Type - round 1"		LayerParams:Type	= {
				if (LocalCompAssigned( SourceCons ) == 0) then  0
				else	switch ( SourceCons:Type )
						; Ext/Int/Undgr Walls
							case   0 :  1		; "Wood Framed Wall"         -> "Wood Framed Layer"
							case   1 :  2		; "Steel Framed Wall"  		  -> "Steel Framed Layer"
							case   2 : 11 		; "Concrete / ICF / Brick"	  -> using 11 as PLACEHOLDER - requires further logic below
							case   3 : 11 		; "Hollow Unit Masonry"		
							case   4 : 11 		; "Adobe / Strawbale / Log"	
							case   5 :  1		; "SIPS Wall"
						; Attic Roof / Cath Clg / Clg below attic / Int Clg
							case  10 :  1		; "Wood Framed Ceiling"    -> "Wood Framed Layer"
							case  11 : 11 		; "Built-up Roof"  
							case  12 :  2		; "Steel Framed Ceiling"   -> "Steel Framed Layer"
							case  13 :  1		; "SIPS Ceiling" 		  
						; Int/Ext Flrs / Flr over Crawl
							case  20 :  1		; "Wood Framed Floor"      -> "Wood Framed Layer"
							case  23 :  2		; "Steel Framed Floor"	 	-> "Steel Framed Layer"
							case  24 :  1		; "SIPS Floor"
							default  :  0
						endswitch  endif  }
	"Set LayerParams:Type - round 2"		LayerParams:Type	= {
				if (IfValidAnd( Type == 11 ) == 0) then  UNCHANGED
				else	switch (LayerIndex)
							case  1 :	if (IfValidAnd( SourceCons:FrameLayerSymVal[1] > 10000 ) .AND. IfValidAnd( SourceCons:FrameLayerSymVal[1] < 40000 )) then  10 + int( SourceCons:FrameLayerSymVal[1] / 10000 )  else  0  endif
							case  2 :	if (IfValidAnd( SourceCons:FrameLayerSymVal[2] > 10000 ) .AND. IfValidAnd( SourceCons:FrameLayerSymVal[2] < 40000 )) then  10 + int( SourceCons:FrameLayerSymVal[2] / 10000 )  else  0  endif
							case  3 :	if (IfValidAnd( SourceCons:FrameLayerSymVal[3] > 10000 ) .AND. IfValidAnd( SourceCons:FrameLayerSymVal[3] < 40000 )) then  10 + int( SourceCons:FrameLayerSymVal[3] / 10000 )  else  0  endif
							case  4 :	if (IfValidAnd( SourceCons:FrameLayerSymVal[4] > 10000 ) .AND. IfValidAnd( SourceCons:FrameLayerSymVal[4] < 40000 )) then  10 + int( SourceCons:FrameLayerSymVal[4] / 10000 )  else  0  endif
							case  5 :	if (IfValidAnd( SourceCons:FrameLayerSymVal[5] > 10000 ) .AND. IfValidAnd( SourceCons:FrameLayerSymVal[5] < 40000 )) then  10 + int( SourceCons:FrameLayerSymVal[5] / 10000 )  else  0  endif
							case  6 :	if (IfValidAnd( SourceCons:FrameLayerSymVal[6] > 10000 ) .AND. IfValidAnd( SourceCons:FrameLayerSymVal[6] < 40000 )) then  10 + int( SourceCons:FrameLayerSymVal[6] / 10000 )  else  0  endif
							case  7 :	if (IfValidAnd( SourceCons:FrameLayerSymVal[7] > 10000 ) .AND. IfValidAnd( SourceCons:FrameLayerSymVal[7] < 40000 )) then  10 + int( SourceCons:FrameLayerSymVal[7] / 10000 )  else  0  endif
							case  8 :	if (IfValidAnd( SourceCons:FrameLayerSymVal[8] > 10000 ) .AND. IfValidAnd( SourceCons:FrameLayerSymVal[8] < 40000 )) then  10 + int( SourceCons:FrameLayerSymVal[8] / 10000 )  else  0  endif
							case  9 :	if (IfValidAnd( SourceCons:FrameLayerSymVal[9] > 10000 ) .AND. IfValidAnd( SourceCons:FrameLayerSymVal[9] < 40000 )) then  10 + int( SourceCons:FrameLayerSymVal[9] / 10000 )  else  0  endif
							default :	0
						endswitch  endif  }

	"Set LayerParams:FrameSpacing"		LayerParams:FrameSpacing	= {
				if (IfValidAnd( Type != 0 ) == 0) then  UNDEFINED
				else if (Type < 11)			; wood or steel framing
				then	switch (LayerIndex)
							case  1 :	if (IfValidAnd( SourceCons:FrameLayerSymVal[1] > 0 )) then  mod( SourceCons:FrameLayerSymVal[1], 100 )  else  UNDEFINED  endif
							case  2 :	if (IfValidAnd( SourceCons:FrameLayerSymVal[2] > 0 )) then  mod( SourceCons:FrameLayerSymVal[2], 100 )  else  UNDEFINED  endif
							case  3 :	if (IfValidAnd( SourceCons:FrameLayerSymVal[3] > 0 )) then  mod( SourceCons:FrameLayerSymVal[3], 100 )  else  UNDEFINED  endif
							case  4 :	if (IfValidAnd( SourceCons:FrameLayerSymVal[4] > 0 )) then  mod( SourceCons:FrameLayerSymVal[4], 100 )  else  UNDEFINED  endif
							case  5 :	if (IfValidAnd( SourceCons:FrameLayerSymVal[5] > 0 )) then  mod( SourceCons:FrameLayerSymVal[5], 100 )  else  UNDEFINED  endif
							case  6 :	if (IfValidAnd( SourceCons:FrameLayerSymVal[6] > 0 )) then  mod( SourceCons:FrameLayerSymVal[6], 100 )  else  UNDEFINED  endif
							case  7 :	if (IfValidAnd( SourceCons:FrameLayerSymVal[7] > 0 )) then  mod( SourceCons:FrameLayerSymVal[7], 100 )  else  UNDEFINED  endif
							case  8 :	if (IfValidAnd( SourceCons:FrameLayerSymVal[8] > 0 )) then  mod( SourceCons:FrameLayerSymVal[8], 100 )  else  UNDEFINED  endif
							case  9 :	if (IfValidAnd( SourceCons:FrameLayerSymVal[9] > 0 )) then  mod( SourceCons:FrameLayerSymVal[9], 100 )  else  UNDEFINED  endif
							default :	UNDEFINED
						endswitch
				else if (Type < 13)			; wood or steel furring
				then	24							;  - for now, assume 24" spacing for ALL furring
				else if (Type == 13)			; EIFS furring
				then	UNDEFINED				; ???
				else	UNDEFINED  endif endif endif endif  }

	"Set LayerParams:FrameWebWidth"			LayerParams:FrameWebWidth		= {
				if (IfValidAnd( Type != 0 ) == 0) then  UNDEFINED
				else if (Type == 1 .OR. Type == 11) then  1.5			; wood
				else if (Type == 2 .OR. Type == 12) then  0.038			; steel
				else  UNDEFINED  endif endif endif  }

	"Set LayerParams:FrameFlangeWidth"		LayerParams:FrameFlangeWidth		= {
				if (IfValidAnd( Type != 0 ) == 0) then  UNDEFINED
				else if (Type == 1 .OR. Type == 11) then  1.5			; wood
				else if (Type == 2 .OR. Type == 12) then  1.5			; steel
				else  UNDEFINED  endif endif endif  }

;	"Set LayerParams:FrameWidth - round 1"		LayerParams:FrameWidth		= {
;				if (IfValidAnd( Type != 0 ) == 0) then  UNDEFINED
;				else if (Type < 11)			; wood or steel framing
;				then	switch (LayerIndex)
;							case  1 :	if (IfValidAnd( SourceCons:FrameLayerSymVal[1] > 0 )) then  int( SourceCons:FrameLayerSymVal[1] / 100 )  else  UNDEFINED  endif
;							case  2 :	if (IfValidAnd( SourceCons:FrameLayerSymVal[2] > 0 )) then  int( SourceCons:FrameLayerSymVal[2] / 100 )  else  UNDEFINED  endif
;							case  3 :	if (IfValidAnd( SourceCons:FrameLayerSymVal[3] > 0 )) then  int( SourceCons:FrameLayerSymVal[3] / 100 )  else  UNDEFINED  endif
;							case  4 :	if (IfValidAnd( SourceCons:FrameLayerSymVal[4] > 0 )) then  int( SourceCons:FrameLayerSymVal[4] / 100 )  else  UNDEFINED  endif
;							case  5 :	if (IfValidAnd( SourceCons:FrameLayerSymVal[5] > 0 )) then  int( SourceCons:FrameLayerSymVal[5] / 100 )  else  UNDEFINED  endif
;							case  6 :	if (IfValidAnd( SourceCons:FrameLayerSymVal[6] > 0 )) then  int( SourceCons:FrameLayerSymVal[6] / 100 )  else  UNDEFINED  endif
;							case  7 :	if (IfValidAnd( SourceCons:FrameLayerSymVal[7] > 0 )) then  int( SourceCons:FrameLayerSymVal[7] / 100 )  else  UNDEFINED  endif
;							case  8 :	if (IfValidAnd( SourceCons:FrameLayerSymVal[8] > 0 )) then  int( SourceCons:FrameLayerSymVal[8] / 100 )  else  UNDEFINED  endif
;							case  9 :	if (IfValidAnd( SourceCons:FrameLayerSymVal[9] > 0 )) then  int( SourceCons:FrameLayerSymVal[9] / 100 )  else  UNDEFINED  endif
;							default :	UNDEFINED
;						endswitch
;				else if (Type == 11) then  1.5			; wood furring
;				else if (Type == 12) then  0.038			; wood or steel furring
;				else if (Type == 13)	then  UNDEFINED	; EIFS furring - ?????
;				else	UNDEFINED  endif endif endif endif endif  }
;	"Set LayerParams:FrameWidth - round 2"		LayerParams:FrameWidth		= {		; adjust frame widths:  4" -> 3.5" ... 12" -> 11.25" ...
;				if (IfValidAnd( Type != 0 ) == 0 .OR. LocalStatus( FrameWidth ) < 1) then  UNCHANGED
;				else if (Type < 11)			; wood or steel framing
;				then	if (FrameWidth < 8)
;						then  FrameWidth - 0.50
;						else  FrameWidth - 0.75
;						endif
;				else  UNCHANGED  endif endif  }

	"Set LayerParams:FrameWeight"		LayerParams:FrameWeight		= {	     if (Type == 1 .OR. Type == 11) then  0		; Wood framing/furring -> derive weight
																							else if (Type == 2 .OR. Type == 12) then  1		; approximation for steel
																							else if (Type == 13) then  0							; EIFS Furring -> ?????
																							else  UNDEFINED  endif endif endif  }

;	"Set LayerParams:FrameFactor"		LayerParams:FrameFactor		= {	if (	IfValidAnd( SourceCons:FrmFctrCanBeInput > 0.5 ) .AND. IfValidAnd( SourceCons:SpecifyFrmFctr > 0.5 ) .AND.
;																									IfValidAnd( SourceCons:FramingFactor > 0 ) ) then  SourceCons:FramingFactor  else  UNDEFINED  endif  }

	"Set LayerParams:FKnockOut"		LayerParams:FKnockOut		= {	0  }

END
;*************************************************************************

;*************************************************************************
RULELIST "ForceDefault_Cons_FrameLayer"    1 0 0 0
	; SAC 5/11/16 - blast Cons:FrameLayer when the existing selection is invalid (for non-wood framed Cons:Types)
	"Blast Cons:FrameLayer"		Cons:FrameLayer	= {	UNDEFINED  }
END
;*************************************************************************

;*************************************************************************  - SAC 6/21/17 - override SIPS surfaces w/ lower cavity R-values than we currently support
RULELIST "ForceDefault_SIPSWall_Cons_CavityLayer"    1 0 0 0
   "Post warning to log when resetting SIPS wall cavity layer"    Cons:Action  = {
         if (CavityLayer == 100401)
         then  PostWarning( "Cavity layer of 'no insulation' for wall Construction '%s' being reset due to minimnum required SIPS insulation of R-14", Name )
         else  PostWarning( "Cavity layer of R-%g for wall Construction '%s' being reset due to minimnum required SIPS insulation of R-14", CavityLayer, Name )
         endif  }
   "Blast Cons:CavityLayer"      Cons:CavityLayer  = {  UNDEFINED  }
END
;*************************************************************************  - SAC 6/21/17 - override SIPS surfaces w/ lower cavity R-values than we currently support
RULELIST "ForceDefault_SIPSCeiling_Cons_CavityLayer"    1 0 0 0
   "Post warning to log when resetting SIPS ceiling cavity layer"    Cons:Action  = {
         if (CavityLayer < 1)
         then  PostWarning( "Cavity layer of 'no insulation' for ceiling Construction '%s' being reset due to minimnum required SIPS insulation of R-14", Name )
         else  PostWarning( "Cavity layer of R-%g for ceiling Construction '%s' being reset due to minimnum required SIPS insulation of R-14", CavityLayer, Name )
         endif  }
   "Blast Cons:CavityLayer"      Cons:CavityLayer  = {  UNDEFINED  }
END
;*************************************************************************  - SAC 6/21/17 - override SIPS surfaces w/ lower cavity R-values than we currently support
RULELIST "ForceDefault_SIPSFloor_Cons_CavityLayer"    1 0 0 0
   "Post warning to log when resetting SIPS floor cavity layer"    Cons:Action  = {
         if (CavityLayer < 1)
         then  PostWarning( "Cavity layer of 'no insulation' for floor Construction '%s' being reset due to minimnum required SIPS insulation of R-14", Name )
         else  PostWarning( "Cavity layer of R-%g for floor Construction '%s' being reset due to minimnum required SIPS insulation of R-14", CavityLayer, Name )
         endif  }
   "Blast Cons:CavityLayer"      Cons:CavityLayer  = {  UNDEFINED  }
END
;*************************************************************************

; SAC 6/28/17 - rulelists handling backward compat for removal of Cons:*ExtFinish = 'R4 Synthetic Stucco' (tic #761)
;*************************************************************************
RULELIST "ForceUpdate_Cons_WallExtFinish_2Path_R4Synthetic" 1 0 1 1

   "Post message to log describing change to model (if any) in removing WallExtFinishLayer of 'R4 Synthetic Stucco'"   Cons:Action  = {
         if (SheathInsulLayer == 100101 .OR. SheathInsulLayer == 100102)
         then  PostWarning( "For Cons '%s' replacing old WallExtFinishLayer selection of 'R4 Synthetic Stucco' with 'Synthetic Stucco', but existing sheating selection ('%s') cannot easily be modified to account for this update.", Name, EnumString( SheathInsulLayer ) )
         else if (SheathInsulLayer >  99056)  ; hi-R sheathing
         then  PostWarning( "For Cons '%s' replacing old WallExtFinishLayer selection of 'R4 Synthetic Stucco' with 'Synthetic Stucco', but adding R-4 to existing sheathing selection ('%s') would exceed the maximum option.", Name, EnumString( SheathInsulLayer ) )
         else if (SheathInsulLayer == 99000)  ; specify
         then  PostMessageToLog( "For Cons '%s' replacing old WallExtFinishLayer selection of 'R4 Synthetic Stucco' with 'Synthetic Stucco' and increasing user-specified sheathing R-value (%g) by 4.", Name, ValidOr( SheathInsulLayerRVal, 0 ) )
         else if (SheathInsulLayer == 0)      ; none
         then  PostMessageToLog( "For Cons '%s' replacing old WallExtFinishLayer selection of 'R4 Synthetic Stucco' with 'Synthetic Stucco' and selecting R-4 sheathing insulation option.", Name )
         else  PostMessageToLog( "For Cons '%s' replacing old WallExtFinishLayer selection of 'R4 Synthetic Stucco' with 'Synthetic Stucco' and increasing sheathing insulation R-value (%g) by 4.", Name, ValidOr( SheathInsulLayer, 99000 )-99000 )
         endif endif endif endif  }

   "Switch Cons:WallExtFinishLayer = 'R4 Synthetic Stucco' to 'Synthetic Stucco'"
      Cons:WallExtFinishLayer  = {  100112  }  ; "Synthetic Stucco"

   "Modify SheathInsulLayer to accommodate removal of WallExtFinishLayer = 'R4 Synthetic Stucco'"
      Cons:SheathInsulLayer  = {
         if (SheathInsulLayer == 100101 .OR. SheathInsulLayer == 100102 .OR.
             SheathInsulLayer ==  99000 .OR. SheathInsulLayer  >  99056) then  UNCHANGED     ; no update
         else if (SheathInsulLayer == 0)      ; none
         then  99004
         else  SheathInsulLayer + 4
         endif endif  }

   "Modify SheathInsulLayerRVal to accommodate removal of WallExtFinishLayer = 'R4 Synthetic Stucco'"
      Cons:SheathInsulLayerRVal  = {
         if (SheathInsulLayer ==  99000) then  ValidOr( SheathInsulLayerRVal, 0 ) + 4
         else  UNCHANGED  endif  }
   "Set SheathInsulLayerRpt"     Cons:SheathInsulLayerRpt = {  SheathInsulLayer  }     ; SAC 10/21/19 (tic #1121)
END
;*************************************************************************
RULELIST "ForceUpdate_Cons_WallExtFinish_1Path_R4Synthetic" 1 0 1 1

   "Post message to log describing change to model (if any) in removing WallExtFinishLayer of 'R4 Synthetic Stucco'"   Cons:Action  = {
         if (FurringInsulLayer > 56 .AND. FurringInsulLayer < 200)  ; hi-R sheathing
         then  PostWarning( "For Cons '%s' replacing old WallExtFinishLayer selection of 'R4 Synthetic Stucco' with 'Synthetic Stucco', but adding R-4 to existing furring insulation selection ('%s') would exceed the maximum option.", Name, EnumString( FurringInsulLayer ) )
         else if (FurringInsulLayer == 900)  ; specify
         then  PostMessageToLog( "For Cons '%s' replacing old WallExtFinishLayer selection of 'R4 Synthetic Stucco' with 'Synthetic Stucco' and increasing user-specified furring insulation R-value (%g) by 4.", Name, ValidOr( FurringInsulLayerRVal, 0 ) )
         else if (FurringInsulLayer == 100401)      ; none
         then  PostMessageToLog( "For Cons '%s' replacing old WallExtFinishLayer selection of 'R4 Synthetic Stucco' with 'Synthetic Stucco' and selecting R-4 furring insulation option.", Name )
         else  PostMessageToLog( "For Cons '%s' replacing old WallExtFinishLayer selection of 'R4 Synthetic Stucco' with 'Synthetic Stucco' and increasing furring insulation R-value (%g) by 4.", Name, ValidOr( FurringInsulLayer, 0 ) )
         endif endif endif  }

   "Switch Cons:WallExtFinishLayer = 'R4 Synthetic Stucco' to 'Synthetic Stucco'"
      Cons:WallExtFinishLayer  = {  100112  }  ; "Synthetic Stucco"

   "Modify FurringInsulLayer to accommodate removal of WallExtFinishLayer = 'R4 Synthetic Stucco'"
      Cons:FurringInsulLayer  = {
         if (FurringInsulLayer == 100401) then  4     ; none -> R-4
         else if (FurringInsulLayer == 900 .OR. FurringInsulLayer > 56) then  UNCHANGED     ; no update
         else  FurringInsulLayer + 4
         endif endif  }

   "Modify FurringInsulLayerRVal to accommodate removal of WallExtFinishLayer = 'R4 Synthetic Stucco'"
      Cons:FurringInsulLayerRVal  = {
         if (FurringInsulLayer == 900) then  ValidOr( FurringInsulLayerRVal, 0 ) + 4
         else  UNCHANGED  endif  }
END
;*************************************************************************
RULELIST "ForceUpdate_Cons_FlrExtFinish_2Path_R4Synthetic" 1 0 1 1

   "Post message to log describing change to model (if any) in removing FlrExtFinishLayer of 'R4 Synthetic Stucco'"   Cons:Action  = {
         if (SheathInsulLayer == 100101 .OR. SheathInsulLayer == 100102)
         then  PostWarning( "For Cons '%s' replacing old FlrExtFinishLayer selection of 'R4 Synthetic Stucco' with 'Synthetic Stucco', but existing sheating selection ('%s') cannot easily be modified to account for this update.", Name, EnumString( SheathInsulLayer ) )
         else if (SheathInsulLayer >  99056)  ; hi-R sheathing
         then  PostWarning( "For Cons '%s' replacing old FlrExtFinishLayer selection of 'R4 Synthetic Stucco' with 'Synthetic Stucco', but adding R-4 to existing sheathing selection ('%s') would exceed the maximum option.", Name, EnumString( SheathInsulLayer ) )
         else if (SheathInsulLayer == 99000)  ; specify
         then  PostMessageToLog( "For Cons '%s' replacing old FlrExtFinishLayer selection of 'R4 Synthetic Stucco' with 'Synthetic Stucco' and increasing user-specified sheathing R-value (%g) by 4.", Name, ValidOr( SheathInsulLayerRVal, 0 ) )
         else if (SheathInsulLayer == 0)      ; none
         then  PostMessageToLog( "For Cons '%s' replacing old FlrExtFinishLayer selection of 'R4 Synthetic Stucco' with 'Synthetic Stucco' and selecting R-4 sheathing insulation option.", Name )
         else  PostMessageToLog( "For Cons '%s' replacing old FlrExtFinishLayer selection of 'R4 Synthetic Stucco' with 'Synthetic Stucco' and increasing sheathing insulation R-value (%g) by 4.", Name, ValidOr( SheathInsulLayer, 99000 )-99000 )
         endif endif endif endif  }

   "Switch Cons:FlrExtFinishLayer = 'R4 Synthetic Stucco' to 'Synthetic Stucco'"
      Cons:FlrExtFinishLayer  = {  100112  }  ; "Synthetic Stucco"

   "Modify SheathInsulLayer to accommodate removal of FlrExtFinishLayer = 'R4 Synthetic Stucco'"
      Cons:SheathInsulLayer  = {
         if (SheathInsulLayer == 100101 .OR. SheathInsulLayer == 100102 .OR.
             SheathInsulLayer ==  99000 .OR. SheathInsulLayer  >  99056) then  UNCHANGED     ; no update
         else if (SheathInsulLayer == 0)      ; none
         then  99004
         else  SheathInsulLayer + 4
         endif endif  }

   "Modify SheathInsulLayerRVal to accommodate removal of FlrExtFinishLayer = 'R4 Synthetic Stucco'"
      Cons:SheathInsulLayerRVal  = {
         if (SheathInsulLayer ==  99000) then  ValidOr( SheathInsulLayerRVal, 0 ) + 4
         else  UNCHANGED  endif  }
   "Set SheathInsulLayerRpt"     Cons:SheathInsulLayerRpt = {  SheathInsulLayer  }     ; SAC 10/21/19 (tic #1121)
END
;*************************************************************************
RULELIST "ForceUpdate_Cons_FlrExtFinish_1Path_R4Synthetic" 1 0 1 1

   "Post message to log describing change to model (if any) in removing FlrExtFinishLayer of 'R4 Synthetic Stucco'"   Cons:Action  = {
         if (FurringInsulLayer > 56 .AND. FurringInsulLayer < 200)  ; hi-R sheathing
         then  PostWarning( "For Cons '%s' replacing old FlrExtFinishLayer selection of 'R4 Synthetic Stucco' with 'Synthetic Stucco', but adding R-4 to existing furring insulation selection ('%s') would exceed the maximum option.", Name, EnumString( FurringInsulLayer ) )
         else if (FurringInsulLayer == 900)  ; specify
         then  PostMessageToLog( "For Cons '%s' replacing old FlrExtFinishLayer selection of 'R4 Synthetic Stucco' with 'Synthetic Stucco' and increasing user-specified furring insulation R-value (%g) by 4.", Name, ValidOr( FurringInsulLayerRVal, 0 ) )
         else if (FurringInsulLayer == 100401)      ; none
         then  PostMessageToLog( "For Cons '%s' replacing old FlrExtFinishLayer selection of 'R4 Synthetic Stucco' with 'Synthetic Stucco' and selecting R-4 furring insulation option.", Name )
         else  PostMessageToLog( "For Cons '%s' replacing old FlrExtFinishLayer selection of 'R4 Synthetic Stucco' with 'Synthetic Stucco' and increasing furring insulation R-value (%g) by 4.", Name, ValidOr( FurringInsulLayer, 0 ) )
         endif endif endif  }

   "Switch Cons:FlrExtFinishLayer = 'R4 Synthetic Stucco' to 'Synthetic Stucco'"
      Cons:FlrExtFinishLayer  = {  100112  }  ; "Synthetic Stucco"

   "Modify FurringInsulLayer to accommodate removal of FlrExtFinishLayer = 'R4 Synthetic Stucco'"
      Cons:FurringInsulLayer  = {
         if (FurringInsulLayer == 100401) then  4     ; none -> R-4
         else if (FurringInsulLayer == 900 .OR. FurringInsulLayer > 56) then  UNCHANGED     ; no update
         else  FurringInsulLayer + 4
         endif endif  }

   "Modify FurringInsulLayerRVal to accommodate removal of FlrExtFinishLayer = 'R4 Synthetic Stucco'"
      Cons:FurringInsulLayerRVal  = {
         if (FurringInsulLayer == 900) then  ValidOr( FurringInsulLayerRVal, 0 ) + 4
         else  UNCHANGED  endif  }
END
;*************************************************************************

;*************************************************************************
RULELIST "ForceUpdate_Cons_R19_2x6_Compressed" 1 0 1 1

   "Post message to log describing change to model - switching CavityLayer from 'R 19' to 'R 19 in 5-1/2 in. cavity (R-18)'"   Cons:Action  = {
         PostMessageToLog( "For Cons '%s' replacing 5 1/2 inch CavityLayer of 'R 19' with 'R 19 in 5-1/2 in. cavity (R-18)'", Name )  }

   "Switch CavityLayer from 'R 19' to 'R 19 in 5-1/2 in. cavity (R-18)'"   Cons:CavityLayer  = {  1801  }  ; "R 19 in 5-1/2 in. cavity (R-18)"
END
;*************************************************************************

;*************************************************************************
RULELIST "ForceUpdate_Cons_CavInsulOverFrame_On" 1 0 1 1

   "Post message to log describing change to model - overriding default CavInsulOverFrame for consistency w/ past releases"   Cons:Action  = {
         PostMessageToLog( "For Cons '%s' overriding default CavInsulOverFrame of 0/none with value of 1/have for consistency w/ past releases", Name )  }

   "Override default for Cons:CavInsulOverFrame with '1'"   Cons:CavInsulOverFrame  = {  1  }
END
;*************************************************************************


;*************************************************************************
;*************************************************************************

ENDFILE
