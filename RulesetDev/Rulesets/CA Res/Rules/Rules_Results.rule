; -------------------------------------------------------------------------
; Rules pertaining to:   Simulation and Compliance Analysis Results
; CEC Title-24 Residential Energy Code
; -------------------------------------------------------------------------
; Copyright (c) 2012-2014, California Energy Commission
; Copyright (c) 2012-2014, Wrightsoft Corporation
; All rights reserved.
; Redistribution and use in source and binary forms, with or without modification,
; are permitted provided that the following conditions are met:
; - Redistributions of source code must retain the above copyright notice, this
;   list of conditions and the following disclaimer.
; - Redistributions in binary form must reproduce the above copyright notice, this
;   list of conditions, the following disclaimer in the documentation and/or other
;   materials provided with the distribution.
; - Neither the name of the California Energy Commission nor the names of its
;   contributors may be used to endorse or promote products derived from this
;   software without specific prior written permission.
; DISCLAIMER: THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
; "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
; THE IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
; NON-INFRINGEMENT ARE DISCLAIMED. IN NO EVENT SHALL CALIFORNIA ENERGY COMMISSION,
; WRIGHTSOFT CORPORATION, ITRON, INC. OR ANY OTHER AUTHOR OR COPYRIGHT HOLDER OF
; THIS SOFTWARE (COLLECTIVELY, THE "AUTHORS") BE LIABLE FOR ANY DIRECT, INDIRECT,
; INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
; LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
; OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
; LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
; OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
; ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.  EACH LICENSEE AND SUBLICENSEE OF THE
; SOFTWARE AGREES NOT TO ASSERT ANY CLAIM AGAINST ANY OF THE AUTHORS RELATING TO
; THIS SOFTWARE, WHETHER DUE TO PERFORMANCE ISSUES, TITLE OR INFRINGEMENT ISSUES,
; STRICT LIABILITY OR OTHERWISE.
; -------------------------------------------------------------------------


;*************************************************************************
RULELIST "ProcessResults" 1 0 0 1
;*************************************************************************
; SAC 3/17/14 - addded clean-up of LayerParams & Mat objects created during SimulationPrep rules
	"Blast all LayerParams objects"			Proj:Action	= {	DeleteAllComps( LayerParams )  }
	"Blast Mats marked for deletion"			Mat:Action	= {	if (IfValidAnd( MarkForDeletion == 1 )) then  DeleteComp()  else  UNCHANGED  endif  }
;	"Blast Mats not referenced by Cons:*"	Mat:Action	= {	if (CountRefs( Cons:CavityPathMats ) < 1 .AND. CountRefs( Cons:FramePathMats ) < 1) then  DeleteComp()  else  UNCHANGED  endif  }		; SAC 3/21/14

;"store BEMProc details"		Proj:Action = {  if (IfValidAnd( RunID == "Proposed" )==0) then  UNCHANGED
;                                            else  StoreBEMProc( "Prop-ProcessResults begin", 0 )  endif  }

	"Store and process simulation results for this run"	Proj:Action = {	EvalRulelist( "CARes_ProcessResults" )  }

	"Store flags and messages to restrict results UI display to only valid results"	Proj:Action =     ; SAC 6/26/19
	   {	EvalRulelist( "CARes_ProcessResults_SetResultsValidMsgs" )  }


   "call rulelist to write MxdFuelCmpr export CSV"    Proj:Action =     ; placed here following final results calcs - SAC 06/27/22
      {  if (IfValidAnd( ShowMixedFuelCompare > 0 ) .AND. IfValidAnd( RunAbbrev = "dr" ) .AND.
             ( AnalysisType == 14 .OR. AnalysisType == 15 ))
         then  EvalRulelist( "MxdFuelCmprReport_Main" )
         else  UNCHANGED  endif  }


   ;--------------------------------------------------------------------
   ; Blast Proposed Design components that were created for compliance analysis
   ;--------------------------------------------------------------------
; "debug"		HVACSys:Action	= {	MessageBox( "ProcessResults - HVACSys: %s  HtPumpDucted  %g  RunNumber  %g", Name, HtPumpDucted, Proj:RunNumber )  }
; "debug"		HVACSys:Action	= {	MessageBox( "ProcessResults - HVACSys: %s  HtPumpDucted %g  RunNumber %g  RunAbbrev %s", Name, HtPumpDucted, Proj:RunNumber, Proj:RunAbbrev )  }

   ; SAC 2/19/18 - added logic to prevent DistribSystem or Fan deletion following 'pp' (PrelimProp) run (tic #979)  ; added similar logic to prevent DistribSystem or Fan deletion following 'pp-N' run - SAC 03/08/21
	"Remove DistribSystem  from HtPump Systems if needed"
			HVACSys:DistribSystem	= {	if ( LocalCompAssigned( DistribSystem ) .AND. Type == 2 .AND. Proj:RunNumber == 1 .AND. Proj:RunAbbrev != "pp" .AND. Proj:RunAbbrev != "pp-N" ) then
														if ( T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) != 0 ) then DeleteComp()
														else UNCHANGED endif	
													else UNCHANGED endif	}

	"Remove Fan from HtPump Systems if needed"
			HVACSys:Fan					= {	if ( LocalCompAssigned( Fan ) .AND. Proj:RunNumber == 1 .AND. Type == 2 .AND. Proj:RunAbbrev != "pp" .AND. Proj:RunAbbrev != "pp-N" ) then 
														if ( T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) != 0 ) then DeleteComp()
														else UNCHANGED endif	
													else UNCHANGED endif	}

	"Remove DistribSystem  from Room AC Systems if needed"
			HVACSys:DistribSystem	= {	if ( LocalCompAssigned( DistribSystem ) .AND. Proj:RunNumber == 1 .AND. Type == 1 .AND. Proj:RunAbbrev != "pp" .AND. Proj:RunAbbrev != "pp-N" ) then
														if ( T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev ) != 0 ) then  DeleteComp()
														else UNCHANGED endif	
													else UNCHANGED endif	}

	"Remove Fan from Room AC Systems if needed"
			HVACSys:Fan					= {	if ( LocalCompAssigned( Fan ) .AND. Proj:RunNumber == 1 .AND. Type == 1 .AND. Proj:RunAbbrev != "pp" .AND. Proj:RunAbbrev != "pp-N" ) then
														if ( T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev ) != 0 ) then  DeleteComp()
														else UNCHANGED endif	
													else UNCHANGED endif	}

	"Reset CoolDuctedRpt based on User Inputs"
			HVACSys:CoolDuctedRpt	= {	if (Type == 2)		; heat pump system
													then	if (HtPumpSysType < 1 .OR. LocalCompAssigned( HtPumpSystem[1] ) == 0) then  0
														else if (T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) != 0) then  1
														else  0  endif endif
													else	if (CoolSysType < 1 .OR. LocalCompAssigned( CoolSystem[1] ) == 0) then  0
														else if (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev ) != 0) then  1
														else  0  endif endif endif  }

	"Blast AC Charge populated for analysis, but not in User Model"
			HVACHtPump:ACCharge	=	{	if ( FloorAreaServed > 0.5 .AND. Proj:RunNumber == 1 ) then
													if ( T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) != 0) then 1 
													else UNCHANGED endif	
												else UNCHANGED endif	}
	"Blast CFMperTon populated for analysis, but not in User Model"
			HVACHtPump:CFMperTon	=	{	if ( FloorAreaServed > 0.5 .AND. Proj:RunNumber == 1 ) then
													if ( T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) != 0) then UNDEFINED 
													else UNCHANGED endif	
												else UNCHANGED endif	}
;	"debugging"		HVACHtPump:Action	= {	if (FloorAreaServed > 0.5) then MessageBox( "ProcessResults:  Name = %s  ACCharge = %s  CFMperTon = %g", Name, EnumString(ACCharge), CFMperTon) else UNCHANGED endif }

	"Blast AC Charge populated for analysis, but not in User Model"
			HVACCool:ACCharge		=	{	if ( FloorAreaServed > 0.5 .AND. Proj:RunNumber == 1 ) then
													if ( T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) != 0) then UNDEFINED
													else UNCHANGED endif	
												else UNCHANGED endif	}
															
	"Blast CFMperTon populated for analysis, but not in User Model"
			HVACCool:CFMperTon	=	{	if ( FloorAreaServed > 0.5 .AND. Proj:RunNumber == 1 ) then
													if ( T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) != 0) then UNDEFINED
													else UNCHANGED endif	
												else UNCHANGED endif	}

;"store BEMProc details"		Proj:Action = {  if (IfValidAnd( RunID == "Proposed" )==0) then  UNCHANGED
;                                            else  StoreBEMProc( "Prop-ProcessResults end", 0 )  endif  }

; SAC/mjb 10/22/14 - moved to 'ProposedReportPrep' rulelist
;; mjb relocated from PostProposed rulelist on 8/26/14
;   ;--------------------------------------------------------------------
;   ; Setup SCSysRpt reporting object properties (if none exist yet)
;   ;--------------------------------------------------------------------
;	"Setup SCSysRpt objects (if needed)"		Proj:Action	= {	;  if (ComponentCount( SCSysRpt ) > 0 .OR. Proj:NumSCSysEquipUnits < 1) then  UNCHANGED
;																					if (Proj:NumSCSysEquipUnits < 1) then  UNCHANGED
;																					else	EvalRulelist( "Setup_SCSysReportingObjects" )  endif  }
;
;   ;--------------------------------------------------------------------
;   ; Setup DHWSysRpt reporting object properties (if none exist yet)
;   ;--------------------------------------------------------------------
;	"Setup DHWSysRpt objects (if needed)"		Proj:Action	= {	;  if (ComponentCount( DHWSysRpt ) > 0 .OR. Proj:NumDHWEquipUnits < 1) then  UNCHANGED
;																					if (Proj:NumDHWEquipUnits < 1) then  UNCHANGED
;																					else	EvalRulelist( "Setup_DHWSysReportingObjects" )  endif  }
;
;   ;--------------------------------------------------------------------
;   ; Setup IAQVentRpt reporting object properties (if none exist yet)
;   ;--------------------------------------------------------------------
;	"Setup IAQVentRpt objects (if needed)"		Proj:Action	= {	;  if (ComponentCount( IAQVentRpt ) > 0) then  UNCHANGED
;																					;  else	EvalRulelist( "Setup_IAQVentReportingObjects" )  endif  }
;																					EvalRulelist( "Setup_IAQVentReportingObjects" )  }

END

;*************************************************************************  SAC 6/26/19
RULELIST "CARes_ProcessResults_SetResultsValidMsgs" 1 0 1 1
;*************************************************************************
   "Set EUseSummary:HideEDRs - flag indicating Energy Design Rating UI should be hidden"        EUseSummary:HideEDRs =
      {  if (Proj:EnergyCodeYearNum >= 2019 .AND. Proj:AllowDesignRating < 0.5) then  1
	      else if (Proj:AllowDesignRating < 0.5) then  2
	      else if (Proj:EnergyCodeYearNum < 2019 .AND. Proj:DesignRatingCalcs < 0.5) then  3
         else if (Proj:AnalysisType < 13) then  4
         else  0  endif endif endif endif  }
      ;   else if (Proj:EnergyCodeYearNum >= 2022 .AND. Proj:WeatherFileSet > 0) then  5                    - SAC 8/26/19 - remove limitation on 2022 EDR calcs
      ;   else if (Proj:AnalysisType != 13) then  4         - allow calc & display of EDRs for Mixed Fuel or All Elec Baseline comparisons - SAC 12/29/21 (MxdFuel)
   "Set EUseSummary:HideCompSummary - flag indicating Compliance Summary UI should be hidden"   EUseSummary:HideCompSummary =    ; toggle ON CompSummary tab for 2025 - SAC 07/25/23
      {  if (Proj:EnergyCodeYearNum >= 2025) then  0
         else  HideEDRs  endif  }
   "Set EUseSummary:HideC02Emissions - flag indicating CO2 Emissions UI should be hidden"       EUseSummary:HideC02Emissions =
      {  0  }
      ;{  if (Proj:EnergyCodeYearNum >= 2022 .AND. Proj:WeatherFileSet > 0) then  1                         - SAC 8/26/19 - remove limitation on 2022 Carbon calcs
      ;   else  0  endif  }
   "Set EUseSummary:CompSummaryMsg - Compliance Summary UI message"                             EUseSummary:CompSummaryMsg =
      {  if (IfValidAnd( HideCompSummary > 0 )==0) then  UNDEFINED
         else  switch (HideCompSummary)
                  case  1 :  Format( "Compliance Summary not available for %g analysis.", Proj:EnergyCodeYearNum )
                  case  2 :          "Compliance Summary only available for single family new construction analysis."
                  case  3 :          "Energy Design Rating calcs must be toggled on in EDR/PV tab of Project data to view results here."
                  case  4 :  Format( "Compliance Summary not available for analysis type '%s'", EnumString( Proj:AnalysisType ) )
                  default :  UNDEFINED
               endswitch  endif  }
      ;            case  5 :  Format( "Compliance Summary available only for weather file set '(default)' (not '%s')", EnumString( Proj:WeatherFileSet ) )
   "Set EUseSummary:EDRMsg - Energy Design Rating UI message"                                   EUseSummary:EDRMsg =
      {  if (IfValidAnd( HideEDRs > 0 )==0) then  UNDEFINED
         else  switch (HideEDRs)
                  case  1 :  Format( "Energy Design Rating calcs not yet implemented for %g analysis.", Proj:EnergyCodeYearNum )
                  case  2 :          "Energy Design Rating calcs currently available only for single family new construction analysis."
                  case  3 :          "Energy Design Rating calcs must be toggled on in EDR/PV tab of Project data to view results here."
                  case  4 :  Format( "Energy Design Ratings not available for analysis type '%s'", EnumString( Proj:AnalysisType ) )
                  default :  UNDEFINED
               endswitch  endif  }
      ;            case  5 :  Format( "Energy Design Ratings available only for weather file set '(default)' (not '%s')", EnumString( Proj:WeatherFileSet ) )
   "Set EUseSummary:C02EmissionsMsg - CO2 Emissions UI message"                                 EUseSummary:C02EmissionsMsg =
      {  if (IfValidAnd( HideC02Emissions > 0 )==0) then  UNDEFINED
         else  UNDEFINED  endif  }
      ;   else  switch (HideC02Emissions)
      ;            case  1 :  Format( "CO2 Emissions available only for weather file set '(default)' (not '%s')", EnumString( Proj:WeatherFileSet ) )
      ;            default :  UNDEFINED
      ;         endswitch  endif  }
END

;*************************************************************************
RULELIST "CARes_ProcessResults" 1 0 0 1
;*************************************************************************
; "store BEMProc details"		Proj:Action = {  StoreBEMProc( "Before ProcRes", 0 )  }
; "debug"		Proj:Action	= {	MessageBox( "About to evaluate 'CARes_ProcessResults' rules." )  }
;"debug"  Proj:Action = {  PostMessageToLog( "  evaluating 'CARes_ProcessResults':  RunAbbrev '%s'  RunNumber %g  - %g EUseSummary & %g EnergyUse objects", RunAbbrev, RunNumber, ComponentCount( EUseSummary ), ComponentCount( EnergyUse ) )  }
;"store BEMProc details"		Proj:Action = {  StoreBEMProc( Format( "b4 ProcessResults for %s", RunAbbrev ), 0 )  }

   ; SAC 4/21/15 - modified all rules to base results/summary rulelist evals on Proj:RunAbbrev so that each rule needn't include logic determining which run was performed based on user inputs
	"Copy initial EnergyUse:Proposed properties"	Proj:Action = {
         if (RunAbbrev == "dr") then    EvalRulelist( "CARes_EnergyUse_CopyProposedResults" )
         else  UNCHANGED  endif  }

;"testing" Proj:Action = {  MessageBox( "storing results for run: %s", RunAbbrev )  }
	"Store sim energy use results for this run"	Proj:Action = {
         switch (RunAbbrev)
            case  "pp"	:  EvalRulelist( "CARes_PrelimPropResults" )
            case  "pp-N" : EvalRulelist( "CARes_PrelimPropResults_N" )
            case  "pp-E" : EvalRulelist( "CARes_PrelimPropResults_E" )
            case  "pp-S" : EvalRulelist( "CARes_PrelimPropResults_S" )
            case  "pp-W" : EvalRulelist( "CARes_PrelimPropResults_W" )
            case  "p-N"	:  EvalRulelist( "CARes_ProposedResults_N" )
            case  "p-E"	:  EvalRulelist( "CARes_ProposedResults_E" )
            case  "p-S"	:  EvalRulelist( "CARes_ProposedResults_S" )
            case  "p-W"	:  EvalRulelist( "CARes_ProposedResults_W" )
            case  "s"	:  if (AllOrientations < 0.5)
            					then	EvalRulelist( "CARes_StandardResults" )
            					else	EvalRulelist( "CARes_StandardResults_NESW" )  endif
            case  "s2"	:  UNCHANGED
            case  "s3"	:  UNCHANGED
            case  "dr"	:  if (AllOrientations < 0.5)
            					then	EvalRulelist( "CARes_DesignRatingResults" )
            					else	EvalRulelist( "CARes_DesignRatingResults_NESW" )  endif
            case  "smf"   :  EvalRulelist( "CARes_StdMixedFuelResults" )
            case  "pfx"   :  EvalRulelist( "CARes_PropFlexResults" )
            case  "pfx-N" :  EvalRulelist( "CARes_PropFlexResults_N" )
            case  "pfx-E" :  EvalRulelist( "CARes_PropFlexResults_E" )
            case  "pfx-S" :  EvalRulelist( "CARes_PropFlexResults_S" )
            case  "pfx-W" :  EvalRulelist( "CARes_PropFlexResults_W" )
            default		  :  EvalRulelist( "CARes_ProposedResults" )	; for 'u' or 'p' run
         endswitch  }

   ; SAC 12/10/12 - revised rule to calc TDV for Research simulations   ; SAC 07/20/23 (2025)
	"Calc & store TDV results for this run"		Proj:Action = {
         if (ClimateZone > 0.9 .AND. ClimateZone < 16.1)
         then	switch (RunAbbrev)
            		case  "pp"	:  UNCHANGED
            		case  "pp-N" : UNCHANGED
            		case  "pp-E" : UNCHANGED
            		case  "pp-S" : UNCHANGED
            		case  "pp-W" : UNCHANGED
            		case  "p-N"	:  EvalRulelist( "CARes_ProposedTDVResults_N" )
            		case  "p-E"	:  EvalRulelist( "CARes_ProposedTDVResults_E" )
            		case  "p-S"	:  EvalRulelist( "CARes_ProposedTDVResults_S" )
            		case  "p-W"	:  EvalRulelist( "CARes_ProposedTDVResults_W" )
            		case  "s"	:  if (AllOrientations < 0.5)
            							then	EvalRulelist( "CARes_StandardTDVResults" )
            							else	EvalRulelist( "CARes_StandardTDVResults_NESW" )  endif
            		case  "s2"	:  if (AllOrientations < 0.5)
            							then	EvalRulelist( "CARes_StandardTDVResults_PVonly" )
            							else	EvalRulelist( "CARes_StandardTDVResults_PVonly_NESW" )  endif
            		case  "s3"	:  UNCHANGED
            		case  "dr"	:  if (AllOrientations < 0.5)
            							then	EvalRulelist( "CARes_DesignRatingTDVResults" )
            							else	EvalRulelist( "CARes_DesignRatingTDVResults_NESW" )  endif
            		case  "smf"   :  UNCHANGED  ; EvalRulelist( "CARes_ProposedTDVResults" )
            		case  "pfx"   :  EvalRulelist( "CARes_PropFlexTDVResults" )
            		case  "pfx-N" :  EvalRulelist( "CARes_PropFlexTDVResults_N" )
            		case  "pfx-E" :  EvalRulelist( "CARes_PropFlexTDVResults_E" )
            		case  "pfx-S" :  EvalRulelist( "CARes_PropFlexTDVResults_S" )
            		case  "pfx-W" :  EvalRulelist( "CARes_PropFlexTDVResults_W" )
            		default		  :  EvalRulelist( "CARes_ProposedTDVResults" )	; for 'u' or 'p' run
               endswitch
         else  UNCHANGED  endif  }

	"Calc & store PeakCoolElec results for this run"      Proj:Action =        ; SAC 08/08/23 (2025)
      {  if (ClimateZone > 0.9 .AND. ClimateZone < 16.1)
         then	switch (RunAbbrev)
            		case  "p"	:  EvalRulelist( "CARes_ProposedPeakCoolElec" )
            		case  "p-N"	:  EvalRulelist( "CARes_ProposedPeakCoolElec_N" )
            		case  "p-E"	:  EvalRulelist( "CARes_ProposedPeakCoolElec_E" )
            		case  "p-S"	:  EvalRulelist( "CARes_ProposedPeakCoolElec_S" )
            		case  "p-W"	:  EvalRulelist( "CARes_ProposedPeakCoolElec_W" )
            		case  "s"	:  if (AllOrientations < 0.5)
            							then	EvalRulelist( "CARes_StandardPeakCoolElec" )
            							else	EvalRulelist( "CARes_StandardPeakCoolElec_NESW" )  endif
            		default	   :  UNCHANGED
               endswitch
         else  UNCHANGED  endif  }

   ; SAC 6/11/19 - calc SrcEnergy results
   "Calc & store SrcEnergy results for this run"      Proj:Action = {
         if (ClimateZone > 0.9 .AND. ClimateZone < 16.1 .AND. TrackSrcEnergy)
         then   switch (RunAbbrev)
                  case  "pp"    :  UNCHANGED
                  case  "pp-N"  :  UNCHANGED
                  case  "pp-E"  :  UNCHANGED
                  case  "pp-S"  :  UNCHANGED
                  case  "pp-W"  :  UNCHANGED
                  case  "p-N"   :  EvalRulelist( "CARes_ProposedSrcEnergyResults_N" )
                  case  "p-E"   :  EvalRulelist( "CARes_ProposedSrcEnergyResults_E" )
                  case  "p-S"   :  EvalRulelist( "CARes_ProposedSrcEnergyResults_S" )
                  case  "p-W"   :  EvalRulelist( "CARes_ProposedSrcEnergyResults_W" )
; TO DO - restore check of AnalysisVersion > 250000 to avoid Src energy retrieval for 2025 's' run
                  case  "s"     :  if (Proj:AnalysisVersion > 990000) then  UNCHANGED
                                   else if (AllOrientations < 0.5)
                                   then   EvalRulelist( "CARes_StandardSrcEnergyResults" )
                                   else   EvalRulelist( "CARes_StandardSrcEnergyResults_NESW" )  endif endif
                  case  "s2"    :  UNCHANGED
                  case  "s3"    :  if (AllOrientations < 0.5)
                                   then   EvalRulelist( "CARes_StandardSrcEnergyResults_2025" )
                                   else   EvalRulelist( "CARes_StandardSrcEnergyResults_2025_NESW" )  endif
                  case  "dr"    :  if (AllOrientations < 0.5)
                                   then   EvalRulelist( "CARes_DesignRatingSrcEnergyResults" )
                                   else   EvalRulelist( "CARes_DesignRatingSrcEnergyResults_NESW" )  endif
                  case  "smf"   :  UNCHANGED
                  case  "pfx"   :  UNCHANGED     ; -to do-  EvalRulelist( "CARes_PropFlexSrcEnergyResults" )
                  case  "pfx-N" :  UNCHANGED     ; -to do-  EvalRulelist( "CARes_PropFlexSrcEnergyResults_N" )
                  case  "pfx-E" :  UNCHANGED     ; -to do-  EvalRulelist( "CARes_PropFlexSrcEnergyResults_E" )
                  case  "pfx-S" :  UNCHANGED     ; -to do-  EvalRulelist( "CARes_PropFlexSrcEnergyResults_S" )
                  case  "pfx-W" :  UNCHANGED     ; -to do-  EvalRulelist( "CARes_PropFlexSrcEnergyResults_W" )
                  default       :  EvalRulelist( "CARes_ProposedSrcEnergyResults" )   ; for 'u' or 'p' run
               endswitch
         else  UNCHANGED  endif  }

   "Retrieve Zone Cooling UMLHs from CSE export for P/PN run - 1"  Zone:NumClgUMLHs[1] =         ; SAC 03/24/22   ; revised for AllOrientations & to retrieve ALL results only after final run simulation - SAC 08/10/22
      {  if ( TrackUMLHs > 0.5 .AND. Proj:AnalysisVersion > 220000 .AND.
              ((Proj:RunScope == 1 .AND. (Proj:RunAbbrev == "dr" .OR. Proj:RunAbbrev == "s3")) .OR. (Proj:RunScope != 1 .AND. Proj:RunAbbrev == "s")) )
         then  if (IfValidAnd( AllOrientations > 0 ))
               then  RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + " - Prop-N-znUMLHs.csv",  2, Name, 1 )
               else  RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + " - Prop-znUMLHs.csv",    2, Name, 1 )
               endif
         else  UNCHANGED  endif  }
   "Retrieve Zone Cooling UMLHs from CSE export for P-E run - 2"  Zone:NumClgUMLHs[2] =  
      {  if ( TrackUMLHs > 0.5 .AND. Proj:AnalysisVersion > 220000 .AND. IfValidAnd( AllOrientations > 0 ) .AND.
              ((Proj:RunScope == 1 .AND. (Proj:RunAbbrev == "dr" .OR. Proj:RunAbbrev == "s3")) .OR. (Proj:RunScope != 1 .AND. Proj:RunAbbrev == "s")) )
         then        RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + " - Prop-E-znUMLHs.csv",  2, Name, 1 )
         else  UNCHANGED  endif  }
   "Retrieve Zone Cooling UMLHs from CSE export for P-S run - 3"  Zone:NumClgUMLHs[3] =  
      {  if ( TrackUMLHs > 0.5 .AND. Proj:AnalysisVersion > 220000 .AND. IfValidAnd( AllOrientations > 0 ) .AND.
              ((Proj:RunScope == 1 .AND. (Proj:RunAbbrev == "dr" .OR. Proj:RunAbbrev == "s3")) .OR. (Proj:RunScope != 1 .AND. Proj:RunAbbrev == "s")) )
         then        RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + " - Prop-S-znUMLHs.csv",  2, Name, 1 )
         else  UNCHANGED  endif  }
   "Retrieve Zone Cooling UMLHs from CSE export for P-W run - 4"  Zone:NumClgUMLHs[4] =  
      {  if ( TrackUMLHs > 0.5 .AND. Proj:AnalysisVersion > 220000 .AND. IfValidAnd( AllOrientations > 0 ) .AND.
              ((Proj:RunScope == 1 .AND. (Proj:RunAbbrev == "dr" .OR. Proj:RunAbbrev == "s3")) .OR. (Proj:RunScope != 1 .AND. Proj:RunAbbrev == "s")) )
         then        RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + " - Prop-W-znUMLHs.csv",  2, Name, 1 )
         else  UNCHANGED  endif  }
   "Retrieve Zone Cooling UMLHs from CSE export for Std run - 5"  Zone:NumClgUMLHs[5] =  
      {  if ( TrackUMLHs > 0.5 .AND. Proj:AnalysisVersion > 220000 .AND.
              ((Proj:RunScope == 1 .AND. (Proj:RunAbbrev == "dr" .OR. Proj:RunAbbrev == "s3")) .OR. (Proj:RunScope != 1 .AND. Proj:RunAbbrev == "s")) )
         then        RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + " - Std-znUMLHs.csv",  2, Name, 1 )
         else  UNCHANGED  endif  }
   "Retrieve Zone Cooling UMLHs from CSE export for DRtg run - 6"  Zone:NumClgUMLHs[6] =  
      {  if ( TrackUMLHs > 0.5 .AND. Proj:AnalysisVersion > 220000 .AND. Proj:RunAbbrev == "dr" )
         then        RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + " - DRtg-znUMLHs.csv",  2, Name, 1 )
         else  UNCHANGED  endif  }

   "Retrieve Zone Heating UMLHs from CSE export for P/PN run - 1"  Zone:NumHtgUMLHs[1] =         ; SAC 03/24/22   ; revised for AllOrientations & to retrieve ALL results only after final run simulation - SAC 08/10/22
      {  if ( TrackUMLHs > 0.5 .AND. Proj:AnalysisVersion > 220000 .AND.
              ((Proj:RunScope == 1 .AND. (Proj:RunAbbrev == "dr" .OR. Proj:RunAbbrev == "s3")) .OR. (Proj:RunScope != 1 .AND. Proj:RunAbbrev == "s")) )
         then  if (IfValidAnd( AllOrientations > 0 ))
               then  RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + " - Prop-N-znUMLHs.csv",  2, Name, 2 )
               else  RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + " - Prop-znUMLHs.csv",    2, Name, 2 )
               endif
         else  UNCHANGED  endif  }
   "Retrieve Zone Heating UMLHs from CSE export for P-E run - 2"  Zone:NumHtgUMLHs[2] =  
      {  if ( TrackUMLHs > 0.5 .AND. Proj:AnalysisVersion > 220000 .AND. IfValidAnd( AllOrientations > 0 ) .AND.
              ((Proj:RunScope == 1 .AND. (Proj:RunAbbrev == "dr" .OR. Proj:RunAbbrev == "s3")) .OR. (Proj:RunScope != 1 .AND. Proj:RunAbbrev == "s")) )
         then        RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + " - Prop-E-znUMLHs.csv",  2, Name, 2 )
         else  UNCHANGED  endif  }
   "Retrieve Zone Heating UMLHs from CSE export for P-S run - 3"  Zone:NumHtgUMLHs[3] =  
      {  if ( TrackUMLHs > 0.5 .AND. Proj:AnalysisVersion > 220000 .AND. IfValidAnd( AllOrientations > 0 ) .AND.
              ((Proj:RunScope == 1 .AND. (Proj:RunAbbrev == "dr" .OR. Proj:RunAbbrev == "s3")) .OR. (Proj:RunScope != 1 .AND. Proj:RunAbbrev == "s")) )
         then        RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + " - Prop-S-znUMLHs.csv",  2, Name, 2 )
         else  UNCHANGED  endif  }
   "Retrieve Zone Heating UMLHs from CSE export for P-W run - 4"  Zone:NumHtgUMLHs[4] =  
      {  if ( TrackUMLHs > 0.5 .AND. Proj:AnalysisVersion > 220000 .AND. IfValidAnd( AllOrientations > 0 ) .AND.
              ((Proj:RunScope == 1 .AND. (Proj:RunAbbrev == "dr" .OR. Proj:RunAbbrev == "s3")) .OR. (Proj:RunScope != 1 .AND. Proj:RunAbbrev == "s")) )
         then        RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + " - Prop-W-znUMLHs.csv",  2, Name, 2 )
         else  UNCHANGED  endif  }
   "Retrieve Zone Heating UMLHs from CSE export for Std run - 5"  Zone:NumHtgUMLHs[5] =  
      {  if ( TrackUMLHs > 0.5 .AND. Proj:AnalysisVersion > 220000 .AND.
              ((Proj:RunScope == 1 .AND. (Proj:RunAbbrev == "dr" .OR. Proj:RunAbbrev == "s3")) .OR. (Proj:RunScope != 1 .AND. Proj:RunAbbrev == "s")) )
         then        RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + " - Std-znUMLHs.csv",  2, Name, 2 )
         else  UNCHANGED  endif  }
   "Retrieve Zone Heating UMLHs from CSE export for DRtg run - 6"  Zone:NumHtgUMLHs[6] =  
      {  if ( TrackUMLHs > 0.5 .AND. Proj:AnalysisVersion > 220000 .AND. Proj:RunAbbrev == "dr" )
         then        RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + " - DRtg-znUMLHs.csv",  2, Name, 2 )
         else  UNCHANGED  endif  }

;   "Retrieve Zone Cooling UMLHs from CSE export for P/PN run - 1"  Zone:NumClgUMLHs[1] =         ; SAC 03/24/22   ; revised for AllOrientations - SAC 08/10/22
;      {  if (TrackUMLHs > 0.5)
;         then  if (Proj:RunAbbrev == "p" .OR. Proj:RunAbbrev == "p-N")
;               then  RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + ValidOr( Proj:RunIDProcFile, "" ) + "-znUMLHs.csv",   2, Name, 1 )
;               else  UNCHANGED  endif
;         else  UNDEFINED  endif  }
;;               then  int( RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + ValidOr( Proj:RunIDProcFile, "" ) + "-znUMLHs.csv",   2, Name, 1 ) + 0.99 )
;   "Retrieve Zone Cooling UMLHs from CSE export for P-E run - 2"  Zone:NumClgUMLHs[2] =         ; SAC 08/10/22
;      {  if (TrackUMLHs > 0.5)
;         then  if (Proj:RunAbbrev == "p-E")
;               then  RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + ValidOr( Proj:RunIDProcFile, "" ) + "-znUMLHs.csv",   2, Name, 1 )
;               else  UNCHANGED  endif
;         else  UNDEFINED  endif  }
;   "Retrieve Zone Cooling UMLHs from CSE export for P-S run - 3"  Zone:NumClgUMLHs[3] =  
;      {  if (TrackUMLHs > 0.5)
;         then  if (Proj:RunAbbrev == "p-S")
;               then  RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + ValidOr( Proj:RunIDProcFile, "" ) + "-znUMLHs.csv",   2, Name, 1 )
;               else  UNCHANGED  endif
;         else  UNDEFINED  endif  }
;   "Retrieve Zone Cooling UMLHs from CSE export for P-W run - 4"  Zone:NumClgUMLHs[4] =  
;      {  if (TrackUMLHs > 0.5)
;         then  if (Proj:RunAbbrev == "p-W")
;               then  RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + ValidOr( Proj:RunIDProcFile, "" ) + "-znUMLHs.csv",   2, Name, 1 )
;               else  UNCHANGED  endif
;         else  UNDEFINED  endif  }
;
;   "Retrieve Zone Heating UMLHs from CSE export for P/PN run - 1"  Zone:NumHtgUMLHs[1] =  
;      {  if (TrackUMLHs > 0.5)
;         then  if (Proj:RunAbbrev == "p" .OR. Proj:RunAbbrev == "p-N")
;               then  RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + ValidOr( Proj:RunIDProcFile, "" ) + "-znUMLHs.csv",   2, Name, 2 )
;               else  UNCHANGED  endif
;         else  UNDEFINED  endif  }
;;               then  int( RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + ValidOr( Proj:RunIDProcFile, "" ) + "-znUMLHs.csv",   2, Name, 2 ) + 0.99 )
;   "Retrieve Zone Heating UMLHs from CSE export for P-E run - 2"  Zone:NumHtgUMLHs[2] =         ; SAC 08/10/22
;      {  if (TrackUMLHs > 0.5)
;         then  if (Proj:RunAbbrev == "p-E")
;               then  RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + ValidOr( Proj:RunIDProcFile, "" ) + "-znUMLHs.csv",   2, Name, 2 )
;               else  UNCHANGED  endif
;         else  UNDEFINED  endif  }
;   "Retrieve Zone Heating UMLHs from CSE export for P-S run - 3"  Zone:NumHtgUMLHs[3] =  
;      {  if (TrackUMLHs > 0.5)
;         then  if (Proj:RunAbbrev == "p-S")
;               then  RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + ValidOr( Proj:RunIDProcFile, "" ) + "-znUMLHs.csv",   2, Name, 2 )
;               else  UNCHANGED  endif
;         else  UNDEFINED  endif  }
;   "Retrieve Zone Heating UMLHs from CSE export for P-W run - 4"  Zone:NumHtgUMLHs[4] =  
;      {  if (TrackUMLHs > 0.5)
;         then  if (Proj:RunAbbrev == "p-W")
;               then  RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + ValidOr( Proj:RunIDProcFile, "" ) + "-znUMLHs.csv",   2, Name, 2 )
;               else  UNCHANGED  endif
;         else  UNDEFINED  endif  }

	"Calc and store SelfUtilizationCredit (SUC) for this run"		Proj:Action =        ; SAC 07/21/23 (2025)
      {  switch (RunAbbrev)
            case  "s3"	:  EvalRulelist( "CARes_FinalRun_SelfUtilizationCredit" )
            case  "dr"	:  EvalRulelist( "CARes_FinalRun_SelfUtilizationCredit" )
            default	   :  UNCHANGED
         endswitch  }

	"Store energy use summary for this run"		Proj:Action =        ; SAC 07/19/23 (2025)
      {  switch (RunAbbrev)
            case  "pp"	:  UNCHANGED
            	case  "pp-N" : UNCHANGED
            	case  "pp-E" : UNCHANGED
            	case  "pp-S" : UNCHANGED
            	case  "pp-W" : UNCHANGED
            case  "p-N"	:  EvalRulelist( "CARes_ProposedSummary_N" )
            case  "p-E"	:  EvalRulelist( "CARes_ProposedSummary_E" )
            case  "p-S"	:  EvalRulelist( "CARes_ProposedSummary_S" )
            case  "p-W"	:  EvalRulelist( "CARes_ProposedSummary_W" )
            case  "s"	:  if (Proj:CompCodeBase >= 2025 .AND. RunScope == 1 .AND. IfValidAnd( IsAddAlone > 0 )==0) then  UNCHANGED
                           else if (AllOrientations < 0.5)
            					then	EvalRulelist( "CARes_StandardSummary" )
            					else	EvalRulelist( "CARes_StandardSummary_NESW" )  endif endif
      ;      case  "s2"	:  if (AllOrientations < 0.5)
      ;      					then	EvalRulelist( "CARes_StandardSummary_PVonly" )
      ;      					else	EvalRulelist( "CARes_StandardSummary_PVonly_NESW" )  endif
            case  "s3"	:  if (Proj:CompCodeBase < 2025) then  UNCHANGED
                           else if (AllOrientations < 0.5)
            					then	EvalRulelist( "CARes_StandardSummary" )
            					else	EvalRulelist( "CARes_StandardSummary_NESW" )  endif endif
            case  "dr"	:  if (AllOrientations < 0.5)
            					then	EvalRulelist( "CARes_DesignRatingSummary" )
            					else	EvalRulelist( "CARes_DesignRatingSummary_NESW" )  endif
            	   		case  "smf"   :  UNCHANGED  ; EvalRulelist( "CARes_ProposedSummary" )
            case  "pfx"   :  EvalRulelist( "CARes_PropFlexSummary" )
            case  "pfx-N" :  EvalRulelist( "CARes_PropFlexSummary_N" )
            case  "pfx-E" :  EvalRulelist( "CARes_PropFlexSummary_E" )
            case  "pfx-S" :  EvalRulelist( "CARes_PropFlexSummary_S" )
            case  "pfx-W" :  EvalRulelist( "CARes_PropFlexSummary_W" )
            default	     :  EvalRulelist( "CARes_ProposedSummary" )	; for 'u' or 'p' run
         endswitch  }

	"Store source energy summary for all runs"		Proj:Action =        ; SAC 6/12/19
      {  if (ClimateZone > 0.9 .AND. ClimateZone < 16.1 .AND. TrackSrcEnergy)
         then  switch (RunAbbrev)
                  case  "s3"	:  if (AllOrientations < 0.5)
            		      			then	EvalRulelist( "CARes_SourceEnergySummary" )
            				      	else	EvalRulelist( "CARes_SourceEnergySummary_NESW" )  endif
                  case  "dr"	:  if (AllOrientations < 0.5)
            		      			then	EvalRulelist( "CARes_SourceEnergySummary" )
            				      	else	EvalRulelist( "CARes_SourceEnergySummary_NESW" )  endif
                  default	     :  UNCHANGED
               endswitch
         else  UNCHANGED  endif  }

   ; SAC 4/11/19 - revised to populate SummaryTab for 2019 EAA or AdditionAlone models    ; SAC 6/12/19 - 2022   ; SAC 07/19/23 (2025)
	"Store final results summary info"				Proj:Action =
      {  switch (RunAbbrev)
            case  "s"	:  if (EnergyCodeYearNum >= 2019 .AND. RunScope == 1 .AND. IsAddAlone == 0) then  UNCHANGED
                           else if (AllOrientations < 0.5)
                           then	EvalRulelist( "CARes_SummaryTab" )
            					else	EvalRulelist( "CARes_SummaryTab_NESW" )  endif endif
            case  "s3"	:  if (EnergyCodeYearNum >= 2025)
                           then  if (AllOrientations < 0.5)
                  					then	EvalRulelist( "CARes_SummaryTab_2025" )
                  					else	EvalRulelist( "CARes_SummaryTab_2025_NESW" )  endif
                  			else  UNCHANGED  endif
            case  "dr"	:  if (EnergyCodeYearNum >= 2022)
                           then  if (AllOrientations < 0.5)
                  					then	EvalRulelist( "CARes_SummaryTab_2022" )
                  					else	EvalRulelist( "CARes_SummaryTab_2022_NESW" )  endif
            					else if (EnergyCodeYearNum >= 2019)
                           then  if (AllOrientations < 0.5)
                  					then	EvalRulelist( "CARes_SummaryTab_2019" )
                  					else	EvalRulelist( "CARes_SummaryTab_2019_NESW" )  endif
                  			else  UNCHANGED  endif endif
            default		:  UNCHANGED
         endswitch  }
																						
	"Reset Proj:ResultsCurrentMsg"	Proj:ResultsCurrentMsg	= {
         switch (RunAbbrev)
            case  "s"	:  " "
            case  "s2"	:  " "
            case  "s3"	:  " "
            case  "dr"	:  " "
            default		:  UNCHANGED
         endswitch  }

   ; SAC 4/10/17 - address Target Design Rating specification
   "Initiate processing to handle TargetDesignRating"    Proj:Action  = {
         if (LocalStatus( TargetDesignRtg ) < 1 .OR.
             RunAbbrev != "dr") then  UNCHANGED
         else  EvalRulelist( "ProcessResults_TargetDesignRating" )  endif  }

   ; SAC 1/11/18 - prevent reporting of negative EDRs (depending on INI option)
   "Evaluate rules to prevent negative EDR reporting"    Proj:Action  = {
         if (RunAbbrev != "dr" .OR. IfValidAnd( AllowNegativeDesignRatings > 0 )) then  UNCHANGED
         else if (LocalStatus( TargetDesignRtg ) > 0 .AND.
                  IfValidAnd( TargetDRtgIterNum > 0 )) then  UNCHANGED
         else  EvalRulelist( "ProcessResults_PreventReportingNegativeEDRs" )  endif endif  }

;"debug"  Proj:Action = {  PostMessageToLog( "  evaluating 'CARes_ProcessResults':  RunAbbrev '%s'  RunNumber %g  - ResultSummary[1]:TargetDRtgPVMult = %g", RunAbbrev, RunNumber, ValidOr( ResultSummary[1]:TargetDRtgPVMult, -999 ) )  }
   "Call rulelist to report PV scaling"   Proj:Action =           ; add logic for 2025 max PV scaling overriding std PV scaling - SAC 07/26/23 (2025)
      {  switch (RunAbbrev)
            case  "dr"  :  if (IfValidAnd( ResultSummary[1]:TargetDRtgPVMult  != 1 ))
                           then  if (AllOrientations < 0.5)
                                 then  EvalRulelist( "ProcessResults_PVScalingMessage" )
                                 else  EvalRulelist( "ProcessResults_PVScalingMessage_NESW" )  endif
                           else  UNCHANGED  endif
            case  "p"   :  if (IfValidAnd( PVWDCSysTotal > 0 )==0) then  UNCHANGED
                           else if (IfValidAnd( ResultSummary[1]:TargetDRtgPVMult  != 1 ) .OR.
                                    LocalStatus( ResultSummary[1]:RedPVRqPVScalingMsg ) > 0 .OR.
                                    LocalStatus( ResultSummary[1]:UserPVScalingMsg ) > 0 .OR.
                                     ((IfValidAnd( ResultSummary[1]:PropPVScaleFactor != 1 ) .OR.
                                       IfValidAnd( ResultSummary[1]:PropInputPVMult   <  1 ) .OR.
                                       ( CompCodeBase >= 2025 .AND. PVSizeOption == 1 .AND. 
                                         IfValidAnd( UseReducedPVReqVal >= 0 )==0 .AND. IfValidAnd( T24RPrescribedPV >= 0 ) .AND.
                                         (ValidOr( T24RPrescribedPV, 0 ) / ValidOr( PVWDCSysTotal, 0.1 )) > ValidOr( ResultSummary[1]:PropInputPVMult, 999 ) ) ) .AND.
                                      IfValidAnd( MaxPropPVRatio > 0 )))
                           then  EvalRulelist( "ProcessResults_PVScalingMessage" )
                           else  UNCHANGED  endif endif
            case  "p-N" :  if (IfValidAnd( ResultSummary[2]:TargetDRtgPVMult  != 1 ) .OR.
                                LocalStatus( ResultSummary[2]:RedPVRqPVScalingMsg ) > 0 .OR.
                                LocalStatus( ResultSummary[2]:UserPVScalingMsg ) > 0 .OR.
                                 ((IfValidAnd( ResultSummary[2]:PropPVScaleFactor != 1 ) .OR.
                                   IfValidAnd( ResultSummary[2]:PropInputPVMult   <  1 )) .AND. IfValidAnd( MaxPropPVRatio > 0 )))
                           then  EvalRulelist( "ProcessResults_PVScalingMessage_N" )
                           else  UNCHANGED  endif
            case  "p-E" :  if (IfValidAnd( ResultSummary[3]:TargetDRtgPVMult  != 1 ) .OR.
                                LocalStatus( ResultSummary[3]:RedPVRqPVScalingMsg ) > 0 .OR.
                                LocalStatus( ResultSummary[3]:UserPVScalingMsg ) > 0 .OR.
                                 ((IfValidAnd( ResultSummary[3]:PropPVScaleFactor != 1 ) .OR.
                                   IfValidAnd( ResultSummary[3]:PropInputPVMult   <  1 )) .AND. IfValidAnd( MaxPropPVRatio > 0 )))
                           then  EvalRulelist( "ProcessResults_PVScalingMessage_E" )
                           else  UNCHANGED  endif
            case  "p-S" :  if (IfValidAnd( ResultSummary[4]:TargetDRtgPVMult  != 1 ) .OR.
                                LocalStatus( ResultSummary[4]:RedPVRqPVScalingMsg ) > 0 .OR.
                                LocalStatus( ResultSummary[4]:UserPVScalingMsg ) > 0 .OR.
                                 ((IfValidAnd( ResultSummary[4]:PropPVScaleFactor != 1 ) .OR.
                                   IfValidAnd( ResultSummary[4]:PropInputPVMult   <  1 )) .AND. IfValidAnd( MaxPropPVRatio > 0 )))
                           then  EvalRulelist( "ProcessResults_PVScalingMessage_S" )
                           else  UNCHANGED  endif
            case  "p-W" :  if (IfValidAnd( ResultSummary[5]:TargetDRtgPVMult  != 1 ) .OR.
                                LocalStatus( ResultSummary[5]:RedPVRqPVScalingMsg ) > 0 .OR.
                                LocalStatus( ResultSummary[5]:UserPVScalingMsg ) > 0 .OR.
                                 ((IfValidAnd( ResultSummary[5]:PropPVScaleFactor != 1 ) .OR.
                                   IfValidAnd( ResultSummary[5]:PropInputPVMult   <  1 )) .AND. IfValidAnd( MaxPropPVRatio > 0 )))
                           then  EvalRulelist( "ProcessResults_PVScalingMessage_W" )
                           else  UNCHANGED  endif
            default     :  UNCHANGED
         endswitch  }
   ; SAC 1/12/18 - replaced several old rules w/ above to minimize # of evaluations

   "Call rulelist to report PV exceeding Proposed electric use"   Proj:Action = {
         switch (RunAbbrev)
            case  "dr"  :  if (IfValidAnd( ResultSummary[1]:TargetDRtgPVMult != 1 ) .AND.
                               IfValidAnd( EnergyCodeYearNum >= 2019 ) .AND.
                               IfValidAnd( RunResults[10]:PropElecEnergy[1] < 0 ) .AND.
                               IfValidAnd( CondFloorArea > 0 ))
                           then  EvalRulelist( "ProcessResults_ExcessPVMessage" )
                           else  UNCHANGED  endif
            case  "p"   :  if (IfValidAnd( EnergyCodeYearNum >= 2019 ) .AND.
                               IfValidAnd( RunResults[10]:PropElecEnergy[1] < 0 ) .AND.
                               IfValidAnd( CondFloorArea > 0 ))
                           then  EvalRulelist( "ProcessResults_ExcessPVMessage" )
                           else  UNCHANGED  endif
            case  "p-N" :  if (IfValidAnd( EnergyCodeYearNum >= 2019 ) .AND.
                               IfValidAnd( RunResultsN[10]:PropElecEnergy[1] < 0 ) .AND.
                               IfValidAnd( CondFloorArea > 0 ))
                           then  EvalRulelist( "ProcessResults_ExcessPVMessage_N" )
                           else  UNCHANGED  endif
            case  "p-E" :  if (IfValidAnd( EnergyCodeYearNum >= 2019 ) .AND.
                               IfValidAnd( RunResultsE[10]:PropElecEnergy[1] < 0 ) .AND.
                               IfValidAnd( CondFloorArea > 0 ))
                           then  EvalRulelist( "ProcessResults_ExcessPVMessage_E" )
                           else  UNCHANGED  endif
            case  "p-S" :  if (IfValidAnd( EnergyCodeYearNum >= 2019 ) .AND.
                               IfValidAnd( RunResultsS[10]:PropElecEnergy[1] < 0 ) .AND.
                               IfValidAnd( CondFloorArea > 0 ))
                           then  EvalRulelist( "ProcessResults_ExcessPVMessage_S" )
                           else  UNCHANGED  endif
            case  "p-W" :  if (IfValidAnd( EnergyCodeYearNum >= 2019 ) .AND.
                               IfValidAnd( RunResultsW[10]:PropElecEnergy[1] < 0 ) .AND.
                               IfValidAnd( CondFloorArea > 0 ))
                           then  EvalRulelist( "ProcessResults_ExcessPVMessage_W" )
                           else  UNCHANGED  endif
            default     :  UNCHANGED
         endswitch  }

   "Call rulelist to store Proposed DHW SSFs for OG-300 solar systems"  Proj:Action =           ; SAC 6/23/20 (tic #1210)
      {  if (SumAcrossIf( DHWSolarSys:FloorAreaServed, DHWSolarSys:RatingProgram = 3 ) > 1)
         then  switch (RunAbbrev)
                  case  "p"   :  EvalRulelist( "ProcessResults_DHWSolarSys_OG300SSF" )
                  case  "p-N" :  EvalRulelist( "ProcessResults_DHWSolarSys_OG300SSF_N" )
                  case  "p-E" :  EvalRulelist( "ProcessResults_DHWSolarSys_OG300SSF_E" )
                  case  "p-S" :  EvalRulelist( "ProcessResults_DHWSolarSys_OG300SSF_S" )
                  case  "p-W" :  EvalRulelist( "ProcessResults_DHWSolarSys_OG300SSF_W" )
                  default     :  UNCHANGED
               endswitch
         else  UNCHANGED  endif  }

   "Call rulelist to report Proposed and/or Standard DHW SSF"   Proj:Action =             ; SAC 6/22/20 (tic #1208)
      {  switch (RunAbbrev)
            case  "dr"  :  if (IfValidAnd( ResultSummary[1]:PropDHW_SSF[1] > 0 ) .OR.
                               IfValidAnd( ResultSummary[1]:StdDHW_SSF > 0 ))
                           then  if (AllOrientations < 0.5)
                  					then	EvalRulelist( "CARes_ReportDHWSSF" )
                  					else	EvalRulelist( "CARes_ReportDHWSSF_NESW" )  endif
                  			else  UNCHANGED  endif
            default     :  UNCHANGED
         endswitch  }

; don't think we need this, now that first round analysis should properly handle auto-sized ht pumps - SAC 03/15/21
;   "Set EUseSummary:NumPropSmlHPAutoSz - # of Proposed model HPs modeled w/ low std fan power due to auto-sized, which may invalidate results"   ; SAC 03/11/21
;      EUseSummary:NumPropSmlHPAutoSz =
;         {  if (Proj:RunAbbrev == "pp" .OR. Proj:RunAbbrev == "pp-N" .OR. Proj:RunAbbrev == "pp-E" .OR.
;                                            Proj:RunAbbrev == "pp-S" .OR. Proj:RunAbbrev == "pp-W")
;            then  SumAll( HVACSys:PropSmlHtPumpAutoSz )
;            else  UNCHANGED  endif  }


   "Retrieve Heating capacities from CSE results for P, S & DR runs"    HVACSys:RunHtgCap =        ; SAC 03/15/21
      {  if (FloorAreaServed[1] > 0.5)
         then  switch (Proj:RunAbbrev)
                  case  "p"   :  RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + " - Prop-HVACCaps.csv",   2, Name, 1 )
                  case  "p-N" :  RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + " - Prop-N-HVACCaps.csv", 2, Name, 1 )
                  case  "p-E" :  RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + " - Prop-E-HVACCaps.csv", 2, Name, 1 )
                  case  "p-S" :  RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + " - Prop-S-HVACCaps.csv", 2, Name, 1 )
                  case  "p-W" :  RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + " - Prop-W-HVACCaps.csv", 2, Name, 1 )
                  case  "s"   :  RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + " - Std-HVACCaps.csv",    2, Name, 1 )
                  case  "dr"  :  RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + " - DRtg-HVACCaps.csv",   2, Name, 1 )
                  default     :  UNDEFINED
               endswitch
         else  UNDEFINED  endif  }
   "Retrieve Cooling capacities from CSE results for P, S & DR runs"    HVACSys:RunClgCap = 
      {  if (FloorAreaServed[1] > 0.5)
         then  switch (Proj:RunAbbrev)
                  case  "p"   :  RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + " - Prop-HVACCaps.csv",   2, Name, 2 )
                  case  "p-N" :  RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + " - Prop-N-HVACCaps.csv", 2, Name, 2 )
                  case  "p-E" :  RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + " - Prop-E-HVACCaps.csv", 2, Name, 2 )
                  case  "p-S" :  RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + " - Prop-S-HVACCaps.csv", 2, Name, 2 )
                  case  "p-W" :  RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + " - Prop-W-HVACCaps.csv", 2, Name, 2 )
                  case  "s"   :  RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + " - Std-HVACCaps.csv",    2, Name, 2 )
                  case  "dr"  :  RetrieveCSVValue( ValidOr( Proj:ProcessingPath, "" ) + ValidOr( Proj:ProjFileNameNoExt, "" ) + " - DRtg-HVACCaps.csv",   2, Name, 2 )
                  default     :  UNDEFINED
               endswitch
         else  UNDEFINED  endif  }
   "Set EUseSummary:NumPropHVACSystems - # of proposed HVAC systems"    EUseSummary:NumPropHVACSystems =       ; SAC 03/16/21
      {  if (Proj:RunAbbrev == "p" .OR. Proj:RunAbbrev == "p-N")
         then  SumAcrossIf( HVACSys:TypeOK, HVACSys:FloorAreaServed[1] > 0.5 )
         else  UNCHANGED  endif  }
   "Set EUseSummary:NumPropHVACEquips - Count of HVAC equipment (heat pumps and/or furnace/AC pairs)"    EUseSummary:NumPropHVACEquips = 
      {  if (Proj:RunAbbrev == "p" .OR. Proj:RunAbbrev == "p-N")
         then  SumAcrossIf( HVACSys:MaxNumHVACEquipTypes, HVACSys:FloorAreaServed[1] > 0.5 )
         else  UNCHANGED  endif  }
   "Sum HVAC heating capacities across systems into totals by run - TotalHVACHtgCap[1-7]"  for:#RN=(1to7)  EUseSummary:TotalHVACHtgCap[#RN] =   ; SAC 03/16/21
      {  switch (Proj:RunAbbrev)
            case  "p"   :  if (#RN == 1) then  SumAll( HVACSys:RunHtgCap )  else  UNCHANGED  endif
            case  "p-N" :  if (#RN == 2) then  SumAll( HVACSys:RunHtgCap )  else  UNCHANGED  endif
            case  "p-E" :  if (#RN == 3) then  SumAll( HVACSys:RunHtgCap )  else  UNCHANGED  endif
            case  "p-S" :  if (#RN == 4) then  SumAll( HVACSys:RunHtgCap )  else  UNCHANGED  endif
            case  "p-W" :  if (#RN == 5) then  SumAll( HVACSys:RunHtgCap )  else  UNCHANGED  endif
            case  "s"   :  if (#RN == 6) then  SumAll( HVACSys:RunHtgCap )  else  UNCHANGED  endif
            case  "dr"  :  if (#RN == 7) then  SumAll( HVACSys:RunHtgCap )  else  UNCHANGED  endif
            default     :  UNCHANGED
         endswitch  }
   "Sum HVAC cooling capacities across systems into totals by run - TotalHVACClgCap[1-7]"  for:#RN=(1to7)  EUseSummary:TotalHVACClgCap[#RN] = 
      {  switch (Proj:RunAbbrev)
            case  "p"   :  if (#RN == 1) then  SumAll( HVACSys:RunClgCap )  else  UNCHANGED  endif
            case  "p-N" :  if (#RN == 2) then  SumAll( HVACSys:RunClgCap )  else  UNCHANGED  endif
            case  "p-E" :  if (#RN == 3) then  SumAll( HVACSys:RunClgCap )  else  UNCHANGED  endif
            case  "p-S" :  if (#RN == 4) then  SumAll( HVACSys:RunClgCap )  else  UNCHANGED  endif
            case  "p-W" :  if (#RN == 5) then  SumAll( HVACSys:RunClgCap )  else  UNCHANGED  endif
            case  "s"   :  if (#RN == 6) then  SumAll( HVACSys:RunClgCap )  else  UNCHANGED  endif
            case  "dr"  :  if (#RN == 7) then  SumAll( HVACSys:RunClgCap )  else  UNCHANGED  endif
            default     :  UNCHANGED
         endswitch  }

   "Sum Std design Central HPWH auto-sized capacity"              EUseSummary:StdCHPWHCap =        ; SAC 07/20/21 (tic #1275)
      {  if (Proj:RunAbbrev == "s")
         then  SumAll( cseDHWHEATER:AutoSzCap ) / 3412
         else  UNCHANGED  endif  }
   "Sum Std design Central HPWH auto-sized primary tank volume"   EUseSummary:StdCHPWHVol = 
      {  if (Proj:RunAbbrev == "s")
         then  SumAll( cseDHWHEATER:AutoSzVol )
         else  UNCHANGED  endif  }
;"dbg" Proj:Action = { if (Proj:RunAbbrev == "s") then  StoreBEMProc( Format( "AutoszdCHPWH results-std" ), 0 )  else UNCHANGED endif }

   ; SAC 11/6/17 - moved all CAHP-related 2016 rules into separate Rule module
   "Perform CAHP analysis"				Proj:Action = {
         if (EnergyCodeYearNum != 2016) then  UNCHANGED
         else  EvalRulelist( "CAHP_2016" )  endif  }

   "Store combined PV+Battery results to special EUseSummary array for display in 2025+ UI"     Proj:Action =     ; SAC 06/07/23
      {  if (EnergyCodeYearNum >= 2025)
         then  EvalRulelist( "EUseSummary_CombinePVBatteryResults" )
         else  UNCHANGED  endif  }

  ; SAC 2/4/16 - store model details following results storage for User model (research mode)
	"store research mode details"		Proj:Action = {	if (RunAbbrev == "u") then  StoreBEMProc( "UserModelDetails", 0 )
																		else	UNCHANGED  endif  }

;"store BEMProc details"		Proj:Action = {  StoreBEMProc( Format( "aft ProcessResults for %s", RunAbbrev ), 0 )  }
END


;*************************************************************************
RULELIST "ProcessResults_PVScalingMessage" 1 0 1 1
   ; SAC 12/7/17 - revised scaling messages to not report for scaling mults between 0.995 & 1.005 (tic #930)
   ; SAC 12/30/17 - added logic to label new 2019 scenario where PV scaled via PrelimProposed simulation
   ; SAC 1/2/18 - added logic referencing EUseSummary:UserPVScalingMsg to report user-initiated PV scaling (tic #923)
   ; SAC 2/6/18 - added logic referencing EUseSummary:RedPVRqPVScalingMsg to report PV system scaling based on Reduced PV Requirement (tic #974)
   ; SAC 8/30/19 - minor rewording of some messages (tic #1056)
   ; added logic to document PV scaling when Std PV scaling limited when it exceeds max Prop PV - SAC 07/26/23 (2025)
   "Set ResultSummary[1]:ResultsNotes[1] to report PV scaling"
      Proj:ResultSummary[1]:ResultsNotes[1]  = {
         if ((IfValidAnd( ResultSummary[1]:TargetDRtgPVMult  <= 0.995 ) .OR. IfValidAnd( ResultSummary[1]:TargetDRtgPVMult  >= 1.005 )) .AND. 
             (IfValidAnd( ResultSummary[1]:PropPVScaleFactor <= 0.995 ) .OR. IfValidAnd( ResultSummary[1]:PropPVScaleFactor >= 1.005 )) .AND. IfValidAnd( MaxPropPVRatio > 0 ))
         then  if (IfValidAnd( Proj:PVWLastRow > 1 ))
               then  Format( "Proposed PV system(s) scaled by a factor of %.3f to approach target EDR (but capped @ %g x prop design elec use)", ResultSummary[1]:TargetDRtgPVMult, MaxPropPVRatio )
               else if (ResultSummary[1]:TargetDRtgPVMult < 1)
               then  Format( "Proposed PV system downsized to %.2f kWdc (a factor of %.3f) to approach target EDR (but capped @ %g x prop design elec use)", (PVWDCSysTotal * ResultSummary[1]:TargetDRtgPVMult), ResultSummary[1]:TargetDRtgPVMult, MaxPropPVRatio )
               else  Format( "Proposed PV system increased to %.2f kWdc (a factor of %.3f) to approach target EDR (but capped @ %g x prop design elec use)", (PVWDCSysTotal * ResultSummary[1]:TargetDRtgPVMult), ResultSummary[1]:TargetDRtgPVMult, MaxPropPVRatio )
               endif endif
         else if (IfValidAnd( ResultSummary[1]:TargetDRtgPVMult  <= 0.995 ) .OR. IfValidAnd( ResultSummary[1]:TargetDRtgPVMult  >= 1.005 ))
         then  if (IfValidAnd( Proj:PVWLastRow > 1 ))
               then  Format( "Proposed PV system(s) scaled by a factor of %.3f to achieve target energy design rating", ResultSummary[1]:TargetDRtgPVMult )
               else if (ResultSummary[1]:TargetDRtgPVMult < 1)
               then  Format( "Proposed PV system downsized to %.2f kWdc (a factor of %.3f) to achieve target energy design rating", (PVWDCSysTotal * ResultSummary[1]:TargetDRtgPVMult), ResultSummary[1]:TargetDRtgPVMult )
               else  Format( "Proposed PV system increased to %.2f kWdc (a factor of %.3f) to achieve target energy design rating", (PVWDCSysTotal * ResultSummary[1]:TargetDRtgPVMult), ResultSummary[1]:TargetDRtgPVMult )
               endif endif
         else if (LocalStatus( ResultSummary[1]:RedPVRqPVScalingMsg ) > 0)
         then  ResultSummary[1]:RedPVRqPVScalingMsg
         else if (LocalStatus( ResultSummary[1]:UserPVScalingMsg ) > 0)
         then  ResultSummary[1]:UserPVScalingMsg
         else if (IfValidAnd( ResultSummary[1]:PropInputPVMult < 1 ) .AND. IfValidAnd( MaxPropPVRatio > 0 ))
         then  if (IfValidAnd( ResultSummary[1]:PropInputPVMult > 0.995 )) then  UNDEFINED
               else if (IfValidAnd( Proj:PVWLastRow > 1 ))
               then  Format( "Proposed PV system(s) scaled by a factor of %.3f due to cap of %g x proposed design electricity use", ResultSummary[1]:PropInputPVMult, MaxPropPVRatio )
               else  Format( "Proposed PV system downsized to %.2f kWdc (a factor of %.3f) due to cap of %g x proposed design electricity use", (PVWDCSysTotal * ResultSummary[1]:PropInputPVMult), ResultSummary[1]:PropInputPVMult, MaxPropPVRatio )
               endif endif
         else if (LocalStatus( ResultSummary[1]:ResultsNotes[1] ) < 1 .AND. CompCodeBase >= 2025 .AND. PVSizeOption == 1 .AND.
                  IfValidAnd( UseReducedPVReqVal >= 0 )==0 .AND. IfValidAnd( T24RPrescribedPV >= 0 ) .AND.
                  (ValidOr( T24RPrescribedPV, 0 ) / ValidOr( PVWDCSysTotal, 0.1 )) > ValidOr( ResultSummary[1]:PropInputPVMult, 999 ))
         then  Format( "Proposed PV system(s) scaled by a factor of %.3f due to cap of %g x proposed design electricity use", ResultSummary[1]:PropInputPVMult, MaxPropPVRatio )
         else if ((IfValidAnd( ResultSummary[1]:PropPVScaleFactor <= 0.995 ) .OR. IfValidAnd( ResultSummary[1]:PropPVScaleFactor >= 1.005 )) .AND. IfValidAnd( MaxPropPVRatio > 0 ))
         then  if (IfValidAnd( Proj:PVWLastRow > 1 ))
               then  Format( "Proposed PV system(s) scaled by a factor of %.3f due to cap of %g x proposed design electricity use", ResultSummary[1]:PropPVScaleFactor, MaxPropPVRatio )
               else  Format( "Proposed PV system downsized to %.2f kWdc (a factor of %.3f) due to cap of %g x proposed design electricity use", (PVWDCSysTotal * ResultSummary[1]:PropPVScaleFactor), ResultSummary[1]:PropPVScaleFactor, MaxPropPVRatio )
               endif
         else  UNCHANGED  endif endif endif endif endif endif endif  }
   "Set ResultSummary[1]:HaveResultsNotesPV[1] related to PV scaling"
      Proj:ResultSummary[1]:HaveResultsNotesPV[1]  = {
         if (LocalStatus( ResultSummary[1]:ResultsNotes[1] ) < 1) then  0
         else if (strlen( ResultSummary[1]:ResultsNotes[1] ) > 2) then  1
         else  0  endif endif  }
;"dbg log msg" Proj:Action = { if (ResultSummary[1]:HaveResultsNotesPV[1]) then  PostMessageToLog( "   ResultSummary[1]:ResultsNotes[1] = '%s'", ResultSummary[1]:ResultsNotes[1] )
;   else  PostMessageToLog( "   ResultSummary[1]:ResultsNotes[1] undefined" )  endif  }

   "Set ResultSummary[1]:ResultsNotes[4] to report PV scaling"
      Proj:ResultSummary[1]:ResultsNotes[4]  = {
         if (ResultSummary[1]:HaveResultsNotesPV[1] < 1) then  UNDEFINED
         else  ResultSummary[1]:ResultsNotes[1]  endif  }
   "Set ResultSummary[1]:HaveResultsNotesPV[4] to report PV scaling"
      Proj:ResultSummary[1]:HaveResultsNotesPV[4]  = {
         if (ResultSummary[1]:HaveResultsNotesPV[1] < 1) then  0
         else  1  endif  }
END
;*************************************************************************
RULELIST "ProcessResults_PVScalingMessage_NESW" 1 0 1 1
   "PV Scaling msg"     Proj:Action = {  EvalRulelist( "ProcessResults_PVScalingMessage"   )  }
   "PV Scaling msg-N"   Proj:Action = {  EvalRulelist( "ProcessResults_PVScalingMessage_N" )  }
   "PV Scaling msg-E"   Proj:Action = {  EvalRulelist( "ProcessResults_PVScalingMessage_E" )  }
   "PV Scaling msg-S"   Proj:Action = {  EvalRulelist( "ProcessResults_PVScalingMessage_S" )  }
   "PV Scaling msg-W"   Proj:Action = {  EvalRulelist( "ProcessResults_PVScalingMessage_W" )  }
END
;*************************************************************************
RULELIST "ProcessResults_PVScalingMessage_N" 1 0 1 1
   ; SAC 12/7/17 - revised scaling messages to not report for scaling mults between 0.995 & 1.005 (tic #930)
   ; SAC 1/11/18 - added logic to label new 2019 scenario where PV scaled via PrelimProposed simulation
   ; SAC 1/11/18 - added logic referencing EUseSummary:UserPVScalingMsg to report user-initiated PV scaling (tic #923)
   ; SAC 8/30/19 - minor rewording of some messages (tic #1056)
   "Set ResultSummary[2]:ResultsNotes[1] to report PV scaling"
      Proj:ResultSummary[2]:ResultsNotes[1]  = {
         if ((IfValidAnd( ResultSummary[2]:TargetDRtgPVMult  <= 0.995 ) .OR. IfValidAnd( ResultSummary[2]:TargetDRtgPVMult  >= 1.005 )) .AND. 
             (IfValidAnd( ResultSummary[2]:PropPVScaleFactor <= 0.995 ) .OR. IfValidAnd( ResultSummary[2]:PropPVScaleFactor >= 1.005 )) .AND. IfValidAnd( MaxPropPVRatio > 0 ))
         then  if (IfValidAnd( Proj:PVWLastRow > 1 ))
               then  Format( "Proposed PV system(s) scaled by a factor of %.3f to approach target EDR (but capped @ %g x prop design elec use)", ResultSummary[2]:TargetDRtgPVMult, MaxPropPVRatio )
               else if (ResultSummary[2]:TargetDRtgPVMult < 1)
               then  Format( "Proposed PV system downsized to %.2f kWdc (a factor of %.3f) to approach target EDR (but capped @ %g x prop design elec use)", (PVWDCSysTotal * ResultSummary[2]:TargetDRtgPVMult), ResultSummary[2]:TargetDRtgPVMult, MaxPropPVRatio )
               else  Format( "Proposed PV system increased to %.2f kWdc (a factor of %.3f) to approach target EDR (but capped @ %g x prop design elec use)", (PVWDCSysTotal * ResultSummary[2]:TargetDRtgPVMult), ResultSummary[2]:TargetDRtgPVMult, MaxPropPVRatio )
               endif endif
         else if (IfValidAnd( ResultSummary[2]:TargetDRtgPVMult  <= 0.995 ) .OR. IfValidAnd( ResultSummary[2]:TargetDRtgPVMult  >= 1.005 ))
         then  if (IfValidAnd( Proj:PVWLastRow > 1 ))
               then  Format( "Proposed PV system(s) scaled by a factor of %.3f to achieve target energy design rating", ResultSummary[2]:TargetDRtgPVMult )
               else if (ResultSummary[2]:TargetDRtgPVMult < 1)
               then  Format( "Proposed PV system downsized to %.2f kWdc (a factor of %.3f) to achieve target energy design rating", (PVWDCSysTotal * ResultSummary[2]:TargetDRtgPVMult), ResultSummary[2]:TargetDRtgPVMult )
               else  Format( "Proposed PV system increased to %.2f kWdc (a factor of %.3f) to achieve target energy design rating", (PVWDCSysTotal * ResultSummary[2]:TargetDRtgPVMult), ResultSummary[2]:TargetDRtgPVMult )
               endif endif
         else if (LocalStatus( ResultSummary[2]:RedPVRqPVScalingMsg ) > 0)
         then  ResultSummary[2]:RedPVRqPVScalingMsg
         else if (LocalStatus( ResultSummary[2]:UserPVScalingMsg ) > 0)
         then  ResultSummary[2]:UserPVScalingMsg
         else if (IfValidAnd( ResultSummary[2]:PropInputPVMult < 1 ) .AND. IfValidAnd( MaxPropPVRatio > 0 ))
         then  if (IfValidAnd( ResultSummary[2]:PropInputPVMult > 0.995 )) then  UNDEFINED
               else if (IfValidAnd( Proj:PVWLastRow > 1 ))
               then  Format( "Proposed PV system(s) scaled by a factor of %.3f due to cap of %g x proposed design electricity use", ResultSummary[2]:PropInputPVMult, MaxPropPVRatio )
               else  Format( "Proposed PV system downsized to %.2f kWdc (a factor of %.3f) due to cap of %g x proposed design electricity use", (PVWDCSysTotal * ResultSummary[2]:PropInputPVMult), ResultSummary[2]:PropInputPVMult, MaxPropPVRatio )
               endif endif
         else if ((IfValidAnd( ResultSummary[2]:PropPVScaleFactor <= 0.995 ) .OR. IfValidAnd( ResultSummary[2]:PropPVScaleFactor >= 1.005 )) .AND. IfValidAnd( MaxPropPVRatio > 0 ))
         then  if (IfValidAnd( Proj:PVWLastRow > 1 ))
               then  Format( "Proposed PV system(s) scaled by a factor of %.3f due to cap of %g x proposed design electricity use", ResultSummary[2]:PropPVScaleFactor, MaxPropPVRatio )
               else  Format( "Proposed PV system downsized to %.2f kWdc (a factor of %.3f) due to cap of %g x proposed design electricity use", (PVWDCSysTotal * ResultSummary[2]:PropPVScaleFactor), ResultSummary[2]:PropPVScaleFactor, MaxPropPVRatio )
               endif
         else  UNCHANGED  endif endif endif endif endif endif  }
   "Set ResultSummary[2]:HaveResultsNotesPV[1] related to PV scaling"
      Proj:ResultSummary[2]:HaveResultsNotesPV[1]  = {
         if (LocalStatus( ResultSummary[2]:ResultsNotes[1] ) < 1) then  0
         else if (strlen( ResultSummary[2]:ResultsNotes[1] ) > 2) then  1
         else  0  endif endif  }

   "Set ResultSummary[2]:ResultsNotes[4] to report PV scaling"
      Proj:ResultSummary[2]:ResultsNotes[4]  = {
         if (ResultSummary[2]:HaveResultsNotesPV[1] < 1) then  UNDEFINED
         else if (IfValidAnd( ResultSummary[2]:TargetDRtgPVMult  <= 0.995 ) .OR. IfValidAnd( ResultSummary[2]:TargetDRtgPVMult  >= 1.005 ))
         then  Format( "  North (%.2f kWdc)", (PVWDCSysTotal * ResultSummary[2]:TargetDRtgPVMult) )
         else if (LocalStatus( ResultSummary[2]:UserPVScalingMsg ) > 0 .OR. LocalStatus( ResultSummary[2]:RedPVRqPVScalingMsg ) > 0)
         then  Format( "  North (%.2f kWdc)", (PVWDCSysTotal * Proj:PVWDCSizeMultiplier[1]) )
         else if (IfValidAnd( ResultSummary[2]:PropInputPVMult <= 0.995 ) .AND. IfValidAnd( MaxPropPVRatio > 0 ))
         then  Format( "  North (%.2f kWdc)", (PVWDCSysTotal * ResultSummary[2]:PropInputPVMult) )
         else if ((IfValidAnd( ResultSummary[2]:PropPVScaleFactor <= 0.995 ) .OR. IfValidAnd( ResultSummary[2]:PropPVScaleFactor >= 1.005 )) .AND. IfValidAnd( MaxPropPVRatio > 0 ))
         then  Format( "  North (%.2f kWdc)", (PVWDCSysTotal * ResultSummary[2]:PropPVScaleFactor) )
         else  UNDEFINED  endif endif endif endif endif  }
   "Set ResultSummary[2]:HaveResultsNotesPV[4] to report PV scaling"
      Proj:ResultSummary[2]:HaveResultsNotesPV[4]  = {
         if (ResultSummary[2]:HaveResultsNotesPV[1] < 1) then  0
         else  1  endif  }
END
;*************************************************************************
RULELIST "ProcessResults_PVScalingMessage_E" 1 0 1 1
   ; SAC 12/7/17 - revised scaling messages to not report for scaling mults between 0.995 & 1.005 (tic #930)
   ; SAC 1/11/18 - added logic to label new 2019 scenario where PV scaled via PrelimProposed simulation
   ; SAC 1/11/18 - added logic referencing EUseSummary:UserPVScalingMsg to report user-initiated PV scaling (tic #923)
   ; SAC 8/30/19 - minor rewording of some messages (tic #1056)
   "Set ResultSummary[3]:ResultsNotes[1] to report PV scaling"
      Proj:ResultSummary[3]:ResultsNotes[1]  = {
         if ((IfValidAnd( ResultSummary[3]:TargetDRtgPVMult  <= 0.995 ) .OR. IfValidAnd( ResultSummary[3]:TargetDRtgPVMult  >= 1.005 )) .AND. 
             (IfValidAnd( ResultSummary[3]:PropPVScaleFactor <= 0.995 ) .OR. IfValidAnd( ResultSummary[3]:PropPVScaleFactor >= 1.005 )) .AND. IfValidAnd( MaxPropPVRatio > 0 ))
         then  if (IfValidAnd( Proj:PVWLastRow > 1 ))
               then  Format( "Proposed PV system(s) scaled by a factor of %.3f to approach target EDR (but capped @ %g x prop design elec use)", ResultSummary[3]:TargetDRtgPVMult, MaxPropPVRatio )
               else if (ResultSummary[3]:TargetDRtgPVMult < 1)
               then  Format( "Proposed PV system downsized to %.2f kWdc (a factor of %.3f) to approach target EDR (but capped @ %g x prop design elec use)", (PVWDCSysTotal * ResultSummary[3]:TargetDRtgPVMult), ResultSummary[3]:TargetDRtgPVMult, MaxPropPVRatio )
               else  Format( "Proposed PV system increased to %.2f kWdc (a factor of %.3f) to approach target EDR (but capped @ %g x prop design elec use)", (PVWDCSysTotal * ResultSummary[3]:TargetDRtgPVMult), ResultSummary[3]:TargetDRtgPVMult, MaxPropPVRatio )
               endif endif
         else if (IfValidAnd( ResultSummary[3]:TargetDRtgPVMult  <= 0.995 ) .OR. IfValidAnd( ResultSummary[3]:TargetDRtgPVMult  >= 1.005 ))
         then  if (IfValidAnd( Proj:PVWLastRow > 1 ))
               then  Format( "Proposed PV system(s) scaled by a factor of %.3f to achieve target energy design rating", ResultSummary[3]:TargetDRtgPVMult )
               else if (ResultSummary[3]:TargetDRtgPVMult < 1)
               then  Format( "Proposed PV system downsized to %.2f kWdc (a factor of %.3f) to achieve target energy design rating", (PVWDCSysTotal * ResultSummary[3]:TargetDRtgPVMult), ResultSummary[3]:TargetDRtgPVMult )
               else  Format( "Proposed PV system increased to %.2f kWdc (a factor of %.3f) to achieve target energy design rating", (PVWDCSysTotal * ResultSummary[3]:TargetDRtgPVMult), ResultSummary[3]:TargetDRtgPVMult )
               endif endif
         else if (LocalStatus( ResultSummary[3]:RedPVRqPVScalingMsg ) > 0)
         then  ResultSummary[3]:RedPVRqPVScalingMsg
         else if (LocalStatus( ResultSummary[3]:UserPVScalingMsg ) > 0)
         then  ResultSummary[3]:UserPVScalingMsg
         else if (IfValidAnd( ResultSummary[3]:PropInputPVMult < 1 ) .AND. IfValidAnd( MaxPropPVRatio > 0 ))
         then  if (IfValidAnd( ResultSummary[3]:PropInputPVMult > 0.995 )) then  UNDEFINED
               else if (IfValidAnd( Proj:PVWLastRow > 1 ))
               then  Format( "Proposed PV system(s) scaled by a factor of %.3f due to cap of %g x proposed design electricity use", ResultSummary[3]:PropInputPVMult, MaxPropPVRatio )
               else  Format( "Proposed PV system downsized to %.2f kWdc (a factor of %.3f) due to cap of %g x proposed design electricity use", (PVWDCSysTotal * ResultSummary[3]:PropInputPVMult), ResultSummary[3]:PropInputPVMult, MaxPropPVRatio )
               endif endif
         else if ((IfValidAnd( ResultSummary[3]:PropPVScaleFactor <= 0.995 ) .OR. IfValidAnd( ResultSummary[3]:PropPVScaleFactor >= 1.005 )) .AND. IfValidAnd( MaxPropPVRatio > 0 ))
         then  if (IfValidAnd( Proj:PVWLastRow > 1 ))
               then  Format( "Proposed PV system(s) scaled by a factor of %.3f due to cap of %g x proposed design electricity use", ResultSummary[3]:PropPVScaleFactor, MaxPropPVRatio )
               else  Format( "Proposed PV system downsized to %.2f kWdc (a factor of %.3f) due to cap of %g x proposed design electricity use", (PVWDCSysTotal * ResultSummary[3]:PropPVScaleFactor), ResultSummary[3]:PropPVScaleFactor, MaxPropPVRatio )
               endif
         else  UNCHANGED  endif endif endif endif endif endif  }
   "Set ResultSummary[3]:HaveResultsNotesPV[1] related to PV scaling"
      Proj:ResultSummary[3]:HaveResultsNotesPV[1]  = {
         if (LocalStatus( ResultSummary[3]:ResultsNotes[1] ) < 1) then  0
         else if (strlen( ResultSummary[3]:ResultsNotes[1] ) > 2) then  1
         else  0  endif endif  }

   "Set ResultSummary[3]:ResultsNotes[4] to report PV scaling"
      Proj:ResultSummary[3]:ResultsNotes[4]  = {
         if (ResultSummary[3]:HaveResultsNotesPV[1] < 1) then  UNDEFINED
         else if (IfValidAnd( ResultSummary[3]:TargetDRtgPVMult  <= 0.995 ) .OR. IfValidAnd( ResultSummary[3]:TargetDRtgPVMult  >= 1.005 ))
         then  Format( "  East (%.2f kWdc)", (PVWDCSysTotal * ResultSummary[3]:TargetDRtgPVMult) )
         else if (LocalStatus( ResultSummary[3]:UserPVScalingMsg ) > 0 .OR. LocalStatus( ResultSummary[3]:RedPVRqPVScalingMsg ) > 0)
         then  Format( "  East (%.2f kWdc)", (PVWDCSysTotal * Proj:PVWDCSizeMultiplier[1]) )
         else if (IfValidAnd( ResultSummary[3]:PropInputPVMult <= 0.995 ) .AND. IfValidAnd( MaxPropPVRatio > 0 ))
         then  Format( "  East (%.2f kWdc)", (PVWDCSysTotal * ResultSummary[3]:PropInputPVMult) )
         else if ((IfValidAnd( ResultSummary[3]:PropPVScaleFactor <= 0.995 ) .OR. IfValidAnd( ResultSummary[3]:PropPVScaleFactor >= 1.005 )) .AND. IfValidAnd( MaxPropPVRatio > 0 ))
         then  Format( "  East (%.2f kWdc)", (PVWDCSysTotal * ResultSummary[3]:PropPVScaleFactor) )
         else  UNDEFINED  endif endif endif endif endif  }
   "Set ResultSummary[3]:HaveResultsNotesPV[4] to report PV scaling"
      Proj:ResultSummary[3]:HaveResultsNotesPV[4]  = {
         if (ResultSummary[3]:HaveResultsNotesPV[1] < 1) then  0
         else  1  endif  }
END
;*************************************************************************
RULELIST "ProcessResults_PVScalingMessage_S" 1 0 1 1
   ; SAC 12/7/17 - revised scaling messages to not report for scaling mults between 0.995 & 1.005 (tic #930)
   ; SAC 1/11/18 - added logic to label new 2019 scenario where PV scaled via PrelimProposed simulation
   ; SAC 1/11/18 - added logic referencing EUseSummary:UserPVScalingMsg to report user-initiated PV scaling (tic #923)
   ; SAC 8/30/19 - minor rewording of some messages (tic #1056)
   "Set ResultSummary[4]:ResultsNotes[1] to report PV scaling"
      Proj:ResultSummary[4]:ResultsNotes[1]  = {
         if ((IfValidAnd( ResultSummary[4]:TargetDRtgPVMult  <= 0.995 ) .OR. IfValidAnd( ResultSummary[4]:TargetDRtgPVMult  >= 1.005 )) .AND. 
             (IfValidAnd( ResultSummary[4]:PropPVScaleFactor <= 0.995 ) .OR. IfValidAnd( ResultSummary[4]:PropPVScaleFactor >= 1.005 )) .AND. IfValidAnd( MaxPropPVRatio > 0 ))
         then  if (IfValidAnd( Proj:PVWLastRow > 1 ))
               then  Format( "Proposed PV system(s) scaled by a factor of %.3f to approach target EDR (but capped @ %g x prop design elec use)", ResultSummary[4]:TargetDRtgPVMult, MaxPropPVRatio )
               else if (ResultSummary[4]:TargetDRtgPVMult < 1)
               then  Format( "Proposed PV system downsized to %.2f kWdc (a factor of %.3f) to approach target EDR (but capped @ %g x prop design elec use)", (PVWDCSysTotal * ResultSummary[4]:TargetDRtgPVMult), ResultSummary[4]:TargetDRtgPVMult, MaxPropPVRatio )
               else  Format( "Proposed PV system increased to %.2f kWdc (a factor of %.3f) to approach target EDR (but capped @ %g x prop design elec use)", (PVWDCSysTotal * ResultSummary[4]:TargetDRtgPVMult), ResultSummary[4]:TargetDRtgPVMult, MaxPropPVRatio )
               endif endif
         else if (IfValidAnd( ResultSummary[4]:TargetDRtgPVMult  <= 0.995 ) .OR. IfValidAnd( ResultSummary[4]:TargetDRtgPVMult  >= 1.005 ))
         then  if (IfValidAnd( Proj:PVWLastRow > 1 ))
               then  Format( "Proposed PV system(s) scaled by a factor of %.3f to achieve target energy design rating", ResultSummary[4]:TargetDRtgPVMult )
               else if (ResultSummary[4]:TargetDRtgPVMult < 1)
               then  Format( "Proposed PV system downsized to %.2f kWdc (a factor of %.3f) to achieve target energy design rating", (PVWDCSysTotal * ResultSummary[4]:TargetDRtgPVMult), ResultSummary[4]:TargetDRtgPVMult )
               else  Format( "Proposed PV system increased to %.2f kWdc (a factor of %.3f) to achieve target energy design rating", (PVWDCSysTotal * ResultSummary[4]:TargetDRtgPVMult), ResultSummary[4]:TargetDRtgPVMult )
               endif endif
         else if (LocalStatus( ResultSummary[4]:RedPVRqPVScalingMsg ) > 0)
         then  ResultSummary[4]:RedPVRqPVScalingMsg
         else if (LocalStatus( ResultSummary[4]:UserPVScalingMsg ) > 0)
         then  ResultSummary[4]:UserPVScalingMsg
         else if (IfValidAnd( ResultSummary[4]:PropInputPVMult < 1 ) .AND. IfValidAnd( MaxPropPVRatio > 0 ))
         then  if (IfValidAnd( ResultSummary[4]:PropInputPVMult > 0.995 )) then  UNDEFINED
               else if (IfValidAnd( Proj:PVWLastRow > 1 ))
               then  Format( "Proposed PV system(s) scaled by a factor of %.3f due to cap of %g x proposed design electricity use", ResultSummary[4]:PropInputPVMult, MaxPropPVRatio )
               else  Format( "Proposed PV system downsized to %.2f kWdc (a factor of %.3f) due to cap of %g x proposed design electricity use", (PVWDCSysTotal * ResultSummary[4]:PropInputPVMult), ResultSummary[4]:PropInputPVMult, MaxPropPVRatio )
               endif endif
         else if ((IfValidAnd( ResultSummary[4]:PropPVScaleFactor <= 0.995 ) .OR. IfValidAnd( ResultSummary[4]:PropPVScaleFactor >= 1.005 )) .AND. IfValidAnd( MaxPropPVRatio > 0 ))
         then  if (IfValidAnd( Proj:PVWLastRow > 1 ))
               then  Format( "Proposed PV system(s) scaled by a factor of %.3f due to cap of %g x proposed design electricity use", ResultSummary[4]:PropPVScaleFactor, MaxPropPVRatio )
               else  Format( "Proposed PV system downsized to %.2f kWdc (a factor of %.3f) due to cap of %g x proposed design electricity use", (PVWDCSysTotal * ResultSummary[4]:PropPVScaleFactor), ResultSummary[4]:PropPVScaleFactor, MaxPropPVRatio )
               endif
         else  UNCHANGED  endif endif endif endif endif endif  }
   "Set ResultSummary[4]:HaveResultsNotesPV[1] related to PV scaling"
      Proj:ResultSummary[4]:HaveResultsNotesPV[1]  = {
         if (LocalStatus( ResultSummary[4]:ResultsNotes[1] ) < 1) then  0
         else if (strlen( ResultSummary[4]:ResultsNotes[1] ) > 2) then  1
         else  0  endif endif  }

   "Set ResultSummary[4]:ResultsNotes[4] to report PV scaling"
      Proj:ResultSummary[4]:ResultsNotes[4]  = {
         if (ResultSummary[4]:HaveResultsNotesPV[1] < 1) then  UNDEFINED
         else if (IfValidAnd( ResultSummary[4]:TargetDRtgPVMult  <= 0.995 ) .OR. IfValidAnd( ResultSummary[4]:TargetDRtgPVMult  >= 1.005 ))
         then  Format( "  South (%.2f kWdc)", (PVWDCSysTotal * ResultSummary[4]:TargetDRtgPVMult) )
         else if (LocalStatus( ResultSummary[4]:UserPVScalingMsg ) > 0 .OR. LocalStatus( ResultSummary[4]:RedPVRqPVScalingMsg ) > 0)
         then  Format( "  South (%.2f kWdc)", (PVWDCSysTotal * Proj:PVWDCSizeMultiplier[1]) )
         else if (IfValidAnd( ResultSummary[4]:PropInputPVMult <= 0.995 ) .AND. IfValidAnd( MaxPropPVRatio > 0 ))
         then  Format( "  South (%.2f kWdc)", (PVWDCSysTotal * ResultSummary[4]:PropInputPVMult) )
         else if ((IfValidAnd( ResultSummary[4]:PropPVScaleFactor <= 0.995 ) .OR. IfValidAnd( ResultSummary[4]:PropPVScaleFactor >= 1.005 )) .AND. IfValidAnd( MaxPropPVRatio > 0 ))
         then  Format( "  South (%.2f kWdc)", (PVWDCSysTotal * ResultSummary[4]:PropPVScaleFactor) )
         else  UNDEFINED  endif endif endif endif endif  }
   "Set ResultSummary[4]:HaveResultsNotesPV[4] to report PV scaling"
      Proj:ResultSummary[4]:HaveResultsNotesPV[4]  = {
         if (ResultSummary[4]:HaveResultsNotesPV[1] < 1) then  0
         else  1  endif  }
END
;*************************************************************************
RULELIST "ProcessResults_PVScalingMessage_W" 1 0 1 1
   ; SAC 12/7/17 - revised scaling messages to not report for scaling mults between 0.995 & 1.005 (tic #930)
   ; SAC 1/11/18 - added logic to label new 2019 scenario where PV scaled via PrelimProposed simulation
   ; SAC 1/11/18 - added logic referencing EUseSummary:UserPVScalingMsg to report user-initiated PV scaling (tic #923)
   ; SAC 8/30/19 - minor rewording of some messages (tic #1056)
   "Set ResultSummary[5]:ResultsNotes[1] to report PV scaling"
      Proj:ResultSummary[5]:ResultsNotes[1]  = {
         if ((IfValidAnd( ResultSummary[5]:TargetDRtgPVMult  <= 0.995 ) .OR. IfValidAnd( ResultSummary[5]:TargetDRtgPVMult  >= 1.005 )) .AND. 
             (IfValidAnd( ResultSummary[5]:PropPVScaleFactor <= 0.995 ) .OR. IfValidAnd( ResultSummary[5]:PropPVScaleFactor >= 1.005 )) .AND. IfValidAnd( MaxPropPVRatio > 0 ))
         then  if (IfValidAnd( Proj:PVWLastRow > 1 ))
               then  Format( "Proposed PV system(s) scaled by a factor of %.3f to approach target EDR (but capped @ %g x prop design elec use)", ResultSummary[5]:TargetDRtgPVMult, MaxPropPVRatio )
               else if (ResultSummary[5]:TargetDRtgPVMult < 1)
               then  Format( "Proposed PV system downsized to %.2f kWdc (a factor of %.3f) to approach target EDR (but capped @ %g x prop design elec use)", (PVWDCSysTotal * ResultSummary[5]:TargetDRtgPVMult), ResultSummary[5]:TargetDRtgPVMult, MaxPropPVRatio )
               else  Format( "Proposed PV system increased to %.2f kWdc (a factor of %.3f) to approach target EDR (but capped @ %g x prop design elec use)", (PVWDCSysTotal * ResultSummary[5]:TargetDRtgPVMult), ResultSummary[5]:TargetDRtgPVMult, MaxPropPVRatio )
               endif endif
         else if (IfValidAnd( ResultSummary[5]:TargetDRtgPVMult  <= 0.995 ) .OR. IfValidAnd( ResultSummary[5]:TargetDRtgPVMult  >= 1.005 ))
         then  if (IfValidAnd( Proj:PVWLastRow > 1 ))
               then  Format( "Proposed PV system(s) scaled by a factor of %.3f to achieve target energy design rating", ResultSummary[5]:TargetDRtgPVMult )
               else if (ResultSummary[5]:TargetDRtgPVMult < 1)
               then  Format( "Proposed PV system downsized to %.2f kWdc (a factor of %.3f) to achieve target energy design rating", (PVWDCSysTotal * ResultSummary[5]:TargetDRtgPVMult), ResultSummary[5]:TargetDRtgPVMult )
               else  Format( "Proposed PV system increased to %.2f kWdc (a factor of %.3f) to achieve target energy design rating", (PVWDCSysTotal * ResultSummary[5]:TargetDRtgPVMult), ResultSummary[5]:TargetDRtgPVMult )
               endif endif
         else if (LocalStatus( ResultSummary[5]:RedPVRqPVScalingMsg ) > 0)
         then  ResultSummary[5]:RedPVRqPVScalingMsg
         else if (LocalStatus( ResultSummary[5]:UserPVScalingMsg ) > 0)
         then  ResultSummary[5]:UserPVScalingMsg
         else if (IfValidAnd( ResultSummary[5]:PropInputPVMult < 1 ) .AND. IfValidAnd( MaxPropPVRatio > 0 ))
         then  if (IfValidAnd( ResultSummary[5]:PropInputPVMult > 0.995 )) then  UNDEFINED
               else if (IfValidAnd( Proj:PVWLastRow > 1 ))
               then  Format( "Proposed PV system(s) scaled by a factor of %.3f due to cap of %g x proposed design electricity use", ResultSummary[5]:PropInputPVMult, MaxPropPVRatio )
               else  Format( "Proposed PV system downsized to %.2f kWdc (a factor of %.3f) due to cap of %g x proposed design electricity use", (PVWDCSysTotal * ResultSummary[5]:PropInputPVMult), ResultSummary[5]:PropInputPVMult, MaxPropPVRatio )
               endif endif
         else if ((IfValidAnd( ResultSummary[5]:PropPVScaleFactor <= 0.995 ) .OR. IfValidAnd( ResultSummary[5]:PropPVScaleFactor >= 1.005 )) .AND. IfValidAnd( MaxPropPVRatio > 0 ))
         then  if (IfValidAnd( Proj:PVWLastRow > 1 ))
               then  Format( "Proposed PV system(s) scaled by a factor of %.3f due to cap of %g x proposed design electricity use", ResultSummary[5]:PropPVScaleFactor, MaxPropPVRatio )
               else  Format( "Proposed PV system downsized to %.2f kWdc (a factor of %.3f) due to cap of %g x proposed design electricity use", (PVWDCSysTotal * ResultSummary[5]:PropPVScaleFactor), ResultSummary[5]:PropPVScaleFactor, MaxPropPVRatio )
               endif
         else  UNCHANGED  endif endif endif endif endif endif  }
   "Set ResultSummary[5]:HaveResultsNotesPV[1] related to PV scaling"
      Proj:ResultSummary[5]:HaveResultsNotesPV[1]  = {
         if (LocalStatus( ResultSummary[5]:ResultsNotes[1] ) < 1) then  0
         else if (strlen( ResultSummary[5]:ResultsNotes[1] ) > 2) then  1
         else  0  endif endif  }

   "Set ResultSummary[5]:ResultsNotes[4] to report PV scaling"
      Proj:ResultSummary[5]:ResultsNotes[4]  = {
         if (ResultSummary[5]:HaveResultsNotesPV[1] < 1) then  UNDEFINED
         else if (IfValidAnd( ResultSummary[5]:TargetDRtgPVMult  <= 0.995 ) .OR. IfValidAnd( ResultSummary[5]:TargetDRtgPVMult  >= 1.005 ))
         then  Format( "  West (%.2f kWdc)", (PVWDCSysTotal * ResultSummary[5]:TargetDRtgPVMult) )
         else if (LocalStatus( ResultSummary[5]:UserPVScalingMsg ) > 0 .OR. LocalStatus( ResultSummary[5]:RedPVRqPVScalingMsg ) > 0)
         then  Format( "  West (%.2f kWdc)", (PVWDCSysTotal * Proj:PVWDCSizeMultiplier[1]) )
         else if (IfValidAnd( ResultSummary[5]:PropInputPVMult <= 0.995 ) .AND. IfValidAnd( MaxPropPVRatio > 0 ))
         then  Format( "  West (%.2f kWdc)", (PVWDCSysTotal * ResultSummary[5]:PropInputPVMult) )
         else if ((IfValidAnd( ResultSummary[5]:PropPVScaleFactor <= 0.995 ) .OR. IfValidAnd( ResultSummary[5]:PropPVScaleFactor >= 1.005 )) .AND. IfValidAnd( MaxPropPVRatio > 0 ))
         then  Format( "  West (%.2f kWdc)", (PVWDCSysTotal * ResultSummary[5]:PropPVScaleFactor) )
         else  UNDEFINED  endif endif endif endif endif  }
   "Set ResultSummary[5]:HaveResultsNotesPV[4] to report PV scaling"
      Proj:ResultSummary[5]:HaveResultsNotesPV[4]  = {
         if (ResultSummary[5]:HaveResultsNotesPV[1] < 1) then  0
         else  1  endif  }

   ; now assemble entire set of HaveResultsNotesPV[4] messages into one - and copy to each orientation
   "Set ResultSummary[1]:HaveResultsNotesPV[4] to report PV scaling"
      Proj:ResultSummary[1]:HaveResultsNotesPV[4]  = {
         if (IfValidAnd( ResultSummary[2]:HaveResultsNotesPV[4] > 0 ) .OR.
             IfValidAnd( ResultSummary[3]:HaveResultsNotesPV[4] > 0 ) .OR.
             IfValidAnd( ResultSummary[4]:HaveResultsNotesPV[4] > 0 ) .OR.
             IfValidAnd( ResultSummary[5]:HaveResultsNotesPV[4] > 0 )) then  1
         else  0  endif  }
   "Set ResultSummary[1]:ResultsNotes[4] to report PV scaling -intro"
      Proj:ResultSummary[1]:ResultsNotes[4]  = {
         if (IfValidAnd( ResultSummary[1]:HaveResultsNotesPV[4] > 0 )==0) then  UNDEFINED
         else  "Proposed PV Capacity Scaling:"  endif  }
   "Set ResultSummary[1]:ResultsNotes[4] to report PV scaling -N"
      Proj:ResultSummary[1]:ResultsNotes[4]  = {
         if (IfValidAnd( ResultSummary[2]:HaveResultsNotesPV[4] > 0 )==0) then  UNCHANGED
         else  ResultSummary[1]:ResultsNotes[4] + ResultSummary[2]:ResultsNotes[4]  endif  }
   "Set ResultSummary[1]:ResultsNotes[4] to report PV scaling -E"
      Proj:ResultSummary[1]:ResultsNotes[4]  = {
         if (IfValidAnd( ResultSummary[3]:HaveResultsNotesPV[4] > 0 )==0) then  UNCHANGED
         else  ResultSummary[1]:ResultsNotes[4] + ResultSummary[3]:ResultsNotes[4]  endif  }
   "Set ResultSummary[1]:ResultsNotes[4] to report PV scaling -S"
      Proj:ResultSummary[1]:ResultsNotes[4]  = {
         if (IfValidAnd( ResultSummary[4]:HaveResultsNotesPV[4] > 0 )==0) then  UNCHANGED
         else  ResultSummary[1]:ResultsNotes[4] + ResultSummary[4]:ResultsNotes[4]  endif  }
   "Set ResultSummary[1]:ResultsNotes[4] to report PV scaling -W"
      Proj:ResultSummary[1]:ResultsNotes[4]  = {
         if (IfValidAnd( ResultSummary[5]:HaveResultsNotesPV[4] > 0 )==0) then  UNCHANGED
         else  ResultSummary[1]:ResultsNotes[4] + ResultSummary[5]:ResultsNotes[4]  endif  }
   "Copy   ResultSummary[2]:HaveResultsNotesPV[4]"
      Proj:ResultSummary[2]:HaveResultsNotesPV[4]  = {   ResultSummary[1]:HaveResultsNotesPV[4]  }
   "Copy   ResultSummary[2]:ResultsNotes[4]"
      Proj:ResultSummary[2]:ResultsNotes[4]        = {   ResultSummary[1]:ResultsNotes[4]  }
   "Copy   ResultSummary[3]:HaveResultsNotesPV[4]"
      Proj:ResultSummary[3]:HaveResultsNotesPV[4]  = {   ResultSummary[1]:HaveResultsNotesPV[4]  }
   "Copy   ResultSummary[3]:ResultsNotes[4]"
      Proj:ResultSummary[3]:ResultsNotes[4]        = {   ResultSummary[1]:ResultsNotes[4]  }
   "Copy   ResultSummary[4]:HaveResultsNotesPV[4]"
      Proj:ResultSummary[4]:HaveResultsNotesPV[4]  = {   ResultSummary[1]:HaveResultsNotesPV[4]  }
   "Copy   ResultSummary[4]:ResultsNotes[4]"
      Proj:ResultSummary[4]:ResultsNotes[4]        = {   ResultSummary[1]:ResultsNotes[4]  }
   "Copy   ResultSummary[5]:HaveResultsNotesPV[4]"
      Proj:ResultSummary[5]:HaveResultsNotesPV[4]  = {   ResultSummary[1]:HaveResultsNotesPV[4]  }
   "Copy   ResultSummary[5]:ResultsNotes[4]"
      Proj:ResultSummary[5]:ResultsNotes[4]        = {   ResultSummary[1]:ResultsNotes[4]  }
END
;*************************************************************************

;*************************************************************************
RULELIST "ProcessResults_ExcessPVMessage" 1 0 1 1
   "Set ResultSummary[1]:ResultsNotes[6] to report PV output exceeding Prop elec use"  ; SAC 2/28/18 (tic #985)   ; SAC 3/7/18 - revised to prevent vals < 0.01% (tic #996)
      Proj:ResultSummary[1]:ResultsNotes[6]  = {
         if (IfValidAnd( RunResults[10]:PropElecEnergy[1] < 0 ) .AND.
             IfValidAnd( RunResults[13]:PropElecEnergy[1] < RunResults[10]:PropElecEnergy[1] ))
         then  if ((-100 * RunResults[10]:PropElecEnergy[1] * CondFloorArea / 3.412) /
                   ((RunResults[10]:PropElecEnergy[1] - RunResults[13]:PropElecEnergy[1]) * CondFloorArea / 3.412) > 0.005)
               then  Format( "Proposed PV kWh output exceeds proposed electricity use by %g% which may violate NEM rules. Contact local utility.",    ; SAC 8/30/19 - rewording (tic #1056)
                              round( (-100 * RunResults[10]:PropElecEnergy[1] * CondFloorArea / 3.412) /
                                     ((RunResults[10]:PropElecEnergy[1] - RunResults[13]:PropElecEnergy[1]) * CondFloorArea / 3.412), 2 ) )
               else  UNDEFINED  endif
         else  UNDEFINED  endif  }
   ;      if (IfValidAnd( ResultSummary[1]:PrelimPropkWh > 0.1 ) .AND.
   ;                     round( (-100 * RunResults[10]:PropElecEnergy[1] * CondFloorArea / 3.412) / ResultSummary[1]:PrelimPropkWh, 2 ) )
   "Set ResultSummary[1]:HaveResultsNotesPV[6] (reporting PV output exceeding Prop elec use)"  ; SAC 2/28/18 (tic #985)
      Proj:ResultSummary[1]:HaveResultsNotesPV[6]  = {
         if (LocalStatus( ResultSummary[1]:ResultsNotes[6] ) < 1) then  0
         else if (strlen( ResultSummary[1]:ResultsNotes[6] ) > 2) then  1
         else  0  endif endif  }
;"dbg" Proj:Action = { if (ResultSummary[1]:HaveResultsNotesPV[6] < 1) then  UNCHANGED
;                      else  MessageBox( "ResultSummary[1]:ResultsNotes[6] ->\n%s", ResultSummary[1]:ResultsNotes[6] )  endif  }
END
;*************************************************************************
RULELIST "ProcessResults_ExcessPVMessage_N" 1 0 1 1
   "Set ResultSummary[2]:ResultsNotes[6] to report PV output exceeding Prop elec use"  ; SAC 2/28/18 (tic #985)   ; SAC 3/7/18 - revised to prevent vals < 0.01% (tic #996)
      Proj:ResultSummary[2]:ResultsNotes[6]  = {
         if (IfValidAnd( RunResultsN[10]:PropElecEnergy[1] < 0 ) .AND.
             IfValidAnd( RunResultsN[13]:PropElecEnergy[1] < RunResultsN[10]:PropElecEnergy[1] ))
         then  if ((-100 * RunResultsN[10]:PropElecEnergy[1] * CondFloorArea / 3.412) /
                   ((RunResultsN[10]:PropElecEnergy[1] - RunResultsN[13]:PropElecEnergy[1]) * CondFloorArea / 3.412) > 0.005)
               then  Format( "Proposed PV kWh output exceeds proposed electricity use by %g% which may violate NEM rules. Contact local utility.",    ; SAC 8/30/19 - rewording (tic #1056)
                              round( (-100 * RunResultsN[10]:PropElecEnergy[1] * CondFloorArea / 3.412) /
                                     ((RunResultsN[10]:PropElecEnergy[1] - RunResultsN[13]:PropElecEnergy[1]) * CondFloorArea / 3.412), 2 ) )
               else  UNDEFINED  endif
         else  UNDEFINED  endif  }
   "Set ResultSummary[2]:HaveResultsNotesPV[6] (reporting PV output exceeding Prop elec use)"  ; SAC 2/28/18 (tic #985)
      Proj:ResultSummary[2]:HaveResultsNotesPV[6]  = {
         if (LocalStatus( ResultSummary[2]:ResultsNotes[6] ) < 1) then  0
         else if (strlen( ResultSummary[2]:ResultsNotes[6] ) > 2) then  1
         else  0  endif endif  }
END
;*************************************************************************
RULELIST "ProcessResults_ExcessPVMessage_E" 1 0 1 1
   "Set ResultSummary[3]:ResultsNotes[6] to report PV output exceeding Prop elec use"  ; SAC 2/28/18 (tic #985)   ; SAC 3/7/18 - revised to prevent vals < 0.01% (tic #996)
      Proj:ResultSummary[3]:ResultsNotes[6]  = {
         if (IfValidAnd( RunResultsE[10]:PropElecEnergy[1] < 0 ) .AND.
             IfValidAnd( RunResultsE[13]:PropElecEnergy[1] < RunResultsE[10]:PropElecEnergy[1] ))
         then  if ((-100 * RunResultsE[10]:PropElecEnergy[1] * CondFloorArea / 3.412) /
                   ((RunResultsE[10]:PropElecEnergy[1] - RunResultsE[13]:PropElecEnergy[1]) * CondFloorArea / 3.412) > 0.005)
               then  Format( "Proposed PV kWh output exceeds proposed electricity use by %g% which may violate NEM rules. Contact local utility.",    ; SAC 8/30/19 - rewording (tic #1056)
                              round( (-100 * RunResultsE[10]:PropElecEnergy[1] * CondFloorArea / 3.412) /
                                     ((RunResultsE[10]:PropElecEnergy[1] - RunResultsE[13]:PropElecEnergy[1]) * CondFloorArea / 3.412), 2 ) )
               else  UNDEFINED  endif
         else  UNDEFINED  endif  }
   "Set ResultSummary[3]:HaveResultsNotesPV[6] (reporting PV output exceeding Prop elec use)"  ; SAC 2/28/18 (tic #985)
      Proj:ResultSummary[3]:HaveResultsNotesPV[6]  = {
         if (LocalStatus( ResultSummary[3]:ResultsNotes[6] ) < 1) then  0
         else if (strlen( ResultSummary[3]:ResultsNotes[6] ) > 2) then  1
         else  0  endif endif  }
END
;*************************************************************************
RULELIST "ProcessResults_ExcessPVMessage_S" 1 0 1 1
   "Set ResultSummary[4]:ResultsNotes[6] to report PV output exceeding Prop elec use"  ; SAC 2/28/18 (tic #985)   ; SAC 3/7/18 - revised to prevent vals < 0.01% (tic #996)
      Proj:ResultSummary[4]:ResultsNotes[6]  = {
         if (IfValidAnd( RunResultsS[10]:PropElecEnergy[1] < 0 ) .AND.
             IfValidAnd( RunResultsS[13]:PropElecEnergy[1] < RunResultsS[10]:PropElecEnergy[1] ))
         then  if ((-100 * RunResultsS[10]:PropElecEnergy[1] * CondFloorArea / 3.412) /
                   ((RunResultsS[10]:PropElecEnergy[1] - RunResultsS[13]:PropElecEnergy[1]) * CondFloorArea / 3.412) > 0.005)
               then  Format( "Proposed PV kWh output exceeds proposed electricity use by %g% which may violate NEM rules. Contact local utility.",    ; SAC 8/30/19 - rewording (tic #1056)
                              round( (-100 * RunResultsS[10]:PropElecEnergy[1] * CondFloorArea / 3.412) /
                                     ((RunResultsS[10]:PropElecEnergy[1] - RunResultsS[13]:PropElecEnergy[1]) * CondFloorArea / 3.412), 2 ) )
               else  UNDEFINED  endif
         else  UNDEFINED  endif  }
   "Set ResultSummary[4]:HaveResultsNotesPV[6] (reporting PV output exceeding Prop elec use)"  ; SAC 2/28/18 (tic #985)
      Proj:ResultSummary[4]:HaveResultsNotesPV[6]  = {
         if (LocalStatus( ResultSummary[4]:ResultsNotes[6] ) < 1) then  0
         else if (strlen( ResultSummary[4]:ResultsNotes[6] ) > 2) then  1
         else  0  endif endif  }
END
;*************************************************************************
RULELIST "ProcessResults_ExcessPVMessage_W" 1 0 1 1
   "Set ResultSummary[5]:ResultsNotes[6] to report PV output exceeding Prop elec use"  ; SAC 2/28/18 (tic #985)   ; SAC 3/7/18 - revised to prevent vals < 0.01% (tic #996)
      Proj:ResultSummary[5]:ResultsNotes[6]  = {
         if (IfValidAnd( RunResultsW[10]:PropElecEnergy[1] < 0 ) .AND.
             IfValidAnd( RunResultsW[13]:PropElecEnergy[1] < RunResultsW[10]:PropElecEnergy[1] ))
         then  if ((-100 * RunResultsW[10]:PropElecEnergy[1] * CondFloorArea / 3.412) /
                   ((RunResultsW[10]:PropElecEnergy[1] - RunResultsW[13]:PropElecEnergy[1]) * CondFloorArea / 3.412) > 0.005)
               then  Format( "Proposed PV kWh output exceeds proposed electricity use by %g% which may violate NEM rules. Contact local utility.",    ; SAC 8/30/19 - rewording (tic #1056)
                              round( (-100 * RunResultsW[10]:PropElecEnergy[1] * CondFloorArea / 3.412) /
                                     ((RunResultsW[10]:PropElecEnergy[1] - RunResultsW[13]:PropElecEnergy[1]) * CondFloorArea / 3.412), 2 ) )
               else  UNDEFINED  endif
         else  UNDEFINED  endif  }
   "Set ResultSummary[5]:HaveResultsNotesPV[6] (reporting PV output exceeding Prop elec use)"  ; SAC 2/28/18 (tic #985)
      Proj:ResultSummary[5]:HaveResultsNotesPV[6]  = {
         if (LocalStatus( ResultSummary[5]:ResultsNotes[6] ) < 1) then  0
         else if (strlen( ResultSummary[5]:ResultsNotes[6] ) > 2) then  1
         else  0  endif endif  }
END
;*************************************************************************

;*************************************************************************
RULELIST "ProcessResults_TargetDesignRating" 1 0 0 1
;*************************************************************************
;"store BEMProc details" Proj:Action = { StoreBEMProc( "TDR rules begin", 0 ) }
;"dbg" Proj:Action = { MessageBox( "just stored model details from 'ProcessResults_TargetDesignRating' rulelist" ) }

   ; SAC 7/21/17 - adjustment for 2016 where PV elec use not included in total...
   "Set Proj:CurrentPropPVRatio"    Proj:CurrentPropPVRatio  = {
      if (EnergyCodeYearNum < 2019)
      then  (-1 * RunResults[13]:PropElecEnergy[1]) /
             RunResults[10]:PropElecEnergy[1]
      else  (-1 * RunResults[13]:PropElecEnergy[1]) /
            (RunResults[10]:PropElecEnergy[1] - RunResults[13]:PropElecEnergy[1])
      endif  }

   "Set Proj:ResultSummary[1]:UnscaledPropPVRatio"   Proj:ResultSummary[1]:UnscaledPropPVRatio  = {
      if (IfValidAnd( PVWDCSizeMultiplier[1] != 0 ))
      then  if (EnergyCodeYearNum < 2019)
            then  (-1 * RunResults[13]:PropElecEnergy[1] / PVWDCSizeMultiplier[1]) /
                   RunResults[10]:PropElecEnergy[1]
            else  (-1 * RunResults[13]:PropElecEnergy[1] / PVWDCSizeMultiplier[1]) /
                  (RunResults[10]:PropElecEnergy[1] - RunResults[13]:PropElecEnergy[1])
            endif
      else  CurrentPropPVRatio  endif  }

"Debug log msg"   Proj:Action  = {
   PostMessageToLog( "   TDR check:   TargetDesignRtg = %.2f  |  cur DesignRating = %.2f  |  CurrentPropPVRatio = %.3f  |  UnscaledPropPVRatio = %.3f  |  MaxPropPVRatio = %.2f",
            TargetDesignRtg, ValidOr( ResultSummary[1]:DesignRating, -999 ), CurrentPropPVRatio, ResultSummary[1]:UnscaledPropPVRatio, ValidOr( MaxPropPVRatio, -999 ) )  }

   ; SAC 6/15/17 - added logic to prevent PV scaling from going negative when PV scaling is toggled OFF
   "Check for success in achieving target"   Proj:Action = {
         if (TargetDesignRtg < (ValidOr( ResultSummary[1]:DesignRating, -999 ) + 0.1) .AND.
             TargetDesignRtg > (ValidOr( ResultSummary[1]:DesignRating, -999 ) - 0.4))
         then  if (IfValidAnd( MaxPropPVRatio > 0 ) .AND.
                   CurrentPropPVRatio > (ValidOr( MaxPropPVRatio, 999 )+0.01))
               then  EvalRulelist( "ProcessResults_TargetDesignRating_Iterate_MaxPVScaling" )
               else  EvalRulelist( "ProcessResults_TargetDesignRating_Success" )
               endif
         else if (IfValidAnd( ResultSummary[1]:PropInputPVMult < 1 ) .AND.
                  TargetDesignRtg <= (ValidOr( ResultSummary[1]:DesignRating, -999 ) - 0.45) .AND.
                  IfValidAnd( TargetDRtgIterNum > 0 )==0)       ; DR too high after PV scaling by PrelimProp run - SAC 12/30/17
         then  EvalRulelist( "ProcessResults_TargetDesignRating_MaxPVConflict" )
         else if (IfValidAnd( ScalePropPVResults > 0.5 ) .AND.
                  CurrentPropPVRatio > (ValidOr( MaxPropPVRatio, -999 )-0.03) .AND.
                  CurrentPropPVRatio < (ValidOr( MaxPropPVRatio, -999 )+0.03) .AND.
                  IfValidAnd( TargetDRtgMaxIter = TargetDRtgIterNum ))
         then  EvalRulelist( "ProcessResults_TargetDesignRating_MaxPVConflict" )
         else if (TargetDesignRtg <= (ValidOr( ResultSummary[1]:DesignRating, -999 ) - 0.4) .AND.
                  IfValidAnd( ScalePropPVResults > 0.5 ) .AND.
                  IfValidAnd( MaxPropPVRatio > 0 ) .AND.
                  IfValidAnd( CurrentPropPVRatio > MaxPropPVRatio ))
         then  EvalRulelist( "ProcessResults_TargetDesignRating_Iterate_MaxPVScaling" )
         else if (TargetDesignRtg <= (ValidOr( ResultSummary[1]:DesignRating, -999 ) - 0.45) .AND.
                  IfValidAnd( ScalePropPVResults > 0.5 ) .AND.
                  IfValidAnd( MaxPropPVRatio > 0 ) .AND.
                  CurrentPropPVRatio >= ValidOr( MaxPropPVRatio, 0 )-0.01 )
         then  EvalRulelist( "ProcessResults_TarcgetDesignRating_MaxPVConflict" )
         else if (ValidOr( TargetDRtgIterNum, 0 ) < TargetDRtgMaxIter .AND. 
                  IfValidAnd( RunResults[13]:ProposedTDV[3] != 0 ))
         then  EvalRulelist( "ProcessResults_TargetDesignRating_Iterate" )
         else  EvalRulelist( "ProcessResults_TargetDesignRating_Failure" )
         endif endif endif endif endif endif  }
;         else if (TargetDesignRtg < ValidOr( ResultSummary[1]:DesignRating, -999 ) .AND.
;                  IfValidAnd( ResultSummary[1]:PropPVScaleFactor < 1 ))
END
;*************************************************************************
RULELIST "ProcessResults_TargetDesignRating_Iterate_MaxPVScaling" 1 0 0 1
"Debug log msg"   Proj:Action  = {  PostMessageToLog( "    Iterate-MaxPVScaling iterate rules..." )  }

   "Store past iteration data"   Proj:Action  = {
         EvalRulelist( "ProcessResults_TargetDesignRating_StoreIterData" )  }

   "Set Proj:PVWDCSizeMultiplier[1] - to achieve MaxPropPVRatio"
      Proj:PVWDCSizeMultiplier[1]  = {
         ValidOr( PVWDCSizeMultiplier[2], 1 ) * MaxPropPVRatio / CurrentPropPVRatio  }

"Debug log msg"   Proj:Action  = {
   PostMessageToLog( "      PVWDCSizeMultiplier[1] = %.3f  |  %.3f * %.3f  (in ..._Iterate_MaxPVScaling)",
            PVWDCSizeMultiplier[1], ValidOr( PVWDCSizeMultiplier[2], 1 ), (PVWDCSizeMultiplier[1] / ValidOr( PVWDCSizeMultiplier[2], 1 )) )  }

   "Increment Proj:TargetDRtgIterNum"     Proj:TargetDRtgIterNum  = {
         if (IfValidAnd( TargetDRtgIterNum > 0 )==0) then  1
         else  TargetDRtgIterNum + 1  endif  }
   "Adjust Proj:TargetDRtgMaxIter - where PV multiplier limited by Max PV ratio"
      Proj:TargetDRtgMaxIter  = {  TargetDRtgIterNum  }



;   "Init PropPVScaleFactor"   Proj:ResultSummary[1]:PropPVScaleFactor  = {  UNDEFINED  }
;   "Scale Proposed PV & Battery if necessary"      Proj:Action  = {
;         if (IfValidAnd( ScalePropPVResults > 0.5 )==0 .OR.
;             IfValidAnd( MaxPropPVRatio >= 0 )==0 .OR.
;             IfValidAnd( RunResults[13]:PropElecEnergy[1] < 0 )==0 .OR.
;             LocalStatus( RunResults[10]:PropElecEnergy[1] ) < 1) then  UNCHANGED
;         else if ( (MaxPropPVRatio * (RunResults[10]:PropElecEnergy[1] -
;                                      RunResults[13]:PropElecEnergy[1])) >
;                   (-1 * RunResults[13]:PropElecEnergy[1]) ) then  UNCHANGED
;         else  EvalRulelist( "CARes_ProposedSummary_ScalePV" )  endif endif  }
;
;	"Call subordinate rulelist to set all EUseSummary data"		Proj:Action = {	EvalRulelist( "CARes_ProposedSummary_Main" )  }
;  END
;
;  RULELIST "CARes_ProposedSummary_ScalePV" 1 0 1 1
;   "Set PropPVScaleFactor"    Proj:ResultSummary[1]:PropPVScaleFactor  = {
;         (MaxPropPVRatio * (RunResults[10]:PropElecEnergy[1] - RunResults[13]:PropElecEnergy[1]))
;         / (-1 * RunResults[13]:PropElecEnergy[1])  }
;
;   ; first STORE PV, Battery and Totals BEFORE scaling
;	"Store pre-scaled PV EnergyUse:ProposedTDV[4]"		Proj:RunResults[13]:ProposedTDV[4]	= {	RunResults[13]:ProposedTDV[1]  }
;	"Store pre-scaled Batt EnergyUse:ProposedTDV[4]"	Proj:RunResults[14]:ProposedTDV[4]	= {	RunResults[14]:ProposedTDV[1]  }
;	"Store pre-scaled Total EnergyUse:ProposedTDV[4]"	Proj:RunResults[10]:ProposedTDV[4]	= {	RunResults[10]:ProposedTDV[1]  }


END
;*************************************************************************
RULELIST "ProcessResults_TargetDesignRating_Iterate" 1 0 0 1
"Debug log msg"   Proj:Action  = {  PostMessageToLog( "    Iterate rules..." )  }

   "Store past iteration data"   Proj:Action  = {
         EvalRulelist( "ProcessResults_TargetDesignRating_StoreIterData" )  }

;"Debug log msg"   Proj:Action  = {
;   PostMessageToLog( "   Iterating to achieve Target EDR:\n      %.2f  =  ( %.2f - %.2f + %.2f ) / %.2f\n               ( (TargetDesignRtg * RunResults[10]:DesignRatingTDV[2] / 100) - RunResults[10]:ProposedTDV[3] + RunResults[13]:ProposedTDV[3] )  /  RunResults[13]:ProposedTDV[3]",
;       ( ( TargetDesignRtg * RunResults[10]:DesignRatingTDV[2] / 100 ) -
;           RunResults[10]:ProposedTDV[3] + RunResults[13]:ProposedTDV[3] ) / RunResults[13]:ProposedTDV[3],
;         ( TargetDesignRtg * RunResults[10]:DesignRatingTDV[2] / 100 ), RunResults[10]:ProposedTDV[3], RunResults[13]:ProposedTDV[3], RunResults[13]:ProposedTDV[3] )  }

   "Set Proj:PVWDCSizeMultiplier[1] - multiplier on PV system size, used to iterate to achieve a target design rating"
   ;    NextScaleFactor  =  ( ( TargetDRtg * DRtgTDV / 100 ) - TotPropTDV + PropPVTDV )  /  PropPVTDV
      Proj:PVWDCSizeMultiplier[1]  = {
         ( ( TargetDesignRtg * RunResults[10]:DesignRatingTDV[2] / 100 ) -
           RunResults[10]:ProposedTDV[3] + RunResults[13]:ProposedTDV[3] ) / RunResults[13]:ProposedTDV[3]  }

   "Adjust Proj:PVWDCSizeMultiplier[1] to help hit target more quickly"    ; SAC 5/4/17   ; SAC 10/23/17 - prevent negative PV
      Proj:PVWDCSizeMultiplier[1]  = {
         if (IfValidAnd( TargetDRtgIterNum > 0 )) then  UNCHANGED    ; only adjust initial multiplier
         else if (PVWDCSizeMultiplier[1] < 0) then  0
         else if (PVWDCSizeMultiplier[1] < 1)
         then  PVWDCSizeMultiplier[1] * ((PVWDCSizeMultiplier[1] * 0.0668) + 0.931)
         else if (PVWDCSizeMultiplier[1] < 1.5)
         then  PVWDCSizeMultiplier[1] * ((PVWDCSizeMultiplier[1] * 0.0622) + 0.931)
         else  PVWDCSizeMultiplier[1] * ((PVWDCSizeMultiplier[1] * 0.0657) + 0.9084)
         endif endif endif endif  }

;   "Set Proj:PVWDCSizeMultiplier[3] flag if value set above will cause PV to exceed MaxPropPVRatio"
;      Proj:PVWDCSizeMultiplier[3]  = {
;         if (IfValidAnd( ScalePropPVResults > 0.5 )==0 .OR.
;             IfValidAnd( MaxPropPVRatio >= 0 )==0) then  UNDEFINED
;         else if ( MaxPropPVRatio < 
;                     ( PVWDCSizeMultiplier[1] * (-1 * RunResults[13]:PropElecEnergy[1]) )  /
;                     (RunResults[10]:PropElecEnergy[1] - RunResults[13]:PropElecEnergy[1]) )
;         then  1  ; this flag indicates that next PV mult needs to simply max out PV - best we can do
;         else  UNDEFINED  endif endif  }
;
;"Debug log msg"   Proj:Action  = {
;   if (IfValidAnd( PVWDCSizeMultiplier[3] > 0 ))
;   then  PostMessageToLog( "      PVWDCSizeMultiplier[3] > 0  due to:  ScalePropPVResults = %.2f  |  MaxPropPVRatio = %.2f  |  %.2f = ( %.2f * %.2f ) / ( %.2f - %.2f ) -> ",
;            ValidOr( ScalePropPVResults, -1 ), ValidOr( MaxPropPVRatio, -1 ), 
;            ( PVWDCSizeMultiplier[1] * (-1 * RunResults[13]:PropElecEnergy[1]) )  /
;            (RunResults[10]:PropElecEnergy[1] - RunResults[13]:PropElecEnergy[1]),
;            PVWDCSizeMultiplier[1], (-1 * RunResults[13]:PropElecEnergy[1]), RunResults[10]:PropElecEnergy[1], RunResults[13]:PropElecEnergy[1] )
;   else  UNCHANGED  endif  }
;
;   "Final setting Proj:PVWDCSizeMultiplier[1] - based either on max PV or existing (* previous) multiplier"
;      Proj:PVWDCSizeMultiplier[1]  = {
;         if (IfValidAnd( PVWDCSizeMultiplier[3] = 1 ))
;         then  ; RESET multiplier if it would result in PV that exceeds MaxPropPVRatio
;               ValidOr( PVWDCSizeMultiplier[2], 1 ) *
;               (MaxPropPVRatio * (RunResults[10]:PropElecEnergy[1] - RunResults[13]:PropElecEnergy[1]))
;                  / (-1 * RunResults[13]:PropElecEnergy[1])
;         else  ValidOr( PVWDCSizeMultiplier[2], 1 ) * PVWDCSizeMultiplier[1]
;         endif  }
   "Final setting Proj:PVWDCSizeMultiplier[1] - taking into account existing (* previous) multiplier"
      Proj:PVWDCSizeMultiplier[1]  = {
         ValidOr( PVWDCSizeMultiplier[2], 1 ) * PVWDCSizeMultiplier[1]  }

"Debug log msg"   Proj:Action  = {
   PostMessageToLog( "      PVWDCSizeMultiplier[1] = %.3f  =  %.3f * %.3f  (in ..._Iterate)",
            PVWDCSizeMultiplier[1], ValidOr( PVWDCSizeMultiplier[2], 1 ), (PVWDCSizeMultiplier[1] / ValidOr( PVWDCSizeMultiplier[2], 1 )) )  }
;   if (IfValidAnd( PVWDCSizeMultiplier[3] > 0 ))
;   then  PostMessageToLog( "      PVWDCSizeMultiplier[1] reset to %.2f  |  %.2f * (%.2f * (%.2f - %.2f)) / %.2f",
;            PVWDCSizeMultiplier[1], 
;               ValidOr( PVWDCSizeMultiplier[2], 1 ), MaxPropPVRatio, RunResults[10]:PropElecEnergy[1],
;               RunResults[13]:PropElecEnergy[1], (-1 * RunResults[13]:PropElecEnergy[1]) )
;   else  PostMessageToLog( "      PVWDCSizeMultiplier[1] = %.3f  |  %.3f * %.3f",
;            PVWDCSizeMultiplier[1], ValidOr( PVWDCSizeMultiplier[2], 1 ), PVWDCSizeMultiplier[1] )
;   endif  }

   "Increment Proj:TargetDRtgIterNum"     Proj:TargetDRtgIterNum  = {
         if (IfValidAnd( TargetDRtgIterNum > 0 )==0) then  1
         else  TargetDRtgIterNum + 1  endif  }
   "Adjust Proj:TargetDRtgMaxIter - where PV multiplier zeroed out due to high TDR value"
      Proj:TargetDRtgMaxIter  = {  
         if (IfValidAnd( PVWDCSizeMultiplier[1] = 0 ))
         then  TargetDRtgIterNum
         else  UNCHANGED  endif  }

;                  IfValidAnd( ScalePropPVResults > 0.5 ) .AND.
;                  IfValidAnd( MaxPropPVRatio >= 0 ) .AND.
;                  IfValidAnd( RunResults[13]:PropElecEnergy[1] < 0 ) .AND.
;                  (MaxPropPVRatio * (RunResults[10]:PropElecEnergy[1] -
;                                      RunResults[13]:PropElecEnergy[1])) >
;                      (-1 * RunResults[13]:PropElecEnergy[1]) )

;   "Set PropPVScaleFactor"    Proj:ResultSummary[1]:PropPVScaleFactor  = {
;         (MaxPropPVRatio * (RunResults[10]:PropElecEnergy[1] - RunResults[13]:PropElecEnergy[1]))
;         / (-1 * RunResults[13]:PropElecEnergy[1])  }

;      ( ScaleFactor  *  (-1 * RunResults[13]:PropElecEnergy[1]) )  /  (RunResults[10]:PropElecEnergy[1] - RunResults[13]:PropElecEnergy[1])  =  (MaxPropPVRatio * )

;   "Set PropPVScaleFactor"    Proj:ResultSummary[1]:PropPVScaleFactor  = {
;         (MaxPropPVRatio * (RunResults[10]:PropElecEnergy[1] - RunResults[13]:PropElecEnergy[1]))
;         / (-1 * RunResults[13]:PropElecEnergy[1])  }

END
;*************************************************************************
RULELIST "ProcessResults_TargetDesignRating_StoreIterData" 1 0 0 1
"Debug log msg"   Proj:Action  = {  PostMessageToLog( "      StoreIterData iterate rules..." )  }

   "Set Proj:TargetDRtgScores[1]"      Proj:TargetDRtgScores[1]  = {
         if (IfValidAnd( TargetDRtgIterNum > 0 )==0) then  ResultSummary[1]:DesignRating
         else  UNCHANGED  endif  }
   "Set Proj:TargetDRtgScores[2]"      Proj:TargetDRtgScores[2]  = {
         if (IfValidAnd( TargetDRtgIterNum = 1 )) then  ResultSummary[1]:DesignRating
         else if (IfValidAnd( TargetDRtgIterNum > 1 )) then  UNCHANGED
         else  UNDEFINED  endif endif  }
   "Set Proj:TargetDRtgScores[3]"      Proj:TargetDRtgScores[3]  = {
         if (IfValidAnd( TargetDRtgIterNum = 2 )) then  ResultSummary[1]:DesignRating
         else if (IfValidAnd( TargetDRtgIterNum > 2 )) then  UNCHANGED
         else  UNDEFINED  endif endif  }
   "Set Proj:TargetDRtgScores[4]"      Proj:TargetDRtgScores[4]  = {
         if (IfValidAnd( TargetDRtgIterNum = 3 )) then  ResultSummary[1]:DesignRating
         else if (IfValidAnd( TargetDRtgIterNum > 3 )) then  UNCHANGED
         else  UNDEFINED  endif endif  }
   "Set Proj:TargetDRtgScores[5]"      Proj:TargetDRtgScores[5]  = {
         if (IfValidAnd( TargetDRtgIterNum = 4 )) then  ResultSummary[1]:DesignRating
         else if (IfValidAnd( TargetDRtgIterNum > 4 )) then  UNCHANGED
         else  UNDEFINED  endif endif  }

   "Set Proj:TargetDRtgPVMults[1]"     Proj:TargetDRtgPVMults[1]  = {
         if (IfValidAnd( TargetDRtgIterNum > 0 )==0) then  ResultSummary[1]:PropPVScaleFactor
         else  UNCHANGED  endif  }
   "Set Proj:TargetDRtgPVMults[2]"     Proj:TargetDRtgPVMults[2]  = {
         if (IfValidAnd( TargetDRtgIterNum = 1 )) then  ResultSummary[1]:PropPVScaleFactor
         else if (IfValidAnd( TargetDRtgIterNum > 1 )) then  UNCHANGED
         else  UNDEFINED  endif endif  }
   "Set Proj:TargetDRtgPVMults[3]"     Proj:TargetDRtgPVMults[3]  = {
         if (IfValidAnd( TargetDRtgIterNum = 2 )) then  ResultSummary[1]:PropPVScaleFactor
         else if (IfValidAnd( TargetDRtgIterNum > 2 )) then  UNCHANGED
         else  UNDEFINED  endif endif  }
   "Set Proj:TargetDRtgPVMults[4]"     Proj:TargetDRtgPVMults[4]  = {
         if (IfValidAnd( TargetDRtgIterNum = 3 )) then  ResultSummary[1]:PropPVScaleFactor
         else if (IfValidAnd( TargetDRtgIterNum > 3 )) then  UNCHANGED
         else  UNDEFINED  endif endif  }
   "Set Proj:TargetDRtgPVMults[5]"     Proj:TargetDRtgPVMults[5]  = {
         if (IfValidAnd( TargetDRtgIterNum = 4 )) then  ResultSummary[1]:PropPVScaleFactor
         else if (IfValidAnd( TargetDRtgIterNum > 4 )) then  UNCHANGED
         else  UNDEFINED  endif endif  }

   "Store previous Proj:PVWDCSizeMultiplier[1] into 2nd array element"     Proj:PVWDCSizeMultiplier[2]  = {
         if (LocalStatus( PVWDCSizeMultiplier[1] ) > 0) then  PVWDCSizeMultiplier[1]
         else  UNDEFINED  endif  }
END
;*************************************************************************
RULELIST "ProcessResults_TargetDesignRating_Success" 1 0 1 1
"Debug log msg"   Proj:Action  = {  PostMessageToLog( "    Success iterate rules..." )  }
   ; success could include a defined ResultSummary[1]:PropPVScaleFactor
   "Set Proj:TargetDRtgResMsg"      Proj:TargetDRtgResMsg  = {
         if (IfValidAnd( PVWLastRow = 1 ) .AND. IfValidAnd( PVWDCSysTotal > 0 ))
         then  Format( "Target design rating achieved (total rating of %.1f w/ PV size of %.2f kWdc).",
                           ResultSummary[1]:DesignRating, (PVWDCSysTotal * ValidOr( PVWDCSizeMultiplier[1], 1 )) )
         else  Format( "Target design rating achieved (total rating of %.1f w/ PV multiplier of %.2f).",
                           ResultSummary[1]:DesignRating, ValidOr( PVWDCSizeMultiplier[1], 1 ) )
         endif  }
;         Format( "Target design rating achieved (final rating of %.1f in %g iteration(s)).",
;                     ResultSummary[1]:DesignRating, ValidOr( TargetDRtgIterNum, 0 )+1 )  }
   "Set ResultSummary[1]:TargetDRtgMsg"   Proj:ResultSummary[1]:TargetDRtgMsg  = {  TargetDRtgResMsg  }
   "Store Proj:PVWDCSizeMultiplier[1] to ResultSummary[1]:TargetDRtgPVMult if != 1"
      Proj:ResultSummary[1]:TargetDRtgPVMult  = {
         if (IfValidAnd( PVWDCSizeMultiplier[1] != 1 )==0) then  UNDEFINED
         else  PVWDCSizeMultiplier[1]  endif  }
   "Copy ResultSummary[1]:TargetDRtgPVMult to all orientations"  Proj:Action = {
         if (AllOrientations < 0.5) then  UNCHANGED
         else  EvalRulelist( "CopyToAllOrientations_TargetDRtgPVMult" )  endif  }
   "Blast Proj:TargetDRtgIterNum"   Proj:TargetDRtgIterNum  = {  UNDEFINED  }
END
;*************************************************************************
RULELIST "ProcessResults_TargetDesignRating_MaxPVConflict" 1 0 1 1
"Debug log msg"   Proj:Action  = {  PostMessageToLog( "    MaxPVConflict iterate rules..." )  }

   "Set Proj:TargetDRtgResMsg"      Proj:TargetDRtgResMsg  = {
         Format( "Target design rating not achievable w/out exceeding max PV generation (target: %g, total: %.1f w/ max PV gen).",
                     TargetDesignRtg, ResultSummary[1]:DesignRating )  }
;         Format( "Target design rating not achievable without exceeding maximum PV generation (target: %g, final rating: %.1f).",
;                     TargetDesignRtg, ResultSummary[1]:DesignRating )  }
;         else if (TargetDesignRtg > (ResultSummary[1]:DesignRating - 0.5) .AND.
;                  IfValidAnd( ResultSummary[1]:PropPVScaleFactor < 1 ))
   "Set ResultSummary[1]:TargetDRtgMsg"   Proj:ResultSummary[1]:TargetDRtgMsg  = {  TargetDRtgResMsg  }
   "Store Proj:PVWDCSizeMultiplier[1] to ResultSummary[1]:TargetDRtgPVMult if != 1"
      Proj:ResultSummary[1]:TargetDRtgPVMult  = {
         if (IfValidAnd( PVWDCSizeMultiplier[1] != 1 )==0) then  UNDEFINED
         else  PVWDCSizeMultiplier[1]  endif  }
   "Copy ResultSummary[1]:TargetDRtgPVMult to all orientations"  Proj:Action = {
         if (AllOrientations < 0.5) then  UNCHANGED
         else  EvalRulelist( "CopyToAllOrientations_TargetDRtgPVMult" )  endif  }
   "ALSO Store Proj:PVWDCSizeMultiplier[1] to ResultSummary[1]:PropPVScaleFactor if != 1"
      Proj:ResultSummary[1]:PropPVScaleFactor  = {
         if (IfValidAnd( PVWDCSizeMultiplier[1] != 1 )==0) then  UNDEFINED
         else  PVWDCSizeMultiplier[1]  endif  }
   "Copy ResultSummary[1]:PropPVScaleFactor to all orientations"  Proj:Action = {
         if (AllOrientations < 0.5) then  UNCHANGED
         else  EvalRulelist( "CopyToAllOrientations_PropPVScaleFactor" )  endif  }
   "Blast Proj:TargetDRtgIterNum"   Proj:TargetDRtgIterNum  = {  UNDEFINED  }
END
;*************************************************************************
RULELIST "ProcessResults_TargetDesignRating_Failure" 1 0 1 1
"Debug log msg"   Proj:Action  = {  PostMessageToLog( "    Failure iterate rules..." )  }

   "Set Proj:TargetDRtgResMsg"      Proj:TargetDRtgResMsg  = {
         if (LocalStatus( ResultSummary[1]:DesignRating ) < 1)
         then  "Target EDR not achievable due to no initial design rating calculated."
         else if (IfValidAnd( PVWDCSizeMultiplier[1] > 0 )==0 .AND. 
                  IfValidAnd( TargetDRtgIterNum = TargetDRtgMaxIter ))
         then  "Target EDR not achievable (Target value is worse than proposed model without any PV)."
         else if (IfValidAnd( RunResults[13]:ProposedTDV[3] != 0 )==0)
         then  "Target EDR not achievable due to no PV analysis results."
         else if (TargetDRtgIterNum >= TargetDRtgMaxIter .AND. TargetDRtgMaxIter < 4)
         then  if (IfValidAnd( PVWLastRow = 1 ) .AND. IfValidAnd( PVWDCSysTotal > 0 ))
               then  Format( "Target EDR not achievable w/out exceeding max PV generation (target: %g, total: %.1f w/ PV size of %.2f kWdc).",
                                 TargetDesignRtg, ResultSummary[1]:DesignRating, (PVWDCSysTotal * ValidOr( PVWDCSizeMultiplier[1], 1 )) )
               else  Format( "Target EDR not achievable w/out exceeding max PV generation (target: %g, total: %.1f w/ PV multiplier of %.2f).",
                                 TargetDesignRtg, ResultSummary[1]:DesignRating, ValidOr( PVWDCSizeMultiplier[1], 1 ) )
               endif
         else if (TargetDRtgIterNum >= TargetDRtgMaxIter)
         then  if (IfValidAnd( PVWLastRow = 1 ) .AND. IfValidAnd( PVWDCSysTotal > 0 ))
               then  Format( "Target EDR not achieved within the max of %g iterations (target: %g, total: %.1f w/ PV size of %.2f kWdc).",
                                 TargetDRtgMaxIter, TargetDesignRtg, ResultSummary[1]:DesignRating, (PVWDCSysTotal * ValidOr( PVWDCSizeMultiplier[1], 1 )) )
               else  Format( "Target EDR not achieved within the max of %g iterations (target: %g, total: %.1f w/ PV multiplier of %.2f).",
                                 TargetDRtgMaxIter, TargetDesignRtg, ResultSummary[1]:DesignRating, ValidOr( PVWDCSizeMultiplier[1], 1 ) )
               endif
         else  "Target EDR not achievable."
         endif endif endif endif endif  }
   "Set ResultSummary[1]:TargetDRtgMsg"   Proj:ResultSummary[1]:TargetDRtgMsg  = {  TargetDRtgResMsg  }
   "Store Proj:PVWDCSizeMultiplier[1] to ResultSummary[1]:TargetDRtgPVMult if != 1"
      Proj:ResultSummary[1]:TargetDRtgPVMult  = {
         if (IfValidAnd( PVWDCSizeMultiplier[1] != 1 )==0) then  UNDEFINED
         else  PVWDCSizeMultiplier[1]  endif  }
   "Copy ResultSummary[1]:TargetDRtgPVMult to all orientations"  Proj:Action = {
         if (AllOrientations < 0.5) then  UNCHANGED
         else  EvalRulelist( "CopyToAllOrientations_TargetDRtgPVMult" )  endif  }
   "Blast Proj:TargetDRtgIterNum"   Proj:TargetDRtgIterNum  = {  UNDEFINED  }
END
;*************************************************************************

;*************************************************************************  ; SAC 3/3/18 (tic #973)
RULELIST "CopyToAllOrientations_TargetDRtgPVMult" 1 0 1 1
   "Copy ResultSummary[1]:TargetDRtgPVMult to ResultSummary[2]-N" 
      Proj:ResultSummary[2]:TargetDRtgPVMult  = {  ResultSummary[1]:TargetDRtgPVMult  }
   "Copy ResultSummary[1]:TargetDRtgPVMult to ResultSummary[3]-E" 
      Proj:ResultSummary[3]:TargetDRtgPVMult  = {  ResultSummary[1]:TargetDRtgPVMult  }
   "Copy ResultSummary[1]:TargetDRtgPVMult to ResultSummary[4]-S" 
      Proj:ResultSummary[4]:TargetDRtgPVMult  = {  ResultSummary[1]:TargetDRtgPVMult  }
   "Copy ResultSummary[1]:TargetDRtgPVMult to ResultSummary[5]-W" 
      Proj:ResultSummary[5]:TargetDRtgPVMult  = {  ResultSummary[1]:TargetDRtgPVMult  }
END
;*************************************************************************  ; SAC 3/3/18 (tic #973)
RULELIST "CopyToAllOrientations_PropPVScaleFactor" 1 0 1 1
   "Copy ResultSummary[1]:PropPVScaleFactor to ResultSummary[2]-N" 
      Proj:ResultSummary[2]:PropPVScaleFactor  = {  ResultSummary[1]:PropPVScaleFactor  }
   "Copy ResultSummary[1]:PropPVScaleFactor to ResultSummary[3]-E" 
      Proj:ResultSummary[3]:PropPVScaleFactor  = {  ResultSummary[1]:PropPVScaleFactor  }
   "Copy ResultSummary[1]:PropPVScaleFactor to ResultSummary[4]-S" 
      Proj:ResultSummary[4]:PropPVScaleFactor  = {  ResultSummary[1]:PropPVScaleFactor  }
   "Copy ResultSummary[1]:PropPVScaleFactor to ResultSummary[5]-W" 
      Proj:ResultSummary[5]:PropPVScaleFactor  = {  ResultSummary[1]:PropPVScaleFactor  }
END
;*************************************************************************

;   1,           "TargetDRtgResMsg",  BEMP_Str,  1,  1,  0, "",                 0,  0,                           7010, "TargetDesignRating results message - populated only once target achieved (or can't be achieved)"
;
;   Proj:TargetDRtgMaxIter,    - already set -   NotInput,   0,    0,   0,    1,  1,  1 BEMP_Int,  1,  0,  0,  "Max number of times we will iterate to achieve the target design rating"  ; SAC 4/11/17
;   Proj:TargetDRtgIterNum,     NotInput,   0,    0,   0,    1,  1,  1 BEMP_Int,  1,  0,  0,  "Number of times we have iterated thus far to achieve the target design rating"
;   Proj:TargetDRtgScores[ALL], NotInput,   0,    0,   0,    1,  1,  1 BEMP_Flt,  5,  1,  0,  "Archive of EDR scores from each iteration (to achieve the target design rating)"
;   Proj:TargetDRtgPVMults[ALL],NotInput,   0,    0,   0,    1,  1,  1 BEMP_Flt,  5,  1,  0,  "Archive of PV size multipliers from each iteration (to achieve the target design rating)"
;
;   "Set Proj:PVWDCSizeMultiplier (iff undefined) - multiplier on PV system size, used to iterate to achieve a target design rating"
;      Proj:PVWDCSizeMultiplier  = {
;         if (LocalStatus( PVWDCSizeMultiplier ) > 0) then  UNCHANGED
;         else  1  endif  }
;
;   Set Proj:TargetDesignRtg - Target Design Rating (100 * Prop / DesignRtg TDV)"
;      Proj:TargetDesignRtg  = {
;         if (EnergyCodeYearNum >= 2019 .AND. 
;             IfValidAnd( AllowDesignRating  > 0.5 ) .AND. IfValidAnd( DesignRatingCalcs  > 0.5 ) .AND.
;             IfValidAnd( SpecifyTargetDRtg  > 0.5 ) .AND. LocalStatus( TargetDesignRtgInp ) > 0)
;         then  TargetDesignRtgInp
;         else  UNDEFINED  endif  }
;
;   "Set Proj:TargetDRtgInpMsg"    Proj:TargetDRtgInpMsg  = {
;             IfValidAnd( ScalePropPVResults > 0.5 ) .AND. IfValidAnd( MaxPropPVRatioInp  > 0 ) .AND.
;         then  Format( "Max PV Generation Ratio of %g entered on Battery tab will supercede Target Design Rating", MaxPropPVRatioInp )
;         else  UNDEFINED  endif  }



;*************************************************************************   ; SAC 1/11/18 - prevent reporting of negative EDRs (depending on INI option)
RULELIST "ProcessResults_PreventReportingNegativeEDRs" 1 0 1 1

   "Set ResultsNotes[2] for neg EDRs"        EUseSummary:ResultsNotes[2] = {
         if (IfValidAnd( DesignRating < 0 )) then  "EDR is capped at zero"
         else  UNCHANGED  endif  }
	"Set HaveResultsNotesPV[2] for neg EDRs"  EUseSummary:HaveResultsNotesPV[2] = {
         if (IfValidAnd( DesignRating < 0 )) then  1
         else  UNCHANGED  endif  }
	"Set HaveResultsNotesPV[3] for neg EDRs"  EUseSummary:HaveResultsNotesPV[3] = {
         if (MaxAll( EUseSummary:HaveResultsNotesPV[2] ) > 0) then  1
         else  UNCHANGED  endif  }
	"Set ResultsNotes[3] for neg EDRs -1"     EUseSummary:ResultsNotes[3] = {
         if (IfValidAnd( HaveResultsNotesPV[3] > 0 ))
         then  if (IfValidAnd( Proj:AllOrientations > 0.5 ))
               then  "EDR is capped at zero for orientation(s):"
               else  "EDR is capped at zero"  endif
         else  UNCHANGED  endif  }
	"Set ResultsNotes[3] for neg EDRs -N"     EUseSummary:ResultsNotes[3] = {
         if (IfValidAnd( HaveResultsNotesPV[3] > 0 ) .AND. IfValidAnd( Proj:AllOrientations > 0.5 ) .AND.
             IfValidAnd( Proj:ResultSummary[2]:DesignRating < 0 ))
         then  ResultsNotes[3] + "  North"    else  UNCHANGED  endif  }
	"Set ResultsNotes[3] for neg EDRs -E"     EUseSummary:ResultsNotes[3] = {
         if (IfValidAnd( HaveResultsNotesPV[3] > 0 ) .AND. IfValidAnd( Proj:AllOrientations > 0.5 ) .AND.
             IfValidAnd( Proj:ResultSummary[3]:DesignRating < 0 ))
         then  ResultsNotes[3] + "  East"     else  UNCHANGED  endif  }
	"Set ResultsNotes[3] for neg EDRs -S"     EUseSummary:ResultsNotes[3] = {
         if (IfValidAnd( HaveResultsNotesPV[3] > 0 ) .AND. IfValidAnd( Proj:AllOrientations > 0.5 ) .AND.
             IfValidAnd( Proj:ResultSummary[4]:DesignRating < 0 ))
         then  ResultsNotes[3] + "  South"    else  UNCHANGED  endif  }
	"Set ResultsNotes[3] for neg EDRs -W"     EUseSummary:ResultsNotes[3] = {
         if (IfValidAnd( HaveResultsNotesPV[3] > 0 ) .AND. IfValidAnd( Proj:AllOrientations > 0.5 ) .AND.
             IfValidAnd( Proj:ResultSummary[5]:DesignRating < 0 ))
         then  ResultsNotes[3] + "  West"     else  UNCHANGED  endif  }

   "Zero out neg Prop EDR"    EUseSummary:DesignRating  = {
         if (IfValidAnd( DesignRating < 0 )) then  0
         else  UNCHANGED  endif  }
   "Zero out neg Std EDR"     EUseSummary:DesignRatingStd  = {
         if (IfValidAnd( DesignRatingStd < 0 )) then  0
         else  UNCHANGED  endif  }

   "Zero out neg Prop EDR1 EDR"    EUseSummary:EDR1DesignRating  = {
         if (IfValidAnd( EDR1DesignRating < 0 )) then  0
         else  UNCHANGED  endif  }
   "Zero out neg Std EDR1 EDR"     EUseSummary:EDR1DesignRatingStd  = {
         if (IfValidAnd( EDR1DesignRatingStd < 0 )) then  0
         else  UNCHANGED  endif  }

   "Zero out CompMargin DRs based on neg DRs-1"    EUseSummary:SummaryColFinMarg[5] = {
         if (find( SummaryColFinDR[5], "-" )==1) then  SummaryColFinDR[4]
         else  UNCHANGED  endif  }
   "Zero out Final DRs that are neg-1"             EUseSummary:SummaryColFinDR[5] = {
         if (find( SummaryColFinDR[5], "-" )==1) then  "0.0"
         else  UNCHANGED  endif  }

   "Zero out CompMargin DRs based on neg DRs-N"    EUseSummary:SummaryColFinMarg[6] = {
         if (find( SummaryColFinDR[6], "-" )==1) then  SummaryColFinDR[4]
         else  UNCHANGED  endif  }
   "Zero out Final DRs that are neg-N"             EUseSummary:SummaryColFinDR[6] = {
         if (find( SummaryColFinDR[6], "-" )==1) then  "0.0"
         else  UNCHANGED  endif  }

   "Zero out CompMargin DRs based on neg DRs-E"    EUseSummary:SummaryColFinMarg[7] = {
         if (find( SummaryColFinDR[7], "-" )==1) then  SummaryColFinDR[4]
         else  UNCHANGED  endif  }
   "Zero out Final DRs that are neg-E"             EUseSummary:SummaryColFinDR[7] = {
         if (find( SummaryColFinDR[7], "-" )==1) then  "0.0"
         else  UNCHANGED  endif  }

   "Zero out CompMargin DRs based on neg DRs-S"    EUseSummary:SummaryColFinMarg[8] = {
         if (find( SummaryColFinDR[8], "-" )==1) then  SummaryColFinDR[4]
         else  UNCHANGED  endif  }
   "Zero out Final DRs that are neg-S"             EUseSummary:SummaryColFinDR[8] = {
         if (find( SummaryColFinDR[8], "-" )==1) then  "0.0"
         else  UNCHANGED  endif  }

   "Zero out CompMargin DRs based on neg DRs-W"    EUseSummary:SummaryColFinMarg[9] = {
         if (find( SummaryColFinDR[9], "-" )==1) then  SummaryColFinDR[4]
         else  UNCHANGED  endif  }
   "Zero out Final DRs that are neg-W"             EUseSummary:SummaryColFinDR[9] = {
         if (find( SummaryColFinDR[9], "-" )==1) then  "0.0"
         else  UNCHANGED  endif  }

   "Revise Target EDR msg removing negative DR"    EUseSummary:TargetDRtgMsg  = {
         if (GlobalStatus( Proj:TargetDesignRtg ) > 0)
         then  if (find( TargetDRtgMsg, "Target design rating achieved (total rating of -" ) == 1)       ; TargetDesignRating_Success msg
               then  if (IfValidAnd( Proj:PVWLastRow = 1 ) .AND. IfValidAnd( Proj:PVWDCSysTotal > 0 ))
                     then  Format( "Target design rating achieved (total rating of 0.0 w/ PV size of %.2f kWdc).",
                                       (Proj:PVWDCSysTotal * ValidOr( Proj:PVWDCSizeMultiplier[1], 1 )) )
                     else  Format( "Target design rating achieved (total rating of 0.0 w/ PV multiplier of %.2f).",
                                       ValidOr( Proj:PVWDCSizeMultiplier[1], 1 ) )
                     endif
               else if (find( TargetDRtgMsg, " total: -" ) < 1) then  UNCHANGED
               else if (find( TargetDRtgMsg, "Target design rating not achievable w/out exceeding max PV" ) == 1)   ; TargetDesignRating_MaxPVConflict msg
               then  Format( "Target design rating not achievable w/out exceeding max PV generation (target: %g, total: 0.0 w/ max PV gen).",
                                 Proj:TargetDesignRtg )
               else if (find( TargetDRtgMsg, "Target EDR not achievable w/out exceeding max PV" ) == 1)     ; TargetDesignRating_Failure msg
               then  if (IfValidAnd( Proj:PVWLastRow = 1 ) .AND. IfValidAnd( Proj:PVWDCSysTotal > 0 ))
                     then  Format( "Target EDR not achievable w/out exceeding max PV generation (target: %g, total: 0.0 w/ PV size of %.2f kWdc).",
                                       Proj:TargetDesignRtg, (Proj:PVWDCSysTotal * ValidOr( Proj:PVWDCSizeMultiplier[1], 1 )) )
                     else  Format( "Target EDR not achievable w/out exceeding max PV generation (target: %g, total: 0.0 w/ PV multiplier of %.2f).",
                                       Proj:TargetDesignRtg, ValidOr( Proj:PVWDCSizeMultiplier[1], 1 ) )
                     endif
               else if (find( TargetDRtgMsg, "Target EDR not achieved within the max of" ) == 1)            ; TargetDesignRating_Failure msg
               then  if (IfValidAnd( Proj:PVWLastRow = 1 ) .AND. IfValidAnd( Proj:PVWDCSysTotal > 0 ))
                     then  Format( "Target EDR not achieved within the max of %g iterations (target: %g, total: 0.0 w/ PV size of %.2f kWdc).",
                                       Proj:TargetDRtgMaxIter, Proj:TargetDesignRtg, (Proj:PVWDCSysTotal * ValidOr( Proj:PVWDCSizeMultiplier[1], 1 )) )
                     else  Format( "Target EDR not achieved within the max of %g iterations (target: %g, total: 0.0 w/ PV multiplier of %.2f).",
                                       Proj:TargetDRtgMaxIter, Proj:TargetDesignRtg, ValidOr( Proj:PVWDCSizeMultiplier[1], 1 ) )
                     endif
               else  UNCHANGED
               endif endif endif endif endif
         else  UNCHANGED  endif  }
END
;*************************************************************************

;*************************************************************************
RULELIST "CARes_EnergyUse_CopyProposedResults" 1 0 0 1

	"Set EnergyUse:ProposedTDV[2]"			EnergyUse:ProposedTDV[2]			= {	EnergyUse:ProposedTDV[1]  }
	"Set EnergyUse:ProposedTDV[3]"			EnergyUse:ProposedTDV[3]			= {	EnergyUse:ProposedTDV[1]  }
	"Set EnergyUse:ProposedSrc[2]"			EnergyUse:ProposedSrc[2]			= {	EnergyUse:ProposedSrc[1]  }
	"Set EnergyUse:ProposedSrc[3]"			EnergyUse:ProposedSrc[3]			= {	EnergyUse:ProposedSrc[1]  }
	"Set EnergyUse:PropElecEnergy[2]"		EnergyUse:PropElecEnergy[2]		= {	EnergyUse:PropElecEnergy[1]  }
	"Set EnergyUse:PropNatGasEnergy[2]"		EnergyUse:PropNatGasEnergy[2]		= {	EnergyUse:PropNatGasEnergy[1]  }
	"Set EnergyUse:PropOtherEnergy[2]"		EnergyUse:PropOtherEnergy[2]		= {	EnergyUse:PropOtherEnergy[1]  }
	"Set EnergyUse:PropTotalEnergy[2]"		EnergyUse:PropTotalEnergy[2]		= {	EnergyUse:PropTotalEnergy[1]  }
	"Set EnergyUse:PropElecTDV[2]"			EnergyUse:PropElecTDV[2]			= {	EnergyUse:PropElecTDV[1]  }
	"Set EnergyUse:PropElecSrc[2]"			EnergyUse:PropElecSrc[2]			= {	EnergyUse:PropElecSrc[1]  }
	"Set EnergyUse:PropElecDemand[2]"		EnergyUse:PropElecDemand[2]		= {	EnergyUse:PropElecDemand[1]  }

	"Copy Proposed EUseSummary properties"	Proj:Action = {	EvalRulelist( "CARes_EnergyUse_CopyProposedSummaryResults" )  }

END
;*************************************************************************
RULELIST "CARes_EnergyUse_CopyProposedSummaryResults" 1 0 1 1

	"Set EUseSummary:Title1[17]"			EUseSummary:Title1[17]			= {	Title1[2]  }	; Proposed Elec Use -> DRtg Prop Elec Use
	"Set EUseSummary:Title2[17]"			EUseSummary:Title2[17]			= {	Title2[2]  }
	"Set EUseSummary:Title3[17]"			EUseSummary:Title3[17]			= {	Title3[2]  }
	"Set EUseSummary:Enduse1[17]"			EUseSummary:Enduse1[17]			= {	Enduse1[2]  }
	"Set EUseSummary:Enduse2[17]"			EUseSummary:Enduse2[17]			= {	Enduse2[2]  }
	"Set EUseSummary:Enduse3[17]"			EUseSummary:Enduse3[17]			= {	Enduse3[2]  }
	"Set EUseSummary:Enduse4[17]"			EUseSummary:Enduse4[17]			= {	Enduse4[2]  }
	"Set EUseSummary:Enduse5[17]"			EUseSummary:Enduse5[17]			= {	Enduse5[2]  }
	"Set EUseSummary:Enduse6[17]"			EUseSummary:Enduse6[17]			= {	Enduse6[2]  }
	"Set EUseSummary:Enduse7[17]"			EUseSummary:Enduse7[17]			= {	Enduse7[2]  }
	"Set EUseSummary:Enduse8[17]"			EUseSummary:Enduse8[17]			= {	Enduse8[2]  }
	"Set EUseSummary:Enduse9[17]"			EUseSummary:Enduse9[17]			= {	Enduse9[2]  }
	"Set EUseSummary:Enduse10[17]"		EUseSummary:Enduse10[17]		= {	Enduse10[2]  }
	"Set EUseSummary:Enduse11[17]"		EUseSummary:Enduse11[17]		= {	Enduse11[2]  }
	"Set EUseSummary:Enduse12[17]"		EUseSummary:Enduse12[17]		= {	Enduse12[2]  }
	"Set EUseSummary:Enduse13[17]"		EUseSummary:Enduse13[17]		= {	Enduse13[2]  }
	"Set EUseSummary:Enduse14[17]"		EUseSummary:Enduse14[17]		= {	Enduse14[2]  }
	"Set EUseSummary:SummaryCol1[17]"	EUseSummary:SummaryCol1[17]	= {	SummaryCol1[2]  } 
	"Set EUseSummary:SummaryCol2[17]"	EUseSummary:SummaryCol2[17]	= {	SummaryCol2[2]  }
	"Set EUseSummary:SummaryCol3[17]"	EUseSummary:SummaryCol3[17]	= {	SummaryCol3[2]  }

	"Set EUseSummary:Title1[18]"			EUseSummary:Title1[18]			= {	Title1[3]  }	; Proposed NatGas Use -> DRtg Prop NatGas Use
	"Set EUseSummary:Title2[18]"			EUseSummary:Title2[18]			= {	Title2[3]  }
	"Set EUseSummary:Title3[18]"			EUseSummary:Title3[18]			= {	Title3[3]  }
	"Set EUseSummary:Enduse1[18]"			EUseSummary:Enduse1[18]			= {	Enduse1[3]  }
	"Set EUseSummary:Enduse2[18]"			EUseSummary:Enduse2[18]			= {	Enduse2[3]  }
	"Set EUseSummary:Enduse3[18]"			EUseSummary:Enduse3[18]			= {	Enduse3[3]  }
	"Set EUseSummary:Enduse4[18]"			EUseSummary:Enduse4[18]			= {	Enduse4[3]  }
	"Set EUseSummary:Enduse5[18]"			EUseSummary:Enduse5[18]			= {	Enduse5[3]  }
	"Set EUseSummary:Enduse6[18]"			EUseSummary:Enduse6[18]			= {	Enduse6[3]  }
	"Set EUseSummary:Enduse7[18]"			EUseSummary:Enduse7[18]			= {	Enduse7[3]  }
	"Set EUseSummary:Enduse8[18]"			EUseSummary:Enduse8[18]			= {	Enduse8[3]  }
	"Set EUseSummary:Enduse9[18]"			EUseSummary:Enduse9[18]			= {	Enduse9[3]  }
	"Set EUseSummary:Enduse10[18]"		EUseSummary:Enduse10[18]		= {	Enduse10[3]  }
	"Set EUseSummary:Enduse11[18]"		EUseSummary:Enduse11[18]		= {	Enduse11[3]  }
	"Set EUseSummary:Enduse12[18]"		EUseSummary:Enduse12[18]		= {	Enduse12[3]  }
	"Set EUseSummary:Enduse13[18]"		EUseSummary:Enduse13[18]		= {	Enduse13[3]  }
	"Set EUseSummary:Enduse14[18]"		EUseSummary:Enduse14[18]		= {	Enduse14[3]  }
	"Set EUseSummary:SummaryCol1[18]"	EUseSummary:SummaryCol1[18]	= {	SummaryCol1[3]  } 
	"Set EUseSummary:SummaryCol2[18]"	EUseSummary:SummaryCol2[18]	= {	SummaryCol2[3]  }
	"Set EUseSummary:SummaryCol3[18]"	EUseSummary:SummaryCol3[18]	= {	SummaryCol3[3]  }

	"Set EUseSummary:Title1[19]"			EUseSummary:Title1[19]			= {	Title1[4]  }	; Proposed Total TDV -> DRtg Prop Total TDV
	"Set EUseSummary:Title2[19]"			EUseSummary:Title2[19]			= {	Title2[4]  }
	"Set EUseSummary:Title3[19]"			EUseSummary:Title3[19]			= {	Title3[4]  }
	"Set EUseSummary:Enduse1[19]"			EUseSummary:Enduse1[19]			= {	Enduse1[4]  }
	"Set EUseSummary:Enduse2[19]"			EUseSummary:Enduse2[19]			= {	Enduse2[4]  }
	"Set EUseSummary:Enduse3[19]"			EUseSummary:Enduse3[19]			= {	Enduse3[4]  }
	"Set EUseSummary:Enduse4[19]"			EUseSummary:Enduse4[19]			= {	Enduse4[4]  }
	"Set EUseSummary:Enduse5[19]"			EUseSummary:Enduse5[19]			= {	Enduse5[4]  }
	"Set EUseSummary:Enduse6[19]"			EUseSummary:Enduse6[19]			= {	Enduse6[4]  }
	"Set EUseSummary:Enduse7[19]"			EUseSummary:Enduse7[19]			= {	Enduse7[4]  }
	"Set EUseSummary:Enduse8[19]"			EUseSummary:Enduse8[19]			= {	Enduse8[4]  }
	"Set EUseSummary:Enduse9[19]"			EUseSummary:Enduse9[19]			= {	Enduse9[4]  }
	"Set EUseSummary:Enduse10[19]"		EUseSummary:Enduse10[19]		= {	Enduse10[4]  }
	"Set EUseSummary:Enduse11[19]"		EUseSummary:Enduse11[19]		= {	Enduse11[4]  }
	"Set EUseSummary:Enduse12[19]"		EUseSummary:Enduse12[19]		= {	Enduse12[4]  }
	"Set EUseSummary:Enduse13[19]"		EUseSummary:Enduse13[19]		= {	Enduse13[4]  }
	"Set EUseSummary:Enduse14[19]"		EUseSummary:Enduse14[19]		= {	Enduse14[4]  }
	"Set EUseSummary:SummaryCol1[19]"	EUseSummary:SummaryCol1[19]	= {	SummaryCol1[4]  } 
	"Set EUseSummary:SummaryCol2[19]"	EUseSummary:SummaryCol2[19]	= {	SummaryCol2[4]  }
	"Set EUseSummary:SummaryCol3[19]"	EUseSummary:SummaryCol3[19]	= {	SummaryCol3[4]  }
END
;*************************************************************************

; 'HPHtg' -> 'HPBU' - SAC 07/02/21

;*************************************************************************
RULELIST "CARes_StdMixedFuelResults" 1 0 1 1
;*************************************************************************
;"debug"  Proj:Action = {  PostMessageToLog( "  evaluating 'CARes_StdMixedFuelResults':  RunAbbrev '%s'  RunNumber %g", RunAbbrev, RunNumber )  }
   ; SAC 12/20/17 - call rules to blast and re-create RunResults objects as part of mods to move StdMixedFuel run(s) to beginning of analysis sequence
   "Refresh RunResults objects"  Proj:Action  = {
         if (IfValidAnd( RunNumber < 2 )==0) then  UNCHANGED
         else  EvalRulelist( "CARes_Refresh_RunResults" )  endif  }

   ; SAC 2/27/18 - added "DhwMFL" enduse following each reference to "DHWPmp"
   ; SAC 1/8/19 - summed in CSE enduse 'User2' to each elec DHW results retrieval (to capture HPWH XBU energy)
   "Store Electric use of standard mixed fuel run"    Proj:ResultSummary[1]:StdMixedFuelkWh  = {
         ( HourlyResultSum( RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) +     ; SpcHtg
           HourlyResultSum( RunID, "MtrElec",   "Clg", "FanC" ) +                ; SpcClg
           HourlyResultSum( RunID, "MtrElec",   "FanV" ) +                       ; IAQVent
           HourlyResultSum( RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2" ) +        ; WtrHtg
           HourlyResultSum( RunID, "MtrElec",   "Lit" ) +                        ; InsLtg
           HourlyResultSum( RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) +    ; ApplCook
           HourlyResultSum( RunID, "MtrElec",   "Rcp" ) +                        ; PlugLds
           HourlyResultSum( RunID, "MtrElec",   "Ext" )  ) / 3.412  }            ; Exterior
   "Store Electric use of standard mixed fuel run-2"    Proj:ResultSummary[1]:StdMixedFuelkWh  = {
         if (CSEinclDHWMFL_EU)
         then  ResultSummary[1]:StdMixedFuelkWh +
               ( HourlyResultSum( RunID, "MtrElec",   "DhwMFL" ) / 3.412 )     ; WtrHtg
         else  UNCHANGED  endif  }

   "Store PV Electric generation of standard mixed fuel run"    Proj:ResultSummary[1]:StdMixedFuelPV  = {
           HourlyResultSum( RunID, "MtrElec",   "PV" )  / 3.412  }

; SAC 1/11/18 - moved to BudgetConversion rules where Std Design PV system setup
;   "Scale StdMixedFuelPV to adjust for Reduced PV Requirement (ReducedPVReq)"   ; SAC 1/3/18
;      Proj:ResultSummary[1]:StdMixedFuelPV  = {
;         if (IfValidAnd( ResultSummary[1]:StdMixedFuelPV  < 0 )==0 .OR.
;             IfValidAnd( ResultSummary[1]:StdMixedFuelkWh > 0 )==0 .OR.
;             IfValidAnd( UseReducedPVReqVal >= 0 )==0) then  UNCHANGED
;         else if (UseReducedPVReqVal = 0) then  0
;         else if ((-1 * ResultSummary[1]:StdMixedFuelkWh / ResultSummary[1]:StdMixedFuelPV) > UseReducedPVReqVal)
;         then  ResultSummary[1]:StdMixedFuelPV * (-1 * ResultSummary[1]:StdMixedFuelkWh / ResultSummary[1]:StdMixedFuelPV) / UseReducedPVReqVal
;         else  UNCHANGED  endif endif endif  }

   ; added calc of SMF PV scaling factor while debugging std design carbon results - SAC 10/6/17
   "Calc standard mixed fuel PV scaling factor"  Proj:ResultSummary[1]:StdMixedFuelPVMlt  = {
         if (IfValidAnd( ResultSummary[1]:StdMixedFuelPV  < 0 ) .AND.
             IfValidAnd( ResultSummary[1]:StdMixedFuelkWh > 0 ))
         then  (-1 * ResultSummary[1]:StdMixedFuelkWh / ResultSummary[1]:StdMixedFuelPV)
         else  1.0  endif  }
;"dbg" Proj:Action = {  PostMessageToLog( "     just set ResultSummary[1]:StdMixedFuelPVMlt = %g", ValidOr( ResultSummary[1]:StdMixedFuelPVMlt, -999 ) )  }
         ; SAC 8/24/19 - replaced 1/3.413 & 0.01 TDV table multipliers with Proj:TDVSecMult_Elec & TDVSecMult_Fuel to accommodate 2022+ switch to native (E3) TDV table units
         ; SAC 8/26/19 - added primary table multipliers (of 1.0) to all ApplyHourlyResultMult* function calls (to accommodate 2022+ TDV table unit switch)
         ; revised call to ApplyHourlyResultMultipliers_NEM() to include hourly NEM table name & col arguments - SAC 05/16/23 (NEM3)
   "Calc TDV of PV Electric generation for standard mixed fuel run"  Proj:ResultSummary[1]:StdMixedFuelPVTDV  = {
         int( (100 * ApplyHourlyResultMultipliers_NEM( "PVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV", "Tot",
                                                                              NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, ResultSummary[1]:StdMixedFuelPVMlt ) / CondFloorArea) + 0.5) / 100  }
;"dbg" Proj:Action = { PostMessageToLog( "   Just set ResultSummary[1]:StdMixedFuelPVTDV = %g", ValidOr( ResultSummary[1]:StdMixedFuelPVTDV, -999 ) )  }

   "Copy StdMixedFuel* results from first EUseSummary into orientation-specific ones"  Proj:Action = {
         if (IfValidAnd( AllOrientations > 0)==0) then  UNCHANGED
         else  EvalRulelist( "CARes_StdMixedFuelResults_OrientationCopy" )  endif  }

; SAC 12/20/17 - moved to end of 'CARes_StandardResults' during process of moving StdMixedFuel run to first in analysis sequence
;  ; SAC 10/5/17 - added rules to calc carbon emissions by enduse
;   "Call rulelist to setup std design PV 8760"  Proj:Action = {   if (EnergyCodeYearNum < 2019) then  UNCHANGED
;                                                                  else  EvalRulelist( "CARes_StandardResults_Carbon" )  endif  }
;;                                                                  else  EvalRulelist( "CARes_StdMixedFuelResults_Carbon" )  endif  }
END
;*************************************************************************  - SAC 1/17/18
RULELIST "CARes_StdMixedFuelResults_OrientationCopy" 1 0 1 1
   "Copy to ResultSummary[2]:StdMixedFuelkWh"   Proj:ResultSummary[2]:StdMixedFuelkWh   = {  ResultSummary[1]:StdMixedFuelkWh    }
   "Copy to ResultSummary[2]:StdMixedFuelPV"    Proj:ResultSummary[2]:StdMixedFuelPV    = {  ResultSummary[1]:StdMixedFuelPV     }
   "Copy to ResultSummary[2]:StdMixedFuelPVTDV" Proj:ResultSummary[2]:StdMixedFuelPVTDV = {  ResultSummary[1]:StdMixedFuelPVTDV  }
   "Copy to ResultSummary[2]:StdMixedFuelPVMlt" Proj:ResultSummary[2]:StdMixedFuelPVMlt = {  ResultSummary[1]:StdMixedFuelPVMlt  }

   "Copy to ResultSummary[3]:StdMixedFuelkWh"   Proj:ResultSummary[3]:StdMixedFuelkWh   = {  ResultSummary[1]:StdMixedFuelkWh    }
   "Copy to ResultSummary[3]:StdMixedFuelPV"    Proj:ResultSummary[3]:StdMixedFuelPV    = {  ResultSummary[1]:StdMixedFuelPV     }
   "Copy to ResultSummary[3]:StdMixedFuelPVTDV" Proj:ResultSummary[3]:StdMixedFuelPVTDV = {  ResultSummary[1]:StdMixedFuelPVTDV  }
   "Copy to ResultSummary[3]:StdMixedFuelPVMlt" Proj:ResultSummary[3]:StdMixedFuelPVMlt = {  ResultSummary[1]:StdMixedFuelPVMlt  }

   "Copy to ResultSummary[4]:StdMixedFuelkWh"   Proj:ResultSummary[4]:StdMixedFuelkWh   = {  ResultSummary[1]:StdMixedFuelkWh    }
   "Copy to ResultSummary[4]:StdMixedFuelPV"    Proj:ResultSummary[4]:StdMixedFuelPV    = {  ResultSummary[1]:StdMixedFuelPV     }
   "Copy to ResultSummary[4]:StdMixedFuelPVTDV" Proj:ResultSummary[4]:StdMixedFuelPVTDV = {  ResultSummary[1]:StdMixedFuelPVTDV  }
   "Copy to ResultSummary[4]:StdMixedFuelPVMlt" Proj:ResultSummary[4]:StdMixedFuelPVMlt = {  ResultSummary[1]:StdMixedFuelPVMlt  }

   "Copy to ResultSummary[5]:StdMixedFuelkWh"   Proj:ResultSummary[5]:StdMixedFuelkWh   = {  ResultSummary[1]:StdMixedFuelkWh    }
   "Copy to ResultSummary[5]:StdMixedFuelPV"    Proj:ResultSummary[5]:StdMixedFuelPV    = {  ResultSummary[1]:StdMixedFuelPV     }
   "Copy to ResultSummary[5]:StdMixedFuelPVTDV" Proj:ResultSummary[5]:StdMixedFuelPVTDV = {  ResultSummary[1]:StdMixedFuelPVTDV  }
   "Copy to ResultSummary[5]:StdMixedFuelPVMlt" Proj:ResultSummary[5]:StdMixedFuelPVMlt = {  ResultSummary[1]:StdMixedFuelPVMlt  }
END
;*************************************************************************

;*************************************************************************
RULELIST "CARes_PrelimPropResults" 1 0 1 1
;*************************************************************************
;"debug"  Proj:Action = {  PostMessageToLog( "  evaluating 'CARes_PrelimPropResults':  RunAbbrev '%s'  RunNumber %g", RunAbbrev, RunNumber )  }
   ; SAC 12/20/17 - call rules to blast and re-create RunResults objects as part of mods to move StdMixedFuel run(s) to beginning of analysis sequence
   "Refresh RunResults objects"  Proj:Action  = {
         if (IfValidAnd( RunNumber < 2 )==0) then  UNCHANGED
         else  EvalRulelist( "CARes_Refresh_RunResults" )  endif  }

   ; SAC 12/30/17 - added battery elec use into total PrelimProp elec use used in scaling PV system
   "Store Electric use of prelim proposed run"    Proj:ResultSummary[1]:PrelimPropkWh  = {
         ( HourlyResultSum( RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) +     ; SpcHtg
           HourlyResultSum( RunID, "MtrElec",   "Clg", "FanC" ) +                ; SpcClg
           HourlyResultSum( RunID, "MtrElec",   "FanV" ) +                       ; IAQVent
           HourlyResultSum( RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2" ) +        ; WtrHtg
           HourlyResultSum( RunID, "MtrElec",   "Lit" ) +                        ; InsLtg
           HourlyResultSum( RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) +    ; ApplCook
           HourlyResultSum( RunID, "MtrElec",   "Rcp" ) +                        ; PlugLds
           HourlyResultSum( RunID, "MtrElec",   "Ext" ) +                        ; Exterior
           HourlyResultSum( RunID, "MtrElec",   "BT"  )  ) / 3.412  }            ; Battery
   "Store Electric use of prelim proposed run-2"    Proj:ResultSummary[1]:PrelimPropkWh  = {
         if (CSEinclDHWMFL_EU)
         then  ResultSummary[1]:PrelimPropkWh +
               ( HourlyResultSum( RunID, "MtrElec",   "DhwMFL" ) / 3.412 )     ; WtrHtg
         else  UNCHANGED  endif  }

   "Store PV Electric generation of prelim proposed run"    Proj:ResultSummary[1]:PrelimPropPV  =      ; SAC 7/16/20 (CommunitySolar)
      {  if (CommunitySolarProjID > 0 .AND. IfValidAnd( CmntySlr_ElecEnergy < 0 )) then  CmntySlr_ElecEnergy
         else  HourlyResultSum( RunID, "MtrElec",   "PV" )  / 3.412  endif  }
   "Store PV Electric generation TDV of prelim proposed run"    Proj:ResultSummary[1]:PrelimPropPVTDV  =       ; SAC 6/9/20 (CommunitySolar)    ; SAC 7/16/20 (CommunitySolar)
      {  if (IfValidAnd( ResultSummary[1]:PrelimPropPV < 0 )==0) then  UNDEFINED
         else if (CommunitySolarProjID > 0 .AND. IfValidAnd( CmntySlr_TDV < 0 )) then  CmntySlr_TDV / CondFloorArea
         else  int( (100 * ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV" ) / CondFloorArea) + 0.5) / 100
         endif endif  }

   "Calc PropInputPVMult - Scaling factor applied to user input PV capacity to prevent exceeding max PV generation"
      Proj:ResultSummary[1]:PropInputPVMult  = {
         if (IfValidAnd( Proj:AllowExcessPVEDR > 0 ) .OR. IfValidAnd( Proj:PVWDCSysTotal > 0 )==0 .OR.
             IfValidAnd( Proj:MaxPropPVRatio > 0 )==0 .OR.
             IfValidAnd( ResultSummary[1]:PrelimPropPV < 0 )==0) then  UNDEFINED
         else  ResultSummary[1]:PrelimPropkWh * Proj:MaxPropPVRatio / (-1 * ResultSummary[1]:PrelimPropPV)
         endif  }
      ; removed following to set PropInputPVMult regardless of whether PV system needs to be scaled down
      ;   else if ((ResultSummary[1]:PrelimPropkWh * Proj:MaxPropPVRatio) >= (-1 * ResultSummary[1]:PrelimPropPV) + 0.001)
      ;   then  UNDEFINED

;"dbg" Proj:Action = { MessageBox( "Just set ResultSummary[1]:PropInputPVMult to %g\n\n   Proj:AllowExcessPVEDR = %g\n\n   Proj:PVWDCSysTotal = %g\n\n   Proj:MaxPropPVRatio = %g\n\n   ResultSummary[1]:PrelimPropPV = %g\n\n   ResultSummary[1]:PrelimPropkWh = %g",
;                        ValidOr( ResultSummary[1]:PropInputPVMult, -999 ), ValidOr( AllowExcessPVEDR, -999 ), ValidOr( PVWDCSysTotal, -999 ), ValidOr( MaxPropPVRatio, -999 ), ValidOr( ResultSummary[1]:PrelimPropPV, -999 ), ValidOr( ResultSummary[1]:PrelimPropkWh, -999 ) )  }

         ; SAC 8/24/19 - replaced 1/3.413 & 0.01 TDV table multipliers with Proj:TDVSecMult_Elec & TDVSecMult_Fuel to accommodate 2022+ switch to native (E3) TDV table units
         ; SAC 8/26/19 - added primary table multipliers (of 1.0) to all ApplyHourlyResultMult* function calls (to accommodate 2022+ TDV table unit switch)
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run - HtgElec"       Proj:ResultSummary[1]:PrelimPropCompTDV  = {
         if (Fuel_HaveElec < 0.5 .OR. CondFloorArea < 1) then  0
         else if (HourlyResultSum( RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) < 0.0001) then  0
         else  ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / CondFloorArea
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run - HtgNGas"       Proj:ResultSummary[1]:PrelimPropCompTDV  = {
         if (Fuel_HaveNatGas < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrNatGas", "Htg", "HPBU", "Aux" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[1]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Htg", "HPBU", "Aux"                ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run - HtgOthr"       Proj:ResultSummary[1]:PrelimPropCompTDV  = {
         if (Fuel_HaveOther < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrOther",  "Htg", "HPBU",  "Aux" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[1]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Htg", "HPBU", "Aux"                ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run - ClgElec"       Proj:ResultSummary[1]:PrelimPropCompTDV  = {
         if (Fuel_HaveElec < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrElec",  "Clg", "FanC" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[1]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run - ClgNGas"       Proj:ResultSummary[1]:PrelimPropCompTDV  = {
         if (Fuel_HaveNatGas < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrNatGas",  "Clg" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[1]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Clg" ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run - ClgOthr"       Proj:ResultSummary[1]:PrelimPropCompTDV  = {
         if (Fuel_HaveOther < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrOther",  "Clg" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[1]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Clg" ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run - IAQVentElec"   Proj:ResultSummary[1]:PrelimPropCompTDV  = {
         if (Fuel_HaveElec < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrElec",  "FanV" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[1]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "FanV" ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run - WtrHtElec"     Proj:ResultSummary[1]:PrelimPropCompTDV  = {
         if (Fuel_HaveElec < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (CSEinclDHWMFL_EU)
			then  if (HourlyResultSum( RunID, "MtrElec",  "Dhw", "DhwBU", "DHWPmp", "DhwMFL", "User2" ) < 0.0001) then  UNCHANGED
               else  ResultSummary[1]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "DhwMFL", "User2" ) / CondFloorArea)
               endif
         else if (HourlyResultSum( RunID, "MtrElec",  "Dhw", "DhwBU", "DHWPmp", "User2" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[1]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2" ) / CondFloorArea)
         endif endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run - WtrHtNGas"     Proj:ResultSummary[1]:PrelimPropCompTDV  = {
         if (Fuel_HaveNatGas < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrNatGas",  "Dhw", "DhwBU" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[1]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run - WtrHtOthr"     Proj:ResultSummary[1]:PrelimPropCompTDV  = {
         if (Fuel_HaveOther < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrOther",  "Dhw", "DhwBU" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[1]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea)
         endif endif  }
END

;************************************************************************* - SAC 1/5/18
RULELIST "CARes_PrelimPropResults_N" 1 0 1 1
;"debug"  Proj:Action = {  PostMessageToLog( "  evaluating 'CARes_PrelimPropResults_N':  RunAbbrev '%s'  RunNumber %g", RunAbbrev, RunNumber )  }
   ; SAC 1/5/18 - call rules to blast and re-create RunResults objects as part of mods to move StdMixedFuel run(s) to beginning of analysis sequence
   "Refresh RunResults objects-N"  Proj:Action  = {
         if (IfValidAnd( RunNumber < 2 )==0) then  UNCHANGED
         else  EvalRulelist( "CARes_Refresh_RunResults_N" )  endif  }

   ; SAC 12/30/17 - added battery elec use into total PrelimProp elec use used in scaling PV system
   "Store Electric use of prelim proposed run-N"    Proj:ResultSummary[2]:PrelimPropkWh  = {
         ( HourlyResultSum( RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) +     ; SpcHtg
           HourlyResultSum( RunID, "MtrElec",   "Clg", "FanC" ) +                ; SpcClg
           HourlyResultSum( RunID, "MtrElec",   "FanV" ) +                       ; IAQVent
           HourlyResultSum( RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2" ) +        ; WtrHtg
           HourlyResultSum( RunID, "MtrElec",   "Lit" ) +                        ; InsLtg
           HourlyResultSum( RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) +    ; ApplCook
           HourlyResultSum( RunID, "MtrElec",   "Rcp" ) +                        ; PlugLds
           HourlyResultSum( RunID, "MtrElec",   "Ext" ) +                        ; Exterior
           HourlyResultSum( RunID, "MtrElec",   "BT"  )  ) / 3.412  }            ; Battery
   "Store Electric use of prelim proposed run-N-2"    Proj:ResultSummary[2]:PrelimPropkWh  = {
         if (CSEinclDHWMFL_EU)
         then  ResultSummary[2]:PrelimPropkWh +
               ( HourlyResultSum( RunID, "MtrElec",   "DhwMFL" ) / 3.412 )
         else  UNCHANGED  endif  }

   "Store PV Electric generation of prelim proposed run-N"    Proj:ResultSummary[2]:PrelimPropPV  =      ; SAC 7/16/20 (CommunitySolar)
      {  if (CommunitySolarProjID > 0 .AND. IfValidAnd( CmntySlr_ElecEnergy < 0 )) then  CmntySlr_ElecEnergy
         else  HourlyResultSum( RunID, "MtrElec",   "PV" )  / 3.412
         endif  }
   "Store PV Electric generation TDV of prelim proposed run-N"    Proj:ResultSummary[2]:PrelimPropPVTDV  =        ; SAC 6/9/20 (CommunitySolar)    ; SAC 7/16/20 (CommunitySolar)
      {  if (IfValidAnd( ResultSummary[2]:PrelimPropPV < 0 )==0) then  UNDEFINED
         else if (CommunitySolarProjID > 0 .AND. IfValidAnd( CmntySlr_TDV < 0 )) then  CmntySlr_TDV / CondFloorArea
         else  int( (100 * ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV" ) / CondFloorArea) + 0.5) / 100
         endif endif  }

   "Calc PropInputPVMult-N - Scaling factor applied to user input PV capacity to prevent exceeding max PV generation"   ; wrap Proj:AllowExcessPVEDR in IfValidAnd - SAC 04/09/22
      Proj:ResultSummary[2]:PropInputPVMult  = {
         if (IfValidAnd( Proj:AllowExcessPVEDR > 0 ) .OR. IfValidAnd( Proj:PVWDCSysTotal > 0 )==0 .OR.
             IfValidAnd( Proj:MaxPropPVRatio > 0 )==0 .OR.
             IfValidAnd( ResultSummary[2]:PrelimPropPV < 0 )==0) then  UNDEFINED
         else  ResultSummary[2]:PrelimPropkWh * Proj:MaxPropPVRatio / (-1 * ResultSummary[2]:PrelimPropPV)
         endif  }
      ; removed following to set PropInputPVMult regardless of whether PV system needs to be scaled down
      ;   else if ((ResultSummary[2]:PrelimPropkWh * Proj:MaxPropPVRatio) >= (-1 * ResultSummary[2]:PrelimPropPV) + 0.001)
      ;   then  UNDEFINED
;"dbg" Proj:Action = { MessageBox( "Just set ResultSummary[2]:PropInputPVMult to %g\n\n   Proj:AllowExcessPVEDR = %g\n\n   Proj:PVWDCSysTotal = %g\n\n   Proj:MaxPropPVRatio = %g\n\n   ResultSummary[2]:PrelimPropPV = %g\n\n   ResultSummary[2]:PrelimPropkWh = %g",
;                        ValidOr( ResultSummary[2]:PropInputPVMult, -999 ), ValidOr( AllowExcessPVEDR, -999 ), ValidOr( PVWDCSysTotal, -999 ), ValidOr( MaxPropPVRatio, -999 ), ValidOr( ResultSummary[2]:PrelimPropPV, -999 ), ValidOr( ResultSummary[2]:PrelimPropkWh, -999 ) )  }

         ; SAC 8/24/19 - replaced 1/3.413 & 0.01 TDV table multipliers with Proj:TDVSecMult_Elec & TDVSecMult_Fuel to accommodate 2022+ switch to native (E3) TDV table units
         ; SAC 8/26/19 - added primary table multipliers (of 1.0) to all ApplyHourlyResultMult* function calls (to accommodate 2022+ TDV table unit switch)
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-N - HtgElec"       Proj:ResultSummary[2]:PrelimPropCompTDV  = {
         if (Fuel_HaveElec < 0.5 .OR. CondFloorArea < 1) then  0
         else if (HourlyResultSum( RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) < 0.0001) then  0
         else  ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / CondFloorArea
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-N - HtgNGas"       Proj:ResultSummary[2]:PrelimPropCompTDV  = {
         if (Fuel_HaveNatGas < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrNatGas", "Htg", "HPBU", "Aux" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[2]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Htg", "HPBU", "Aux"                ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-N - HtgOthr"       Proj:ResultSummary[2]:PrelimPropCompTDV  = {
         if (Fuel_HaveOther < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrOther",  "Htg", "HPBU",  "Aux" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[2]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Htg", "HPBU", "Aux"                ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-N - ClgElec"       Proj:ResultSummary[2]:PrelimPropCompTDV  = {
         if (Fuel_HaveElec < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrElec",  "Clg", "FanC" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[2]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-N - ClgNGas"       Proj:ResultSummary[2]:PrelimPropCompTDV  = {
         if (Fuel_HaveNatGas < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrNatGas",  "Clg" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[2]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Clg" ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-N - ClgOthr"       Proj:ResultSummary[2]:PrelimPropCompTDV  = {
         if (Fuel_HaveOther < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrOther",  "Clg" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[2]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Clg" ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-N - IAQVentElec"   Proj:ResultSummary[2]:PrelimPropCompTDV  = {
         if (Fuel_HaveElec < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrElec",  "FanV" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[2]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "FanV" ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-N - WtrHtElec"     Proj:ResultSummary[2]:PrelimPropCompTDV  = {
         if (Fuel_HaveElec < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (CSEinclDHWMFL_EU)
			then  if (HourlyResultSum( RunID, "MtrElec",  "Dhw", "DhwBU", "DHWPmp", "DhwMFL", "User2" ) < 0.0001) then  UNCHANGED
               else  ResultSummary[2]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "DhwMFL", "User2" ) / CondFloorArea)
               endif
         else if (HourlyResultSum( RunID, "MtrElec",  "Dhw", "DhwBU", "DHWPmp", "User2" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[2]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2" ) / CondFloorArea)
         endif endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-N - WtrHtNGas"     Proj:ResultSummary[2]:PrelimPropCompTDV  = {
         if (Fuel_HaveNatGas < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrNatGas",  "Dhw", "DhwBU" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[2]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-N - WtrHtOthr"     Proj:ResultSummary[2]:PrelimPropCompTDV  = {
         if (Fuel_HaveOther < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrOther",  "Dhw", "DhwBU" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[2]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea)
         endif endif  }
END
;*************************************************************************
RULELIST "CARes_PrelimPropResults_E" 1 0 1 1
;"debug"  Proj:Action = {  PostMessageToLog( "  evaluating 'CARes_PrelimPropResults_E':  RunAbbrev '%s'  RunNumber %g", RunAbbrev, RunNumber )  }
   ; SAC 1/5/18 - call rules to blast and re-create RunResults objects as part of mods to move StdMixedFuel run(s) to beginning of analysis sequence
   "Refresh RunResults objects-E"  Proj:Action  = {
         if (IfValidAnd( RunNumber < 3 )==0) then  UNCHANGED
         else  EvalRulelist( "CARes_Refresh_RunResults_E" )  endif  }

   ; SAC 12/30/17 - added battery elec use into total PrelimProp elec use used in scaling PV system
   "Store Electric use of prelim proposed run-E"    Proj:ResultSummary[3]:PrelimPropkWh  = {
         ( HourlyResultSum( RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) +     ; SpcHtg
           HourlyResultSum( RunID, "MtrElec",   "Clg", "FanC" ) +                ; SpcClg
           HourlyResultSum( RunID, "MtrElec",   "FanV" ) +                       ; IAQVent
           HourlyResultSum( RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2" ) +        ; WtrHtg
           HourlyResultSum( RunID, "MtrElec",   "Lit" ) +                        ; InsLtg
           HourlyResultSum( RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) +    ; ApplCook
           HourlyResultSum( RunID, "MtrElec",   "Rcp" ) +                        ; PlugLds
           HourlyResultSum( RunID, "MtrElec",   "Ext" ) +                        ; Exterior
           HourlyResultSum( RunID, "MtrElec",   "BT"  )  ) / 3.412  }            ; Battery
   "Store Electric use of prelim proposed run-E-2"    Proj:ResultSummary[3]:PrelimPropkWh  = {
         if (CSEinclDHWMFL_EU)
         then  ResultSummary[3]:PrelimPropkWh +
               ( HourlyResultSum( RunID, "MtrElec",   "DhwMFL" ) / 3.412 )     ; WtrHtg
         else  UNCHANGED  endif  }

   "Store PV Electric generation of prelim proposed run-E"    Proj:ResultSummary[3]:PrelimPropPV  =      ; SAC 7/16/20 (CommunitySolar)
      {  if (CommunitySolarProjID > 0 .AND. IfValidAnd( CmntySlr_ElecEnergy < 0 )) then  CmntySlr_ElecEnergy
         else  HourlyResultSum( RunID, "MtrElec",   "PV" )  / 3.412  endif  }
   "Store PV Electric generation TDV of prelim proposed run-E"    Proj:ResultSummary[3]:PrelimPropPVTDV  =        ; SAC 6/9/20 (CommunitySolar)    ; SAC 7/16/20 (CommunitySolar)
      {  if (IfValidAnd( ResultSummary[3]:PrelimPropPV < 0 )==0) then  UNDEFINED
         else if (CommunitySolarProjID > 0 .AND. IfValidAnd( CmntySlr_TDV < 0 )) then  CmntySlr_TDV / CondFloorArea
         else  int( (100 * ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV" ) / CondFloorArea) + 0.5) / 100
         endif endif  }

   "Calc PropInputPVMult-E - Scaling factor applied to user input PV capacity to prevent exceeding max PV generation"      ; wrap Proj:AllowExcessPVEDR in IfValidAnd - SAC 04/09/22
      Proj:ResultSummary[3]:PropInputPVMult  = {
         if (IfValidAnd( Proj:AllowExcessPVEDR > 0 ) .OR. IfValidAnd( Proj:PVWDCSysTotal > 0 )==0 .OR.
             IfValidAnd( Proj:MaxPropPVRatio > 0 )==0 .OR.
             IfValidAnd( ResultSummary[3]:PrelimPropPV < 0 )==0) then  UNDEFINED
         else  ResultSummary[3]:PrelimPropkWh * Proj:MaxPropPVRatio / (-1 * ResultSummary[3]:PrelimPropPV)
         endif  }
;"dbg" Proj:Action = { MessageBox( "Just set ResultSummary[3]:PropInputPVMult to %g\n\n   Proj:AllowExcessPVEDR = %g\n\n   Proj:PVWDCSysTotal = %g\n\n   Proj:MaxPropPVRatio = %g\n\n   ResultSummary[3]:PrelimPropPV = %g\n\n   ResultSummary[3]:PrelimPropkWh = %g",
;                        ValidOr( ResultSummary[3]:PropInputPVMult, -999 ), ValidOr( AllowExcessPVEDR, -999 ), ValidOr( PVWDCSysTotal, -999 ), ValidOr( MaxPropPVRatio, -999 ), ValidOr( ResultSummary[3]:PrelimPropPV, -999 ), ValidOr( ResultSummary[3]:PrelimPropkWh, -999 ) )  }

         ; SAC 8/24/19 - replaced 1/3.413 & 0.01 TDV table multipliers with Proj:TDVSecMult_Elec & TDVSecMult_Fuel to accommodate 2022+ switch to native (E3) TDV table units
         ; SAC 8/26/19 - added primary table multipliers (of 1.0) to all ApplyHourlyResultMult* function calls (to accommodate 2022+ TDV table unit switch)
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-E - HtgElec"       Proj:ResultSummary[3]:PrelimPropCompTDV  = {
         if (Fuel_HaveElec < 0.5 .OR. CondFloorArea < 1) then  0
         else if (HourlyResultSum( RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) < 0.0001) then  0
         else  ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / CondFloorArea
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-E - HtgNGas"       Proj:ResultSummary[3]:PrelimPropCompTDV  = {
         if (Fuel_HaveNatGas < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrNatGas", "Htg", "HPBU", "Aux" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[3]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Htg", "HPBU", "Aux"                ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-E - HtgOthr"       Proj:ResultSummary[3]:PrelimPropCompTDV  = {
         if (Fuel_HaveOther < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrOther",  "Htg", "HPBU",  "Aux" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[3]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Htg", "HPBU", "Aux"                ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-E - ClgElec"       Proj:ResultSummary[3]:PrelimPropCompTDV  = {
         if (Fuel_HaveElec < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrElec",  "Clg", "FanC" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[3]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-E - ClgNGas"       Proj:ResultSummary[3]:PrelimPropCompTDV  = {
         if (Fuel_HaveNatGas < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrNatGas",  "Clg" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[3]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Clg" ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-E - ClgOthr"       Proj:ResultSummary[3]:PrelimPropCompTDV  = {
         if (Fuel_HaveOther < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrOther",  "Clg" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[3]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Clg" ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-E - IAQVentElec"   Proj:ResultSummary[3]:PrelimPropCompTDV  = {
         if (Fuel_HaveElec < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrElec",  "FanV" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[3]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "FanV" ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-E - WtrHtElec"     Proj:ResultSummary[3]:PrelimPropCompTDV  = {
         if (Fuel_HaveElec < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (CSEinclDHWMFL_EU)
			then  if (HourlyResultSum( RunID, "MtrElec",  "Dhw", "DhwBU", "DHWPmp", "DhwMFL", "User2" ) < 0.0001) then  UNCHANGED
               else  ResultSummary[3]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "DhwMFL", "User2" ) / CondFloorArea)
               endif
         else if (HourlyResultSum( RunID, "MtrElec",  "Dhw", "DhwBU", "DHWPmp", "User2" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[3]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2" ) / CondFloorArea)
         endif endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-E - WtrHtNGas"     Proj:ResultSummary[3]:PrelimPropCompTDV  = {
         if (Fuel_HaveNatGas < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrNatGas",  "Dhw", "DhwBU" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[3]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-E - WtrHtOthr"     Proj:ResultSummary[3]:PrelimPropCompTDV  = {
         if (Fuel_HaveOther < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrOther",  "Dhw", "DhwBU" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[3]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea)
         endif endif  }
END
;*************************************************************************
RULELIST "CARes_PrelimPropResults_S" 1 0 1 1
;"debug"  Proj:Action = {  PostMessageToLog( "  evaluating 'CARes_PrelimPropResults_S':  RunAbbrev '%s'  RunNumber %g", RunAbbrev, RunNumber )  }
   ; SAC 1/5/18 - call rules to blast and re-create RunResults objects as part of mods to move StdMixedFuel run(s) to beginning of analysis sequence
   "Refresh RunResults objects-S"  Proj:Action  = {
         if (IfValidAnd( RunNumber < 4 )==0) then  UNCHANGED
         else  EvalRulelist( "CARes_Refresh_RunResults_S" )  endif  }

   ; SAC 12/30/17 - added battery elec use into total PrelimProp elec use used in scaling PV system
   "Store Electric use of prelim proposed run-S"    Proj:ResultSummary[4]:PrelimPropkWh  = {
         ( HourlyResultSum( RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) +     ; SpcHtg
           HourlyResultSum( RunID, "MtrElec",   "Clg", "FanC" ) +                ; SpcClg
           HourlyResultSum( RunID, "MtrElec",   "FanV" ) +                       ; IAQVent
           HourlyResultSum( RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2" ) +        ; WtrHtg
           HourlyResultSum( RunID, "MtrElec",   "Lit" ) +                        ; InsLtg
           HourlyResultSum( RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) +    ; ApplCook
           HourlyResultSum( RunID, "MtrElec",   "Rcp" ) +                        ; PlugLds
           HourlyResultSum( RunID, "MtrElec",   "Ext" ) +                        ; Exterior
           HourlyResultSum( RunID, "MtrElec",   "BT"  )  ) / 3.412  }            ; Battery
   "Store Electric use of prelim proposed run-S-2"    Proj:ResultSummary[4]:PrelimPropkWh  = {
         if (CSEinclDHWMFL_EU)
         then  ResultSummary[4]:PrelimPropkWh +
               ( HourlyResultSum( RunID, "MtrElec",   "DhwMFL" ) / 3.412 )     ; WtrHtg
         else  UNCHANGED  endif  }

   "Store PV Electric generation of prelim proposed run-S"    Proj:ResultSummary[4]:PrelimPropPV  =      ; SAC 7/16/20 (CommunitySolar)
      {  if (CommunitySolarProjID > 0 .AND. IfValidAnd( CmntySlr_ElecEnergy < 0 )) then  CmntySlr_ElecEnergy
         else  HourlyResultSum( RunID, "MtrElec",   "PV" )  / 3.412  endif  }
   "Store PV Electric generation TDV of prelim proposed run-S"    Proj:ResultSummary[4]:PrelimPropPVTDV  =        ; SAC 6/9/20 (CommunitySolar)    ; SAC 7/16/20 (CommunitySolar)
      {  if (IfValidAnd( ResultSummary[4]:PrelimPropPV < 0 )==0) then  UNDEFINED
         else if (CommunitySolarProjID > 0 .AND. IfValidAnd( CmntySlr_TDV < 0 )) then  CmntySlr_TDV / CondFloorArea
         else  int( (100 * ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV" ) / CondFloorArea) + 0.5) / 100
         endif endif  }

   "Calc PropInputPVMult-S - Scaling factor applied to user input PV capacity to prevent exceeding max PV generation"      ; wrap Proj:AllowExcessPVEDR in IfValidAnd - SAC 04/09/22
      Proj:ResultSummary[4]:PropInputPVMult  = {
         if (IfValidAnd( Proj:AllowExcessPVEDR > 0 ) .OR. IfValidAnd( Proj:PVWDCSysTotal > 0 )==0 .OR.
             IfValidAnd( Proj:MaxPropPVRatio > 0 )==0 .OR.
             IfValidAnd( ResultSummary[4]:PrelimPropPV < 0 )==0) then  UNDEFINED
         else  ResultSummary[4]:PrelimPropkWh * Proj:MaxPropPVRatio / (-1 * ResultSummary[4]:PrelimPropPV)
         endif  }
;"dbg" Proj:Action = { MessageBox( "Just set ResultSummary[4]:PropInputPVMult to %g\n\n   Proj:AllowExcessPVEDR = %g\n\n   Proj:PVWDCSysTotal = %g\n\n   Proj:MaxPropPVRatio = %g\n\n   ResultSummary[4]:PrelimPropPV = %g\n\n   ResultSummary[4]:PrelimPropkWh = %g",
;                        ValidOr( ResultSummary[4]:PropInputPVMult, -999 ), ValidOr( AllowExcessPVEDR, -999 ), ValidOr( PVWDCSysTotal, -999 ), ValidOr( MaxPropPVRatio, -999 ), ValidOr( ResultSummary[4]:PrelimPropPV, -999 ), ValidOr( ResultSummary[4]:PrelimPropkWh, -999 ) )  }

         ; SAC 8/24/19 - replaced 1/3.413 & 0.01 TDV table multipliers with Proj:TDVSecMult_Elec & TDVSecMult_Fuel to accommodate 2022+ switch to native (E3) TDV table units
         ; SAC 8/26/19 - added primary table multipliers (of 1.0) to all ApplyHourlyResultMult* function calls (to accommodate 2022+ TDV table unit switch)
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-S - HtgElec"       Proj:ResultSummary[4]:PrelimPropCompTDV  = {
         if (Fuel_HaveElec < 0.5 .OR. CondFloorArea < 1) then  0
         else if (HourlyResultSum( RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) < 0.0001) then  0
         else  ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / CondFloorArea
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-S - HtgNGas"       Proj:ResultSummary[4]:PrelimPropCompTDV  = {
         if (Fuel_HaveNatGas < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrNatGas", "Htg", "HPBU", "Aux" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[4]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Htg", "HPBU", "Aux"                ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-S - HtgOthr"       Proj:ResultSummary[4]:PrelimPropCompTDV  = {
         if (Fuel_HaveOther < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrOther",  "Htg", "HPBU",  "Aux" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[4]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Htg", "HPBU", "Aux"                ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-S - ClgElec"       Proj:ResultSummary[4]:PrelimPropCompTDV  = {
         if (Fuel_HaveElec < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrElec",  "Clg", "FanC" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[4]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-S - ClgNGas"       Proj:ResultSummary[4]:PrelimPropCompTDV  = {
         if (Fuel_HaveNatGas < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrNatGas",  "Clg" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[4]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Clg" ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-S - ClgOthr"       Proj:ResultSummary[4]:PrelimPropCompTDV  = {
         if (Fuel_HaveOther < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrOther",  "Clg" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[4]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Clg" ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-S - IAQVentElec"   Proj:ResultSummary[4]:PrelimPropCompTDV  = {
         if (Fuel_HaveElec < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrElec",  "FanV" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[4]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "FanV" ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-S - WtrHtElec"     Proj:ResultSummary[4]:PrelimPropCompTDV  = {
         if (Fuel_HaveElec < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (CSEinclDHWMFL_EU)
			then  if (HourlyResultSum( RunID, "MtrElec",  "Dhw", "DhwBU", "DHWPmp", "DhwMFL", "User2" ) < 0.0001) then  UNCHANGED
               else  ResultSummary[4]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "DhwMFL", "User2" ) / CondFloorArea)
               endif
         else if (HourlyResultSum( RunID, "MtrElec",  "Dhw", "DhwBU", "DHWPmp", "User2" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[4]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2" ) / CondFloorArea)
         endif endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-S - WtrHtNGas"     Proj:ResultSummary[4]:PrelimPropCompTDV  = {
         if (Fuel_HaveNatGas < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrNatGas",  "Dhw", "DhwBU" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[4]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-S - WtrHtOthr"     Proj:ResultSummary[4]:PrelimPropCompTDV  = {
         if (Fuel_HaveOther < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrOther",  "Dhw", "DhwBU" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[4]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea)
         endif endif  }
END
;*************************************************************************
RULELIST "CARes_PrelimPropResults_W" 1 0 1 1
;"debug"  Proj:Action = {  PostMessageToLog( "  evaluating 'CARes_PrelimPropResults_W':  RunAbbrev '%s'  RunNumber %g", RunAbbrev, RunNumber )  }
   ; SAC 1/5/18 - call rules to blast and re-create RunResults objects as part of mods to move StdMixedFuel run(s) to beginning of analysis sequence
   "Refresh RunResults objects-W"  Proj:Action  = {
         if (IfValidAnd( RunNumber < 5 )==0) then  UNCHANGED
         else  EvalRulelist( "CARes_Refresh_RunResults_W" )  endif  }

   ; SAC 12/30/17 - added battery elec use into total PrelimProp elec use used in scaling PV system
   "Store Electric use of prelim proposed run-W"    Proj:ResultSummary[5]:PrelimPropkWh  = {
         ( HourlyResultSum( RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) +     ; SpcHtg
           HourlyResultSum( RunID, "MtrElec",   "Clg", "FanC" ) +                ; SpcClg
           HourlyResultSum( RunID, "MtrElec",   "FanV" ) +                       ; IAQVent
           HourlyResultSum( RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2" ) +        ; WtrHtg
           HourlyResultSum( RunID, "MtrElec",   "Lit" ) +                        ; InsLtg
           HourlyResultSum( RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) +    ; ApplCook
           HourlyResultSum( RunID, "MtrElec",   "Rcp" ) +                        ; PlugLds
           HourlyResultSum( RunID, "MtrElec",   "Ext" ) +                        ; Exterior
           HourlyResultSum( RunID, "MtrElec",   "BT"  )  ) / 3.412  }            ; Battery
   "Store Electric use of prelim proposed run-W-2"    Proj:ResultSummary[5]:PrelimPropkWh  = {
         if (CSEinclDHWMFL_EU)
         then  ResultSummary[5]:PrelimPropkWh +
               ( HourlyResultSum( RunID, "MtrElec",   "DhwMFL" ) / 3.412 )     ; WtrHtg
         else  UNCHANGED  endif  }

   "Store PV Electric generation of prelim proposed run-W"    Proj:ResultSummary[5]:PrelimPropPV  =      ; SAC 7/16/20 (CommunitySolar)
      {  if (CommunitySolarProjID > 0 .AND. IfValidAnd( CmntySlr_ElecEnergy < 0 )) then  CmntySlr_ElecEnergy
         else  HourlyResultSum( RunID, "MtrElec",   "PV" )  / 3.412  endif  }
   "Store PV Electric generation TDV of prelim proposed run-W"    Proj:ResultSummary[5]:PrelimPropPVTDV  =        ; SAC 6/9/20 (CommunitySolar)    ; SAC 7/16/20 (CommunitySolar)
      {  if (IfValidAnd( ResultSummary[5]:PrelimPropPV < 0 )==0) then  UNDEFINED
         else if (CommunitySolarProjID > 0 .AND. IfValidAnd( CmntySlr_TDV < 0 )) then  CmntySlr_TDV / CondFloorArea
         else  int( (100 * ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV" ) / CondFloorArea) + 0.5) / 100
         endif endif  }

   "Calc PropInputPVMult-W - Scaling factor applied to user input PV capacity to prevent exceeding max PV generation"      ; wrap Proj:AllowExcessPVEDR in IfValidAnd - SAC 04/09/22
      Proj:ResultSummary[5]:PropInputPVMult  = {
         if (IfValidAnd( Proj:AllowExcessPVEDR > 0 ) .OR. IfValidAnd( Proj:PVWDCSysTotal > 0 )==0 .OR.
             IfValidAnd( Proj:MaxPropPVRatio > 0 )==0 .OR.
             IfValidAnd( ResultSummary[5]:PrelimPropPV < 0 )==0) then  UNDEFINED
         else  ResultSummary[5]:PrelimPropkWh * Proj:MaxPropPVRatio / (-1 * ResultSummary[5]:PrelimPropPV)
         endif  }
;"dbg" Proj:Action = { MessageBox( "Just set ResultSummary[5]:PropInputPVMult to %g\n\n   Proj:AllowExcessPVEDR = %g\n\n   Proj:PVWDCSysTotal = %g\n\n   Proj:MaxPropPVRatio = %g\n\n   ResultSummary[5]:PrelimPropPV = %g\n\n   ResultSummary[5]:PrelimPropkWh = %g",
;                        ValidOr( ResultSummary[5]:PropInputPVMult, -999 ), ValidOr( AllowExcessPVEDR, -999 ), ValidOr( PVWDCSysTotal, -999 ), ValidOr( MaxPropPVRatio, -999 ), ValidOr( ResultSummary[5]:PrelimPropPV, -999 ), ValidOr( ResultSummary[5]:PrelimPropkWh, -999 ) )  }

         ; SAC 8/24/19 - replaced 1/3.413 & 0.01 TDV table multipliers with Proj:TDVSecMult_Elec & TDVSecMult_Fuel to accommodate 2022+ switch to native (E3) TDV table units
         ; SAC 8/26/19 - added primary table multipliers (of 1.0) to all ApplyHourlyResultMult* function calls (to accommodate 2022+ TDV table unit switch)
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-W - HtgElec"       Proj:ResultSummary[5]:PrelimPropCompTDV  = {
         if (Fuel_HaveElec < 0.5 .OR. CondFloorArea < 1) then  0
         else if (HourlyResultSum( RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) < 0.0001) then  0
         else  ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / CondFloorArea
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-W - HtgNGas"       Proj:ResultSummary[5]:PrelimPropCompTDV  = {
         if (Fuel_HaveNatGas < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrNatGas", "Htg", "HPBU", "Aux" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[5]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Htg", "HPBU", "Aux"                ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-W - HtgOthr"       Proj:ResultSummary[5]:PrelimPropCompTDV  = {
         if (Fuel_HaveOther < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrOther",  "Htg", "HPBU",  "Aux" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[5]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Htg", "HPBU", "Aux"                ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-W - ClgElec"       Proj:ResultSummary[5]:PrelimPropCompTDV  = {
         if (Fuel_HaveElec < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrElec",  "Clg", "FanC" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[5]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-W - ClgNGas"       Proj:ResultSummary[5]:PrelimPropCompTDV  = {
         if (Fuel_HaveNatGas < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrNatGas",  "Clg" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[5]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Clg" ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-W - ClgOthr"       Proj:ResultSummary[5]:PrelimPropCompTDV  = {
         if (Fuel_HaveOther < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrOther",  "Clg" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[5]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Clg" ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-W - IAQVentElec"   Proj:ResultSummary[5]:PrelimPropCompTDV  = {
         if (Fuel_HaveElec < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrElec",  "FanV" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[5]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "FanV" ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-W - WtrHtElec"     Proj:ResultSummary[5]:PrelimPropCompTDV  = {
         if (Fuel_HaveElec < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (CSEinclDHWMFL_EU)
			then  if (HourlyResultSum( RunID, "MtrElec",  "Dhw", "DhwBU", "DHWPmp", "DhwMFL", "User2" ) < 0.0001) then  UNCHANGED
               else  ResultSummary[5]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "DhwMFL", "User2" ) / CondFloorArea)
               endif
         else if (HourlyResultSum( RunID, "MtrElec",  "Dhw", "DhwBU", "DHWPmp", "User2" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[5]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2" ) / CondFloorArea)
         endif endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-W - WtrHtNGas"     Proj:ResultSummary[5]:PrelimPropCompTDV  = {
         if (Fuel_HaveNatGas < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrNatGas",  "Dhw", "DhwBU" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[5]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea)
         endif endif  }
   "Calc & store Compliance TDV (minus PV&Batt) of prelim proposed run-W - WtrHtOthr"     Proj:ResultSummary[5]:PrelimPropCompTDV  = {
         if (Fuel_HaveOther < 0.5 .OR. CondFloorArea < 1) then  UNCHANGED
         else if (HourlyResultSum( RunID, "MtrOther",  "Dhw", "DhwBU" ) < 0.0001) then  UNCHANGED
         else  ResultSummary[5]:PrelimPropCompTDV + (ApplyHourlyResultMultipliers( "none", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea)
         endif endif  }
END
;*************************************************************************


;*************************************************************************  - SAC 12/29/17
RULELIST "ApplyPrelimRunResults" 1 0 0 1
	"Apply Prelim run results to Proposed inputs"	Proj:Action = {
         switch (RunAbbrev)
				case  "p"   :  EvalRulelist( "CARes_PrelimPropPVScaling" )
				case  "p-N" :  EvalRulelist( "CARes_PrelimPropPVScaling_N" )
				case  "p-E" :  EvalRulelist( "CARes_PrelimPropPVScaling_E" )
				case  "p-S" :  EvalRulelist( "CARes_PrelimPropPVScaling_S" )
				case  "p-W" :  EvalRulelist( "CARes_PrelimPropPVScaling_W" )
				default		 :  UNCHANGED
			endswitch  }
END
;*************************************************************************  - SAC 12/29/17
RULELIST "CARes_PrelimPropPVScaling" 1 0 0 1
   "Set Proj:PVWDCSizeMultiplier[1] if PV input scaling necessary"
      Proj:PVWDCSizeMultiplier[1]  = {
         if (IfValidAnd( ResultSummary[1]:PropInputPVMult < 1.0 )==0) then  UNCHANGED
         else  ResultSummary[1]:PropInputPVMult  endif  }
;"dbg" Proj:Action = { MessageBox( "Just set Proj:PVWDCSizeMultiplier[1] to %g\n   ResultSummary[1]:PropInputPVMult = %g",
;                        ValidOr( PVWDCSizeMultiplier[1], -999 ), ValidOr( ResultSummary[1]:PropInputPVMult, -999 ) )  }
END
;*************************************************************************
RULELIST "CARes_PrelimPropPVScaling_N" 1 0 0 1
   "Set Proj:PVWDCSizeMultiplier[1] if PV input scaling necessary"
      Proj:PVWDCSizeMultiplier[1]  = {
         if (IfValidAnd( ResultSummary[2]:PropInputPVMult < 1.0 )==0) then  UNCHANGED
         else  ResultSummary[2]:PropInputPVMult  endif  }
END
;*************************************************************************
RULELIST "CARes_PrelimPropPVScaling_E" 1 0 0 1
   "Set Proj:PVWDCSizeMultiplier[1] if PV input scaling necessary"
      Proj:PVWDCSizeMultiplier[1]  = {
         if (IfValidAnd( ResultSummary[3]:PropInputPVMult < 1.0 )==0) then  UNCHANGED
         else  ResultSummary[3]:PropInputPVMult  endif  }
END
;*************************************************************************
RULELIST "CARes_PrelimPropPVScaling_S" 1 0 0 1
   "Set Proj:PVWDCSizeMultiplier[1] if PV input scaling necessary"
      Proj:PVWDCSizeMultiplier[1]  = {
         if (IfValidAnd( ResultSummary[4]:PropInputPVMult < 1.0 )==0) then  UNCHANGED
         else  ResultSummary[4]:PropInputPVMult  endif  }
END
;*************************************************************************
RULELIST "CARes_PrelimPropPVScaling_W" 1 0 0 1
   "Set Proj:PVWDCSizeMultiplier[1] if PV input scaling necessary"
      Proj:PVWDCSizeMultiplier[1]  = {
         if (IfValidAnd( ResultSummary[5]:PropInputPVMult < 1.0 )==0) then  UNCHANGED
         else  ResultSummary[5]:PropInputPVMult  endif  }
END
;*************************************************************************


;************************************************************************* SAC 08/08/23 (2025)
RULELIST "CARes_ProposedPeakCoolElec" 1 0 1 1
   "Calculate & set PropPeakCoolElec"     Proj:ResultSummary[1]:PropPeakCoolElec =
      {	ApplyHourlyResultMultipliers( "none", "PeakCoolingElecEnergyTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Clg", "FanC" ) / 3.412  }
END
      ;      		case  "p-N"	:  EvalRulelist( "CARes_ProposedPeakCoolElec_N" )
      ;      		case  "p-E"	:  EvalRulelist( "CARes_ProposedPeakCoolElec_E" )
      ;      		case  "p-S"	:  EvalRulelist( "CARes_ProposedPeakCoolElec_S" )
      ;      		case  "p-W"	:  EvalRulelist( "CARes_ProposedPeakCoolElec_W" )
;************************************************************************* SAC 08/08/23 (2025)
RULELIST "CARes_StandardPeakCoolElec" 1 0 1 1
   "Calculate & set StdPeakCoolElec"      Proj:ResultSummary[1]:StdPeakCoolElec =
      {	ApplyHourlyResultMultipliers( "none", "PeakCoolingElecEnergyTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Clg", "FanC" ) / 3.412  }

   "Set StdPeakCoolElecLimit"    Proj:ResultSummary[1]:StdPeakCoolElecLimit =       ; mods for StdPeakCoolElecLimitMult = 0 - SAC 08/14/23
      {  if (IfValidAnd( Proj:StdPeakCoolElecLimitMult = 0.0 )) then  ResultSummary[1]:StdPeakCoolElec
         else  ResultSummary[1]:StdPeakCoolElec * ValidOr( Proj:StdPeakCoolElecLimitMult, 1.2 )  endif  }

   "Set PeakCoolElecMargin"      Proj:ResultSummary[1]:PeakCoolElecMargin =
      {  if (IfValidAnd( Proj:StdPeakCoolElecLimitMult = 0.0 )) then  0
         else  int( ResultSummary[1]:StdPeakCoolElecLimit + 0.5 ) - int( ResultSummary[1]:PropPeakCoolElec + 0.5 )  endif  }

   "set PeakCoolElecLabels[1] - prop"     Proj:ResultSummary[1]:PeakCoolElecLabels[1] =
      {  FltToStr( int( ResultSummary[1]:PropPeakCoolElec     + 0.5 ) )  }
   "set PeakCoolElecLabels[2] - std"      Proj:ResultSummary[1]:PeakCoolElecLabels[2] =
      {  FltToStr( int( ResultSummary[1]:StdPeakCoolElecLimit + 0.5 ) )  }
   "set PeakCoolElecLabels[3] - margin"   Proj:ResultSummary[1]:PeakCoolElecLabels[3] =
      {  if (IfValidAnd( Proj:StdPeakCoolElecLimitMult = 0.0 )) then  UNDEFINED
         else  FltToStr(      ResultSummary[1]:PeakCoolElecMargin           )  endif  }
   "set PeakCoolElecLabels[4] - result"   Proj:ResultSummary[1]:PeakCoolElecLabels[4] =
      {  if (IfValidAnd( Proj:StdPeakCoolElecLimitMult = 0.0 )) then  "n/a"
         else if (IfValidAnd( ResultSummary[1]:PeakCoolElecMargin >= 0 )) then  "Pass"  else  "Fail"  endif endif  }
END
      ;      							else	EvalRulelist( "CARes_StandardPeakCoolElec_NESW" )  endif
;*************************************************************************


;*************************************************************************
RULELIST "CARes_DesignRating_2019GHC" 1 0 1 1
;*************************************************************************
   ; SAC 12/28/17 - 2019 GHC (grid harmonization credit) 
 	"Set ResultSummary[1]:GHCEnergyEffCap - Max Battery TDV that can be applied to Energy Efficiency DsgnRtg in the form of GHC" 
      Proj:ResultSummary[1]:GHCEnergyEffCap  = {
         if (EnergyCodeYearNum < 2019) then  UNDEFINED
         else if (IfValidAnd( BattGridHarmCredit > 0 )==0) then  0
         else  ValidOr( RunResults[11]:StandardTDV, 0 ) *
               T24RClimateZoneCodeBase:GridHarmCredPk( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr )
         endif endif  }
 	"Set ResultSummary[1]:GHCEnergyEffTDV - Battery TDV applied to Energy Efficiency DsgnRtg in the form of GHC" 
      Proj:ResultSummary[1]:GHCEnergyEffTDV  = {
         if (EnergyCodeYearNum < 2019 .OR.
             LocalStatus( ResultSummary[1]:GHCEnergyEffCap ) < 1) then  UNDEFINED
         else if ( (EnergyCodeYearNum <  2025 .AND. IfValidAnd( RunResults[14]:ProposedTDV[3] >= 0 )) .OR.
                   (EnergyCodeYearNum >= 2025 .AND. IfValidAnd( RunResults[14]:ProposedTDV[1] >= 0 )) ) then  0
         else if (EnergyCodeYearNum <  2025)
         then  min( ResultSummary[1]:GHCEnergyEffCap, (-1 * RunResults[14]:ProposedTDV[3]) )
         else  min( ResultSummary[1]:GHCEnergyEffCap, (-1 * RunResults[14]:ProposedTDV[1]) )
         endif endif endif  }
 	"Set ResultSummary[1]:GHCEnergyEffBattFrac - Fraction of Battery TDV applied to Energy Efficiency DsgnRtg in the form of GHC" 
      Proj:ResultSummary[1]:GHCEnergyEffBattFrac  = {
         if (EnergyCodeYearNum < 2019 .OR.
             LocalStatus( ResultSummary[1]:GHCEnergyEffCap ) < 1) then  UNDEFINED
         else if ( (EnergyCodeYearNum <  2025 .AND. IfValidAnd( RunResults[14]:ProposedTDV[3] >= 0 )) .OR.
                   (EnergyCodeYearNum >= 2025 .AND. IfValidAnd( RunResults[14]:ProposedTDV[1] >= 0 )) ) then  0
         else if (EnergyCodeYearNum <  2025)
         then  ResultSummary[1]:GHCEnergyEffTDV / (-1 * RunResults[14]:ProposedTDV[3])
         else  ResultSummary[1]:GHCEnergyEffTDV / (-1 * RunResults[14]:ProposedTDV[1])
         endif endif endif  }
 	"Set ResultSummary[1]:GHCEnergyEffElec - Battery elec use applied to Energy Efficiency DsgnRtg in the form of GHC" 
      Proj:ResultSummary[1]:GHCEnergyEffElec  =  {
         if (EnergyCodeYearNum < 2019 .OR.
             LocalStatus( ResultSummary[1]:GHCEnergyEffTDV ) < 1) then  UNDEFINED
         else if (ResultSummary[1]:GHCEnergyEffTDV <= 0) then  0
         else  (RunResults[14]:PropElecEnergy * Proj:CondFloorArea / 3.413) *
               ResultSummary[1]:GHCEnergyEffBattFrac
         endif endif  }
 	"Set ResultSummary[1]:GHCEnergyEffCO2 - Battery CO2 emissions applied to Energy Efficiency DsgnRtg in the form of GHC"   ; SAC 1/27/18 
      Proj:ResultSummary[1]:GHCEnergyEffCO2  =  {
         if (EnergyCodeYearNum < 2019 .OR.
             LocalStatus( ResultSummary[1]:GHCEnergyEffBattFrac ) < 1) then  UNDEFINED
         else if (ResultSummary[1]:GHCEnergyEffBattFrac <= 0) then  0
         else  ValidOr( RunResults[14]:PropTotalCarbon, 0 ) * ResultSummary[1]:GHCEnergyEffBattFrac
         endif endif  }

   "Set ResultSummary[1]:StdDHWNoSlrSysTDVpSF"     Proj:ResultSummary[1]:StdDHWNoSlrSysTDVpSF =
      {  if (IfValidAnd( ResultSummary[1]:StdDHWNoSlrSysTotTDV > 0 )==0) then  UNDEFINED
         else  ResultSummary[1]:StdDHWNoSlrSysTotTDV / Proj:CondFloorArea  endif  }
 	"Set ResultSummary[1]:DHWSlrPVCreditFrac - frac of PV TDV to be applied to Energy Efficiency DsgnRtg in the form of SelfUtil/Flex credit"    ; SAC 5/5/20 (FlexibilityCredit) 
      Proj:ResultSummary[1]:DHWSlrPVCreditFrac  =
      {  if (IfValidAnd( RunResults[13]:ProposedTDV[1] < 0 ) .AND.
             IfValidAnd( ResultSummary[1]:StdDHWNoSlrSysTDVpSF > RunResults[5]:StandardTDV ))
         then  if (  (ResultSummary[1]:StdDHWNoSlrSysTDVpSF - RunResults[5]:StandardTDV) >= (-1 * RunResults[13]:ProposedTDV[1])) then  1.0
               else  (ResultSummary[1]:StdDHWNoSlrSysTDVpSF - RunResults[5]:StandardTDV) /  (-1 * RunResults[13]:ProposedTDV[1])
               endif
         else  UNDEFINED  endif  }
         ; RunResults[13]:ProposedTDV[1] - Proposed TDV - 3 values, Comp, DRtg, and DRtg w/ Fuel Mult applied
 	"Set ResultSummary[1]:DHWSlrPVCreditTDV - PV TDV to be applied to Energy Efficiency DsgnRtg in the form of SelfUtil/Flex credit" 
      Proj:ResultSummary[1]:DHWSlrPVCreditTDV  =
      {  if (IfValidAnd( ResultSummary[1]:DHWSlrPVCreditFrac > 0 )==0) then  UNDEFINED
         else  ResultSummary[1]:DHWSlrPVCreditFrac * RunResults[13]:ProposedTDV[1] * -1  endif  }
 	"Set ResultSummary[1]:DHWSlrPVCreditElec - PV electric use/generation to be applied to Energy Efficiency DsgnRtg in the form of SelfUtil/Flex credit" 
      Proj:ResultSummary[1]:DHWSlrPVCreditElec  =
      {  if (IfValidAnd( ResultSummary[1]:DHWSlrPVCreditFrac > 0 )==0) then  UNDEFINED
         else  ResultSummary[1]:DHWSlrPVCreditFrac * (RunResults[13]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413)  endif  }
         ; RunResults[13]:PropElecEnergy[1] - Proposed Electric energy use - 2 runs, Comp & DRtg
 	"Set ResultSummary[1]:DHWSlrPVCreditCO2 - PV CO2 emissions (credits) to be applied to Energy Efficiency DsgnRtg in the form of SelfUtil/Flex credit" 
      Proj:ResultSummary[1]:DHWSlrPVCreditCO2  =
      {  if (IfValidAnd( ResultSummary[1]:DHWSlrPVCreditFrac > 0 )==0) then  UNDEFINED
         else  ResultSummary[1]:DHWSlrPVCreditFrac * ValidOr( RunResults[13]:PropTotalCarbon[1], 0 )  endif  }
END

;*************************************************************************
RULELIST "CARes_DesignRating_2019Standard" 1 0 1 1
;*************************************************************************
   ; 2019 rules to calculate Standard Design EDR taking into account Required Minimum PV
   ; DesignRatingStd already populated w/ rating excluding PV & Batt - so strat by copying that into the new DesignRatingStdNoPV property
   ; SAC 7/19/17 - added rounding of all design rating results to 0.1 (tic #864)
   ; SAC 1/11/18 - revised rules to remove PV/BT to set DesignRatingStdNoPV rather than adding PV/BT to DesignRatingStd (which is already done)
   ; modified for 2022 to use (non-fuel adjusted) Compliance, not Total TDV in calc of design rating - SAC 02/06/21
 	"Set ResultSummary[1]:DesignRatingStdNoPV"		Proj:ResultSummary[1]:DesignRatingStdNoPV		=
      {  if (EnergyCodeYearNum >= 2022)
         then  if (IfValidAnd( RunResults[11]:DesignRatingTDV[1] != 0 )==0 .OR. AnalysisType < 3) then  UNDEFINED
			      else	int( ((	RunResults[1]:StdElecTDV[1] + RunResults[1]:StdNatGasTDV + RunResults[1]:StdOtherTDV    ; SpcHt
      	      				 +	RunResults[2]:StdElecTDV[1] + RunResults[2]:StdNatGasTDV + RunResults[2]:StdOtherTDV    ; SpcCl
      	      				 +	RunResults[3]:StdElecTDV[1]    ; IAQVent
		            			 +	RunResults[4]:StandardTDV[1]   ; OthrHVAC
      	      				 +	RunResults[5]:StdElecTDV[1] + RunResults[5]:StdNatGasTDV + RunResults[5]:StdOtherTDV )  ; WtrHt
			      	      			* 1000 / RunResults[11]:DesignRatingTDV[1])+0.5 )/10
               endif
         else  if (IfValidAnd( RunResults[10]:DesignRatingTDV[2] != 0 )==0 .OR. AnalysisType < 3) then  UNDEFINED
			      else	int( ((	RunResults[1]:StdElecTDV[1] + RunResults[1]:StdNatGasTDV + RunResults[1]:StdOtherTDV    ; SpcHt
      	      				 +	RunResults[2]:StdElecTDV[1] + RunResults[2]:StdNatGasTDV + RunResults[2]:StdOtherTDV    ; SpcCl
      	      				 +	RunResults[3]:StdElecTDV[1]    ; IAQVent
		            			 +	RunResults[4]:StandardTDV[1]   ; OthrHVAC
      	      				 +	RunResults[5]:StdElecTDV[1] + RunResults[5]:StdNatGasTDV + RunResults[5]:StdOtherTDV    ; WtrHt
		            			 +	RunResults[6]:StandardTDV[1]   ; InsLtg
      	      				 +	RunResults[7]:StdElecTDV[1] + RunResults[7]:StdNatGasTDV + RunResults[7]:StdOtherTDV    ; AppCkg
		            			 +	RunResults[8]:StandardTDV[1]   ; Plugs
			      	      	 +	RunResults[9]:StandardTDV[1] ) ; Ext
			      	      			* 1000 / RunResults[10]:DesignRatingTDV[2])+0.5 )/10
               endif  endif  }
;"dbg" Proj:Action = { PostMessageToLog( "   Just set ResultSummary[1]:DesignRatingStd = %g  based on RunResults[10]:DesignRatingTDV[2] = %g  and ResultSummary[1]:StdMixedFuelPVTDV = %g",
;                           ValidOr( ResultSummary[1]:DesignRatingStd, -999 ), ValidOr( RunResults[10]:DesignRatingTDV[2], -999 ), ValidOr( ResultSummary[1]:StdMixedFuelPVTDV, -999 ) )  }
   ; and finally calculate DesignRatingStdPVOnly based on difference between DesignRatingStdNoPV and DesignRatingStd
   ; SAC 6/6/17 - flipped sign of PV-only EDR value prior to release of 2019.0.4
   ; revised DesignRatingPVOnly calc for 2022 to include only PV, Battery & Flexibility (below line) - SAC 02/09/21
   "Set ResultSummary[1]:DesignRatingStdPVOnly"    Proj:ResultSummary[1]:DesignRatingStdPVOnly  = {
         if (LocalStatus( ResultSummary[1]:DesignRatingStdNoPV ) < 1 .OR. LocalStatus( ResultSummary[1]:DesignRatingStd ) < 1) then  UNDEFINED
         else if (EnergyCodeYearNum >= 2022)
         then  (  int( ((	RunResults[1]:StdElecTDV[1] + RunResults[1]:StdNatGasTDV + RunResults[1]:StdOtherTDV    ; SpcHt
      	    				 +	RunResults[2]:StdElecTDV[1] + RunResults[2]:StdNatGasTDV + RunResults[2]:StdOtherTDV    ; SpcCl
      	     				 +	RunResults[3]:StdElecTDV[1]    ; IAQVent
		           			 +	RunResults[4]:StandardTDV[1]   ; OthrHVAC
      	     				 +	RunResults[5]:StdElecTDV[1] + RunResults[5]:StdNatGasTDV + RunResults[5]:StdOtherTDV    ; WtrHt
		           			 +	RunResults[6]:StandardTDV[1]   ; InsLtg
      	     				 +	RunResults[7]:StdElecTDV[1] + RunResults[7]:StdNatGasTDV + RunResults[7]:StdOtherTDV    ; AppCkg
		           			 +	RunResults[8]:StandardTDV[1]   ; Plugs
			     	      	 +	RunResults[9]:StandardTDV[1] ) ; Ext
			  			* 1000 / RunResults[10]:DesignRatingTDV[2])+0.5 )/10  )  - ResultSummary[1]:DesignRatingStd
         else	ResultSummary[1]:DesignRatingStdNoPV - ResultSummary[1]:DesignRatingStd  endif endif  }
END

;*************************************************************************  - SAC 1/6/18
RULELIST "CARes_DesignRating_2019GHC_NESW" 1 0 1 1
   ; -- GHC - Grid Harmonization Credit --
   ; SAC 1/6/18 - 2019 GHC (grid harmonization credit) 
 	"Set ResultSummary[2]:GHCEnergyEffCap - Max Battery TDV that can be applied to Energy Efficiency DsgnRtg in the form of GHC" 
      Proj:ResultSummary[2]:GHCEnergyEffCap  = {
         if (EnergyCodeYearNum < 2019) then  UNDEFINED
         else if (IfValidAnd( BattGridHarmCredit > 0 )==0) then  0
         else  ValidOr( RunResultsN[11]:StandardTDV, 0 ) *
               T24RClimateZoneCodeBase:GridHarmCredPk( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr )
         endif endif  }
 	"Set ResultSummary[2]:GHCEnergyEffTDV - Battery TDV applied to Energy Efficiency DsgnRtg in the form of GHC" 
      Proj:ResultSummary[2]:GHCEnergyEffTDV  = {
         if (EnergyCodeYearNum < 2019 .OR.
             LocalStatus( ResultSummary[2]:GHCEnergyEffCap ) < 1) then  UNDEFINED
         else if ( (EnergyCodeYearNum <  2025 .AND. IfValidAnd( RunResultsN[14]:ProposedTDV[3] >= 0)) .OR.
                   (EnergyCodeYearNum >= 2025 .AND. IfValidAnd( RunResultsN[14]:ProposedTDV[1] >= 0 )) ) then  0
         else if (EnergyCodeYearNum <  2025)
         then  min( ResultSummary[2]:GHCEnergyEffCap, (-1 * RunResultsN[14]:ProposedTDV[3]) )
         else  min( ResultSummary[2]:GHCEnergyEffCap, (-1 * RunResultsN[14]:ProposedTDV[1]) )
         endif endif endif  }
 	"Set ResultSummary[2]:GHCEnergyEffBattFrac - Fraction of Battery TDV applied to Energy Efficiency DsgnRtg in the form of GHC" 
      Proj:ResultSummary[2]:GHCEnergyEffBattFrac  = {
         if (EnergyCodeYearNum < 2019 .OR.
             LocalStatus( ResultSummary[2]:GHCEnergyEffCap ) < 1) then  UNDEFINED
         else if ( (EnergyCodeYearNum <  2025 .AND. IfValidAnd( RunResultsN[14]:ProposedTDV[3] >= 0)) .OR.
                   (EnergyCodeYearNum >= 2025 .AND. IfValidAnd( RunResultsN[14]:ProposedTDV[1] >= 0 )) ) then  0
         else if (EnergyCodeYearNum <  2025)
         then  ResultSummary[2]:GHCEnergyEffTDV / (-1 * RunResultsN[14]:ProposedTDV[3])
         else  ResultSummary[2]:GHCEnergyEffTDV / (-1 * RunResultsN[14]:ProposedTDV[1])
         endif endif endif  }
 	"Set ResultSummary[2]:GHCEnergyEffElec - Battery elec use applied to Energy Efficiency DsgnRtg in the form of GHC" 
      Proj:ResultSummary[2]:GHCEnergyEffElec  =  {
         if (EnergyCodeYearNum < 2019 .OR.
             LocalStatus( ResultSummary[2]:GHCEnergyEffTDV ) < 1) then  UNDEFINED
         else if (ResultSummary[2]:GHCEnergyEffTDV <= 0) then  0
         else  (RunResultsN[14]:PropElecEnergy * Proj:CondFloorArea / 3.413) *
               ResultSummary[2]:GHCEnergyEffBattFrac
         endif endif  }
 	"Set ResultSummary[2]:GHCEnergyEffCO2 - Battery CO2 emissions applied to Energy Efficiency DsgnRtg in the form of GHC"   ; SAC 1/27/18 
      Proj:ResultSummary[2]:GHCEnergyEffCO2  =  {
         if (EnergyCodeYearNum < 2019 .OR.
             LocalStatus( ResultSummary[2]:GHCEnergyEffBattFrac ) < 1) then  UNDEFINED
         else if (ResultSummary[2]:GHCEnergyEffBattFrac <= 0) then  0
         else  ValidOr( RunResultsN[14]:PropTotalCarbon, 0 ) * ResultSummary[2]:GHCEnergyEffBattFrac
         endif endif  }
;END
;;*************************************************************************  - SAC 1/6/18
;RULELIST "CARes_DesignRating_2019GHC_E" 1 0 1 1
   ; -- GHC - Grid Harmonization Credit --
   ; SAC 1/6/18 - 2019 GHC (grid harmonization credit) 
 	"Set ResultSummary[3]:GHCEnergyEffCap - Max Battery TDV that can be applied to Energy Efficiency DsgnRtg in the form of GHC" 
      Proj:ResultSummary[3]:GHCEnergyEffCap  = {
         if (EnergyCodeYearNum < 2019) then  UNDEFINED
         else if (IfValidAnd( BattGridHarmCredit > 0 )==0) then  0
         else  ValidOr( RunResultsE[11]:StandardTDV, 0 ) *
               T24RClimateZoneCodeBase:GridHarmCredPk( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr )
         endif endif  }
 	"Set ResultSummary[3]:GHCEnergyEffTDV - Battery TDV applied to Energy Efficiency DsgnRtg in the form of GHC" 
      Proj:ResultSummary[3]:GHCEnergyEffTDV  = {
         if (EnergyCodeYearNum < 2019 .OR.
             LocalStatus( ResultSummary[3]:GHCEnergyEffCap ) < 1) then  UNDEFINED
         else if (RunResultsE[14]:ProposedTDV[3] >= 0) then  0
         else  min( ResultSummary[3]:GHCEnergyEffCap, (-1 * RunResultsE[14]:ProposedTDV[3]) )
         endif endif  }
 	"Set ResultSummary[3]:GHCEnergyEffBattFrac - Fraction of Battery TDV applied to Energy Efficiency DsgnRtg in the form of GHC" 
      Proj:ResultSummary[3]:GHCEnergyEffBattFrac  = {
         if (EnergyCodeYearNum < 2019 .OR.
             LocalStatus( ResultSummary[3]:GHCEnergyEffCap ) < 1) then  UNDEFINED
         else if (RunResultsE[14]:ProposedTDV[3] >= 0) then  0
         else  ResultSummary[3]:GHCEnergyEffTDV / (-1 * RunResultsE[14]:ProposedTDV[3])
         endif endif  }
 	"Set ResultSummary[3]:GHCEnergyEffElec - Battery elec use applied to Energy Efficiency DsgnRtg in the form of GHC" 
      Proj:ResultSummary[3]:GHCEnergyEffElec  =  {
         if (EnergyCodeYearNum < 2019 .OR.
             LocalStatus( ResultSummary[3]:GHCEnergyEffTDV ) < 1) then  UNDEFINED
         else if (ResultSummary[3]:GHCEnergyEffTDV <= 0) then  0
         else  (RunResultsE[14]:PropElecEnergy * Proj:CondFloorArea / 3.413) *
               ResultSummary[3]:GHCEnergyEffBattFrac
         endif endif  }
 	"Set ResultSummary[3]:GHCEnergyEffCO2 - Battery CO2 emissions applied to Energy Efficiency DsgnRtg in the form of GHC"   ; SAC 1/27/18 
      Proj:ResultSummary[3]:GHCEnergyEffCO2  =  {
         if (EnergyCodeYearNum < 2019 .OR.
             LocalStatus( ResultSummary[3]:GHCEnergyEffBattFrac ) < 1) then  UNDEFINED
         else if (ResultSummary[3]:GHCEnergyEffBattFrac <= 0) then  0
         else  ValidOr( RunResultsE[14]:PropTotalCarbon, 0 ) * ResultSummary[3]:GHCEnergyEffBattFrac
         endif endif  }
;END
;;*************************************************************************  - SAC 1/7/18
;RULELIST "CARes_DesignRating_2019GHC_S" 1 0 1 1
   ; -- GHC - Grid Harmonization Credit --
   ; SAC 1/6/18 - 2019 GHC (grid harmonization credit) 
 	"Set ResultSummary[4]:GHCEnergyEffCap - Max Battery TDV that can be applied to Energy Efficiency DsgnRtg in the form of GHC" 
      Proj:ResultSummary[4]:GHCEnergyEffCap  = {
         if (EnergyCodeYearNum < 2019) then  UNDEFINED
         else if (IfValidAnd( BattGridHarmCredit > 0 )==0) then  0
         else  ValidOr( RunResultsS[11]:StandardTDV, 0 ) *
               T24RClimateZoneCodeBase:GridHarmCredPk( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr )
         endif endif  }
 	"Set ResultSummary[4]:GHCEnergyEffTDV - Battery TDV applied to Energy Efficiency DsgnRtg in the form of GHC" 
      Proj:ResultSummary[4]:GHCEnergyEffTDV  = {
         if (EnergyCodeYearNum < 2019 .OR.
             LocalStatus( ResultSummary[4]:GHCEnergyEffCap ) < 1) then  UNDEFINED
         else if (RunResultsS[14]:ProposedTDV[3] >= 0) then  0
         else  min( ResultSummary[4]:GHCEnergyEffCap, (-1 * RunResultsS[14]:ProposedTDV[3]) )
         endif endif  }
 	"Set ResultSummary[4]:GHCEnergyEffBattFrac - Fraction of Battery TDV applied to Energy Efficiency DsgnRtg in the form of GHC" 
      Proj:ResultSummary[4]:GHCEnergyEffBattFrac  = {
         if (EnergyCodeYearNum < 2019 .OR.
             LocalStatus( ResultSummary[4]:GHCEnergyEffCap ) < 1) then  UNDEFINED
         else if (RunResultsS[14]:ProposedTDV[3] >= 0) then  0
         else  ResultSummary[4]:GHCEnergyEffTDV / (-1 * RunResultsS[14]:ProposedTDV[3])
         endif endif  }
 	"Set ResultSummary[4]:GHCEnergyEffElec - Battery elec use applied to Energy Efficiency DsgnRtg in the form of GHC" 
      Proj:ResultSummary[4]:GHCEnergyEffElec  =  {
         if (EnergyCodeYearNum < 2019 .OR.
             LocalStatus( ResultSummary[4]:GHCEnergyEffTDV ) < 1) then  UNDEFINED
         else if (ResultSummary[4]:GHCEnergyEffTDV <= 0) then  0
         else  (RunResultsS[14]:PropElecEnergy * Proj:CondFloorArea / 3.413) *
               ResultSummary[4]:GHCEnergyEffBattFrac
         endif endif  }
 	"Set ResultSummary[4]:GHCEnergyEffCO2 - Battery CO2 emissions applied to Energy Efficiency DsgnRtg in the form of GHC"   ; SAC 1/27/18 
      Proj:ResultSummary[4]:GHCEnergyEffCO2  =  {
         if (EnergyCodeYearNum < 2019 .OR.
             LocalStatus( ResultSummary[4]:GHCEnergyEffBattFrac ) < 1) then  UNDEFINED
         else if (ResultSummary[4]:GHCEnergyEffBattFrac <= 0) then  0
         else  ValidOr( RunResultsS[14]:PropTotalCarbon, 0 ) * ResultSummary[4]:GHCEnergyEffBattFrac
         endif endif  }
;END
;;*************************************************************************  - SAC 1/7/18
;RULELIST "CARes_DesignRating_2019GHC_W" 1 0 1 1
   ; -- GHC - Grid Harmonization Credit --
   ; SAC 1/6/18 - 2019 GHC (grid harmonization credit) 
 	"Set ResultSummary[5]:GHCEnergyEffCap - Max Battery TDV that can be applied to Energy Efficiency DsgnRtg in the form of GHC" 
      Proj:ResultSummary[5]:GHCEnergyEffCap  = {
         if (EnergyCodeYearNum < 2019) then  UNDEFINED
         else if (IfValidAnd( BattGridHarmCredit > 0 )==0) then  0
         else  ValidOr( RunResultsW[11]:StandardTDV, 0 ) *
               T24RClimateZoneCodeBase:GridHarmCredPk( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr )
         endif endif  }
 	"Set ResultSummary[5]:GHCEnergyEffTDV - Battery TDV applied to Energy Efficiency DsgnRtg in the form of GHC" 
      Proj:ResultSummary[5]:GHCEnergyEffTDV  = {
         if (EnergyCodeYearNum < 2019 .OR.
             LocalStatus( ResultSummary[5]:GHCEnergyEffCap ) < 1) then  UNDEFINED
         else if (RunResultsW[14]:ProposedTDV[3] >= 0) then  0
         else  min( ResultSummary[5]:GHCEnergyEffCap, (-1 * RunResultsW[14]:ProposedTDV[3]) )
         endif endif  }
 	"Set ResultSummary[5]:GHCEnergyEffBattFrac - Fraction of Battery TDV applied to Energy Efficiency DsgnRtg in the form of GHC" 
      Proj:ResultSummary[5]:GHCEnergyEffBattFrac  = {
         if (EnergyCodeYearNum < 2019 .OR.
             LocalStatus( ResultSummary[5]:GHCEnergyEffCap ) < 1) then  UNDEFINED
         else if (RunResultsW[14]:ProposedTDV[3] >= 0) then  0
         else  ResultSummary[5]:GHCEnergyEffTDV / (-1 * RunResultsW[14]:ProposedTDV[3])
         endif endif  }
 	"Set ResultSummary[5]:GHCEnergyEffElec - Battery elec use applied to Energy Efficiency DsgnRtg in the form of GHC" 
      Proj:ResultSummary[5]:GHCEnergyEffElec  =  {
         if (EnergyCodeYearNum < 2019 .OR.
             LocalStatus( ResultSummary[5]:GHCEnergyEffTDV ) < 1) then  UNDEFINED
         else if (ResultSummary[5]:GHCEnergyEffTDV <= 0) then  0
         else  (RunResultsW[14]:PropElecEnergy * Proj:CondFloorArea / 3.413) *
               ResultSummary[5]:GHCEnergyEffBattFrac
         endif endif  }
 	"Set ResultSummary[5]:GHCEnergyEffCO2 - Battery CO2 emissions applied to Energy Efficiency DsgnRtg in the form of GHC"   ; SAC 1/27/18 
      Proj:ResultSummary[5]:GHCEnergyEffCO2  =  {
         if (EnergyCodeYearNum < 2019 .OR.
             LocalStatus( ResultSummary[5]:GHCEnergyEffBattFrac ) < 1) then  UNDEFINED
         else if (ResultSummary[5]:GHCEnergyEffBattFrac <= 0) then  0
         else  ValidOr( RunResultsW[14]:PropTotalCarbon, 0 ) * ResultSummary[5]:GHCEnergyEffBattFrac
         endif endif  }
END

;*************************************************************************  - SAC 1/6/18
RULELIST "CARes_DesignRating_2019Standard_N" 1 0 1 1
   ; 2019 rules to calculate Standard Design EDR taking into account Required Minimum PV
   ; SAC 1/11/18 - revised rules to remove PV/BT to set DesignRatingStdNoPV rather than adding PV/BT to DesignRatingStd (which is already done)
   "Set ResultSummary[2]:DesignRatingStd"    Proj:ResultSummary[2]:DesignRatingStd  = {
         if (IfValidAnd( RunResultsN[10]:DesignRatingTDV[2] != 0 )==0 .OR. AnalysisType < 3) then  UNDEFINED
         else  int( (( RunResultsN[1]:StdElecTDV[1] + RunResultsN[1]:StdNatGasTDV + RunResultsN[1]:StdOtherTDV +  ; SpcHt
                     + RunResultsN[2]:StdElecTDV[1] + RunResultsN[2]:StdNatGasTDV + RunResultsN[2]:StdOtherTDV +  ; SpcCl
                     + RunResultsN[3]:StdElecTDV[1]    ; IAQVent
                     + RunResultsN[4]:StandardTDV[1]   ; OthrHVAC
                     + RunResultsN[5]:StdElecTDV[1] + RunResultsN[5]:StdNatGasTDV + RunResultsN[5]:StdOtherTDV +  ; WtrHt
                     + RunResultsN[6]:StandardTDV[1]   ; InsLtg
                     + RunResultsN[7]:StdElecTDV[1] + RunResultsN[7]:StdNatGasTDV + RunResultsN[7]:StdOtherTDV +  ; AppCkg
                     + RunResultsN[8]:StandardTDV[1]   ; Plugs
                     + RunResultsN[9]:StandardTDV[1]   ; Ext
                     + RunResultsN[13]:StandardTDV[1]  ; PV
                     + RunResultsN[14]:StandardTDV[1] ) ; Battery
              * 1000 / RunResultsN[10]:DesignRatingTDV[2])+0.5 )/10    endif  }
   ; modified for 2022 to use (non-fuel adjusted) Compliance, not Total TDV in calc of design rating - SAC 02/06/21
   "Set ResultSummary[2]:DesignRatingStdNoPV"   Proj:ResultSummary[2]:DesignRatingStdNoPV  =
      {  if (EnergyCodeYearNum >= 2022)
         then  if (IfValidAnd( RunResultsN[11]:DesignRatingTDV[1] != 0 )==0 .OR. AnalysisType < 3) then  UNDEFINED
               else  int( (( RunResultsN[1]:StdElecTDV[1] + RunResultsN[1]:StdNatGasTDV + RunResultsN[1]:StdOtherTDV    ; SpcHt
                           + RunResultsN[2]:StdElecTDV[1] + RunResultsN[2]:StdNatGasTDV + RunResultsN[2]:StdOtherTDV    ; SpcCl
                           + RunResultsN[3]:StdElecTDV[1]    ; IAQVent
                           + RunResultsN[4]:StandardTDV[1]   ; OthrHVAC
                           + RunResultsN[5]:StdElecTDV[1] + RunResultsN[5]:StdNatGasTDV + RunResultsN[5]:StdOtherTDV )  ; WtrHt
                    * 1000 / RunResultsN[11]:DesignRatingTDV[1])+0.5 )/10
               endif
         else  if (IfValidAnd( RunResultsN[10]:DesignRatingTDV[2] != 0 )==0 .OR. AnalysisType < 3) then  UNDEFINED
               else  int( (( RunResultsN[1]:StdElecTDV[1] + RunResultsN[1]:StdNatGasTDV + RunResultsN[1]:StdOtherTDV    ; SpcHt
                           + RunResultsN[2]:StdElecTDV[1] + RunResultsN[2]:StdNatGasTDV + RunResultsN[2]:StdOtherTDV    ; SpcCl
                           + RunResultsN[3]:StdElecTDV[1]    ; IAQVent
                           + RunResultsN[4]:StandardTDV[1]   ; OthrHVAC
                           + RunResultsN[5]:StdElecTDV[1] + RunResultsN[5]:StdNatGasTDV + RunResultsN[5]:StdOtherTDV    ; WtrHt
                           + RunResultsN[6]:StandardTDV[1]   ; InsLtg
                           + RunResultsN[7]:StdElecTDV[1] + RunResultsN[7]:StdNatGasTDV + RunResultsN[7]:StdOtherTDV    ; AppCkg
                           + RunResultsN[8]:StandardTDV[1]   ; Plugs
                           + RunResultsN[9]:StandardTDV[1] ) ; Ext
                    * 1000 / RunResultsN[10]:DesignRatingTDV[2])+0.5 )/10
               endif  endif  }
;"dbg" Proj:Action = { PostMessageToLog( "   Just set ResultSummary[2]:DesignRatingStd = %g  based on RunResultsN[10]:DesignRatingTDV[2] = %g  and ResultSummary[2]:StdMixedFuelPVTDV = %g",
;                           ValidOr( ResultSummary[2]:DesignRatingStd, -999 ), ValidOr( RunResultsN[10]:DesignRatingTDV[2], -999 ), ValidOr( ResultSummary[2]:StdMixedFuelPVTDV, -999 ) )  }
   ; and finally calculate DesignRatingStdPVOnly based on difference between DesignRatingStdNoPV and DesignRatingStd
   ; revised DesignRatingPVOnly calc for 2022 to include only PV, Battery & Flexibility (below line) - SAC 02/09/21
   "Set ResultSummary[2]:DesignRatingStdPVOnly"    Proj:ResultSummary[2]:DesignRatingStdPVOnly  = {
         if (LocalStatus( ResultSummary[2]:DesignRatingStdNoPV ) < 1 .OR. LocalStatus( ResultSummary[2]:DesignRatingStd ) < 1) then  UNDEFINED
         else if (EnergyCodeYearNum >= 2022)
         then  (  int( (( RunResultsN[1]:StdElecTDV[1] + RunResultsN[1]:StdNatGasTDV + RunResultsN[1]:StdOtherTDV    ; SpcHt
                        + RunResultsN[2]:StdElecTDV[1] + RunResultsN[2]:StdNatGasTDV + RunResultsN[2]:StdOtherTDV    ; SpcCl
                        + RunResultsN[3]:StdElecTDV[1]    ; IAQVent
                        + RunResultsN[4]:StandardTDV[1]   ; OthrHVAC
                        + RunResultsN[5]:StdElecTDV[1] + RunResultsN[5]:StdNatGasTDV + RunResultsN[5]:StdOtherTDV    ; WtrHt
                        + RunResultsN[6]:StandardTDV[1]   ; InsLtg
                        + RunResultsN[7]:StdElecTDV[1] + RunResultsN[7]:StdNatGasTDV + RunResultsN[7]:StdOtherTDV    ; AppCkg
                        + RunResultsN[8]:StandardTDV[1]   ; Plugs
                        + RunResultsN[9]:StandardTDV[1] ) ; Ext
                 * 1000 / RunResultsN[10]:DesignRatingTDV[2])+0.5 )/10  )  - ResultSummary[2]:DesignRatingStd
         else	ResultSummary[2]:DesignRatingStdNoPV - ResultSummary[2]:DesignRatingStd  endif endif  }
END
;*************************************************************************  - SAC 1/6/18
RULELIST "CARes_DesignRating_2019Standard_E" 1 0 1 1
   ; 2019 rules to calculate Standard Design EDR taking into account Required Minimum PV
   ; SAC 1/11/18 - revised rules to remove PV/BT to set DesignRatingStdNoPV rather than adding PV/BT to DesignRatingStd (which is already done)
   "Set ResultSummary[3]:DesignRatingStd"    Proj:ResultSummary[3]:DesignRatingStd  = {
         if (IfValidAnd( RunResultsE[10]:DesignRatingTDV[2] != 0 )==0 .OR. AnalysisType < 3) then  UNDEFINED
         else  int( (( RunResultsE[1]:StdElecTDV[1] + RunResultsE[1]:StdNatGasTDV + RunResultsE[1]:StdOtherTDV +  ; SpcHt
                     + RunResultsE[2]:StdElecTDV[1] + RunResultsE[2]:StdNatGasTDV + RunResultsE[2]:StdOtherTDV +  ; SpcCl
                     + RunResultsE[3]:StdElecTDV[1]    ; IAQVent
                     + RunResultsE[4]:StandardTDV[1]   ; OthrHVAC
                     + RunResultsE[5]:StdElecTDV[1] + RunResultsE[5]:StdNatGasTDV + RunResultsE[5]:StdOtherTDV +  ; WtrHt
                     + RunResultsE[6]:StandardTDV[1]   ; InsLtg
                     + RunResultsE[7]:StdElecTDV[1] + RunResultsE[7]:StdNatGasTDV + RunResultsE[7]:StdOtherTDV +  ; AppCkg
                     + RunResultsE[8]:StandardTDV[1]   ; Plugs
                     + RunResultsE[9]:StandardTDV[1]   ; Ext
                     + RunResultsE[13]:StandardTDV[1]  ; PV
                     + RunResultsE[14]:StandardTDV[1] ) ; Battery
              * 1000 / RunResultsE[10]:DesignRatingTDV[2])+0.5 )/10    endif  }
   ; modified for 2022 to use (non-fuel adjusted) Compliance, not Total TDV in calc of design rating - SAC 02/06/21
   "Set ResultSummary[3]:DesignRatingStdNoPV"   Proj:ResultSummary[3]:DesignRatingStdNoPV  =
      {  if (EnergyCodeYearNum >= 2022)
         then  if (IfValidAnd( RunResultsE[11]:DesignRatingTDV[1] != 0 )==0 .OR. AnalysisType < 3) then  UNDEFINED
               else  int( (( RunResultsE[1]:StdElecTDV[1] + RunResultsE[1]:StdNatGasTDV + RunResultsE[1]:StdOtherTDV    ; SpcHt
                           + RunResultsE[2]:StdElecTDV[1] + RunResultsE[2]:StdNatGasTDV + RunResultsE[2]:StdOtherTDV    ; SpcCl
                           + RunResultsE[3]:StdElecTDV[1]    ; IAQVent
                           + RunResultsE[4]:StandardTDV[1]   ; OthrHVAC
                           + RunResultsE[5]:StdElecTDV[1] + RunResultsE[5]:StdNatGasTDV + RunResultsE[5]:StdOtherTDV )  ; WtrHt
                    * 1000 / RunResultsE[11]:DesignRatingTDV[1])+0.5 )/10
               endif
         else  if (IfValidAnd( RunResultsE[10]:DesignRatingTDV[2] != 0 )==0 .OR. AnalysisType < 3) then  UNDEFINED
               else  int( (( RunResultsE[1]:StdElecTDV[1] + RunResultsE[1]:StdNatGasTDV + RunResultsE[1]:StdOtherTDV    ; SpcHt
                           + RunResultsE[2]:StdElecTDV[1] + RunResultsE[2]:StdNatGasTDV + RunResultsE[2]:StdOtherTDV    ; SpcCl
                           + RunResultsE[3]:StdElecTDV[1]    ; IAQVent
                           + RunResultsE[4]:StandardTDV[1]   ; OthrHVAC
                           + RunResultsE[5]:StdElecTDV[1] + RunResultsE[5]:StdNatGasTDV + RunResultsE[5]:StdOtherTDV    ; WtrHt
                           + RunResultsE[6]:StandardTDV[1]   ; InsLtg
                           + RunResultsE[7]:StdElecTDV[1] + RunResultsE[7]:StdNatGasTDV + RunResultsE[7]:StdOtherTDV    ; AppCkg
                           + RunResultsE[8]:StandardTDV[1]   ; Plugs
                           + RunResultsE[9]:StandardTDV[1] ) ; Ext
                    * 1000 / RunResultsE[10]:DesignRatingTDV[2])+0.5 )/10
               endif  endif  }
;"dbg" Proj:Action = { PostMessageToLog( "   Just set ResultSummary[3]:DesignRatingStd = %g  based on RunResultsE[10]:DesignRatingTDV[2] = %g  and ResultSummary[3]:StdMixedFuelPVTDV = %g",
;                           ValidOr( ResultSummary[3]:DesignRatingStd, -999 ), ValidOr( RunResultsE[10]:DesignRatingTDV[2], -999 ), ValidOr( ResultSummary[3]:StdMixedFuelPVTDV, -999 ) )  }
   ; and finally calculate DesignRatingStdPVOnly based on difference between DesignRatingStdNoPV and DesignRatingStd
   ; revised DesignRatingPVOnly calc for 2022 to include only PV, Battery & Flexibility (below line) - SAC 02/09/21
   "Set ResultSummary[3]:DesignRatingStdPVOnly"    Proj:ResultSummary[3]:DesignRatingStdPVOnly  = {
         if (LocalStatus( ResultSummary[3]:DesignRatingStdNoPV ) < 1 .OR. LocalStatus( ResultSummary[3]:DesignRatingStd ) < 1) then  UNDEFINED
         else if (EnergyCodeYearNum >= 2022)
         then  (  int( (( RunResultsE[1]:StdElecTDV[1] + RunResultsE[1]:StdNatGasTDV + RunResultsE[1]:StdOtherTDV    ; SpcHt
                        + RunResultsE[2]:StdElecTDV[1] + RunResultsE[2]:StdNatGasTDV + RunResultsE[2]:StdOtherTDV    ; SpcCl
                        + RunResultsE[3]:StdElecTDV[1]    ; IAQVent
                        + RunResultsE[4]:StandardTDV[1]   ; OthrHVAC
                        + RunResultsE[5]:StdElecTDV[1] + RunResultsE[5]:StdNatGasTDV + RunResultsE[5]:StdOtherTDV    ; WtrHt
                        + RunResultsE[6]:StandardTDV[1]   ; InsLtg
                        + RunResultsE[7]:StdElecTDV[1] + RunResultsE[7]:StdNatGasTDV + RunResultsE[7]:StdOtherTDV    ; AppCkg
                        + RunResultsE[8]:StandardTDV[1]   ; Plugs
                        + RunResultsE[9]:StandardTDV[1] ) ; Ext
                 * 1000 / RunResultsE[10]:DesignRatingTDV[2])+0.5 )/10  )  - ResultSummary[3]:DesignRatingStd
         else	ResultSummary[3]:DesignRatingStdNoPV - ResultSummary[3]:DesignRatingStd  endif endif  }
END
;*************************************************************************  - SAC 1/7/18
RULELIST "CARes_DesignRating_2019Standard_S" 1 0 1 1
   ; 2019 rules to calculate Standard Design EDR taking into account Required Minimum PV
   ; SAC 1/11/18 - revised rules to remove PV/BT to set DesignRatingStdNoPV rather than adding PV/BT to DesignRatingStd (which is already done)
   "Set ResultSummary[4]:DesignRatingStd"    Proj:ResultSummary[4]:DesignRatingStd  = {
         if (IfValidAnd( RunResultsS[10]:DesignRatingTDV[2] != 0 )==0 .OR. AnalysisType < 3) then  UNDEFINED
         else  int( (( RunResultsS[1]:StdElecTDV[1] + RunResultsS[1]:StdNatGasTDV + RunResultsS[1]:StdOtherTDV +  ; SpcHt
                     + RunResultsS[2]:StdElecTDV[1] + RunResultsS[2]:StdNatGasTDV + RunResultsS[2]:StdOtherTDV +  ; SpcCl
                     + RunResultsS[3]:StdElecTDV[1]    ; IAQVent
                     + RunResultsS[4]:StandardTDV[1]   ; OthrHVAC
                     + RunResultsS[5]:StdElecTDV[1] + RunResultsS[5]:StdNatGasTDV + RunResultsS[5]:StdOtherTDV +  ; WtrHt
                     + RunResultsS[6]:StandardTDV[1]   ; InsLtg
                     + RunResultsS[7]:StdElecTDV[1] + RunResultsS[7]:StdNatGasTDV + RunResultsS[7]:StdOtherTDV +  ; AppCkg
                     + RunResultsS[8]:StandardTDV[1]   ; Plugs
                     + RunResultsS[9]:StandardTDV[1]   ; Ext
                     + RunResultsS[13]:StandardTDV[1]  ; PV
                     + RunResultsS[14]:StandardTDV[1] ) ; Battery
              * 1000 / RunResultsS[10]:DesignRatingTDV[2])+0.5 )/10    endif  }
   ; modified for 2022 to use (non-fuel adjusted) Compliance, not Total TDV in calc of design rating - SAC 02/06/21
   "Set ResultSummary[4]:DesignRatingStdNoPV"   Proj:ResultSummary[4]:DesignRatingStdNoPV  =
      {  if (EnergyCodeYearNum >= 2022)
         then  if (IfValidAnd( RunResultsS[11]:DesignRatingTDV[1] != 0 )==0 .OR. AnalysisType < 3) then  UNDEFINED
               else  int( (( RunResultsS[1]:StdElecTDV[1] + RunResultsS[1]:StdNatGasTDV + RunResultsS[1]:StdOtherTDV    ; SpcHt
                           + RunResultsS[2]:StdElecTDV[1] + RunResultsS[2]:StdNatGasTDV + RunResultsS[2]:StdOtherTDV    ; SpcCl
                           + RunResultsS[3]:StdElecTDV[1]    ; IAQVent
                           + RunResultsS[4]:StandardTDV[1]   ; OthrHVAC
                           + RunResultsS[5]:StdElecTDV[1] + RunResultsS[5]:StdNatGasTDV + RunResultsS[5]:StdOtherTDV )  ; WtrHt
                    * 1000 / RunResultsS[11]:DesignRatingTDV[1])+0.5 )/10
               endif
         else  if (IfValidAnd( RunResultsS[10]:DesignRatingTDV[2] != 0 )==0 .OR. AnalysisType < 3) then  UNDEFINED
               else  int( (( RunResultsS[1]:StdElecTDV[1] + RunResultsS[1]:StdNatGasTDV + RunResultsS[1]:StdOtherTDV    ; SpcHt
                           + RunResultsS[2]:StdElecTDV[1] + RunResultsS[2]:StdNatGasTDV + RunResultsS[2]:StdOtherTDV    ; SpcCl
                           + RunResultsS[3]:StdElecTDV[1]    ; IAQVent
                           + RunResultsS[4]:StandardTDV[1]   ; OthrHVAC
                           + RunResultsS[5]:StdElecTDV[1] + RunResultsS[5]:StdNatGasTDV + RunResultsS[5]:StdOtherTDV    ; WtrHt
                           + RunResultsS[6]:StandardTDV[1]   ; InsLtg
                           + RunResultsS[7]:StdElecTDV[1] + RunResultsS[7]:StdNatGasTDV + RunResultsS[7]:StdOtherTDV    ; AppCkg
                           + RunResultsS[8]:StandardTDV[1]   ; Plugs
                           + RunResultsS[9]:StandardTDV[1] ) ; Ext
                    * 1000 / RunResultsS[10]:DesignRatingTDV[2])+0.5 )/10
               endif  endif  }
;"dbg" Proj:Action = { PostMessageToLog( "   Just set ResultSummary[4]:DesignRatingStd = %g  based on RunResultsS[10]:DesignRatingTDV[2] = %g  and ResultSummary[4]:StdMixedFuelPVTDV = %g",
;                           ValidOr( ResultSummary[4]:DesignRatingStd, -999 ), ValidOr( RunResultsS[10]:DesignRatingTDV[2], -999 ), ValidOr( ResultSummary[4]:StdMixedFuelPVTDV, -999 ) )  }
   ; and finally calculate DesignRatingStdPVOnly based on difference between DesignRatingStdNoPV and DesignRatingStd
   ; revised DesignRatingPVOnly calc for 2022 to include only PV, Battery & Flexibility (below line) - SAC 02/09/21
   "Set ResultSummary[4]:DesignRatingStdPVOnly"    Proj:ResultSummary[4]:DesignRatingStdPVOnly  = {
         if (LocalStatus( ResultSummary[4]:DesignRatingStdNoPV ) < 1 .OR. LocalStatus( ResultSummary[4]:DesignRatingStd ) < 1) then  UNDEFINED
         else if (EnergyCodeYearNum >= 2022)
         then  (  int( (( RunResultsS[1]:StdElecTDV[1] + RunResultsS[1]:StdNatGasTDV + RunResultsS[1]:StdOtherTDV    ; SpcHt
                        + RunResultsS[2]:StdElecTDV[1] + RunResultsS[2]:StdNatGasTDV + RunResultsS[2]:StdOtherTDV    ; SpcCl
                        + RunResultsS[3]:StdElecTDV[1]    ; IAQVent
                        + RunResultsS[4]:StandardTDV[1]   ; OthrHVAC
                        + RunResultsS[5]:StdElecTDV[1] + RunResultsS[5]:StdNatGasTDV + RunResultsS[5]:StdOtherTDV    ; WtrHt
                        + RunResultsS[6]:StandardTDV[1]   ; InsLtg
                        + RunResultsS[7]:StdElecTDV[1] + RunResultsS[7]:StdNatGasTDV + RunResultsS[7]:StdOtherTDV    ; AppCkg
                        + RunResultsS[8]:StandardTDV[1]   ; Plugs
                        + RunResultsS[9]:StandardTDV[1] ) ; Ext
                 * 1000 / RunResultsS[10]:DesignRatingTDV[2])+0.5 )/10  )  - ResultSummary[4]:DesignRatingStd
         else	ResultSummary[4]:DesignRatingStdNoPV - ResultSummary[4]:DesignRatingStd  endif endif  }
END
;*************************************************************************  - SAC 1/7/18
RULELIST "CARes_DesignRating_2019Standard_W" 1 0 1 1
   ; 2019 rules to calculate Standard Design EDR taking into account Required Minimum PV
   ; SAC 1/11/18 - revised rules to remove PV/BT to set DesignRatingStdNoPV rather than adding PV/BT to DesignRatingStd (which is already done)
   "Set ResultSummary[5]:DesignRatingStd"    Proj:ResultSummary[5]:DesignRatingStd  = {
         if (IfValidAnd( RunResultsW[10]:DesignRatingTDV[2] != 0 )==0 .OR. AnalysisType < 3) then  UNDEFINED
         else  int( (( RunResultsW[1]:StdElecTDV[1] + RunResultsW[1]:StdNatGasTDV + RunResultsW[1]:StdOtherTDV +  ; SpcHt
                     + RunResultsW[2]:StdElecTDV[1] + RunResultsW[2]:StdNatGasTDV + RunResultsW[2]:StdOtherTDV +  ; SpcCl
                     + RunResultsW[3]:StdElecTDV[1]    ; IAQVent
                     + RunResultsW[4]:StandardTDV[1]   ; OthrHVAC
                     + RunResultsW[5]:StdElecTDV[1] + RunResultsW[5]:StdNatGasTDV + RunResultsW[5]:StdOtherTDV +  ; WtrHt
                     + RunResultsW[6]:StandardTDV[1]   ; InsLtg
                     + RunResultsW[7]:StdElecTDV[1] + RunResultsW[7]:StdNatGasTDV + RunResultsW[7]:StdOtherTDV +  ; AppCkg
                     + RunResultsW[8]:StandardTDV[1]   ; Plugs
                     + RunResultsW[9]:StandardTDV[1]   ; Ext
                     + RunResultsW[13]:StandardTDV[1]  ; PV
                     + RunResultsW[14]:StandardTDV[1] ) ; Battery
              * 1000 / RunResultsW[10]:DesignRatingTDV[2])+0.5 )/10    endif  }
   ; modified for 2022 to use (non-fuel adjusted) Compliance, not Total TDV in calc of design rating - SAC 02/06/21
   "Set ResultSummary[5]:DesignRatingStdNoPV"   Proj:ResultSummary[5]:DesignRatingStdNoPV  =
      {  if (EnergyCodeYearNum >= 2022)
         then  if (IfValidAnd( RunResultsW[11]:DesignRatingTDV[1] != 0 )==0 .OR. AnalysisType < 3) then  UNDEFINED
               else  int( (( RunResultsW[1]:StdElecTDV[1] + RunResultsW[1]:StdNatGasTDV + RunResultsW[1]:StdOtherTDV    ; SpcHt
                           + RunResultsW[2]:StdElecTDV[1] + RunResultsW[2]:StdNatGasTDV + RunResultsW[2]:StdOtherTDV    ; SpcCl
                           + RunResultsW[3]:StdElecTDV[1]    ; IAQVent
                           + RunResultsW[4]:StandardTDV[1]   ; OthrHVAC
                           + RunResultsW[5]:StdElecTDV[1] + RunResultsW[5]:StdNatGasTDV + RunResultsW[5]:StdOtherTDV )  ; WtrHt
                    * 1000 / RunResultsW[11]:DesignRatingTDV[1])+0.5 )/10
               endif
         else  if (IfValidAnd( RunResultsW[10]:DesignRatingTDV[2] != 0 )==0 .OR. AnalysisType < 3) then  UNDEFINED
               else  int( (( RunResultsW[1]:StdElecTDV[1] + RunResultsW[1]:StdNatGasTDV + RunResultsW[1]:StdOtherTDV    ; SpcHt
                           + RunResultsW[2]:StdElecTDV[1] + RunResultsW[2]:StdNatGasTDV + RunResultsW[2]:StdOtherTDV    ; SpcCl
                           + RunResultsW[3]:StdElecTDV[1]    ; IAQVent
                           + RunResultsW[4]:StandardTDV[1]   ; OthrHVAC
                           + RunResultsW[5]:StdElecTDV[1] + RunResultsW[5]:StdNatGasTDV + RunResultsW[5]:StdOtherTDV    ; WtrHt
                           + RunResultsW[6]:StandardTDV[1]   ; InsLtg
                           + RunResultsW[7]:StdElecTDV[1] + RunResultsW[7]:StdNatGasTDV + RunResultsW[7]:StdOtherTDV    ; AppCkg
                           + RunResultsW[8]:StandardTDV[1]   ; Plugs
                           + RunResultsW[9]:StandardTDV[1] ) ; Ext
                    * 1000 / RunResultsW[10]:DesignRatingTDV[2])+0.5 )/10
               endif  endif  }
;"dbg" Proj:Action = { PostMessageToLog( "   Just set ResultSummary[5]:DesignRatingStd = %g  based on RunResultsW[10]:DesignRatingTDV[2] = %g  and ResultSummary[5]:StdMixedFuelPVTDV = %g",
;                           ValidOr( ResultSummary[5]:DesignRatingStd, -999 ), ValidOr( RunResultsW[10]:DesignRatingTDV[2], -999 ), ValidOr( ResultSummary[5]:StdMixedFuelPVTDV, -999 ) )  }
   ; and finally calculate DesignRatingStdPVOnly based on difference between DesignRatingStdNoPV and DesignRatingStd
   ; revised DesignRatingPVOnly calc for 2022 to include only PV, Battery & Flexibility (below line) - SAC 02/09/21
   "Set ResultSummary[5]:DesignRatingStdPVOnly"    Proj:ResultSummary[5]:DesignRatingStdPVOnly  = {
         if (LocalStatus( ResultSummary[5]:DesignRatingStdNoPV ) < 1 .OR. LocalStatus( ResultSummary[5]:DesignRatingStd ) < 1) then  UNDEFINED
         else if (EnergyCodeYearNum >= 2022)
         then  (  int( (( RunResultsW[1]:StdElecTDV[1] + RunResultsW[1]:StdNatGasTDV + RunResultsW[1]:StdOtherTDV    ; SpcHt
                        + RunResultsW[2]:StdElecTDV[1] + RunResultsW[2]:StdNatGasTDV + RunResultsW[2]:StdOtherTDV    ; SpcCl
                        + RunResultsW[3]:StdElecTDV[1]    ; IAQVent
                        + RunResultsW[4]:StandardTDV[1]   ; OthrHVAC
                        + RunResultsW[5]:StdElecTDV[1] + RunResultsW[5]:StdNatGasTDV + RunResultsW[5]:StdOtherTDV    ; WtrHt
                        + RunResultsW[6]:StandardTDV[1]   ; InsLtg
                        + RunResultsW[7]:StdElecTDV[1] + RunResultsW[7]:StdNatGasTDV + RunResultsW[7]:StdOtherTDV    ; AppCkg
                        + RunResultsW[8]:StandardTDV[1]   ; Plugs
                        + RunResultsW[9]:StandardTDV[1] ) ; Ext
                 * 1000 / RunResultsW[10]:DesignRatingTDV[2])+0.5 )/10  )  - ResultSummary[5]:DesignRatingStd
         else	ResultSummary[5]:DesignRatingStdNoPV - ResultSummary[5]:DesignRatingStd  endif endif  }
END


;*************************************************************************
RULELIST "CARes_Refresh_RunResults" 1 0 0 1
;*************************************************************************
;"debug"  Proj:Action = {  PostMessageToLog( "  evaluating 'CARes_Refresh_RunResults':  RunAbbrev '%s'  RunNumber %g", RunAbbrev, RunNumber )  }
;	"Blast all EUseSummary components if this is the first run of an analysis"	Proj:Action	= {	DeleteAllComps( EUseSummary )  }  - moved to OneTimeAnalysisPrep
	"Create energy use summary component"				Proj:ResultSummary[1]					= {	CreateComp( EUseSummary, "EUSummary" )  }
	"Set parent for energy use summary"					Proj:ResultSummary[1]:Parent			= {	Local( Name )  }
	"Set ProjAssignFirst for energy use summary"		Proj:ResultSummary[1]:ProjAssignFirst	= {	1  }		; SAC 3/3/16 - tic #609

;	"Blast all EnergyUse components if this is the first run of an analysis"	Proj:Action	= {	DeleteAllComps( EnergyUse )  }  - moved to OneTimeAnalysisPrep

	"Create result component - SpcHtg"		Proj:RunResults[1]					= {	CreateComp( EnergyUse, "EU-SpcHtg" )  }
	"Set parent for result   - SpcHtg"		Proj:RunResults[1]:Parent			= {	Local( Name )  }
	"Set EU name for result  - SpcHtg"		Proj:RunResults[1]:EnduseName		= {	"Space Heating"  }

	"Create result component - SpcClg"		Proj:RunResults[2]					= {	CreateComp( EnergyUse, "EU-SpcClg" )  }
	"Set parent for result   - SpcClg"		Proj:RunResults[2]:Parent			= {	Local( Name )  }
	"Set EU name for result  - SpcClg"		Proj:RunResults[2]:EnduseName		= {	"Space Cooling"  }

	"Create result component - IAQVent"		Proj:RunResults[3]					= {	CreateComp( EnergyUse, "EU-IAQVent" )  }
	"Set parent for result   - IAQVent"		Proj:RunResults[3]:Parent			= {	Local( Name )  }
	"Set EU name for result  - IAQVent"		Proj:RunResults[3]:EnduseName		= {	"IAQ Ventilation"  }

	"Create result component - Othr HVAC"	Proj:RunResults[4]					= {	CreateComp( EnergyUse, "EU-OthrHVAC" )  }
	"Set parent for result   - Othr HVAC"	Proj:RunResults[4]:Parent			= {	Local( Name )  }
	"Set EU name for result  - Othr HVAC"	Proj:RunResults[4]:EnduseName		= {	"Other HVAC"  }

	"Create result component - WtrHt"		Proj:RunResults[5]					= {	CreateComp( EnergyUse, "EU-WtrHt" )  }
	"Set parent for result   - WtrHt"		Proj:RunResults[5]:Parent			= {	Local( Name )  }
	"Set EU name for result  - WtrHt"		Proj:RunResults[5]:EnduseName		= {	"Water Heating"  }

	"Create result component - InsLtg"		Proj:RunResults[6]					= {	CreateComp( EnergyUse, "EU-InsLtg" )  }
	"Set parent for result   - InsLtg"		Proj:RunResults[6]:Parent			= {	Local( Name )  }
	"Set EU name for result  - InsLtg"		Proj:RunResults[6]:EnduseName		= {	"Inside Lighting"  }

	"Create result component - AppCkg"		Proj:RunResults[7]					= {	CreateComp( EnergyUse, "EU-AppCkg" )  }
	"Set parent for result   - AppCkg"		Proj:RunResults[7]:Parent			= {	Local( Name )  }
	"Set EU name for result  - AppCkg"		Proj:RunResults[7]:EnduseName		= {	"Appl. & Cooking"  }

	"Create result component - Plugs"		Proj:RunResults[8]					= {	CreateComp( EnergyUse, "EU-Plugs" )  }
	"Set parent for result   - Plugs"		Proj:RunResults[8]:Parent			= {	Local( Name )  }
	"Set EU name for result  - Plugs"		Proj:RunResults[8]:EnduseName		= {	"Plug Loads"  }

	"Create result component - Ext"			Proj:RunResults[9]					= {	CreateComp( EnergyUse, "EU-Ext" )  }
	"Set parent for result   - Ext"			Proj:RunResults[9]:Parent			= {	Local( Name )  }
	"Set EU name for result  - Ext"			Proj:RunResults[9]:EnduseName		= {	"Exterior"  }

	"Create result component - Total"		Proj:RunResults[10]					= {	CreateComp( EnergyUse, "EU-Total" )  }
	"Set parent for result   - Total"		Proj:RunResults[10]:Parent			= {	Local( Name )  }
	"Set EU name for result  - Total"		Proj:RunResults[10]:EnduseName	= {	"TOTAL"  }

	"Create result component - Comp Ttl"	Proj:RunResults[11]					= {	CreateComp( EnergyUse, "EU-Compliance" )  }
	"Set parent for result   - Comp Ttl"	Proj:RunResults[11]:Parent			= {	Local( Name )  }
	"Set EU name for result  - Comp Ttl"	Proj:RunResults[11]:EnduseName	= {	"Compliance Total"  }

	"Create result component - PV Ttl"		Proj:RunResults[13]					= {	CreateComp( EnergyUse, "EU-PV" )  }
	"Set parent for result   - PV Ttl"		Proj:RunResults[13]:Parent			= {	Local( Name )  }
	"Set EU name for result  - PV Ttl"		Proj:RunResults[13]:EnduseName	= {	"Photovoltaics"  }

	"Create result component - Battery"		Proj:RunResults[14]					= {	CreateComp( EnergyUse, "EU-Battery" )  }
	"Set parent for result   - Battery"		Proj:RunResults[14]:Parent			= {	Local( Name )  }
	"Set EU name for result  - Battery"		Proj:RunResults[14]:EnduseName	= {	"Battery"  }

;"dbg BEMProc details"		Proj:Action = {  StoreBEMProc( Format( "aft CARes_Refresh_RunResults for %s", RunAbbrev ), 0 )  }
END


;************************************************************************* ; switched from non-User to User-defined data status flagging - SAC 11/26/22
RULELIST "CARes_ProposedResults" 1 0 1 1
;	mjb-10/16/13	moved "Other HVAC" [4] to "Space Heating" [1]
;*************************************************************************
;"debug"  Proj:Action = {  PostMessageToLog( "  evaluating 'CARes_ProposedResults':  RunAbbrev '%s'  RunNumber %g", RunAbbrev, RunNumber )  }
   ; SAC 12/20/17 - moved rules to blast and re-create RunResults objects into subordinate list to initiate either from here or StdMixdFuel run rules
   "Refresh RunResults objects"  Proj:Action  = {
         if (ComponentCount( EUseSummary ) > 0 .AND. ComponentCount( EnergyUse ) > 0) then  UNCHANGED
         else  EvalRulelist( "CARes_Refresh_RunResults" )  endif  }
      ;   if (IfValidAnd( RunNumber < 2 )==0) then  UNCHANGED
      ;   else  EvalRulelist( "CARes_Refresh_RunResults" )  endif  }

; SAC 8/5/13 - added references to new "SHWPmp" (summed into each occurrence of Elec-SHW)
  ; Space Heating (& heating fan)
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
	"Store energy use - Elec   - SpcHt"		Proj:RunResults[1]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - SpcHt"		Proj:RunResults[1]:PropNatGasEnergy[1]		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrNatGas", "Htg", "HPBU", "Aux" ) / CondFloorArea  endif  }
	"Store energy use - Other  - SpcHt"		Proj:RunResults[1]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrOther",  "Htg", "HPBU",  "Aux" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - SpcHt"		Proj:RunResults[1]:PropTotalEnergy[1]		= {	LocalRef( RunResults[1]:PropElecEnergy[1] ) + LocalRef( RunResults[1]:PropNatGasEnergy[1] ) + LocalRef( RunResults[1]:PropOtherEnergy[1] )   }

  ; Space Cooling (& cooling fan)
	"Store energy use - Elec   - SpcCl"		Proj:RunResults[2]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - SpcCl"		Proj:RunResults[2]:PropNatGasEnergy[1]		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrNatGas", "Clg"         ) / CondFloorArea  endif  }
	"Store energy use - Other  - SpcCl"		Proj:RunResults[2]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrOther",  "Clg"         ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - SpcCl"		Proj:RunResults[2]:PropTotalEnergy[1]		= {	LocalRef( RunResults[2]:PropElecEnergy[1] ) + LocalRef( RunResults[2]:PropNatGasEnergy[1] ) + LocalRef( RunResults[2]:PropOtherEnergy[1] )   }

  ; IAQ Ventilation Fans
	"Store energy use - Elec   - IAQVent"	Proj:RunResults[3]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrElec",   "FanV" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - IAQVent"	Proj:RunResults[3]:PropNatGasEnergy[1]		= {	0  }
	"Store energy use - Other  - IAQVent"	Proj:RunResults[3]:PropOtherEnergy[1]		= {	0  }
	"Store energy use - TOTAL  - IAQVent"	Proj:RunResults[3]:PropTotalEnergy[1]		= {	LocalRef( RunResults[3]:PropElecEnergy[1] )   }

  ; Other HVAC (aux & misc fans)
; SAC 11/8/18 - restored "Other HVAC" [4] to handle VCHP CFan via "User1" enduse
	"Store energy use - Elec   - OthrHVAC"	Proj:RunResults[4]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrElec",   "User1" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - OthrHVAC"	Proj:RunResults[4]:PropNatGasEnergy[1]		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrNatGas", "User1" ) / CondFloorArea  endif  }
	"Store energy use - Other  - OthrHVAC"	Proj:RunResults[4]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrOther",  "User1" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - OthrHVAC"	Proj:RunResults[4]:PropTotalEnergy[1]		= {	LocalRef( RunResults[4]:PropElecEnergy[1] ) + LocalRef( RunResults[4]:PropNatGasEnergy[1] ) + LocalRef( RunResults[4]:PropOtherEnergy[1] )   }

; SAC 1/26/19 - REDISTRIBUTE OthrHVAC Prop energy use across SpcHt & SpcCl by fuel based on ratio of total energy use (across all fuels) (tic #1053)
   "Set OthrHVAC_SpcHtFrac - PropEnergy"  Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResults[4]:PropTotalEnergy[1] != 0 )==0) then  0
                                                                        else if (IfValidAnd( RunResults[1]:PropTotalEnergy[1] == 0 ) .AND.
                                                                                 IfValidAnd( RunResults[2]:PropTotalEnergy[1] == 0 )) then  0.5
                                                                        else   ValidOr( RunResults[1]:PropTotalEnergy[1], 0 ) / 
                                                                              (ValidOr( RunResults[1]:PropTotalEnergy[1], 0 ) + ValidOr( RunResults[2]:PropTotalEnergy[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Elec   - SpcHt"		Proj:RunResults[1]:PropElecEnergy[1]	= {   if (IfValidAnd( RunResults[4]:PropElecEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[1]:PropElecEnergy[1] + (RunResults[4]:PropElecEnergy[1]     * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - NatGas - SpcHt"		Proj:RunResults[1]:PropNatGasEnergy[1]	= {   if (IfValidAnd( RunResults[4]:PropNatGasEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[1]:PropNatGasEnergy[1] + (RunResults[4]:PropNatGasEnergy[1] * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - Other  - SpcHt"		Proj:RunResults[1]:PropOtherEnergy[1]	= {   if (IfValidAnd( RunResults[4]:PropOtherEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[1]:PropOtherEnergy[1] + (RunResults[4]:PropOtherEnergy[1]   * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - TOTAL  - SpcHt"		Proj:RunResults[1]:PropTotalEnergy[1]	= {	LocalRef( RunResults[1]:PropElecEnergy[1] ) + LocalRef( RunResults[1]:PropNatGasEnergy[1] ) + LocalRef( RunResults[1]:PropOtherEnergy[1] )   }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Elec   - SpcCl"		Proj:RunResults[2]:PropElecEnergy[1]	= {   if (IfValidAnd( RunResults[4]:PropElecEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[2]:PropElecEnergy[1] + (RunResults[4]:PropElecEnergy[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - NatGas - SpcCl"		Proj:RunResults[2]:PropNatGasEnergy[1]	= {   if (IfValidAnd( RunResults[4]:PropNatGasEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[2]:PropNatGasEnergy[1] + (RunResults[4]:PropNatGasEnergy[1] * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - Other  - SpcCl"		Proj:RunResults[2]:PropOtherEnergy[1]	= {   if (IfValidAnd( RunResults[4]:PropOtherEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[2]:PropOtherEnergy[1] + (RunResults[4]:PropOtherEnergy[1]   * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - TOTAL  - SpcCl"		Proj:RunResults[2]:PropTotalEnergy[1]	= {	LocalRef( RunResults[2]:PropElecEnergy[1] ) + LocalRef( RunResults[2]:PropNatGasEnergy[1] ) + LocalRef( RunResults[2]:PropOtherEnergy[1] )   }
  ; Other HVAC (aux & misc fans)
	"ZERO-OUT         - Elec   - OthrHVAC"	Proj:RunResults[4]:PropElecEnergy[1]	= {	0  }
	"ZERO-OUT         - NatGas - OthrHVAC"	Proj:RunResults[4]:PropNatGasEnergy[1]	= {	0  }
	"ZERO-OUT         - Other  - OthrHVAC"	Proj:RunResults[4]:PropOtherEnergy[1]	= {	0  }
	"ZERO-OUT         - TOTAL  - OthrHVAC"	Proj:RunResults[4]:PropTotalEnergy[1]	= {	0  }
   ; SAC 1/26/19 - end of - redistribution of OthrHVAC PropEnergy

  ; SAC 3/23/16 - updated references to "DHW" enduse w/ "Dhw" and added "DhwBU" (DHW backup htg)
  ; Water Heating
	"Store energy use - Elec   - WtrHt"		Proj:RunResults[5]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else if (CSEinclDHWMFL_EU)
			 			  																							then  HourlyResultSum( RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / CondFloorArea
			 			  																							else  HourlyResultSum( RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / CondFloorArea  endif endif  }
	"Store energy use - NatGas - WtrHt"		Proj:RunResults[5]:PropNatGasEnergy[1]		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea  endif  }
	"Store energy use - Other  - WtrHt"		Proj:RunResults[5]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - WtrHt"		Proj:RunResults[5]:PropTotalEnergy[1]		= {	LocalRef( RunResults[5]:PropElecEnergy[1] ) + LocalRef( RunResults[5]:PropNatGasEnergy[1] ) + LocalRef( RunResults[5]:PropOtherEnergy[1] )   }

  ; Inside Lighting
	"Store energy use - Elec   - InsLtg"	Proj:RunResults[6]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrElec",   "Lit" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - InsLtg"	Proj:RunResults[6]:PropNatGasEnergy[1]		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrNatGas", "Lit" ) / CondFloorArea  endif  }
	"Store energy use - Other  - InsLtg"	Proj:RunResults[6]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrOther",  "Lit" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - InsLtg"	Proj:RunResults[6]:PropTotalEnergy[1]		= {	LocalRef( RunResults[6]:PropElecEnergy[1] ) + LocalRef( RunResults[6]:PropNatGasEnergy[1] ) + LocalRef( RunResults[6]:PropOtherEnergy[1] )   }

  ; Appliances & Cooking
	"Store energy use - Elec   - AppCkg"	Proj:RunResults[7]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - AppCkg"	Proj:RunResults[7]:PropNatGasEnergy[1]		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea  endif  }
	"Store energy use - Other  - AppCkg"	Proj:RunResults[7]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - AppCkg"	Proj:RunResults[7]:PropTotalEnergy[1]		= {	LocalRef( RunResults[7]:PropElecEnergy[1] ) + LocalRef( RunResults[7]:PropNatGasEnergy[1] ) + LocalRef( RunResults[7]:PropOtherEnergy[1] )   }

  ; Plug Loads
	"Store energy use - Elec   - Plugs"		Proj:RunResults[8]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrElec",   "Rcp" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - Plugs"		Proj:RunResults[8]:PropNatGasEnergy[1]		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrNatGas", "Rcp" ) / CondFloorArea  endif  }
	"Store energy use - Other  - Plugs"		Proj:RunResults[8]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrOther",  "Rcp" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - Plugs"		Proj:RunResults[8]:PropTotalEnergy[1]		= {	LocalRef( RunResults[8]:PropElecEnergy[1] ) + LocalRef( RunResults[8]:PropNatGasEnergy[1] ) + LocalRef( RunResults[8]:PropOtherEnergy[1] )   }

  ; Exterior
	"Store energy use - Elec   - Ext"		Proj:RunResults[9]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrElec",   "Ext" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - Ext"		Proj:RunResults[9]:PropNatGasEnergy[1]		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrNatGas", "Ext" ) / CondFloorArea  endif  }
	"Store energy use - Other  - Ext"		Proj:RunResults[9]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrOther",  "Ext" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - Ext"		Proj:RunResults[9]:PropTotalEnergy[1]		= {	LocalRef( RunResults[9]:PropElecEnergy[1] ) + LocalRef( RunResults[9]:PropNatGasEnergy[1] ) + LocalRef( RunResults[9]:PropOtherEnergy[1] )   }

  ; PV
	"Store energy use - Elec   - PV"			Proj:RunResults[13]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec ) < 0.5 .OR. CondFloorArea < 1) then  0
                                                                                          else if (CommunitySolarProjID > 0 .AND. IfValidAnd( CmntySlr_ElecEnergy < 0 )) then  CmntySlr_ElecEnergy * PVWDCSizeMultiplier[1] * 3.412 / CondFloorArea
			 			  																								else  HourlyResultSum( RunID, "MtrElec", "PV" ) / CondFloorArea  endif endif  }
	"Store energy use - NatGas - PV"			Proj:RunResults[13]:PropNatGasEnergy[1]	= {	0  }
	"Store energy use - Other  - PV"			Proj:RunResults[13]:PropOtherEnergy[1]		= {	0  }
	"Store energy use - TOTAL  - PV"			Proj:RunResults[13]:PropTotalEnergy[1]		= {	LocalRef( RunResults[13]:PropElecEnergy[1] )   }

  ; Battery
	"Store energy use - Elec   - Battery"	Proj:RunResults[14]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec", "BT" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - Battery"	Proj:RunResults[14]:PropNatGasEnergy[1]	= {	0  }
	"Store energy use - Other  - Battery"	Proj:RunResults[14]:PropOtherEnergy[1]		= {	0  }
	"Store energy use - TOTAL  - Battery"	Proj:RunResults[14]:PropTotalEnergy[1]		= {	LocalRef( RunResults[14]:PropElecEnergy[1] )   }

  ; Compliance Total
	"Store energy use - Elec   - Comp Ttl"	Proj:RunResults[11]:PropElecEnergy[1]		= {	RunResults[1]:PropElecEnergy[1]   + RunResults[2]:PropElecEnergy[1]   + RunResults[3]:PropElecEnergy[1]   + RunResults[4]:PropElecEnergy[1]   + RunResults[5]:PropElecEnergy[1]    }
	"Store energy use - NatGas - Comp Ttl"	Proj:RunResults[11]:PropNatGasEnergy[1]	= {	RunResults[1]:PropNatGasEnergy[1] + RunResults[2]:PropNatGasEnergy[1] + RunResults[3]:PropNatGasEnergy[1] + RunResults[4]:PropNatGasEnergy[1] + RunResults[5]:PropNatGasEnergy[1]  }
	"Store energy use - Other  - Comp Ttl"	Proj:RunResults[11]:PropOtherEnergy[1]		= {	RunResults[1]:PropOtherEnergy[1]  + RunResults[2]:PropOtherEnergy[1]  + RunResults[3]:PropOtherEnergy[1]  + RunResults[4]:PropOtherEnergy[1]  + RunResults[5]:PropOtherEnergy[1]   }
	"Store energy use - TOTAL  - Comp Ttl"	Proj:RunResults[11]:PropTotalEnergy[1]		= {	RunResults[1]:PropTotalEnergy[1]  + RunResults[2]:PropTotalEnergy[1]  + RunResults[3]:PropTotalEnergy[1]  + RunResults[4]:PropTotalEnergy[1]  + RunResults[5]:PropTotalEnergy[1]   }
;   ; SAC 10/6/16 - 2019 updates  - SAC 4/7/17 - shifted from CompTot to Tot
;	"Add in PV - Elec   - Comp Ttl"	      Proj:RunResults[11]:PropElecEnergy[1]		= {	if (EnergyCodeYearNum < 2019) then  UNCHANGED
;                                                                                          else  RunResults[11]:PropElecEnergy[1]  + RunResults[13]:PropElecEnergy[1]  + RunResults[14]:PropElecEnergy[1]   endif   }
;	"Add in PV - TOTAL  - Comp Ttl"	      Proj:RunResults[11]:PropTotalEnergy[1]		= {	if (EnergyCodeYearNum < 2019) then  UNCHANGED
;                                                                                          else  RunResults[11]:PropTotalEnergy[1] + RunResults[13]:PropTotalEnergy[1] + RunResults[14]:PropTotalEnergy[1]  endif   }

  ; Total
	"Store energy use - Elec   - Total"		Proj:RunResults[10]:PropElecEnergy[1]		= {	RunResults[11]:PropElecEnergy[1]   + RunResults[6]:PropElecEnergy[1]   + RunResults[7]:PropElecEnergy[1]   + RunResults[8]:PropElecEnergy[1]   + RunResults[9]:PropElecEnergy[1]    }
	"Store energy use - NatGas - Total"		Proj:RunResults[10]:PropNatGasEnergy[1]	= {	RunResults[11]:PropNatGasEnergy[1] + RunResults[6]:PropNatGasEnergy[1] + RunResults[7]:PropNatGasEnergy[1] + RunResults[8]:PropNatGasEnergy[1] + RunResults[9]:PropNatGasEnergy[1]  }
	"Store energy use - Other  - Total"		Proj:RunResults[10]:PropOtherEnergy[1]		= {	RunResults[11]:PropOtherEnergy[1]  + RunResults[6]:PropOtherEnergy[1]  + RunResults[7]:PropOtherEnergy[1]  + RunResults[8]:PropOtherEnergy[1]  + RunResults[9]:PropOtherEnergy[1]   }
	"Store energy use - TOTAL  - Total"		Proj:RunResults[10]:PropTotalEnergy[1]		= {	RunResults[11]:PropTotalEnergy[1]  + RunResults[6]:PropTotalEnergy[1]  + RunResults[7]:PropTotalEnergy[1]  + RunResults[8]:PropTotalEnergy[1]  + RunResults[9]:PropTotalEnergy[1]   }
   ; SAC 4/7/17 - shifted PV & Batt from CompTot to Tot for 2019
   ; SAC 4/28/17 - add in only Battery to Total for 2016
	"Add in PV/Batt - Elec   - Total"	   Proj:RunResults[10]:PropElecEnergy[1]		= {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                          else if (EnergyCodeYearNum < 2019) 
                                                                                          then  RunResults[10]:PropElecEnergy[1]  + RunResults[14]:PropElecEnergy[1]
                                                                                          else  RunResults[10]:PropElecEnergy[1]  + RunResults[13]:PropElecEnergy[1]  + RunResults[14]:PropElecEnergy[1]   endif endif   }
	"Add in PV/Batt - TOTAL  - Total"	   Proj:RunResults[10]:PropTotalEnergy[1]		= {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                          else if (EnergyCodeYearNum < 2019) 
                                                                                          then  RunResults[10]:PropTotalEnergy[1] + RunResults[14]:PropTotalEnergy[1]
                                                                                          else  RunResults[10]:PropTotalEnergy[1] + RunResults[13]:PropTotalEnergy[1] + RunResults[14]:PropTotalEnergy[1]  endif endif   }

   "Store Proj:AnalysisVersion to EUseSummary"     Proj:ResultSummary[1]:ResultsAnalysisVer = {  ValidOr( Proj:AnalysisVersion, 0 )  }    ; SAC 11/28/22
   "Store Proj:AllOrientations to EUseSummary"     Proj:ResultSummary[1]:AllOrientations    = {  ValidOr( Proj:AllOrientations, 0 )  }

   ; SAC 1/19/18 - add reporting proposed PV cap
   "Store size of PV system actually analyzed"     Proj:ResultSummary[1]:PropDesignPVTot  = {
         if ( (EnergyCodeYearNum < 2019 .AND.
               (IfValidAnd( AllowDesignRating > 0.5 )==0 .OR. IfValidAnd( DesignRatingCalcs > 0.5 )==0)) .OR.
              IfValidAnd( PVWDCSysTotal > 0 )==0 )
         then  UNDEFINED
         else	PVWDCSysTotal * ValidOr( PVWDCSizeMultiplier[1], 1 )  endif  }
   "Store PV input properties"      Proj:Action = {
         if (IfValidAnd( ResultSummary[1]:PropDesignPVTot > 0 )==0) then  UNCHANGED
         else  EvalRulelist( "CARes_Results_StoreInputPVSize" )  endif  }

   "Store Proposed model Battery capacity"      Proj:ResultSummary[1]:PropDesignBattCap  =      ; SAC 11/26/22
      {  if ( (IfValidAnd( PVWDCSysTotal > 0 )==0 .AND. IfValidAnd( SimStandaloneBatt > 0 )==0 ) .OR. IfValidAnd( SimulateBattery > 0 )==0 .OR. 
              (IfValidAnd( SimulateBattery > 0 ) .AND. IfValidAnd( AllowBattRoundTripEff == 1) .AND. IfValidAnd( BattRoundTripEff < 0.8))) 
         then  UNDEFINED
         else  ValidOr( BattMaxCap, 0 )  endif  }
   "Store Proposed model Battery power"         Proj:ResultSummary[1]:PropDesignBattPwr  =
      {  if (IfValidAnd( ResultSummary[1]:PropDesignBattCap > 0 )==0) 
         then  UNDEFINED
         else  (ValidOr( BattMaxChgPwr, 0 ) + ValidOr( BattMaxDschgPwr, 0 )) / 2  endif  }
END


;*************************************************************************
RULELIST "CARes_Refresh_RunResults_N" 1 0 0 1
;*************************************************************************
;"debug"  Proj:Action = {  PostMessageToLog( "  evaluating 'CARes_Refresh_RunResults_N':  RunAbbrev '%s'  RunNumber %g", RunAbbrev, RunNumber )  }
;	"Blast all EUseSummary components if this is the first run of an analysis"	Proj:Action	= {	DeleteAllComps( EUseSummary )  }		; only for FIRST (North) run  - moved to OneTimeAnalysisPrep

	"Create 'Worst Case'energy use summary component"			Proj:ResultSummary[1]			= {	CreateComp( EUseSummary, "Worst Case" )  }
	"Set parent for energy use summary"								Proj:ResultSummary[1]:Parent	= {	Local( Name )  }
	"Set ProjAssignFirst for energy use summary"					Proj:ResultSummary[1]:ProjAssignFirst	= {	1  }		; SAC 3/3/16 - tic #609

	"Create 'North Facing' energy use summary component"		Proj:ResultSummary[2]			= {	CreateComp( EUseSummary, "North Facing" )  }
	"Set parent for energy use summary"								Proj:ResultSummary[2]:Parent	= {	Local( Name )  }
	"Set ProjAssignFirst for energy use summary"					Proj:ResultSummary[2]:ProjAssignFirst	= {	0  }		; SAC 3/3/16 - tic #609

;	"Blast all EnergyUse components if this is the first run of an analysis"	Proj:Action	= {	DeleteAllComps( EnergyUse )  }  ; ONLY for FIRST (North) run  - moved to OneTimeAnalysisPrep

	"Create result component - N-SpcHtg"		Proj:RunResultsN[1]					= {	CreateComp( EnergyUse, "N-EU-SpcHtg" )  }
	"Set parent for result   - N-SpcHtg"		Proj:RunResultsN[1]:Parent			= {	Local( Name )  }
	"Set EU name for result  - N-SpcHtg"		Proj:RunResultsN[1]:EnduseName	= {	"Space Heating"  }

	"Create result component - N-SpcClg"		Proj:RunResultsN[2]					= {	CreateComp( EnergyUse, "N-EU-SpcClg" )  }
	"Set parent for result   - N-SpcClg"		Proj:RunResultsN[2]:Parent			= {	Local( Name )  }
	"Set EU name for result  - N-SpcClg"		Proj:RunResultsN[2]:EnduseName	= {	"Space Cooling"  }

	"Create result component - N-IAQVent"		Proj:RunResultsN[3]					= {	CreateComp( EnergyUse, "N-EU-IAQVent" )  }
	"Set parent for result   - N-IAQVent"		Proj:RunResultsN[3]:Parent			= {	Local( Name )  }
	"Set EU name for result  - N-IAQVent"		Proj:RunResultsN[3]:EnduseName	= {	"IAQ Ventilation"  }

	"Create result component - N-Othr HVAC"	Proj:RunResultsN[4]					= {	CreateComp( EnergyUse, "N-EU-OthrHVAC" )  }
	"Set parent for result   - N-Othr HVAC"	Proj:RunResultsN[4]:Parent			= {	Local( Name )  }
	"Set EU name for result  - N-Othr HVAC"	Proj:RunResultsN[4]:EnduseName	= {	"Other HVAC"  }

	"Create result component - N-WtrHt"			Proj:RunResultsN[5]					= {	CreateComp( EnergyUse, "N-EU-WtrHt" )  }
	"Set parent for result   - N-WtrHt"			Proj:RunResultsN[5]:Parent			= {	Local( Name )  }
	"Set EU name for result  - N-WtrHt"			Proj:RunResultsN[5]:EnduseName	= {	"Water Heating"  }

	"Create result component - N-InsLtg"		Proj:RunResultsN[6]					= {	CreateComp( EnergyUse, "N-EU-InsLtg" )  }
	"Set parent for result   - N-InsLtg"		Proj:RunResultsN[6]:Parent			= {	Local( Name )  }
	"Set EU name for result  - N-InsLtg"		Proj:RunResultsN[6]:EnduseName	= {	"Inside Lighting"  }

	"Create result component - N-AppCkg"		Proj:RunResultsN[7]					= {	CreateComp( EnergyUse, "N-EU-AppCkg" )  }
	"Set parent for result   - N-AppCkg"		Proj:RunResultsN[7]:Parent			= {	Local( Name )  }
	"Set EU name for result  - N-AppCkg"		Proj:RunResultsN[7]:EnduseName	= {	"Appl. & Cooking"  }

	"Create result component - N-Plugs"			Proj:RunResultsN[8]					= {	CreateComp( EnergyUse, "N-EU-Plugs" )  }
	"Set parent for result   - N-Plugs"			Proj:RunResultsN[8]:Parent			= {	Local( Name )  }
	"Set EU name for result  - N-Plugs"			Proj:RunResultsN[8]:EnduseName	= {	"Plug Loads"  }

	"Create result component - N-Ext"			Proj:RunResultsN[9]					= {	CreateComp( EnergyUse, "N-EU-Ext" )  }
	"Set parent for result   - N-Ext"			Proj:RunResultsN[9]:Parent			= {	Local( Name )  }
	"Set EU name for result  - N-Ext"			Proj:RunResultsN[9]:EnduseName	= {	"Exterior"  }

	"Create result component - N-Total"			Proj:RunResultsN[10]					= {	CreateComp( EnergyUse, "N-EU-Total" )  }
	"Set parent for result   - N-Total"			Proj:RunResultsN[10]:Parent		= {	Local( Name )  }
	"Set EU name for result  - N-Total"			Proj:RunResultsN[10]:EnduseName	= {	"TOTAL"  }

	"Create result component - N-Comp Ttl"		Proj:RunResultsN[11]					= {	CreateComp( EnergyUse, "N-EU-Compliance" )  }
	"Set parent for result   - N-Comp Ttl"		Proj:RunResultsN[11]:Parent		= {	Local( Name )  }
	"Set EU name for result  - N-Comp Ttl"		Proj:RunResultsN[11]:EnduseName	= {	"Compliance Total"  }

	"Create result component - N-PV Ttl"		Proj:RunResultsN[13]					= {	CreateComp( EnergyUse, "N-EU-PV" )  }
	"Set parent for result   - N-PV Ttl"		Proj:RunResultsN[13]:Parent		= {	Local( Name )  }
	"Set EU name for result  - N-PV Ttl"		Proj:RunResultsN[13]:EnduseName	= {	"Photovoltaics"  }

	"Create result component - N-Batt Ttl"		Proj:RunResultsN[14]					= {	CreateComp( EnergyUse, "N-EU-Battery" )  }
	"Set parent for result   - N-Batt Ttl"		Proj:RunResultsN[14]:Parent		= {	Local( Name )  }
	"Set EU name for result  - N-Batt Ttl"		Proj:RunResultsN[14]:EnduseName	= {	"Battery"  }

;"dbg BEMProc details"		Proj:Action = {  StoreBEMProc( Format( "aft CARes_Refresh_RunResults_N for %s", RunAbbrev ), 0 )  }
END


;*************************************************************************		- SAC 6/25/13
RULELIST "CARes_ProposedResults_N" 1 0 1 1
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
;*************************************************************************
;"debug"  Proj:Action = {  PostMessageToLog( "  evaluating 'CARes_ProposedResults_N':  RunAbbrev '%s'  RunNumber %g  - %g EUseSummary & %g EnergyUse objects", RunAbbrev, RunNumber, ComponentCount( EUseSummary ), ComponentCount( EnergyUse ) )  }
   ; SAC 1/5/18 - moved rules to blast and re-create RunResults objects into subordinate list to initiate either from here or StdMixdFuel run rules
   "Refresh RunResults-N objects"  Proj:Action  = {
         if (ComponentCount( EUseSummary ) > 0 .AND. ComponentCount( EnergyUse ) > 0) then  UNCHANGED
         else  EvalRulelist( "CARes_Refresh_RunResults_N" )  endif  }

  ; Space Heating (& heating fan)
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
	"Store energy use - Elec   - N-SpcHt"		Proj:RunResultsN[1]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Htg", "HPBU", "FanH",   "Aux", "Fan"  ) / CondFloorArea  endif  }
	"Store energy use - NatGas - N-SpcHt"		Proj:RunResultsN[1]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Htg", "HPBU", "Aux"         ) / CondFloorArea  endif  }
	"Store energy use - Other  - N-SpcHt"		Proj:RunResultsN[1]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Htg", "HPBU",  "Aux"         ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - N-SpcHt"		Proj:RunResultsN[1]:PropTotalEnergy[1]		= {	LocalRef( RunResultsN[1]:PropElecEnergy[1] ) + LocalRef( RunResultsN[1]:PropNatGasEnergy[1] ) + LocalRef( RunResultsN[1]:PropOtherEnergy[1] )   }

  ; Space Cooling (& cooling fan)
	"Store energy use - Elec   - N-SpcCl"		Proj:RunResultsN[2]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - N-SpcCl"		Proj:RunResultsN[2]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Clg"         ) / CondFloorArea  endif  }
	"Store energy use - Other  - N-SpcCl"		Proj:RunResultsN[2]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Clg"         ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - N-SpcCl"		Proj:RunResultsN[2]:PropTotalEnergy[1]		= {	LocalRef( RunResultsN[2]:PropElecEnergy[1] ) + LocalRef( RunResultsN[2]:PropNatGasEnergy[1] ) + LocalRef( RunResultsN[2]:PropOtherEnergy[1] )   }

  ; IAQ Ventilation Fans
	"Store energy use - Elec   - N-IAQVent"	Proj:RunResultsN[3]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "FanV" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - N-IAQVent"	Proj:RunResultsN[3]:PropNatGasEnergy[1]	= {	0  }
	"Store energy use - Other  - N-IAQVent"	Proj:RunResultsN[3]:PropOtherEnergy[1]		= {	0  }
	"Store energy use - TOTAL  - N-IAQVent"	Proj:RunResultsN[3]:PropTotalEnergy[1]		= {	LocalRef( RunResultsN[3]:PropElecEnergy[1] )   }

  ; Other HVAC (aux & misc fans)
; SAC 11/8/18 - restored "Other HVAC" [4] to handle VCHP CFan via "User1" enduse
	"Store energy use - Elec   - N-OthrHVAC"	Proj:RunResultsN[4]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "User1" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - N-OthrHVAC"	Proj:RunResultsN[4]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "User1" ) / CondFloorArea  endif  }
	"Store energy use - Other  - N-OthrHVAC"	Proj:RunResultsN[4]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "User1" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:PropTotalEnergy[1]		= {	LocalRef( RunResultsN[4]:PropElecEnergy[1] ) + LocalRef( RunResultsN[4]:PropNatGasEnergy[1] ) + LocalRef( RunResultsN[4]:PropOtherEnergy[1] )   }

; SAC 1/27/19 - REDISTRIBUTE OthrHVAC Prop energy use across SpcHt & SpcCl by fuel based on ratio of total energy use (across all fuels) (tic #1053)
   "Set OthrHVAC_SpcHtFrac - N-PropEnergy"   Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResultsN[4]:PropTotalEnergy[1] != 0 )==0) then  0
                                                                           else if (IfValidAnd( RunResultsN[1]:PropTotalEnergy[1] == 0 ) .AND.
                                                                                    IfValidAnd( RunResultsN[2]:PropTotalEnergy[1] == 0 )) then  0.5
                                                                           else   ValidOr( RunResultsN[1]:PropTotalEnergy[1], 0 ) / 
                                                                                 (ValidOr( RunResultsN[1]:PropTotalEnergy[1], 0 ) + ValidOr( RunResultsN[2]:PropTotalEnergy[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Elec   - N-SpcHt"		Proj:RunResultsN[1]:PropElecEnergy[1]	= {   if (IfValidAnd( RunResultsN[4]:PropElecEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsN[1]:PropElecEnergy[1] + (RunResultsN[4]:PropElecEnergy[1]     * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - NatGas - N-SpcHt"		Proj:RunResultsN[1]:PropNatGasEnergy[1] ={   if (IfValidAnd( RunResultsN[4]:PropNatGasEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsN[1]:PropNatGasEnergy[1] + (RunResultsN[4]:PropNatGasEnergy[1] * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - Other  - N-SpcHt"		Proj:RunResultsN[1]:PropOtherEnergy[1]	= {   if (IfValidAnd( RunResultsN[4]:PropOtherEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsN[1]:PropOtherEnergy[1] + (RunResultsN[4]:PropOtherEnergy[1]   * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - TOTAL  - N-SpcHt"		Proj:RunResultsN[1]:PropTotalEnergy[1]	= {	LocalRef( RunResultsN[1]:PropElecEnergy[1] ) + LocalRef( RunResultsN[1]:PropNatGasEnergy[1] ) + LocalRef( RunResultsN[1]:PropOtherEnergy[1] )   }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Elec   - N-SpcCl"		Proj:RunResultsN[2]:PropElecEnergy[1]	= {   if (IfValidAnd( RunResultsN[4]:PropElecEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsN[2]:PropElecEnergy[1] + (RunResultsN[4]:PropElecEnergy[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - NatGas - N-SpcCl"		Proj:RunResultsN[2]:PropNatGasEnergy[1] ={   if (IfValidAnd( RunResultsN[4]:PropNatGasEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsN[2]:PropNatGasEnergy[1] + (RunResultsN[4]:PropNatGasEnergy[1] * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - Other  - N-SpcCl"		Proj:RunResultsN[2]:PropOtherEnergy[1]	= {   if (IfValidAnd( RunResultsN[4]:PropOtherEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsN[2]:PropOtherEnergy[1] + (RunResultsN[4]:PropOtherEnergy[1]   * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - TOTAL  - N-SpcCl"		Proj:RunResultsN[2]:PropTotalEnergy[1]	= {	LocalRef( RunResultsN[2]:PropElecEnergy[1] ) + LocalRef( RunResultsN[2]:PropNatGasEnergy[1] ) + LocalRef( RunResultsN[2]:PropOtherEnergy[1] )   }
  ; Other HVAC (aux & misc fans)
	"ZERO-OUT         - Elec   - N-OthrHVAC"	Proj:RunResultsN[4]:PropElecEnergy[1]	= {	0  }
	"ZERO-OUT         - NatGas - N-OthrHVAC"	Proj:RunResultsN[4]:PropNatGasEnergy[1] ={	0  }
	"ZERO-OUT         - Other  - N-OthrHVAC"	Proj:RunResultsN[4]:PropOtherEnergy[1]	= {	0  }
	"ZERO-OUT         - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:PropTotalEnergy[1]	= {	0  }
   ; SAC 1/27/19 - end of - redistribution of OthrHVAC PropEnergy

  ; Water Heating
	"Store energy use - Elec   - N-WtrHt"		Proj:RunResultsN[5]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else if (CSEinclDHWMFL_EU)
			 			  																							   then  HourlyResultSum( RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / CondFloorArea
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / CondFloorArea  endif endif  }
	"Store energy use - NatGas - N-WtrHt"		Proj:RunResultsN[5]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea  endif  }
	"Store energy use - Other  - N-WtrHt"		Proj:RunResultsN[5]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - N-WtrHt"		Proj:RunResultsN[5]:PropTotalEnergy[1]		= {	LocalRef( RunResultsN[5]:PropElecEnergy[1] ) + LocalRef( RunResultsN[5]:PropNatGasEnergy[1] ) + LocalRef( RunResultsN[5]:PropOtherEnergy[1] )   }

  ; Inside Lighting
	"Store energy use - Elec   - N-InsLtg"		Proj:RunResultsN[6]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Lit" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - N-InsLtg"		Proj:RunResultsN[6]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Lit" ) / CondFloorArea  endif  }
	"Store energy use - Other  - N-InsLtg"		Proj:RunResultsN[6]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Lit" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - N-InsLtg"		Proj:RunResultsN[6]:PropTotalEnergy[1]		= {	LocalRef( RunResultsN[6]:PropElecEnergy[1] ) + LocalRef( RunResultsN[6]:PropNatGasEnergy[1] ) + LocalRef( RunResultsN[6]:PropOtherEnergy[1] )   }

  ; Appliances & Cooking
	"Store energy use - Elec   - N-AppCkg"		Proj:RunResultsN[7]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - N-AppCkg"		Proj:RunResultsN[7]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea  endif  }
	"Store energy use - Other  - N-AppCkg"		Proj:RunResultsN[7]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - N-AppCkg"		Proj:RunResultsN[7]:PropTotalEnergy[1]		= {	LocalRef( RunResultsN[7]:PropElecEnergy[1] ) + LocalRef( RunResultsN[7]:PropNatGasEnergy[1] ) + LocalRef( RunResultsN[7]:PropOtherEnergy[1] )   }

  ; Plug Loads
	"Store energy use - Elec   - N-Plugs"		Proj:RunResultsN[8]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Rcp" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - N-Plugs"		Proj:RunResultsN[8]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Rcp" ) / CondFloorArea  endif  }
	"Store energy use - Other  - N-Plugs"		Proj:RunResultsN[8]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Rcp" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - N-Plugs"		Proj:RunResultsN[8]:PropTotalEnergy[1]		= {	LocalRef( RunResultsN[8]:PropElecEnergy[1] ) + LocalRef( RunResultsN[8]:PropNatGasEnergy[1] ) + LocalRef( RunResultsN[8]:PropOtherEnergy[1] )   }

  ; Exterior
	"Store energy use - Elec   - N-Ext"			Proj:RunResultsN[9]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Ext" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - N-Ext"			Proj:RunResultsN[9]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Ext" ) / CondFloorArea  endif  }
	"Store energy use - Other  - N-Ext"			Proj:RunResultsN[9]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Ext" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - N-Ext"			Proj:RunResultsN[9]:PropTotalEnergy[1]		= {	LocalRef( RunResultsN[9]:PropElecEnergy[1] ) + LocalRef( RunResultsN[9]:PropNatGasEnergy[1] ) + LocalRef( RunResultsN[9]:PropOtherEnergy[1] )   }

  ; PV
	"Store energy use - Elec   - N-PV"			Proj:RunResultsN[13]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec ) < 0.5 .OR. CondFloorArea < 1) then  0
                                                                                          else if (CommunitySolarProjID > 0 .AND. IfValidAnd( CmntySlr_ElecEnergy < 0 )) then  CmntySlr_ElecEnergy * PVWDCSizeMultiplier[1] * 3.412 / CondFloorArea
			 			  																								else  HourlyResultSum( RunID, "MtrElec", "PV" ) / CondFloorArea  endif endif  }
	"Store energy use - NatGas - N-PV"			Proj:RunResultsN[13]:PropNatGasEnergy[1]	= {	0  }
	"Store energy use - Other  - N-PV"			Proj:RunResultsN[13]:PropOtherEnergy[1]	= {	0  }
	"Store energy use - TOTAL  - N-PV"			Proj:RunResultsN[13]:PropTotalEnergy[1]	= {	LocalRef( RunResultsN[13]:PropElecEnergy[1] )   }

  ; Battery
	"Store energy use - Elec   - N-Battery"	Proj:RunResultsN[14]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								   else  HourlyResultSum( RunID, "MtrElec", "BT" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - N-Battery"	Proj:RunResultsN[14]:PropNatGasEnergy[1]	= {	0  }
	"Store energy use - Other  - N-Battery"	Proj:RunResultsN[14]:PropOtherEnergy[1]	= {	0  }
	"Store energy use - TOTAL  - N-Battery"	Proj:RunResultsN[14]:PropTotalEnergy[1]	= {	LocalRef( RunResultsN[14]:PropElecEnergy[1] )   }

  ; Compliance Total
	"Store energy use - Elec   - N-Comp Ttl"	Proj:RunResultsN[11]:PropElecEnergy[1]		= {	RunResultsN[1]:PropElecEnergy[1]   + RunResultsN[2]:PropElecEnergy[1]   + RunResultsN[3]:PropElecEnergy[1]   + RunResultsN[4]:PropElecEnergy[1]   + RunResultsN[5]:PropElecEnergy[1]    }
	"Store energy use - NatGas - N-Comp Ttl"	Proj:RunResultsN[11]:PropNatGasEnergy[1]	= {	RunResultsN[1]:PropNatGasEnergy[1] + RunResultsN[2]:PropNatGasEnergy[1] + RunResultsN[3]:PropNatGasEnergy[1] + RunResultsN[4]:PropNatGasEnergy[1] + RunResultsN[5]:PropNatGasEnergy[1]  }
	"Store energy use - Other  - N-Comp Ttl"	Proj:RunResultsN[11]:PropOtherEnergy[1]	= {	RunResultsN[1]:PropOtherEnergy[1]  + RunResultsN[2]:PropOtherEnergy[1]  + RunResultsN[3]:PropOtherEnergy[1]  + RunResultsN[4]:PropOtherEnergy[1]  + RunResultsN[5]:PropOtherEnergy[1]   }
	"Store energy use - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:PropTotalEnergy[1]	= {	RunResultsN[1]:PropTotalEnergy[1]  + RunResultsN[2]:PropTotalEnergy[1]  + RunResultsN[3]:PropTotalEnergy[1]  + RunResultsN[4]:PropTotalEnergy[1]  + RunResultsN[5]:PropTotalEnergy[1]   }
;   ; SAC 10/6/16 - 2019 updates
;	"Add in PV - Elec   - N-Comp Ttl"	      Proj:RunResultsN[11]:PropElecEnergy[1]		= {	if (EnergyCodeYearNum < 2019) then  UNCHANGED
;                                                                                             else  RunResultsN[11]:PropElecEnergy[1]  + RunResultsN[13]:PropElecEnergy[1]  + RunResultsN[14]:PropElecEnergy[1]   endif   }
;	"Add in PV - TOTAL  - N-Comp Ttl"	      Proj:RunResultsN[11]:PropTotalEnergy[1]	= {	if (EnergyCodeYearNum < 2019) then  UNCHANGED
;                                                                                             else  RunResultsN[11]:PropTotalEnergy[1] + RunResultsN[13]:PropTotalEnergy[1] + RunResultsN[14]:PropTotalEnergy[1]  endif   }

  ; Total
	"Store energy use - Elec   - N-Total"		Proj:RunResultsN[10]:PropElecEnergy[1]		= {	RunResultsN[11]:PropElecEnergy[1]   + RunResultsN[6]:PropElecEnergy[1]   + RunResultsN[7]:PropElecEnergy[1]   + RunResultsN[8]:PropElecEnergy[1]   + RunResultsN[9]:PropElecEnergy[1]    }
	"Store energy use - NatGas - N-Total"		Proj:RunResultsN[10]:PropNatGasEnergy[1]	= {	RunResultsN[11]:PropNatGasEnergy[1] + RunResultsN[6]:PropNatGasEnergy[1] + RunResultsN[7]:PropNatGasEnergy[1] + RunResultsN[8]:PropNatGasEnergy[1] + RunResultsN[9]:PropNatGasEnergy[1]  }
	"Store energy use - Other  - N-Total"		Proj:RunResultsN[10]:PropOtherEnergy[1]	= {	RunResultsN[11]:PropOtherEnergy[1]  + RunResultsN[6]:PropOtherEnergy[1]  + RunResultsN[7]:PropOtherEnergy[1]  + RunResultsN[8]:PropOtherEnergy[1]  + RunResultsN[9]:PropOtherEnergy[1]   }
	"Store energy use - TOTAL  - N-Total"		Proj:RunResultsN[10]:PropTotalEnergy[1]	= {	RunResultsN[11]:PropTotalEnergy[1]  + RunResultsN[6]:PropTotalEnergy[1]  + RunResultsN[7]:PropTotalEnergy[1]  + RunResultsN[8]:PropTotalEnergy[1]  + RunResultsN[9]:PropTotalEnergy[1]   }
   ; SAC 4/28/17 - shifted PV & Batt from CompTot to Tot for 2019
   ; SAC 4/28/17 - add in only Battery to Total for 2016
	"Add in PV/Batt - Elec   - N-Total"	      Proj:RunResultsN[10]:PropElecEnergy[1]		= {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                             else if (EnergyCodeYearNum < 2019) 
                                                                                             then  RunResultsN[10]:PropElecEnergy[1]  + RunResultsN[14]:PropElecEnergy[1]
                                                                                             else  RunResultsN[10]:PropElecEnergy[1]  + RunResultsN[13]:PropElecEnergy[1]  + RunResultsN[14]:PropElecEnergy[1]   endif endif   }
	"Add in PV/Batt - TOTAL  - N-Total"	      Proj:RunResultsN[10]:PropTotalEnergy[1]	= {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                             else if (EnergyCodeYearNum < 2019) 
                                                                                             then  RunResultsN[10]:PropTotalEnergy[1] + RunResultsN[14]:PropTotalEnergy[1]
                                                                                             else  RunResultsN[10]:PropTotalEnergy[1] + RunResultsN[13]:PropTotalEnergy[1] + RunResultsN[14]:PropTotalEnergy[1]  endif endif   }

   "Store Proj:AnalysisVersion to EUseSummary-N"   Proj:ResultSummary[2]:ResultsAnalysisVer = {  ValidOr( Proj:AnalysisVersion, 0 )  }    ; SAC 11/28/22
   "Store Proj:AllOrientations to EUseSummary-N"   Proj:ResultSummary[2]:AllOrientations    = {  ValidOr( Proj:AllOrientations, 0 )  }

   ; SAC 1/19/18 - add reporting proposed PV cap
   "Store size of PV system actually analyzed-N"   Proj:ResultSummary[2]:PropDesignPVTot  = {
         if ( (EnergyCodeYearNum < 2019 .AND.
               (IfValidAnd( AllowDesignRating > 0.5 )==0 .OR. IfValidAnd( DesignRatingCalcs > 0.5 )==0)) .OR.
              IfValidAnd( PVWDCSysTotal > 0 )==0 )
         then  UNDEFINED
         else	PVWDCSysTotal * ValidOr( PVWDCSizeMultiplier[1], 1 )  endif  }
   "Store PV input properties"      Proj:Action = {
         if (IfValidAnd( ResultSummary[2]:PropDesignPVTot > 0 )==0) then  UNCHANGED
         else  EvalRulelist( "CARes_Results_StoreInputPVSize" )  endif  }

   "Store Proposed model Battery capacity-N"      Proj:ResultSummary[2]:PropDesignBattCap  =      ; SAC 11/26/22
      {  if ( (IfValidAnd( PVWDCSysTotal > 0 )==0 .AND. IfValidAnd( SimStandaloneBatt > 0 )==0 ) .OR. IfValidAnd( SimulateBattery > 0 )==0 .OR. 
              (IfValidAnd( SimulateBattery > 0 ) .AND. IfValidAnd( AllowBattRoundTripEff == 1) .AND. IfValidAnd( BattRoundTripEff < 0.8))) 
         then  UNDEFINED
         else  ValidOr( BattMaxCap, 0 )  endif  }
   "Store Proposed model Battery power-N"         Proj:ResultSummary[2]:PropDesignBattPwr  =
      {  if (IfValidAnd( ResultSummary[2]:PropDesignBattCap > 0 )==0) then  UNDEFINED
         else  (ValidOr( BattMaxChgPwr, 0 ) + ValidOr( BattMaxDschgPwr, 0 )) / 2  endif  }
END

;*************************************************************************
RULELIST "CARes_Refresh_RunResults_E" 1 0 0 1
;*************************************************************************
;"debug"  Proj:Action = {  PostMessageToLog( "  evaluating 'CARes_Refresh_RunResults_E':  RunAbbrev '%s'  RunNumber %g", RunAbbrev, RunNumber )  }
	"Create 'East Facing' energy use summary component"		Proj:ResultSummary[3]			= {	CreateComp( EUseSummary, "East Facing" )  }
	"Set parent for energy use summary"								Proj:ResultSummary[3]:Parent	= {	Local( Name )  }
	"Set ProjAssignFirst for energy use summary"					Proj:ResultSummary[3]:ProjAssignFirst	= {	0  }		; SAC 3/3/16 - tic #609

;	"Blast all EnergyUse components if this is the first run of an analysis"	Proj:Action	= {	DeleteAllComps( EnergyUse )  }  ; ONLY for FIRST (North) run

	"Create result component - E-SpcHtg"		Proj:RunResultsE[1]					= {	CreateComp( EnergyUse, "E-EU-SpcHtg" )  }
	"Set parent for result   - E-SpcHtg"		Proj:RunResultsE[1]:Parent			= {	Local( Name )  }
	"Set EU name for result  - E-SpcHtg"		Proj:RunResultsE[1]:EnduseName	= {	"Space Heating"  }

	"Create result component - E-SpcClg"		Proj:RunResultsE[2]					= {	CreateComp( EnergyUse, "E-EU-SpcClg" )  }
	"Set parent for result   - E-SpcClg"		Proj:RunResultsE[2]:Parent			= {	Local( Name )  }
	"Set EU name for result  - E-SpcClg"		Proj:RunResultsE[2]:EnduseName	= {	"Space Cooling"  }

	"Create result component - E-IAQVent"		Proj:RunResultsE[3]					= {	CreateComp( EnergyUse, "E-EU-IAQVent" )  }
	"Set parent for result   - E-IAQVent"		Proj:RunResultsE[3]:Parent			= {	Local( Name )  }
	"Set EU name for result  - E-IAQVent"		Proj:RunResultsE[3]:EnduseName	= {	"IAQ Ventilation"  }

	"Create result component - E-Othr HVAC"	Proj:RunResultsE[4]					= {	CreateComp( EnergyUse, "E-EU-OthrHVAC" )  }
	"Set parent for result   - E-Othr HVAC"	Proj:RunResultsE[4]:Parent			= {	Local( Name )  }
	"Set EU name for result  - E-Othr HVAC"	Proj:RunResultsE[4]:EnduseName	= {	"Other HVAC"  }

	"Create result component - E-WtrHt"			Proj:RunResultsE[5]					= {	CreateComp( EnergyUse, "E-EU-WtrHt" )  }
	"Set parent for result   - E-WtrHt"			Proj:RunResultsE[5]:Parent			= {	Local( Name )  }
	"Set EU name for result  - E-WtrHt"			Proj:RunResultsE[5]:EnduseName	= {	"Water Heating"  }

	"Create result component - E-InsLtg"		Proj:RunResultsE[6]					= {	CreateComp( EnergyUse, "E-EU-InsLtg" )  }
	"Set parent for result   - E-InsLtg"		Proj:RunResultsE[6]:Parent			= {	Local( Name )  }
	"Set EU name for result  - E-InsLtg"		Proj:RunResultsE[6]:EnduseName	= {	"Inside Lighting"  }

	"Create result component - E-AppCkg"		Proj:RunResultsE[7]					= {	CreateComp( EnergyUse, "E-EU-AppCkg" )  }
	"Set parent for result   - E-AppCkg"		Proj:RunResultsE[7]:Parent			= {	Local( Name )  }
	"Set EU name for result  - E-AppCkg"		Proj:RunResultsE[7]:EnduseName	= {	"Appl. & Cooking"  }

	"Create result component - E-Plugs"			Proj:RunResultsE[8]					= {	CreateComp( EnergyUse, "E-EU-Plugs" )  }
	"Set parent for result   - E-Plugs"			Proj:RunResultsE[8]:Parent			= {	Local( Name )  }
	"Set EU name for result  - E-Plugs"			Proj:RunResultsE[8]:EnduseName	= {	"Plug Loads"  }

	"Create result component - E-Ext"			Proj:RunResultsE[9]					= {	CreateComp( EnergyUse, "E-EU-Ext" )  }
	"Set parent for result   - E-Ext"			Proj:RunResultsE[9]:Parent			= {	Local( Name )  }
	"Set EU name for result  - E-Ext"			Proj:RunResultsE[9]:EnduseName	= {	"Exterior"  }

	"Create result component - E-Total"			Proj:RunResultsE[10]					= {	CreateComp( EnergyUse, "E-EU-Total" )  }
	"Set parent for result   - E-Total"			Proj:RunResultsE[10]:Parent		= {	Local( Name )  }
	"Set EU name for result  - E-Total"			Proj:RunResultsE[10]:EnduseName	= {	"TOTAL"  }

	"Create result component - E-Comp Ttl"		Proj:RunResultsE[11]					= {	CreateComp( EnergyUse, "E-EU-Compliance" )  }
	"Set parent for result   - E-Comp Ttl"		Proj:RunResultsE[11]:Parent		= {	Local( Name )  }
	"Set EU name for result  - E-Comp Ttl"		Proj:RunResultsE[11]:EnduseName	= {	"Compliance Total"  }

	"Create result component - E-PV Ttl"		Proj:RunResultsE[13]					= {	CreateComp( EnergyUse, "E-EU-PV" )  }
	"Set parent for result   - E-PV Ttl"		Proj:RunResultsE[13]:Parent		= {	Local( Name )  }
	"Set EU name for result  - E-PV Ttl"		Proj:RunResultsE[13]:EnduseName	= {	"Photovoltaics"  }

	"Create result component - E-Batt Ttl"		Proj:RunResultsE[14]					= {	CreateComp( EnergyUse, "E-EU-Battery" )  }
	"Set parent for result   - E-Batt Ttl"		Proj:RunResultsE[14]:Parent		= {	Local( Name )  }
	"Set EU name for result  - E-Batt Ttl"		Proj:RunResultsE[14]:EnduseName	= {	"Battery"  }

;"dbg BEMProc details"		Proj:Action = {  StoreBEMProc( Format( "aft CARes_Refresh_RunResults_E for %s", RunAbbrev ), 0 )  }
END

;*************************************************************************		- SAC 6/25/13
RULELIST "CARes_ProposedResults_E" 1 0 1 1
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
;*************************************************************************
;"debug"  Proj:Action = {  PostMessageToLog( "  evaluating 'CARes_ProposedResults_E':  RunAbbrev '%s'  RunNumber %g", RunAbbrev, RunNumber )  }
   ; SAC 1/5/18 - moved rules to blast and re-create RunResults objects into subordinate list to initiate either from here or StdMixdFuel run rules
   "Refresh RunResults-E objects"  Proj:Action  = {
         if (ComponentCount( EUseSummary ) > 2 .AND. ComponentCount( EnergyUse ) > 20) then  UNCHANGED
         else  EvalRulelist( "CARes_Refresh_RunResults_E" )  endif  }

  ; Space Heating (& heating fan)
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
	"Store energy use - Elec   - E-SpcHt"		Proj:RunResultsE[1]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Htg", "HPBU", "FanH",   "Aux", "Fan" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - E-SpcHt"		Proj:RunResultsE[1]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Htg", "HPBU", "Aux"         ) / CondFloorArea  endif  }
	"Store energy use - Other  - E-SpcHt"		Proj:RunResultsE[1]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Htg", "HPBU",  "Aux"         ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - E-SpcHt"		Proj:RunResultsE[1]:PropTotalEnergy[1]		= {	LocalRef( RunResultsE[1]:PropElecEnergy[1] ) + LocalRef( RunResultsE[1]:PropNatGasEnergy[1] ) + LocalRef( RunResultsE[1]:PropOtherEnergy[1] )   }

  ; Space Cooling (& cooling fan)
	"Store energy use - Elec   - E-SpcCl"		Proj:RunResultsE[2]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - E-SpcCl"		Proj:RunResultsE[2]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Clg"         ) / CondFloorArea  endif  }
	"Store energy use - Other  - E-SpcCl"		Proj:RunResultsE[2]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Clg"         ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - E-SpcCl"		Proj:RunResultsE[2]:PropTotalEnergy[1]		= {	LocalRef( RunResultsE[2]:PropElecEnergy[1] ) + LocalRef( RunResultsE[2]:PropNatGasEnergy[1] ) + LocalRef( RunResultsE[2]:PropOtherEnergy[1] )   }

  ; IAQ Ventilation Fans
	"Store energy use - Elec   - E-IAQVent"	Proj:RunResultsE[3]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "FanV" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - E-IAQVent"	Proj:RunResultsE[3]:PropNatGasEnergy[1]	= {	0  }
	"Store energy use - Other  - E-IAQVent"	Proj:RunResultsE[3]:PropOtherEnergy[1]		= {	0  }
	"Store energy use - TOTAL  - E-IAQVent"	Proj:RunResultsE[3]:PropTotalEnergy[1]		= {	LocalRef( RunResultsE[3]:PropElecEnergy[1] )   }

  ; Other HVAC (aux & misc fans)
; SAC 11/8/18 - restored "Other HVAC" [4] to handle VCHP CFan via "User1" enduse
	"Store energy use - Elec   - E-OthrHVAC"	Proj:RunResultsE[4]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "User1" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - E-OthrHVAC"	Proj:RunResultsE[4]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "User1" ) / CondFloorArea  endif  }
	"Store energy use - Other  - E-OthrHVAC"	Proj:RunResultsE[4]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "User1" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - E-OthrHVAC"	Proj:RunResultsE[4]:PropTotalEnergy[1]		= {	LocalRef( RunResultsE[4]:PropElecEnergy[1] ) + LocalRef( RunResultsE[4]:PropNatGasEnergy[1] ) + LocalRef( RunResultsE[4]:PropOtherEnergy[1] )   }

; SAC 1/27/19 - REDISTRIBUTE OthrHVAC Prop energy use across SpcHt & SpcCl by fuel based on ratio of total energy use (across all fuels) (tic #1053)
   "Set OthrHVAC_SpcHtFrac - E-PropEnergy"   Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResultsE[4]:PropTotalEnergy[1] != 0 )==0) then  0
                                                                           else if (IfValidAnd( RunResultsE[1]:PropTotalEnergy[1] == 0 ) .AND.
                                                                                    IfValidAnd( RunResultsE[2]:PropTotalEnergy[1] == 0 )) then  0.5
                                                                           else   ValidOr( RunResultsE[1]:PropTotalEnergy[1], 0 ) / 
                                                                                 (ValidOr( RunResultsE[1]:PropTotalEnergy[1], 0 ) + ValidOr( RunResultsE[2]:PropTotalEnergy[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Elec   - E-SpcHt"		Proj:RunResultsE[1]:PropElecEnergy[1]	= {   if (IfValidAnd( RunResultsE[4]:PropElecEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsE[1]:PropElecEnergy[1] + (RunResultsE[4]:PropElecEnergy[1]     * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - NatGas - E-SpcHt"		Proj:RunResultsE[1]:PropNatGasEnergy[1] ={   if (IfValidAnd( RunResultsE[4]:PropNatGasEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsE[1]:PropNatGasEnergy[1] + (RunResultsE[4]:PropNatGasEnergy[1] * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - Other  - E-SpcHt"		Proj:RunResultsE[1]:PropOtherEnergy[1]	= {   if (IfValidAnd( RunResultsE[4]:PropOtherEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsE[1]:PropOtherEnergy[1] + (RunResultsE[4]:PropOtherEnergy[1]   * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - TOTAL  - E-SpcHt"		Proj:RunResultsE[1]:PropTotalEnergy[1]	= {	LocalRef( RunResultsE[1]:PropElecEnergy[1] ) + LocalRef( RunResultsE[1]:PropNatGasEnergy[1] ) + LocalRef( RunResultsE[1]:PropOtherEnergy[1] )   }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Elec   - E-SpcCl"		Proj:RunResultsE[2]:PropElecEnergy[1]	= {   if (IfValidAnd( RunResultsE[4]:PropElecEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsE[2]:PropElecEnergy[1] + (RunResultsE[4]:PropElecEnergy[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - NatGas - E-SpcCl"		Proj:RunResultsE[2]:PropNatGasEnergy[1] ={   if (IfValidAnd( RunResultsE[4]:PropNatGasEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsE[2]:PropNatGasEnergy[1] + (RunResultsE[4]:PropNatGasEnergy[1] * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - Other  - E-SpcCl"		Proj:RunResultsE[2]:PropOtherEnergy[1]	= {   if (IfValidAnd( RunResultsE[4]:PropOtherEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsE[2]:PropOtherEnergy[1] + (RunResultsE[4]:PropOtherEnergy[1]   * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - TOTAL  - E-SpcCl"		Proj:RunResultsE[2]:PropTotalEnergy[1]	= {	LocalRef( RunResultsE[2]:PropElecEnergy[1] ) + LocalRef( RunResultsE[2]:PropNatGasEnergy[1] ) + LocalRef( RunResultsE[2]:PropOtherEnergy[1] )   }
  ; Other HVAC (aux & misc fans)
	"ZERO-OUT         - Elec   - E-OthrHVAC"	Proj:RunResultsE[4]:PropElecEnergy[1]	= {	0  }
	"ZERO-OUT         - NatGas - E-OthrHVAC"	Proj:RunResultsE[4]:PropNatGasEnergy[1] ={	0  }
	"ZERO-OUT         - Other  - E-OthrHVAC"	Proj:RunResultsE[4]:PropOtherEnergy[1]	= {	0  }
	"ZERO-OUT         - TOTAL  - E-OthrHVAC"	Proj:RunResultsE[4]:PropTotalEnergy[1]	= {	0  }
   ; SAC 1/27/19 - end of - redistribution of OthrHVAC PropEnergy

  ; Water Heating
	"Store energy use - Elec   - E-WtrHt"		Proj:RunResultsE[5]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else if (CSEinclDHWMFL_EU)
			 			  																							   then  HourlyResultSum( RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / CondFloorArea
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / CondFloorArea  endif endif  }
	"Store energy use - NatGas - E-WtrHt"		Proj:RunResultsE[5]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea  endif  }
	"Store energy use - Other  - E-WtrHt"		Proj:RunResultsE[5]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - E-WtrHt"		Proj:RunResultsE[5]:PropTotalEnergy[1]		= {	LocalRef( RunResultsE[5]:PropElecEnergy[1] ) + LocalRef( RunResultsE[5]:PropNatGasEnergy[1] ) + LocalRef( RunResultsE[5]:PropOtherEnergy[1] )   }

  ; Inside Lighting
	"Store energy use - Elec   - E-InsLtg"		Proj:RunResultsE[6]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Lit" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - E-InsLtg"		Proj:RunResultsE[6]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Lit" ) / CondFloorArea  endif  }
	"Store energy use - Other  - E-InsLtg"		Proj:RunResultsE[6]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Lit" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - E-InsLtg"		Proj:RunResultsE[6]:PropTotalEnergy[1]		= {	LocalRef( RunResultsE[6]:PropElecEnergy[1] ) + LocalRef( RunResultsE[6]:PropNatGasEnergy[1] ) + LocalRef( RunResultsE[6]:PropOtherEnergy[1] )   }

  ; Appliances & Cooking
	"Store energy use - Elec   - E-AppCkg"		Proj:RunResultsE[7]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - E-AppCkg"		Proj:RunResultsE[7]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea  endif  }
	"Store energy use - Other  - E-AppCkg"		Proj:RunResultsE[7]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - E-AppCkg"		Proj:RunResultsE[7]:PropTotalEnergy[1]		= {	LocalRef( RunResultsE[7]:PropElecEnergy[1] ) + LocalRef( RunResultsE[7]:PropNatGasEnergy[1] ) + LocalRef( RunResultsE[7]:PropOtherEnergy[1] )   }

  ; Plug Loads
	"Store energy use - Elec   - E-Plugs"		Proj:RunResultsE[8]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Rcp" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - E-Plugs"		Proj:RunResultsE[8]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Rcp" ) / CondFloorArea  endif  }
	"Store energy use - Other  - E-Plugs"		Proj:RunResultsE[8]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Rcp" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - E-Plugs"		Proj:RunResultsE[8]:PropTotalEnergy[1]		= {	LocalRef( RunResultsE[8]:PropElecEnergy[1] ) + LocalRef( RunResultsE[8]:PropNatGasEnergy[1] ) + LocalRef( RunResultsE[8]:PropOtherEnergy[1] )   }

  ; Exterior
	"Store energy use - Elec   - E-Ext"			Proj:RunResultsE[9]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Ext" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - E-Ext"			Proj:RunResultsE[9]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Ext" ) / CondFloorArea  endif  }
	"Store energy use - Other  - E-Ext"			Proj:RunResultsE[9]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Ext" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - E-Ext"			Proj:RunResultsE[9]:PropTotalEnergy[1]		= {	LocalRef( RunResultsE[9]:PropElecEnergy[1] ) + LocalRef( RunResultsE[9]:PropNatGasEnergy[1] ) + LocalRef( RunResultsE[9]:PropOtherEnergy[1] )   }

  ; PV
	"Store energy use - Elec   - E-PV"			Proj:RunResultsE[13]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec ) < 0.5 .OR. CondFloorArea < 1) then  0
                                                                                          else if (CommunitySolarProjID > 0 .AND. IfValidAnd( CmntySlr_ElecEnergy < 0 )) then  CmntySlr_ElecEnergy * PVWDCSizeMultiplier[1] * 3.412 / CondFloorArea
			 			  																								else  HourlyResultSum( RunID, "MtrElec", "PV" ) / CondFloorArea  endif endif  }
	"Store energy use - NatGas - E-PV"			Proj:RunResultsE[13]:PropNatGasEnergy[1]	= {	0  }
	"Store energy use - Other  - E-PV"			Proj:RunResultsE[13]:PropOtherEnergy[1]	= {	0  }
	"Store energy use - TOTAL  - E-PV"			Proj:RunResultsE[13]:PropTotalEnergy[1]	= {	LocalRef( RunResultsE[13]:PropElecEnergy[1] )   }

  ; Battery
	"Store energy use - Elec   - E-Battery"	Proj:RunResultsE[14]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec", "BT" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - E-Battery"	Proj:RunResultsE[14]:PropNatGasEnergy[1]	= {	0  }
	"Store energy use - Other  - E-Battery"	Proj:RunResultsE[14]:PropOtherEnergy[1]	= {	0  }
	"Store energy use - TOTAL  - E-Battery"	Proj:RunResultsE[14]:PropTotalEnergy[1]	= {	LocalRef( RunResultsE[14]:PropElecEnergy[1] )   }

  ; Compliance Total
	"Store energy use - Elec   - E-Comp Ttl"	Proj:RunResultsE[11]:PropElecEnergy[1]		= {	RunResultsE[1]:PropElecEnergy[1]   + RunResultsE[2]:PropElecEnergy[1]   + RunResultsE[3]:PropElecEnergy[1]   + RunResultsE[4]:PropElecEnergy[1]   + RunResultsE[5]:PropElecEnergy[1]    }
	"Store energy use - NatGas - E-Comp Ttl"	Proj:RunResultsE[11]:PropNatGasEnergy[1]	= {	RunResultsE[1]:PropNatGasEnergy[1] + RunResultsE[2]:PropNatGasEnergy[1] + RunResultsE[3]:PropNatGasEnergy[1] + RunResultsE[4]:PropNatGasEnergy[1] + RunResultsE[5]:PropNatGasEnergy[1]  }
	"Store energy use - Other  - E-Comp Ttl"	Proj:RunResultsE[11]:PropOtherEnergy[1]	= {	RunResultsE[1]:PropOtherEnergy[1]  + RunResultsE[2]:PropOtherEnergy[1]  + RunResultsE[3]:PropOtherEnergy[1]  + RunResultsE[4]:PropOtherEnergy[1]  + RunResultsE[5]:PropOtherEnergy[1]   }
	"Store energy use - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:PropTotalEnergy[1]	= {	RunResultsE[1]:PropTotalEnergy[1]  + RunResultsE[2]:PropTotalEnergy[1]  + RunResultsE[3]:PropTotalEnergy[1]  + RunResultsE[4]:PropTotalEnergy[1]  + RunResultsE[5]:PropTotalEnergy[1]   }
;   ; SAC 10/6/16 - 2019 updates
;	"Add in PV - Elec   - E-Comp Ttl"	      Proj:RunResultsE[11]:PropElecEnergy[1]		= {	if (EnergyCodeYearNum < 2019) then  UNCHANGED
;                                                                                             else  RunResultsE[11]:PropElecEnergy[1]  + RunResultsE[13]:PropElecEnergy[1]  + RunResultsE[14]:PropElecEnergy[1]   endif   }
;	"Add in PV - TOTAL  - E-Comp Ttl"	      Proj:RunResultsE[11]:PropTotalEnergy[1]	= {	if (EnergyCodeYearNum < 2019) then  UNCHANGED
;                                                                                             else  RunResultsE[11]:PropTotalEnergy[1] + RunResultsE[13]:PropTotalEnergy[1] + RunResultsE[14]:PropTotalEnergy[1]  endif   }

  ; Total
	"Store energy use - Elec   - E-Total"		Proj:RunResultsE[10]:PropElecEnergy[1]		= {	RunResultsE[11]:PropElecEnergy[1]   + RunResultsE[6]:PropElecEnergy[1]   + RunResultsE[7]:PropElecEnergy[1]   + RunResultsE[8]:PropElecEnergy[1]   + RunResultsE[9]:PropElecEnergy[1]    }
	"Store energy use - NatGas - E-Total"		Proj:RunResultsE[10]:PropNatGasEnergy[1]	= {	RunResultsE[11]:PropNatGasEnergy[1] + RunResultsE[6]:PropNatGasEnergy[1] + RunResultsE[7]:PropNatGasEnergy[1] + RunResultsE[8]:PropNatGasEnergy[1] + RunResultsE[9]:PropNatGasEnergy[1]  }
	"Store energy use - Other  - E-Total"		Proj:RunResultsE[10]:PropOtherEnergy[1]	= {	RunResultsE[11]:PropOtherEnergy[1]  + RunResultsE[6]:PropOtherEnergy[1]  + RunResultsE[7]:PropOtherEnergy[1]  + RunResultsE[8]:PropOtherEnergy[1]  + RunResultsE[9]:PropOtherEnergy[1]   }
	"Store energy use - TOTAL  - E-Total"		Proj:RunResultsE[10]:PropTotalEnergy[1]	= {	RunResultsE[11]:PropTotalEnergy[1]  + RunResultsE[6]:PropTotalEnergy[1]  + RunResultsE[7]:PropTotalEnergy[1]  + RunResultsE[8]:PropTotalEnergy[1]  + RunResultsE[9]:PropTotalEnergy[1]   }
   ; SAC 4/28/17 - shifted PV & Batt from CompTot to Tot for 2019
   ; SAC 4/28/17 - add in only Battery to Total for 2016
	"Add in PV/Batt - Elec   - E-Total"	      Proj:RunResultsE[10]:PropElecEnergy[1]		= {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                             else if (EnergyCodeYearNum < 2019) 
                                                                                             then  RunResultsE[10]:PropElecEnergy[1]  + RunResultsE[14]:PropElecEnergy[1]
                                                                                             else  RunResultsE[10]:PropElecEnergy[1]  + RunResultsE[13]:PropElecEnergy[1]  + RunResultsE[14]:PropElecEnergy[1]   endif endif   }
	"Add in PV/Batt - TOTAL  - E-Total"	      Proj:RunResultsE[10]:PropTotalEnergy[1]	= {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                             else if (EnergyCodeYearNum < 2019) 
                                                                                             then  RunResultsE[10]:PropTotalEnergy[1] + RunResultsE[14]:PropTotalEnergy[1]
                                                                                             else  RunResultsE[10]:PropTotalEnergy[1] + RunResultsE[13]:PropTotalEnergy[1] + RunResultsE[14]:PropTotalEnergy[1]  endif endif   }

   "Store Proj:AnalysisVersion to EUseSummary-E"   Proj:ResultSummary[3]:ResultsAnalysisVer = {  ValidOr( Proj:AnalysisVersion, 0 )  }    ; SAC 11/28/22
   "Store Proj:AllOrientations to EUseSummary-E"   Proj:ResultSummary[3]:AllOrientations    = {  ValidOr( Proj:AllOrientations, 0 )  }

   ; SAC 1/19/18 - add reporting proposed PV cap
   "Store size of PV system actually analyzed-E"      Proj:ResultSummary[3]:PropDesignPVTot  = {
         if ( (EnergyCodeYearNum < 2019 .AND.
               (IfValidAnd( AllowDesignRating > 0.5 )==0 .OR. IfValidAnd( DesignRatingCalcs > 0.5 )==0)) .OR.
              IfValidAnd( PVWDCSysTotal > 0 )==0 )
         then  UNDEFINED
         else	PVWDCSysTotal * ValidOr( PVWDCSizeMultiplier[1], 1 )  endif  }

   "Store Proposed model Battery capacity-E"      Proj:ResultSummary[3]:PropDesignBattCap  =      ; SAC 11/26/22
      {  if ( (IfValidAnd( PVWDCSysTotal > 0 )==0 .AND. IfValidAnd( SimStandaloneBatt > 0 )==0 ) .OR. IfValidAnd( SimulateBattery > 0 )==0 .OR. 
              (IfValidAnd( SimulateBattery > 0 ) .AND. IfValidAnd( AllowBattRoundTripEff == 1) .AND. IfValidAnd( BattRoundTripEff < 0.8))) 
         then  UNDEFINED
         else  ValidOr( BattMaxCap, 0 )  endif  }
   "Store Proposed model Battery power-E"         Proj:ResultSummary[3]:PropDesignBattPwr  =
      {  if (IfValidAnd( ResultSummary[3]:PropDesignBattCap > 0 )==0) then  UNDEFINED
         else  (ValidOr( BattMaxChgPwr, 0 ) + ValidOr( BattMaxDschgPwr, 0 )) / 2  endif  }
END


;*************************************************************************
RULELIST "CARes_Refresh_RunResults_S" 1 0 0 1
;*************************************************************************
;"debug"  Proj:Action = {  PostMessageToLog( "  evaluating 'CARes_Refresh_RunResults_S':  RunAbbrev '%s'  RunNumber %g", RunAbbrev, RunNumber )  }
	"Create 'South Facing' energy use summary component"		Proj:ResultSummary[4]			= {	CreateComp( EUseSummary, "South Facing" )  }
	"Set parent for energy use summary"								Proj:ResultSummary[4]:Parent	= {	Local( Name )  }
	"Set ProjAssignFirst for energy use summary"					Proj:ResultSummary[4]:ProjAssignFirst	= {	0  }		; SAC 3/3/16 - tic #609

;	"Blast all EnergyUse components if this is the first run of an analysis"	Proj:Action	= {	DeleteAllComps( EnergyUse )  }  ; ONLY for FIRST (North) run

	"Create result component - S-SpcHtg"		Proj:RunResultsS[1]					= {	CreateComp( EnergyUse, "S-EU-SpcHtg" )  }
	"Set parent for result   - S-SpcHtg"		Proj:RunResultsS[1]:Parent			= {	Local( Name )  }
	"Set EU name for result  - S-SpcHtg"		Proj:RunResultsS[1]:EnduseName	= {	"Space Heating"  }

	"Create result component - S-SpcClg"		Proj:RunResultsS[2]					= {	CreateComp( EnergyUse, "S-EU-SpcClg" )  }
	"Set parent for result   - S-SpcClg"		Proj:RunResultsS[2]:Parent			= {	Local( Name )  }
	"Set EU name for result  - S-SpcClg"		Proj:RunResultsS[2]:EnduseName	= {	"Space Cooling"  }

	"Create result component - S-IAQVent"		Proj:RunResultsS[3]					= {	CreateComp( EnergyUse, "S-EU-IAQVent" )  }
	"Set parent for result   - S-IAQVent"		Proj:RunResultsS[3]:Parent			= {	Local( Name )  }
	"Set EU name for result  - S-IAQVent"		Proj:RunResultsS[3]:EnduseName	= {	"IAQ Ventilation"  }

	"Create result component - S-Othr HVAC"	Proj:RunResultsS[4]					= {	CreateComp( EnergyUse, "S-EU-OthrHVAC" )  }
	"Set parent for result   - S-Othr HVAC"	Proj:RunResultsS[4]:Parent			= {	Local( Name )  }
	"Set EU name for result  - S-Othr HVAC"	Proj:RunResultsS[4]:EnduseName	= {	"Other HVAC"  }

	"Create result component - S-WtrHt"			Proj:RunResultsS[5]					= {	CreateComp( EnergyUse, "S-EU-WtrHt" )  }
	"Set parent for result   - S-WtrHt"			Proj:RunResultsS[5]:Parent			= {	Local( Name )  }
	"Set EU name for result  - S-WtrHt"			Proj:RunResultsS[5]:EnduseName	= {	"Water Heating"  }

	"Create result component - S-InsLtg"		Proj:RunResultsS[6]					= {	CreateComp( EnergyUse, "S-EU-InsLtg" )  }
	"Set parent for result   - S-InsLtg"		Proj:RunResultsS[6]:Parent			= {	Local( Name )  }
	"Set EU name for result  - S-InsLtg"		Proj:RunResultsS[6]:EnduseName	= {	"Inside Lighting"  }

	"Create result component - S-AppCkg"		Proj:RunResultsS[7]					= {	CreateComp( EnergyUse, "S-EU-AppCkg" )  }
	"Set parent for result   - S-AppCkg"		Proj:RunResultsS[7]:Parent			= {	Local( Name )  }
	"Set EU name for result  - S-AppCkg"		Proj:RunResultsS[7]:EnduseName	= {	"Appl. & Cooking"  }

	"Create result component - S-Plugs"			Proj:RunResultsS[8]					= {	CreateComp( EnergyUse, "S-EU-Plugs" )  }
	"Set parent for result   - S-Plugs"			Proj:RunResultsS[8]:Parent			= {	Local( Name )  }
	"Set EU name for result  - S-Plugs"			Proj:RunResultsS[8]:EnduseName	= {	"Plug Loads"  }

	"Create result component - S-Ext"			Proj:RunResultsS[9]					= {	CreateComp( EnergyUse, "S-EU-Ext" )  }
	"Set parent for result   - S-Ext"			Proj:RunResultsS[9]:Parent			= {	Local( Name )  }
	"Set EU name for result  - S-Ext"			Proj:RunResultsS[9]:EnduseName	= {	"Exterior"  }

	"Create result component - S-Total"			Proj:RunResultsS[10]					= {	CreateComp( EnergyUse, "S-EU-Total" )  }
	"Set parent for result   - S-Total"			Proj:RunResultsS[10]:Parent		= {	Local( Name )  }
	"Set EU name for result  - S-Total"			Proj:RunResultsS[10]:EnduseName	= {	"TOTAL"  }

	"Create result component - S-Comp Ttl"		Proj:RunResultsS[11]					= {	CreateComp( EnergyUse, "S-EU-Compliance" )  }
	"Set parent for result   - S-Comp Ttl"		Proj:RunResultsS[11]:Parent		= {	Local( Name )  }
	"Set EU name for result  - S-Comp Ttl"		Proj:RunResultsS[11]:EnduseName	= {	"Compliance Total"  }

	"Create result component - S-PV Ttl"		Proj:RunResultsS[13]					= {	CreateComp( EnergyUse, "S-EU-PV" )  }
	"Set parent for result   - S-PV Ttl"		Proj:RunResultsS[13]:Parent		= {	Local( Name )  }
	"Set EU name for result  - S-PV Ttl"		Proj:RunResultsS[13]:EnduseName	= {	"Photovoltaics"  }

	"Create result component - S-Batt Ttl"		Proj:RunResultsS[14]					= {	CreateComp( EnergyUse, "S-EU-Battery" )  }
	"Set parent for result   - S-Batt Ttl"		Proj:RunResultsS[14]:Parent		= {	Local( Name )  }
	"Set EU name for result  - S-Batt Ttl"		Proj:RunResultsS[14]:EnduseName	= {	"Battery"  }

;"dbg BEMProc details"		Proj:Action = {  StoreBEMProc( Format( "aft CARes_Refresh_RunResults_S for %s", RunAbbrev ), 0 )  }
END

;*************************************************************************		- SAC 6/25/13
RULELIST "CARes_ProposedResults_S" 1 0 1 1
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
;*************************************************************************
;"debug"  Proj:Action = {  PostMessageToLog( "  evaluating 'CARes_ProposedResults_S':  RunAbbrev '%s'  RunNumber %g", RunAbbrev, RunNumber )  }
   ; SAC 1/5/18 - moved rules to blast and re-create RunResults objects into subordinate list to initiate either from here or StdMixdFuel run rules
   "Refresh RunResults-S objects"  Proj:Action  = {
         if (ComponentCount( EUseSummary ) > 3 .AND. ComponentCount( EnergyUse ) > 30) then  UNCHANGED
         else  EvalRulelist( "CARes_Refresh_RunResults_S" )  endif  }

  ; Space Heating (& heating fan)
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
	"Store energy use - Elec   - S-SpcHt"		Proj:RunResultsS[1]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Htg", "HPBU", "FanH",   "Aux", "Fan" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - S-SpcHt"		Proj:RunResultsS[1]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Htg", "HPBU", "Aux"         ) / CondFloorArea  endif  }
	"Store energy use - Other  - S-SpcHt"		Proj:RunResultsS[1]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Htg", "HPBU",  "Aux"         ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - S-SpcHt"		Proj:RunResultsS[1]:PropTotalEnergy[1]		= {	LocalRef( RunResultsS[1]:PropElecEnergy[1] ) + LocalRef( RunResultsS[1]:PropNatGasEnergy[1] ) + LocalRef( RunResultsS[1]:PropOtherEnergy[1] )   }

  ; Space Cooling (& cooling fan)
	"Store energy use - Elec   - S-SpcCl"		Proj:RunResultsS[2]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - S-SpcCl"		Proj:RunResultsS[2]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Clg"         ) / CondFloorArea  endif  }
	"Store energy use - Other  - S-SpcCl"		Proj:RunResultsS[2]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Clg"         ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - S-SpcCl"		Proj:RunResultsS[2]:PropTotalEnergy[1]		= {	LocalRef( RunResultsS[2]:PropElecEnergy[1] ) + LocalRef( RunResultsS[2]:PropNatGasEnergy[1] ) + LocalRef( RunResultsS[2]:PropOtherEnergy[1] )   }

  ; IAQ Ventilation Fans
	"Store energy use - Elec   - S-IAQVent"	Proj:RunResultsS[3]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "FanV" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - S-IAQVent"	Proj:RunResultsS[3]:PropNatGasEnergy[1]	= {	0  }
	"Store energy use - Other  - S-IAQVent"	Proj:RunResultsS[3]:PropOtherEnergy[1]		= {	0  }
	"Store energy use - TOTAL  - S-IAQVent"	Proj:RunResultsS[3]:PropTotalEnergy[1]		= {	LocalRef( RunResultsS[3]:PropElecEnergy[1] )   }

  ; Other HVAC (aux & misc fans)
; SAC 11/8/18 - restored "Other HVAC" [4] to handle VCHP CFan via "User1" enduse
	"Store energy use - Elec   - S-OthrHVAC"	Proj:RunResultsS[4]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "User1" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - S-OthrHVAC"	Proj:RunResultsS[4]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "User1" ) / CondFloorArea  endif  }
	"Store energy use - Other  - S-OthrHVAC"	Proj:RunResultsS[4]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "User1" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - S-OthrHVAC"	Proj:RunResultsS[4]:PropTotalEnergy[1]		= {	LocalRef( RunResultsS[4]:PropElecEnergy[1] ) + LocalRef( RunResultsS[4]:PropNatGasEnergy[1] ) + LocalRef( RunResultsS[4]:PropOtherEnergy[1] )   }

; SAC 1/27/19 - REDISTRIBUTE OthrHVAC Prop energy use across SpcHt & SpcCl by fuel based on ratio of total energy use (across all fuels) (tic #1053)
   "Set OthrHVAC_SpcHtFrac - S-PropEnergy"   Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResultsS[4]:PropTotalEnergy[1] != 0 )==0) then  0
                                                                           else if (IfValidAnd( RunResultsS[1]:PropTotalEnergy[1] == 0 ) .AND.
                                                                                    IfValidAnd( RunResultsS[2]:PropTotalEnergy[1] == 0 )) then  0.5
                                                                           else   ValidOr( RunResultsS[1]:PropTotalEnergy[1], 0 ) / 
                                                                                 (ValidOr( RunResultsS[1]:PropTotalEnergy[1], 0 ) + ValidOr( RunResultsS[2]:PropTotalEnergy[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Elec   - S-SpcHt"		Proj:RunResultsS[1]:PropElecEnergy[1]	= {   if (IfValidAnd( RunResultsS[4]:PropElecEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsS[1]:PropElecEnergy[1] + (RunResultsS[4]:PropElecEnergy[1]     * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - NatGas - S-SpcHt"		Proj:RunResultsS[1]:PropNatGasEnergy[1] ={   if (IfValidAnd( RunResultsS[4]:PropNatGasEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsS[1]:PropNatGasEnergy[1] + (RunResultsS[4]:PropNatGasEnergy[1] * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - Other  - S-SpcHt"		Proj:RunResultsS[1]:PropOtherEnergy[1]	= {   if (IfValidAnd( RunResultsS[4]:PropOtherEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsS[1]:PropOtherEnergy[1] + (RunResultsS[4]:PropOtherEnergy[1]   * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - TOTAL  - S-SpcHt"		Proj:RunResultsS[1]:PropTotalEnergy[1]	= {	LocalRef( RunResultsS[1]:PropElecEnergy[1] ) + LocalRef( RunResultsS[1]:PropNatGasEnergy[1] ) + LocalRef( RunResultsS[1]:PropOtherEnergy[1] )   }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Elec   - S-SpcCl"		Proj:RunResultsS[2]:PropElecEnergy[1]	= {   if (IfValidAnd( RunResultsS[4]:PropElecEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsS[2]:PropElecEnergy[1] + (RunResultsS[4]:PropElecEnergy[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - NatGas - S-SpcCl"		Proj:RunResultsS[2]:PropNatGasEnergy[1] ={   if (IfValidAnd( RunResultsS[4]:PropNatGasEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsS[2]:PropNatGasEnergy[1] + (RunResultsS[4]:PropNatGasEnergy[1] * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - Other  - S-SpcCl"		Proj:RunResultsS[2]:PropOtherEnergy[1]	= {   if (IfValidAnd( RunResultsS[4]:PropOtherEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsS[2]:PropOtherEnergy[1] + (RunResultsS[4]:PropOtherEnergy[1]   * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - TOTAL  - S-SpcCl"		Proj:RunResultsS[2]:PropTotalEnergy[1]	= {	LocalRef( RunResultsS[2]:PropElecEnergy[1] ) + LocalRef( RunResultsS[2]:PropNatGasEnergy[1] ) + LocalRef( RunResultsS[2]:PropOtherEnergy[1] )   }
  ; Other HVAC (aux & misc fans)
	"ZERO-OUT         - Elec   - S-OthrHVAC"	Proj:RunResultsS[4]:PropElecEnergy[1]	= {	0  }
	"ZERO-OUT         - NatGas - S-OthrHVAC"	Proj:RunResultsS[4]:PropNatGasEnergy[1] ={	0  }
	"ZERO-OUT         - Other  - S-OthrHVAC"	Proj:RunResultsS[4]:PropOtherEnergy[1]	= {	0  }
	"ZERO-OUT         - TOTAL  - S-OthrHVAC"	Proj:RunResultsS[4]:PropTotalEnergy[1]	= {	0  }
   ; SAC 1/27/19 - end of - redistribution of OthrHVAC PropEnergy

  ; Water Heating
	"Store energy use - Elec   - S-WtrHt"		Proj:RunResultsS[5]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else if (CSEinclDHWMFL_EU)
			 			  																							   then  HourlyResultSum( RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / CondFloorArea
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / CondFloorArea  endif endif  }
	"Store energy use - NatGas - S-WtrHt"		Proj:RunResultsS[5]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea  endif  }
	"Store energy use - Other  - S-WtrHt"		Proj:RunResultsS[5]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - S-WtrHt"		Proj:RunResultsS[5]:PropTotalEnergy[1]		= {	LocalRef( RunResultsS[5]:PropElecEnergy[1] ) + LocalRef( RunResultsS[5]:PropNatGasEnergy[1] ) + LocalRef( RunResultsS[5]:PropOtherEnergy[1] )   }

  ; Inside Lighting
	"Store energy use - Elec   - S-InsLtg"		Proj:RunResultsS[6]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Lit" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - S-InsLtg"		Proj:RunResultsS[6]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Lit" ) / CondFloorArea  endif  }
	"Store energy use - Other  - S-InsLtg"		Proj:RunResultsS[6]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Lit" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - S-InsLtg"		Proj:RunResultsS[6]:PropTotalEnergy[1]		= {	LocalRef( RunResultsS[6]:PropElecEnergy[1] ) + LocalRef( RunResultsS[6]:PropNatGasEnergy[1] ) + LocalRef( RunResultsS[6]:PropOtherEnergy[1] )   }

  ; Appliances & Cooking
	"Store energy use - Elec   - S-AppCkg"		Proj:RunResultsS[7]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - S-AppCkg"		Proj:RunResultsS[7]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea  endif  }
	"Store energy use - Other  - S-AppCkg"		Proj:RunResultsS[7]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - S-AppCkg"		Proj:RunResultsS[7]:PropTotalEnergy[1]		= {	LocalRef( RunResultsS[7]:PropElecEnergy[1] ) + LocalRef( RunResultsS[7]:PropNatGasEnergy[1] ) + LocalRef( RunResultsS[7]:PropOtherEnergy[1] )   }

  ; Plug Loads
	"Store energy use - Elec   - S-Plugs"		Proj:RunResultsS[8]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Rcp" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - S-Plugs"		Proj:RunResultsS[8]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Rcp" ) / CondFloorArea  endif  }
	"Store energy use - Other  - S-Plugs"		Proj:RunResultsS[8]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Rcp" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - S-Plugs"		Proj:RunResultsS[8]:PropTotalEnergy[1]		= {	LocalRef( RunResultsS[8]:PropElecEnergy[1] ) + LocalRef( RunResultsS[8]:PropNatGasEnergy[1] ) + LocalRef( RunResultsS[8]:PropOtherEnergy[1] )   }

  ; Exterior
	"Store energy use - Elec   - S-Ext"			Proj:RunResultsS[9]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Ext" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - S-Ext"			Proj:RunResultsS[9]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Ext" ) / CondFloorArea  endif  }
	"Store energy use - Other  - S-Ext"			Proj:RunResultsS[9]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Ext" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - S-Ext"			Proj:RunResultsS[9]:PropTotalEnergy[1]		= {	LocalRef( RunResultsS[9]:PropElecEnergy[1] ) + LocalRef( RunResultsS[9]:PropNatGasEnergy[1] ) + LocalRef( RunResultsS[9]:PropOtherEnergy[1] )   }

  ; PV
	"Store energy use - Elec   - S-PV"			Proj:RunResultsS[13]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec ) < 0.5 .OR. CondFloorArea < 1) then  0
                                                                                          else if (CommunitySolarProjID > 0 .AND. IfValidAnd( CmntySlr_ElecEnergy < 0 )) then  CmntySlr_ElecEnergy * PVWDCSizeMultiplier[1] * 3.412 / CondFloorArea
			 			  																								else  HourlyResultSum( RunID, "MtrElec", "PV" ) / CondFloorArea  endif endif  }
	"Store energy use - NatGas - S-PV"			Proj:RunResultsS[13]:PropNatGasEnergy[1]	= {	0  }
	"Store energy use - Other  - S-PV"			Proj:RunResultsS[13]:PropOtherEnergy[1]	= {	0  }
	"Store energy use - TOTAL  - S-PV"			Proj:RunResultsS[13]:PropTotalEnergy[1]	= {	LocalRef( RunResultsS[13]:PropElecEnergy[1] )   }

  ; Battery
	"Store energy use - Elec   - S-Battery"	Proj:RunResultsS[14]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec", "BT" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - S-Battery"	Proj:RunResultsS[14]:PropNatGasEnergy[1]	= {	0  }
	"Store energy use - Other  - S-Battery"	Proj:RunResultsS[14]:PropOtherEnergy[1]	= {	0  }
	"Store energy use - TOTAL  - S-Battery"	Proj:RunResultsS[14]:PropTotalEnergy[1]	= {	LocalRef( RunResultsS[14]:PropElecEnergy[1] )   }

  ; Compliance Total
	"Store energy use - Elec   - S-Comp Ttl"	Proj:RunResultsS[11]:PropElecEnergy[1]		= {	RunResultsS[1]:PropElecEnergy[1]   + RunResultsS[2]:PropElecEnergy[1]   + RunResultsS[3]:PropElecEnergy[1]   + RunResultsS[4]:PropElecEnergy[1]   + RunResultsS[5]:PropElecEnergy[1]    }
	"Store energy use - NatGas - S-Comp Ttl"	Proj:RunResultsS[11]:PropNatGasEnergy[1]	= {	RunResultsS[1]:PropNatGasEnergy[1] + RunResultsS[2]:PropNatGasEnergy[1] + RunResultsS[3]:PropNatGasEnergy[1] + RunResultsS[4]:PropNatGasEnergy[1] + RunResultsS[5]:PropNatGasEnergy[1]  }
	"Store energy use - Other  - S-Comp Ttl"	Proj:RunResultsS[11]:PropOtherEnergy[1]	= {	RunResultsS[1]:PropOtherEnergy[1]  + RunResultsS[2]:PropOtherEnergy[1]  + RunResultsS[3]:PropOtherEnergy[1]  + RunResultsS[4]:PropOtherEnergy[1]  + RunResultsS[5]:PropOtherEnergy[1]   }
	"Store energy use - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:PropTotalEnergy[1]	= {	RunResultsS[1]:PropTotalEnergy[1]  + RunResultsS[2]:PropTotalEnergy[1]  + RunResultsS[3]:PropTotalEnergy[1]  + RunResultsS[4]:PropTotalEnergy[1]  + RunResultsS[5]:PropTotalEnergy[1]   }
;   ; SAC 10/6/16 - 2019 updates
;	"Add in PV - Elec   - S-Comp Ttl"	      Proj:RunResultsS[11]:PropElecEnergy[1]		= {	if (EnergyCodeYearNum < 2019) then  UNCHANGED
;                                                                                             else  RunResultsS[11]:PropElecEnergy[1]  + RunResultsS[13]:PropElecEnergy[1]  + RunResultsW[14]:PropTotalEnergy[1]  endif   }
;	"Add in PV - TOTAL  - S-Comp Ttl"	      Proj:RunResultsS[11]:PropTotalEnergy[1]	= {	if (EnergyCodeYearNum < 2019) then  UNCHANGED
;                                                                                             else  RunResultsS[11]:PropTotalEnergy[1] + RunResultsS[13]:PropTotalEnergy[1] + RunResultsS[14]:PropTotalEnergy[1]  endif   }

  ; Total
	"Store energy use - Elec   - S-Total"		Proj:RunResultsS[10]:PropElecEnergy[1]		= {	RunResultsS[11]:PropElecEnergy[1]   + RunResultsS[6]:PropElecEnergy[1]   + RunResultsS[7]:PropElecEnergy[1]   + RunResultsS[8]:PropElecEnergy[1]   + RunResultsS[9]:PropElecEnergy[1]    }
	"Store energy use - NatGas - S-Total"		Proj:RunResultsS[10]:PropNatGasEnergy[1]	= {	RunResultsS[11]:PropNatGasEnergy[1] + RunResultsS[6]:PropNatGasEnergy[1] + RunResultsS[7]:PropNatGasEnergy[1] + RunResultsS[8]:PropNatGasEnergy[1] + RunResultsS[9]:PropNatGasEnergy[1]  }
	"Store energy use - Other  - S-Total"		Proj:RunResultsS[10]:PropOtherEnergy[1]	= {	RunResultsS[11]:PropOtherEnergy[1]  + RunResultsS[6]:PropOtherEnergy[1]  + RunResultsS[7]:PropOtherEnergy[1]  + RunResultsS[8]:PropOtherEnergy[1]  + RunResultsS[9]:PropOtherEnergy[1]   }
	"Store energy use - TOTAL  - S-Total"		Proj:RunResultsS[10]:PropTotalEnergy[1]	= {	RunResultsS[11]:PropTotalEnergy[1]  + RunResultsS[6]:PropTotalEnergy[1]  + RunResultsS[7]:PropTotalEnergy[1]  + RunResultsS[8]:PropTotalEnergy[1]  + RunResultsS[9]:PropTotalEnergy[1]   }
   ; SAC 4/28/17 - shifted PV & Batt from CompTot to Tot for 2019
   ; SAC 4/28/17 - add in only Battery to Total for 2016
	"Add in PV/Batt - Elec   - S-Total"	      Proj:RunResultsS[10]:PropElecEnergy[1]		= {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                             else if (EnergyCodeYearNum < 2019) 
                                                                                             then  RunResultsS[10]:PropElecEnergy[1]  + RunResultsS[14]:PropElecEnergy[1]
                                                                                             else  RunResultsS[10]:PropElecEnergy[1]  + RunResultsS[13]:PropElecEnergy[1]  + RunResultsS[14]:PropElecEnergy[1]   endif endif   }
	"Add in PV/Batt - TOTAL  - S-Total"	      Proj:RunResultsS[10]:PropTotalEnergy[1]	= {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                             else if (EnergyCodeYearNum < 2019) 
                                                                                             then  RunResultsS[10]:PropTotalEnergy[1] + RunResultsS[14]:PropTotalEnergy[1]
                                                                                             else  RunResultsS[10]:PropTotalEnergy[1] + RunResultsS[13]:PropTotalEnergy[1] + RunResultsS[14]:PropTotalEnergy[1]  endif endif   }

   "Store Proj:AnalysisVersion to EUseSummary-S"   Proj:ResultSummary[4]:ResultsAnalysisVer = {  ValidOr( Proj:AnalysisVersion, 0 )  }    ; SAC 11/28/22
   "Store Proj:AllOrientations to EUseSummary-S"   Proj:ResultSummary[4]:AllOrientations    = {  ValidOr( Proj:AllOrientations, 0 )  }

   ; SAC 1/19/18 - add reporting proposed PV cap
   "Store size of PV system actually analyzed-S"      Proj:ResultSummary[4]:PropDesignPVTot  = {
         if ( (EnergyCodeYearNum < 2019 .AND.
               (IfValidAnd( AllowDesignRating > 0.5 )==0 .OR. IfValidAnd( DesignRatingCalcs > 0.5 )==0)) .OR.
              IfValidAnd( PVWDCSysTotal > 0 )==0 )
         then  UNDEFINED
         else	PVWDCSysTotal * ValidOr( PVWDCSizeMultiplier[1], 1 )  endif  }

   "Store Proposed model Battery capacity-S"      Proj:ResultSummary[4]:PropDesignBattCap  =      ; SAC 11/26/22
      {  if ( (IfValidAnd( PVWDCSysTotal > 0 )==0 .AND. IfValidAnd( SimStandaloneBatt > 0 )==0 ) .OR. IfValidAnd( SimulateBattery > 0 )==0 .OR. 
              (IfValidAnd( SimulateBattery > 0 ) .AND. IfValidAnd( AllowBattRoundTripEff == 1) .AND. IfValidAnd( BattRoundTripEff < 0.8))) 
         then  UNDEFINED
         else  ValidOr( BattMaxCap, 0 )  endif  }
   "Store Proposed model Battery power-S"         Proj:ResultSummary[4]:PropDesignBattPwr  =
      {  if (IfValidAnd( ResultSummary[4]:PropDesignBattCap > 0 )==0) then  UNDEFINED
         else  (ValidOr( BattMaxChgPwr, 0 ) + ValidOr( BattMaxDschgPwr, 0 )) / 2  endif  }
END


;*************************************************************************
RULELIST "CARes_Refresh_RunResults_W" 1 0 0 1
;*************************************************************************
;"debug"  Proj:Action = {  PostMessageToLog( "  evaluating 'CARes_Refresh_RunResults_W':  RunAbbrev '%s'  RunNumber %g", RunAbbrev, RunNumber )  }
	"Create 'West Facing' energy use summary component"		Proj:ResultSummary[5]			= {	CreateComp( EUseSummary, "West Facing" )  }
	"Set parent for energy use summary"								Proj:ResultSummary[5]:Parent	= {	Local( Name )  }
	"Set ProjAssignFirst for energy use summary"					Proj:ResultSummary[5]:ProjAssignFirst	= {	0  }		; SAC 3/3/16 - tic #609

;	"Blast all EnergyUse components if this is the first run of an analysis"	Proj:Action	= {	DeleteAllComps( EnergyUse )  }  ; ONLY for FIRST (North) run

	"Create result component - W-SpcHtg"		Proj:RunResultsW[1]					= {	CreateComp( EnergyUse, "W-EU-SpcHtg" )  }
	"Set parent for result   - W-SpcHtg"		Proj:RunResultsW[1]:Parent			= {	Local( Name )  }
	"Set EU name for result  - W-SpcHtg"		Proj:RunResultsW[1]:EnduseName	= {	"Space Heating"  }

	"Create result component - W-SpcClg"		Proj:RunResultsW[2]					= {	CreateComp( EnergyUse, "W-EU-SpcClg" )  }
	"Set parent for result   - W-SpcClg"		Proj:RunResultsW[2]:Parent			= {	Local( Name )  }
	"Set EU name for result  - W-SpcClg"		Proj:RunResultsW[2]:EnduseName	= {	"Space Cooling"  }

	"Create result component - W-IAQVent"		Proj:RunResultsW[3]					= {	CreateComp( EnergyUse, "W-EU-IAQVent" )  }
	"Set parent for result   - W-IAQVent"		Proj:RunResultsW[3]:Parent			= {	Local( Name )  }
	"Set EU name for result  - W-IAQVent"		Proj:RunResultsW[3]:EnduseName	= {	"IAQ Ventilation"  }

	"Create result component - W-Othr HVAC"	Proj:RunResultsW[4]					= {	CreateComp( EnergyUse, "W-EU-OthrHVAC" )  }
	"Set parent for result   - W-Othr HVAC"	Proj:RunResultsW[4]:Parent			= {	Local( Name )  }
	"Set EU name for result  - W-Othr HVAC"	Proj:RunResultsW[4]:EnduseName	= {	"Other HVAC"  }

	"Create result component - W-WtrHt"			Proj:RunResultsW[5]					= {	CreateComp( EnergyUse, "W-EU-WtrHt" )  }
	"Set parent for result   - W-WtrHt"			Proj:RunResultsW[5]:Parent			= {	Local( Name )  }
	"Set EU name for result  - W-WtrHt"			Proj:RunResultsW[5]:EnduseName	= {	"Water Heating"  }

	"Create result component - W-InsLtg"		Proj:RunResultsW[6]					= {	CreateComp( EnergyUse, "W-EU-InsLtg" )  }
	"Set parent for result   - W-InsLtg"		Proj:RunResultsW[6]:Parent			= {	Local( Name )  }
	"Set EU name for result  - W-InsLtg"		Proj:RunResultsW[6]:EnduseName	= {	"Inside Lighting"  }

	"Create result component - W-AppCkg"		Proj:RunResultsW[7]					= {	CreateComp( EnergyUse, "W-EU-AppCkg" )  }
	"Set parent for result   - W-AppCkg"		Proj:RunResultsW[7]:Parent			= {	Local( Name )  }
	"Set EU name for result  - W-AppCkg"		Proj:RunResultsW[7]:EnduseName	= {	"Appl. & Cooking"  }

	"Create result component - W-Plugs"			Proj:RunResultsW[8]					= {	CreateComp( EnergyUse, "W-EU-Plugs" )  }
	"Set parent for result   - W-Plugs"			Proj:RunResultsW[8]:Parent			= {	Local( Name )  }
	"Set EU name for result  - W-Plugs"			Proj:RunResultsW[8]:EnduseName	= {	"Plug Loads"  }

	"Create result component - W-Ext"			Proj:RunResultsW[9]					= {	CreateComp( EnergyUse, "W-EU-Ext" )  }
	"Set parent for result   - W-Ext"			Proj:RunResultsW[9]:Parent			= {	Local( Name )  }
	"Set EU name for result  - W-Ext"			Proj:RunResultsW[9]:EnduseName	= {	"Exterior"  }

	"Create result component - W-Total"			Proj:RunResultsW[10]					= {	CreateComp( EnergyUse, "W-EU-Total" )  }
	"Set parent for result   - W-Total"			Proj:RunResultsW[10]:Parent		= {	Local( Name )  }
	"Set EU name for result  - W-Total"			Proj:RunResultsW[10]:EnduseName	= {	"TOTAL"  }

	"Create result component - W-Comp Ttl"		Proj:RunResultsW[11]					= {	CreateComp( EnergyUse, "W-EU-Compliance" )  }
	"Set parent for result   - W-Comp Ttl"		Proj:RunResultsW[11]:Parent		= {	Local( Name )  }
	"Set EU name for result  - W-Comp Ttl"		Proj:RunResultsW[11]:EnduseName	= {	"Compliance Total"  }

	"Create result component - W-PV Ttl"		Proj:RunResultsW[13]					= {	CreateComp( EnergyUse, "W-EU-PV" )  }
	"Set parent for result   - W-PV Ttl"		Proj:RunResultsW[13]:Parent		= {	Local( Name )  }
	"Set EU name for result  - W-PV Ttl"		Proj:RunResultsW[13]:EnduseName	= {	"Photovoltaics"  }

	"Create result component - W-Batt Ttl"		Proj:RunResultsW[14]					= {	CreateComp( EnergyUse, "W-EU-Battery" )  }
	"Set parent for result   - W-Batt Ttl"		Proj:RunResultsW[14]:Parent		= {	Local( Name )  }
	"Set EU name for result  - W-Batt Ttl"		Proj:RunResultsW[14]:EnduseName	= {	"Battery"  }

;"dbg BEMProc details"		Proj:Action = {  StoreBEMProc( Format( "aft CARes_Refresh_RunResults_W for %s", RunAbbrev ), 0 )  }
END

;*************************************************************************		- SAC 6/25/13
RULELIST "CARes_ProposedResults_W" 1 0 1 1
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
;*************************************************************************
;"debug"  Proj:Action = {  PostMessageToLog( "  evaluating 'CARes_ProposedResults_W':  RunAbbrev '%s'  RunNumber %g", RunAbbrev, RunNumber )  }
   ; SAC 1/5/18 - moved rules to blast and re-create RunResults objects into subordinate list to initiate either from here or StdMixdFuel run rules
   "Refresh RunResults-W objects"  Proj:Action  = {
         if (ComponentCount( EUseSummary ) > 4 .AND. ComponentCount( EnergyUse ) > 40) then  UNCHANGED
         else  EvalRulelist( "CARes_Refresh_RunResults_W" )  endif  }

  ; Space Heating (& heating fan)
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
	"Store energy use - Elec   - W-SpcHt"		Proj:RunResultsW[1]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Htg", "HPBU", "FanH",   "Aux", "Fan" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - W-SpcHt"		Proj:RunResultsW[1]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Htg", "HPBU", "Aux"         ) / CondFloorArea  endif  }
	"Store energy use - Other  - W-SpcHt"		Proj:RunResultsW[1]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Htg", "HPBU", "Aux"         ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - W-SpcHt"		Proj:RunResultsW[1]:PropTotalEnergy[1]		= {	LocalRef( RunResultsW[1]:PropElecEnergy[1] ) + LocalRef( RunResultsW[1]:PropNatGasEnergy[1] ) + LocalRef( RunResultsW[1]:PropOtherEnergy[1] )   }

  ; Space Cooling (& cooling fan)
	"Store energy use - Elec   - W-SpcCl"		Proj:RunResultsW[2]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - W-SpcCl"		Proj:RunResultsW[2]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Clg"         ) / CondFloorArea  endif  }
	"Store energy use - Other  - W-SpcCl"		Proj:RunResultsW[2]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Clg"         ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - W-SpcCl"		Proj:RunResultsW[2]:PropTotalEnergy[1]		= {	LocalRef( RunResultsW[2]:PropElecEnergy[1] ) + LocalRef( RunResultsW[2]:PropNatGasEnergy[1] ) + LocalRef( RunResultsW[2]:PropOtherEnergy[1] )   }

  ; IAQ Ventilation Fans
	"Store energy use - Elec   - W-IAQVent"	Proj:RunResultsW[3]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "FanV" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - W-IAQVent"	Proj:RunResultsW[3]:PropNatGasEnergy[1]	= {	0  }
	"Store energy use - Other  - W-IAQVent"	Proj:RunResultsW[3]:PropOtherEnergy[1]		= {	0  }
	"Store energy use - TOTAL  - W-IAQVent"	Proj:RunResultsW[3]:PropTotalEnergy[1]		= {	LocalRef( RunResultsW[3]:PropElecEnergy[1] )   }

  ; Other HVAC (aux & misc fans)
; SAC 11/8/18 - restored "Other HVAC" [4] to handle VCHP CFan via "User1" enduse
	"Store energy use - Elec   - W-OthrHVAC"	Proj:RunResultsW[4]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "User1" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - W-OthrHVAC"	Proj:RunResultsW[4]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "User1" ) / CondFloorArea  endif  }
	"Store energy use - Other  - W-OthrHVAC"	Proj:RunResultsW[4]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "User1" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - W-OthrHVAC"	Proj:RunResultsW[4]:PropTotalEnergy[1]		= {	LocalRef( RunResultsW[4]:PropElecEnergy[1] ) + LocalRef( RunResultsW[4]:PropNatGasEnergy[1] ) + LocalRef( RunResultsW[4]:PropOtherEnergy[1] )   }

; SAC 1/27/19 - REDISTRIBUTE OthrHVAC Prop energy use across SpcHt & SpcCl by fuel based on ratio of total energy use (across all fuels) (tic #1053)
   "Set OthrHVAC_SpcHtFrac - W-PropEnergy"   Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResultsW[4]:PropTotalEnergy[1] != 0 )==0) then  0
                                                                           else if (IfValidAnd( RunResultsW[1]:PropTotalEnergy[1] == 0 ) .AND.
                                                                                    IfValidAnd( RunResultsW[2]:PropTotalEnergy[1] == 0 )) then  0.5
                                                                           else   ValidOr( RunResultsW[1]:PropTotalEnergy[1], 0 ) / 
                                                                                 (ValidOr( RunResultsW[1]:PropTotalEnergy[1], 0 ) + ValidOr( RunResultsW[2]:PropTotalEnergy[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Elec   - W-SpcHt"		Proj:RunResultsW[1]:PropElecEnergy[1]	= {   if (IfValidAnd( RunResultsW[4]:PropElecEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsW[1]:PropElecEnergy[1] + (RunResultsW[4]:PropElecEnergy[1]     * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - NatGas - W-SpcHt"		Proj:RunResultsW[1]:PropNatGasEnergy[1] ={   if (IfValidAnd( RunResultsW[4]:PropNatGasEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsW[1]:PropNatGasEnergy[1] + (RunResultsW[4]:PropNatGasEnergy[1] * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - Other  - W-SpcHt"		Proj:RunResultsW[1]:PropOtherEnergy[1]	= {   if (IfValidAnd( RunResultsW[4]:PropOtherEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsW[1]:PropOtherEnergy[1] + (RunResultsW[4]:PropOtherEnergy[1]   * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - TOTAL  - W-SpcHt"		Proj:RunResultsW[1]:PropTotalEnergy[1]	= {	LocalRef( RunResultsW[1]:PropElecEnergy[1] ) + LocalRef( RunResultsW[1]:PropNatGasEnergy[1] ) + LocalRef( RunResultsW[1]:PropOtherEnergy[1] )   }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Elec   - W-SpcCl"		Proj:RunResultsW[2]:PropElecEnergy[1]	= {   if (IfValidAnd( RunResultsW[4]:PropElecEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsW[2]:PropElecEnergy[1] + (RunResultsW[4]:PropElecEnergy[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - NatGas - W-SpcCl"		Proj:RunResultsW[2]:PropNatGasEnergy[1] ={   if (IfValidAnd( RunResultsW[4]:PropNatGasEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsW[2]:PropNatGasEnergy[1] + (RunResultsW[4]:PropNatGasEnergy[1] * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - Other  - W-SpcCl"		Proj:RunResultsW[2]:PropOtherEnergy[1]	= {   if (IfValidAnd( RunResultsW[4]:PropOtherEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsW[2]:PropOtherEnergy[1] + (RunResultsW[4]:PropOtherEnergy[1]   * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - TOTAL  - W-SpcCl"		Proj:RunResultsW[2]:PropTotalEnergy[1]	= {	LocalRef( RunResultsW[2]:PropElecEnergy[1] ) + LocalRef( RunResultsW[2]:PropNatGasEnergy[1] ) + LocalRef( RunResultsW[2]:PropOtherEnergy[1] )   }
  ; Other HVAC (aux & misc fans)
	"ZERO-OUT         - Elec   - W-OthrHVAC"	Proj:RunResultsW[4]:PropElecEnergy[1]	= {	0  }
	"ZERO-OUT         - NatGas - W-OthrHVAC"	Proj:RunResultsW[4]:PropNatGasEnergy[1] ={	0  }
	"ZERO-OUT         - Other  - W-OthrHVAC"	Proj:RunResultsW[4]:PropOtherEnergy[1]	= {	0  }
	"ZERO-OUT         - TOTAL  - W-OthrHVAC"	Proj:RunResultsW[4]:PropTotalEnergy[1]	= {	0  }
   ; SAC 1/27/19 - end of - redistribution of OthrHVAC PropEnergy

  ; Water Heating
	"Store energy use - Elec   - W-WtrHt"		Proj:RunResultsW[5]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else if (CSEinclDHWMFL_EU)
			 			  																							   then  HourlyResultSum( RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / CondFloorArea
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / CondFloorArea  endif endif  }
	"Store energy use - NatGas - W-WtrHt"		Proj:RunResultsW[5]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea  endif  }
	"Store energy use - Other  - W-WtrHt"		Proj:RunResultsW[5]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - W-WtrHt"		Proj:RunResultsW[5]:PropTotalEnergy[1]		= {	LocalRef( RunResultsW[5]:PropElecEnergy[1] ) + LocalRef( RunResultsW[5]:PropNatGasEnergy[1] ) + LocalRef( RunResultsW[5]:PropOtherEnergy[1] )   }

  ; Inside Lighting
	"Store energy use - Elec   - W-InsLtg"		Proj:RunResultsW[6]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Lit" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - W-InsLtg"		Proj:RunResultsW[6]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Lit" ) / CondFloorArea  endif  }
	"Store energy use - Other  - W-InsLtg"		Proj:RunResultsW[6]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Lit" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - W-InsLtg"		Proj:RunResultsW[6]:PropTotalEnergy[1]		= {	LocalRef( RunResultsW[6]:PropElecEnergy[1] ) + LocalRef( RunResultsW[6]:PropNatGasEnergy[1] ) + LocalRef( RunResultsW[6]:PropOtherEnergy[1] )   }

  ; Appliances & Cooking
	"Store energy use - Elec   - W-AppCkg"		Proj:RunResultsW[7]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - W-AppCkg"		Proj:RunResultsW[7]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea  endif  }
	"Store energy use - Other  - W-AppCkg"		Proj:RunResultsW[7]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - W-AppCkg"		Proj:RunResultsW[7]:PropTotalEnergy[1]		= {	LocalRef( RunResultsW[7]:PropElecEnergy[1] ) + LocalRef( RunResultsW[7]:PropNatGasEnergy[1] ) + LocalRef( RunResultsW[7]:PropOtherEnergy[1] )   }

  ; Plug Loads
	"Store energy use - Elec   - W-Plugs"		Proj:RunResultsW[8]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Rcp" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - W-Plugs"		Proj:RunResultsW[8]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Rcp" ) / CondFloorArea  endif  }
	"Store energy use - Other  - W-Plugs"		Proj:RunResultsW[8]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Rcp" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - W-Plugs"		Proj:RunResultsW[8]:PropTotalEnergy[1]		= {	LocalRef( RunResultsW[8]:PropElecEnergy[1] ) + LocalRef( RunResultsW[8]:PropNatGasEnergy[1] ) + LocalRef( RunResultsW[8]:PropOtherEnergy[1] )   }

  ; Exterior
	"Store energy use - Elec   - W-Ext"			Proj:RunResultsW[9]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Ext" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - W-Ext"			Proj:RunResultsW[9]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Ext" ) / CondFloorArea  endif  }
	"Store energy use - Other  - W-Ext"			Proj:RunResultsW[9]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Ext" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - W-Ext"			Proj:RunResultsW[9]:PropTotalEnergy[1]		= {	LocalRef( RunResultsW[9]:PropElecEnergy[1] ) + LocalRef( RunResultsW[9]:PropNatGasEnergy[1] ) + LocalRef( RunResultsW[9]:PropOtherEnergy[1] )   }

  ; PV
	"Store energy use - Elec   - W-PV"			Proj:RunResultsW[13]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec ) < 0.5 .OR. CondFloorArea < 1) then  0
                                                                                          else if (CommunitySolarProjID > 0 .AND. IfValidAnd( CmntySlr_ElecEnergy < 0 )) then  CmntySlr_ElecEnergy * PVWDCSizeMultiplier[1] * 3.412 / CondFloorArea
			 			  																								else  HourlyResultSum( RunID, "MtrElec", "PV" ) / CondFloorArea  endif endif  }
	"Store energy use - NatGas - W-PV"			Proj:RunResultsW[13]:PropNatGasEnergy[1]	= {	0  }
	"Store energy use - Other  - W-PV"			Proj:RunResultsW[13]:PropOtherEnergy[1]	= {	0  }
	"Store energy use - TOTAL  - W-PV"			Proj:RunResultsW[13]:PropTotalEnergy[1]	= {	LocalRef( RunResultsW[13]:PropElecEnergy[1] )   }

  ; Battery
	"Store energy use - Elec   - W-Battery"	Proj:RunResultsW[14]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec", "BT" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - W-Battery"	Proj:RunResultsW[14]:PropNatGasEnergy[1]	= {	0  }
	"Store energy use - Other  - W-Battery"	Proj:RunResultsW[14]:PropOtherEnergy[1]	= {	0  }
	"Store energy use - TOTAL  - W-Battery"	Proj:RunResultsW[14]:PropTotalEnergy[1]	= {	LocalRef( RunResultsW[14]:PropElecEnergy[1] )   }

  ; Compliance Total
	"Store energy use - Elec   - W-Comp Ttl"	Proj:RunResultsW[11]:PropElecEnergy[1]		= {	RunResultsW[1]:PropElecEnergy[1]   + RunResultsW[2]:PropElecEnergy[1]   + RunResultsW[3]:PropElecEnergy[1]   + RunResultsW[4]:PropElecEnergy[1]   + RunResultsW[5]:PropElecEnergy[1]    }
	"Store energy use - NatGas - W-Comp Ttl"	Proj:RunResultsW[11]:PropNatGasEnergy[1]	= {	RunResultsW[1]:PropNatGasEnergy[1] + RunResultsW[2]:PropNatGasEnergy[1] + RunResultsW[3]:PropNatGasEnergy[1] + RunResultsW[4]:PropNatGasEnergy[1] + RunResultsW[5]:PropNatGasEnergy[1]  }
	"Store energy use - Other  - W-Comp Ttl"	Proj:RunResultsW[11]:PropOtherEnergy[1]	= {	RunResultsW[1]:PropOtherEnergy[1]  + RunResultsW[2]:PropOtherEnergy[1]  + RunResultsW[3]:PropOtherEnergy[1]  + RunResultsW[4]:PropOtherEnergy[1]  + RunResultsW[5]:PropOtherEnergy[1]   }
	"Store energy use - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:PropTotalEnergy[1]	= {	RunResultsW[1]:PropTotalEnergy[1]  + RunResultsW[2]:PropTotalEnergy[1]  + RunResultsW[3]:PropTotalEnergy[1]  + RunResultsW[4]:PropTotalEnergy[1]  + RunResultsW[5]:PropTotalEnergy[1]   }
;   ; SAC 10/6/16 - 2019 updates
;	"Add in PV - Elec   - W-Comp Ttl"	      Proj:RunResultsW[11]:PropElecEnergy[1]		= {	if (EnergyCodeYearNum < 2019) then  UNCHANGED
;                                                                                             else  RunResultsW[11]:PropElecEnergy[1]  + RunResultsW[13]:PropElecEnergy[1]  + RunResultsW[14]:PropElecEnergy[1]   endif   }
;	"Add in PV - TOTAL  - W-Comp Ttl"	      Proj:RunResultsW[11]:PropTotalEnergy[1]	= {	if (EnergyCodeYearNum < 2019) then  UNCHANGED
;                                                                                             else  RunResultsW[11]:PropTotalEnergy[1] + RunResultsW[13]:PropTotalEnergy[1] + RunResultsW[14]:PropTotalEnergy[1]  endif   }

  ; Total
	"Store energy use - Elec   - W-Total"		Proj:RunResultsW[10]:PropElecEnergy[1]		= {	RunResultsW[11]:PropElecEnergy[1]   + RunResultsW[6]:PropElecEnergy[1]   + RunResultsW[7]:PropElecEnergy[1]   + RunResultsW[8]:PropElecEnergy[1]   + RunResultsW[9]:PropElecEnergy[1]    }
	"Store energy use - NatGas - W-Total"		Proj:RunResultsW[10]:PropNatGasEnergy[1]	= {	RunResultsW[11]:PropNatGasEnergy[1] + RunResultsW[6]:PropNatGasEnergy[1] + RunResultsW[7]:PropNatGasEnergy[1] + RunResultsW[8]:PropNatGasEnergy[1] + RunResultsW[9]:PropNatGasEnergy[1]  }
	"Store energy use - Other  - W-Total"		Proj:RunResultsW[10]:PropOtherEnergy[1]	= {	RunResultsW[11]:PropOtherEnergy[1]  + RunResultsW[6]:PropOtherEnergy[1]  + RunResultsW[7]:PropOtherEnergy[1]  + RunResultsW[8]:PropOtherEnergy[1]  + RunResultsW[9]:PropOtherEnergy[1]   }
	"Store energy use - TOTAL  - W-Total"		Proj:RunResultsW[10]:PropTotalEnergy[1]	= {	RunResultsW[11]:PropTotalEnergy[1]  + RunResultsW[6]:PropTotalEnergy[1]  + RunResultsW[7]:PropTotalEnergy[1]  + RunResultsW[8]:PropTotalEnergy[1]  + RunResultsW[9]:PropTotalEnergy[1]   }
   ; SAC 4/28/17 - shifted PV & Batt from CompTot to Tot for 2019
   ; SAC 4/28/17 - add in only Battery to Total for 2016
	"Add in PV/Batt - Elec   - W-Total"	      Proj:RunResultsW[10]:PropElecEnergy[1]		= {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                             else if (EnergyCodeYearNum < 2019) 
                                                                                             then  RunResultsW[10]:PropElecEnergy[1]  + RunResultsW[14]:PropElecEnergy[1]
                                                                                             else  RunResultsW[10]:PropElecEnergy[1]  + RunResultsW[13]:PropElecEnergy[1]  + RunResultsW[14]:PropElecEnergy[1]   endif endif   }
	"Add in PV/Batt - TOTAL  - W-Total"	      Proj:RunResultsW[10]:PropTotalEnergy[1]	= {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                             else if (EnergyCodeYearNum < 2019) 
                                                                                             then  RunResultsW[10]:PropTotalEnergy[1] + RunResultsW[14]:PropTotalEnergy[1]
                                                                                             else  RunResultsW[10]:PropTotalEnergy[1] + RunResultsW[13]:PropTotalEnergy[1] + RunResultsW[14]:PropTotalEnergy[1]  endif endif   }

   "Store Proj:AnalysisVersion to EUseSummary-W"   Proj:ResultSummary[5]:ResultsAnalysisVer = {  ValidOr( Proj:AnalysisVersion, 0 )  }    ; SAC 11/28/22
   "Store Proj:AllOrientations to EUseSummary-W"   Proj:ResultSummary[5]:AllOrientations    = {  ValidOr( Proj:AllOrientations, 0 )  }

   ; SAC 1/19/18 - add reporting proposed PV cap
   "Store size of PV system actually analyzed-W"      Proj:ResultSummary[5]:PropDesignPVTot  = {
         if ( (EnergyCodeYearNum < 2019 .AND.
               (IfValidAnd( AllowDesignRating > 0.5 )==0 .OR. IfValidAnd( DesignRatingCalcs > 0.5 )==0)) .OR.
              IfValidAnd( PVWDCSysTotal > 0 )==0 )
         then  UNDEFINED
         else	PVWDCSysTotal * ValidOr( PVWDCSizeMultiplier[1], 1 )  endif  }

   "Store Proposed model Battery capacity-W"      Proj:ResultSummary[5]:PropDesignBattCap  =      ; SAC 11/26/22
      {  if ( (IfValidAnd( PVWDCSysTotal > 0 )==0 .AND. IfValidAnd( SimStandaloneBatt > 0 )==0 ) .OR. IfValidAnd( SimulateBattery > 0 )==0 .OR. 
              (IfValidAnd( SimulateBattery > 0 ) .AND. IfValidAnd( AllowBattRoundTripEff == 1) .AND. IfValidAnd( BattRoundTripEff < 0.8))) 
         then  UNDEFINED
         else  ValidOr( BattMaxCap, 0 )  endif  }
   "Store Proposed model Battery power-W"         Proj:ResultSummary[5]:PropDesignBattPwr  =
      {  if (IfValidAnd( ResultSummary[5]:PropDesignBattCap > 0 )==0) then  UNDEFINED
         else  (ValidOr( BattMaxChgPwr, 0 ) + ValidOr( BattMaxDschgPwr, 0 )) / 2  endif  }
END


;*************************************************************************
RULELIST "CARes_StandardResults" 1 0 1 1
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
;*************************************************************************
;"debug"  Proj:Action = {  PostMessageToLog( "  evaluating 'CARes_StandardResults':  RunAbbrev '%s'  RunNumber %g", RunAbbrev, RunNumber )  }
   "Set ResultSummary[1]:StdDesignPVSize"    Proj:ResultSummary[1]:StdDesignPVSize  = {  if (EnergyCodeYearNum < 2019) then  UNCHANGED  else  PVWDCSysSize[1]  endif  }    ; SAC 1/11/18

   "Set ResultSummary[1]:ResultsNotes[5]"        Proj:ResultSummary[1]:ResultsNotes[5]        = {  if (EnergyCodeYearNum < 2019) then  UNCHANGED  else  Format( "Standard Design PV Capacity: %.2f kWdc", ResultSummary[1]:StdDesignPVSize )  endif  }   ; SAC 8/30/19 - added 'dc' (tic #1056)
	"Set ResultSummary[1]:HaveResultsNotesPV[5]"  Proj:ResultSummary[1]:HaveResultsNotesPV[5]  = {  if (EnergyCodeYearNum < 2019) then  UNCHANGED  else  1  endif  }

  ; Space Heating (& heating fan)
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
	"Store energy use - Elec   - SpcHt"		Proj:RunResults[1]:StdElecEnergy			= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrElec",   "Htg", "HPBU", "FanH",   "Aux", "Fan" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - SpcHt"		Proj:RunResults[1]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrNatGas", "Htg", "HPBU", "Aux"         ) / CondFloorArea  endif  }
	"Store energy use - Other  - SpcHt"		Proj:RunResults[1]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrOther",  "Htg", "HPBU", "Aux"         ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - SpcHt"		Proj:RunResults[1]:StdTotalEnergy		= {	LocalRef( RunResults[1]:StdElecEnergy ) + LocalRef( RunResults[1]:StdNatGasEnergy ) + LocalRef( RunResults[1]:StdOtherEnergy )   }

  ; Space Cooling (& cooling fan)
	"Store energy use - Elec   - SpcCl"		Proj:RunResults[2]:StdElecEnergy			= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - SpcCl"		Proj:RunResults[2]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrNatGas", "Clg"         ) / CondFloorArea  endif  }
	"Store energy use - Other  - SpcCl"		Proj:RunResults[2]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrOther",  "Clg"         ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - SpcCl"		Proj:RunResults[2]:StdTotalEnergy		= {	LocalRef( RunResults[2]:StdElecEnergy ) + LocalRef( RunResults[2]:StdNatGasEnergy ) + LocalRef( RunResults[2]:StdOtherEnergy )   }

  ; IAQ Ventilation Fans
	"Store energy use - Elec   - IAQVent"	Proj:RunResults[3]:StdElecEnergy			= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrElec",   "FanV" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - IAQVent"	Proj:RunResults[3]:StdNatGasEnergy		= {	0  }
	"Store energy use - Other  - IAQVent"	Proj:RunResults[3]:StdOtherEnergy		= {	0  }
	"Store energy use - TOTAL  - IAQVent"	Proj:RunResults[3]:StdTotalEnergy		= {	LocalRef( RunResults[3]:StdElecEnergy )   }

  ; Other HVAC (aux & misc fans)
   ; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
   ; SAC 11/15/18 - restored "Other HVAC" [4] to handle VCHP CFan via "User1" enduse
	"Store energy use - Elec   - OthrHVAC"	Proj:RunResults[4]:StdElecEnergy			= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrElec",   "User1" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - OthrHVAC"	Proj:RunResults[4]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrNatGas", "User1" ) / CondFloorArea  endif  }
	"Store energy use - Other  - OthrHVAC"	Proj:RunResults[4]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrOther",  "User1" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - OthrHVAC"	Proj:RunResults[4]:StdTotalEnergy		= {	LocalRef( RunResults[4]:StdElecEnergy ) + LocalRef( RunResults[4]:StdNatGasEnergy ) + LocalRef( RunResults[4]:StdOtherEnergy )   }

; SAC 1/27/19 - REDISTRIBUTE OthrHVAC Std energy use across SpcHt & SpcCl by fuel based on ratio of total energy use (across all fuels) (tic #1053)
   "Set OthrHVAC_SpcHtFrac - StdEnergy"   Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResults[4]:StdTotalEnergy[1] != 0 )==0) then  0
                                                                        else if (IfValidAnd( RunResults[1]:StdTotalEnergy[1] == 0 ) .AND.
                                                                                 IfValidAnd( RunResults[2]:StdTotalEnergy[1] == 0 )) then  0.5
                                                                        else   ValidOr( RunResults[1]:StdTotalEnergy[1], 0 ) / 
                                                                              (ValidOr( RunResults[1]:StdTotalEnergy[1], 0 ) + ValidOr( RunResults[2]:StdTotalEnergy[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Elec   - SpcHt"		Proj:RunResults[1]:StdElecEnergy[1]	   = {   if (IfValidAnd( RunResults[4]:StdElecEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[1]:StdElecEnergy[1] + (RunResults[4]:StdElecEnergy[1]     * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - NatGas - SpcHt"		Proj:RunResults[1]:StdNatGasEnergy[1]	= {   if (IfValidAnd( RunResults[4]:StdNatGasEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[1]:StdNatGasEnergy[1] + (RunResults[4]:StdNatGasEnergy[1] * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - Other  - SpcHt"		Proj:RunResults[1]:StdOtherEnergy[1]	= {   if (IfValidAnd( RunResults[4]:StdOtherEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[1]:StdOtherEnergy[1] + (RunResults[4]:StdOtherEnergy[1]   * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - TOTAL  - SpcHt"		Proj:RunResults[1]:StdTotalEnergy[1]	= {	LocalRef( RunResults[1]:StdElecEnergy[1] ) + LocalRef( RunResults[1]:StdNatGasEnergy[1] ) + LocalRef( RunResults[1]:StdOtherEnergy[1] )   }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Elec   - SpcCl"		Proj:RunResults[2]:StdElecEnergy[1]	   = {   if (IfValidAnd( RunResults[4]:StdElecEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[2]:StdElecEnergy[1] + (RunResults[4]:StdElecEnergy[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - NatGas - SpcCl"		Proj:RunResults[2]:StdNatGasEnergy[1]	= {   if (IfValidAnd( RunResults[4]:StdNatGasEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[2]:StdNatGasEnergy[1] + (RunResults[4]:StdNatGasEnergy[1] * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - Other  - SpcCl"		Proj:RunResults[2]:StdOtherEnergy[1]	= {   if (IfValidAnd( RunResults[4]:StdOtherEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[2]:StdOtherEnergy[1] + (RunResults[4]:StdOtherEnergy[1]   * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - TOTAL  - SpcCl"		Proj:RunResults[2]:StdTotalEnergy[1]	= {	LocalRef( RunResults[2]:StdElecEnergy[1] ) + LocalRef( RunResults[2]:StdNatGasEnergy[1] ) + LocalRef( RunResults[2]:StdOtherEnergy[1] )   }
  ; Other HVAC (aux & misc fans)
	"ZERO-OUT         - Elec   - OthrHVAC"	Proj:RunResults[4]:StdElecEnergy[1]	   = {	0  }
	"ZERO-OUT         - NatGas - OthrHVAC"	Proj:RunResults[4]:StdNatGasEnergy[1]	= {	0  }
	"ZERO-OUT         - Other  - OthrHVAC"	Proj:RunResults[4]:StdOtherEnergy[1]	= {	0  }
	"ZERO-OUT         - TOTAL  - OthrHVAC"	Proj:RunResults[4]:StdTotalEnergy[1]	= {	0  }
   ; SAC 1/27/19 - end of - redistribution of OthrHVAC PropEnergy

  ; Water Heating
	"Store energy use - Elec   - WtrHt"		Proj:RunResults[5]:StdElecEnergy			= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else if (CSEinclDHWMFL_EU)
			 			  																							then  HourlyResultSum( RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / CondFloorArea
			 			  																							else  HourlyResultSum( RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / CondFloorArea  endif endif  }
	"Store energy use - NatGas - WtrHt"		Proj:RunResults[5]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea  endif  }
	"Store energy use - Other  - WtrHt"		Proj:RunResults[5]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - WtrHt"		Proj:RunResults[5]:StdTotalEnergy		= {	LocalRef( RunResults[5]:StdElecEnergy ) + LocalRef( RunResults[5]:StdNatGasEnergy ) + LocalRef( RunResults[5]:StdOtherEnergy )   }

  ; Inside Lighting
	"Store energy use - Elec   - InsLtg"	Proj:RunResults[6]:StdElecEnergy			= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrElec",   "Lit" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - InsLtg"	Proj:RunResults[6]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrNatGas", "Lit" ) / CondFloorArea  endif  }
	"Store energy use - Other  - InsLtg"	Proj:RunResults[6]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrOther",  "Lit" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - InsLtg"	Proj:RunResults[6]:StdTotalEnergy		= {	LocalRef( RunResults[6]:StdElecEnergy ) + LocalRef( RunResults[6]:StdNatGasEnergy ) + LocalRef( RunResults[6]:StdOtherEnergy )   }

  ; Appliances & Cooking
	"Store energy use - Elec   - AppCkg"	Proj:RunResults[7]:StdElecEnergy			= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - AppCkg"	Proj:RunResults[7]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea  endif  }
	"Store energy use - Other  - AppCkg"	Proj:RunResults[7]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - AppCkg"	Proj:RunResults[7]:StdTotalEnergy		= {	LocalRef( RunResults[7]:StdElecEnergy ) + LocalRef( RunResults[7]:StdNatGasEnergy ) + LocalRef( RunResults[7]:StdOtherEnergy )   }

  ; Plug Loads
	"Store energy use - Elec   - Plugs"		Proj:RunResults[8]:StdElecEnergy			= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrElec",   "Rcp" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - Plugs"		Proj:RunResults[8]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrNatGas", "Rcp" ) / CondFloorArea  endif  }
	"Store energy use - Other  - Plugs"		Proj:RunResults[8]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrOther",  "Rcp" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - Plugs"		Proj:RunResults[8]:StdTotalEnergy		= {	LocalRef( RunResults[8]:StdElecEnergy ) + LocalRef( RunResults[8]:StdNatGasEnergy ) + LocalRef( RunResults[8]:StdOtherEnergy )   }

  ; Exterior
	"Store energy use - Elec   - Ext"		Proj:RunResults[9]:StdElecEnergy			= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrElec",   "Ext" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - Ext"		Proj:RunResults[9]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrNatGas", "Ext" ) / CondFloorArea  endif  }
	"Store energy use - Other  - Ext"		Proj:RunResults[9]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrOther",  "Ext" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - Ext"		Proj:RunResults[9]:StdTotalEnergy		= {	LocalRef( RunResults[9]:StdElecEnergy ) + LocalRef( RunResults[9]:StdNatGasEnergy ) + LocalRef( RunResults[9]:StdOtherEnergy )   }

  ; PV
	"Store energy use - Elec   - PV"			Proj:RunResults[13]:StdElecEnergy		= {	if (Local( Fuel_HaveElec ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrElec", "PV" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - PV"			Proj:RunResults[13]:StdNatGasEnergy		= {	0  }
	"Store energy use - Other  - PV"			Proj:RunResults[13]:StdOtherEnergy		= {	0  }
	"Store energy use - TOTAL  - PV"			Proj:RunResults[13]:StdTotalEnergy		= {	LocalRef( RunResults[13]:StdElecEnergy )   }

  ; Battery
	"Store energy use - Elec   - Battery"	Proj:RunResults[14]:StdElecEnergy		= {	if (Local( Fuel_HaveElec ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrElec", "BT" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - Battery"	Proj:RunResults[14]:StdNatGasEnergy		= {	0  }
	"Store energy use - Other  - Battery"	Proj:RunResults[14]:StdOtherEnergy		= {	0  }
	"Store energy use - TOTAL  - Battery"	Proj:RunResults[14]:StdTotalEnergy		= {	LocalRef( RunResults[14]:StdElecEnergy )   }

  ; Compliance Total
	"Store energy use - Elec   - Comp Ttl"	Proj:RunResults[11]:StdElecEnergy		= {	RunResults[1]:StdElecEnergy   + RunResults[2]:StdElecEnergy   + RunResults[3]:StdElecEnergy   + RunResults[4]:StdElecEnergy   + RunResults[5]:StdElecEnergy    }
	"Store energy use - NatGas - Comp Ttl"	Proj:RunResults[11]:StdNatGasEnergy		= {	RunResults[1]:StdNatGasEnergy + RunResults[2]:StdNatGasEnergy + RunResults[3]:StdNatGasEnergy + RunResults[4]:StdNatGasEnergy + RunResults[5]:StdNatGasEnergy  }
	"Store energy use - Other  - Comp Ttl"	Proj:RunResults[11]:StdOtherEnergy		= {	RunResults[1]:StdOtherEnergy  + RunResults[2]:StdOtherEnergy  + RunResults[3]:StdOtherEnergy  + RunResults[4]:StdOtherEnergy  + RunResults[5]:StdOtherEnergy   }
	"Store energy use - TOTAL  - Comp Ttl"	Proj:RunResults[11]:StdTotalEnergy		= {	RunResults[1]:StdTotalEnergy  + RunResults[2]:StdTotalEnergy  + RunResults[3]:StdTotalEnergy  + RunResults[4]:StdTotalEnergy  + RunResults[5]:StdTotalEnergy   }

  ; Total
	"Store energy use - Elec   - Total"		Proj:RunResults[10]:StdElecEnergy		= {	RunResults[11]:StdElecEnergy   + RunResults[6]:StdElecEnergy   + RunResults[7]:StdElecEnergy   + RunResults[8]:StdElecEnergy   + RunResults[9]:StdElecEnergy   + RunResults[13]:StdElecEnergy   + RunResults[14]:StdElecEnergy    }
	"Store energy use - NatGas - Total"		Proj:RunResults[10]:StdNatGasEnergy		= {	RunResults[11]:StdNatGasEnergy + RunResults[6]:StdNatGasEnergy + RunResults[7]:StdNatGasEnergy + RunResults[8]:StdNatGasEnergy + RunResults[9]:StdNatGasEnergy + RunResults[13]:StdNatGasEnergy + RunResults[14]:StdNatGasEnergy  }
	"Store energy use - Other  - Total"		Proj:RunResults[10]:StdOtherEnergy		= {	RunResults[11]:StdOtherEnergy  + RunResults[6]:StdOtherEnergy  + RunResults[7]:StdOtherEnergy  + RunResults[8]:StdOtherEnergy  + RunResults[9]:StdOtherEnergy  + RunResults[13]:StdOtherEnergy  + RunResults[14]:StdOtherEnergy   }
	"Store energy use - TOTAL  - Total"		Proj:RunResults[10]:StdTotalEnergy		= {	RunResults[11]:StdTotalEnergy  + RunResults[6]:StdTotalEnergy  + RunResults[7]:StdTotalEnergy  + RunResults[8]:StdTotalEnergy  + RunResults[9]:StdTotalEnergy  + RunResults[13]:StdTotalEnergy  + RunResults[14]:StdTotalEnergy   }

  ; SAC 12/20/17 - moved here from 'CARes_StdMixedFuelResults' during process of moving StdMixedFuel run to first in analysis sequence
  ; SAC 2/6/18 - removed '.OR. LocalStatus( ResultSummary[1]:StdMixedFuelPV ) < 1' check that was preventing std model carbon calcs when SMF run is skipped (due to reduced PV requirement specified by the user) (tic #974)
   "Call rulelist to setup std design CO2 emissions"  Proj:Action = {
         if (EnergyCodeYearNum < 2019) then  UNCHANGED
         else  EvalRulelist( "CARes_StandardResults_Carbon" )  endif  }

   "Set PV reporting properties"    Proj:Action = {  EvalRulelist( "CARes_Results_PVReporting" )  }
END

;*************************************************************************
RULELIST "CARes_DesignRatingResults" 1 0 0 1
;*************************************************************************
;"debug"  Proj:Action = {  PostMessageToLog( "  evaluating 'CARes_DesignRatingResults':  RunAbbrev '%s'  RunNumber %g", RunAbbrev, RunNumber )  }
  ; Space Heating (& heating fan)
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
	"Store energy use - Elec   - SpcHt"		Proj:RunResults[1]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrElec",   "Htg", "HPBU", "FanH",   "Aux", "Fan" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - SpcHt"		Proj:RunResults[1]:DRtgNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrNatGas", "Htg", "HPBU", "Aux"         ) / CondFloorArea  endif  }
	"Store energy use - Other  - SpcHt"		Proj:RunResults[1]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrOther",  "Htg", "HPBU", "Aux"         ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - SpcHt"		Proj:RunResults[1]:DRtgTotalEnergy		= {	LocalRef( RunResults[1]:DRtgElecEnergy ) + LocalRef( RunResults[1]:DRtgNatGasEnergy ) + LocalRef( RunResults[1]:DRtgOtherEnergy )   }

  ; Space Cooling (& cooling fan)
	"Store energy use - Elec   - SpcCl"		Proj:RunResults[2]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - SpcCl"		Proj:RunResults[2]:DRtgNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrNatGas", "Clg"         ) / CondFloorArea  endif  }
	"Store energy use - Other  - SpcCl"		Proj:RunResults[2]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrOther",  "Clg"         ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - SpcCl"		Proj:RunResults[2]:DRtgTotalEnergy		= {	LocalRef( RunResults[2]:DRtgElecEnergy ) + LocalRef( RunResults[2]:DRtgNatGasEnergy ) + LocalRef( RunResults[2]:DRtgOtherEnergy )   }

  ; IAQ Ventilation Fans
	"Store energy use - Elec   - IAQVent"	Proj:RunResults[3]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrElec",   "FanV" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - IAQVent"	Proj:RunResults[3]:DRtgNatGasEnergy		= {	0  }
	"Store energy use - Other  - IAQVent"	Proj:RunResults[3]:DRtgOtherEnergy		= {	0  }
	"Store energy use - TOTAL  - IAQVent"	Proj:RunResults[3]:DRtgTotalEnergy		= {	LocalRef( RunResults[3]:DRtgElecEnergy )   }

  ; Other HVAC (aux & misc fans)
   ; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
   ; SAC 11/15/18 - restored "Other HVAC" [4] to handle VCHP CFan via "User1" enduse
	"Store energy use - Elec   - OthrHVAC"	Proj:RunResults[4]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrElec",   "User1" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - OthrHVAC"	Proj:RunResults[4]:DRtgNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrNatGas", "User1" ) / CondFloorArea  endif  }
	"Store energy use - Other  - OthrHVAC"	Proj:RunResults[4]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrOther",  "User1" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - OthrHVAC"	Proj:RunResults[4]:DRtgTotalEnergy		= {	LocalRef( RunResults[4]:DRtgElecEnergy ) + LocalRef( RunResults[4]:DRtgNatGasEnergy ) + LocalRef( RunResults[4]:DRtgOtherEnergy )   }

; SAC 1/27/19 - REDISTRIBUTE OthrHVAC DRtg energy use across SpcHt & SpcCl by fuel based on ratio of total energy use (across all fuels) (tic #1053)
   "Set OthrHVAC_SpcHtFrac - DRtgEnergy"  Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResults[4]:DRtgTotalEnergy[1] != 0 )==0) then  0
                                                                        else if (IfValidAnd( RunResults[1]:DRtgTotalEnergy[1] == 0 ) .AND.
                                                                                 IfValidAnd( RunResults[2]:DRtgTotalEnergy[1] == 0 )) then  0.5
                                                                        else   ValidOr( RunResults[1]:DRtgTotalEnergy[1], 0 ) / 
                                                                              (ValidOr( RunResults[1]:DRtgTotalEnergy[1], 0 ) + ValidOr( RunResults[2]:DRtgTotalEnergy[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Elec   - SpcHt"		Proj:RunResults[1]:DRtgElecEnergy[1]	= {   if (IfValidAnd( RunResults[4]:DRtgElecEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[1]:DRtgElecEnergy[1] + (RunResults[4]:DRtgElecEnergy[1]     * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - NatGas - SpcHt"		Proj:RunResults[1]:DRtgNatGasEnergy[1]	= {   if (IfValidAnd( RunResults[4]:DRtgNatGasEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[1]:DRtgNatGasEnergy[1] + (RunResults[4]:DRtgNatGasEnergy[1] * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - Other  - SpcHt"		Proj:RunResults[1]:DRtgOtherEnergy[1]	= {   if (IfValidAnd( RunResults[4]:DRtgOtherEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[1]:DRtgOtherEnergy[1] + (RunResults[4]:DRtgOtherEnergy[1]   * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - TOTAL  - SpcHt"		Proj:RunResults[1]:DRtgTotalEnergy[1]	= {	LocalRef( RunResults[1]:DRtgElecEnergy[1] ) + LocalRef( RunResults[1]:DRtgNatGasEnergy[1] ) + LocalRef( RunResults[1]:DRtgOtherEnergy[1] )   }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Elec   - SpcCl"		Proj:RunResults[2]:DRtgElecEnergy[1]	= {   if (IfValidAnd( RunResults[4]:DRtgElecEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[2]:DRtgElecEnergy[1] + (RunResults[4]:DRtgElecEnergy[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - NatGas - SpcCl"		Proj:RunResults[2]:DRtgNatGasEnergy[1]	= {   if (IfValidAnd( RunResults[4]:DRtgNatGasEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[2]:DRtgNatGasEnergy[1] + (RunResults[4]:DRtgNatGasEnergy[1] * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - Other  - SpcCl"		Proj:RunResults[2]:DRtgOtherEnergy[1]	= {   if (IfValidAnd( RunResults[4]:DRtgOtherEnergy[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[2]:DRtgOtherEnergy[1] + (RunResults[4]:DRtgOtherEnergy[1]   * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - TOTAL  - SpcCl"		Proj:RunResults[2]:DRtgTotalEnergy[1]	= {	LocalRef( RunResults[2]:DRtgElecEnergy[1] ) + LocalRef( RunResults[2]:DRtgNatGasEnergy[1] ) + LocalRef( RunResults[2]:DRtgOtherEnergy[1] )   }
  ; Other HVAC (aux & misc fans)
	"ZERO-OUT         - Elec   - OthrHVAC"	Proj:RunResults[4]:DRtgElecEnergy[1]	= {	0  }
	"ZERO-OUT         - NatGas - OthrHVAC"	Proj:RunResults[4]:DRtgNatGasEnergy[1]	= {	0  }
	"ZERO-OUT         - Other  - OthrHVAC"	Proj:RunResults[4]:DRtgOtherEnergy[1]	= {	0  }
	"ZERO-OUT         - TOTAL  - OthrHVAC"	Proj:RunResults[4]:DRtgTotalEnergy[1]	= {	0  }
   ; SAC 1/27/19 - end of - redistribution of OthrHVAC PropEnergy

  ; Water Heating
	"Store energy use - Elec   - WtrHt"		Proj:RunResults[5]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else if (CSEinclDHWMFL_EU)
			 			  																							then  HourlyResultSum( RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / CondFloorArea
			 			  																							else  HourlyResultSum( RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / CondFloorArea  endif endif  }
	"Store energy use - NatGas - WtrHt"		Proj:RunResults[5]:DRtgNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea  endif  }
	"Store energy use - Other  - WtrHt"		Proj:RunResults[5]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - WtrHt"		Proj:RunResults[5]:DRtgTotalEnergy		= {	LocalRef( RunResults[5]:DRtgElecEnergy ) + LocalRef( RunResults[5]:DRtgNatGasEnergy ) + LocalRef( RunResults[5]:DRtgOtherEnergy )   }

  ; Inside Lighting
	"Store energy use - Elec   - InsLtg"	Proj:RunResults[6]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrElec",   "Lit" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - InsLtg"	Proj:RunResults[6]:DRtgNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrNatGas", "Lit" ) / CondFloorArea  endif  }
	"Store energy use - Other  - InsLtg"	Proj:RunResults[6]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrOther",  "Lit" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - InsLtg"	Proj:RunResults[6]:DRtgTotalEnergy		= {	LocalRef( RunResults[6]:DRtgElecEnergy ) + LocalRef( RunResults[6]:DRtgNatGasEnergy ) + LocalRef( RunResults[6]:DRtgOtherEnergy )   }

  ; Appliances & Cooking
	"Store energy use - Elec   - AppCkg"	Proj:RunResults[7]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - AppCkg"	Proj:RunResults[7]:DRtgNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea  endif  }
	"Store energy use - Other  - AppCkg"	Proj:RunResults[7]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - AppCkg"	Proj:RunResults[7]:DRtgTotalEnergy		= {	LocalRef( RunResults[7]:DRtgElecEnergy ) + LocalRef( RunResults[7]:DRtgNatGasEnergy ) + LocalRef( RunResults[7]:DRtgOtherEnergy )   }

  ; Plug Loads
	"Store energy use - Elec   - Plugs"		Proj:RunResults[8]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrElec",   "Rcp" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - Plugs"		Proj:RunResults[8]:DRtgNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrNatGas", "Rcp" ) / CondFloorArea  endif  }
	"Store energy use - Other  - Plugs"		Proj:RunResults[8]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrOther",  "Rcp" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - Plugs"		Proj:RunResults[8]:DRtgTotalEnergy		= {	LocalRef( RunResults[8]:DRtgElecEnergy ) + LocalRef( RunResults[8]:DRtgNatGasEnergy ) + LocalRef( RunResults[8]:DRtgOtherEnergy )   }

  ; Exterior
	"Store energy use - Elec   - Ext"		Proj:RunResults[9]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrElec",   "Ext" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - Ext"		Proj:RunResults[9]:DRtgNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrNatGas", "Ext" ) / CondFloorArea  endif  }
	"Store energy use - Other  - Ext"		Proj:RunResults[9]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrOther",  "Ext" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - Ext"		Proj:RunResults[9]:DRtgTotalEnergy		= {	LocalRef( RunResults[9]:DRtgElecEnergy ) + LocalRef( RunResults[9]:DRtgNatGasEnergy ) + LocalRef( RunResults[9]:DRtgOtherEnergy )   }

  ; PV
	"Store energy use - Elec   - PV"			Proj:RunResults[13]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrElec", "PV" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - PV"			Proj:RunResults[13]:DRtgNatGasEnergy	= {	0  }
	"Store energy use - Other  - PV"			Proj:RunResults[13]:DRtgOtherEnergy		= {	0  }
	"Store energy use - TOTAL  - PV"			Proj:RunResults[13]:DRtgTotalEnergy		= {	LocalRef( RunResults[13]:DRtgElecEnergy )   }

  ; Battery
	"Store energy use - Elec   - Battery"	Proj:RunResults[14]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																							else  HourlyResultSum( RunID, "MtrElec", "BT" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - Battery"	Proj:RunResults[14]:DRtgNatGasEnergy	= {	0  }
	"Store energy use - Other  - Battery"	Proj:RunResults[14]:DRtgOtherEnergy		= {	0  }
	"Store energy use - TOTAL  - Battery"	Proj:RunResults[14]:DRtgTotalEnergy		= {	LocalRef( RunResults[14]:DRtgElecEnergy )   }

  ; Compliance Total
	"Store energy use - Elec   - Comp Ttl"	Proj:RunResults[11]:DRtgElecEnergy		= {	RunResults[1]:DRtgElecEnergy   + RunResults[2]:DRtgElecEnergy   + RunResults[3]:DRtgElecEnergy   + RunResults[4]:DRtgElecEnergy   + RunResults[5]:DRtgElecEnergy    }
	"Store energy use - NatGas - Comp Ttl"	Proj:RunResults[11]:DRtgNatGasEnergy	= {	RunResults[1]:DRtgNatGasEnergy + RunResults[2]:DRtgNatGasEnergy + RunResults[3]:DRtgNatGasEnergy + RunResults[4]:DRtgNatGasEnergy + RunResults[5]:DRtgNatGasEnergy  }
	"Store energy use - Other  - Comp Ttl"	Proj:RunResults[11]:DRtgOtherEnergy		= {	RunResults[1]:DRtgOtherEnergy  + RunResults[2]:DRtgOtherEnergy  + RunResults[3]:DRtgOtherEnergy  + RunResults[4]:DRtgOtherEnergy  + RunResults[5]:DRtgOtherEnergy   }
	"Store energy use - TOTAL  - Comp Ttl"	Proj:RunResults[11]:DRtgTotalEnergy		= {	RunResults[1]:DRtgTotalEnergy  + RunResults[2]:DRtgTotalEnergy  + RunResults[3]:DRtgTotalEnergy  + RunResults[4]:DRtgTotalEnergy  + RunResults[5]:DRtgTotalEnergy   }

  ; Total
	"Store energy use - Elec   - Total"		Proj:RunResults[10]:DRtgElecEnergy		= {	RunResults[11]:DRtgElecEnergy   + RunResults[6]:DRtgElecEnergy   + RunResults[7]:DRtgElecEnergy   + RunResults[8]:DRtgElecEnergy   + RunResults[9]:DRtgElecEnergy    }
	"Store energy use - NatGas - Total"		Proj:RunResults[10]:DRtgNatGasEnergy	= {	RunResults[11]:DRtgNatGasEnergy + RunResults[6]:DRtgNatGasEnergy + RunResults[7]:DRtgNatGasEnergy + RunResults[8]:DRtgNatGasEnergy + RunResults[9]:DRtgNatGasEnergy  }
	"Store energy use - Other  - Total"		Proj:RunResults[10]:DRtgOtherEnergy		= {	RunResults[11]:DRtgOtherEnergy  + RunResults[6]:DRtgOtherEnergy  + RunResults[7]:DRtgOtherEnergy  + RunResults[8]:DRtgOtherEnergy  + RunResults[9]:DRtgOtherEnergy   }
	"Store energy use - TOTAL  - Total"		Proj:RunResults[10]:DRtgTotalEnergy		= {	RunResults[11]:DRtgTotalEnergy  + RunResults[6]:DRtgTotalEnergy  + RunResults[7]:DRtgTotalEnergy  + RunResults[8]:DRtgTotalEnergy  + RunResults[9]:DRtgTotalEnergy   }

  ; SAC 1/26/18 - calc design rating reference run CO2 emissions by enduse
   "Call rulelist to calc design rating reference model CO2 emissions"  Proj:Action = {
         if (EnergyCodeYearNum < 2019) then  UNCHANGED
         else  EvalRulelist( "CARes_DesignRatingResults_Carbon" )  endif  }

   "Set PV reporting properties"    Proj:Action = {  EvalRulelist( "CARes_Results_PVReporting" )  }
END


;*************************************************************************
RULELIST "CARes_StandardResults_NESW" 1 0 1 1
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
;*************************************************************************
   "Set ResultSummary[2]:StdDesignPVSize"    Proj:ResultSummary[2]:StdDesignPVSize  = {  if (EnergyCodeYearNum < 2019) then  UNCHANGED  else  PVWDCSysSize[1]  endif  }    ; SAC 1/11/18
   "Set ResultSummary[3]:StdDesignPVSize"    Proj:ResultSummary[3]:StdDesignPVSize  = {  ResultSummary[2]:StdDesignPVSize  }
   "Set ResultSummary[4]:StdDesignPVSize"    Proj:ResultSummary[4]:StdDesignPVSize  = {  ResultSummary[2]:StdDesignPVSize  }
   "Set ResultSummary[5]:StdDesignPVSize"    Proj:ResultSummary[5]:StdDesignPVSize  = {  ResultSummary[2]:StdDesignPVSize  }

   "Set ResultSummary[2]:ResultsNotes[5]"        Proj:ResultSummary[2]:ResultsNotes[5]        = {  if (EnergyCodeYearNum < 2019) then  UNCHANGED  else  Format( "Standard Design PV Capacity: %.2f kWdc", ResultSummary[2]:StdDesignPVSize )  endif  }   ; SAC 8/30/19 - added 'dc' (tic #1056)
	"Set ResultSummary[2]:HaveResultsNotesPV[5]"  Proj:ResultSummary[2]:HaveResultsNotesPV[5]  = {  if (EnergyCodeYearNum < 2019) then  UNCHANGED  else  1  endif  }
   "Set ResultSummary[3]:ResultsNotes[5]"        Proj:ResultSummary[3]:ResultsNotes[5]        = {  ResultSummary[2]:ResultsNotes[5]        }
	"Set ResultSummary[3]:HaveResultsNotesPV[5]"  Proj:ResultSummary[3]:HaveResultsNotesPV[5]  = {  ResultSummary[2]:HaveResultsNotesPV[5]  }
   "Set ResultSummary[4]:ResultsNotes[5]"        Proj:ResultSummary[4]:ResultsNotes[5]        = {  ResultSummary[2]:ResultsNotes[5]        }
	"Set ResultSummary[4]:HaveResultsNotesPV[5]"  Proj:ResultSummary[4]:HaveResultsNotesPV[5]  = {  ResultSummary[2]:HaveResultsNotesPV[5]  }
   "Set ResultSummary[5]:ResultsNotes[5]"        Proj:ResultSummary[5]:ResultsNotes[5]        = {  ResultSummary[2]:ResultsNotes[5]        }
	"Set ResultSummary[5]:HaveResultsNotesPV[5]"  Proj:ResultSummary[5]:HaveResultsNotesPV[5]  = {  ResultSummary[2]:HaveResultsNotesPV[5]  }

  ; Space Heating (& heating fan)
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
	"Store energy use - Elec   - N-SpcHt"		Proj:RunResultsN[1]:StdElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Htg", "HPBU", "FanH",   "Aux", "Fan" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - N-SpcHt"		Proj:RunResultsN[1]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Htg", "HPBU", "Aux"         ) / CondFloorArea  endif  }
	"Store energy use - Other  - N-SpcHt"		Proj:RunResultsN[1]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Htg", "HPBU", "Aux"         ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - N-SpcHt"		Proj:RunResultsN[1]:StdTotalEnergy		= {	LocalRef( RunResultsN[1]:StdElecEnergy ) + LocalRef( RunResultsN[1]:StdNatGasEnergy ) + LocalRef( RunResultsN[1]:StdOtherEnergy )   }

  ; Space Cooling (& cooling fan)
	"Store energy use - Elec   - N-SpcCl"		Proj:RunResultsN[2]:StdElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - N-SpcCl"		Proj:RunResultsN[2]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Clg"         ) / CondFloorArea  endif  }
	"Store energy use - Other  - N-SpcCl"		Proj:RunResultsN[2]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Clg"         ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - N-SpcCl"		Proj:RunResultsN[2]:StdTotalEnergy		= {	LocalRef( RunResultsN[2]:StdElecEnergy ) + LocalRef( RunResultsN[2]:StdNatGasEnergy ) + LocalRef( RunResultsN[2]:StdOtherEnergy )   }

  ; IAQ Ventilation Fans
	"Store energy use - Elec   - N-IAQVent"	Proj:RunResultsN[3]:StdElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "FanV" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - N-IAQVent"	Proj:RunResultsN[3]:StdNatGasEnergy		= {	0  }
	"Store energy use - Other  - N-IAQVent"	Proj:RunResultsN[3]:StdOtherEnergy		= {	0  }
	"Store energy use - TOTAL  - N-IAQVent"	Proj:RunResultsN[3]:StdTotalEnergy		= {	LocalRef( RunResultsN[3]:StdElecEnergy )   }

  ; Other HVAC (aux & misc fans)
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
;	"Store energy use - Elec   - N-OthrHVAC"	Proj:RunResultsN[4]:StdElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
;			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Aux", "Fan" ) / CondFloorArea  endif  }
;	"Store energy use - NatGas - N-OthrHVAC"	Proj:RunResultsN[4]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
;			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Aux" ) / CondFloorArea  endif  }
;	"Store energy use - Other  - N-OthrHVAC"	Proj:RunResultsN[4]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
;			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Aux" ) / CondFloorArea  endif  }
;	"Store energy use - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:StdTotalEnergy		= {	LocalRef( RunResultsN[4]:StdElecEnergy ) + LocalRef( RunResultsN[4]:StdNatGasEnergy ) + LocalRef( RunResultsN[4]:StdOtherEnergy )   }
;
	"Zero out - Elec   - N-OthrHVAC"		Proj:RunResultsN[4]:StdElecEnergy		= {	0  }
	"Zero out - NatGas - N-OthrHVAC"	Proj:RunResultsN[4]:StdNatGasEnergy		= {	0  }
	"Zero out - Other  - N-OthrHVAC"	Proj:RunResultsN[4]:StdOtherEnergy		= {	0  }
	"Zero out - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:StdTotalEnergy		= {	0  }

   ; Water Heating
	"Store energy use - Elec   - N-WtrHt"		Proj:RunResultsN[5]:StdElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else if (CSEinclDHWMFL_EU)
			 			  																							   then  HourlyResultSum( RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / CondFloorArea
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / CondFloorArea  endif endif  }
	"Store energy use - NatGas - N-WtrHt"		Proj:RunResultsN[5]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea  endif  }
	"Store energy use - Other  - N-WtrHt"		Proj:RunResultsN[5]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - N-WtrHt"		Proj:RunResultsN[5]:StdTotalEnergy		= {	LocalRef( RunResultsN[5]:StdElecEnergy ) + LocalRef( RunResultsN[5]:StdNatGasEnergy ) + LocalRef( RunResultsN[5]:StdOtherEnergy )   }

  ; Inside Lighting
	"Store energy use - Elec   - N-InsLtg"		Proj:RunResultsN[6]:StdElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Lit" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - N-InsLtg"		Proj:RunResultsN[6]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Lit" ) / CondFloorArea  endif  }
	"Store energy use - Other  - N-InsLtg"		Proj:RunResultsN[6]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Lit" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - N-InsLtg"		Proj:RunResultsN[6]:StdTotalEnergy		= {	LocalRef( RunResultsN[6]:StdElecEnergy ) + LocalRef( RunResultsN[6]:StdNatGasEnergy ) + LocalRef( RunResultsN[6]:StdOtherEnergy )   }

  ; Appliances & Cooking
	"Store energy use - Elec   - N-AppCkg"		Proj:RunResultsN[7]:StdElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - N-AppCkg"		Proj:RunResultsN[7]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea  endif  }
	"Store energy use - Other  - N-AppCkg"		Proj:RunResultsN[7]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - N-AppCkg"		Proj:RunResultsN[7]:StdTotalEnergy		= {	LocalRef( RunResultsN[7]:StdElecEnergy ) + LocalRef( RunResultsN[7]:StdNatGasEnergy ) + LocalRef( RunResultsN[7]:StdOtherEnergy )   }

  ; Plug Loads
	"Store energy use - Elec   - N-Plugs"		Proj:RunResultsN[8]:StdElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Rcp" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - N-Plugs"		Proj:RunResultsN[8]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Rcp" ) / CondFloorArea  endif  }
	"Store energy use - Other  - N-Plugs"		Proj:RunResultsN[8]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Rcp" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - N-Plugs"		Proj:RunResultsN[8]:StdTotalEnergy		= {	LocalRef( RunResultsN[8]:StdElecEnergy ) + LocalRef( RunResultsN[8]:StdNatGasEnergy ) + LocalRef( RunResultsN[8]:StdOtherEnergy )   }

  ; Exterior
	"Store energy use - Elec   - N-Ext"			Proj:RunResultsN[9]:StdElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Ext" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - N-Ext"			Proj:RunResultsN[9]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Ext" ) / CondFloorArea  endif  }
	"Store energy use - Other  - N-Ext"			Proj:RunResultsN[9]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Ext" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - N-Ext"			Proj:RunResultsN[9]:StdTotalEnergy		= {	LocalRef( RunResultsN[9]:StdElecEnergy ) + LocalRef( RunResultsN[9]:StdNatGasEnergy ) + LocalRef( RunResultsN[9]:StdOtherEnergy )   }

  ; PV
	"Store energy use - Elec   - N-PV"			Proj:RunResultsN[13]:StdElecEnergy		= {	if (Local( Fuel_HaveElec ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec", "PV" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - N-PV"			Proj:RunResultsN[13]:StdNatGasEnergy	= {	0  }
	"Store energy use - Other  - N-PV"			Proj:RunResultsN[13]:StdOtherEnergy		= {	0  }
	"Store energy use - TOTAL  - N-PV"			Proj:RunResultsN[13]:StdTotalEnergy		= {	LocalRef( RunResultsN[13]:StdElecEnergy )   }

  ; Battery
	"Store energy use - Elec   - N-Battery"	Proj:RunResultsN[14]:StdElecEnergy		= {	if (Local( Fuel_HaveElec ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec", "BT" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - N-Battery"	Proj:RunResultsN[14]:StdNatGasEnergy	= {	0  }
	"Store energy use - Other  - N-Battery"	Proj:RunResultsN[14]:StdOtherEnergy		= {	0  }
	"Store energy use - TOTAL  - N-Battery"	Proj:RunResultsN[14]:StdTotalEnergy		= {	LocalRef( RunResultsN[14]:StdElecEnergy )   }

; SAC 11/20/14 - fixed bug where RunResultsN totals were summing values from RunResults (no trailing 'N'), which are not yet set.
  ; Compliance Total
	"Store energy use - Elec   - N-Comp Ttl"	Proj:RunResultsN[11]:StdElecEnergy		= {	RunResultsN[1]:StdElecEnergy   + RunResultsN[2]:StdElecEnergy   + RunResultsN[3]:StdElecEnergy   + RunResultsN[4]:StdElecEnergy   + RunResultsN[5]:StdElecEnergy    }
	"Store energy use - NatGas - N-Comp Ttl"	Proj:RunResultsN[11]:StdNatGasEnergy	= {	RunResultsN[1]:StdNatGasEnergy + RunResultsN[2]:StdNatGasEnergy + RunResultsN[3]:StdNatGasEnergy + RunResultsN[4]:StdNatGasEnergy + RunResultsN[5]:StdNatGasEnergy  }
	"Store energy use - Other  - N-Comp Ttl"	Proj:RunResultsN[11]:StdOtherEnergy		= {	RunResultsN[1]:StdOtherEnergy  + RunResultsN[2]:StdOtherEnergy  + RunResultsN[3]:StdOtherEnergy  + RunResultsN[4]:StdOtherEnergy  + RunResultsN[5]:StdOtherEnergy   }
	"Store energy use - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:StdTotalEnergy		= {	RunResultsN[1]:StdTotalEnergy  + RunResultsN[2]:StdTotalEnergy  + RunResultsN[3]:StdTotalEnergy  + RunResultsN[4]:StdTotalEnergy  + RunResultsN[5]:StdTotalEnergy   }

  ; Total
	"Store energy use - Elec   - N-Total"		Proj:RunResultsN[10]:StdElecEnergy		= {	RunResultsN[11]:StdElecEnergy   + RunResultsN[6]:StdElecEnergy   + RunResultsN[7]:StdElecEnergy   + RunResultsN[8]:StdElecEnergy   + RunResultsN[9]:StdElecEnergy   + RunResultsN[13]:StdElecEnergy   + RunResultsN[14]:StdElecEnergy    }
	"Store energy use - NatGas - N-Total"		Proj:RunResultsN[10]:StdNatGasEnergy	= {	RunResultsN[11]:StdNatGasEnergy + RunResultsN[6]:StdNatGasEnergy + RunResultsN[7]:StdNatGasEnergy + RunResultsN[8]:StdNatGasEnergy + RunResultsN[9]:StdNatGasEnergy + RunResultsN[13]:StdNatGasEnergy + RunResultsN[14]:StdNatGasEnergy  }
	"Store energy use - Other  - N-Total"		Proj:RunResultsN[10]:StdOtherEnergy		= {	RunResultsN[11]:StdOtherEnergy  + RunResultsN[6]:StdOtherEnergy  + RunResultsN[7]:StdOtherEnergy  + RunResultsN[8]:StdOtherEnergy  + RunResultsN[9]:StdOtherEnergy  + RunResultsN[13]:StdOtherEnergy  + RunResultsN[14]:StdOtherEnergy   }
	"Store energy use - TOTAL  - N-Total"		Proj:RunResultsN[10]:StdTotalEnergy		= {	RunResultsN[11]:StdTotalEnergy  + RunResultsN[6]:StdTotalEnergy  + RunResultsN[7]:StdTotalEnergy  + RunResultsN[8]:StdTotalEnergy  + RunResultsN[9]:StdTotalEnergy  + RunResultsN[13]:StdTotalEnergy  + RunResultsN[14]:StdTotalEnergy   }

; -- COPY N results to E --
  ; Space Heating (& heating fan)
	"Store energy use - Elec   - E-SpcHt"		Proj:RunResultsE[1]:StdElecEnergy		= {	RunResultsN[1]:StdElecEnergy     }
	"Store energy use - NatGas - E-SpcHt"		Proj:RunResultsE[1]:StdNatGasEnergy		= {	RunResultsN[1]:StdNatGasEnergy   }
	"Store energy use - Other  - E-SpcHt"		Proj:RunResultsE[1]:StdOtherEnergy		= {	RunResultsN[1]:StdOtherEnergy    }
	"Store energy use - TOTAL  - E-SpcHt"		Proj:RunResultsE[1]:StdTotalEnergy		= {	RunResultsN[1]:StdTotalEnergy    }
  ; Space Cooling (& cooling fan)
	"Store energy use - Elec   - E-SpcCl"		Proj:RunResultsE[2]:StdElecEnergy		= {	RunResultsN[2]:StdElecEnergy     }
	"Store energy use - NatGas - E-SpcCl"		Proj:RunResultsE[2]:StdNatGasEnergy		= {	RunResultsN[2]:StdNatGasEnergy   }
	"Store energy use - Other  - E-SpcCl"		Proj:RunResultsE[2]:StdOtherEnergy		= {	RunResultsN[2]:StdOtherEnergy    }
	"Store energy use - TOTAL  - E-SpcCl"		Proj:RunResultsE[2]:StdTotalEnergy		= {	RunResultsN[2]:StdTotalEnergy    }
  ; IAQ Ventilation Fans                                                                                                 
	"Store energy use - Elec   - E-IAQVent"	Proj:RunResultsE[3]:StdElecEnergy		= {	RunResultsN[3]:StdElecEnergy     }
	"Store energy use - NatGas - E-IAQVent"	Proj:RunResultsE[3]:StdNatGasEnergy		= {	RunResultsN[3]:StdNatGasEnergy   }
	"Store energy use - Other  - E-IAQVent"	Proj:RunResultsE[3]:StdOtherEnergy		= {	RunResultsN[3]:StdOtherEnergy    }
	"Store energy use - TOTAL  - E-IAQVent"	Proj:RunResultsE[3]:StdTotalEnergy		= {	RunResultsN[3]:StdTotalEnergy    }
  ; Other HVAC (aux & misc fans)                                                                                         
	"Store energy use - Elec   - E-OthrHVAC"	Proj:RunResultsE[4]:StdElecEnergy		= {	RunResultsN[4]:StdElecEnergy     }
	"Store energy use - NatGas - E-OthrHVAC"	Proj:RunResultsE[4]:StdNatGasEnergy		= {	RunResultsN[4]:StdNatGasEnergy   }
	"Store energy use - Other  - E-OthrHVAC"	Proj:RunResultsE[4]:StdOtherEnergy		= {	RunResultsN[4]:StdOtherEnergy    }
	"Store energy use - TOTAL  - E-OthrHVAC"	Proj:RunResultsE[4]:StdTotalEnergy		= {	RunResultsN[4]:StdTotalEnergy    }
  ; Water Heating                                                                                                        
	"Store energy use - Elec   - E-WtrHt"		Proj:RunResultsE[5]:StdElecEnergy		= {	RunResultsN[5]:StdElecEnergy     }
	"Store energy use - NatGas - E-WtrHt"		Proj:RunResultsE[5]:StdNatGasEnergy		= {	RunResultsN[5]:StdNatGasEnergy   }
	"Store energy use - Other  - E-WtrHt"		Proj:RunResultsE[5]:StdOtherEnergy		= {	RunResultsN[5]:StdOtherEnergy    }
	"Store energy use - TOTAL  - E-WtrHt"		Proj:RunResultsE[5]:StdTotalEnergy		= {	RunResultsN[5]:StdTotalEnergy    }
  ; Inside Lighting                                                                                                      
	"Store energy use - Elec   - E-InsLtg"		Proj:RunResultsE[6]:StdElecEnergy		= {	RunResultsN[6]:StdElecEnergy     }
	"Store energy use - NatGas - E-InsLtg"		Proj:RunResultsE[6]:StdNatGasEnergy		= {	RunResultsN[6]:StdNatGasEnergy   }
	"Store energy use - Other  - E-InsLtg"		Proj:RunResultsE[6]:StdOtherEnergy		= {	RunResultsN[6]:StdOtherEnergy    }
	"Store energy use - TOTAL  - E-InsLtg"		Proj:RunResultsE[6]:StdTotalEnergy		= {	RunResultsN[6]:StdTotalEnergy    }
  ; Appliances & Cooking                                                                                                 
	"Store energy use - Elec   - E-AppCkg"		Proj:RunResultsE[7]:StdElecEnergy		= {	RunResultsN[7]:StdElecEnergy     }
	"Store energy use - NatGas - E-AppCkg"		Proj:RunResultsE[7]:StdNatGasEnergy		= {	RunResultsN[7]:StdNatGasEnergy   }
	"Store energy use - Other  - E-AppCkg"		Proj:RunResultsE[7]:StdOtherEnergy		= {	RunResultsN[7]:StdOtherEnergy    }
	"Store energy use - TOTAL  - E-AppCkg"		Proj:RunResultsE[7]:StdTotalEnergy		= {	RunResultsN[7]:StdTotalEnergy    }
  ; Plug Loads                                                                                                           
	"Store energy use - Elec   - E-Plugs"		Proj:RunResultsE[8]:StdElecEnergy		= {	RunResultsN[8]:StdElecEnergy     }
	"Store energy use - NatGas - E-Plugs"		Proj:RunResultsE[8]:StdNatGasEnergy		= {	RunResultsN[8]:StdNatGasEnergy   }
	"Store energy use - Other  - E-Plugs"		Proj:RunResultsE[8]:StdOtherEnergy		= {	RunResultsN[8]:StdOtherEnergy    }
	"Store energy use - TOTAL  - E-Plugs"		Proj:RunResultsE[8]:StdTotalEnergy		= {	RunResultsN[8]:StdTotalEnergy    }
  ; Exterior                                                                                                             
	"Store energy use - Elec   - E-Ext"			Proj:RunResultsE[9]:StdElecEnergy		= {	RunResultsN[9]:StdElecEnergy     }
	"Store energy use - NatGas - E-Ext"			Proj:RunResultsE[9]:StdNatGasEnergy		= {	RunResultsN[9]:StdNatGasEnergy   }
	"Store energy use - Other  - E-Ext"			Proj:RunResultsE[9]:StdOtherEnergy		= {	RunResultsN[9]:StdOtherEnergy    }
	"Store energy use - TOTAL  - E-Ext"			Proj:RunResultsE[9]:StdTotalEnergy		= {	RunResultsN[9]:StdTotalEnergy    }
  ; PV
	"Store energy use - Elec   - E-PV"			Proj:RunResultsE[13]:StdElecEnergy		= {	RunResultsN[13]:StdElecEnergy    }
	"Store energy use - NatGas - E-PV"			Proj:RunResultsE[13]:StdNatGasEnergy	= {	RunResultsN[13]:StdNatGasEnergy  }
	"Store energy use - Other  - E-PV"			Proj:RunResultsE[13]:StdOtherEnergy		= {	RunResultsN[13]:StdOtherEnergy   }
	"Store energy use - TOTAL  - E-PV"			Proj:RunResultsE[13]:StdTotalEnergy		= {	RunResultsN[13]:StdTotalEnergy   }
  ; Battery
	"Store energy use - Elec   - E-Battery"	Proj:RunResultsE[14]:StdElecEnergy		= {	RunResultsN[14]:StdElecEnergy    }
	"Store energy use - NatGas - E-Battery"	Proj:RunResultsE[14]:StdNatGasEnergy	= {	RunResultsN[14]:StdNatGasEnergy  }
	"Store energy use - Other  - E-Battery"	Proj:RunResultsE[14]:StdOtherEnergy		= {	RunResultsN[14]:StdOtherEnergy   }
	"Store energy use - TOTAL  - E-Battery"	Proj:RunResultsE[14]:StdTotalEnergy		= {	RunResultsN[14]:StdTotalEnergy   }
  ; Compliance Total                                                                                                     
	"Store energy use - Elec   - E-Comp Ttl"	Proj:RunResultsE[11]:StdElecEnergy		= {	RunResultsN[11]:StdElecEnergy    }
	"Store energy use - NatGas - E-Comp Ttl"	Proj:RunResultsE[11]:StdNatGasEnergy	= {	RunResultsN[11]:StdNatGasEnergy  }
	"Store energy use - Other  - E-Comp Ttl"	Proj:RunResultsE[11]:StdOtherEnergy		= {	RunResultsN[11]:StdOtherEnergy   }
	"Store energy use - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:StdTotalEnergy		= {	RunResultsN[11]:StdTotalEnergy   }
  ; Total                                                                                                                
	"Store energy use - Elec   - E-Total"		Proj:RunResultsE[10]:StdElecEnergy		= {	RunResultsN[10]:StdElecEnergy    }
	"Store energy use - NatGas - E-Total"		Proj:RunResultsE[10]:StdNatGasEnergy	= {	RunResultsN[10]:StdNatGasEnergy  }
	"Store energy use - Other  - E-Total"		Proj:RunResultsE[10]:StdOtherEnergy		= {	RunResultsN[10]:StdOtherEnergy   }
	"Store energy use - TOTAL  - E-Total"		Proj:RunResultsE[10]:StdTotalEnergy		= {	RunResultsN[10]:StdTotalEnergy   }

; -- COPY N results to S --
  ; Space Heating (& heating fan)
	"Store energy use - Elec   - S-SpcHt"		Proj:RunResultsS[1]:StdElecEnergy		= {	RunResultsN[1]:StdElecEnergy     }
	"Store energy use - NatGas - S-SpcHt"		Proj:RunResultsS[1]:StdNatGasEnergy		= {	RunResultsN[1]:StdNatGasEnergy   }
	"Store energy use - Other  - S-SpcHt"		Proj:RunResultsS[1]:StdOtherEnergy		= {	RunResultsN[1]:StdOtherEnergy    }
	"Store energy use - TOTAL  - S-SpcHt"		Proj:RunResultsS[1]:StdTotalEnergy		= {	RunResultsN[1]:StdTotalEnergy    }
  ; Space Cooling (& cooling fan)
	"Store energy use - Elec   - S-SpcCl"		Proj:RunResultsS[2]:StdElecEnergy		= {	RunResultsN[2]:StdElecEnergy     }
	"Store energy use - NatGas - S-SpcCl"		Proj:RunResultsS[2]:StdNatGasEnergy		= {	RunResultsN[2]:StdNatGasEnergy   }
	"Store energy use - Other  - S-SpcCl"		Proj:RunResultsS[2]:StdOtherEnergy		= {	RunResultsN[2]:StdOtherEnergy    }
	"Store energy use - TOTAL  - S-SpcCl"		Proj:RunResultsS[2]:StdTotalEnergy		= {	RunResultsN[2]:StdTotalEnergy    }
  ; IAQ Ventilation Fans                                                                                                 
	"Store energy use - Elec   - S-IAQVent"	Proj:RunResultsS[3]:StdElecEnergy		= {	RunResultsN[3]:StdElecEnergy     }
	"Store energy use - NatGas - S-IAQVent"	Proj:RunResultsS[3]:StdNatGasEnergy		= {	RunResultsN[3]:StdNatGasEnergy   }
	"Store energy use - Other  - S-IAQVent"	Proj:RunResultsS[3]:StdOtherEnergy		= {	RunResultsN[3]:StdOtherEnergy    }
	"Store energy use - TOTAL  - S-IAQVent"	Proj:RunResultsS[3]:StdTotalEnergy		= {	RunResultsN[3]:StdTotalEnergy    }
  ; Other HVAC (aux & misc fans)                                                                                         
	"Store energy use - Elec   - S-OthrHVAC"	Proj:RunResultsS[4]:StdElecEnergy		= {	RunResultsN[4]:StdElecEnergy     }
	"Store energy use - NatGas - S-OthrHVAC"	Proj:RunResultsS[4]:StdNatGasEnergy		= {	RunResultsN[4]:StdNatGasEnergy   }
	"Store energy use - Other  - S-OthrHVAC"	Proj:RunResultsS[4]:StdOtherEnergy		= {	RunResultsN[4]:StdOtherEnergy    }
	"Store energy use - TOTAL  - S-OthrHVAC"	Proj:RunResultsS[4]:StdTotalEnergy		= {	RunResultsN[4]:StdTotalEnergy    }
  ; Water Heating                                                                                                        
	"Store energy use - Elec   - S-WtrHt"		Proj:RunResultsS[5]:StdElecEnergy		= {	RunResultsN[5]:StdElecEnergy     }
	"Store energy use - NatGas - S-WtrHt"		Proj:RunResultsS[5]:StdNatGasEnergy		= {	RunResultsN[5]:StdNatGasEnergy   }
	"Store energy use - Other  - S-WtrHt"		Proj:RunResultsS[5]:StdOtherEnergy		= {	RunResultsN[5]:StdOtherEnergy    }
	"Store energy use - TOTAL  - S-WtrHt"		Proj:RunResultsS[5]:StdTotalEnergy		= {	RunResultsN[5]:StdTotalEnergy    }
  ; Inside Lighting                                                                                                      
	"Store energy use - Elec   - S-InsLtg"		Proj:RunResultsS[6]:StdElecEnergy		= {	RunResultsN[6]:StdElecEnergy     }
	"Store energy use - NatGas - S-InsLtg"		Proj:RunResultsS[6]:StdNatGasEnergy		= {	RunResultsN[6]:StdNatGasEnergy   }
	"Store energy use - Other  - S-InsLtg"		Proj:RunResultsS[6]:StdOtherEnergy		= {	RunResultsN[6]:StdOtherEnergy    }
	"Store energy use - TOTAL  - S-InsLtg"		Proj:RunResultsS[6]:StdTotalEnergy		= {	RunResultsN[6]:StdTotalEnergy    }
  ; Appliances & Cooking                                                                                                 
	"Store energy use - Elec   - S-AppCkg"		Proj:RunResultsS[7]:StdElecEnergy		= {	RunResultsN[7]:StdElecEnergy     }
	"Store energy use - NatGas - S-AppCkg"		Proj:RunResultsS[7]:StdNatGasEnergy		= {	RunResultsN[7]:StdNatGasEnergy   }
	"Store energy use - Other  - S-AppCkg"		Proj:RunResultsS[7]:StdOtherEnergy		= {	RunResultsN[7]:StdOtherEnergy    }
	"Store energy use - TOTAL  - S-AppCkg"		Proj:RunResultsS[7]:StdTotalEnergy		= {	RunResultsN[7]:StdTotalEnergy    }
  ; Plug Loads                                                                                                           
	"Store energy use - Elec   - S-Plugs"		Proj:RunResultsS[8]:StdElecEnergy		= {	RunResultsN[8]:StdElecEnergy     }
	"Store energy use - NatGas - S-Plugs"		Proj:RunResultsS[8]:StdNatGasEnergy		= {	RunResultsN[8]:StdNatGasEnergy   }
	"Store energy use - Other  - S-Plugs"		Proj:RunResultsS[8]:StdOtherEnergy		= {	RunResultsN[8]:StdOtherEnergy    }
	"Store energy use - TOTAL  - S-Plugs"		Proj:RunResultsS[8]:StdTotalEnergy		= {	RunResultsN[8]:StdTotalEnergy    }
  ; Exterior                                                                                                             
	"Store energy use - Elec   - S-Ext"			Proj:RunResultsS[9]:StdElecEnergy		= {	RunResultsN[9]:StdElecEnergy     }
	"Store energy use - NatGas - S-Ext"			Proj:RunResultsS[9]:StdNatGasEnergy		= {	RunResultsN[9]:StdNatGasEnergy   }
	"Store energy use - Other  - S-Ext"			Proj:RunResultsS[9]:StdOtherEnergy		= {	RunResultsN[9]:StdOtherEnergy    }
	"Store energy use - TOTAL  - S-Ext"			Proj:RunResultsS[9]:StdTotalEnergy		= {	RunResultsN[9]:StdTotalEnergy    }
  ; PV
	"Store energy use - Elec   - S-PV"			Proj:RunResultsS[13]:StdElecEnergy		= {	RunResultsN[13]:StdElecEnergy    }
	"Store energy use - NatGas - S-PV"			Proj:RunResultsS[13]:StdNatGasEnergy	= {	RunResultsN[13]:StdNatGasEnergy  }
	"Store energy use - Other  - S-PV"			Proj:RunResultsS[13]:StdOtherEnergy		= {	RunResultsN[13]:StdOtherEnergy   }
	"Store energy use - TOTAL  - S-PV"			Proj:RunResultsS[13]:StdTotalEnergy		= {	RunResultsN[13]:StdTotalEnergy   }
  ; Battery
	"Store energy use - Elec   - S-Battery"	Proj:RunResultsS[14]:StdElecEnergy		= {	RunResultsN[14]:StdElecEnergy    }
	"Store energy use - NatGas - S-Battery"	Proj:RunResultsS[14]:StdNatGasEnergy	= {	RunResultsN[14]:StdNatGasEnergy  }
	"Store energy use - Other  - S-Battery"	Proj:RunResultsS[14]:StdOtherEnergy		= {	RunResultsN[14]:StdOtherEnergy   }
	"Store energy use - TOTAL  - S-Battery"	Proj:RunResultsS[14]:StdTotalEnergy		= {	RunResultsN[14]:StdTotalEnergy   }
  ; Compliance Total                                                                                                     
	"Store energy use - Elec   - S-Comp Ttl"	Proj:RunResultsS[11]:StdElecEnergy		= {	RunResultsN[11]:StdElecEnergy    }
	"Store energy use - NatGas - S-Comp Ttl"	Proj:RunResultsS[11]:StdNatGasEnergy	= {	RunResultsN[11]:StdNatGasEnergy  }
	"Store energy use - Other  - S-Comp Ttl"	Proj:RunResultsS[11]:StdOtherEnergy		= {	RunResultsN[11]:StdOtherEnergy   }
	"Store energy use - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:StdTotalEnergy		= {	RunResultsN[11]:StdTotalEnergy   }
  ; Total                                                                                                                
	"Store energy use - Elec   - S-Total"		Proj:RunResultsS[10]:StdElecEnergy		= {	RunResultsN[10]:StdElecEnergy    }
	"Store energy use - NatGas - S-Total"		Proj:RunResultsS[10]:StdNatGasEnergy	= {	RunResultsN[10]:StdNatGasEnergy  }
	"Store energy use - Other  - S-Total"		Proj:RunResultsS[10]:StdOtherEnergy		= {	RunResultsN[10]:StdOtherEnergy   }
	"Store energy use - TOTAL  - S-Total"		Proj:RunResultsS[10]:StdTotalEnergy		= {	RunResultsN[10]:StdTotalEnergy   }

; -- COPY N results to W --
  ; Space Heating (& heating fan)
	"Store energy use - Elec   - W-SpcHt"		Proj:RunResultsW[1]:StdElecEnergy		= {	RunResultsN[1]:StdElecEnergy     }
	"Store energy use - NatGas - W-SpcHt"		Proj:RunResultsW[1]:StdNatGasEnergy		= {	RunResultsN[1]:StdNatGasEnergy   }
	"Store energy use - Other  - W-SpcHt"		Proj:RunResultsW[1]:StdOtherEnergy		= {	RunResultsN[1]:StdOtherEnergy    }
	"Store energy use - TOTAL  - W-SpcHt"		Proj:RunResultsW[1]:StdTotalEnergy		= {	RunResultsN[1]:StdTotalEnergy    }
  ; Space Cooling (& cooling fan)
	"Store energy use - Elec   - W-SpcCl"		Proj:RunResultsW[2]:StdElecEnergy		= {	RunResultsN[2]:StdElecEnergy     }
	"Store energy use - NatGas - W-SpcCl"		Proj:RunResultsW[2]:StdNatGasEnergy		= {	RunResultsN[2]:StdNatGasEnergy   }
	"Store energy use - Other  - W-SpcCl"		Proj:RunResultsW[2]:StdOtherEnergy		= {	RunResultsN[2]:StdOtherEnergy    }
	"Store energy use - TOTAL  - W-SpcCl"		Proj:RunResultsW[2]:StdTotalEnergy		= {	RunResultsN[2]:StdTotalEnergy    }
  ; IAQ Ventilation Fans                                                                                                 
	"Store energy use - Elec   - W-IAQVent"	Proj:RunResultsW[3]:StdElecEnergy		= {	RunResultsN[3]:StdElecEnergy     }
	"Store energy use - NatGas - W-IAQVent"	Proj:RunResultsW[3]:StdNatGasEnergy		= {	RunResultsN[3]:StdNatGasEnergy   }
	"Store energy use - Other  - W-IAQVent"	Proj:RunResultsW[3]:StdOtherEnergy		= {	RunResultsN[3]:StdOtherEnergy    }
	"Store energy use - TOTAL  - W-IAQVent"	Proj:RunResultsW[3]:StdTotalEnergy		= {	RunResultsN[3]:StdTotalEnergy    }
  ; Other HVAC (aux & misc fans)                                                                                         
	"Store energy use - Elec   - W-OthrHVAC"	Proj:RunResultsW[4]:StdElecEnergy		= {	RunResultsN[4]:StdElecEnergy     }
	"Store energy use - NatGas - W-OthrHVAC"	Proj:RunResultsW[4]:StdNatGasEnergy		= {	RunResultsN[4]:StdNatGasEnergy   }
	"Store energy use - Other  - W-OthrHVAC"	Proj:RunResultsW[4]:StdOtherEnergy		= {	RunResultsN[4]:StdOtherEnergy    }
	"Store energy use - TOTAL  - W-OthrHVAC"	Proj:RunResultsW[4]:StdTotalEnergy		= {	RunResultsN[4]:StdTotalEnergy    }
  ; Water Heating                                                                                                        
	"Store energy use - Elec   - W-WtrHt"		Proj:RunResultsW[5]:StdElecEnergy		= {	RunResultsN[5]:StdElecEnergy     }
	"Store energy use - NatGas - W-WtrHt"		Proj:RunResultsW[5]:StdNatGasEnergy		= {	RunResultsN[5]:StdNatGasEnergy   }
	"Store energy use - Other  - W-WtrHt"		Proj:RunResultsW[5]:StdOtherEnergy		= {	RunResultsN[5]:StdOtherEnergy    }
	"Store energy use - TOTAL  - W-WtrHt"		Proj:RunResultsW[5]:StdTotalEnergy		= {	RunResultsN[5]:StdTotalEnergy    }
  ; Inside Lighting                                                                                                      
	"Store energy use - Elec   - W-InsLtg"		Proj:RunResultsW[6]:StdElecEnergy		= {	RunResultsN[6]:StdElecEnergy     }
	"Store energy use - NatGas - W-InsLtg"		Proj:RunResultsW[6]:StdNatGasEnergy		= {	RunResultsN[6]:StdNatGasEnergy   }
	"Store energy use - Other  - W-InsLtg"		Proj:RunResultsW[6]:StdOtherEnergy		= {	RunResultsN[6]:StdOtherEnergy    }
	"Store energy use - TOTAL  - W-InsLtg"		Proj:RunResultsW[6]:StdTotalEnergy		= {	RunResultsN[6]:StdTotalEnergy    }
  ; Appliances & Cooking                                                                                                 
	"Store energy use - Elec   - W-AppCkg"		Proj:RunResultsW[7]:StdElecEnergy		= {	RunResultsN[7]:StdElecEnergy     }
	"Store energy use - NatGas - W-AppCkg"		Proj:RunResultsW[7]:StdNatGasEnergy		= {	RunResultsN[7]:StdNatGasEnergy   }
	"Store energy use - Other  - W-AppCkg"		Proj:RunResultsW[7]:StdOtherEnergy		= {	RunResultsN[7]:StdOtherEnergy    }
	"Store energy use - TOTAL  - W-AppCkg"		Proj:RunResultsW[7]:StdTotalEnergy		= {	RunResultsN[7]:StdTotalEnergy    }
  ; Plug Loads                                                                                                           
	"Store energy use - Elec   - W-Plugs"		Proj:RunResultsW[8]:StdElecEnergy		= {	RunResultsN[8]:StdElecEnergy     }
	"Store energy use - NatGas - W-Plugs"		Proj:RunResultsW[8]:StdNatGasEnergy		= {	RunResultsN[8]:StdNatGasEnergy   }
	"Store energy use - Other  - W-Plugs"		Proj:RunResultsW[8]:StdOtherEnergy		= {	RunResultsN[8]:StdOtherEnergy    }
	"Store energy use - TOTAL  - W-Plugs"		Proj:RunResultsW[8]:StdTotalEnergy		= {	RunResultsN[8]:StdTotalEnergy    }
  ; Exterior                                                                                                             
	"Store energy use - Elec   - W-Ext"			Proj:RunResultsW[9]:StdElecEnergy		= {	RunResultsN[9]:StdElecEnergy     }
	"Store energy use - NatGas - W-Ext"			Proj:RunResultsW[9]:StdNatGasEnergy		= {	RunResultsN[9]:StdNatGasEnergy   }
	"Store energy use - Other  - W-Ext"			Proj:RunResultsW[9]:StdOtherEnergy		= {	RunResultsN[9]:StdOtherEnergy    }
	"Store energy use - TOTAL  - W-Ext"			Proj:RunResultsW[9]:StdTotalEnergy		= {	RunResultsN[9]:StdTotalEnergy    }
  ; PV
	"Store energy use - Elec   - W-PV"			Proj:RunResultsW[13]:StdElecEnergy		= {	RunResultsN[13]:StdElecEnergy    }
	"Store energy use - NatGas - W-PV"			Proj:RunResultsW[13]:StdNatGasEnergy	= {	RunResultsN[13]:StdNatGasEnergy  }
	"Store energy use - Other  - W-PV"			Proj:RunResultsW[13]:StdOtherEnergy		= {	RunResultsN[13]:StdOtherEnergy   }
	"Store energy use - TOTAL  - W-PV"			Proj:RunResultsW[13]:StdTotalEnergy		= {	RunResultsN[13]:StdTotalEnergy   }
  ; Battery
	"Store energy use - Elec   - W-Battery"	Proj:RunResultsW[14]:StdElecEnergy		= {	RunResultsN[14]:StdElecEnergy    }
	"Store energy use - NatGas - W-Battery"	Proj:RunResultsW[14]:StdNatGasEnergy	= {	RunResultsN[14]:StdNatGasEnergy  }
	"Store energy use - Other  - W-Battery"	Proj:RunResultsW[14]:StdOtherEnergy		= {	RunResultsN[14]:StdOtherEnergy   }
	"Store energy use - TOTAL  - W-Battery"	Proj:RunResultsW[14]:StdTotalEnergy		= {	RunResultsN[14]:StdTotalEnergy   }
  ; Compliance Total                                                                                                     
	"Store energy use - Elec   - W-Comp Ttl"	Proj:RunResultsW[11]:StdElecEnergy		= {	RunResultsN[11]:StdElecEnergy    }
	"Store energy use - NatGas - W-Comp Ttl"	Proj:RunResultsW[11]:StdNatGasEnergy	= {	RunResultsN[11]:StdNatGasEnergy  }
	"Store energy use - Other  - W-Comp Ttl"	Proj:RunResultsW[11]:StdOtherEnergy		= {	RunResultsN[11]:StdOtherEnergy   }
	"Store energy use - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:StdTotalEnergy		= {	RunResultsN[11]:StdTotalEnergy   }
  ; Total                                                                                                                
	"Store energy use - Elec   - W-Total"		Proj:RunResultsW[10]:StdElecEnergy		= {	RunResultsN[10]:StdElecEnergy    }
	"Store energy use - NatGas - W-Total"		Proj:RunResultsW[10]:StdNatGasEnergy	= {	RunResultsN[10]:StdNatGasEnergy  }
	"Store energy use - Other  - W-Total"		Proj:RunResultsW[10]:StdOtherEnergy		= {	RunResultsN[10]:StdOtherEnergy   }
	"Store energy use - TOTAL  - W-Total"		Proj:RunResultsW[10]:StdTotalEnergy		= {	RunResultsN[10]:StdTotalEnergy   }

  ; SAC 10/5/17 - added rules to calc carbon emissions by enduse
  ; SAC 1/5/18 - moved here from end of 'CARes_StdMixedFuelResults_NESW' during process of moving StdMixedFuel run to first in analysis sequence
   "Call rulelist to setup std design CO2 emissions"  Proj:Action = {
         if (EnergyCodeYearNum < 2019) then  UNCHANGED
         else  EvalRulelist( "CARes_StandardResults_Carbon_NESW" )  endif  }

   ; SAC 1/19/18 - add reporting proposed PV cap
   "Store max orientation size of PV system actually analyzed-N"  Proj:ResultSummary[1]:PropDesignPVTot  = {
         ValidOr( ResultSummary[2]:PropDesignPVTot, 0 )  }
   "Store max orientation size of PV system actually analyzed-E"  Proj:ResultSummary[1]:PropDesignPVTot  = {
         if (IfValidAnd( ResultSummary[3]:PropDesignPVTot > ResultSummary[1]:PropDesignPVTot )==0) then  UNCHANGED
         else            ResultSummary[3]:PropDesignPVTot  endif  }
   "Store max orientation size of PV system actually analyzed-S"  Proj:ResultSummary[1]:PropDesignPVTot  = {
         if (IfValidAnd( ResultSummary[4]:PropDesignPVTot > ResultSummary[1]:PropDesignPVTot )==0) then  UNCHANGED
         else            ResultSummary[4]:PropDesignPVTot  endif  }
   "Store max orientation size of PV system actually analyzed-W"  Proj:ResultSummary[1]:PropDesignPVTot  = {
         if (IfValidAnd( ResultSummary[5]:PropDesignPVTot > ResultSummary[1]:PropDesignPVTot )==0) then  UNCHANGED
         else            ResultSummary[5]:PropDesignPVTot  endif  }
   "Set PV reporting properties"    Proj:Action = {  EvalRulelist( "CARes_Results_PVReporting" )  }
END

;*************************************************************************
RULELIST "CARes_Results_StoreInputPVSize" 1 0 1 1
;*************************************************************************
   "Store input PV cap-1"     Proj:ResultSummary[1]:PropDesignPVInp[1]  = {
         if (IfValidAnd( PVWDCSysSize[1] > 0 )==0) then  UNDEFINED
         else            PVWDCSysSize[1]   endif  }
   "Store input PV cap-2"     Proj:ResultSummary[1]:PropDesignPVInp[2]  = {
         if (IfValidAnd( PVWDCSysSize[2] > 0 )==0) then  UNDEFINED
         else            PVWDCSysSize[2]   endif  }
   "Store input PV cap-3"     Proj:ResultSummary[1]:PropDesignPVInp[3]  = {
         if (IfValidAnd( PVWDCSysSize[3] > 0 )==0) then  UNDEFINED
         else            PVWDCSysSize[3]   endif  }
   "Store input PV cap-4"     Proj:ResultSummary[1]:PropDesignPVInp[4]  = {
         if (IfValidAnd( PVWDCSysSize[4] > 0 )==0) then  UNDEFINED
         else            PVWDCSysSize[4]   endif  }
   "Store input PV cap-5"     Proj:ResultSummary[1]:PropDesignPVInp[5]  = {
         if (IfValidAnd( PVWDCSysSize[5] > 0 )==0) then  UNDEFINED
         else            PVWDCSysSize[5]   endif  }
   "Store input PV tot-1"     Proj:ResultSummary[1]:PropDesignPVInp[6]  = {                                        ValidOr( ResultSummary[1]:PropDesignPVInp[1], 0 )  }
   "Store input PV cap-2"     Proj:ResultSummary[1]:PropDesignPVInp[6]  = {  ResultSummary[1]:PropDesignPVInp[6] + ValidOr( ResultSummary[1]:PropDesignPVInp[2], 0 )  }
   "Store input PV cap-3"     Proj:ResultSummary[1]:PropDesignPVInp[6]  = {  ResultSummary[1]:PropDesignPVInp[6] + ValidOr( ResultSummary[1]:PropDesignPVInp[3], 0 )  }
   "Store input PV cap-4"     Proj:ResultSummary[1]:PropDesignPVInp[6]  = {  ResultSummary[1]:PropDesignPVInp[6] + ValidOr( ResultSummary[1]:PropDesignPVInp[4], 0 )  }
   "Store input PV cap-5"     Proj:ResultSummary[1]:PropDesignPVInp[6]  = {  ResultSummary[1]:PropDesignPVInp[6] + ValidOr( ResultSummary[1]:PropDesignPVInp[5], 0 )  }
END
;*************************************************************************
RULELIST "CARes_Results_PVReporting" 1 0 1 1
;*************************************************************************
;"dbg" Proj:Action = { MessageBox( "CARes_Results_PVReporting -> PropDesignPVTot %g / EnergyCodeYearNum %g / SpeclFeatrs:PVSysCreditMsg Status %g", ValidOr( ResultSummary[1]:PropDesignPVTot, -999 ), EnergyCodeYearNum, LocalStatus( SpeclFeatrs:PVSysCreditMsg ) )  }
;"dbg" Proj:Action = { PostMessageToLog( "CARes_Results_PVReporting for run '%s' -> PropDesignPVTot %g / EnergyCodeYearNum %g / SpeclFeatrs:PVSysCreditMsg Status %g", RunAbbrev, ValidOr( ResultSummary[1]:PropDesignPVTot, -999 ), EnergyCodeYearNum, LocalStatus( SpeclFeatrs:PVSysCreditMsg ) )  }
   ; SAC 2/20/18 - revised PV capacity decimal precision from 1->2 (tic #921) - SAC 2/26/18 - revised again to reference new PVWDCSysScldTotRnd
   "Set rounded & scaled PV size (based on PropDesignPVTot)"   Proj:Action  = {
         if (IfValidAnd( ResultSummary[1]:PropDesignPVTot > 0 )==0 .OR. EnergyCodeYearNum < 2019 .OR.
             LocalStatus( SpeclFeatrs:PVSysCreditMsg ) < 1) then  UNCHANGED
         else  EvalRulelist( "Set_Proj_PVWDCSysScldTotRnd_by_PropDesignPVTot" )  endif  }
   ; SAC 10/12/18 - added separate PVSysCreditVal property to carry reported PV system capacity separately from message (to facilitate XML schema CF1R rules)
	"Revise PV Capacity Value"             Proj:SpeclFeatrs:PVSysCreditVal = {
         if (IfValidAnd( PVWDCSysScldTotRnd > 0 )==0 .OR. EnergyCodeYearNum < 2019 .OR.
             LocalStatus( SpeclFeatrs:PVSysCreditMsg ) < 1) then  UNDEFINED
         else  PVWDCSysScldTotRnd  endif  }
   "Revise SpeclFeatrs:PVSysCreditMsg"    Proj:SpeclFeatrs:PVSysCreditMsg  = {
         if (LocalStatus( SpeclFeatrs:PVSysCreditVal ) < 1) then  UNDEFINED
         else  Format( "PV System: %s kWdc", FltToStr( SpeclFeatrs:PVSysCreditVal, 2, 0, 0, 1 ) )  endif  }
   "Reset SpeclFeatrs:PVSysCredit flag (if needed)"  Proj:SpeclFeatrs:PVSysCredit  = {
         if (LocalStatus( SpeclFeatrs:PVSysCreditMsg ) < 1) then  0  else  1  endif  }

   "Store analyzed PV cap-1"     Proj:ResultSummary[1]:PropDesignPVSize[1]  = {
         if (IfValidAnd( ResultSummary[1]:PropDesignPVInp[1] > 0 )==0 .OR. IfValidAnd( ResultSummary[1]:PropDesignPVTot > 0 )==0) then  UNDEFINED
         else            ResultSummary[1]:PropDesignPVInp[1] * (ResultSummary[1]:PropDesignPVTot / ResultSummary[1]:PropDesignPVInp[6])  endif  }
   "Store analyzed PV cap-2"     Proj:ResultSummary[1]:PropDesignPVSize[2]  = {
         if (IfValidAnd( ResultSummary[1]:PropDesignPVInp[2] > 0 )==0 .OR. IfValidAnd( ResultSummary[1]:PropDesignPVTot > 0 )==0) then  UNDEFINED
         else            ResultSummary[1]:PropDesignPVInp[2] * (ResultSummary[1]:PropDesignPVTot / ResultSummary[1]:PropDesignPVInp[6])  endif  }
   "Store analyzed PV cap-3"     Proj:ResultSummary[1]:PropDesignPVSize[3]  = {
         if (IfValidAnd( ResultSummary[1]:PropDesignPVInp[3] > 0 )==0 .OR. IfValidAnd( ResultSummary[1]:PropDesignPVTot > 0 )==0) then  UNDEFINED
         else            ResultSummary[1]:PropDesignPVInp[3] * (ResultSummary[1]:PropDesignPVTot / ResultSummary[1]:PropDesignPVInp[6])  endif  }
   "Store analyzed PV cap-4"     Proj:ResultSummary[1]:PropDesignPVSize[4]  = {
         if (IfValidAnd( ResultSummary[1]:PropDesignPVInp[4] > 0 )==0 .OR. IfValidAnd( ResultSummary[1]:PropDesignPVTot > 0 )==0) then  UNDEFINED
         else            ResultSummary[1]:PropDesignPVInp[4] * (ResultSummary[1]:PropDesignPVTot / ResultSummary[1]:PropDesignPVInp[6])  endif  }
   "Store analyzed PV cap-5"     Proj:ResultSummary[1]:PropDesignPVSize[5]  = {
         if (IfValidAnd( ResultSummary[1]:PropDesignPVInp[5] > 0 )==0 .OR. IfValidAnd( ResultSummary[1]:PropDesignPVTot > 0 )==0) then  UNDEFINED
         else            ResultSummary[1]:PropDesignPVInp[5] * (ResultSummary[1]:PropDesignPVTot / ResultSummary[1]:PropDesignPVInp[6])  endif  }
END

;*************************************************************************
RULELIST "CARes_DesignRatingResults_NESW" 1 0 0 1
;*************************************************************************
  ; Space Heating (& heating fan)
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
	"Store energy use - Elec   - N-SpcHt"		Proj:RunResultsN[1]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Htg", "HPBU", "FanH",   "Aux", "Fan" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - N-SpcHt"		Proj:RunResultsN[1]:DRtgNatGasEnergy	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Htg", "HPBU", "Aux"         ) / CondFloorArea  endif  }
	"Store energy use - Other  - N-SpcHt"		Proj:RunResultsN[1]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Htg", "HPBU", "Aux"         ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - N-SpcHt"		Proj:RunResultsN[1]:DRtgTotalEnergy		= {	LocalRef( RunResultsN[1]:DRtgElecEnergy ) + LocalRef( RunResultsN[1]:DRtgNatGasEnergy ) + LocalRef( RunResultsN[1]:DRtgOtherEnergy )   }

  ; Space Cooling (& cooling fan)
	"Store energy use - Elec   - N-SpcCl"		Proj:RunResultsN[2]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - N-SpcCl"		Proj:RunResultsN[2]:DRtgNatGasEnergy	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Clg"         ) / CondFloorArea  endif  }
	"Store energy use - Other  - N-SpcCl"		Proj:RunResultsN[2]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Clg"         ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - N-SpcCl"		Proj:RunResultsN[2]:DRtgTotalEnergy		= {	LocalRef( RunResultsN[2]:DRtgElecEnergy ) + LocalRef( RunResultsN[2]:DRtgNatGasEnergy ) + LocalRef( RunResultsN[2]:DRtgOtherEnergy )   }

  ; IAQ Ventilation Fans
	"Store energy use - Elec   - N-IAQVent"	Proj:RunResultsN[3]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "FanV" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - N-IAQVent"	Proj:RunResultsN[3]:DRtgNatGasEnergy	= {	0  }
	"Store energy use - Other  - N-IAQVent"	Proj:RunResultsN[3]:DRtgOtherEnergy		= {	0  }
	"Store energy use - TOTAL  - N-IAQVent"	Proj:RunResultsN[3]:DRtgTotalEnergy		= {	LocalRef( RunResultsN[3]:DRtgElecEnergy )   }

  ; Other HVAC (aux & misc fans)
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
;	"Store energy use - Elec   - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
;			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Aux", "Fan" ) / CondFloorArea  endif  }
;	"Store energy use - NatGas - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgNatGasEnergy	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
;			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Aux" ) / CondFloorArea  endif  }
;	"Store energy use - Other  - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
;			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Aux" ) / CondFloorArea  endif  }
;	"Store energy use - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgTotalEnergy		= {	LocalRef( RunResultsN[4]:DRtgElecEnergy ) + LocalRef( RunResultsN[4]:DRtgNatGasEnergy ) + LocalRef( RunResultsN[4]:DRtgOtherEnergy )   }
;
	"Zero out - Elec   - N-OthrHVAC"		Proj:RunResultsN[4]:DRtgElecEnergy	= {	0  }
	"Zero out - NatGas - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgNatGasEnergy	= {	0  }
	"Zero out - Other  - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgOtherEnergy		= {	0  }
	"Zero out - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgTotalEnergy		= {	0  }

   ; Water Heating
	"Store energy use - Elec   - N-WtrHt"		Proj:RunResultsN[5]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else if (CSEinclDHWMFL_EU)
			 			  																							   then  HourlyResultSum( RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / CondFloorArea
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / CondFloorArea  endif endif  }
	"Store energy use - NatGas - N-WtrHt"		Proj:RunResultsN[5]:DRtgNatGasEnergy	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea  endif  }
	"Store energy use - Other  - N-WtrHt"		Proj:RunResultsN[5]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - N-WtrHt"		Proj:RunResultsN[5]:DRtgTotalEnergy		= {	LocalRef( RunResultsN[5]:DRtgElecEnergy ) + LocalRef( RunResultsN[5]:DRtgNatGasEnergy ) + LocalRef( RunResultsN[5]:DRtgOtherEnergy )   }

  ; Inside Lighting
	"Store energy use - Elec   - N-InsLtg"		Proj:RunResultsN[6]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Lit" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - N-InsLtg"		Proj:RunResultsN[6]:DRtgNatGasEnergy	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Lit" ) / CondFloorArea  endif  }
	"Store energy use - Other  - N-InsLtg"		Proj:RunResultsN[6]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Lit" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - N-InsLtg"		Proj:RunResultsN[6]:DRtgTotalEnergy		= {	LocalRef( RunResultsN[6]:DRtgElecEnergy ) + LocalRef( RunResultsN[6]:DRtgNatGasEnergy ) + LocalRef( RunResultsN[6]:DRtgOtherEnergy )   }

  ; Appliances & Cooking
	"Store energy use - Elec   - N-AppCkg"		Proj:RunResultsN[7]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - N-AppCkg"		Proj:RunResultsN[7]:DRtgNatGasEnergy	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea  endif  }
	"Store energy use - Other  - N-AppCkg"		Proj:RunResultsN[7]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - N-AppCkg"		Proj:RunResultsN[7]:DRtgTotalEnergy		= {	LocalRef( RunResultsN[7]:DRtgElecEnergy ) + LocalRef( RunResultsN[7]:DRtgNatGasEnergy ) + LocalRef( RunResultsN[7]:DRtgOtherEnergy )   }

  ; Plug Loads
	"Store energy use - Elec   - N-Plugs"		Proj:RunResultsN[8]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Rcp" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - N-Plugs"		Proj:RunResultsN[8]:DRtgNatGasEnergy	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Rcp" ) / CondFloorArea  endif  }
	"Store energy use - Other  - N-Plugs"		Proj:RunResultsN[8]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Rcp" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - N-Plugs"		Proj:RunResultsN[8]:DRtgTotalEnergy		= {	LocalRef( RunResultsN[8]:DRtgElecEnergy ) + LocalRef( RunResultsN[8]:DRtgNatGasEnergy ) + LocalRef( RunResultsN[8]:DRtgOtherEnergy )   }

  ; Exterior
	"Store energy use - Elec   - N-Ext"			Proj:RunResultsN[9]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "Ext" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - N-Ext"			Proj:RunResultsN[9]:DRtgNatGasEnergy	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrNatGas", "Ext" ) / CondFloorArea  endif  }
	"Store energy use - Other  - N-Ext"			Proj:RunResultsN[9]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrOther",  "Ext" ) / CondFloorArea  endif  }
	"Store energy use - TOTAL  - N-Ext"			Proj:RunResultsN[9]:DRtgTotalEnergy		= {	LocalRef( RunResultsN[9]:DRtgElecEnergy ) + LocalRef( RunResultsN[9]:DRtgNatGasEnergy ) + LocalRef( RunResultsN[9]:DRtgOtherEnergy )   }

  ; PV
	"Store energy use - Elec   - N-PV"			Proj:RunResultsN[13]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "PV" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - N-PV"			Proj:RunResultsN[13]:DRtgNatGasEnergy	= {	0  }
	"Store energy use - Other  - N-PV"			Proj:RunResultsN[13]:DRtgOtherEnergy	= {	0  }
	"Store energy use - TOTAL  - N-PV"			Proj:RunResultsN[13]:DRtgTotalEnergy	= {	LocalRef( RunResultsN[13]:DRtgElecEnergy )   }

  ; Battery
	"Store energy use - Elec   - N-Battery"	Proj:RunResultsN[14]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. CondFloorArea < 1) then  0
			 			  																								else  HourlyResultSum( RunID, "MtrElec",   "BT" ) / CondFloorArea  endif  }
	"Store energy use - NatGas - N-Battery"	Proj:RunResultsN[14]:DRtgNatGasEnergy	= {	0  }
	"Store energy use - Other  - N-Battery"	Proj:RunResultsN[14]:DRtgOtherEnergy	= {	0  }
	"Store energy use - TOTAL  - N-Battery"	Proj:RunResultsN[14]:DRtgTotalEnergy	= {	LocalRef( RunResultsN[14]:DRtgElecEnergy )   }

; SAC 11/20/14 - fixed bug where RunResultsN totals were summing values from RunResults (no trailing 'N'), which are not yet set.
  ; Compliance Total
	"Store energy use - Elec   - N-Comp Ttl"	Proj:RunResultsN[11]:DRtgElecEnergy		= {	RunResultsN[1]:DRtgElecEnergy   + RunResultsN[2]:DRtgElecEnergy   + RunResultsN[3]:DRtgElecEnergy   + RunResultsN[4]:DRtgElecEnergy   + RunResultsN[5]:DRtgElecEnergy    }
	"Store energy use - NatGas - N-Comp Ttl"	Proj:RunResultsN[11]:DRtgNatGasEnergy	= {	RunResultsN[1]:DRtgNatGasEnergy + RunResultsN[2]:DRtgNatGasEnergy + RunResultsN[3]:DRtgNatGasEnergy + RunResultsN[4]:DRtgNatGasEnergy + RunResultsN[5]:DRtgNatGasEnergy  }
	"Store energy use - Other  - N-Comp Ttl"	Proj:RunResultsN[11]:DRtgOtherEnergy	= {	RunResultsN[1]:DRtgOtherEnergy  + RunResultsN[2]:DRtgOtherEnergy  + RunResultsN[3]:DRtgOtherEnergy  + RunResultsN[4]:DRtgOtherEnergy  + RunResultsN[5]:DRtgOtherEnergy   }
	"Store energy use - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:DRtgTotalEnergy	= {	RunResultsN[1]:DRtgTotalEnergy  + RunResultsN[2]:DRtgTotalEnergy  + RunResultsN[3]:DRtgTotalEnergy  + RunResultsN[4]:DRtgTotalEnergy  + RunResultsN[5]:DRtgTotalEnergy   }

  ; Total
	"Store energy use - Elec   - N-Total"		Proj:RunResultsN[10]:DRtgElecEnergy		= {	RunResultsN[11]:DRtgElecEnergy   + RunResultsN[6]:DRtgElecEnergy   + RunResultsN[7]:DRtgElecEnergy   + RunResultsN[8]:DRtgElecEnergy   + RunResultsN[9]:DRtgElecEnergy    }
	"Store energy use - NatGas - N-Total"		Proj:RunResultsN[10]:DRtgNatGasEnergy	= {	RunResultsN[11]:DRtgNatGasEnergy + RunResultsN[6]:DRtgNatGasEnergy + RunResultsN[7]:DRtgNatGasEnergy + RunResultsN[8]:DRtgNatGasEnergy + RunResultsN[9]:DRtgNatGasEnergy  }
	"Store energy use - Other  - N-Total"		Proj:RunResultsN[10]:DRtgOtherEnergy	= {	RunResultsN[11]:DRtgOtherEnergy  + RunResultsN[6]:DRtgOtherEnergy  + RunResultsN[7]:DRtgOtherEnergy  + RunResultsN[8]:DRtgOtherEnergy  + RunResultsN[9]:DRtgOtherEnergy   }
	"Store energy use - TOTAL  - N-Total"		Proj:RunResultsN[10]:DRtgTotalEnergy	= {	RunResultsN[11]:DRtgTotalEnergy  + RunResultsN[6]:DRtgTotalEnergy  + RunResultsN[7]:DRtgTotalEnergy  + RunResultsN[8]:DRtgTotalEnergy  + RunResultsN[9]:DRtgTotalEnergy   }

; -- COPY N results to E --
  ; Space Heating (& heating fan)
	"Store energy use - Elec   - E-SpcHt"		Proj:RunResultsE[1]:DRtgElecEnergy		= {	RunResultsN[1]:DRtgElecEnergy     }
	"Store energy use - NatGas - E-SpcHt"		Proj:RunResultsE[1]:DRtgNatGasEnergy	= {	RunResultsN[1]:DRtgNatGasEnergy   }
	"Store energy use - Other  - E-SpcHt"		Proj:RunResultsE[1]:DRtgOtherEnergy		= {	RunResultsN[1]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - E-SpcHt"		Proj:RunResultsE[1]:DRtgTotalEnergy		= {	RunResultsN[1]:DRtgTotalEnergy    }
  ; Space Cooling (& cooling fan)
	"Store energy use - Elec   - E-SpcCl"		Proj:RunResultsE[2]:DRtgElecEnergy		= {	RunResultsN[2]:DRtgElecEnergy     }
	"Store energy use - NatGas - E-SpcCl"		Proj:RunResultsE[2]:DRtgNatGasEnergy	= {	RunResultsN[2]:DRtgNatGasEnergy   }
	"Store energy use - Other  - E-SpcCl"		Proj:RunResultsE[2]:DRtgOtherEnergy		= {	RunResultsN[2]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - E-SpcCl"		Proj:RunResultsE[2]:DRtgTotalEnergy		= {	RunResultsN[2]:DRtgTotalEnergy    }
  ; IAQ Ventilation Fans                                                                                                 
	"Store energy use - Elec   - E-IAQVent"	Proj:RunResultsE[3]:DRtgElecEnergy		= {	RunResultsN[3]:DRtgElecEnergy     }
	"Store energy use - NatGas - E-IAQVent"	Proj:RunResultsE[3]:DRtgNatGasEnergy	= {	RunResultsN[3]:DRtgNatGasEnergy   }
	"Store energy use - Other  - E-IAQVent"	Proj:RunResultsE[3]:DRtgOtherEnergy		= {	RunResultsN[3]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - E-IAQVent"	Proj:RunResultsE[3]:DRtgTotalEnergy		= {	RunResultsN[3]:DRtgTotalEnergy    }
  ; Other HVAC (aux & misc fans)                                                                                         
	"Store energy use - Elec   - E-OthrHVAC"	Proj:RunResultsE[4]:DRtgElecEnergy		= {	RunResultsN[4]:DRtgElecEnergy     }
	"Store energy use - NatGas - E-OthrHVAC"	Proj:RunResultsE[4]:DRtgNatGasEnergy	= {	RunResultsN[4]:DRtgNatGasEnergy   }
	"Store energy use - Other  - E-OthrHVAC"	Proj:RunResultsE[4]:DRtgOtherEnergy		= {	RunResultsN[4]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - E-OthrHVAC"	Proj:RunResultsE[4]:DRtgTotalEnergy		= {	RunResultsN[4]:DRtgTotalEnergy    }
  ; Water Heating                                                                                                        
	"Store energy use - Elec   - E-WtrHt"		Proj:RunResultsE[5]:DRtgElecEnergy		= {	RunResultsN[5]:DRtgElecEnergy     }
	"Store energy use - NatGas - E-WtrHt"		Proj:RunResultsE[5]:DRtgNatGasEnergy	= {	RunResultsN[5]:DRtgNatGasEnergy   }
	"Store energy use - Other  - E-WtrHt"		Proj:RunResultsE[5]:DRtgOtherEnergy		= {	RunResultsN[5]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - E-WtrHt"		Proj:RunResultsE[5]:DRtgTotalEnergy		= {	RunResultsN[5]:DRtgTotalEnergy    }
  ; Inside Lighting                                                                                                      
	"Store energy use - Elec   - E-InsLtg"		Proj:RunResultsE[6]:DRtgElecEnergy		= {	RunResultsN[6]:DRtgElecEnergy     }
	"Store energy use - NatGas - E-InsLtg"		Proj:RunResultsE[6]:DRtgNatGasEnergy	= {	RunResultsN[6]:DRtgNatGasEnergy   }
	"Store energy use - Other  - E-InsLtg"		Proj:RunResultsE[6]:DRtgOtherEnergy		= {	RunResultsN[6]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - E-InsLtg"		Proj:RunResultsE[6]:DRtgTotalEnergy		= {	RunResultsN[6]:DRtgTotalEnergy    }
  ; Appliances & Cooking                                                                                                 
	"Store energy use - Elec   - E-AppCkg"		Proj:RunResultsE[7]:DRtgElecEnergy		= {	RunResultsN[7]:DRtgElecEnergy     }
	"Store energy use - NatGas - E-AppCkg"		Proj:RunResultsE[7]:DRtgNatGasEnergy	= {	RunResultsN[7]:DRtgNatGasEnergy   }
	"Store energy use - Other  - E-AppCkg"		Proj:RunResultsE[7]:DRtgOtherEnergy		= {	RunResultsN[7]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - E-AppCkg"		Proj:RunResultsE[7]:DRtgTotalEnergy		= {	RunResultsN[7]:DRtgTotalEnergy    }
  ; Plug Loads                                                                                                           
	"Store energy use - Elec   - E-Plugs"		Proj:RunResultsE[8]:DRtgElecEnergy		= {	RunResultsN[8]:DRtgElecEnergy     }
	"Store energy use - NatGas - E-Plugs"		Proj:RunResultsE[8]:DRtgNatGasEnergy	= {	RunResultsN[8]:DRtgNatGasEnergy   }
	"Store energy use - Other  - E-Plugs"		Proj:RunResultsE[8]:DRtgOtherEnergy		= {	RunResultsN[8]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - E-Plugs"		Proj:RunResultsE[8]:DRtgTotalEnergy		= {	RunResultsN[8]:DRtgTotalEnergy    }
  ; Exterior                                                                                                             
	"Store energy use - Elec   - E-Ext"			Proj:RunResultsE[9]:DRtgElecEnergy		= {	RunResultsN[9]:DRtgElecEnergy     }
	"Store energy use - NatGas - E-Ext"			Proj:RunResultsE[9]:DRtgNatGasEnergy	= {	RunResultsN[9]:DRtgNatGasEnergy   }
	"Store energy use - Other  - E-Ext"			Proj:RunResultsE[9]:DRtgOtherEnergy		= {	RunResultsN[9]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - E-Ext"			Proj:RunResultsE[9]:DRtgTotalEnergy		= {	RunResultsN[9]:DRtgTotalEnergy    }
  ; PV
	"Store energy use - Elec   - E-PV"			Proj:RunResultsE[13]:DRtgElecEnergy		= {	RunResultsN[13]:DRtgElecEnergy    }
	"Store energy use - NatGas - E-PV"			Proj:RunResultsE[13]:DRtgNatGasEnergy	= {	RunResultsN[13]:DRtgNatGasEnergy  }
	"Store energy use - Other  - E-PV"			Proj:RunResultsE[13]:DRtgOtherEnergy	= {	RunResultsN[13]:DRtgOtherEnergy   }
	"Store energy use - TOTAL  - E-PV"			Proj:RunResultsE[13]:DRtgTotalEnergy	= {	RunResultsN[13]:DRtgTotalEnergy   }
  ; Battery
	"Store energy use - Elec   - E-Battery"	Proj:RunResultsE[14]:DRtgElecEnergy		= {	RunResultsN[14]:DRtgElecEnergy    }
	"Store energy use - NatGas - E-Battery"	Proj:RunResultsE[14]:DRtgNatGasEnergy	= {	RunResultsN[14]:DRtgNatGasEnergy  }
	"Store energy use - Other  - E-Battery"	Proj:RunResultsE[14]:DRtgOtherEnergy	= {	RunResultsN[14]:DRtgOtherEnergy   }
	"Store energy use - TOTAL  - E-Battery"	Proj:RunResultsE[14]:DRtgTotalEnergy	= {	RunResultsN[14]:DRtgTotalEnergy   }
  ; Compliance Total                                                                                                     
	"Store energy use - Elec   - E-Comp Ttl"	Proj:RunResultsE[11]:DRtgElecEnergy		= {	RunResultsN[11]:DRtgElecEnergy    }
	"Store energy use - NatGas - E-Comp Ttl"	Proj:RunResultsE[11]:DRtgNatGasEnergy	= {	RunResultsN[11]:DRtgNatGasEnergy  }
	"Store energy use - Other  - E-Comp Ttl"	Proj:RunResultsE[11]:DRtgOtherEnergy	= {	RunResultsN[11]:DRtgOtherEnergy   }
	"Store energy use - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:DRtgTotalEnergy	= {	RunResultsN[11]:DRtgTotalEnergy   }
  ; Total                                                                                                                
	"Store energy use - Elec   - E-Total"		Proj:RunResultsE[10]:DRtgElecEnergy		= {	RunResultsN[10]:DRtgElecEnergy    }
	"Store energy use - NatGas - E-Total"		Proj:RunResultsE[10]:DRtgNatGasEnergy	= {	RunResultsN[10]:DRtgNatGasEnergy  }
	"Store energy use - Other  - E-Total"		Proj:RunResultsE[10]:DRtgOtherEnergy	= {	RunResultsN[10]:DRtgOtherEnergy   }
	"Store energy use - TOTAL  - E-Total"		Proj:RunResultsE[10]:DRtgTotalEnergy	= {	RunResultsN[10]:DRtgTotalEnergy   }

; -- COPY N results to S --
  ; Space Heating (& heating fan)
	"Store energy use - Elec   - S-SpcHt"		Proj:RunResultsS[1]:DRtgElecEnergy		= {	RunResultsN[1]:DRtgElecEnergy     }
	"Store energy use - NatGas - S-SpcHt"		Proj:RunResultsS[1]:DRtgNatGasEnergy	= {	RunResultsN[1]:DRtgNatGasEnergy   }
	"Store energy use - Other  - S-SpcHt"		Proj:RunResultsS[1]:DRtgOtherEnergy		= {	RunResultsN[1]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - S-SpcHt"		Proj:RunResultsS[1]:DRtgTotalEnergy		= {	RunResultsN[1]:DRtgTotalEnergy    }
  ; Space Cooling (& cooling fan)
	"Store energy use - Elec   - S-SpcCl"		Proj:RunResultsS[2]:DRtgElecEnergy		= {	RunResultsN[2]:DRtgElecEnergy     }
	"Store energy use - NatGas - S-SpcCl"		Proj:RunResultsS[2]:DRtgNatGasEnergy	= {	RunResultsN[2]:DRtgNatGasEnergy   }
	"Store energy use - Other  - S-SpcCl"		Proj:RunResultsS[2]:DRtgOtherEnergy		= {	RunResultsN[2]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - S-SpcCl"		Proj:RunResultsS[2]:DRtgTotalEnergy		= {	RunResultsN[2]:DRtgTotalEnergy    }
  ; IAQ Ventilation Fans                                                                                                 
	"Store energy use - Elec   - S-IAQVent"	Proj:RunResultsS[3]:DRtgElecEnergy		= {	RunResultsN[3]:DRtgElecEnergy     }
	"Store energy use - NatGas - S-IAQVent"	Proj:RunResultsS[3]:DRtgNatGasEnergy	= {	RunResultsN[3]:DRtgNatGasEnergy   }
	"Store energy use - Other  - S-IAQVent"	Proj:RunResultsS[3]:DRtgOtherEnergy		= {	RunResultsN[3]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - S-IAQVent"	Proj:RunResultsS[3]:DRtgTotalEnergy		= {	RunResultsN[3]:DRtgTotalEnergy    }
  ; Other HVAC (aux & misc fans)                                                                                         
	"Store energy use - Elec   - S-OthrHVAC"	Proj:RunResultsS[4]:DRtgElecEnergy		= {	RunResultsN[4]:DRtgElecEnergy     }
	"Store energy use - NatGas - S-OthrHVAC"	Proj:RunResultsS[4]:DRtgNatGasEnergy	= {	RunResultsN[4]:DRtgNatGasEnergy   }
	"Store energy use - Other  - S-OthrHVAC"	Proj:RunResultsS[4]:DRtgOtherEnergy		= {	RunResultsN[4]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - S-OthrHVAC"	Proj:RunResultsS[4]:DRtgTotalEnergy		= {	RunResultsN[4]:DRtgTotalEnergy    }
  ; Water Heating                                                                                                        
	"Store energy use - Elec   - S-WtrHt"		Proj:RunResultsS[5]:DRtgElecEnergy		= {	RunResultsN[5]:DRtgElecEnergy     }
	"Store energy use - NatGas - S-WtrHt"		Proj:RunResultsS[5]:DRtgNatGasEnergy	= {	RunResultsN[5]:DRtgNatGasEnergy   }
	"Store energy use - Other  - S-WtrHt"		Proj:RunResultsS[5]:DRtgOtherEnergy		= {	RunResultsN[5]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - S-WtrHt"		Proj:RunResultsS[5]:DRtgTotalEnergy		= {	RunResultsN[5]:DRtgTotalEnergy    }
  ; Inside Lighting                                                                                                      
	"Store energy use - Elec   - S-InsLtg"		Proj:RunResultsS[6]:DRtgElecEnergy		= {	RunResultsN[6]:DRtgElecEnergy     }
	"Store energy use - NatGas - S-InsLtg"		Proj:RunResultsS[6]:DRtgNatGasEnergy	= {	RunResultsN[6]:DRtgNatGasEnergy   }
	"Store energy use - Other  - S-InsLtg"		Proj:RunResultsS[6]:DRtgOtherEnergy		= {	RunResultsN[6]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - S-InsLtg"		Proj:RunResultsS[6]:DRtgTotalEnergy		= {	RunResultsN[6]:DRtgTotalEnergy    }
  ; Appliances & Cooking                                                                                                 
	"Store energy use - Elec   - S-AppCkg"		Proj:RunResultsS[7]:DRtgElecEnergy		= {	RunResultsN[7]:DRtgElecEnergy     }
	"Store energy use - NatGas - S-AppCkg"		Proj:RunResultsS[7]:DRtgNatGasEnergy	= {	RunResultsN[7]:DRtgNatGasEnergy   }
	"Store energy use - Other  - S-AppCkg"		Proj:RunResultsS[7]:DRtgOtherEnergy		= {	RunResultsN[7]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - S-AppCkg"		Proj:RunResultsS[7]:DRtgTotalEnergy		= {	RunResultsN[7]:DRtgTotalEnergy    }
  ; Plug Loads                                                                                                           
	"Store energy use - Elec   - S-Plugs"		Proj:RunResultsS[8]:DRtgElecEnergy		= {	RunResultsN[8]:DRtgElecEnergy     }
	"Store energy use - NatGas - S-Plugs"		Proj:RunResultsS[8]:DRtgNatGasEnergy	= {	RunResultsN[8]:DRtgNatGasEnergy   }
	"Store energy use - Other  - S-Plugs"		Proj:RunResultsS[8]:DRtgOtherEnergy		= {	RunResultsN[8]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - S-Plugs"		Proj:RunResultsS[8]:DRtgTotalEnergy		= {	RunResultsN[8]:DRtgTotalEnergy    }
  ; Exterior                                                                                                             
	"Store energy use - Elec   - S-Ext"			Proj:RunResultsS[9]:DRtgElecEnergy		= {	RunResultsN[9]:DRtgElecEnergy     }
	"Store energy use - NatGas - S-Ext"			Proj:RunResultsS[9]:DRtgNatGasEnergy	= {	RunResultsN[9]:DRtgNatGasEnergy   }
	"Store energy use - Other  - S-Ext"			Proj:RunResultsS[9]:DRtgOtherEnergy		= {	RunResultsN[9]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - S-Ext"			Proj:RunResultsS[9]:DRtgTotalEnergy		= {	RunResultsN[9]:DRtgTotalEnergy    }
  ; PV
	"Store energy use - Elec   - S-PV"			Proj:RunResultsS[13]:DRtgElecEnergy		= {	RunResultsN[13]:DRtgElecEnergy    }
	"Store energy use - NatGas - S-PV"			Proj:RunResultsS[13]:DRtgNatGasEnergy	= {	RunResultsN[13]:DRtgNatGasEnergy  }
	"Store energy use - Other  - S-PV"			Proj:RunResultsS[13]:DRtgOtherEnergy	= {	RunResultsN[13]:DRtgOtherEnergy   }
	"Store energy use - TOTAL  - S-PV"			Proj:RunResultsS[13]:DRtgTotalEnergy	= {	RunResultsN[13]:DRtgTotalEnergy   }
  ; Battery
	"Store energy use - Elec   - S-Battery"	Proj:RunResultsS[14]:DRtgElecEnergy		= {	RunResultsN[14]:DRtgElecEnergy    }
	"Store energy use - NatGas - S-Battery"	Proj:RunResultsS[14]:DRtgNatGasEnergy	= {	RunResultsN[14]:DRtgNatGasEnergy  }
	"Store energy use - Other  - S-Battery"	Proj:RunResultsS[14]:DRtgOtherEnergy	= {	RunResultsN[14]:DRtgOtherEnergy   }
	"Store energy use - TOTAL  - S-Battery"	Proj:RunResultsS[14]:DRtgTotalEnergy	= {	RunResultsN[14]:DRtgTotalEnergy   }
  ; Compliance Total                                                                                                     
	"Store energy use - Elec   - S-Comp Ttl"	Proj:RunResultsS[11]:DRtgElecEnergy		= {	RunResultsN[11]:DRtgElecEnergy    }
	"Store energy use - NatGas - S-Comp Ttl"	Proj:RunResultsS[11]:DRtgNatGasEnergy	= {	RunResultsN[11]:DRtgNatGasEnergy  }
	"Store energy use - Other  - S-Comp Ttl"	Proj:RunResultsS[11]:DRtgOtherEnergy	= {	RunResultsN[11]:DRtgOtherEnergy   }
	"Store energy use - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:DRtgTotalEnergy	= {	RunResultsN[11]:DRtgTotalEnergy   }
  ; Total                                                                                                                
	"Store energy use - Elec   - S-Total"		Proj:RunResultsS[10]:DRtgElecEnergy		= {	RunResultsN[10]:DRtgElecEnergy    }
	"Store energy use - NatGas - S-Total"		Proj:RunResultsS[10]:DRtgNatGasEnergy	= {	RunResultsN[10]:DRtgNatGasEnergy  }
	"Store energy use - Other  - S-Total"		Proj:RunResultsS[10]:DRtgOtherEnergy	= {	RunResultsN[10]:DRtgOtherEnergy   }
	"Store energy use - TOTAL  - S-Total"		Proj:RunResultsS[10]:DRtgTotalEnergy	= {	RunResultsN[10]:DRtgTotalEnergy   }

; -- COPY N results to W --
  ; Space Heating (& heating fan)
	"Store energy use - Elec   - W-SpcHt"		Proj:RunResultsW[1]:DRtgElecEnergy		= {	RunResultsN[1]:DRtgElecEnergy     }
	"Store energy use - NatGas - W-SpcHt"		Proj:RunResultsW[1]:DRtgNatGasEnergy	= {	RunResultsN[1]:DRtgNatGasEnergy   }
	"Store energy use - Other  - W-SpcHt"		Proj:RunResultsW[1]:DRtgOtherEnergy		= {	RunResultsN[1]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - W-SpcHt"		Proj:RunResultsW[1]:DRtgTotalEnergy		= {	RunResultsN[1]:DRtgTotalEnergy    }
  ; Space Cooling (& cooling fan)
	"Store energy use - Elec   - W-SpcCl"		Proj:RunResultsW[2]:DRtgElecEnergy		= {	RunResultsN[2]:DRtgElecEnergy     }
	"Store energy use - NatGas - W-SpcCl"		Proj:RunResultsW[2]:DRtgNatGasEnergy	= {	RunResultsN[2]:DRtgNatGasEnergy   }
	"Store energy use - Other  - W-SpcCl"		Proj:RunResultsW[2]:DRtgOtherEnergy		= {	RunResultsN[2]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - W-SpcCl"		Proj:RunResultsW[2]:DRtgTotalEnergy		= {	RunResultsN[2]:DRtgTotalEnergy    }
  ; IAQ Ventilation Fans                                                                                                 
	"Store energy use - Elec   - W-IAQVent"	Proj:RunResultsW[3]:DRtgElecEnergy		= {	RunResultsN[3]:DRtgElecEnergy     }
	"Store energy use - NatGas - W-IAQVent"	Proj:RunResultsW[3]:DRtgNatGasEnergy	= {	RunResultsN[3]:DRtgNatGasEnergy   }
	"Store energy use - Other  - W-IAQVent"	Proj:RunResultsW[3]:DRtgOtherEnergy		= {	RunResultsN[3]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - W-IAQVent"	Proj:RunResultsW[3]:DRtgTotalEnergy		= {	RunResultsN[3]:DRtgTotalEnergy    }
  ; Other HVAC (aux & misc fans)                                                                                         
	"Store energy use - Elec   - W-OthrHVAC"	Proj:RunResultsW[4]:DRtgElecEnergy		= {	RunResultsN[4]:DRtgElecEnergy     }
	"Store energy use - NatGas - W-OthrHVAC"	Proj:RunResultsW[4]:DRtgNatGasEnergy	= {	RunResultsN[4]:DRtgNatGasEnergy   }
	"Store energy use - Other  - W-OthrHVAC"	Proj:RunResultsW[4]:DRtgOtherEnergy		= {	RunResultsN[4]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - W-OthrHVAC"	Proj:RunResultsW[4]:DRtgTotalEnergy		= {	RunResultsN[4]:DRtgTotalEnergy    }
  ; Water Heating                                                                                                        
	"Store energy use - Elec   - W-WtrHt"		Proj:RunResultsW[5]:DRtgElecEnergy		= {	RunResultsN[5]:DRtgElecEnergy     }
	"Store energy use - NatGas - W-WtrHt"		Proj:RunResultsW[5]:DRtgNatGasEnergy	= {	RunResultsN[5]:DRtgNatGasEnergy   }
	"Store energy use - Other  - W-WtrHt"		Proj:RunResultsW[5]:DRtgOtherEnergy		= {	RunResultsN[5]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - W-WtrHt"		Proj:RunResultsW[5]:DRtgTotalEnergy		= {	RunResultsN[5]:DRtgTotalEnergy    }
  ; Inside Lighting                                                                                                      
	"Store energy use - Elec   - W-InsLtg"		Proj:RunResultsW[6]:DRtgElecEnergy		= {	RunResultsN[6]:DRtgElecEnergy     }
	"Store energy use - NatGas - W-InsLtg"		Proj:RunResultsW[6]:DRtgNatGasEnergy	= {	RunResultsN[6]:DRtgNatGasEnergy   }
	"Store energy use - Other  - W-InsLtg"		Proj:RunResultsW[6]:DRtgOtherEnergy		= {	RunResultsN[6]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - W-InsLtg"		Proj:RunResultsW[6]:DRtgTotalEnergy		= {	RunResultsN[6]:DRtgTotalEnergy    }
  ; Appliances & Cooking                                                                                                 
	"Store energy use - Elec   - W-AppCkg"		Proj:RunResultsW[7]:DRtgElecEnergy		= {	RunResultsN[7]:DRtgElecEnergy     }
	"Store energy use - NatGas - W-AppCkg"		Proj:RunResultsW[7]:DRtgNatGasEnergy	= {	RunResultsN[7]:DRtgNatGasEnergy   }
	"Store energy use - Other  - W-AppCkg"		Proj:RunResultsW[7]:DRtgOtherEnergy		= {	RunResultsN[7]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - W-AppCkg"		Proj:RunResultsW[7]:DRtgTotalEnergy		= {	RunResultsN[7]:DRtgTotalEnergy    }
  ; Plug Loads                                                                                                           
	"Store energy use - Elec   - W-Plugs"		Proj:RunResultsW[8]:DRtgElecEnergy		= {	RunResultsN[8]:DRtgElecEnergy     }
	"Store energy use - NatGas - W-Plugs"		Proj:RunResultsW[8]:DRtgNatGasEnergy	= {	RunResultsN[8]:DRtgNatGasEnergy   }
	"Store energy use - Other  - W-Plugs"		Proj:RunResultsW[8]:DRtgOtherEnergy		= {	RunResultsN[8]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - W-Plugs"		Proj:RunResultsW[8]:DRtgTotalEnergy		= {	RunResultsN[8]:DRtgTotalEnergy    }
  ; Exterior                                                                                                             
	"Store energy use - Elec   - W-Ext"			Proj:RunResultsW[9]:DRtgElecEnergy		= {	RunResultsN[9]:DRtgElecEnergy     }
	"Store energy use - NatGas - W-Ext"			Proj:RunResultsW[9]:DRtgNatGasEnergy	= {	RunResultsN[9]:DRtgNatGasEnergy   }
	"Store energy use - Other  - W-Ext"			Proj:RunResultsW[9]:DRtgOtherEnergy		= {	RunResultsN[9]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - W-Ext"			Proj:RunResultsW[9]:DRtgTotalEnergy		= {	RunResultsN[9]:DRtgTotalEnergy    }
  ; PV
	"Store energy use - Elec   - W-PV"			Proj:RunResultsW[13]:DRtgElecEnergy		= {	RunResultsN[13]:DRtgElecEnergy    }
	"Store energy use - NatGas - W-PV"			Proj:RunResultsW[13]:DRtgNatGasEnergy	= {	RunResultsN[13]:DRtgNatGasEnergy  }
	"Store energy use - Other  - W-PV"			Proj:RunResultsW[13]:DRtgOtherEnergy	= {	RunResultsN[13]:DRtgOtherEnergy   }
	"Store energy use - TOTAL  - W-PV"			Proj:RunResultsW[13]:DRtgTotalEnergy	= {	RunResultsN[13]:DRtgTotalEnergy   }
  ; Battery
	"Store energy use - Elec   - W-Battery"	Proj:RunResultsW[14]:DRtgElecEnergy		= {	RunResultsN[14]:DRtgElecEnergy    }
	"Store energy use - NatGas - W-Battery"	Proj:RunResultsW[14]:DRtgNatGasEnergy	= {	RunResultsN[14]:DRtgNatGasEnergy  }
	"Store energy use - Other  - W-Battery"	Proj:RunResultsW[14]:DRtgOtherEnergy	= {	RunResultsN[14]:DRtgOtherEnergy   }
	"Store energy use - TOTAL  - W-Battery"	Proj:RunResultsW[14]:DRtgTotalEnergy	= {	RunResultsN[14]:DRtgTotalEnergy   }
  ; Compliance Total                                                                                                     
	"Store energy use - Elec   - W-Comp Ttl"	Proj:RunResultsW[11]:DRtgElecEnergy		= {	RunResultsN[11]:DRtgElecEnergy    }
	"Store energy use - NatGas - W-Comp Ttl"	Proj:RunResultsW[11]:DRtgNatGasEnergy	= {	RunResultsN[11]:DRtgNatGasEnergy  }
	"Store energy use - Other  - W-Comp Ttl"	Proj:RunResultsW[11]:DRtgOtherEnergy	= {	RunResultsN[11]:DRtgOtherEnergy   }
	"Store energy use - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:DRtgTotalEnergy	= {	RunResultsN[11]:DRtgTotalEnergy   }
  ; Total                                                                                                                
	"Store energy use - Elec   - W-Total"		Proj:RunResultsW[10]:DRtgElecEnergy		= {	RunResultsN[10]:DRtgElecEnergy    }
	"Store energy use - NatGas - W-Total"		Proj:RunResultsW[10]:DRtgNatGasEnergy	= {	RunResultsN[10]:DRtgNatGasEnergy  }
	"Store energy use - Other  - W-Total"		Proj:RunResultsW[10]:DRtgOtherEnergy	= {	RunResultsN[10]:DRtgOtherEnergy   }
	"Store energy use - TOTAL  - W-Total"		Proj:RunResultsW[10]:DRtgTotalEnergy	= {	RunResultsN[10]:DRtgTotalEnergy   }

  ; SAC 1/26/18 - added rules to calc carbon emissions by enduse
   "Call rulelist to setup design rating reference CO2 emissions"  Proj:Action = {
         if (EnergyCodeYearNum < 2019) then  UNCHANGED
         else  EvalRulelist( "CARes_DesignRatingResults_Carbon_NESW" )  endif  }

   "Set PV reporting properties"    Proj:Action = {  EvalRulelist( "CARes_Results_PVReporting" )  }
END


;*************************************************************************
RULELIST "CARes_ProposedTDVResults" 1 0 0 1
;*************************************************************************
; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
         ; SAC 8/24/19 - replaced 1/3.413 & 0.01 TDV table multipliers with Proj:TDVSecMult_Elec & TDVSecMult_Fuel to accommodate 2022+ switch to native (E3) TDV table units
         ; SAC 8/26/19 - added primary table multipliers (of 1.0) to all ApplyHourlyResultMult* function calls (to accommodate 2022+ TDV table unit switch)
  ; Space Heating (& heating fan)
	"Calculate TDV - Elec   - SpcHt"		Proj:RunResults[1]:PropElecTDV[1]			= {	if (LocalRef( RunResults[1]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - SpcHt"		Proj:RunResults[1]:PropNatGasTDV			= {	if (LocalRef( RunResults[1]:PropNatGasEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - SpcHt"		Proj:RunResults[1]:PropOtherTDV			= {	if (LocalRef( RunResults[1]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - SpcHt"		Proj:RunResults[1]:ProposedTDV[1]			= {	LocalRef( RunResults[1]:PropElecTDV[1] ) + LocalRef( RunResults[1]:PropNatGasTDV ) + LocalRef( RunResults[1]:PropOtherTDV )   }
  ; SAC 8/23/14 - added rules to set elec demand
	"Calculate Elec Demand  - SpcHt"		Proj:RunResults[1]:PropElecDemand[1]		= {	if (LocalRef( RunResults[1]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / 3.412  endif  }

  ; Space Cooling (& cooling fan)
	"Calculate TDV - Elec   - SpcCl"		Proj:RunResults[2]:PropElecTDV[1]			= {	if (LocalRef( RunResults[2]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - SpcCl"		Proj:RunResults[2]:PropNatGasTDV			= {	if (LocalRef( RunResults[2]:PropNatGasEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - SpcCl"		Proj:RunResults[2]:PropOtherTDV			= {	if (LocalRef( RunResults[2]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - SpcCl"		Proj:RunResults[2]:ProposedTDV[1]			= {	LocalRef( RunResults[2]:PropElecTDV[1] ) + LocalRef( RunResults[2]:PropNatGasTDV ) + LocalRef( RunResults[2]:PropOtherTDV )   }
	"Calculate Elec Demand  - SpcCl"		Proj:RunResults[2]:PropElecDemand[1]		= {	if (LocalRef( RunResults[2]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Clg", "FanC" ) / 3.412  endif  }

  ; IAQ Ventilation Fans
	"Calculate TDV - Elec   - IAQVent"	Proj:RunResults[3]:PropElecTDV[1]			= {	if (LocalRef( RunResults[3]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "IAQVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "FanV" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - IAQVent"	Proj:RunResults[3]:PropNatGasTDV			= {	0  }
	"Calculate TDV - Other  - IAQVent"	Proj:RunResults[3]:PropOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - IAQVent"	Proj:RunResults[3]:ProposedTDV[1]			= {	LocalRef( RunResults[3]:PropElecTDV[1] )   }
	"Calculate Elec Demand  - IAQVent"	Proj:RunResults[3]:PropElecDemand[1]		= {	if (LocalRef( RunResults[3]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "FanV" ) / 3.412  endif  }

  ; Other HVAC (aux & misc fans)
   ; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
   ; SAC 11/8/18 - restored "Other HVAC" [4] to handle VCHP CFan via "User1" enduse
	"Calculate TDV - Elec   - OthrHVAC"	Proj:RunResults[4]:PropElecTDV[1]		= {	if (LocalRef( RunResults[4]:PropElecEnergy[1] ) < 0.0001 .AND. OthrHVAC_SpcHtFrac == 0) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "OHVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "User1" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - OthrHVAC"	Proj:RunResults[4]:PropNatGasTDV			= {	0  }
	"Calculate TDV - Other  - OthrHVAC"	Proj:RunResults[4]:PropOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - OthrHVAC"	Proj:RunResults[4]:ProposedTDV[1]		= {	LocalRef( RunResults[4]:PropElecTDV[1] )   }
	"Calculate Elec Demand  - OthrHVAC"	Proj:RunResults[4]:PropElecDemand[1]	= {	if (LocalRef( RunResults[4]:PropElecEnergy[1] ) < 0.0001 .AND. OthrHVAC_SpcHtFrac == 0) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "User1" ) / 3.412  endif  }

; SAC 1/27/19 - REDISTRIBUTE OthrHVAC Prop TDV across SpcHt & SpcCl by fuel based on ratio of total TDV (across all fuels) (tic #1053)
   "Set OthrHVAC_SpcHtFrac - PropTDV"     Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResults[4]:ProposedTDV[1] != 0 )==0) then  0
                                                                        else if (IfValidAnd( RunResults[1]:ProposedTDV[1] == 0 ) .AND.
                                                                                 IfValidAnd( RunResults[2]:ProposedTDV[1] == 0 )) then  0.5
                                                                        else   ValidOr( RunResults[1]:ProposedTDV[1], 0 ) / 
                                                                              (ValidOr( RunResults[1]:ProposedTDV[1], 0 ) + ValidOr( RunResults[2]:ProposedTDV[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Elec   - SpcHt"		Proj:RunResults[1]:PropElecTDV[1]	   = {   if (IfValidAnd( RunResults[4]:PropElecTDV[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[1]:PropElecTDV[1] + (RunResults[4]:PropElecTDV[1]     * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - NatGas - SpcHt"		Proj:RunResults[1]:PropNatGasTDV[1]	   = {   if (IfValidAnd( RunResults[4]:PropNatGasTDV[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[1]:PropNatGasTDV[1] + (RunResults[4]:PropNatGasTDV[1] * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - Other  - SpcHt"		Proj:RunResults[1]:PropOtherTDV[1]	   = {   if (IfValidAnd( RunResults[4]:PropOtherTDV[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[1]:PropOtherTDV[1] + (RunResults[4]:PropOtherTDV[1]   * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - TOTAL  - SpcHt"		Proj:RunResults[1]:ProposedTDV[1]	   = {	LocalRef( RunResults[1]:PropElecTDV[1] ) + LocalRef( RunResults[1]:PropNatGasTDV[1] ) + LocalRef( RunResults[1]:PropOtherTDV[1] )   }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Elec   - SpcCl"		Proj:RunResults[2]:PropElecTDV[1]	   = {   if (IfValidAnd( RunResults[4]:PropElecTDV[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[2]:PropElecTDV[1] + (RunResults[4]:PropElecTDV[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - NatGas - SpcCl"		Proj:RunResults[2]:PropNatGasTDV[1]	   = {   if (IfValidAnd( RunResults[4]:PropNatGasTDV[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[2]:PropNatGasTDV[1] + (RunResults[4]:PropNatGasTDV[1] * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - Other  - SpcCl"		Proj:RunResults[2]:PropOtherTDV[1]	   = {   if (IfValidAnd( RunResults[4]:PropOtherTDV[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[2]:PropOtherTDV[1] + (RunResults[4]:PropOtherTDV[1]   * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - TOTAL  - SpcCl"		Proj:RunResults[2]:ProposedTDV[1]	   = {	LocalRef( RunResults[2]:PropElecTDV[1] ) + LocalRef( RunResults[2]:PropNatGasTDV[1] ) + LocalRef( RunResults[2]:PropOtherTDV[1] )   }
   ; SAC 1/27/19 - REDISTRIBUTE OthrHVAC Prop Demand across SpcHt & SpcCl by fuel based on ratio of total Demand (tic #1053)
   "Set OthrHVAC_SpcHtFrac - Demand"      Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResults[4]:PropElecDemand[1] != 0 )==0) then  0
                                                                        else if (IfValidAnd( RunResults[1]:PropElecDemand[1] == 0 ) .AND.
                                                                                 IfValidAnd( RunResults[2]:PropElecDemand[1] == 0 )) then  0.5
                                                                        else   ValidOr( RunResults[1]:PropElecDemand[1], 0 ) / 
                                                                              (ValidOr( RunResults[1]:PropElecDemand[1], 0 ) + ValidOr( RunResults[2]:PropElecDemand[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Demand - SpcHt"		Proj:RunResults[1]:PropElecDemand[1]   = {   if (IfValidAnd( RunResults[4]:PropElecDemand[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[1]:PropElecDemand[1] + (RunResults[4]:PropElecDemand[1]     * OthrHVAC_SpcHtFrac)  endif  }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Demand - SpcCl"		Proj:RunResults[2]:PropElecDemand[1]   = {   if (IfValidAnd( RunResults[4]:PropElecDemand[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[2]:PropElecDemand[1] + (RunResults[4]:PropElecDemand[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
  ; Other HVAC (aux & misc fans)
	"ZERO-OUT         - Elec   - OthrHVAC"	Proj:RunResults[4]:PropElecTDV[1]	 = {	0  }
	"ZERO-OUT         - NatGas - OthrHVAC"	Proj:RunResults[4]:PropNatGasTDV[1]	 = {	0  }
	"ZERO-OUT         - Other  - OthrHVAC"	Proj:RunResults[4]:PropOtherTDV[1]	 = {	0  }
	"ZERO-OUT         - TOTAL  - OthrHVAC"	Proj:RunResults[4]:ProposedTDV[1]	 = {	0  }
	"ZERO-OUT         - Demand - OthrHVAC"	Proj:RunResults[4]:PropElecDemand[1] = {	0  }
   ; SAC 1/27/19 - end of - redistribution of OthrHVAC PropTDV

  ; Water Heating
	"Calculate TDV - Elec   - WtrHt"		Proj:RunResults[5]:PropElecTDV[1]			= {	if (LocalRef( RunResults[5]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else if (CSEinclDHWMFL_EU)
			 			  																					   then  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / CondFloorArea) + 0.5) / 100
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate TDV - NatGas - WtrHt"		Proj:RunResults[5]:PropNatGasTDV			= {	if (LocalRef( RunResults[5]:PropNatGasEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - WtrHt"		Proj:RunResults[5]:PropOtherTDV			= {	if (LocalRef( RunResults[5]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - WtrHt"		Proj:RunResults[5]:ProposedTDV[1]			= {	LocalRef( RunResults[5]:PropElecTDV[1] ) + LocalRef( RunResults[5]:PropNatGasTDV ) + LocalRef( RunResults[5]:PropOtherTDV )   }
	"Calculate Elec Demand  - WtrHt"		Proj:RunResults[5]:PropElecDemand[1]		= {	if (LocalRef( RunResults[5]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else if (CSEinclDHWMFL_EU)
			 			  																						then  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / 3.412
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / 3.412  endif endif  }

  ; Inside Lighting
	"Calculate TDV - Elec   - InsLtg"	Proj:RunResults[6]:PropElecTDV[1]			= {	if (LocalRef( RunResults[6]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - InsLtg"	Proj:RunResults[6]:PropNatGasTDV			= {	if (LocalRef( RunResults[6]:PropNatGasEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - InsLtg"	Proj:RunResults[6]:PropOtherTDV			= {	if (LocalRef( RunResults[6]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - InsLtg"	Proj:RunResults[6]:ProposedTDV[1]			= {	LocalRef( RunResults[6]:PropElecTDV[1] ) + LocalRef( RunResults[6]:PropNatGasTDV ) + LocalRef( RunResults[6]:PropOtherTDV )   }
	"Calculate Elec Demand  - InsLtg"	Proj:RunResults[6]:PropElecDemand[1]		= {	if (LocalRef( RunResults[6]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Lit" ) / 3.412  endif  }

  ; Appliances & Cooking
	"Calculate TDV - Elec   - AppCkg"	Proj:RunResults[7]:PropElecTDV[1]			= {	if (LocalRef( RunResults[7]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - AppCkg"	Proj:RunResults[7]:PropNatGasTDV			= {	if (LocalRef( RunResults[7]:PropNatGasEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - AppCkg"	Proj:RunResults[7]:PropOtherTDV			= {	if (LocalRef( RunResults[7]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - AppCkg"	Proj:RunResults[7]:ProposedTDV[1]			= {	LocalRef( RunResults[7]:PropElecTDV[1] ) + LocalRef( RunResults[7]:PropNatGasTDV ) + LocalRef( RunResults[7]:PropOtherTDV )   }
	"Calculate Elec Demand  - AppCkg"	Proj:RunResults[7]:PropElecDemand[1]		= {	if (LocalRef( RunResults[7]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / 3.412  endif  }

  ; Plug Loads
	"Calculate TDV - Elec   - Plugs"		Proj:RunResults[8]:PropElecTDV[1]			= {	if (LocalRef( RunResults[8]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - Plugs"		Proj:RunResults[8]:PropNatGasTDV			= {	if (LocalRef( RunResults[8]:PropNatGasEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - Plugs"		Proj:RunResults[8]:PropOtherTDV			= {	if (LocalRef( RunResults[8]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - Plugs"		Proj:RunResults[8]:ProposedTDV[1]			= {	LocalRef( RunResults[8]:PropElecTDV[1] ) + LocalRef( RunResults[8]:PropNatGasTDV ) + LocalRef( RunResults[8]:PropOtherTDV )   }
	"Calculate Elec Demand  - Plugs"		Proj:RunResults[8]:PropElecDemand[1]		= {	if (LocalRef( RunResults[8]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Rcp" ) / 3.412  endif  }

  ; Exterior
	"Calculate TDV - Elec   - Ext"		Proj:RunResults[9]:PropElecTDV[1]			= {	if (LocalRef( RunResults[9]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - Ext"		Proj:RunResults[9]:PropNatGasTDV			= {	if (LocalRef( RunResults[9]:PropNatGasEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - Ext"		Proj:RunResults[9]:PropOtherTDV			= {	if (LocalRef( RunResults[9]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - Ext"		Proj:RunResults[9]:ProposedTDV[1]			= {	LocalRef( RunResults[9]:PropElecTDV[1] ) + LocalRef( RunResults[9]:PropNatGasTDV ) + LocalRef( RunResults[9]:PropOtherTDV )   }
	"Calculate Elec Demand  - Ext"		Proj:RunResults[9]:PropElecDemand[1]		= {	if (LocalRef( RunResults[9]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Ext" ) / 3.412  endif  }

      ; revised all calls to ApplyHourlyResultMultipliers_NEM() to include hourly NEM table name & col arguments - SAC 05/16/23 (NEM3)
      ; revised all calls to ApplyHourlyResultMultipliers_NEM() to include NEMGrossUpFactor argument - SAC 05/25/23 (NEM3)
  ; PV
   "Calculate TDV - Elec   - PV"    Proj:RunResults[13]:PropElecTDV[1]     = {   if (LocalRef( RunResults[13]:PropElecEnergy[1]      ) > -0.0001) then  0
      else if (CommunitySolarProjID > 0 .AND. IfValidAnd( CmntySlr_TDV < 0 )) then  CmntySlr_TDV * PVWDCSizeMultiplier[1] / CondFloorArea
      else if (IfValidAnd( NetEnergyMeteringTDVAdj != 0) .OR. IfValidAnd( HrlyNEMTableCol > 0 ))
      then  if (LocalRef( RunResults[14]:PropElecEnergy[1] ) = 0)
            then  int( (100 * ApplyHourlyResultMultipliers_NEM( "PVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor          ) / CondFloorArea) + 0.5) / 100
            else  int( (100 * ApplyHourlyResultMultipliers_NEM( "PVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, 1, "BT" ) / CondFloorArea) + 0.5) / 100  endif
      else        int( (100 * ApplyHourlyResultMultipliers(     "PVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV" ) / CondFloorArea) + 0.5) / 100  endif endif endif  }
;"dbg" Proj:Action = { PostMessageToLog( "--Prop PV-- PropElecEnergy[1] %g -- Batt PropElecEnergy[1] %g -- NetEnergyMeteringTDVAdj %g -- TDVMult_Elec %g -- TDVTableName '%s' -- TDVSecTbl_Elec '%s' -- TDVSecMult_Elec %g", RunResults[13]:PropElecEnergy[1], RunResults[14]:PropElecEnergy[1], NetEnergyMeteringTDVAdj, TDVMult_Elec, TDVTableName, TDVSecTbl_Elec, TDVSecMult_Elec ) }
   "Calculate TDV - NatGas - PV"    Proj:RunResults[13]:PropNatGasTDV      = {   0  }
   "Calculate TDV - Other  - PV"    Proj:RunResults[13]:PropOtherTDV       = {   0  }
   "Calculate TDV - TOTAL  - PV"    Proj:RunResults[13]:ProposedTDV[1]     = {   LocalRef( RunResults[13]:PropElecTDV[1] )   }
   "Calculate Elec Demand  - PV"    Proj:RunResults[13]:PropElecDemand[1]  = {   if (LocalRef( RunResults[13]:PropElecEnergy[1]      ) > -0.0001) then  0
                                                                                 else if (CommunitySolarProjID > 0 .AND. IfValidAnd( CmntySlr_ElecDemand < 0 )) then  CmntySlr_ElecDemand * PVWDCSizeMultiplier[1]
                                                                                 else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec", "PV" ) / 3.412  endif endif  }

  ; Battery
   "Calculate TDV - Elec   - Battery"  Proj:RunResults[14]:PropElecTDV[1]     = {   if (LocalRef( RunResults[14]:PropElecEnergy[1]      ) = 0) then  0
      else if (IfValidAnd( NetEnergyMeteringTDVAdj != 0) .OR. IfValidAnd( HrlyNEMTableCol > 0 ))
      then  if (LocalRef( RunResults[13]:PropElecEnergy[1] ) = 0)
            then  int( (100 * ApplyHourlyResultMultipliers_NEM( "BTTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "BT", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor          ) / CondFloorArea) + 0.5) / 100
            else  int( (100 * ApplyHourlyResultMultipliers_NEM( "BTTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "BT", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, 1, "PV" ) / CondFloorArea) + 0.5) / 100  endif
      else        int( (100 * ApplyHourlyResultMultipliers(     "BTTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "BT" ) / CondFloorArea) + 0.5) / 100  endif endif  }
   "Calculate TDV - NatGas - Battery"  Proj:RunResults[14]:PropNatGasTDV      = {   0  }
   "Calculate TDV - Other  - Battery"  Proj:RunResults[14]:PropOtherTDV       = {   0  }
   "Calculate TDV - TOTAL  - Battery"  Proj:RunResults[14]:ProposedTDV[1]     = {   LocalRef( RunResults[14]:PropElecTDV[1] )   }
   "Calculate Elec Demand  - Battery"  Proj:RunResults[14]:PropElecDemand[1]  = {   if (LocalRef( RunResults[14]:PropElecEnergy[1]      ) = 0) then  0
                                                                                    else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec", "BT" ) / 3.412  endif  }

  ; Compliance Total
	"Calculate TDV - Elec   - Comp Ttl"	Proj:RunResults[11]:PropElecTDV[1]		= {	RunResults[1]:PropElecTDV[1]    + RunResults[2]:PropElecTDV[1]    + RunResults[3]:PropElecTDV[1]    + RunResults[4]:PropElecTDV[1]    + RunResults[5]:PropElecTDV[1]     }
	"Calculate TDV - NatGas - Comp Ttl"	Proj:RunResults[11]:PropNatGasTDV		= {	RunResults[1]:PropNatGasTDV     + RunResults[2]:PropNatGasTDV     + RunResults[3]:PropNatGasTDV     + RunResults[4]:PropNatGasTDV     + RunResults[5]:PropNatGasTDV      }
	"Calculate TDV - Other  - Comp Ttl"	Proj:RunResults[11]:PropOtherTDV			= {	RunResults[1]:PropOtherTDV      + RunResults[2]:PropOtherTDV      + RunResults[3]:PropOtherTDV      + RunResults[4]:PropOtherTDV      + RunResults[5]:PropOtherTDV       }
	"Calculate TDV - TOTAL  - Comp Ttl"	Proj:RunResults[11]:ProposedTDV[1]		= {	RunResults[1]:ProposedTDV[1]    + RunResults[2]:ProposedTDV[1]    + RunResults[3]:ProposedTDV[1]    + RunResults[4]:ProposedTDV[1]    + RunResults[5]:ProposedTDV[1]     }
	"Calculate Elec Demand  - Comp Ttl"	Proj:RunResults[11]:PropElecDemand[1]	= {	RunResults[1]:PropElecDemand[1] + RunResults[2]:PropElecDemand[1] + RunResults[3]:PropElecDemand[1] + RunResults[4]:PropElecDemand[1] + RunResults[5]:PropElecDemand[1]  }
;   ; SAC 10/6/16 - 2019 updates   - SAC 4/7/17 - shifted PV & Batt from CompTot to Tot for 2019
;	"Add in PV TDV - Elec   - Comp Ttl"	Proj:RunResults[11]:PropElecTDV[1]	   = {	if (EnergyCodeYearNum < 2019) then  UNCHANGED
;                                                                                    else  RunResults[11]:PropElecTDV[1]    + RunResults[13]:PropElecTDV[1]    + RunResults[14]:PropElecTDV[1]     endif   }
;	"Add in PV TDV - TOTAL  - Comp Ttl"	Proj:RunResults[11]:ProposedTDV[1]  	= {	if (EnergyCodeYearNum < 2019) then  UNCHANGED
;                                                                                    else  RunResults[11]:ProposedTDV[1]    + RunResults[13]:ProposedTDV[1]    + RunResults[14]:ProposedTDV[1]     endif   }
;	"Add in PV Elec Demand  - Comp Ttl"	Proj:RunResults[11]:PropElecDemand[1]	= {	if (EnergyCodeYearNum < 2019) then  UNCHANGED
;                                                                                    else  RunResults[11]:PropElecDemand[1] + RunResults[13]:PropElecDemand[1] + RunResults[14]:PropElecDemand[1]  endif   }

  ; Total
	"Calculate TDV - Elec   - Total"		Proj:RunResults[10]:PropElecTDV[1]		= {	RunResults[11]:PropElecTDV[1]    + RunResults[6]:PropElecTDV[1]    + RunResults[7]:PropElecTDV[1]    + RunResults[8]:PropElecTDV[1]    + RunResults[9]:PropElecTDV[1]     }
	"Calculate TDV - NatGas - Total"		Proj:RunResults[10]:PropNatGasTDV		= {	RunResults[11]:PropNatGasTDV     + RunResults[6]:PropNatGasTDV     + RunResults[7]:PropNatGasTDV     + RunResults[8]:PropNatGasTDV     + RunResults[9]:PropNatGasTDV      }
	"Calculate TDV - Other  - Total"		Proj:RunResults[10]:PropOtherTDV			= {	RunResults[11]:PropOtherTDV      + RunResults[6]:PropOtherTDV      + RunResults[7]:PropOtherTDV      + RunResults[8]:PropOtherTDV      + RunResults[9]:PropOtherTDV       }
	"Calculate TDV - TOTAL  - Total"		Proj:RunResults[10]:ProposedTDV[1]		= {	RunResults[11]:ProposedTDV[1]    + RunResults[6]:ProposedTDV[1]    + RunResults[7]:ProposedTDV[1]    + RunResults[8]:ProposedTDV[1]    + RunResults[9]:ProposedTDV[1]     }
	"Calculate Elec Demand  - Total"		Proj:RunResults[10]:PropElecDemand[1]	= {	RunResults[11]:PropElecDemand[1] + RunResults[6]:PropElecDemand[1] + RunResults[7]:PropElecDemand[1] + RunResults[8]:PropElecDemand[1] + RunResults[9]:PropElecDemand[1]  }
   ; SAC 4/7/17 - shifted PV & Batt from CompTot to Tot for 2019
   ; SAC 4/28/17 - add in only Battery to Total for 2016
	"Add in PV TDV - Elec   - Total"	   Proj:RunResults[10]:PropElecTDV[1]	   = {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                    else if (EnergyCodeYearNum < 2019) 
                                                                                    then  RunResults[10]:PropElecTDV[1]    + RunResults[14]:PropElecTDV[1]
                                                                                    else  RunResults[10]:PropElecTDV[1]    + RunResults[13]:PropElecTDV[1]    + RunResults[14]:PropElecTDV[1]     endif endif   }
	"Add in PV TDV - TOTAL  - Total"	   Proj:RunResults[10]:ProposedTDV[1]  	= {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                    else if (EnergyCodeYearNum < 2019) 
                                                                                    then  RunResults[10]:ProposedTDV[1]    + RunResults[14]:ProposedTDV[1]
                                                                                    else  RunResults[10]:ProposedTDV[1]    + RunResults[13]:ProposedTDV[1]    + RunResults[14]:ProposedTDV[1]     endif endif   }
	"Add in PV Elec Demand  - Total"	   Proj:RunResults[10]:PropElecDemand[1]	= {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                    else if (EnergyCodeYearNum < 2019) 
                                                                                    then  RunResults[10]:PropElecDemand[1] + RunResults[14]:PropElecDemand[1]
                                                                                    else  RunResults[10]:PropElecDemand[1] + RunResults[13]:PropElecDemand[1] + RunResults[14]:PropElecDemand[1]  endif endif   }
END


;*************************************************************************  - SAC 6/25/13
RULELIST "CARes_ProposedTDVResults_N" 1 0 0 1
;*************************************************************************
; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
         ; SAC 8/24/19 - replaced 1/3.413 & 0.01 TDV table multipliers with Proj:TDVSecMult_Elec & TDVSecMult_Fuel to accommodate 2022+ switch to native (E3) TDV table units
         ; SAC 8/26/19 - added primary table multipliers (of 1.0) to all ApplyHourlyResultMult* function calls (to accommodate 2022+ TDV table unit switch)
  ; Space Heating (& heating fan)
	"Calculate TDV - Elec   - N-SpcHt"		Proj:RunResultsN[1]:PropElecTDV[1]			= {	if (LocalRef( RunResultsN[1]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-SpcHt"		Proj:RunResultsN[1]:PropNatGasTDV		= {	if (LocalRef( RunResultsN[1]:PropNatGasEnergy[1]	) < 0.0001) then  0                                                                                                     
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-SpcHt"		Proj:RunResultsN[1]:PropOtherTDV			= {	if (LocalRef( RunResultsN[1]:PropOtherEnergy[1]		) < 0.0001) then  0                                                                                                     
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-SpcHt"		Proj:RunResultsN[1]:ProposedTDV[1]			= {	LocalRef( RunResultsN[1]:PropElecTDV[1] ) + LocalRef( RunResultsN[1]:PropNatGasTDV ) + LocalRef( RunResultsN[1]:PropOtherTDV )   }
  ; SAC 8/23/14 - added rules to set elec demand
	"Calculate Elec Demand  - N-SpcHt"		Proj:RunResultsN[1]:PropElecDemand[1]		= {	if (LocalRef( RunResultsN[1]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / 3.412  endif  }

  ; Space Cooling (& cooling fan)
	"Calculate TDV - Elec   - N-SpcCl"		Proj:RunResultsN[2]:PropElecTDV[1]			= {	if (LocalRef( RunResultsN[2]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-SpcCl"		Proj:RunResultsN[2]:PropNatGasTDV		= {	if (LocalRef( RunResultsN[2]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-SpcCl"		Proj:RunResultsN[2]:PropOtherTDV			= {	if (LocalRef( RunResultsN[2]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-SpcCl"		Proj:RunResultsN[2]:ProposedTDV[1]			= {	LocalRef( RunResultsN[2]:PropElecTDV[1] ) + LocalRef( RunResultsN[2]:PropNatGasTDV ) + LocalRef( RunResultsN[2]:PropOtherTDV )   }
	"Calculate Elec Demand  - N-SpcCl"		Proj:RunResultsN[2]:PropElecDemand[1]		= {	if (LocalRef( RunResultsN[2]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Clg", "FanC" ) / 3.412  endif  }

  ; IAQ Ventilation Fans
	"Calculate TDV - Elec   - N-IAQVent"	Proj:RunResultsN[3]:PropElecTDV[1]			= {	if (LocalRef( RunResultsN[3]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "IAQVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "FanV" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-IAQVent"	Proj:RunResultsN[3]:PropNatGasTDV		= {	0  }
	"Calculate TDV - Other  - N-IAQVent"	Proj:RunResultsN[3]:PropOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - N-IAQVent"	Proj:RunResultsN[3]:ProposedTDV[1]			= {	LocalRef( RunResultsN[3]:PropElecTDV[1] )   }
	"Calculate Elec Demand  - N-IAQVent"	Proj:RunResultsN[3]:PropElecDemand[1]		= {	if (LocalRef( RunResultsN[3]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "FanV" ) / 3.412  endif  }

; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
  ; Other HVAC (aux & misc fans)
	"Calculate TDV - Elec   - N-OthrHVAC"	Proj:RunResultsN[4]:PropElecTDV[1]		= {	if (LocalRef( RunResultsN[4]:PropElecEnergy[1] ) < 0.0001 .AND. OthrHVAC_SpcHtFrac == 0) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "OHVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "User1" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-OthrHVAC"	Proj:RunResultsN[4]:PropNatGasTDV		= {	0  }
	"Calculate TDV - Other  - N-OthrHVAC"	Proj:RunResultsN[4]:PropOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:ProposedTDV[1]		= {	LocalRef( RunResultsN[4]:PropElecTDV[1] )   }
	"Calculate Elec Demand  - N-OthrHVAC"	Proj:RunResultsN[4]:PropElecDemand[1]	= {	if (LocalRef( RunResultsN[4]:PropElecEnergy[1] ) < 0.0001 .AND. OthrHVAC_SpcHtFrac == 0) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "User1" ) / 3.412  endif  }

; SAC 1/27/19 - REDISTRIBUTE OthrHVAC N-Prop TDV across SpcHt & SpcCl by fuel based on ratio of total TDV (across all fuels) (tic #1053)
   "Set OthrHVAC_SpcHtFrac - N-PropTDV"      Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResultsN[4]:ProposedTDV[1] != 0 )==0) then  0
                                                                           else if (IfValidAnd( RunResultsN[1]:ProposedTDV[1] == 0 ) .AND.
                                                                                    IfValidAnd( RunResultsN[2]:ProposedTDV[1] == 0 )) then  0.5
                                                                           else   ValidOr( RunResultsN[1]:ProposedTDV[1], 0 ) / 
                                                                                 (ValidOr( RunResultsN[1]:ProposedTDV[1], 0 ) + ValidOr( RunResultsN[2]:ProposedTDV[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Elec   - N-SpcHt"		Proj:RunResultsN[1]:PropElecTDV[1]	   = {   if (IfValidAnd( RunResultsN[4]:PropElecTDV[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsN[1]:PropElecTDV[1] + (RunResultsN[4]:PropElecTDV[1]     * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - NatGas - N-SpcHt"		Proj:RunResultsN[1]:PropNatGasTDV[1]	= {   if (IfValidAnd( RunResultsN[4]:PropNatGasTDV[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsN[1]:PropNatGasTDV[1] + (RunResultsN[4]:PropNatGasTDV[1] * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - Other  - N-SpcHt"		Proj:RunResultsN[1]:PropOtherTDV[1]	   = {   if (IfValidAnd( RunResultsN[4]:PropOtherTDV[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsN[1]:PropOtherTDV[1] + (RunResultsN[4]:PropOtherTDV[1]   * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - TOTAL  - N-SpcHt"		Proj:RunResultsN[1]:ProposedTDV[1]	   = {	LocalRef( RunResultsN[1]:PropElecTDV[1] ) + LocalRef( RunResultsN[1]:PropNatGasTDV[1] ) + LocalRef( RunResultsN[1]:PropOtherTDV[1] )   }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Elec   - N-SpcCl"		Proj:RunResultsN[2]:PropElecTDV[1]	   = {   if (IfValidAnd( RunResultsN[4]:PropElecTDV[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsN[2]:PropElecTDV[1] + (RunResultsN[4]:PropElecTDV[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - NatGas - N-SpcCl"		Proj:RunResultsN[2]:PropNatGasTDV[1]	= {   if (IfValidAnd( RunResultsN[4]:PropNatGasTDV[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsN[2]:PropNatGasTDV[1] + (RunResultsN[4]:PropNatGasTDV[1] * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - Other  - N-SpcCl"		Proj:RunResultsN[2]:PropOtherTDV[1]	   = {   if (IfValidAnd( RunResultsN[4]:PropOtherTDV[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsN[2]:PropOtherTDV[1] + (RunResultsN[4]:PropOtherTDV[1]   * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - TOTAL  - N-SpcCl"		Proj:RunResultsN[2]:ProposedTDV[1]	   = {	LocalRef( RunResultsN[2]:PropElecTDV[1] ) + LocalRef( RunResultsN[2]:PropNatGasTDV[1] ) + LocalRef( RunResultsN[2]:PropOtherTDV[1] )   }
   ; SAC 1/27/19 - REDISTRIBUTE OthrHVAC Prop Demand across SpcHt & SpcCl by fuel based on ratio of total Demand (tic #1053)
   "Set OthrHVAC_SpcHtFrac - N-Demand"       Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResultsN[4]:PropElecDemand[1] != 0 )==0) then  0
                                                                           else if (IfValidAnd( RunResultsN[1]:PropElecDemand[1] == 0 ) .AND.
                                                                                    IfValidAnd( RunResultsN[2]:PropElecDemand[1] == 0 )) then  0.5
                                                                           else   ValidOr( RunResultsN[1]:PropElecDemand[1], 0 ) / 
                                                                                 (ValidOr( RunResultsN[1]:PropElecDemand[1], 0 ) + ValidOr( RunResultsN[2]:PropElecDemand[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Demand - N-SpcHt"		Proj:RunResultsN[1]:PropElecDemand[1]  = {   if (IfValidAnd( RunResultsN[4]:PropElecDemand[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsN[1]:PropElecDemand[1] + (RunResultsN[4]:PropElecDemand[1]     * OthrHVAC_SpcHtFrac)  endif  }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Demand - N-SpcCl"		Proj:RunResultsN[2]:PropElecDemand[1]  = {   if (IfValidAnd( RunResultsN[4]:PropElecDemand[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsN[2]:PropElecDemand[1] + (RunResultsN[4]:PropElecDemand[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
  ; Other HVAC (aux & misc fans)
	"ZERO-OUT         - Elec   - N-OthrHVAC"	Proj:RunResultsN[4]:PropElecTDV[1]	   = {	0  }
	"ZERO-OUT         - NatGas - N-OthrHVAC"	Proj:RunResultsN[4]:PropNatGasTDV[1]	= {	0  }
	"ZERO-OUT         - Other  - N-OthrHVAC"	Proj:RunResultsN[4]:PropOtherTDV[1]	   = {	0  }
	"ZERO-OUT         - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:ProposedTDV[1]	   = {	0  }
	"ZERO-OUT         - Demand - N-OthrHVAC"	Proj:RunResultsN[4]:PropElecDemand[1]  = {	0  }
   ; SAC 1/27/19 - end of - redistribution of OthrHVAC PropTDV

  ; Water Heating
	"Calculate TDV - Elec   - N-WtrHt"		Proj:RunResultsN[5]:PropElecTDV[1]			= {	if (LocalRef( RunResultsN[5]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else if (CSEinclDHWMFL_EU)
			 			  																							then  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / CondFloorArea) + 0.5) / 100
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate TDV - NatGas - N-WtrHt"		Proj:RunResultsN[5]:PropNatGasTDV		= {	if (LocalRef( RunResultsN[5]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-WtrHt"		Proj:RunResultsN[5]:PropOtherTDV			= {	if (LocalRef( RunResultsN[5]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-WtrHt"		Proj:RunResultsN[5]:ProposedTDV[1]			= {	LocalRef( RunResultsN[5]:PropElecTDV[1] ) + LocalRef( RunResultsN[5]:PropNatGasTDV ) + LocalRef( RunResultsN[5]:PropOtherTDV )   }
	"Calculate Elec Demand  - N-WtrHt"		Proj:RunResultsN[5]:PropElecDemand[1]		= {	if (LocalRef( RunResultsN[5]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else if (CSEinclDHWMFL_EU)
			 			  																							then  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / 3.412
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / 3.412  endif endif  }

  ; Inside Lighting
	"Calculate TDV - Elec   - N-InsLtg"		Proj:RunResultsN[6]:PropElecTDV[1]			= {	if (LocalRef( RunResultsN[6]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-InsLtg"		Proj:RunResultsN[6]:PropNatGasTDV		= {	if (LocalRef( RunResultsN[6]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-InsLtg"		Proj:RunResultsN[6]:PropOtherTDV			= {	if (LocalRef( RunResultsN[6]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-InsLtg"		Proj:RunResultsN[6]:ProposedTDV[1]			= {	LocalRef( RunResultsN[6]:PropElecTDV[1] ) + LocalRef( RunResultsN[6]:PropNatGasTDV ) + LocalRef( RunResultsN[6]:PropOtherTDV )   }
	"Calculate Elec Demand  - N-InsLtg"		Proj:RunResultsN[6]:PropElecDemand[1]		= {	if (LocalRef( RunResultsN[6]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Lit" ) / 3.412  endif  }

  ; Appliances & Cooking
	"Calculate TDV - Elec   - N-AppCkg"		Proj:RunResultsN[7]:PropElecTDV[1]			= {	if (LocalRef( RunResultsN[7]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-AppCkg"		Proj:RunResultsN[7]:PropNatGasTDV		= {	if (LocalRef( RunResultsN[7]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-AppCkg"		Proj:RunResultsN[7]:PropOtherTDV			= {	if (LocalRef( RunResultsN[7]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-AppCkg"		Proj:RunResultsN[7]:ProposedTDV[1]			= {	LocalRef( RunResultsN[7]:PropElecTDV[1] ) + LocalRef( RunResultsN[7]:PropNatGasTDV ) + LocalRef( RunResultsN[7]:PropOtherTDV )   }
	"Calculate Elec Demand  - N-AppCkg"		Proj:RunResultsN[7]:PropElecDemand[1]		= {	if (LocalRef( RunResultsN[7]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / 3.412  endif  }

  ; Plug Loads
	"Calculate TDV - Elec   - N-Plugs"		Proj:RunResultsN[8]:PropElecTDV[1]			= {	if (LocalRef( RunResultsN[8]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-Plugs"		Proj:RunResultsN[8]:PropNatGasTDV		= {	if (LocalRef( RunResultsN[8]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-Plugs"		Proj:RunResultsN[8]:PropOtherTDV			= {	if (LocalRef( RunResultsN[8]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-Plugs"		Proj:RunResultsN[8]:ProposedTDV[1]			= {	LocalRef( RunResultsN[8]:PropElecTDV[1] ) + LocalRef( RunResultsN[8]:PropNatGasTDV ) + LocalRef( RunResultsN[8]:PropOtherTDV )   }
	"Calculate Elec Demand  - N-Plugs"		Proj:RunResultsN[8]:PropElecDemand[1]		= {	if (LocalRef( RunResultsN[8]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Rcp" ) / 3.412  endif  }

  ; Exterior
	"Calculate TDV - Elec   - N-Ext"			Proj:RunResultsN[9]:PropElecTDV[1]			= {	if (LocalRef( RunResultsN[9]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-Ext"			Proj:RunResultsN[9]:PropNatGasTDV		= {	if (LocalRef( RunResultsN[9]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-Ext"			Proj:RunResultsN[9]:PropOtherTDV			= {	if (LocalRef( RunResultsN[9]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-Ext"			Proj:RunResultsN[9]:ProposedTDV[1]			= {	LocalRef( RunResultsN[9]:PropElecTDV[1] ) + LocalRef( RunResultsN[9]:PropNatGasTDV ) + LocalRef( RunResultsN[9]:PropOtherTDV )   }
	"Calculate Elec Demand  - N-Ext"			Proj:RunResultsN[9]:PropElecDemand[1]		= {	if (LocalRef( RunResultsN[9]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Ext" ) / 3.412  endif  }

  ; PV
	"Calculate TDV - Elec   - N-PV"			Proj:RunResultsN[13]:PropElecTDV[1]		= {	if (LocalRef( RunResultsN[13]:PropElecEnergy[1]		) > -0.0001) then  0
      else if (CommunitySolarProjID > 0 .AND. IfValidAnd( CmntySlr_TDV < 0 )) then  CmntySlr_TDV * PVWDCSizeMultiplier[1] / CondFloorArea
		else if (IfValidAnd( NetEnergyMeteringTDVAdj != 0) .OR. IfValidAnd( HrlyNEMTableCol > 0 ))
      then  if (LocalRef( RunResultsN[14]:PropElecEnergy[1] ) = 0)
            then  int( (100 * ApplyHourlyResultMultipliers_NEM( "PVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor          ) / CondFloorArea) + 0.5) / 100
            else  int( (100 * ApplyHourlyResultMultipliers_NEM( "PVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, 1, "BT" ) / CondFloorArea) + 0.5) / 100  endif
      else        int( (100 * ApplyHourlyResultMultipliers(     "PVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV" ) / CondFloorArea) + 0.5) / 100  endif endif endif  }
	"Calculate TDV - NatGas - N-PV"			Proj:RunResultsN[13]:PropNatGasTDV		= {	0  }
	"Calculate TDV - Other  - N-PV"			Proj:RunResultsN[13]:PropOtherTDV		= {	0  }
	"Calculate TDV - TOTAL  - N-PV"			Proj:RunResultsN[13]:ProposedTDV[1]		= {	LocalRef( RunResultsN[13]:PropElecTDV[1] )   }
	"Calculate Elec Demand  - N-PV"			Proj:RunResultsN[13]:PropElecDemand[1]	= {	if (LocalRef( RunResultsN[13]:PropElecEnergy[1]		) > -0.0001) then  0
                                                                                       else if (CommunitySolarProjID > 0 .AND. IfValidAnd( CmntySlr_ElecDemand < 0 )) then  CmntySlr_ElecDemand * PVWDCSizeMultiplier[1]
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec", "PV" ) / 3.412  endif endif  }
; "store BEMProc details"		Proj:Action = {  StoreBEMProc( "DsgnRtg PV TDV", 0 )  }
; "testing"	Proj:Action	= {	MessageBox( "RunResultsN[13]:ProposedTDV[1] = %g  and [2] = %g", ValidOr( RunResultsN[13]:ProposedTDV[1], 0 ), ValidOr( RunResultsN[13]:ProposedTDV[2], 0 ) )  }

  ; Battery
	"Calculate TDV - Elec   - N-Battery"	Proj:RunResultsN[14]:PropElecTDV[1]		= {	if (LocalRef( RunResultsN[14]:PropElecEnergy[1]		) < 0.0001) then  0
		else if (IfValidAnd( NetEnergyMeteringTDVAdj != 0) .OR. IfValidAnd( HrlyNEMTableCol > 0 ))
      then  if (LocalRef( RunResultsN[13]:PropElecEnergy[1] ) = 0)
            then  int( (100 * ApplyHourlyResultMultipliers_NEM( "BTTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "BT", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor          ) / CondFloorArea) + 0.5) / 100
            else  int( (100 * ApplyHourlyResultMultipliers_NEM( "BTTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "BT", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, 1, "PV" ) / CondFloorArea) + 0.5) / 100  endif
      else        int( (100 * ApplyHourlyResultMultipliers(     "BTTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "BT" ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate TDV - NatGas - N-Battery"	Proj:RunResultsN[14]:PropNatGasTDV		= {	0  }
	"Calculate TDV - Other  - N-Battery"	Proj:RunResultsN[14]:PropOtherTDV		= {	0  }
	"Calculate TDV - TOTAL  - N-Battery"	Proj:RunResultsN[14]:ProposedTDV[1]		= {	LocalRef( RunResultsN[14]:PropElecTDV[1] )   }
	"Calculate Elec Demand  - N-Battery"	Proj:RunResultsN[14]:PropElecDemand[1]	= {	if (LocalRef( RunResultsN[14]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "BT" ) / 3.412  endif  }

  ; Compliance Total
	"Calculate TDV - Elec   - N-Comp Ttl"	Proj:RunResultsN[11]:PropElecTDV[1]		= {	RunResultsN[1]:PropElecTDV[1]    + RunResultsN[2]:PropElecTDV[1]    + RunResultsN[3]:PropElecTDV[1]    + RunResultsN[4]:PropElecTDV[1]    + RunResultsN[5]:PropElecTDV[1]     }
	"Calculate TDV - NatGas - N-Comp Ttl"	Proj:RunResultsN[11]:PropNatGasTDV		= {	RunResultsN[1]:PropNatGasTDV     + RunResultsN[2]:PropNatGasTDV     + RunResultsN[3]:PropNatGasTDV     + RunResultsN[4]:PropNatGasTDV     + RunResultsN[5]:PropNatGasTDV      }
	"Calculate TDV - Other  - N-Comp Ttl"	Proj:RunResultsN[11]:PropOtherTDV		= {	RunResultsN[1]:PropOtherTDV      + RunResultsN[2]:PropOtherTDV      + RunResultsN[3]:PropOtherTDV      + RunResultsN[4]:PropOtherTDV      + RunResultsN[5]:PropOtherTDV       }
	"Calculate TDV - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:ProposedTDV[1]		= {	RunResultsN[1]:ProposedTDV[1]    + RunResultsN[2]:ProposedTDV[1]    + RunResultsN[3]:ProposedTDV[1]    + RunResultsN[4]:ProposedTDV[1]    + RunResultsN[5]:ProposedTDV[1]     }
	"Calculate Elec Demand  - N-Comp Ttl"	Proj:RunResultsN[11]:PropElecDemand[1]	= {	RunResultsN[1]:PropElecDemand[1] + RunResultsN[2]:PropElecDemand[1] + RunResultsN[3]:PropElecDemand[1] + RunResultsN[4]:PropElecDemand[1] + RunResultsN[5]:PropElecDemand[1]  }
;   ; SAC 10/6/16 - 2019 updates
;	"Add in PV TDV - Elec   - N-Comp Ttl"	Proj:RunResultsN[11]:PropElecTDV[1]	   = {	if (EnergyCodeYearNum < 2019) then  UNCHANGED
;                                                                                       else  RunResultsN[11]:PropElecTDV[1]    + RunResultsN[13]:PropElecTDV[1]    + RunResultsN[14]:PropElecTDV[1]     endif   }
;	"Add in PV TDV - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:ProposedTDV[1]  	= {	if (EnergyCodeYearNum < 2019) then  UNCHANGED
;                                                                                       else  RunResultsN[11]:ProposedTDV[1]    + RunResultsN[13]:ProposedTDV[1]    + RunResultsN[14]:ProposedTDV[1]     endif   }
;	"Add in PV Elec Demand  - N-Comp Ttl"	Proj:RunResultsN[11]:PropElecDemand[1]	= {	if (EnergyCodeYearNum < 2019) then  UNCHANGED
;                                                                                       else  RunResultsN[11]:PropElecDemand[1] + RunResultsN[13]:PropElecDemand[1] + RunResultsN[14]:PropElecDemand[1]  endif   }

  ; Total
	"Calculate TDV - Elec   - N-Total"		Proj:RunResultsN[10]:PropElecTDV[1]		= {	RunResultsN[11]:PropElecTDV[1]    + RunResultsN[6]:PropElecTDV[1]    + RunResultsN[7]:PropElecTDV[1]    + RunResultsN[8]:PropElecTDV[1]    + RunResultsN[9]:PropElecTDV[1]     }
	"Calculate TDV - NatGas - N-Total"		Proj:RunResultsN[10]:PropNatGasTDV		= {	RunResultsN[11]:PropNatGasTDV  + RunResultsN[6]:PropNatGasTDV  + RunResultsN[7]:PropNatGasTDV  + RunResultsN[8]:PropNatGasTDV  + RunResultsN[9]:PropNatGasTDV   }
	"Calculate TDV - Other  - N-Total"		Proj:RunResultsN[10]:PropOtherTDV		= {	RunResultsN[11]:PropOtherTDV   + RunResultsN[6]:PropOtherTDV   + RunResultsN[7]:PropOtherTDV   + RunResultsN[8]:PropOtherTDV   + RunResultsN[9]:PropOtherTDV    }
	"Calculate TDV - TOTAL  - N-Total"		Proj:RunResultsN[10]:ProposedTDV[1]		= {	RunResultsN[11]:ProposedTDV[1]    + RunResultsN[6]:ProposedTDV[1]    + RunResultsN[7]:ProposedTDV[1]    + RunResultsN[8]:ProposedTDV[1]    + RunResultsN[9]:ProposedTDV[1]     }
	"Calculate Elec Demand  - N-Total"		Proj:RunResultsN[10]:PropElecDemand[1]	= {	RunResultsN[11]:PropElecDemand[1] + RunResultsN[6]:PropElecDemand[1] + RunResultsN[7]:PropElecDemand[1] + RunResultsN[8]:PropElecDemand[1] + RunResultsN[9]:PropElecDemand[1]  }
   ; SAC 4/28/17 - shifted PV & Batt from CompTot to Tot for 2019
   ; SAC 4/28/17 - add in only Battery to Total for 2016
	"Add in PV TDV - Elec   - N-Total"	   Proj:RunResultsN[10]:PropElecTDV[1]	   = {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                       else if (EnergyCodeYearNum < 2019) 
                                                                                       then  RunResultsN[10]:PropElecTDV[1]    + RunResultsN[14]:PropElecTDV[1]
                                                                                       else  RunResultsN[10]:PropElecTDV[1]    + RunResultsN[13]:PropElecTDV[1]    + RunResultsN[14]:PropElecTDV[1]     endif endif   }
	"Add in PV TDV - TOTAL  - N-Total"	   Proj:RunResultsN[10]:ProposedTDV[1]  	= {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                       else if (EnergyCodeYearNum < 2019) 
                                                                                       then  RunResultsN[10]:ProposedTDV[1]    + RunResultsN[14]:ProposedTDV[1]
                                                                                       else  RunResultsN[10]:ProposedTDV[1]    + RunResultsN[13]:ProposedTDV[1]    + RunResultsN[14]:ProposedTDV[1]     endif endif   }
	"Add in PV Elec Demand  - N-Total"	   Proj:RunResultsN[10]:PropElecDemand[1]	= {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                       else if (EnergyCodeYearNum < 2019) 
                                                                                       then  RunResultsN[10]:PropElecDemand[1] + RunResultsN[14]:PropElecDemand[1]
                                                                                       else  RunResultsN[10]:PropElecDemand[1] + RunResultsN[13]:PropElecDemand[1] + RunResultsN[14]:PropElecDemand[1]  endif endif   }
END

;*************************************************************************  - SAC 6/25/13
RULELIST "CARes_ProposedTDVResults_E" 1 0 0 1
;*************************************************************************
; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
         ; SAC 8/24/19 - replaced 1/3.413 & 0.01 TDV table multipliers with Proj:TDVSecMult_Elec & TDVSecMult_Fuel to accommodate 2022+ switch to native (E3) TDV table units
         ; SAC 8/26/19 - added primary table multipliers (of 1.0) to all ApplyHourlyResultMult* function calls (to accommodate 2022+ TDV table unit switch)
  ; Space Heating (& heating fan)
	"Calculate TDV - Elec   - E-SpcHt"		Proj:RunResultsE[1]:PropElecTDV[1]			= {	if (LocalRef( RunResultsE[1]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - E-SpcHt"		Proj:RunResultsE[1]:PropNatGasTDV		= {	if (LocalRef( RunResultsE[1]:PropNatGasEnergy[1]	) < 0.0001) then  0                                                                                                     
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - E-SpcHt"		Proj:RunResultsE[1]:PropOtherTDV			= {	if (LocalRef( RunResultsE[1]:PropOtherEnergy[1]		) < 0.0001) then  0                                                                                                     
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - E-SpcHt"		Proj:RunResultsE[1]:ProposedTDV[1]			= {	LocalRef( RunResultsE[1]:PropElecTDV[1] ) + LocalRef( RunResultsE[1]:PropNatGasTDV ) + LocalRef( RunResultsE[1]:PropOtherTDV )   }
  ; SAC 8/23/14 - added rules to set elec demand
	"Calculate Elec Demand  - E-SpcHt"		Proj:RunResultsE[1]:PropElecDemand[1]		= {	if (LocalRef( RunResultsE[1]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / 3.412  endif  }

  ; Space Cooling (& cooling fan)
	"Calculate TDV - Elec   - E-SpcCl"		Proj:RunResultsE[2]:PropElecTDV[1]			= {	if (LocalRef( RunResultsE[2]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - E-SpcCl"		Proj:RunResultsE[2]:PropNatGasTDV		= {	if (LocalRef( RunResultsE[2]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - E-SpcCl"		Proj:RunResultsE[2]:PropOtherTDV			= {	if (LocalRef( RunResultsE[2]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - E-SpcCl"		Proj:RunResultsE[2]:ProposedTDV[1]			= {	LocalRef( RunResultsE[2]:PropElecTDV[1] ) + LocalRef( RunResultsE[2]:PropNatGasTDV ) + LocalRef( RunResultsE[2]:PropOtherTDV )   }
	"Calculate Elec Demand  - E-SpcCl"		Proj:RunResultsE[2]:PropElecDemand[1]		= {	if (LocalRef( RunResultsE[2]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Clg", "FanC" ) / 3.412  endif  }

  ; IAQ Ventilation Fans
	"Calculate TDV - Elec   - E-IAQVent"	Proj:RunResultsE[3]:PropElecTDV[1]			= {	if (LocalRef( RunResultsE[3]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "IAQVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "FanV" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - E-IAQVent"	Proj:RunResultsE[3]:PropNatGasTDV		= {	0  }
	"Calculate TDV - Other  - E-IAQVent"	Proj:RunResultsE[3]:PropOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - E-IAQVent"	Proj:RunResultsE[3]:ProposedTDV[1]			= {	LocalRef( RunResultsE[3]:PropElecTDV[1] )   }
	"Calculate Elec Demand  - E-IAQVent"	Proj:RunResultsE[3]:PropElecDemand[1]		= {	if (LocalRef( RunResultsE[3]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "FanV" ) / 3.412  endif  }

; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
  ; Other HVAC (aux & misc fans)
	"Calculate TDV - Elec   - E-OthrHVAC"	Proj:RunResultsE[4]:PropElecTDV[1]		= {	if (LocalRef( RunResultsE[4]:PropElecEnergy[1] ) < 0.0001 .AND. OthrHVAC_SpcHtFrac == 0) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "OHVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "User1" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - E-OthrHVAC"	Proj:RunResultsE[4]:PropNatGasTDV		= {	0  }
	"Calculate TDV - Other  - E-OthrHVAC"	Proj:RunResultsE[4]:PropOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - E-OthrHVAC"	Proj:RunResultsE[4]:ProposedTDV[1]		= {	LocalRef( RunResultsE[4]:PropElecTDV[1] )   }
	"Calculate Elec Demand  - E-OthrHVAC"	Proj:RunResultsE[4]:PropElecDemand[1]	= {	if (LocalRef( RunResultsE[4]:PropElecEnergy[1] ) < 0.0001 .AND. OthrHVAC_SpcHtFrac == 0) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "User1" ) / 3.412  endif  }

; SAC 1/27/19 - REDISTRIBUTE OthrHVAC E-Prop TDV across SpcHt & SpcCl by fuel based on ratio of total TDV (across all fuels) (tic #1053)
   "Set OthrHVAC_SpcHtFrac - E-PropTDV"      Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResultsE[4]:ProposedTDV[1] != 0 )==0) then  0
                                                                           else if (IfValidAnd( RunResultsE[1]:ProposedTDV[1] == 0 ) .AND.
                                                                                    IfValidAnd( RunResultsE[2]:ProposedTDV[1] == 0 )) then  0.5
                                                                           else   ValidOr( RunResultsE[1]:ProposedTDV[1], 0 ) / 
                                                                                 (ValidOr( RunResultsE[1]:ProposedTDV[1], 0 ) + ValidOr( RunResultsE[2]:ProposedTDV[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Elec   - E-SpcHt"		Proj:RunResultsE[1]:PropElecTDV[1]	   = {   if (IfValidAnd( RunResultsE[4]:PropElecTDV[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsE[1]:PropElecTDV[1] + (RunResultsE[4]:PropElecTDV[1]     * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - NatGas - E-SpcHt"		Proj:RunResultsE[1]:PropNatGasTDV[1]	= {   if (IfValidAnd( RunResultsE[4]:PropNatGasTDV[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsE[1]:PropNatGasTDV[1] + (RunResultsE[4]:PropNatGasTDV[1] * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - Other  - E-SpcHt"		Proj:RunResultsE[1]:PropOtherTDV[1]	   = {   if (IfValidAnd( RunResultsE[4]:PropOtherTDV[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsE[1]:PropOtherTDV[1] + (RunResultsE[4]:PropOtherTDV[1]   * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - TOTAL  - E-SpcHt"		Proj:RunResultsE[1]:ProposedTDV[1]	   = {	LocalRef( RunResultsE[1]:PropElecTDV[1] ) + LocalRef( RunResultsE[1]:PropNatGasTDV[1] ) + LocalRef( RunResultsE[1]:PropOtherTDV[1] )   }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Elec   - E-SpcCl"		Proj:RunResultsE[2]:PropElecTDV[1]	   = {   if (IfValidAnd( RunResultsE[4]:PropElecTDV[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsE[2]:PropElecTDV[1] + (RunResultsE[4]:PropElecTDV[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - NatGas - E-SpcCl"		Proj:RunResultsE[2]:PropNatGasTDV[1]	= {   if (IfValidAnd( RunResultsE[4]:PropNatGasTDV[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsE[2]:PropNatGasTDV[1] + (RunResultsE[4]:PropNatGasTDV[1] * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - Other  - E-SpcCl"		Proj:RunResultsE[2]:PropOtherTDV[1]	   = {   if (IfValidAnd( RunResultsE[4]:PropOtherTDV[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsE[2]:PropOtherTDV[1] + (RunResultsE[4]:PropOtherTDV[1]   * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - TOTAL  - E-SpcCl"		Proj:RunResultsE[2]:ProposedTDV[1]	   = {	LocalRef( RunResultsE[2]:PropElecTDV[1] ) + LocalRef( RunResultsE[2]:PropNatGasTDV[1] ) + LocalRef( RunResultsE[2]:PropOtherTDV[1] )   }
   ; SAC 1/27/19 - REDISTRIBUTE OthrHVAC Prop Demand across SpcHt & SpcCl by fuel based on ratio of total Demand (tic #1053)
   "Set OthrHVAC_SpcHtFrac - E-Demand"       Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResultsE[4]:PropElecDemand[1] != 0 )==0) then  0
                                                                           else if (IfValidAnd( RunResultsE[1]:PropElecDemand[1] == 0 ) .AND.
                                                                                    IfValidAnd( RunResultsE[2]:PropElecDemand[1] == 0 )) then  0.5
                                                                           else   ValidOr( RunResultsE[1]:PropElecDemand[1], 0 ) / 
                                                                                 (ValidOr( RunResultsE[1]:PropElecDemand[1], 0 ) + ValidOr( RunResultsE[2]:PropElecDemand[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Demand - E-SpcHt"		Proj:RunResultsE[1]:PropElecDemand[1]  = {   if (IfValidAnd( RunResultsE[4]:PropElecDemand[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsE[1]:PropElecDemand[1] + (RunResultsE[4]:PropElecDemand[1]     * OthrHVAC_SpcHtFrac)  endif  }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Demand - E-SpcCl"		Proj:RunResultsE[2]:PropElecDemand[1]  = {   if (IfValidAnd( RunResultsE[4]:PropElecDemand[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsE[2]:PropElecDemand[1] + (RunResultsE[4]:PropElecDemand[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
  ; Other HVAC (aux & misc fans)
	"ZERO-OUT         - Elec   - E-OthrHVAC"	Proj:RunResultsE[4]:PropElecTDV[1]	   = {	0  }
	"ZERO-OUT         - NatGas - E-OthrHVAC"	Proj:RunResultsE[4]:PropNatGasTDV[1]	= {	0  }
	"ZERO-OUT         - Other  - E-OthrHVAC"	Proj:RunResultsE[4]:PropOtherTDV[1]	   = {	0  }
	"ZERO-OUT         - TOTAL  - E-OthrHVAC"	Proj:RunResultsE[4]:ProposedTDV[1]	   = {	0  }
	"ZERO-OUT         - Demand - E-OthrHVAC"	Proj:RunResultsE[4]:PropElecDemand[1]  = {	0  }
   ; SAC 1/27/19 - end of - redistribution of OthrHVAC PropTDV

  ; Water Heating
	"Calculate TDV - Elec   - E-WtrHt"		Proj:RunResultsE[5]:PropElecTDV[1]			= {	if (LocalRef( RunResultsE[5]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else if (CSEinclDHWMFL_EU)
			 			  																							then  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / CondFloorArea) + 0.5) / 100
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate TDV - NatGas - E-WtrHt"		Proj:RunResultsE[5]:PropNatGasTDV		= {	if (LocalRef( RunResultsE[5]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - E-WtrHt"		Proj:RunResultsE[5]:PropOtherTDV			= {	if (LocalRef( RunResultsE[5]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - E-WtrHt"		Proj:RunResultsE[5]:ProposedTDV[1]			= {	LocalRef( RunResultsE[5]:PropElecTDV[1] ) + LocalRef( RunResultsE[5]:PropNatGasTDV ) + LocalRef( RunResultsE[5]:PropOtherTDV )   }
	"Calculate Elec Demand  - E-WtrHt"		Proj:RunResultsE[5]:PropElecDemand[1]		= {	if (LocalRef( RunResultsE[5]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else if (CSEinclDHWMFL_EU)
			 			  																							then  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / 3.412
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / 3.412  endif endif  }

  ; Inside Lighting
	"Calculate TDV - Elec   - E-InsLtg"		Proj:RunResultsE[6]:PropElecTDV[1]			= {	if (LocalRef( RunResultsE[6]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - E-InsLtg"		Proj:RunResultsE[6]:PropNatGasTDV		= {	if (LocalRef( RunResultsE[6]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - E-InsLtg"		Proj:RunResultsE[6]:PropOtherTDV			= {	if (LocalRef( RunResultsE[6]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - E-InsLtg"		Proj:RunResultsE[6]:ProposedTDV[1]			= {	LocalRef( RunResultsE[6]:PropElecTDV[1] ) + LocalRef( RunResultsE[6]:PropNatGasTDV ) + LocalRef( RunResultsE[6]:PropOtherTDV )   }
	"Calculate Elec Demand  - E-IndLtg"		Proj:RunResultsE[6]:PropElecDemand[1]		= {	if (LocalRef( RunResultsE[6]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Lit" ) / 3.412  endif  }

  ; Appliances & Cooking
	"Calculate TDV - Elec   - E-AppCkg"		Proj:RunResultsE[7]:PropElecTDV[1]			= {	if (LocalRef( RunResultsE[7]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - E-AppCkg"		Proj:RunResultsE[7]:PropNatGasTDV		= {	if (LocalRef( RunResultsE[7]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - E-AppCkg"		Proj:RunResultsE[7]:PropOtherTDV			= {	if (LocalRef( RunResultsE[7]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - E-AppCkg"		Proj:RunResultsE[7]:ProposedTDV[1]			= {	LocalRef( RunResultsE[7]:PropElecTDV[1] ) + LocalRef( RunResultsE[7]:PropNatGasTDV ) + LocalRef( RunResultsE[7]:PropOtherTDV )   }
	"Calculate Elec Demand  - E-AppCkg"		Proj:RunResultsE[7]:PropElecDemand[1]		= {	if (LocalRef( RunResultsE[7]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / 3.412  endif  }

  ; Plug Loads
	"Calculate TDV - Elec   - E-Plugs"		Proj:RunResultsE[8]:PropElecTDV[1]			= {	if (LocalRef( RunResultsE[8]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - E-Plugs"		Proj:RunResultsE[8]:PropNatGasTDV		= {	if (LocalRef( RunResultsE[8]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - E-Plugs"		Proj:RunResultsE[8]:PropOtherTDV			= {	if (LocalRef( RunResultsE[8]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - E-Plugs"		Proj:RunResultsE[8]:ProposedTDV[1]			= {	LocalRef( RunResultsE[8]:PropElecTDV[1] ) + LocalRef( RunResultsE[8]:PropNatGasTDV ) + LocalRef( RunResultsE[8]:PropOtherTDV )   }
	"Calculate Elec Demand  - E-Plugs"		Proj:RunResultsE[8]:PropElecDemand[1]		= {	if (LocalRef( RunResultsE[8]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Rcp" ) / 3.412  endif  }

  ; Exterior
	"Calculate TDV - Elec   - E-Ext"			Proj:RunResultsE[9]:PropElecTDV[1]			= {	if (LocalRef( RunResultsE[9]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - E-Ext"			Proj:RunResultsE[9]:PropNatGasTDV		= {	if (LocalRef( RunResultsE[9]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - E-Ext"			Proj:RunResultsE[9]:PropOtherTDV			= {	if (LocalRef( RunResultsE[9]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - E-Ext"			Proj:RunResultsE[9]:ProposedTDV[1]			= {	LocalRef( RunResultsE[9]:PropElecTDV[1] ) + LocalRef( RunResultsE[9]:PropNatGasTDV ) + LocalRef( RunResultsE[9]:PropOtherTDV )   }
	"Calculate Elec Demand  - E-Ext"			Proj:RunResultsE[9]:PropElecDemand[1]		= {	if (LocalRef( RunResultsE[9]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Ext" ) / 3.412  endif  }

  ; PV
	"Calculate TDV - Elec   - E-PV"			Proj:RunResultsE[13]:PropElecTDV[1]		= {	if (LocalRef( RunResultsE[13]:PropElecEnergy[1]		) > -0.0001) then  0
      else if (CommunitySolarProjID > 0 .AND. IfValidAnd( CmntySlr_TDV < 0 )) then  CmntySlr_TDV * PVWDCSizeMultiplier[1] / CondFloorArea
		else if (IfValidAnd( NetEnergyMeteringTDVAdj != 0) .OR. IfValidAnd( HrlyNEMTableCol > 0 ))
      then  if (LocalRef( RunResultsE[14]:PropElecEnergy[1] ) = 0)
            then  int( (100 * ApplyHourlyResultMultipliers_NEM( "PVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor          ) / CondFloorArea) + 0.5) / 100
            else  int( (100 * ApplyHourlyResultMultipliers_NEM( "PVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, 1, "BT" ) / CondFloorArea) + 0.5) / 100  endif
      else        int( (100 * ApplyHourlyResultMultipliers(     "PVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV" ) / CondFloorArea) + 0.5) / 100  endif endif endif  }
	"Calculate TDV - NatGas - E-PV"			Proj:RunResultsE[13]:PropNatGasTDV		= {	0  }
	"Calculate TDV - Other  - E-PV"			Proj:RunResultsE[13]:PropOtherTDV		= {	0  }
	"Calculate TDV - TOTAL  - E-PV"			Proj:RunResultsE[13]:ProposedTDV[1]		= {	LocalRef( RunResultsE[13]:PropElecTDV[1] )   }
	"Calculate Elec Demand  - E-PV"			Proj:RunResultsE[13]:PropElecDemand[1]	= {	if (LocalRef( RunResultsE[13]:PropElecEnergy[1]		) > -0.0001) then  0
                                                                                       else if (CommunitySolarProjID > 0 .AND. IfValidAnd( CmntySlr_ElecDemand < 0 )) then  CmntySlr_ElecDemand * PVWDCSizeMultiplier[1]
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec", "PV" ) / 3.412  endif endif  }

  ; Battery
	"Calculate TDV - Elec   - E-Battery"	Proj:RunResultsE[14]:PropElecTDV[1]		= {	if (LocalRef( RunResultsE[14]:PropElecEnergy[1]		) < 0.0001) then  0
		else if (IfValidAnd( NetEnergyMeteringTDVAdj != 0) .OR. IfValidAnd( HrlyNEMTableCol > 0 ))
      then  if (LocalRef( RunResultsE[13]:PropElecEnergy[1] ) = 0)
            then  int( (100 * ApplyHourlyResultMultipliers_NEM( "BTTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "BT", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor          ) / CondFloorArea) + 0.5) / 100
            else  int( (100 * ApplyHourlyResultMultipliers_NEM( "BTTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "BT", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, 1, "PV" ) / CondFloorArea) + 0.5) / 100  endif
      else        int( (100 * ApplyHourlyResultMultipliers(     "BTTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "BT" ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate TDV - NatGas - E-Battery"	Proj:RunResultsE[14]:PropNatGasTDV		= {	0  }
	"Calculate TDV - Other  - E-Battery"	Proj:RunResultsE[14]:PropOtherTDV		= {	0  }
	"Calculate TDV - TOTAL  - E-Battery"	Proj:RunResultsE[14]:ProposedTDV[1]		= {	LocalRef( RunResultsE[14]:PropElecTDV[1] )   }
	"Calculate Elec Demand  - E-Battery"	Proj:RunResultsE[14]:PropElecDemand[1]	= {	if (LocalRef( RunResultsE[14]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec", "BT" ) / 3.412  endif  }

  ; Compliance Total
	"Calculate TDV - Elec   - E-Comp Ttl"	Proj:RunResultsE[11]:PropElecTDV[1]			= {	RunResultsE[1]:PropElecTDV[1]    + RunResultsE[2]:PropElecTDV[1]    + RunResultsE[3]:PropElecTDV[1]    + RunResultsE[4]:PropElecTDV[1]    + RunResultsE[5]:PropElecTDV[1]     }
	"Calculate TDV - NatGas - E-Comp Ttl"	Proj:RunResultsE[11]:PropNatGasTDV		= {	RunResultsE[1]:PropNatGasTDV  + RunResultsE[2]:PropNatGasTDV  + RunResultsE[3]:PropNatGasTDV  + RunResultsE[4]:PropNatGasTDV  + RunResultsE[5]:PropNatGasTDV   }
	"Calculate TDV - Other  - E-Comp Ttl"	Proj:RunResultsE[11]:PropOtherTDV		= {	RunResultsE[1]:PropOtherTDV   + RunResultsE[2]:PropOtherTDV   + RunResultsE[3]:PropOtherTDV   + RunResultsE[4]:PropOtherTDV   + RunResultsE[5]:PropOtherTDV    }
	"Calculate TDV - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:ProposedTDV[1]			= {	RunResultsE[1]:ProposedTDV[1]    + RunResultsE[2]:ProposedTDV[1]    + RunResultsE[3]:ProposedTDV[1]    + RunResultsE[4]:ProposedTDV[1]    + RunResultsE[5]:ProposedTDV[1]     }
	"Calculate Elec Demand  - E-Comp Ttl"	Proj:RunResultsE[11]:PropElecDemand[1]		= {	RunResultsE[1]:PropElecDemand[1] + RunResultsE[2]:PropElecDemand[1] + RunResultsE[3]:PropElecDemand[1] + RunResultsE[4]:PropElecDemand[1] + RunResultsE[5]:PropElecDemand[1]  }
;   ; SAC 10/6/16 - 2019 updates
;	"Add in PV TDV - Elec   - E-Comp Ttl"	Proj:RunResultsE[11]:PropElecTDV[1]	   = {	if (EnergyCodeYearNum < 2019) then  UNCHANGED
;                                                                                       else  RunResultsE[11]:PropElecTDV[1]    + RunResultsE[13]:PropElecTDV[1]    + RunResultsE[14]:PropElecTDV[1]     endif   }
;	"Add in PV TDV - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:ProposedTDV[1]  	= {	if (EnergyCodeYearNum < 2019) then  UNCHANGED
;                                                                                       else  RunResultsE[11]:ProposedTDV[1]    + RunResultsE[13]:ProposedTDV[1]    + RunResultsE[14]:ProposedTDV[1]     endif   }
;	"Add in PV Elec Demand  - E-Comp Ttl"	Proj:RunResultsE[11]:PropElecDemand[1]	= {	if (EnergyCodeYearNum < 2019) then  UNCHANGED
;                                                                                       else  RunResultsE[11]:PropElecDemand[1] + RunResultsE[13]:PropElecDemand[1] + RunResultsE[14]:PropElecDemand[1]  endif   }

  ; Total
	"Calculate TDV - Elec   - E-Total"		Proj:RunResultsE[10]:PropElecTDV[1]			= {	RunResultsE[11]:PropElecTDV[1]    + RunResultsE[6]:PropElecTDV[1]    + RunResultsE[7]:PropElecTDV[1]    + RunResultsE[8]:PropElecTDV[1]    + RunResultsE[9]:PropElecTDV[1]     }
	"Calculate TDV - NatGas - E-Total"		Proj:RunResultsE[10]:PropNatGasTDV		= {	RunResultsE[11]:PropNatGasTDV  + RunResultsE[6]:PropNatGasTDV  + RunResultsE[7]:PropNatGasTDV  + RunResultsE[8]:PropNatGasTDV  + RunResultsE[9]:PropNatGasTDV   }
	"Calculate TDV - Other  - E-Total"		Proj:RunResultsE[10]:PropOtherTDV		= {	RunResultsE[11]:PropOtherTDV   + RunResultsE[6]:PropOtherTDV   + RunResultsE[7]:PropOtherTDV   + RunResultsE[8]:PropOtherTDV   + RunResultsE[9]:PropOtherTDV    }
	"Calculate TDV - TOTAL  - E-Total"		Proj:RunResultsE[10]:ProposedTDV[1]			= {	RunResultsE[11]:ProposedTDV[1]    + RunResultsE[6]:ProposedTDV[1]    + RunResultsE[7]:ProposedTDV[1]    + RunResultsE[8]:ProposedTDV[1]    + RunResultsE[9]:ProposedTDV[1]     }
	"Calculate Elec Demand  - E-Total"		Proj:RunResultsE[10]:PropElecDemand[1]		= {	RunResultsE[11]:PropElecDemand[1] + RunResultsE[6]:PropElecDemand[1] + RunResultsE[7]:PropElecDemand[1] + RunResultsE[8]:PropElecDemand[1] + RunResultsE[9]:PropElecDemand[1]  }
   ; SAC 4/28/17 - shifted PV & Batt from CompTot to Tot for 2019
   ; SAC 4/28/17 - add in only Battery to Total for 2016
	"Add in PV TDV - Elec   - E-Total"	   Proj:RunResultsE[10]:PropElecTDV[1]	   = {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                       else if (EnergyCodeYearNum < 2019) 
                                                                                       then  RunResultsE[10]:PropElecTDV[1]    + RunResultsE[14]:PropElecTDV[1]
                                                                                       else  RunResultsE[10]:PropElecTDV[1]    + RunResultsE[13]:PropElecTDV[1]    + RunResultsE[14]:PropElecTDV[1]     endif endif   }
	"Add in PV TDV - TOTAL  - E-Total"	   Proj:RunResultsE[10]:ProposedTDV[1]  	= {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                       else if (EnergyCodeYearNum < 2019) 
                                                                                       then  RunResultsE[10]:ProposedTDV[1]    + RunResultsE[14]:ProposedTDV[1]
                                                                                       else  RunResultsE[10]:ProposedTDV[1]    + RunResultsE[13]:ProposedTDV[1]    + RunResultsE[14]:ProposedTDV[1]     endif endif   }
	"Add in PV Elec Demand  - E-Total"	   Proj:RunResultsE[10]:PropElecDemand[1]	= {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                       else if (EnergyCodeYearNum < 2019) 
                                                                                       then  RunResultsE[10]:PropElecDemand[1] + RunResultsE[14]:PropElecDemand[1]
                                                                                       else  RunResultsE[10]:PropElecDemand[1] + RunResultsE[13]:PropElecDemand[1] + RunResultsE[14]:PropElecDemand[1]  endif endif   }
END

;*************************************************************************  - SAC 6/25/13
RULELIST "CARes_ProposedTDVResults_S" 1 0 0 1
;*************************************************************************
; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
         ; SAC 8/24/19 - replaced 1/3.413 & 0.01 TDV table multipliers with Proj:TDVSecMult_Elec & TDVSecMult_Fuel to accommodate 2022+ switch to native (E3) TDV table units
         ; SAC 8/26/19 - added primary table multipliers (of 1.0) to all ApplyHourlyResultMult* function calls (to accommodate 2022+ TDV table unit switch)
  ; Space Heating (& heating fan)
	"Calculate TDV - Elec   - S-SpcHt"		Proj:RunResultsS[1]:PropElecTDV[1]			= {	if (LocalRef( RunResultsS[1]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - S-SpcHt"		Proj:RunResultsS[1]:PropNatGasTDV		= {	if (LocalRef( RunResultsS[1]:PropNatGasEnergy[1]	) < 0.0001) then  0                                                                                                     
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - S-SpcHt"		Proj:RunResultsS[1]:PropOtherTDV			= {	if (LocalRef( RunResultsS[1]:PropOtherEnergy[1]		) < 0.0001) then  0                                                                                                     
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - S-SpcHt"		Proj:RunResultsS[1]:ProposedTDV[1]			= {	LocalRef( RunResultsS[1]:PropElecTDV[1] ) + LocalRef( RunResultsS[1]:PropNatGasTDV ) + LocalRef( RunResultsS[1]:PropOtherTDV )   }
  ; SAC 8/23/14 - added rules to set elec demand
	"Calculate Elec Demand  - S-SpcHt"		Proj:RunResultsS[1]:PropElecDemand[1]		= {	if (LocalRef( RunResultsS[1]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / 3.412  endif  }

  ; Space Cooling (& cooling fan)
	"Calculate TDV - Elec   - S-SpcCl"		Proj:RunResultsS[2]:PropElecTDV[1]			= {	if (LocalRef( RunResultsS[2]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - S-SpcCl"		Proj:RunResultsS[2]:PropNatGasTDV		= {	if (LocalRef( RunResultsS[2]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - S-SpcCl"		Proj:RunResultsS[2]:PropOtherTDV			= {	if (LocalRef( RunResultsS[2]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - S-SpcCl"		Proj:RunResultsS[2]:ProposedTDV[1]			= {	LocalRef( RunResultsS[2]:PropElecTDV[1] ) + LocalRef( RunResultsS[2]:PropNatGasTDV ) + LocalRef( RunResultsS[2]:PropOtherTDV )   }
	"Calculate Elec Demand  - S-SpcCl"		Proj:RunResultsS[2]:PropElecDemand[1]		= {	if (LocalRef( RunResultsS[2]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Clg", "FanC" ) / 3.412  endif  }

  ; IAQ Ventilation Fans
	"Calculate TDV - Elec   - S-IAQVent"	Proj:RunResultsS[3]:PropElecTDV[1]			= {	if (LocalRef( RunResultsS[3]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "IAQVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "FanV" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - S-IAQVent"	Proj:RunResultsS[3]:PropNatGasTDV		= {	0  }
	"Calculate TDV - Other  - S-IAQVent"	Proj:RunResultsS[3]:PropOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - S-IAQVent"	Proj:RunResultsS[3]:ProposedTDV[1]			= {	LocalRef( RunResultsS[3]:PropElecTDV[1] )   }
	"Calculate Elec Demand  - S-IAQVent"	Proj:RunResultsS[3]:PropElecDemand[1]		= {	if (LocalRef( RunResultsS[3]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "FanV" ) / 3.412  endif  }

; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
  ; Other HVAC (aux & misc fans)
	"Calculate TDV - Elec   - S-OthrHVAC"	Proj:RunResultsS[4]:PropElecTDV[1]		= {	if (LocalRef( RunResultsS[4]:PropElecEnergy[1] ) < 0.0001 .AND. OthrHVAC_SpcHtFrac == 0) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "OHVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "User1" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - S-OthrHVAC"	Proj:RunResultsS[4]:PropNatGasTDV		= {	0  }
	"Calculate TDV - Other  - S-OthrHVAC"	Proj:RunResultsS[4]:PropOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - S-OthrHVAC"	Proj:RunResultsS[4]:ProposedTDV[1]		= {	LocalRef( RunResultsS[4]:PropElecTDV[1] )   }
	"Calculate Elec Demand  - S-OthrHVAC"	Proj:RunResultsS[4]:PropElecDemand[1]	= {	if (LocalRef( RunResultsS[4]:PropElecEnergy[1] ) < 0.0001 .AND. OthrHVAC_SpcHtFrac == 0) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "User1" ) / 3.412  endif  }

; SAC 1/27/19 - REDISTRIBUTE OthrHVAC S-Prop TDV across SpcHt & SpcCl by fuel based on ratio of total TDV (across all fuels) (tic #1053)
   "Set OthrHVAC_SpcHtFrac - S-PropTDV"      Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResultsS[4]:ProposedTDV[1] != 0 )==0) then  0
                                                                           else if (IfValidAnd( RunResultsS[1]:ProposedTDV[1] == 0 ) .AND.
                                                                                    IfValidAnd( RunResultsS[2]:ProposedTDV[1] == 0 )) then  0.5
                                                                           else   ValidOr( RunResultsS[1]:ProposedTDV[1], 0 ) / 
                                                                                 (ValidOr( RunResultsS[1]:ProposedTDV[1], 0 ) + ValidOr( RunResultsS[2]:ProposedTDV[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Elec   - S-SpcHt"		Proj:RunResultsS[1]:PropElecTDV[1]	   = {   if (IfValidAnd( RunResultsS[4]:PropElecTDV[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsS[1]:PropElecTDV[1] + (RunResultsS[4]:PropElecTDV[1]     * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - NatGas - S-SpcHt"		Proj:RunResultsS[1]:PropNatGasTDV[1]	= {   if (IfValidAnd( RunResultsS[4]:PropNatGasTDV[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsS[1]:PropNatGasTDV[1] + (RunResultsS[4]:PropNatGasTDV[1] * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - Other  - S-SpcHt"		Proj:RunResultsS[1]:PropOtherTDV[1]	   = {   if (IfValidAnd( RunResultsS[4]:PropOtherTDV[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsS[1]:PropOtherTDV[1] + (RunResultsS[4]:PropOtherTDV[1]   * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - TOTAL  - S-SpcHt"		Proj:RunResultsS[1]:ProposedTDV[1]	   = {	LocalRef( RunResultsS[1]:PropElecTDV[1] ) + LocalRef( RunResultsS[1]:PropNatGasTDV[1] ) + LocalRef( RunResultsS[1]:PropOtherTDV[1] )   }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Elec   - S-SpcCl"		Proj:RunResultsS[2]:PropElecTDV[1]	   = {   if (IfValidAnd( RunResultsS[4]:PropElecTDV[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsS[2]:PropElecTDV[1] + (RunResultsS[4]:PropElecTDV[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - NatGas - S-SpcCl"		Proj:RunResultsS[2]:PropNatGasTDV[1]	= {   if (IfValidAnd( RunResultsS[4]:PropNatGasTDV[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsS[2]:PropNatGasTDV[1] + (RunResultsS[4]:PropNatGasTDV[1] * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - Other  - S-SpcCl"		Proj:RunResultsS[2]:PropOtherTDV[1]	   = {   if (IfValidAnd( RunResultsS[4]:PropOtherTDV[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsS[2]:PropOtherTDV[1] + (RunResultsS[4]:PropOtherTDV[1]   * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - TOTAL  - S-SpcCl"		Proj:RunResultsS[2]:ProposedTDV[1]	   = {	LocalRef( RunResultsS[2]:PropElecTDV[1] ) + LocalRef( RunResultsS[2]:PropNatGasTDV[1] ) + LocalRef( RunResultsS[2]:PropOtherTDV[1] )   }
   ; SAC 1/27/19 - REDISTRIBUTE OthrHVAC Prop Demand across SpcHt & SpcCl by fuel based on ratio of total Demand (tic #1053)
   "Set OthrHVAC_SpcHtFrac - S-Demand"       Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResultsS[4]:PropElecDemand[1] != 0 )==0) then  0
                                                                           else if (IfValidAnd( RunResultsS[1]:PropElecDemand[1] == 0 ) .AND.
                                                                                    IfValidAnd( RunResultsS[2]:PropElecDemand[1] == 0 )) then  0.5
                                                                           else   ValidOr( RunResultsS[1]:PropElecDemand[1], 0 ) / 
                                                                                 (ValidOr( RunResultsS[1]:PropElecDemand[1], 0 ) + ValidOr( RunResultsS[2]:PropElecDemand[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Demand - S-SpcHt"		Proj:RunResultsS[1]:PropElecDemand[1]  = {   if (IfValidAnd( RunResultsS[4]:PropElecDemand[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsS[1]:PropElecDemand[1] + (RunResultsS[4]:PropElecDemand[1]     * OthrHVAC_SpcHtFrac)  endif  }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Demand - S-SpcCl"		Proj:RunResultsS[2]:PropElecDemand[1]  = {   if (IfValidAnd( RunResultsS[4]:PropElecDemand[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsS[2]:PropElecDemand[1] + (RunResultsS[4]:PropElecDemand[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
  ; Other HVAC (aux & misc fans)
	"ZERO-OUT         - Elec   - S-OthrHVAC"	Proj:RunResultsS[4]:PropElecTDV[1]	   = {	0  }
	"ZERO-OUT         - NatGas - S-OthrHVAC"	Proj:RunResultsS[4]:PropNatGasTDV[1]	= {	0  }
	"ZERO-OUT         - Other  - S-OthrHVAC"	Proj:RunResultsS[4]:PropOtherTDV[1]	   = {	0  }
	"ZERO-OUT         - TOTAL  - S-OthrHVAC"	Proj:RunResultsS[4]:ProposedTDV[1]	   = {	0  }
	"ZERO-OUT         - Demand - S-OthrHVAC"	Proj:RunResultsS[4]:PropElecDemand[1]  = {	0  }
   ; SAC 1/27/19 - end of - redistribution of OthrHVAC PropTDV

  ; Water Heating
	"Calculate TDV - Elec   - S-WtrHt"		Proj:RunResultsS[5]:PropElecTDV[1]			= {	if (LocalRef( RunResultsS[5]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else if (CSEinclDHWMFL_EU)
			 			  																							then  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / CondFloorArea) + 0.5) / 100
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate TDV - NatGas - S-WtrHt"		Proj:RunResultsS[5]:PropNatGasTDV		= {	if (LocalRef( RunResultsS[5]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - S-WtrHt"		Proj:RunResultsS[5]:PropOtherTDV			= {	if (LocalRef( RunResultsS[5]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - S-WtrHt"		Proj:RunResultsS[5]:ProposedTDV[1]			= {	LocalRef( RunResultsS[5]:PropElecTDV[1] ) + LocalRef( RunResultsS[5]:PropNatGasTDV ) + LocalRef( RunResultsS[5]:PropOtherTDV )   }
	"Calculate Elec Demand  - S-WtrHt"		Proj:RunResultsS[5]:PropElecDemand[1]		= {	if (LocalRef( RunResultsS[5]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else if (CSEinclDHWMFL_EU)
			 			  																							then  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / 3.412
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / 3.412  endif endif  }

  ; Inside Lighting
	"Calculate TDV - Elec   - S-InsLtg"		Proj:RunResultsS[6]:PropElecTDV[1]			= {	if (LocalRef( RunResultsS[6]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - S-InsLtg"		Proj:RunResultsS[6]:PropNatGasTDV		= {	if (LocalRef( RunResultsS[6]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - S-InsLtg"		Proj:RunResultsS[6]:PropOtherTDV			= {	if (LocalRef( RunResultsS[6]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - S-InsLtg"		Proj:RunResultsS[6]:ProposedTDV[1]			= {	LocalRef( RunResultsS[6]:PropElecTDV[1] ) + LocalRef( RunResultsS[6]:PropNatGasTDV ) + LocalRef( RunResultsS[6]:PropOtherTDV )   }
	"Calculate Elec Demand  - S-IndLtg"		Proj:RunResultsS[6]:PropElecDemand[1]		= {	if (LocalRef( RunResultsS[6]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Lit" ) / 3.412  endif  }

  ; Appliances & Cooking
	"Calculate TDV - Elec   - S-AppCkg"		Proj:RunResultsS[7]:PropElecTDV[1]			= {	if (LocalRef( RunResultsS[7]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - S-AppCkg"		Proj:RunResultsS[7]:PropNatGasTDV		= {	if (LocalRef( RunResultsS[7]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - S-AppCkg"		Proj:RunResultsS[7]:PropOtherTDV			= {	if (LocalRef( RunResultsS[7]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - S-AppCkg"		Proj:RunResultsS[7]:ProposedTDV[1]			= {	LocalRef( RunResultsS[7]:PropElecTDV[1] ) + LocalRef( RunResultsS[7]:PropNatGasTDV ) + LocalRef( RunResultsS[7]:PropOtherTDV )   }
	"Calculate Elec Demand  - S-AppCkg"		Proj:RunResultsS[7]:PropElecDemand[1]		= {	if (LocalRef( RunResultsS[7]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / 3.412  endif  }

  ; Plug Loads
	"Calculate TDV - Elec   - S-Plugs"		Proj:RunResultsS[8]:PropElecTDV[1]			= {	if (LocalRef( RunResultsS[8]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - S-Plugs"		Proj:RunResultsS[8]:PropNatGasTDV		= {	if (LocalRef( RunResultsS[8]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - S-Plugs"		Proj:RunResultsS[8]:PropOtherTDV			= {	if (LocalRef( RunResultsS[8]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - S-Plugs"		Proj:RunResultsS[8]:ProposedTDV[1]			= {	LocalRef( RunResultsS[8]:PropElecTDV[1] ) + LocalRef( RunResultsS[8]:PropNatGasTDV ) + LocalRef( RunResultsS[8]:PropOtherTDV )   }
	"Calculate Elec Demand  - S-Plugs"		Proj:RunResultsS[8]:PropElecDemand[1]		= {	if (LocalRef( RunResultsS[8]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Rcp" ) / 3.412  endif  }

  ; Exterior
	"Calculate TDV - Elec   - S-Ext"			Proj:RunResultsS[9]:PropElecTDV[1]			= {	if (LocalRef( RunResultsS[9]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - S-Ext"			Proj:RunResultsS[9]:PropNatGasTDV		= {	if (LocalRef( RunResultsS[9]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - S-Ext"			Proj:RunResultsS[9]:PropOtherTDV			= {	if (LocalRef( RunResultsS[9]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - S-Ext"			Proj:RunResultsS[9]:ProposedTDV[1]			= {	LocalRef( RunResultsS[9]:PropElecTDV[1] ) + LocalRef( RunResultsS[9]:PropNatGasTDV ) + LocalRef( RunResultsS[9]:PropOtherTDV )   }
	"Calculate Elec Demand  - S-Ext"			Proj:RunResultsS[9]:PropElecDemand[1]		= {	if (LocalRef( RunResultsS[9]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Ext" ) / 3.412  endif  }

  ; PV
	"Calculate TDV - Elec   - S-PV"			Proj:RunResultsS[13]:PropElecTDV[1]		= {	if (LocalRef( RunResultsS[13]:PropElecEnergy[1]		) > -0.0001) then  0
      else if (CommunitySolarProjID > 0 .AND. IfValidAnd( CmntySlr_TDV < 0 )) then  CmntySlr_TDV * PVWDCSizeMultiplier[1] / CondFloorArea
		else if (IfValidAnd( NetEnergyMeteringTDVAdj != 0) .OR. IfValidAnd( HrlyNEMTableCol > 0 ))
      then  if (LocalRef( RunResultsS[14]:PropElecEnergy[1] ) = 0)
            then  int( (100 * ApplyHourlyResultMultipliers_NEM( "PVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor          ) / CondFloorArea) + 0.5) / 100
            else  int( (100 * ApplyHourlyResultMultipliers_NEM( "PVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, 1, "BT" ) / CondFloorArea) + 0.5) / 100  endif
      else        int( (100 * ApplyHourlyResultMultipliers(     "PVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV" ) / CondFloorArea) + 0.5) / 100  endif endif endif  }
	"Calculate TDV - NatGas - S-PV"			Proj:RunResultsS[13]:PropNatGasTDV		= {	0  }
	"Calculate TDV - Other  - S-PV"			Proj:RunResultsS[13]:PropOtherTDV		= {	0  }
	"Calculate TDV - TOTAL  - S-PV"			Proj:RunResultsS[13]:ProposedTDV[1]		= {	LocalRef( RunResultsS[13]:PropElecTDV[1] )   }
	"Calculate Elec Demand  - S-PV"			Proj:RunResultsS[13]:PropElecDemand[1]	= {	if (LocalRef( RunResultsS[13]:PropElecEnergy[1]		) > -0.0001) then  0
                                                                                       else if (CommunitySolarProjID > 0 .AND. IfValidAnd( CmntySlr_ElecDemand < 0 )) then  CmntySlr_ElecDemand * PVWDCSizeMultiplier[1]
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec", "PV" ) / 3.412  endif endif  }

  ; Battery
	"Calculate TDV - Elec   - S-Battery"	Proj:RunResultsS[14]:PropElecTDV[1]		= {	if (LocalRef( RunResultsS[14]:PropElecEnergy[1]		) < 0.0001) then  0
		else if (IfValidAnd( NetEnergyMeteringTDVAdj != 0) .OR. IfValidAnd( HrlyNEMTableCol > 0 ))
      then  if (LocalRef( RunResultsS[13]:PropElecEnergy[1] ) = 0)
            then  int( (100 * ApplyHourlyResultMultipliers_NEM( "BTTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "BT", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor          ) / CondFloorArea) + 0.5) / 100
            else  int( (100 * ApplyHourlyResultMultipliers_NEM( "BTTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "BT", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, 1, "PV" ) / CondFloorArea) + 0.5) / 100  endif
      else        int( (100 * ApplyHourlyResultMultipliers(     "BTTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "BT" ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate TDV - NatGas - S-Battery"	Proj:RunResultsS[14]:PropNatGasTDV		= {	0  }
	"Calculate TDV - Other  - S-Battery"	Proj:RunResultsS[14]:PropOtherTDV		= {	0  }
	"Calculate TDV - TOTAL  - S-Battery"	Proj:RunResultsS[14]:ProposedTDV[1]		= {	LocalRef( RunResultsS[14]:PropElecTDV[1] )   }
	"Calculate Elec Demand  - S-Battery"	Proj:RunResultsS[14]:PropElecDemand[1]	= {	if (LocalRef( RunResultsS[14]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec", "BT" ) / 3.412  endif  }

  ; Compliance Total
	"Calculate TDV - Elec   - S-Comp Ttl"	Proj:RunResultsS[11]:PropElecTDV[1]		= {	RunResultsS[1]:PropElecTDV[1]    + RunResultsS[2]:PropElecTDV[1]    + RunResultsS[3]:PropElecTDV[1]    + RunResultsS[4]:PropElecTDV[1]    + RunResultsS[5]:PropElecTDV[1]     }
	"Calculate TDV - NatGas - S-Comp Ttl"	Proj:RunResultsS[11]:PropNatGasTDV		= {	RunResultsS[1]:PropNatGasTDV  + RunResultsS[2]:PropNatGasTDV  + RunResultsS[3]:PropNatGasTDV  + RunResultsS[4]:PropNatGasTDV  + RunResultsS[5]:PropNatGasTDV   }
	"Calculate TDV - Other  - S-Comp Ttl"	Proj:RunResultsS[11]:PropOtherTDV		= {	RunResultsS[1]:PropOtherTDV   + RunResultsS[2]:PropOtherTDV   + RunResultsS[3]:PropOtherTDV   + RunResultsS[4]:PropOtherTDV   + RunResultsS[5]:PropOtherTDV    }
	"Calculate TDV - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:ProposedTDV[1]		= {	RunResultsS[1]:ProposedTDV[1]    + RunResultsS[2]:ProposedTDV[1]    + RunResultsS[3]:ProposedTDV[1]    + RunResultsS[4]:ProposedTDV[1]    + RunResultsS[5]:ProposedTDV[1]     }
	"Calculate Elec Demand  - S-Comp Ttl"	Proj:RunResultsS[11]:PropElecDemand[1]	= {	RunResultsS[1]:PropElecDemand[1] + RunResultsS[2]:PropElecDemand[1] + RunResultsS[3]:PropElecDemand[1] + RunResultsS[4]:PropElecDemand[1] + RunResultsS[5]:PropElecDemand[1]  }
;   ; SAC 10/6/16 - 2019 updates
;	"Add in PV TDV - Elec   - S-Comp Ttl"	Proj:RunResultsS[11]:PropElecTDV[1]	   = {	if (EnergyCodeYearNum < 2019) then  UNCHANGED
;                                                                                       else  RunResultsS[11]:PropElecTDV[1]    + RunResultsS[13]:PropElecTDV[1]    + RunResultsS[14]:PropElecTDV[1]     endif   }
;	"Add in PV TDV - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:ProposedTDV[1]  	= {	if (EnergyCodeYearNum < 2019) then  UNCHANGED
;                                                                                       else  RunResultsS[11]:ProposedTDV[1]    + RunResultsS[13]:ProposedTDV[1]    + RunResultsS[14]:ProposedTDV[1]     endif   }
;	"Add in PV Elec Demand  - S-Comp Ttl"	Proj:RunResultsS[11]:PropElecDemand[1]	= {	if (EnergyCodeYearNum < 2019) then  UNCHANGED
;                                                                                       else  RunResultsS[11]:PropElecDemand[1] + RunResultsS[13]:PropElecDemand[1] + RunResultsS[14]:PropElecDemand[1]  endif   }

  ; Total
	"Calculate TDV - Elec   - S-Total"		Proj:RunResultsS[10]:PropElecTDV[1]			= {	RunResultsS[11]:PropElecTDV[1]    + RunResultsS[6]:PropElecTDV[1]    + RunResultsS[7]:PropElecTDV[1]    + RunResultsS[8]:PropElecTDV[1]    + RunResultsS[9]:PropElecTDV[1]     }
	"Calculate TDV - NatGas - S-Total"		Proj:RunResultsS[10]:PropNatGasTDV		= {	RunResultsS[11]:PropNatGasTDV  + RunResultsS[6]:PropNatGasTDV  + RunResultsS[7]:PropNatGasTDV  + RunResultsS[8]:PropNatGasTDV  + RunResultsS[9]:PropNatGasTDV   }
	"Calculate TDV - Other  - S-Total"		Proj:RunResultsS[10]:PropOtherTDV		= {	RunResultsS[11]:PropOtherTDV   + RunResultsS[6]:PropOtherTDV   + RunResultsS[7]:PropOtherTDV   + RunResultsS[8]:PropOtherTDV   + RunResultsS[9]:PropOtherTDV    }
	"Calculate TDV - TOTAL  - S-Total"		Proj:RunResultsS[10]:ProposedTDV[1]			= {	RunResultsS[11]:ProposedTDV[1]    + RunResultsS[6]:ProposedTDV[1]    + RunResultsS[7]:ProposedTDV[1]    + RunResultsS[8]:ProposedTDV[1]    + RunResultsS[9]:ProposedTDV[1]     }
	"Calculate Elec Demand  - S-Total"		Proj:RunResultsS[10]:PropElecDemand[1]		= {	RunResultsS[11]:PropElecDemand[1] + RunResultsS[6]:PropElecDemand[1] + RunResultsS[7]:PropElecDemand[1] + RunResultsS[8]:PropElecDemand[1] + RunResultsS[9]:PropElecDemand[1]  }
   ; SAC 4/28/17 - shifted PV & Batt from CompTot to Tot for 2019
   ; SAC 4/28/17 - add in only Battery to Total for 2016
	"Add in PV TDV - Elec   - S-Total"	   Proj:RunResultsS[10]:PropElecTDV[1]	   = {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                       else if (EnergyCodeYearNum < 2019) 
                                                                                       then  RunResultsS[10]:PropElecTDV[1]    + RunResultsS[14]:PropElecTDV[1]
                                                                                       else  RunResultsS[10]:PropElecTDV[1]    + RunResultsS[13]:PropElecTDV[1]    + RunResultsS[14]:PropElecTDV[1]     endif endif   }
	"Add in PV TDV - TOTAL  - S-Total"	   Proj:RunResultsS[10]:ProposedTDV[1]  	= {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                       else if (EnergyCodeYearNum < 2019) 
                                                                                       then  RunResultsS[10]:ProposedTDV[1]    + RunResultsS[14]:ProposedTDV[1]
                                                                                       else  RunResultsS[10]:ProposedTDV[1]    + RunResultsS[13]:ProposedTDV[1]    + RunResultsS[14]:ProposedTDV[1]     endif endif   }
	"Add in PV Elec Demand  - S-Total"	   Proj:RunResultsS[10]:PropElecDemand[1]	= {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                       else if (EnergyCodeYearNum < 2019) 
                                                                                       then  RunResultsS[10]:PropElecDemand[1] + RunResultsS[14]:PropElecDemand[1]
                                                                                       else  RunResultsS[10]:PropElecDemand[1] + RunResultsS[13]:PropElecDemand[1] + RunResultsS[14]:PropElecDemand[1]  endif endif   }
END

;*************************************************************************  - SAC 6/25/13
RULELIST "CARes_ProposedTDVResults_W" 1 0 0 1
;*************************************************************************
; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
         ; SAC 8/24/19 - replaced 1/3.413 & 0.01 TDV table multipliers with Proj:TDVSecMult_Elec & TDVSecMult_Fuel to accommodate 2022+ switch to native (E3) TDV table units
         ; SAC 8/26/19 - added primary table multipliers (of 1.0) to all ApplyHourlyResultMult* function calls (to accommodate 2022+ TDV table unit switch)
  ; Space Heating (& heating fan)
	"Calculate TDV - Elec   - W-SpcHt"		Proj:RunResultsW[1]:PropElecTDV[1]			= {	if (LocalRef( RunResultsW[1]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - W-SpcHt"		Proj:RunResultsW[1]:PropNatGasTDV		= {	if (LocalRef( RunResultsW[1]:PropNatGasEnergy[1]	) < 0.0001) then  0                                                                                                     
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - W-SpcHt"		Proj:RunResultsW[1]:PropOtherTDV			= {	if (LocalRef( RunResultsW[1]:PropOtherEnergy[1]		) < 0.0001) then  0                                                                                                     
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - W-SpcHt"		Proj:RunResultsW[1]:ProposedTDV[1]			= {	LocalRef( RunResultsW[1]:PropElecTDV[1] ) + LocalRef( RunResultsW[1]:PropNatGasTDV ) + LocalRef( RunResultsW[1]:PropOtherTDV )   }
  ; SAC 8/23/14 - added rules to set elec demand
	"Calculate Elec Demand  - W-SpcHt"		Proj:RunResultsW[1]:PropElecDemand[1]		= {	if (LocalRef( RunResultsW[1]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / 3.412  endif  }

  ; Space Cooling (& cooling fan)
	"Calculate TDV - Elec   - W-SpcCl"		Proj:RunResultsW[2]:PropElecTDV[1]			= {	if (LocalRef( RunResultsW[2]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - W-SpcCl"		Proj:RunResultsW[2]:PropNatGasTDV		= {	if (LocalRef( RunResultsW[2]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - W-SpcCl"		Proj:RunResultsW[2]:PropOtherTDV			= {	if (LocalRef( RunResultsW[2]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - W-SpcCl"		Proj:RunResultsW[2]:ProposedTDV[1]			= {	LocalRef( RunResultsW[2]:PropElecTDV[1] ) + LocalRef( RunResultsW[2]:PropNatGasTDV ) + LocalRef( RunResultsW[2]:PropOtherTDV )   }
	"Calculate Elec Demand  - W-SpcCl"		Proj:RunResultsW[2]:PropElecDemand[1]		= {	if (LocalRef( RunResultsW[2]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Clg", "FanC" ) / 3.412  endif  }

  ; IAQ Ventilation Fans
	"Calculate TDV - Elec   - W-IAQVent"	Proj:RunResultsW[3]:PropElecTDV[1]			= {	if (LocalRef( RunResultsW[3]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "IAQVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "FanV" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - W-IAQVent"	Proj:RunResultsW[3]:PropNatGasTDV		= {	0  }
	"Calculate TDV - Other  - W-IAQVent"	Proj:RunResultsW[3]:PropOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - W-IAQVent"	Proj:RunResultsW[3]:ProposedTDV[1]			= {	LocalRef( RunResultsW[3]:PropElecTDV[1] )   }
	"Calculate Elec Demand  - W-IAQVent"	Proj:RunResultsW[3]:PropElecDemand[1]		= {	if (LocalRef( RunResultsW[3]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "FanV" ) / 3.412  endif  }		; SAC 7/14/16 - fixed bug here - was same as Htg demand!

; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
  ; Other HVAC (aux & misc fans)
	"Calculate TDV - Elec   - W-OthrHVAC"	Proj:RunResultsW[4]:PropElecTDV[1]		= {	if (LocalRef( RunResultsW[4]:PropElecEnergy[1] ) < 0.0001 .AND. OthrHVAC_SpcHtFrac == 0) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "OHVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "User1" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - W-OthrHVAC"	Proj:RunResultsW[4]:PropNatGasTDV		= {	0  }
	"Calculate TDV - Other  - W-OthrHVAC"	Proj:RunResultsW[4]:PropOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - W-OthrHVAC"	Proj:RunResultsW[4]:ProposedTDV[1]		= {	LocalRef( RunResultsW[4]:PropElecTDV[1] )   }
	"Calculate Elec Demand  - W-OthrHVAC"	Proj:RunResultsW[4]:PropElecDemand[1]	= {	if (LocalRef( RunResultsW[4]:PropElecEnergy[1] ) < 0.0001 .AND. OthrHVAC_SpcHtFrac == 0) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "User1" ) / 3.412  endif  }

; SAC 1/27/19 - REDISTRIBUTE OthrHVAC W-Prop TDV across SpcHt & SpcCl by fuel based on ratio of total TDV (across all fuels) (tic #1053)
   "Set OthrHVAC_SpcHtFrac - W-PropTDV"      Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResultsW[4]:ProposedTDV[1] != 0 )==0) then  0
                                                                           else if (IfValidAnd( RunResultsW[1]:ProposedTDV[1] == 0 ) .AND.
                                                                                    IfValidAnd( RunResultsW[2]:ProposedTDV[1] == 0 )) then  0.5
                                                                           else   ValidOr( RunResultsW[1]:ProposedTDV[1], 0 ) / 
                                                                                 (ValidOr( RunResultsW[1]:ProposedTDV[1], 0 ) + ValidOr( RunResultsW[2]:ProposedTDV[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Elec   - W-SpcHt"		Proj:RunResultsW[1]:PropElecTDV[1]	   = {   if (IfValidAnd( RunResultsW[4]:PropElecTDV[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsW[1]:PropElecTDV[1] + (RunResultsW[4]:PropElecTDV[1]     * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - NatGas - W-SpcHt"		Proj:RunResultsW[1]:PropNatGasTDV[1]	= {   if (IfValidAnd( RunResultsW[4]:PropNatGasTDV[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsW[1]:PropNatGasTDV[1] + (RunResultsW[4]:PropNatGasTDV[1] * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - Other  - W-SpcHt"		Proj:RunResultsW[1]:PropOtherTDV[1]	   = {   if (IfValidAnd( RunResultsW[4]:PropOtherTDV[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsW[1]:PropOtherTDV[1] + (RunResultsW[4]:PropOtherTDV[1]   * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - TOTAL  - W-SpcHt"		Proj:RunResultsW[1]:ProposedTDV[1]	   = {	LocalRef( RunResultsW[1]:PropElecTDV[1] ) + LocalRef( RunResultsW[1]:PropNatGasTDV[1] ) + LocalRef( RunResultsW[1]:PropOtherTDV[1] )   }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Elec   - W-SpcCl"		Proj:RunResultsW[2]:PropElecTDV[1]	   = {   if (IfValidAnd( RunResultsW[4]:PropElecTDV[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsW[2]:PropElecTDV[1] + (RunResultsW[4]:PropElecTDV[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - NatGas - W-SpcCl"		Proj:RunResultsW[2]:PropNatGasTDV[1]	= {   if (IfValidAnd( RunResultsW[4]:PropNatGasTDV[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsW[2]:PropNatGasTDV[1] + (RunResultsW[4]:PropNatGasTDV[1] * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - Other  - W-SpcCl"		Proj:RunResultsW[2]:PropOtherTDV[1]	   = {   if (IfValidAnd( RunResultsW[4]:PropOtherTDV[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsW[2]:PropOtherTDV[1] + (RunResultsW[4]:PropOtherTDV[1]   * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - TOTAL  - W-SpcCl"		Proj:RunResultsW[2]:ProposedTDV[1]	   = {	LocalRef( RunResultsW[2]:PropElecTDV[1] ) + LocalRef( RunResultsW[2]:PropNatGasTDV[1] ) + LocalRef( RunResultsW[2]:PropOtherTDV[1] )   }
   ; SAC 1/27/19 - REDISTRIBUTE OthrHVAC Prop Demand across SpcHt & SpcCl by fuel based on ratio of total Demand (tic #1053)
   "Set OthrHVAC_SpcHtFrac - W-Demand"       Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResultsW[4]:PropElecDemand[1] != 0 )==0) then  0
                                                                           else if (IfValidAnd( RunResultsW[1]:PropElecDemand[1] == 0 ) .AND.
                                                                                    IfValidAnd( RunResultsW[2]:PropElecDemand[1] == 0 )) then  0.5
                                                                           else   ValidOr( RunResultsW[1]:PropElecDemand[1], 0 ) / 
                                                                                 (ValidOr( RunResultsW[1]:PropElecDemand[1], 0 ) + ValidOr( RunResultsW[2]:PropElecDemand[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Demand - W-SpcHt"		Proj:RunResultsW[1]:PropElecDemand[1]  = {   if (IfValidAnd( RunResultsW[4]:PropElecDemand[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsW[1]:PropElecDemand[1] + (RunResultsW[4]:PropElecDemand[1]     * OthrHVAC_SpcHtFrac)  endif  }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Demand - W-SpcCl"		Proj:RunResultsW[2]:PropElecDemand[1]  = {   if (IfValidAnd( RunResultsW[4]:PropElecDemand[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsW[2]:PropElecDemand[1] + (RunResultsW[4]:PropElecDemand[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
  ; Other HVAC (aux & misc fans)
	"ZERO-OUT         - Elec   - W-OthrHVAC"	Proj:RunResultsW[4]:PropElecTDV[1]	   = {	0  }
	"ZERO-OUT         - NatGas - W-OthrHVAC"	Proj:RunResultsW[4]:PropNatGasTDV[1]	= {	0  }
	"ZERO-OUT         - Other  - W-OthrHVAC"	Proj:RunResultsW[4]:PropOtherTDV[1]	   = {	0  }
	"ZERO-OUT         - TOTAL  - W-OthrHVAC"	Proj:RunResultsW[4]:ProposedTDV[1]	   = {	0  }
	"ZERO-OUT         - Demand - W-OthrHVAC"	Proj:RunResultsW[4]:PropElecDemand[1]  = {	0  }
   ; SAC 1/27/19 - end of - redistribution of OthrHVAC PropTDV

  ; Water Heating
	"Calculate TDV - Elec   - W-WtrHt"		Proj:RunResultsW[5]:PropElecTDV[1]			= {	if (LocalRef( RunResultsW[5]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else if (CSEinclDHWMFL_EU)
			 			  																							then  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / CondFloorArea) + 0.5) / 100
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate TDV - NatGas - W-WtrHt"		Proj:RunResultsW[5]:PropNatGasTDV		= {	if (LocalRef( RunResultsW[5]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - W-WtrHt"		Proj:RunResultsW[5]:PropOtherTDV			= {	if (LocalRef( RunResultsW[5]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - W-WtrHt"		Proj:RunResultsW[5]:ProposedTDV[1]			= {	LocalRef( RunResultsW[5]:PropElecTDV[1] ) + LocalRef( RunResultsW[5]:PropNatGasTDV ) + LocalRef( RunResultsW[5]:PropOtherTDV )   }
	"Calculate Elec Demand  - W-WtrHt"		Proj:RunResultsW[5]:PropElecDemand[1]		= {	if (LocalRef( RunResultsW[5]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else if (CSEinclDHWMFL_EU)
			 			  																							then  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / 3.412
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / 3.412  endif endif  }

  ; Inside Lighting
	"Calculate TDV - Elec   - W-InsLtg"		Proj:RunResultsW[6]:PropElecTDV[1]			= {	if (LocalRef( RunResultsW[6]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - W-InsLtg"		Proj:RunResultsW[6]:PropNatGasTDV		= {	if (LocalRef( RunResultsW[6]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - W-InsLtg"		Proj:RunResultsW[6]:PropOtherTDV			= {	if (LocalRef( RunResultsW[6]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - W-InsLtg"		Proj:RunResultsW[6]:ProposedTDV[1]			= {	LocalRef( RunResultsW[6]:PropElecTDV[1] ) + LocalRef( RunResultsW[6]:PropNatGasTDV ) + LocalRef( RunResultsW[6]:PropOtherTDV )   }
	"Calculate Elec Demand  - W-InsLtg"		Proj:RunResultsW[6]:PropElecDemand[1]		= {	if (LocalRef( RunResultsW[6]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Lit" ) / 3.412  endif  }

  ; Appliances & Cooking
	"Calculate TDV - Elec   - W-AppCkg"		Proj:RunResultsW[7]:PropElecTDV[1]			= {	if (LocalRef( RunResultsW[7]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - W-AppCkg"		Proj:RunResultsW[7]:PropNatGasTDV		= {	if (LocalRef( RunResultsW[7]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - W-AppCkg"		Proj:RunResultsW[7]:PropOtherTDV			= {	if (LocalRef( RunResultsW[7]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - W-AppCkg"		Proj:RunResultsW[7]:ProposedTDV[1]			= {	LocalRef( RunResultsW[7]:PropElecTDV[1] ) + LocalRef( RunResultsW[7]:PropNatGasTDV ) + LocalRef( RunResultsW[7]:PropOtherTDV )   }
	"Calculate Elec Demand  - W-AppCkg"		Proj:RunResultsW[7]:PropElecDemand[1]		= {	if (LocalRef( RunResultsW[7]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / 3.412  endif  }

  ; Plug Loads
	"Calculate TDV - Elec   - W-Plugs"		Proj:RunResultsW[8]:PropElecTDV[1]			= {	if (LocalRef( RunResultsW[8]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - W-Plugs"		Proj:RunResultsW[8]:PropNatGasTDV		= {	if (LocalRef( RunResultsW[8]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - W-Plugs"		Proj:RunResultsW[8]:PropOtherTDV			= {	if (LocalRef( RunResultsW[8]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - W-Plugs"		Proj:RunResultsW[8]:ProposedTDV[1]			= {	LocalRef( RunResultsW[8]:PropElecTDV[1] ) + LocalRef( RunResultsW[8]:PropNatGasTDV ) + LocalRef( RunResultsW[8]:PropOtherTDV )   }
	"Calculate Elec Demand  - W-Plugs"		Proj:RunResultsW[8]:PropElecDemand[1]		= {	if (LocalRef( RunResultsW[8]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Rcp" ) / 3.412  endif  }

  ; Exterior
	"Calculate TDV - Elec   - W-Ext"			Proj:RunResultsW[9]:PropElecTDV[1]			= {	if (LocalRef( RunResultsW[9]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - W-Ext"			Proj:RunResultsW[9]:PropNatGasTDV		= {	if (LocalRef( RunResultsW[9]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - W-Ext"			Proj:RunResultsW[9]:PropOtherTDV			= {	if (LocalRef( RunResultsW[9]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - W-Ext"			Proj:RunResultsW[9]:ProposedTDV[1]			= {	LocalRef( RunResultsW[9]:PropElecTDV[1] ) + LocalRef( RunResultsW[9]:PropNatGasTDV ) + LocalRef( RunResultsW[9]:PropOtherTDV )   }
	"Calculate Elec Demand  - W-Ext"			Proj:RunResultsW[9]:PropElecDemand[1]		= {	if (LocalRef( RunResultsW[9]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Ext" ) / 3.412  endif  }

  ; PV
	"Calculate TDV - Elec   - W-PV"			Proj:RunResultsW[13]:PropElecTDV[1]		= {	if (LocalRef( RunResultsW[13]:PropElecEnergy[1]		) > -0.0001) then  0
      else if (CommunitySolarProjID > 0 .AND. IfValidAnd( CmntySlr_TDV < 0 )) then  CmntySlr_TDV * PVWDCSizeMultiplier[1] / CondFloorArea
		else if (IfValidAnd( NetEnergyMeteringTDVAdj != 0) .OR. IfValidAnd( HrlyNEMTableCol > 0 ))
      then  if (LocalRef( RunResultsW[14]:PropElecEnergy[1] ) = 0)
            then  int( (100 * ApplyHourlyResultMultipliers_NEM( "PVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor          ) / CondFloorArea) + 0.5) / 100
            else  int( (100 * ApplyHourlyResultMultipliers_NEM( "PVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, 1, "BT" ) / CondFloorArea) + 0.5) / 100  endif
      else        int( (100 * ApplyHourlyResultMultipliers(     "PVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV" ) / CondFloorArea) + 0.5) / 100  endif endif endif  }
	"Calculate TDV - NatGas - W-PV"			Proj:RunResultsW[13]:PropNatGasTDV		= {	0  }
	"Calculate TDV - Other  - W-PV"			Proj:RunResultsW[13]:PropOtherTDV		= {	0  }
	"Calculate TDV - TOTAL  - W-PV"			Proj:RunResultsW[13]:ProposedTDV[1]		= {	LocalRef( RunResultsW[13]:PropElecTDV[1] )   }
	"Calculate Elec Demand  - W-PV"			Proj:RunResultsW[13]:PropElecDemand[1]	= {	if (LocalRef( RunResultsW[13]:PropElecEnergy[1]		) > -0.0001) then  0
                                                                                       else if (CommunitySolarProjID > 0 .AND. IfValidAnd( CmntySlr_ElecDemand < 0 )) then  CmntySlr_ElecDemand * PVWDCSizeMultiplier[1]
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec", "PV" ) / 3.412  endif endif  }

  ; Battery
	"Calculate TDV - Elec   - W-Battery"	Proj:RunResultsW[14]:PropElecTDV[1]		= {	if (LocalRef( RunResultsW[14]:PropElecEnergy[1]		) < 0.0001) then  0
		else if (IfValidAnd( NetEnergyMeteringTDVAdj != 0) .OR. IfValidAnd( HrlyNEMTableCol > 0 ))
      then  if (LocalRef( RunResultsW[13]:PropElecEnergy[1] ) = 0)
            then  int( (100 * ApplyHourlyResultMultipliers_NEM( "BTTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "BT", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor          ) / CondFloorArea) + 0.5) / 100
            else  int( (100 * ApplyHourlyResultMultipliers_NEM( "BTTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "BT", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, 1, "PV" ) / CondFloorArea) + 0.5) / 100  endif
      else        int( (100 * ApplyHourlyResultMultipliers(     "BTTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "BT" ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate TDV - NatGas - W-Battery"	Proj:RunResultsW[14]:PropNatGasTDV		= {	0  }
	"Calculate TDV - Other  - W-Battery"	Proj:RunResultsW[14]:PropOtherTDV		= {	0  }
	"Calculate TDV - TOTAL  - W-Battery"	Proj:RunResultsW[14]:ProposedTDV[1]		= {	LocalRef( RunResultsW[14]:PropElecTDV[1] )   }
	"Calculate Elec Demand  - W-Battery"	Proj:RunResultsW[14]:PropElecDemand[1]	= {	if (LocalRef( RunResultsW[14]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec", "BT" ) / 3.412  endif  }

  ; Compliance Total
	"Calculate TDV - Elec   - W-Comp Ttl"	Proj:RunResultsW[11]:PropElecTDV[1]			= {	RunResultsW[1]:PropElecTDV[1]    + RunResultsW[2]:PropElecTDV[1]    + RunResultsW[3]:PropElecTDV[1]    + RunResultsW[4]:PropElecTDV[1]    + RunResultsW[5]:PropElecTDV[1]     }
	"Calculate TDV - NatGas - W-Comp Ttl"	Proj:RunResultsW[11]:PropNatGasTDV		= {	RunResultsW[1]:PropNatGasTDV  + RunResultsW[2]:PropNatGasTDV  + RunResultsW[3]:PropNatGasTDV  + RunResultsW[4]:PropNatGasTDV  + RunResultsW[5]:PropNatGasTDV   }
	"Calculate TDV - Other  - W-Comp Ttl"	Proj:RunResultsW[11]:PropOtherTDV		= {	RunResultsW[1]:PropOtherTDV   + RunResultsW[2]:PropOtherTDV   + RunResultsW[3]:PropOtherTDV   + RunResultsW[4]:PropOtherTDV   + RunResultsW[5]:PropOtherTDV    }
	"Calculate TDV - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:ProposedTDV[1]			= {	RunResultsW[1]:ProposedTDV[1]    + RunResultsW[2]:ProposedTDV[1]    + RunResultsW[3]:ProposedTDV[1]    + RunResultsW[4]:ProposedTDV[1]    + RunResultsW[5]:ProposedTDV[1]     }
	"Calculate Elec Demand  - W-Comp Ttl"	Proj:RunResultsW[11]:PropElecDemand[1]		= {	RunResultsW[1]:PropElecDemand[1] + RunResultsW[2]:PropElecDemand[1] + RunResultsW[3]:PropElecDemand[1] + RunResultsW[4]:PropElecDemand[1] + RunResultsW[5]:PropElecDemand[1]  }
;   ; SAC 10/6/16 - 2019 updates
;	"Add in PV TDV - Elec   - W-Comp Ttl"	Proj:RunResultsW[11]:PropElecTDV[1]	   = {	if (EnergyCodeYearNum < 2019) then  UNCHANGED
;                                                                                       else  RunResultsW[11]:PropElecTDV[1]    + RunResultsW[13]:PropElecTDV[1]    + RunResultsW[14]:PropElecTDV[1]     endif   }
;	"Add in PV TDV - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:ProposedTDV[1]  	= {	if (EnergyCodeYearNum < 2019) then  UNCHANGED
;                                                                                       else  RunResultsW[11]:ProposedTDV[1]    + RunResultsW[13]:ProposedTDV[1]    + RunResultsW[14]:ProposedTDV[1]     endif   }
;	"Add in PV Elec Demand  - W-Comp Ttl"	Proj:RunResultsW[11]:PropElecDemand[1]	= {	if (EnergyCodeYearNum < 2019) then  UNCHANGED
;                                                                                       else  RunResultsW[11]:PropElecDemand[1] + RunResultsW[13]:PropElecDemand[1] + RunResultsW[14]:PropElecDemand[1]  endif   }

  ; Total
	"Calculate TDV - Elec   - W-Total"		Proj:RunResultsW[10]:PropElecTDV[1]			= {	RunResultsW[11]:PropElecTDV[1]    + RunResultsW[6]:PropElecTDV[1]    + RunResultsW[7]:PropElecTDV[1]    + RunResultsW[8]:PropElecTDV[1]    + RunResultsW[9]:PropElecTDV[1]     }
	"Calculate TDV - NatGas - W-Total"		Proj:RunResultsW[10]:PropNatGasTDV		= {	RunResultsW[11]:PropNatGasTDV  + RunResultsW[6]:PropNatGasTDV  + RunResultsW[7]:PropNatGasTDV  + RunResultsW[8]:PropNatGasTDV  + RunResultsW[9]:PropNatGasTDV   }
	"Calculate TDV - Other  - W-Total"		Proj:RunResultsW[10]:PropOtherTDV		= {	RunResultsW[11]:PropOtherTDV   + RunResultsW[6]:PropOtherTDV   + RunResultsW[7]:PropOtherTDV   + RunResultsW[8]:PropOtherTDV   + RunResultsW[9]:PropOtherTDV    }
	"Calculate TDV - TOTAL  - W-Total"		Proj:RunResultsW[10]:ProposedTDV[1]			= {	RunResultsW[11]:ProposedTDV[1]    + RunResultsW[6]:ProposedTDV[1]    + RunResultsW[7]:ProposedTDV[1]    + RunResultsW[8]:ProposedTDV[1]    + RunResultsW[9]:ProposedTDV[1]     }
	"Calculate Elec Demand  - W-Total"		Proj:RunResultsW[10]:PropElecDemand[1]		= {	RunResultsW[11]:PropElecDemand[1] + RunResultsW[6]:PropElecDemand[1] + RunResultsW[7]:PropElecDemand[1] + RunResultsW[8]:PropElecDemand[1] + RunResultsW[9]:PropElecDemand[1]  }
   ; SAC 4/28/17 - shifted PV & Batt from CompTot to Tot for 2019
   ; SAC 4/28/17 - add in only Battery to Total for 2016
	"Add in PV TDV - Elec   - W-Total"	   Proj:RunResultsW[10]:PropElecTDV[1]	   = {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                       else if (EnergyCodeYearNum < 2019) 
                                                                                       then  RunResultsW[10]:PropElecTDV[1]    + RunResultsW[14]:PropElecTDV[1]
                                                                                       else  RunResultsW[10]:PropElecTDV[1]    + RunResultsW[13]:PropElecTDV[1]    + RunResultsW[14]:PropElecTDV[1]     endif endif   }
	"Add in PV TDV - TOTAL  - W-Total"	   Proj:RunResultsW[10]:ProposedTDV[1]  	= {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                       else if (EnergyCodeYearNum < 2019) 
                                                                                       then  RunResultsW[10]:ProposedTDV[1]    + RunResultsW[14]:ProposedTDV[1]
                                                                                       else  RunResultsW[10]:ProposedTDV[1]    + RunResultsW[13]:ProposedTDV[1]    + RunResultsW[14]:ProposedTDV[1]     endif endif   }
	"Add in PV Elec Demand  - W-Total"	   Proj:RunResultsW[10]:PropElecDemand[1]	= {	if (EnergyCodeYearNum < 2016) then  UNCHANGED
                                                                                       else if (EnergyCodeYearNum < 2019) 
                                                                                       then  RunResultsW[10]:PropElecDemand[1] + RunResultsW[14]:PropElecDemand[1]
                                                                                       else  RunResultsW[10]:PropElecDemand[1] + RunResultsW[13]:PropElecDemand[1] + RunResultsW[14]:PropElecDemand[1]  endif endif   }
END


;*************************************************************************
RULELIST "CARes_DRtgPropMultTDVResults" 1 0 0 1
;*************************************************************************
; SAC 3/31/16 - revised rules REMOVING application of design rating fuel adjustment multipliers to ProposedTDV (mods made elsewhere to apply inverse adjustment to DR reference TDV)
	"Calculate TDV - TOTAL  - SpcHt"			Proj:RunResults[1]:ProposedTDV[3]			= {	LocalRef( RunResults[1]:PropElecTDV[1] ) + LocalRef( RunResults[1]:PropNatGasTDV ) + LocalRef( RunResults[1]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - SpcHt"			Proj:RunResults[1]:ProposedTDV[3]			= {	LocalRef( RunResults[1]:PropElecTDV[1] ) + ((LocalRef( RunResults[1]:PropNatGasTDV ) + LocalRef( RunResults[1]:PropOtherTDV )) *
;																																													T24RClimateZoneCodeBase:HtgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))   }
	"Calculate TDV - TOTAL  - SpcCl"			Proj:RunResults[2]:ProposedTDV[3]			= {	LocalRef( RunResults[2]:PropElecTDV[1] ) + LocalRef( RunResults[2]:PropNatGasTDV ) + LocalRef( RunResults[2]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - SpcCl"			Proj:RunResults[2]:ProposedTDV[3]			= {	LocalRef( RunResults[2]:PropElecTDV[1] ) + ((LocalRef( RunResults[2]:PropNatGasTDV ) + LocalRef( RunResults[2]:PropOtherTDV )) *
;																																													T24RClimateZoneCodeBase:ClgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))   }
	"Calculate TDV - TOTAL  - IAQVent"		Proj:RunResults[3]:ProposedTDV[3]			= {	LocalRef( RunResults[3]:PropElecTDV[1] )   }
	"Calculate TDV - TOTAL  - OthrHVAC"		Proj:RunResults[4]:ProposedTDV[3]			= {	RunResults[4]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - WtrHt"			Proj:RunResults[5]:ProposedTDV[3]			= {	LocalRef( RunResults[5]:PropElecTDV[1] ) + LocalRef( RunResults[5]:PropNatGasTDV ) + LocalRef( RunResults[5]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - WtrHt"			Proj:RunResults[5]:ProposedTDV[3]			= {	LocalRef( RunResults[5]:PropElecTDV[1] ) + ((LocalRef( RunResults[5]:PropNatGasTDV ) + LocalRef( RunResults[5]:PropOtherTDV )) *
;																																													T24RClimateZoneCodeBase:DHWDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))  }
	"Calculate TDV - TOTAL  - InsLtg"		Proj:RunResults[6]:ProposedTDV[3]			= {	RunResults[6]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - AppCkg"		Proj:RunResults[7]:ProposedTDV[3]			= {	LocalRef( RunResults[7]:PropElecTDV[1] ) + LocalRef( RunResults[7]:PropNatGasTDV ) + LocalRef( RunResults[7]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - AppCkg"		Proj:RunResults[7]:ProposedTDV[3]			= {	LocalRef( RunResults[7]:PropElecTDV[1] ) + ((LocalRef( RunResults[7]:PropNatGasTDV ) + LocalRef( RunResults[7]:PropOtherTDV )) *
;																																													T24RClimateZoneCodeBase:AppDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))   }
	"Calculate TDV - TOTAL  - Plugs"			Proj:RunResults[8]:ProposedTDV[3]			= {	RunResults[8]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - Ext"			Proj:RunResults[9]:ProposedTDV[3]			= {	RunResults[9]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - PV"				Proj:RunResults[13]:ProposedTDV[3]			= {	RunResults[13]:ProposedTDV[1]   }
	"Calculate TDV - TOTAL  - Battery"		Proj:RunResults[14]:ProposedTDV[3]			= {	RunResults[14]:ProposedTDV[1]   }

	"Calculate TDV - TOTAL  - Comp Ttl"		Proj:RunResults[11]:ProposedTDV[3]			= {	RunResults[1]:ProposedTDV[3]    + RunResults[2]:ProposedTDV[3]    + RunResults[3]:ProposedTDV[3]    + RunResults[4]:ProposedTDV[3]    + RunResults[5]:ProposedTDV[3]     }
	"Calculate TDV - TOTAL  - Total"			Proj:RunResults[10]:ProposedTDV[3]			= {	RunResults[11]:ProposedTDV[3]   + RunResults[6]:ProposedTDV[3]    + RunResults[7]:ProposedTDV[3]    + RunResults[8]:ProposedTDV[3]    + RunResults[9]:ProposedTDV[3]     }
END

;*************************************************************************  - SAC 3/14/16
RULELIST "CARes_DRtgPropMultTDVResults_N" 1 0 0 1
;*************************************************************************
; SAC 3/31/16 - revised rules REMOVING application of design rating fuel adjustment multipliers to ProposedTDV (mods made elsewhere to apply inverse adjustment to DR reference TDV)
	"Calculate TDV - TOTAL  - N-SpcHt"		Proj:RunResultsN[1]:ProposedTDV[3]			= {	LocalRef( RunResultsN[1]:PropElecTDV[1] ) + LocalRef( RunResultsN[1]:PropNatGasTDV ) + LocalRef( RunResultsN[1]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - N-SpcHt"		Proj:RunResultsN[1]:ProposedTDV[3]			= {	LocalRef( RunResultsN[1]:PropElecTDV[1] ) + ((LocalRef( RunResultsN[1]:PropNatGasTDV ) + LocalRef( RunResultsN[1]:PropOtherTDV )) *
;																																													T24RClimateZoneCodeBase:HtgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))   }
	"Calculate TDV - TOTAL  - N-SpcCl"		Proj:RunResultsN[2]:ProposedTDV[3]			= {	LocalRef( RunResultsN[2]:PropElecTDV[1] ) + LocalRef( RunResultsN[2]:PropNatGasTDV ) + LocalRef( RunResultsN[2]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - N-SpcCl"		Proj:RunResultsN[2]:ProposedTDV[3]			= {	LocalRef( RunResultsN[2]:PropElecTDV[1] ) + ((LocalRef( RunResultsN[2]:PropNatGasTDV ) + LocalRef( RunResultsN[2]:PropOtherTDV )) *
;																																													T24RClimateZoneCodeBase:ClgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))   }
	"Calculate TDV - TOTAL  - N-IAQVent"	Proj:RunResultsN[3]:ProposedTDV[3]			= {	LocalRef( RunResultsN[3]:PropElecTDV[1] )   }
	"Calculate TDV - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:ProposedTDV[3]			= {	RunResultsN[4]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - N-WtrHt"		Proj:RunResultsN[5]:ProposedTDV[3]			= {	LocalRef( RunResultsN[5]:PropElecTDV[1] ) + LocalRef( RunResultsN[5]:PropNatGasTDV ) + LocalRef( RunResultsN[5]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - N-WtrHt"		Proj:RunResultsN[5]:ProposedTDV[3]			= {	LocalRef( RunResultsN[5]:PropElecTDV[1] ) + ((LocalRef( RunResultsN[5]:PropNatGasTDV ) + LocalRef( RunResultsN[5]:PropOtherTDV )) *
;																																													T24RClimateZoneCodeBase:DHWDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))  }
	"Calculate TDV - TOTAL  - N-InsLtg"		Proj:RunResultsN[6]:ProposedTDV[3]			= {	RunResultsN[6]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - N-AppCkg"		Proj:RunResultsN[7]:ProposedTDV[3]			= {	LocalRef( RunResultsN[7]:PropElecTDV[1] ) + LocalRef( RunResultsN[7]:PropNatGasTDV ) + LocalRef( RunResultsN[7]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - N-AppCkg"		Proj:RunResultsN[7]:ProposedTDV[3]			= {	LocalRef( RunResultsN[7]:PropElecTDV[1] ) + ((LocalRef( RunResultsN[7]:PropNatGasTDV ) + LocalRef( RunResultsN[7]:PropOtherTDV )) *
;																																													T24RClimateZoneCodeBase:AppDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))   }
	"Calculate TDV - TOTAL  - N-Plugs"		Proj:RunResultsN[8]:ProposedTDV[3]			= {	RunResultsN[8]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - N-Ext"			Proj:RunResultsN[9]:ProposedTDV[3]			= {	RunResultsN[9]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - N-PV"			Proj:RunResultsN[13]:ProposedTDV[3]			= {	RunResultsN[13]:ProposedTDV[1]   }
	"Calculate TDV - TOTAL  - N-Battery"	Proj:RunResultsN[14]:ProposedTDV[3]			= {	RunResultsN[14]:ProposedTDV[1]   }

	"Calculate TDV - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:ProposedTDV[3]			= {	RunResultsN[1]:ProposedTDV[3]    + RunResultsN[2]:ProposedTDV[3]    + RunResultsN[3]:ProposedTDV[3]    + RunResultsN[4]:ProposedTDV[3]    + RunResultsN[5]:ProposedTDV[3]     }
	"Calculate TDV - TOTAL  - N-Total"		Proj:RunResultsN[10]:ProposedTDV[3]			= {	RunResultsN[11]:ProposedTDV[3]    + RunResultsN[6]:ProposedTDV[3]    + RunResultsN[7]:ProposedTDV[3]    + RunResultsN[8]:ProposedTDV[3]    + RunResultsN[9]:ProposedTDV[3]     }
END

;*************************************************************************  - SAC 3/14/16
RULELIST "CARes_DRtgPropMultTDVResults_E" 1 0 0 1
;*************************************************************************
; SAC 3/31/16 - revised rules REMOVING application of design rating fuel adjustment multipliers to ProposedTDV (mods made elsewhere to apply inverse adjustment to DR reference TDV)
	"Calculate TDV - TOTAL  - E-SpcHt"		Proj:RunResultsE[1]:ProposedTDV[3]			= {	LocalRef( RunResultsE[1]:PropElecTDV[1] ) + LocalRef( RunResultsE[1]:PropNatGasTDV ) + LocalRef( RunResultsE[1]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - E-SpcHt"		Proj:RunResultsE[1]:ProposedTDV[3]			= {	LocalRef( RunResultsE[1]:PropElecTDV[1] ) + ((LocalRef( RunResultsE[1]:PropNatGasTDV ) + LocalRef( RunResultsE[1]:PropOtherTDV )) *
;																																													T24RClimateZoneCodeBase:HtgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))   }
	"Calculate TDV - TOTAL  - E-SpcCl"		Proj:RunResultsE[2]:ProposedTDV[3]			= {	LocalRef( RunResultsE[2]:PropElecTDV[1] ) + LocalRef( RunResultsE[2]:PropNatGasTDV ) + LocalRef( RunResultsE[2]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - E-SpcCl"		Proj:RunResultsE[2]:ProposedTDV[3]			= {	LocalRef( RunResultsE[2]:PropElecTDV[1] ) + ((LocalRef( RunResultsE[2]:PropNatGasTDV ) + LocalRef( RunResultsE[2]:PropOtherTDV )) *
;																																													T24RClimateZoneCodeBase:ClgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))   }
	"Calculate TDV - TOTAL  - E-IAQVent"	Proj:RunResultsE[3]:ProposedTDV[3]			= {	LocalRef( RunResultsE[3]:PropElecTDV[1] )   }
	"Calculate TDV - TOTAL  - E-OthrHVAC"	Proj:RunResultsE[4]:ProposedTDV[3]			= {	RunResultsE[4]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - E-WtrHt"		Proj:RunResultsE[5]:ProposedTDV[3]			= {	LocalRef( RunResultsE[5]:PropElecTDV[1] ) + LocalRef( RunResultsE[5]:PropNatGasTDV ) + LocalRef( RunResultsE[5]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - E-WtrHt"		Proj:RunResultsE[5]:ProposedTDV[3]			= {	LocalRef( RunResultsE[5]:PropElecTDV[1] ) + ((LocalRef( RunResultsE[5]:PropNatGasTDV ) + LocalRef( RunResultsE[5]:PropOtherTDV )) *
;																																													T24RClimateZoneCodeBase:DHWDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))  }
	"Calculate TDV - TOTAL  - E-InsLtg"		Proj:RunResultsE[6]:ProposedTDV[3]			= {	RunResultsE[6]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - E-AppCkg"		Proj:RunResultsE[7]:ProposedTDV[3]			= {	LocalRef( RunResultsE[7]:PropElecTDV[1] ) + LocalRef( RunResultsE[7]:PropNatGasTDV ) + LocalRef( RunResultsE[7]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - E-AppCkg"		Proj:RunResultsE[7]:ProposedTDV[3]			= {	LocalRef( RunResultsE[7]:PropElecTDV[1] ) + ((LocalRef( RunResultsE[7]:PropNatGasTDV ) + LocalRef( RunResultsE[7]:PropOtherTDV )) *
;																																													T24RClimateZoneCodeBase:AppDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))   }
	"Calculate TDV - TOTAL  - E-Plugs"		Proj:RunResultsE[8]:ProposedTDV[3]			= {	RunResultsE[8]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - E-Ext"			Proj:RunResultsE[9]:ProposedTDV[3]			= {	RunResultsE[9]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - E-PV"			Proj:RunResultsE[13]:ProposedTDV[3]			= {	RunResultsE[13]:ProposedTDV[1]   }
	"Calculate TDV - TOTAL  - E-Battery"	Proj:RunResultsE[14]:ProposedTDV[3]			= {	RunResultsE[14]:ProposedTDV[1]   }

	"Calculate TDV - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:ProposedTDV[3]			= {	RunResultsE[1]:ProposedTDV[3]    + RunResultsE[2]:ProposedTDV[3]    + RunResultsE[3]:ProposedTDV[3]    + RunResultsE[4]:ProposedTDV[3]    + RunResultsE[5]:ProposedTDV[3]     }
	"Calculate TDV - TOTAL  - E-Total"		Proj:RunResultsE[10]:ProposedTDV[3]			= {	RunResultsE[11]:ProposedTDV[3]    + RunResultsE[6]:ProposedTDV[3]    + RunResultsE[7]:ProposedTDV[3]    + RunResultsE[8]:ProposedTDV[3]    + RunResultsE[9]:ProposedTDV[3]     }
END

;*************************************************************************  - SAC 3/14/16
RULELIST "CARes_DRtgPropMultTDVResults_S" 1 0 0 1
;*************************************************************************
; SAC 3/31/16 - revised rules REMOVING application of design rating fuel adjustment multipliers to ProposedTDV (mods made elsewhere to apply inverse adjustment to DR reference TDV)
	"Calculate TDV - TOTAL  - S-SpcHt"		Proj:RunResultsS[1]:ProposedTDV[3]			= {	LocalRef( RunResultsS[1]:PropElecTDV[1] ) + LocalRef( RunResultsS[1]:PropNatGasTDV ) + LocalRef( RunResultsS[1]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - S-SpcHt"		Proj:RunResultsS[1]:ProposedTDV[3]			= {	LocalRef( RunResultsS[1]:PropElecTDV[1] ) + ((LocalRef( RunResultsS[1]:PropNatGasTDV ) + LocalRef( RunResultsS[1]:PropOtherTDV )) *
;																																													T24RClimateZoneCodeBase:HtgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))   }
	"Calculate TDV - TOTAL  - S-SpcCl"		Proj:RunResultsS[2]:ProposedTDV[3]			= {	LocalRef( RunResultsS[2]:PropElecTDV[1] ) + LocalRef( RunResultsS[2]:PropNatGasTDV ) + LocalRef( RunResultsS[2]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - S-SpcCl"		Proj:RunResultsS[2]:ProposedTDV[3]			= {	LocalRef( RunResultsS[2]:PropElecTDV[1] ) + ((LocalRef( RunResultsS[2]:PropNatGasTDV ) + LocalRef( RunResultsS[2]:PropOtherTDV )) *
;																																													T24RClimateZoneCodeBase:ClgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))   }
	"Calculate TDV - TOTAL  - S-IAQVent"	Proj:RunResultsS[3]:ProposedTDV[3]			= {	LocalRef( RunResultsS[3]:PropElecTDV[1] )   }
	"Calculate TDV - TOTAL  - S-OthrHVAC"	Proj:RunResultsS[4]:ProposedTDV[3]			= {	RunResultsS[4]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - S-WtrHt"		Proj:RunResultsS[5]:ProposedTDV[3]			= {	LocalRef( RunResultsS[5]:PropElecTDV[1] ) + LocalRef( RunResultsS[5]:PropNatGasTDV ) + LocalRef( RunResultsS[5]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - S-WtrHt"		Proj:RunResultsS[5]:ProposedTDV[3]			= {	LocalRef( RunResultsS[5]:PropElecTDV[1] ) + ((LocalRef( RunResultsS[5]:PropNatGasTDV ) + LocalRef( RunResultsS[5]:PropOtherTDV )) *
;																																													T24RClimateZoneCodeBase:DHWDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))  }
	"Calculate TDV - TOTAL  - S-InsLtg"		Proj:RunResultsS[6]:ProposedTDV[3]			= {	RunResultsS[6]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - S-AppCkg"		Proj:RunResultsS[7]:ProposedTDV[3]			= {	LocalRef( RunResultsS[7]:PropElecTDV[1] ) + LocalRef( RunResultsS[7]:PropNatGasTDV ) + LocalRef( RunResultsS[7]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - S-AppCkg"		Proj:RunResultsS[7]:ProposedTDV[3]			= {	LocalRef( RunResultsS[7]:PropElecTDV[1] ) + ((LocalRef( RunResultsS[7]:PropNatGasTDV ) + LocalRef( RunResultsS[7]:PropOtherTDV )) *
;																																													T24RClimateZoneCodeBase:AppDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))   }
	"Calculate TDV - TOTAL  - S-Plugs"		Proj:RunResultsS[8]:ProposedTDV[3]			= {	RunResultsS[8]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - S-Ext"			Proj:RunResultsS[9]:ProposedTDV[3]			= {	RunResultsS[9]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - S-PV"			Proj:RunResultsS[13]:ProposedTDV[3]			= {	RunResultsS[13]:ProposedTDV[1]   }
	"Calculate TDV - TOTAL  - S-Battery"	Proj:RunResultsS[14]:ProposedTDV[3]			= {	RunResultsS[14]:ProposedTDV[1]   }

	"Calculate TDV - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:ProposedTDV[3]			= {	RunResultsS[1]:ProposedTDV[3]    + RunResultsS[2]:ProposedTDV[3]    + RunResultsS[3]:ProposedTDV[3]    + RunResultsS[4]:ProposedTDV[3]    + RunResultsS[5]:ProposedTDV[3]     }
	"Calculate TDV - TOTAL  - S-Total"		Proj:RunResultsS[10]:ProposedTDV[3]			= {	RunResultsS[11]:ProposedTDV[3]    + RunResultsS[6]:ProposedTDV[3]    + RunResultsS[7]:ProposedTDV[3]    + RunResultsS[8]:ProposedTDV[3]    + RunResultsS[9]:ProposedTDV[3]     }
END

;*************************************************************************  - SAC 3/14/16
RULELIST "CARes_DRtgPropMultTDVResults_W" 1 0 0 1
;*************************************************************************
; SAC 3/31/16 - revised rules REMOVING application of design rating fuel adjustment multipliers to ProposedTDV (mods made elsewhere to apply inverse adjustment to DR reference TDV)
	"Calculate TDV - TOTAL  - W-SpcHt"		Proj:RunResultsW[1]:ProposedTDV[3]			= {	LocalRef( RunResultsW[1]:PropElecTDV[1] ) + LocalRef( RunResultsW[1]:PropNatGasTDV ) + LocalRef( RunResultsW[1]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - W-SpcHt"		Proj:RunResultsW[1]:ProposedTDV[3]			= {	LocalRef( RunResultsW[1]:PropElecTDV[1] ) + ((LocalRef( RunResultsW[1]:PropNatGasTDV ) + LocalRef( RunResultsW[1]:PropOtherTDV )) *
;																																													T24RClimateZoneCodeBase:HtgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))   }
	"Calculate TDV - TOTAL  - W-SpcCl"		Proj:RunResultsW[2]:ProposedTDV[3]			= {	LocalRef( RunResultsW[2]:PropElecTDV[1] ) + LocalRef( RunResultsW[2]:PropNatGasTDV ) + LocalRef( RunResultsW[2]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - W-SpcCl"		Proj:RunResultsW[2]:ProposedTDV[3]			= {	LocalRef( RunResultsW[2]:PropElecTDV[1] ) + ((LocalRef( RunResultsW[2]:PropNatGasTDV ) + LocalRef( RunResultsW[2]:PropOtherTDV )) *
;																																													T24RClimateZoneCodeBase:ClgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))   }
	"Calculate TDV - TOTAL  - W-IAQVent"	Proj:RunResultsW[3]:ProposedTDV[3]			= {	LocalRef( RunResultsW[3]:PropElecTDV[1] )   }
	"Calculate TDV - TOTAL  - W-OthrHVAC"	Proj:RunResultsW[4]:ProposedTDV[3]			= {	RunResultsW[4]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - W-WtrHt"		Proj:RunResultsW[5]:ProposedTDV[3]			= {	LocalRef( RunResultsW[5]:PropElecTDV[1] ) + LocalRef( RunResultsW[5]:PropNatGasTDV ) + LocalRef( RunResultsW[5]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - W-WtrHt"		Proj:RunResultsW[5]:ProposedTDV[3]			= {	LocalRef( RunResultsW[5]:PropElecTDV[1] ) + ((LocalRef( RunResultsW[5]:PropNatGasTDV ) + LocalRef( RunResultsW[5]:PropOtherTDV )) *
;																																													T24RClimateZoneCodeBase:DHWDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))  }
	"Calculate TDV - TOTAL  - W-InsLtg"		Proj:RunResultsW[6]:ProposedTDV[3]			= {	RunResultsW[6]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - W-AppCkg"		Proj:RunResultsW[7]:ProposedTDV[3]			= {	LocalRef( RunResultsW[7]:PropElecTDV[1] ) + LocalRef( RunResultsW[7]:PropNatGasTDV ) + LocalRef( RunResultsW[7]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - W-AppCkg"		Proj:RunResultsW[7]:ProposedTDV[3]			= {	LocalRef( RunResultsW[7]:PropElecTDV[1] ) + ((LocalRef( RunResultsW[7]:PropNatGasTDV ) + LocalRef( RunResultsW[7]:PropOtherTDV )) *
;																																													T24RClimateZoneCodeBase:AppDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))   }
	"Calculate TDV - TOTAL  - W-Plugs"		Proj:RunResultsW[8]:ProposedTDV[3]			= {	RunResultsW[8]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - W-Ext"			Proj:RunResultsW[9]:ProposedTDV[3]			= {	RunResultsW[9]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - W-PV"			Proj:RunResultsW[13]:ProposedTDV[3]			= {	RunResultsW[13]:ProposedTDV[1]   }
	"Calculate TDV - TOTAL  - W-Battery"	Proj:RunResultsW[14]:ProposedTDV[3]			= {	RunResultsW[14]:ProposedTDV[1]   }

	"Calculate TDV - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:ProposedTDV[3]			= {	RunResultsW[1]:ProposedTDV[3]    + RunResultsW[2]:ProposedTDV[3]    + RunResultsW[3]:ProposedTDV[3]    + RunResultsW[4]:ProposedTDV[3]    + RunResultsW[5]:ProposedTDV[3]     }
	"Calculate TDV - TOTAL  - W-Total"		Proj:RunResultsW[10]:ProposedTDV[3]			= {	RunResultsW[11]:ProposedTDV[3]    + RunResultsW[6]:ProposedTDV[3]    + RunResultsW[7]:ProposedTDV[3]    + RunResultsW[8]:ProposedTDV[3]    + RunResultsW[9]:ProposedTDV[3]     }
END


;*************************************************************************
RULELIST "CARes_CalculatePVCredit_2013Compliance" 1 0 0 1
;*************************************************************************
;	mjb	added check on StandardsVersion for finalizing PV credit	9/23/13
	"Set Proj:PVPrelimCredit based on Std design Cool TDV * MaxPVPrelimCredit"
			Proj:PVPrelimCredit	= {	ApplyHourlyResultMultipliers( "ClgPVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "Clg", "FanC") * (MaxPVPrelimCredit / 100)  }

;  "debug PV credit"		Proj:Action = { PostWarning( "debug PV credit  MaxPVPrelimCredit: %g  PVPrelimCredit: %g",  MaxPVPrelimCredit, PVPrelimCredit )  }
	"Set Proj:PVCredit[1] (min of PVGenCredit & PVPrelimCredit) - Comp analysis"	Proj:PVCredit[1]	= {	int( (100 * min( PVGenCredit, PVPrelimCredit ) / CondFloorArea) + 0.5) / 100  }
;  "debug PV credit 2"		Proj:Action = { PostWarning( "debug 2013 PV credit 2  PVGenCredit: %g  PVCredit: %g  --  in rulelist: CARes_CalculatePVCredit_2013Compliance",  PVGenCredit, PVCredit )  }
END

;*************************************************************************
RULELIST "CARes_CalculatePVCredit_2016Compliance" 1 0 0 1
;*************************************************************************
;"dbg" Proj:Action = { PostMessageToLog( "CARes_CalculatePVCredit_2016Compliance for run '%s' -> PVBaseTDV %g / MaxPVPrelimCredit %g / PVDwellUnitSize %g / PVDUSizeThreshold %g", 
;                                          RunAbbrev, ValidOr( PVBaseTDV, -999 ), MaxPVPrelimCredit, PVDwellUnitSize, PVDUSizeThreshold )  }
; mjb - added check on StandardsVersion for finalizing PV credit - 9/23/13
   "Set Proj:PVPrelimCredit based on Std design Cool TDV * MaxPVPrelimCredit"
         Proj:PVPrelimCredit   = {   PVBaseTDV * (MaxPVPrelimCredit / 100)  }

;  "debug PV credit"      Proj:Action = { PostWarning( "debug PV credit  MaxPVPrelimCredit: %g  PVPrelimCredit: %g",  MaxPVPrelimCredit, PVPrelimCredit )  }
   "Set Proj:PVCredit[1] (min of PVGenCredit & PVPrelimCredit) - Comp analysis"
      Proj:PVCredit[1]   = {   int( (100 * PVPrelimCredit / CondFloorArea) + 0.5) / 100  }
;  "debug PV credit 2"      Proj:Action = { PostWarning( "debug 2016 PV credit 2  PVGenCredit: %g  PVCredit: %g  --  in rulelist: CARes_CalculatePVCredit_2016Compliance",  PVGenCredit, PVCredit )  }

   ; SAC 4/2/15 - adjust Proj:PVMinRatedPower based in part on final PVCredit for T-24 2016 - and if entered PVRatedPower insufficient, then zero out PVCredit
   "Set Proj:PVMinRatedPower[2]"      Proj:PVMinRatedPower[2]   = {
      if (IfValidAnd( PVDwellUnitSize > PVDUSizeThreshold ))
      then  PVMinRatedPower[1] + (PVCredit[1] * ValidOr( NumDwellingUnits, 1 ) * 
               (PVDwellUnitSize - PVDUSizeThreshold) / ValidOr( PVGenerationRate, 1 ))
      else  0  endif  }
   "Round Proj:PVMinRatedPower[2]"   Proj:PVMinRatedPower[2]   = {
      if (PVMinRatedPower[2] > 0) then  int( (PVMinRatedPower[2] * 10) + 0.5 ) / 10
      else  UNCHANGED  endif  }
;"store details"  Proj:Action = { StoreBEMProc( "MinPVCheck", 0 ) }    ; SAC 12/12/16 - DEBUGGING

  ; SAC 12/12/16 - modified logic to handle scenario where user-entered total PV system size < min required for PVCredit (tic #772) / SAC 1/2/18 - labeling changed to std design PV
   "Zero out PVCredit if PVRatedPower too low - Comp analysis"      Proj:Action   = {
      if (IfValidAnd( PVCredit[1] > 0 )==0 .AND. IfValidAnd( PVMinRatedPower[2] > 0 )==0) then  UNCHANGED
      else if (IfValidAnd( AllowPVWInputs > 0 ) .AND. IfValidAnd( PVWDCSysTotal < PVMinRatedPower[2] ))
      then  EvalRulelist( "CARes_ZeroOutCompPVCredit_InsufficientPVRatedPower_WarnUser" )
      else if (IfValidAnd(PVRatedPower < PVMinRatedPower[2]))
      then  EvalRulelist( "CARes_ZeroOutCompPVCredit_InsufficientPVRatedPower" )
      else  UNCHANGED  endif endif endif  }
  ; SAC 3/3/16 - add new PV message when PVCompCredit selected but no PVRatedPower input (tic #609)
  ; SAC 6/19/18 - added logic to set CompResultsMsg based on PVMinRatedPower[1] if it is not yet defined
;"dbg" Proj:Action = { PostMessageToLog( "CARes_CalculatePVCredit_2016Compliance about to set Proj:CompResultsMsg for run '%s' -> PVCompCredit %g / PVCredit[1] %g / ResultSummary[1]:PVMinRatedPower %g / PVMinRatedPower[2] %g", 
;                                          RunAbbrev, ValidOr( PVCompCredit, -999 ), PVCredit[1], ValidOr( ResultSummary[1]:PVMinRatedPower, -999 ), ValidOr( PVMinRatedPower[2], -999 ) )  }
   "Store message to document minimum PV system power to qualify for PV compliance credit"
      Proj:CompResultsMsg   = {
         if (PVCompCredit > 0 .AND. PVCredit[1] > 0)
         then  if (IfValidAnd( ResultSummary[1]:PVMinRatedPower > 0 ))
               then  Format( "Required minimum PV system size is %s kWdc.", FltToStr( ResultSummary[1]:PVMinRatedPower, 2, 0, 0, 1 ) )
               else if (IfValidAnd( PVMinRatedPower[2] > 0 ))
               then  Format( "Required minimum PV system size is %s kWdc.", FltToStr( PVMinRatedPower[2], 2, 0, 0, 1 ) )
               else if (LocalStatus( CompResultsMsg ) < 1 .AND. IfValidAnd( PVMinRatedPower[1] > 0 ))
               then  Format( "Required minimum PV system size is %s kWdc.", FltToStr( PVMinRatedPower[1], 2, 0, 0, 1 ) )
               else  UNCHANGED  endif endif endif
         else  UNCHANGED  endif  }

   ; SAC 3/24/16 - REWRITE SpeclFeatrs:PVSysCreditMsg based on the final PV minimum or installed size (requested by KN 3/22/16)
   ; SAC 2/20/18 - revised PV capacity decimal precision from 1->2 (tic #921) - SAC 2/26/18 - revised again to reference new PVWDCSysScldTotRnd
   ; SAC 6/19/18 - added logic to set PVSysCreditMsg based on PVMinRatedPower[1] if it is not currently defined
   "Set rounded & scaled PV size"   Proj:Action  = {  EvalRulelist( "Set_Proj_PVWDCSysScldTotRnd" )  }
   ; SAC 10/12/18 - added separate PVSysCreditVal property to carry reported PV system capacity separately from message (to facilitate XML schema CF1R rules)
	"Set PV Capacity Value" 			Proj:SpeclFeatrs:PVSysCreditVal = {
         if (PVCompCredit > 0 .AND. PVCredit[1] > 0)
         then  if (IfValidAnd( AllowDesignRating > 0.5 ) .AND. IfValidAnd( DesignRatingCalcs > 0.5 ) .AND.
                   IfValidAnd( PVWDCSysTotal >= PVMinRatedPower[2] ))
               then	if (IfValidAnd( PVWDCSysScldTotRnd > 0 ))
   				      then  PVWDCSysScldTotRnd
	   			      else  PVWDCSysTotal       endif
               else if (IfValidAnd( ResultSummary[1]:PVMinRatedPower > 0 ))
               then  ResultSummary[1]:PVMinRatedPower
               else if (IfValidAnd( PVMinRatedPower[2] > 0 ))
               then  PVMinRatedPower[2]
               else if (LocalStatus( SpeclFeatrs:PVSysCreditMsg ) < 1 .AND. IfValidAnd( PVMinRatedPower[1] > 0 ))
               then  PVMinRatedPower[1]
               else  UNCHANGED  endif endif endif endif
         else  UNCHANGED  endif  }
   "Write PV Capacity Msg"    Proj:SpeclFeatrs:PVSysCreditMsg = {
         if (PVCompCredit > 0 .AND. PVCredit[1] > 0 .AND. IfValidAnd( SpeclFeatrs:PVSysCreditVal > 0 ))
         then  "PV System: " + FltToStr( SpeclFeatrs:PVSysCreditVal, 2, 0, 0, 1 ) + " kWdc"
         else  UNCHANGED  endif  }
   ; SAC 6/19/18 - added rule to ensure PVSysCredit flag set whenever PVSysCreditMsg specified
   "Ensure PVSysCredit flag set (if appropriate)"     Proj:SpeclFeatrs:PVSysCredit = {
         if (IfValidAnd( SpeclFeatrs:PVSysCredit > 0 ) .OR.
             LocalStatus( SpeclFeatrs:PVSysCreditMsg ) < 1)
         then  UNCHANGED
         else if (strlen( SpeclFeatrs:PVSysCreditMsg ) > 3) then  1  else  UNCHANGED  endif endif  }
END

;*************************************************************************
RULELIST "CARes_CalculatePVCredit_2016DesignRating" 1 0 0 1
;*************************************************************************
	"Disable Proj:MaxPVPrelimCredit for DesignRating calc"		Proj:MaxPVPrelimCredit	= {	UNDEFINED  }
	"Disable Proj:PVPrelimCredit for DesignRating calc"			Proj:PVPrelimCredit		= {	UNDEFINED  }

		;  "debug PV credit"		Proj:Action = { PostWarning( "debug PV credit  MaxPVPrelimCredit: %g  PVPrelimCredit: %g",  MaxPVPrelimCredit, PVPrelimCredit )  }
;	"Set Proj:PVCredit[2] (min of PVGenCredit & PVPrelimCredit) - DRtg analysis"	Proj:PVCredit[2]	= {	int( (100 * PVGenCredit / CondFloorArea) + 0.5) / 100  }
		;  "debug PV credit 2"		Proj:Action = { PostWarning( "debug PV credit 2  PVGenCredit: %g  PVCredit: %g",  PVGenCredit, PVCredit[2] )  }
  ; SAC 1/28/16 - new DRtg PVCredit based on PVWatts results...
;"store BEMProc details"		Proj:Action = {  StoreBEMProc( "DsgnRtg PV", 0 )  }
;"testing"	Proj:Action	= {	if (IfValidAnd( AllOrientations > 0.5 ))
;										then	MessageBox( "RunResultsN[13]:ProposedTDV[1] = %g  and [2] = %g", ValidOr( RunResultsN[13]:ProposedTDV[1], 0 ), ValidOr( RunResultsN[13]:ProposedTDV[2], 0 ) )
;										else	MessageBox( "RunResults[13]:ProposedTDV[1] = %g  and [2] = %g", ValidOr(  RunResults[13]:ProposedTDV[1], 0 ), ValidOr(  RunResults[13]:ProposedTDV[2], 0 ) )  endif  }
	"Set Proj:PVCredit[2] (based on PVWatts) - DRtg analysis"
			Proj:PVCredit[2]	= {	if (IfValidAnd( AllOrientations > 0.5 ))
											then	-1 * ValidOr( RunResultsN[13]:ProposedTDV[2], 0 )
											else	-1 * ValidOr(  RunResults[13]:ProposedTDV[2], 0 )
											endif  }
END

;*************************************************************************
RULELIST "CARes_ZeroOutCompPVCredit_InsufficientPVRatedPower_WarnUser" 1 0 0 1
   "Post warning about insufficient PV system size(s)"   Proj:Action = {
;      PostError( "PV credit not awarded due to PV system size (%0.2f kWdc) smaller than minimum size of %0.2f kWdc (adjusted based on standard design simulation).", PVWDCSysTotal, PVMinRatedPower[2] )  }
      PostError( "PV System Size is too small to qualify for PV System Compliance Credit.\nRerun the calculation increasing the PV DC System size(s). In CBECC-Res, the PV DC System sizes (currently summing to %0.2f kWdc) are on the Project EDR tab and need to be increased to >= %0.1f kWdc. These inputs may be located in a different place in other software.\nSet Proj:PVCompCredit = 0 or increase Proj:PVWDCSysSize[1-5] to sum >= %0.1f kWdc.",
                  PVWDCSysTotal, PVMinRatedPower[2], PVMinRatedPower[2] )  }
   "reset PVCredit"  Proj:Action = {  EvalRulelist( "CARes_ZeroOutCompPVCredit_InsufficientPVRatedPower" )  }
END
;*************************************************************************
RULELIST "CARes_ZeroOutCompPVCredit_InsufficientPVRatedPower" 1 0 0 1
	"Zero-out Proj:PVCredit[1] - Comp analysis"	Proj:PVCredit[1]	= {	0  }
; PROMPT USER for insufficient PVRatedPower
	"Prompt user for insufficent PVRatedPower due to PVMinRatedPower increased by PVCredit adjustment - Comp analysis"
		Proj:Action	= {	PostWarning( "Minimum PV rated power increased due to dwelling unit size and calculated PV credit, rated power must be >= %.1f kWdc (compliance analysis).", PVMinRatedPower[2] )  }
	"Store message to field displayed in results summary describing insufficient PVRatedPower issue"
		Proj:CompResultsMsg	= {	Format( "PV credit unavailable for this model unless PV Rated Power increased to >= %.1f kWdc.", PVMinRatedPower[2] )  }
  ; SAC 4/17/15 - ALSO reset special features flag & message to prevent improper
	"Reset SpeclFeatrs:PVSysCredit flag"	Proj:SpeclFeatrs:PVSysCredit		= {	0  }
	"Reset PV Capacity Value" 			      Proj:SpeclFeatrs:PVSysCreditVal  = {   UNDEFINED  }      ; SAC 10/12/18 - to facilitate XML schema CF1R rules 
	"Reset SpeclFeatrs:PVSysCreditMsg"		Proj:SpeclFeatrs:PVSysCreditMsg	= {	" "  }
END
; ;*************************************************************************
; RULELIST "CARes_ZeroOutDRtgPVCredit_InsufficientPVRatedPower" 1 0 0 1
; 	"Zero-out Proj:PVCredit[2] - DRtg analysis"	Proj:PVCredit[2]	= {	0  }
; ; PROMPT USER for insufficient PVRatedPower
; 	"Prompt user for insufficent PVRatedPower due to PVMinRatedPower increased by PVCredit adjustment - DRtg analysis"
; 		Proj:Action	= {	PostWarning( "Minimum PV rated power increased due to dwelling unit size and calculated PV credit, rated power must be >= %g kWdc (design rating analysis).", PVMinRatedPower[2] )  }
; END
;*************************************************************************


;*************************************************************************
RULELIST "CARes_StandardTDVResults" 1 0 0 1
;*************************************************************************
; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
         ; SAC 8/24/19 - replaced 1/3.413 & 0.01 TDV table multipliers with Proj:TDVSecMult_Elec & TDVSecMult_Fuel to accommodate 2022+ switch to native (E3) TDV table units
         ; SAC 8/26/19 - added primary table multipliers (of 1.0) to all ApplyHourlyResultMult* function calls (to accommodate 2022+ TDV table unit switch)
  ; Space Heating (& heating fan)
	"Calculate TDV - Elec   - SpcHt"		Proj:RunResults[1]:StdElecTDV				= {	if (LocalRef( RunResults[1]:StdElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - SpcHt"		Proj:RunResults[1]:StdNatGasTDV			= {	if (LocalRef( RunResults[1]:StdNatGasEnergy		) < 0.0001) then  0                                                                                                        
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - SpcHt"		Proj:RunResults[1]:StdOtherTDV			= {	if (LocalRef( RunResults[1]:StdOtherEnergy		) < 0.0001) then  0                                                                                                        
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - SpcHt"		Proj:RunResults[1]:StandardTDV			= {	LocalRef( RunResults[1]:StdElecTDV ) + LocalRef( RunResults[1]:StdNatGasTDV ) + LocalRef( RunResults[1]:StdOtherTDV )   }
  ; SAC 8/23/14 - added rules to set elec demand
	"Calculate Elec Demand  - SpcHt"		Proj:RunResults[1]:StdElecDemand			= {	if (LocalRef( RunResults[1]:StdElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / 3.412  endif  }

  ; Space Cooling (& cooling fan)
	"Calculate TDV - Elec   - SpcCl"		Proj:RunResults[2]:StdElecTDV				= {	if (LocalRef( RunResults[2]:StdElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - SpcCl"		Proj:RunResults[2]:StdNatGasTDV			= {	if (LocalRef( RunResults[2]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - SpcCl"		Proj:RunResults[2]:StdOtherTDV			= {	if (LocalRef( RunResults[2]:StdOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - SpcCl"		Proj:RunResults[2]:StandardTDV			= {	LocalRef( RunResults[2]:StdElecTDV ) + LocalRef( RunResults[2]:StdNatGasTDV ) + LocalRef( RunResults[2]:StdOtherTDV )   }
	"Calculate Elec Demand  - SpcCl"		Proj:RunResults[2]:StdElecDemand			= {	if (LocalRef( RunResults[1]:StdElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Clg", "FanC" ) / 3.412  endif  }

  ; IAQ Ventilation Fans
	"Calculate TDV - Elec   - IAQVent"	Proj:RunResults[3]:StdElecTDV				= {	if (LocalRef( RunResults[3]:StdElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "IAQVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "FanV" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - IAQVent"	Proj:RunResults[3]:StdNatGasTDV			= {	0  }
	"Calculate TDV - Other  - IAQVent"	Proj:RunResults[3]:StdOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - IAQVent"	Proj:RunResults[3]:StandardTDV			= {	LocalRef( RunResults[3]:StdElecTDV )   }
	"Calculate Elec Demand  - IAQVent"	Proj:RunResults[3]:StdElecDemand			= {	if (LocalRef( RunResults[3]:StdElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "FanV" ) / 3.412  endif  }

  ; Other HVAC (aux & misc fans)
   ; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
   ; SAC 11/15/18 - restored "Other HVAC" [4] to handle VCHP CFan via "User1" enduse
	"Calculate TDV - Elec   - OthrHVAC"	Proj:RunResults[4]:StdElecTDV				= {	if (LocalRef( RunResults[4]:StdElecEnergy ) < 0.0001 .AND. OthrHVAC_SpcHtFrac == 0) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "OHVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "User1" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - OthrHVAC"	Proj:RunResults[4]:StdNatGasTDV			= {	0  }
	"Calculate TDV - Other  - OthrHVAC"	Proj:RunResults[4]:StdOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - OthrHVAC"	Proj:RunResults[4]:StandardTDV			= {	RunResults[4]:StdElecTDV  }
	"Calculate Elec Demand  - OthrHVAC"	Proj:RunResults[4]:StdElecDemand			= {	if (LocalRef( RunResults[4]:StdElecEnergy	) < 0.0001 .AND. OthrHVAC_SpcHtFrac == 0) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "User1" ) / 3.412  endif  }

; SAC 1/27/19 - REDISTRIBUTE OthrHVAC Std TDV across SpcHt & SpcCl by fuel based on ratio of total TDV (across all fuels) (tic #1053)
   "Set OthrHVAC_SpcHtFrac - StdTDV"      Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResults[4]:StandardTDV[1] != 0 )==0) then  0
                                                                        else if (IfValidAnd( RunResults[1]:StandardTDV[1] == 0 ) .AND.
                                                                                 IfValidAnd( RunResults[2]:StandardTDV[1] == 0 )) then  0.5
                                                                        else   ValidOr( RunResults[1]:StandardTDV[1], 0 ) / 
                                                                              (ValidOr( RunResults[1]:StandardTDV[1], 0 ) + ValidOr( RunResults[2]:StandardTDV[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Elec   - SpcHt"		Proj:RunResults[1]:StdElecTDV[1]	   = {   if (IfValidAnd( RunResults[4]:StdElecTDV[1] != 0 )==0) then  UNCHANGED
                                                                                    else  RunResults[1]:StdElecTDV[1] + (RunResults[4]:StdElecTDV[1]     * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - TOTAL  - SpcHt"		Proj:RunResults[1]:StandardTDV[1]	= {	LocalRef( RunResults[1]:StdElecTDV[1] ) + LocalRef( RunResults[1]:StdNatGasTDV[1] ) + LocalRef( RunResults[1]:StdOtherTDV[1] )   }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Elec   - SpcCl"		Proj:RunResults[2]:StdElecTDV[1]	   = {   if (IfValidAnd( RunResults[4]:StdElecTDV[1] != 0 )==0) then  UNCHANGED
                                                                                    else  RunResults[2]:StdElecTDV[1] + (RunResults[4]:StdElecTDV[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - TOTAL  - SpcCl"		Proj:RunResults[2]:StandardTDV[1]	= {	LocalRef( RunResults[2]:StdElecTDV[1] ) + LocalRef( RunResults[2]:StdNatGasTDV[1] ) + LocalRef( RunResults[2]:StdOtherTDV[1] )   }
   ; SAC 1/27/19 - REDISTRIBUTE OthrHVAC Prop Demand across SpcHt & SpcCl by fuel based on ratio of total Demand (tic #1053)
   "Set OthrHVAC_SpcHtFrac - StdDemand"   Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResults[4]:StdElecDemand[1] != 0 )==0) then  0
                                                                        else if (IfValidAnd( RunResults[1]:StdElecDemand[1] == 0 ) .AND.
                                                                                 IfValidAnd( RunResults[2]:StdElecDemand[1] == 0 )) then  0.5
                                                                        else   ValidOr( RunResults[1]:StdElecDemand[1], 0 ) / 
                                                                              (ValidOr( RunResults[1]:StdElecDemand[1], 0 ) + ValidOr( RunResults[2]:StdElecDemand[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Demand - SpcHt"		Proj:RunResults[1]:StdElecDemand[1] = {   if (IfValidAnd( RunResults[4]:StdElecDemand[1] != 0 )==0) then  UNCHANGED
                                                                                    else  RunResults[1]:StdElecDemand[1] + (RunResults[4]:StdElecDemand[1]     * OthrHVAC_SpcHtFrac)  endif  }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Demand - SpcCl"		Proj:RunResults[2]:StdElecDemand[1] = {   if (IfValidAnd( RunResults[4]:StdElecDemand[1] != 0 )==0) then  UNCHANGED
                                                                                    else  RunResults[2]:StdElecDemand[1] + (RunResults[4]:StdElecDemand[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
  ; Other HVAC (aux & misc fans)
	"ZERO-OUT         - Elec   - OthrHVAC"	Proj:RunResults[4]:StdElecTDV[1]	   = {	0  }
	"ZERO-OUT         - NatGas - OthrHVAC"	Proj:RunResults[4]:StdNatGasTDV[1]	= {	0  }
	"ZERO-OUT         - Other  - OthrHVAC"	Proj:RunResults[4]:StdOtherTDV[1]	= {	0  }
	"ZERO-OUT         - TOTAL  - OthrHVAC"	Proj:RunResults[4]:StandardTDV[1]	= {	0  }
	"ZERO-OUT         - Demand - OthrHVAC"	Proj:RunResults[4]:StdElecDemand[1] = {	0  }
   ; SAC 1/27/19 - end of - redistribution of OthrHVAC PropTDV

  ; Water Heating
	"Calculate TDV - Elec   - WtrHt"		Proj:RunResults[5]:StdElecTDV				= {	if (LocalRef( RunResults[5]:StdElecEnergy		) < 0.0001) then  0
			 			  																						else if (CSEinclDHWMFL_EU)
			 			  																				      then  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / CondFloorArea) + 0.5) / 100 
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate TDV - NatGas - WtrHt"		Proj:RunResults[5]:StdNatGasTDV			= {	if (LocalRef( RunResults[5]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - WtrHt"		Proj:RunResults[5]:StdOtherTDV			= {	if (LocalRef( RunResults[5]:StdOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - WtrHt"		Proj:RunResults[5]:StandardTDV			= {	LocalRef( RunResults[5]:StdElecTDV ) + LocalRef( RunResults[5]:StdNatGasTDV ) + LocalRef( RunResults[5]:StdOtherTDV )   }
	"Calculate Elec Demand  - WtrHt"		Proj:RunResults[5]:StdElecDemand			= {	if (LocalRef( RunResults[1]:StdElecEnergy	) < 0.0001) then  0
			 			  																						else if (CSEinclDHWMFL_EU)
			 			  																						then  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / 3.412 
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / 3.412  endif endif  }

  ; Inside Lighting
	"Calculate TDV - Elec   - InsLtg"	Proj:RunResults[6]:StdElecTDV				= {	if (LocalRef( RunResults[6]:StdElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - InsLtg"	Proj:RunResults[6]:StdNatGasTDV			= {	if (LocalRef( RunResults[6]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - InsLtg"	Proj:RunResults[6]:StdOtherTDV			= {	if (LocalRef( RunResults[6]:StdOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - InsLtg"	Proj:RunResults[6]:StandardTDV			= {	LocalRef( RunResults[6]:StdElecTDV ) + LocalRef( RunResults[6]:StdNatGasTDV ) + LocalRef( RunResults[6]:StdOtherTDV )   }
	"Calculate Elec Demand  - InsLtg"	Proj:RunResults[6]:StdElecDemand			= {	if (LocalRef( RunResults[1]:StdElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Lit" ) / 3.412  endif  }

  ; Appliances & Cooking
	"Calculate TDV - Elec   - AppCkg"	Proj:RunResults[7]:StdElecTDV				= {	if (LocalRef( RunResults[7]:StdElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - AppCkg"	Proj:RunResults[7]:StdNatGasTDV			= {	if (LocalRef( RunResults[7]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - AppCkg"	Proj:RunResults[7]:StdOtherTDV			= {	if (LocalRef( RunResults[7]:StdOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - AppCkg"	Proj:RunResults[7]:StandardTDV			= {	LocalRef( RunResults[7]:StdElecTDV ) + LocalRef( RunResults[7]:StdNatGasTDV ) + LocalRef( RunResults[7]:StdOtherTDV )   }
	"Calculate Elec Demand  - AppCkg"	Proj:RunResults[7]:StdElecDemand			= {	if (LocalRef( RunResults[1]:StdElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / 3.412  endif  }

  ; Plug Loads
	"Calculate TDV - Elec   - Plugs"		Proj:RunResults[8]:StdElecTDV				= {	if (LocalRef( RunResults[8]:StdElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - Plugs"		Proj:RunResults[8]:StdNatGasTDV			= {	if (LocalRef( RunResults[8]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - Plugs"		Proj:RunResults[8]:StdOtherTDV			= {	if (LocalRef( RunResults[8]:StdOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - Plugs"		Proj:RunResults[8]:StandardTDV			= {	LocalRef( RunResults[8]:StdElecTDV ) + LocalRef( RunResults[8]:StdNatGasTDV ) + LocalRef( RunResults[8]:StdOtherTDV )   }
	"Calculate Elec Demand  - Plugs"		Proj:RunResults[8]:StdElecDemand			= {	if (LocalRef( RunResults[1]:StdElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Rcp" ) / 3.412  endif  }

  ; Exterior
	"Calculate TDV - Elec   - Ext"		Proj:RunResults[9]:StdElecTDV				= {	if (LocalRef( RunResults[9]:StdElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - Ext"		Proj:RunResults[9]:StdNatGasTDV			= {	if (LocalRef( RunResults[9]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - Ext"		Proj:RunResults[9]:StdOtherTDV			= {	if (LocalRef( RunResults[9]:StdOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - Ext"		Proj:RunResults[9]:StandardTDV			= {	LocalRef( RunResults[9]:StdElecTDV ) + LocalRef( RunResults[9]:StdNatGasTDV ) + LocalRef( RunResults[9]:StdOtherTDV )   }
	"Calculate Elec Demand  - Ext"		Proj:RunResults[9]:StdElecDemand			= {	if (LocalRef( RunResults[1]:StdElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Ext" ) / 3.412  endif  }

  ; PV
   ; mods to calc NEM-adjusted PV TDV (StdElecTDV) & Elec Demand (StdElecDemand) for 2019 analysis
	"Calculate TDV - Elec   - PV"			Proj:RunResults[13]:StdElecTDV			= {	if (LocalRef( RunResults[13]:StdElecEnergy		) > -0.0001) then  0
		else if (IfValidAnd( NetEnergyMeteringTDVAdj != 0) .OR. IfValidAnd( HrlyNEMTableCol > 0 ))
      then  if (LocalRef( RunResults[14]:PropElecEnergy[1] ) = 0)
            then  int( (100 * ApplyHourlyResultMultipliers_NEM( "PVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor          ) / CondFloorArea) + 0.5) / 100
            else  int( (100 * ApplyHourlyResultMultipliers_NEM( "PVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, 1, "BT" ) / CondFloorArea) + 0.5) / 100  endif
      else        int( (100 * ApplyHourlyResultMultipliers(     "PVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV" ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate TDV - NatGas - PV"			Proj:RunResults[13]:StdNatGasTDV			= {	0  }
	"Calculate TDV - Other  - PV"			Proj:RunResults[13]:StdOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - PV"			Proj:RunResults[13]:StandardTDV			= {	LocalRef( RunResults[13]:StdElecTDV )   }
	"Calculate Elec Demand  - PV"			Proj:RunResults[13]:StdElecDemand		= {	if (LocalRef( RunResults[13]:PropElecEnergy[1]		) > -0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec", "PV" ) / 3.412  endif  }

  ; Battery
   ; mods to calc NEM-adjusted Battery TDV (StdElecTDV) & Elec Demand (StdElecDemand) for 2019 analysis
	"Calculate TDV - Elec   - Battery"	Proj:RunResults[14]:StdElecTDV			= {	if (LocalRef( RunResults[14]:StdElecEnergy		) < 0.0001) then  0
		else if (IfValidAnd( NetEnergyMeteringTDVAdj != 0) .OR. IfValidAnd( HrlyNEMTableCol > 0 ))
      then  if (LocalRef( RunResults[13]:PropElecEnergy[1] ) = 0)
            then  int( (100 * ApplyHourlyResultMultipliers_NEM( "BTTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "BT", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor          ) / CondFloorArea) + 0.5) / 100
            else  int( (100 * ApplyHourlyResultMultipliers_NEM( "BTTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "BT", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, 1, "PV" ) / CondFloorArea) + 0.5) / 100  endif
      else        int( (100 * ApplyHourlyResultMultipliers(     "BTTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "BT" ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate TDV - NatGas - Battery"	Proj:RunResults[14]:StdNatGasTDV			= {	0  }
	"Calculate TDV - Other  - Battery"	Proj:RunResults[14]:StdOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - Battery"	Proj:RunResults[14]:StandardTDV			= {	LocalRef( RunResults[14]:StdElecTDV )   }
	"Calculate Elec Demand  - Battery"	Proj:RunResults[14]:StdElecDemand		= {	if (LocalRef( RunResults[14]:StdElecEnergy		) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec", "BT" ) / 3.412  endif  }

  ; Compliance Total
  ; SAC 1/14/13 - added in PVCredit to Std (elec) TDV
; mjb-10/16/13	remove PVCredit from Std Design
	"Calculate TDV - Elec   - Comp Ttl"	Proj:RunResults[11]:StdElecTDV			= {	RunResults[1]:StdElecTDV    + RunResults[2]:StdElecTDV    + RunResults[3]:StdElecTDV    + RunResults[4]:StdElecTDV    + RunResults[5]:StdElecTDV     }
	"Calculate TDV - NatGas - Comp Ttl"	Proj:RunResults[11]:StdNatGasTDV			= {	RunResults[1]:StdNatGasTDV  + RunResults[2]:StdNatGasTDV  + RunResults[3]:StdNatGasTDV  + RunResults[4]:StdNatGasTDV  + RunResults[5]:StdNatGasTDV   }
	"Calculate TDV - Other  - Comp Ttl"	Proj:RunResults[11]:StdOtherTDV			= {	RunResults[1]:StdOtherTDV   + RunResults[2]:StdOtherTDV   + RunResults[3]:StdOtherTDV   + RunResults[4]:StdOtherTDV   + RunResults[5]:StdOtherTDV    }
	"Calculate TDV - TOTAL  - Comp Ttl"	Proj:RunResults[11]:StandardTDV			= {	RunResults[1]:StandardTDV   + RunResults[2]:StandardTDV   + RunResults[3]:StandardTDV   + RunResults[4]:StandardTDV   + RunResults[5]:StandardTDV    }
	"Calculate Elec Demand  - Comp Ttl"	Proj:RunResults[11]:StdElecDemand		= {	RunResults[1]:StdElecDemand + RunResults[2]:StdElecDemand + RunResults[3]:StdElecDemand + RunResults[4]:StdElecDemand + RunResults[5]:StdElecDemand  }

  ; Total
	"Calculate TDV - Elec   - Total"		Proj:RunResults[10]:StdElecTDV			= {	RunResults[11]:StdElecTDV    + RunResults[6]:StdElecTDV    + RunResults[7]:StdElecTDV    + RunResults[8]:StdElecTDV    + RunResults[9]:StdElecTDV    + RunResults[13]:StdElecTDV    + RunResults[14]:StdElecTDV     }
	"Calculate TDV - NatGas - Total"		Proj:RunResults[10]:StdNatGasTDV			= {	RunResults[11]:StdNatGasTDV  + RunResults[6]:StdNatGasTDV  + RunResults[7]:StdNatGasTDV  + RunResults[8]:StdNatGasTDV  + RunResults[9]:StdNatGasTDV  + RunResults[13]:StdNatGasTDV  + RunResults[14]:StdNatGasTDV   }
	"Calculate TDV - Other  - Total"		Proj:RunResults[10]:StdOtherTDV			= {	RunResults[11]:StdOtherTDV   + RunResults[6]:StdOtherTDV   + RunResults[7]:StdOtherTDV   + RunResults[8]:StdOtherTDV   + RunResults[9]:StdOtherTDV   + RunResults[13]:StdOtherTDV   + RunResults[14]:StdOtherTDV    }
	"Calculate TDV - TOTAL  - Total"		Proj:RunResults[10]:StandardTDV			= {	RunResults[11]:StandardTDV   + RunResults[6]:StandardTDV   + RunResults[7]:StandardTDV   + RunResults[8]:StandardTDV   + RunResults[9]:StandardTDV   + RunResults[13]:StandardTDV   + RunResults[14]:StandardTDV    }
	"Calculate Elec Demand  - Total"		Proj:RunResults[10]:StdElecDemand		= {	RunResults[11]:StdElecDemand + RunResults[6]:StdElecDemand + RunResults[7]:StdElecDemand + RunResults[8]:StdElecDemand + RunResults[9]:StdElecDemand + RunResults[13]:StdElecDemand + RunResults[14]:StdElecDemand  }


	; SAC 4/2/14 - moved PV credit calcs into subordinate rulelist
	"Set Proj:PVBaseTDV"						Proj:PVBaseTDV	= {	RunResults[11]:StandardTDV * CondFloorArea  }		; SAC 4/14/15 - switched from elecTotalTDV to totalCompTDV - was: RunResults[10]:StdElecTDV
	"Perform PV calcs if applicable"		Proj:Action		= {	if (PVGenCredit < 1 .OR. StandardsVersion == 2014 .OR. CondFloorArea < 0.01) then  UNCHANGED
																				else	switch ( CompCodeBase )
																							case  2013 :	EvalRulelist( "CARes_CalculatePVCredit_2013Compliance" )
																							case  2016 :	EvalRulelist( "CARes_CalculatePVCredit_2016Compliance" )
																							default    :	UNCHANGED   ; no specific PV credit for 2019 or 2022
																						endswitch  endif  }
	; SAC 4/3/15 - set new EnergyUse:PropPVCreditTDV property (needed to track & pass PVCredit from first to second Proposed EnergyUse data)
	"Store PropPVCreditTDV[1]"				Proj:RunResults[6]:PropPVCreditTDV[1]		= {	PVCredit[1]  }
; ADJUST certain Proposed results that now are to have PVCredit applied to them
; mjb-10/16/13	subtracted PVCredit from Proposed Design Elec and TOTAL 
	"Calculate TDV - Elec   - Comp Ttl"	Proj:RunResults[11]:PropElecTDV[1]			= {	RunResults[11]:PropElecTDV[1]  - PVCredit[1]  }
	"Calculate TDV - TOTAL  - Comp Ttl"	Proj:RunResults[11]:ProposedTDV[1]			= {	RunResults[11]:ProposedTDV[1]  - PVCredit[1]  }
	"Calculate TDV - Elec   - Total"		Proj:RunResults[10]:PropElecTDV[1]			= {	RunResults[10]:PropElecTDV[1]  - PVCredit[1]  }
	"Calculate TDV - TOTAL  - Total"		Proj:RunResults[10]:ProposedTDV[1]			= {	RunResults[10]:ProposedTDV[1]  - PVCredit[1]  }


  ; Compliance Margins
	"Calc TDV Comp Margin - SpcHt"    	Proj:RunResults[1]:CompMarginTDV		= {	LocalRef( RunResults[1]:StandardTDV  ) - LocalRef( RunResults[1]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - SpcCl"    	Proj:RunResults[2]:CompMarginTDV		= {	LocalRef( RunResults[2]:StandardTDV  ) - LocalRef( RunResults[2]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - IAQVent"  	Proj:RunResults[3]:CompMarginTDV		= {	LocalRef( RunResults[3]:StandardTDV  ) - LocalRef( RunResults[3]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - OthrHVAC" 	Proj:RunResults[4]:CompMarginTDV		= {	LocalRef( RunResults[4]:StandardTDV  ) - LocalRef( RunResults[4]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - WtrHt"    	Proj:RunResults[5]:CompMarginTDV		= {	LocalRef( RunResults[5]:StandardTDV  ) - LocalRef( RunResults[5]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - InsLtg"   	Proj:RunResults[6]:CompMarginTDV		= {	LocalRef( RunResults[6]:StandardTDV  ) - LocalRef( RunResults[6]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - AppCkg"   	Proj:RunResults[7]:CompMarginTDV		= {	LocalRef( RunResults[7]:StandardTDV  ) - LocalRef( RunResults[7]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - Plugs"    	Proj:RunResults[8]:CompMarginTDV		= {	LocalRef( RunResults[8]:StandardTDV  ) - LocalRef( RunResults[8]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - Ext"      	Proj:RunResults[9]:CompMarginTDV		= {	LocalRef( RunResults[9]:StandardTDV  ) - LocalRef( RunResults[9]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - PV"      	Proj:RunResults[13]:CompMarginTDV	= {	LocalRef( RunResults[13]:StandardTDV ) - LocalRef( RunResults[13]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - Battery"    Proj:RunResults[14]:CompMarginTDV	= {	LocalRef( RunResults[14]:StandardTDV ) - LocalRef( RunResults[14]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - Total"    	Proj:RunResults[10]:CompMarginTDV	= {	LocalRef( RunResults[10]:StandardTDV ) - LocalRef( RunResults[10]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - Comp Ttl" 	Proj:RunResults[11]:CompMarginTDV	= {	LocalRef( RunResults[11]:StandardTDV ) - LocalRef( RunResults[11]:ProposedTDV[1] )   }

  ; Percent Improvement
	"Calc TDV Pct Improve - SpcHt"    	Proj:RunResults[1]:PctImproveTDV		= {	if (LocalRef( RunResults[1]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResults[1]:CompMarginTDV  ) * 100 / LocalRef( RunResults[1]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - SpcCl"    	Proj:RunResults[2]:PctImproveTDV		= {	if (LocalRef( RunResults[2]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResults[2]:CompMarginTDV  ) * 100 / LocalRef( RunResults[2]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - IAQVent"  	Proj:RunResults[3]:PctImproveTDV		= {	if (LocalRef( RunResults[3]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResults[3]:CompMarginTDV  ) * 100 / LocalRef( RunResults[3]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - OthrHVAC" 	Proj:RunResults[4]:PctImproveTDV		= {	if (LocalRef( RunResults[4]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResults[4]:CompMarginTDV  ) * 100 / LocalRef( RunResults[4]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - WtrHt"    	Proj:RunResults[5]:PctImproveTDV		= {	if (LocalRef( RunResults[5]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResults[5]:CompMarginTDV  ) * 100 / LocalRef( RunResults[5]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - InsLtg"   	Proj:RunResults[6]:PctImproveTDV		= {	if (LocalRef( RunResults[6]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResults[6]:CompMarginTDV  ) * 100 / LocalRef( RunResults[6]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - AppCkg"   	Proj:RunResults[7]:PctImproveTDV		= {	if (LocalRef( RunResults[7]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResults[7]:CompMarginTDV  ) * 100 / LocalRef( RunResults[7]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - Plugs"    	Proj:RunResults[8]:PctImproveTDV		= {	if (LocalRef( RunResults[8]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResults[8]:CompMarginTDV  ) * 100 / LocalRef( RunResults[8]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - Ext"      	Proj:RunResults[9]:PctImproveTDV		= {	if (LocalRef( RunResults[9]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResults[9]:CompMarginTDV  ) * 100 / LocalRef( RunResults[9]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - PV"      	Proj:RunResults[13]:PctImproveTDV	= {	if (LocalRef( RunResults[13]:StandardTDV ) == 0) then  0  else  LocalRef( RunResults[13]:CompMarginTDV ) * 100 / LocalRef( RunResults[13]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - Battery"    Proj:RunResults[14]:PctImproveTDV	= {	if (LocalRef( RunResults[14]:StandardTDV ) == 0) then  0  else  LocalRef( RunResults[14]:CompMarginTDV ) * 100 / LocalRef( RunResults[14]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - Total"    	Proj:RunResults[10]:PctImproveTDV	= {	if (LocalRef( RunResults[10]:StandardTDV ) == 0) then  0  else  LocalRef( RunResults[10]:CompMarginTDV ) * 100 / LocalRef( RunResults[10]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - Comp Ttl"  	Proj:RunResults[11]:PctImproveTDV	= {	if (LocalRef( RunResults[11]:StandardTDV ) == 0) then  0  else  LocalRef( RunResults[11]:CompMarginTDV ) * 100 / LocalRef( RunResults[11]:StandardTDV )  endif  }

  ; Delta Demand   - SAC 8/23/14
	"Calc Delta El Demand - SpcHt"    	Proj:RunResults[1]:DeltaDemand		= {	LocalRef( RunResults[1]:StdElecDemand  ) - LocalRef( RunResults[1]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - SpcCl"    	Proj:RunResults[2]:DeltaDemand		= {	LocalRef( RunResults[2]:StdElecDemand  ) - LocalRef( RunResults[2]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - IAQVent"  	Proj:RunResults[3]:DeltaDemand		= {	LocalRef( RunResults[3]:StdElecDemand  ) - LocalRef( RunResults[3]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - OthrHVAC" 	Proj:RunResults[4]:DeltaDemand		= {	LocalRef( RunResults[4]:StdElecDemand  ) - LocalRef( RunResults[4]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - WtrHt"    	Proj:RunResults[5]:DeltaDemand		= {	LocalRef( RunResults[5]:StdElecDemand  ) - LocalRef( RunResults[5]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - InsLtg"   	Proj:RunResults[6]:DeltaDemand		= {	LocalRef( RunResults[6]:StdElecDemand  ) - LocalRef( RunResults[6]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - AppCkg"   	Proj:RunResults[7]:DeltaDemand		= {	LocalRef( RunResults[7]:StdElecDemand  ) - LocalRef( RunResults[7]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - Plugs"    	Proj:RunResults[8]:DeltaDemand		= {	LocalRef( RunResults[8]:StdElecDemand  ) - LocalRef( RunResults[8]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - Ext"      	Proj:RunResults[9]:DeltaDemand		= {	LocalRef( RunResults[9]:StdElecDemand  ) - LocalRef( RunResults[9]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - PV"      	Proj:RunResults[13]:DeltaDemand		= {	LocalRef( RunResults[13]:StdElecDemand ) - LocalRef( RunResults[13]:PropElecDemand[1] )   }
	"Calc Delta El Demand - Battery"    Proj:RunResults[14]:DeltaDemand		= {	LocalRef( RunResults[14]:StdElecDemand ) - LocalRef( RunResults[14]:PropElecDemand[1] )   }
	"Calc Delta El Demand - Total"    	Proj:RunResults[10]:DeltaDemand		= {	LocalRef( RunResults[10]:StdElecDemand ) - LocalRef( RunResults[10]:PropElecDemand[1] )   }
	"Calc Delta El Demand - Comp Ttl" 	Proj:RunResults[11]:DeltaDemand		= {	LocalRef( RunResults[11]:StdElecDemand ) - LocalRef( RunResults[11]:PropElecDemand[1] )   }

END

;************************************************************************* SAC 07/20/23 (2025)
RULELIST "CARes_StandardTDVResults_PVonly" 1 0 0 1
;*************************************************************************
  ; PV
   ; mods to calc NEM-adjusted PV TDV (StdElecTDV) & Elec Demand (StdElecDemand) for 2019 analysis
	"Calculate TDV - Elec   - PV"			Proj:RunResults[13]:StdElecTDV			= {	if (LocalRef( RunResults[13]:StdElecEnergy		) > -0.0001) then  0
		else if (IfValidAnd( NetEnergyMeteringTDVAdj != 0) .OR. IfValidAnd( HrlyNEMTableCol > 0 ))
      then  if (LocalRef( RunResults[14]:PropElecEnergy[1] ) = 0)
            then  int( (100 * ApplyHourlyResultMultipliers_NEM( "PVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor          ) / CondFloorArea) + 0.5) / 100
            else  int( (100 * ApplyHourlyResultMultipliers_NEM( "PVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, 1, "BT" ) / CondFloorArea) + 0.5) / 100  endif
      else        int( (100 * ApplyHourlyResultMultipliers(     "PVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV" ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate TDV - NatGas - PV"			Proj:RunResults[13]:StdNatGasTDV			= {	0  }
	"Calculate TDV - Other  - PV"			Proj:RunResults[13]:StdOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - PV"			Proj:RunResults[13]:StandardTDV			= {	LocalRef( RunResults[13]:StdElecTDV )   }
	"Calculate Elec Demand  - PV"			Proj:RunResults[13]:StdElecDemand		= {	if (LocalRef( RunResults[13]:PropElecEnergy[1]		) > -0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec", "PV" ) / 3.412  endif  }

  ; Compliance Total
	"Calculate TDV - Elec   - Comp Ttl"	Proj:RunResults[11]:StdElecTDV			= {	RunResults[1]:StdElecTDV    + RunResults[2]:StdElecTDV    + RunResults[3]:StdElecTDV    + RunResults[4]:StdElecTDV    + RunResults[5]:StdElecTDV     }
	"Calculate TDV - NatGas - Comp Ttl"	Proj:RunResults[11]:StdNatGasTDV			= {	RunResults[1]:StdNatGasTDV  + RunResults[2]:StdNatGasTDV  + RunResults[3]:StdNatGasTDV  + RunResults[4]:StdNatGasTDV  + RunResults[5]:StdNatGasTDV   }
	"Calculate TDV - Other  - Comp Ttl"	Proj:RunResults[11]:StdOtherTDV			= {	RunResults[1]:StdOtherTDV   + RunResults[2]:StdOtherTDV   + RunResults[3]:StdOtherTDV   + RunResults[4]:StdOtherTDV   + RunResults[5]:StdOtherTDV    }
	"Calculate TDV - TOTAL  - Comp Ttl"	Proj:RunResults[11]:StandardTDV			= {	RunResults[1]:StandardTDV   + RunResults[2]:StandardTDV   + RunResults[3]:StandardTDV   + RunResults[4]:StandardTDV   + RunResults[5]:StandardTDV    }
	"Calculate Elec Demand  - Comp Ttl"	Proj:RunResults[11]:StdElecDemand		= {	RunResults[1]:StdElecDemand + RunResults[2]:StdElecDemand + RunResults[3]:StdElecDemand + RunResults[4]:StdElecDemand + RunResults[5]:StdElecDemand  }

  ; Total
	"Calculate TDV - Elec   - Total"		Proj:RunResults[10]:StdElecTDV			= {	RunResults[11]:StdElecTDV    + RunResults[6]:StdElecTDV    + RunResults[7]:StdElecTDV    + RunResults[8]:StdElecTDV    + RunResults[9]:StdElecTDV    + RunResults[13]:StdElecTDV    + RunResults[14]:StdElecTDV     }
	"Calculate TDV - NatGas - Total"		Proj:RunResults[10]:StdNatGasTDV			= {	RunResults[11]:StdNatGasTDV  + RunResults[6]:StdNatGasTDV  + RunResults[7]:StdNatGasTDV  + RunResults[8]:StdNatGasTDV  + RunResults[9]:StdNatGasTDV  + RunResults[13]:StdNatGasTDV  + RunResults[14]:StdNatGasTDV   }
	"Calculate TDV - Other  - Total"		Proj:RunResults[10]:StdOtherTDV			= {	RunResults[11]:StdOtherTDV   + RunResults[6]:StdOtherTDV   + RunResults[7]:StdOtherTDV   + RunResults[8]:StdOtherTDV   + RunResults[9]:StdOtherTDV   + RunResults[13]:StdOtherTDV   + RunResults[14]:StdOtherTDV    }
	"Calculate TDV - TOTAL  - Total"		Proj:RunResults[10]:StandardTDV			= {	RunResults[11]:StandardTDV   + RunResults[6]:StandardTDV   + RunResults[7]:StandardTDV   + RunResults[8]:StandardTDV   + RunResults[9]:StandardTDV   + RunResults[13]:StandardTDV   + RunResults[14]:StandardTDV    }
	"Calculate Elec Demand  - Total"		Proj:RunResults[10]:StdElecDemand		= {	RunResults[11]:StdElecDemand + RunResults[6]:StdElecDemand + RunResults[7]:StdElecDemand + RunResults[8]:StdElecDemand + RunResults[9]:StdElecDemand + RunResults[13]:StdElecDemand + RunResults[14]:StdElecDemand  }


; not applicable to 2019+ vintages...
;	; SAC 4/2/14 - moved PV credit calcs into subordinate rulelist
;	"Set Proj:PVBaseTDV"						Proj:PVBaseTDV	= {	RunResults[11]:StandardTDV * CondFloorArea  }		; SAC 4/14/15 - switched from elecTotalTDV to totalCompTDV - was: RunResults[10]:StdElecTDV
;	"Perform PV calcs if applicable"		Proj:Action		= {	if (PVGenCredit < 1 .OR. StandardsVersion == 2014 .OR. CondFloorArea < 0.01) then  UNCHANGED
;																				else	switch ( CompCodeBase )
;																							case  2013 :	EvalRulelist( "CARes_CalculatePVCredit_2013Compliance" )
;																							case  2016 :	EvalRulelist( "CARes_CalculatePVCredit_2016Compliance" )
;																							default    :	UNCHANGED   ; no specific PV credit for 2019 or 2022
;																						endswitch  endif  }
;	; SAC 4/3/15 - set new EnergyUse:PropPVCreditTDV property (needed to track & pass PVCredit from first to second Proposed EnergyUse data)
;	"Store PropPVCreditTDV[1]"				Proj:RunResults[6]:PropPVCreditTDV[1]		= {	PVCredit[1]  }
;; ADJUST certain Proposed results that now are to have PVCredit applied to them
;; mjb-10/16/13	subtracted PVCredit from Proposed Design Elec and TOTAL 
;	"Calculate TDV - Elec   - Comp Ttl"	Proj:RunResults[11]:PropElecTDV[1]			= {	RunResults[11]:PropElecTDV[1]  - PVCredit[1]  }
;	"Calculate TDV - TOTAL  - Comp Ttl"	Proj:RunResults[11]:ProposedTDV[1]			= {	RunResults[11]:ProposedTDV[1]  - PVCredit[1]  }
;	"Calculate TDV - Elec   - Total"		Proj:RunResults[10]:PropElecTDV[1]			= {	RunResults[10]:PropElecTDV[1]  - PVCredit[1]  }
;	"Calculate TDV - TOTAL  - Total"		Proj:RunResults[10]:ProposedTDV[1]			= {	RunResults[10]:ProposedTDV[1]  - PVCredit[1]  }


  ; Compliance Margins
	"Calc TDV Comp Margin - PV"      	Proj:RunResults[13]:CompMarginTDV	= {	LocalRef( RunResults[13]:StandardTDV ) - LocalRef( RunResults[13]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - Total"    	Proj:RunResults[10]:CompMarginTDV	= {	LocalRef( RunResults[10]:StandardTDV ) - LocalRef( RunResults[10]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - Comp Ttl" 	Proj:RunResults[11]:CompMarginTDV	= {	LocalRef( RunResults[11]:StandardTDV ) - LocalRef( RunResults[11]:ProposedTDV[1] )   }

  ; Percent Improvement
	"Calc TDV Pct Improve - PV"      	Proj:RunResults[13]:PctImproveTDV	= {	if (LocalRef( RunResults[13]:StandardTDV ) == 0) then  0  else  LocalRef( RunResults[13]:CompMarginTDV ) * 100 / LocalRef( RunResults[13]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - Total"    	Proj:RunResults[10]:PctImproveTDV	= {	if (LocalRef( RunResults[10]:StandardTDV ) == 0) then  0  else  LocalRef( RunResults[10]:CompMarginTDV ) * 100 / LocalRef( RunResults[10]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - Comp Ttl"  	Proj:RunResults[11]:PctImproveTDV	= {	if (LocalRef( RunResults[11]:StandardTDV ) == 0) then  0  else  LocalRef( RunResults[11]:CompMarginTDV ) * 100 / LocalRef( RunResults[11]:StandardTDV )  endif  }

END

;*************************************************************************
RULELIST "CARes_DesignRatingTDVResults" 1 0 0 1
;*************************************************************************

	"Store DRtg Proposed TDV-multiplied results"		Proj:Action = {	EvalRulelist( "CARes_DRtgPropMultTDVResults" )  }		; SAC 3/14/16

; 1,           "DesignRatingTDV",   BEMP_Flt,  1,  0,  0, "kTDV/ft2-yr",      0,  0,             39110, "Design Rating TDV run result for this enduse" 
; 1,           "DRtgPctSavTDV",     BEMP_Flt,  1,  0,  0, "%",                0,  0,             39110, "Percent improvement (DesignRtg -> Prop TDV) for this enduse" 
; 1,           "DRtgDeltaDemand",   BEMP_Flt,  1,  0,  0, "kW",               0,  0,             39110, "Difference (DRtg-Prop elec demand) for this enduse" 

; 1,           "DRtgElecEnergy",    BEMP_Flt,  1,  0,  0, "kBTU/ft2-yr",      0,  0,             39110, "Design Rating run Eletric energy use for this enduse" 
; 1,           "DRtgNatGasEnergy",  BEMP_Flt,  1,  0,  0, "kBTU/ft2-yr",      0,  0,             39110, "Design Rating run Natural Gas energy use for this enduse" 
; 1,           "DRtgOtherEnergy",   BEMP_Flt,  1,  0,  0, "kBTU/ft2-yr",      0,  0,             39110, "Design Rating run Other Fuel energy use for this enduse" 
; 1,           "DRtgTotalEnergy",   BEMP_Flt,  1,  0,  0, "kBTU/ft2-yr",      0,  0,             39110, "Design Rating run TOTAL energy use for this enduse" 
; 
; 1,           "DRtgElecTDV",       BEMP_Flt,  1,  0,  0, "kTDV/ft2-yr",      0,  0,             39110, "Design Rating run Eletric TDV for this enduse" 
; 1,           "DRtgNatGasTDV",     BEMP_Flt,  1,  0,  0, "kTDV/ft2-yr",      0,  0,             39110, "Design Rating run Natural Gas TDV for this enduse" 
; 1,           "DRtgOtherTDV",      BEMP_Flt,  1,  0,  0, "kTDV/ft2-yr",      0,  0,             39110, "Design Rating run Other Fuel TDV for this enduse" 
; 
; 1,           "DRtgElecDemand",    BEMP_Flt,  1,  0,  0, "kW",               0,  0,             39110, "Design Rating run Eletric TDV for this enduse" 

; SAC 3/31/16 - added rules to set RunResults[*]:DesignRatingTDV[2] to set fuel-adjusted design rating TDV for use in setting design rating score
; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
         ; SAC 8/24/19 - replaced 1/3.413 & 0.01 TDV table multipliers with Proj:TDVSecMult_Elec & TDVSecMult_Fuel to accommodate 2022+ switch to native (E3) TDV table units
         ; SAC 8/26/19 - added primary table multipliers (of 1.0) to all ApplyHourlyResultMult* function calls (to accommodate 2022+ TDV table unit switch)
  ; Space Heating (& heating fan)
	"Calculate TDV - Elec   - SpcHt"		Proj:RunResults[1]:DRtgElecTDV			= {	if (LocalRef( RunResults[1]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - SpcHt"		Proj:RunResults[1]:DRtgNatGasTDV			= {	if (LocalRef( RunResults[1]:DRtgNatGasEnergy		) < 0.0001) then  0                                                                                                        
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - SpcHt"		Proj:RunResults[1]:DRtgOtherTDV			= {	if (LocalRef( RunResults[1]:DRtgOtherEnergy		) < 0.0001) then  0                                                                                                        
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - SpcHt"		Proj:RunResults[1]:DesignRatingTDV[1]	= {	LocalRef( RunResults[1]:DRtgElecTDV ) + LocalRef( RunResults[1]:DRtgNatGasTDV ) + LocalRef( RunResults[1]:DRtgOtherTDV )   }
	"Calculate TDV - TOTAL  - SpcHt"		Proj:RunResults[1]:DesignRatingTDV[2]	= {	if (T24R_EDRFuelAdjustment:SpcHtg( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr, "Metric", TDVEDRFuelMultMetric ) > 0)
																												then	LocalRef( RunResults[1]:DRtgElecTDV ) + ((LocalRef( RunResults[1]:DRtgNatGasTDV ) + LocalRef( RunResults[1]:DRtgOtherTDV )) /
																																												T24R_EDRFuelAdjustment:SpcHtg( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr, "Metric", TDVEDRFuelMultMetric ))
																												else	RunResults[1]:DesignRatingTDV[1]  endif   }
	"Calculate Elec Demand  - SpcHt"		Proj:RunResults[1]:DRtgElecDemand		= {	if (LocalRef( RunResults[1]:DRtgElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / 3.412  endif  }

  ; Space Cooling (& cooling fan)
	"Calculate TDV - Elec   - SpcCl"		Proj:RunResults[2]:DRtgElecTDV			= {	if (LocalRef( RunResults[2]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - SpcCl"		Proj:RunResults[2]:DRtgNatGasTDV			= {	if (LocalRef( RunResults[2]:DRtgNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - SpcCl"		Proj:RunResults[2]:DRtgOtherTDV			= {	if (LocalRef( RunResults[2]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - SpcCl"		Proj:RunResults[2]:DesignRatingTDV[1]	= {	LocalRef( RunResults[2]:DRtgElecTDV ) + LocalRef( RunResults[2]:DRtgNatGasTDV ) + LocalRef( RunResults[2]:DRtgOtherTDV )   }
;"dbg" Proj:Action = { PostMessageToLog( "   Setting RunResults[2]:DesignRatingTDV[2] based on T24R_EDRFuelAdjustment:SpcClg( CZ %g, CodeBase %g, BldgType %s, Metric %s ) => %g", ClimateZone, CompCodeBase, BldgTypeTblStr, TDVEDRFuelMultMetric, T24R_EDRFuelAdjustment:SpcClg( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr, "Metric", TDVEDRFuelMultMetric ) )  }
	"Calculate TDV - TOTAL  - SpcCl"		Proj:RunResults[2]:DesignRatingTDV[2]	= {	if (T24R_EDRFuelAdjustment:SpcClg( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr, "Metric", TDVEDRFuelMultMetric ) > 0)
																												then	LocalRef( RunResults[2]:DRtgElecTDV ) + ((LocalRef( RunResults[2]:DRtgNatGasTDV ) + LocalRef( RunResults[2]:DRtgOtherTDV )) /
																																												T24R_EDRFuelAdjustment:SpcClg( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr, "Metric", TDVEDRFuelMultMetric ))
																												else	RunResults[2]:DesignRatingTDV[1]  endif   }
	"Calculate Elec Demand  - SpcCl"		Proj:RunResults[2]:DRtgElecDemand		= {	if (LocalRef( RunResults[2]:DRtgElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Clg", "FanC" ) / 3.412  endif  }

  ; IAQ Ventilation Fans
	"Calculate TDV - Elec   - IAQVent"	Proj:RunResults[3]:DRtgElecTDV			= {	if (LocalRef( RunResults[3]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "IAQVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "FanV" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - IAQVent"	Proj:RunResults[3]:DRtgNatGasTDV			= {	0  }
	"Calculate TDV - Other  - IAQVent"	Proj:RunResults[3]:DRtgOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - IAQVent"	Proj:RunResults[3]:DesignRatingTDV[1]	= {	LocalRef( RunResults[3]:DRtgElecTDV )   }
	"Calculate TDV - TOTAL  - IAQVent"	Proj:RunResults[3]:DesignRatingTDV[2]	= {	LocalRef( RunResults[3]:DRtgElecTDV )   }
	"Calculate Elec Demand  - IAQVent"	Proj:RunResults[3]:DRtgElecDemand		= {	if (LocalRef( RunResults[3]:DRtgElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "FanV" ) / 3.412  endif  }

  ; Other HVAC (aux & misc fans)
   ; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
   ; SAC 11/15/18 - restored "Other HVAC" [4] to handle VCHP CFan via "User1" enduse
	"Calculate TDV - Elec   - OthrHVAC"	Proj:RunResults[4]:DRtgElecTDV			= {	if (LocalRef( RunResults[4]:DRtgElecEnergy ) < 0.0001 .AND. OthrHVAC_SpcHtFrac == 0) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "OHVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "User1" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - OthrHVAC"	Proj:RunResults[4]:DRtgNatGasTDV			= {	0  }
	"Calculate TDV - Other  - OthrHVAC"	Proj:RunResults[4]:DRtgOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - OthrHVAC"	Proj:RunResults[4]:DesignRatingTDV[1]	= {	LocalRef( RunResults[4]:DRtgElecTDV )  }
	"Calculate TDV - TOTAL  - OthrHVAC"	Proj:RunResults[4]:DesignRatingTDV[2]	= {	RunResults[4]:DesignRatingTDV[1]  }
	"Calculate Elec Demand  - OthrHVAC"	Proj:RunResults[4]:DRtgElecDemand		= {	if (LocalRef( RunResults[4]:DRtgElecEnergy ) < 0.0001 .AND. OthrHVAC_SpcHtFrac == 0) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "User1" ) / 3.412  endif  }

; SAC 1/27/19 - REDISTRIBUTE OthrHVAC DRtg TDV across SpcHt & SpcCl by fuel based on ratio of total TDV (across all fuels) (tic #1053)
   "Set OthrHVAC_SpcHtFrac - DRtgTDV"     Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResults[4]:DesignRatingTDV[1] != 0 )==0) then  0
                                                                        else if (IfValidAnd( RunResults[1]:DesignRatingTDV[1] == 0 ) .AND.
                                                                                 IfValidAnd( RunResults[2]:DesignRatingTDV[1] == 0 )) then  0.5
                                                                        else   ValidOr( RunResults[1]:DesignRatingTDV[1], 0 ) / 
                                                                              (ValidOr( RunResults[1]:DesignRatingTDV[1], 0 ) + ValidOr( RunResults[2]:DesignRatingTDV[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Elec   - SpcHt"    Proj:RunResults[1]:DRtgElecTDV[1]	   = {   if (IfValidAnd( RunResults[4]:DRtgElecTDV[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[1]:DRtgElecTDV[1] + (RunResults[4]:DRtgElecTDV[1]     * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - TOTAL  - SpcHt"		Proj:RunResults[1]:DesignRatingTDV[1]	= {	LocalRef( RunResults[1]:DRtgElecTDV[1] ) + LocalRef( RunResults[1]:DRtgNatGasTDV[1] ) + LocalRef( RunResults[1]:DRtgOtherTDV[1] )   }
	"REALLOC OthrHVAC - TOTAL  - SpcHt"		Proj:RunResults[1]:DesignRatingTDV[2]	= {	if (T24R_EDRFuelAdjustment:SpcHtg( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr, "Metric", TDVEDRFuelMultMetric ) > 0)
   																												then	LocalRef( RunResults[1]:DRtgElecTDV ) + ((LocalRef( RunResults[1]:DRtgNatGasTDV ) + LocalRef( RunResults[1]:DRtgOtherTDV )) /
	   																																											T24R_EDRFuelAdjustment:SpcHtg( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr, "Metric", TDVEDRFuelMultMetric ))
		   																										else	RunResults[1]:DesignRatingTDV[1]  endif   }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Elec   - SpcCl"		Proj:RunResults[2]:DRtgElecTDV[1]	   = {   if (IfValidAnd( RunResults[4]:DRtgElecTDV[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResults[2]:DRtgElecTDV[1] + (RunResults[4]:DRtgElecTDV[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - TOTAL  - SpcCl"		Proj:RunResults[2]:DesignRatingTDV[1]	= {	LocalRef( RunResults[2]:DRtgElecTDV[1] ) + LocalRef( RunResults[2]:DRtgNatGasTDV[1] ) + LocalRef( RunResults[2]:DRtgOtherTDV[1] )   }
	"REALLOC OthrHVAC - TOTAL  - SpcCl"		Proj:RunResults[2]:DesignRatingTDV[2]	= {	if (T24R_EDRFuelAdjustment:SpcClg( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr, "Metric", TDVEDRFuelMultMetric ) > 0)
																												   then	LocalRef( RunResults[2]:DRtgElecTDV ) + ((LocalRef( RunResults[2]:DRtgNatGasTDV ) + LocalRef( RunResults[2]:DRtgOtherTDV )) /
																													   															T24R_EDRFuelAdjustment:SpcClg( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr, "Metric", TDVEDRFuelMultMetric ))
																												   else	RunResults[2]:DesignRatingTDV[1]  endif   }
   ; SAC 1/27/19 - REDISTRIBUTE OthrHVAC Prop Demand across SpcHt & SpcCl by fuel based on ratio of total Demand (tic #1053)
   "Set OthrHVAC_SpcHtFrac - DRtgDemand"  Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResults[4]:DRtgElecDemand[1] != 0 )==0) then  0
                                                                        else if (IfValidAnd( RunResults[1]:DRtgElecDemand[1] == 0 ) .AND.
                                                                                 IfValidAnd( RunResults[2]:DRtgElecDemand[1] == 0 )) then  0.5
                                                                        else   ValidOr( RunResults[1]:DRtgElecDemand[1], 0 ) / 
                                                                              (ValidOr( RunResults[1]:DRtgElecDemand[1], 0 ) + ValidOr( RunResults[2]:DRtgElecDemand[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Demand - SpcHt"		Proj:RunResults[1]:DRtgElecDemand[1] = {  if (IfValidAnd( RunResults[4]:DRtgElecDemand[1] != 0 )==0) then  UNCHANGED
                                                                                    else  RunResults[1]:DRtgElecDemand[1] + (RunResults[4]:DRtgElecDemand[1]     * OthrHVAC_SpcHtFrac)  endif  }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Demand - SpcCl"		Proj:RunResults[2]:DRtgElecDemand[1] = {  if (IfValidAnd( RunResults[4]:DRtgElecDemand[1] != 0 )==0) then  UNCHANGED
                                                                                    else  RunResults[2]:DRtgElecDemand[1] + (RunResults[4]:DRtgElecDemand[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
  ; Other HVAC (aux & misc fans)
	"ZERO-OUT         - Elec   - OthrHVAC"	Proj:RunResults[4]:DRtgElecTDV[1]	   = {	0  }
	"ZERO-OUT         - NatGas - OthrHVAC"	Proj:RunResults[4]:DRtgNatGasTDV[1]	   = {	0  }
	"ZERO-OUT         - Other  - OthrHVAC"	Proj:RunResults[4]:DRtgOtherTDV[1]	   = {	0  }
	"ZERO-OUT         - TOTAL  - OthrHVAC"	Proj:RunResults[4]:DesignRatingTDV[1]	= {	0  }
	"ZERO-OUT         - TOTAL  - OthrHVAC"	Proj:RunResults[4]:DesignRatingTDV[2]	= {	0  }
	"ZERO-OUT         - Demand - OthrHVAC"	Proj:RunResults[4]:DRtgElecDemand[1]   = {	0  }
   ; SAC 1/27/19 - end of - redistribution of OthrHVAC PropTDV

  ; Water Heating
	"Calculate TDV - Elec   - WtrHt"		Proj:RunResults[5]:DRtgElecTDV			= {	if (LocalRef( RunResults[5]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																						else if (CSEinclDHWMFL_EU)
			 			  																						then  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / CondFloorArea) + 0.5) / 100
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate TDV - NatGas - WtrHt"		Proj:RunResults[5]:DRtgNatGasTDV			= {	if (LocalRef( RunResults[5]:DRtgNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - WtrHt"		Proj:RunResults[5]:DRtgOtherTDV			= {	if (LocalRef( RunResults[5]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - WtrHt"		Proj:RunResults[5]:DesignRatingTDV[1]	= {	LocalRef( RunResults[5]:DRtgElecTDV ) + LocalRef( RunResults[5]:DRtgNatGasTDV ) + LocalRef( RunResults[5]:DRtgOtherTDV )   }
	"Calculate TDV - TOTAL  - WtrHt"		Proj:RunResults[5]:DesignRatingTDV[2]	= {	if (T24R_EDRFuelAdjustment:WtrHtg( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr, "Metric", TDVEDRFuelMultMetric ) > 0)
																												then	LocalRef( RunResults[5]:DRtgElecTDV ) + ((LocalRef( RunResults[5]:DRtgNatGasTDV ) + LocalRef( RunResults[5]:DRtgOtherTDV )) / 
																																												T24R_EDRFuelAdjustment:WtrHtg( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr, "Metric", TDVEDRFuelMultMetric ))
																												else	RunResults[5]:DesignRatingTDV[1]  endif   }
	"Calculate Elec Demand  - WtrHt"		Proj:RunResults[5]:DRtgElecDemand		= {	if (LocalRef( RunResults[5]:DRtgElecEnergy	) < 0.0001) then  0
			 			  																						else if (CSEinclDHWMFL_EU)
			 			  																						then  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / 3.412
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / 3.412  endif endif  }

  ; Inside Lighting
	"Calculate TDV - Elec   - InsLtg"	Proj:RunResults[6]:DRtgElecTDV			= {	if (LocalRef( RunResults[6]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - InsLtg"	Proj:RunResults[6]:DRtgNatGasTDV			= {	if (LocalRef( RunResults[6]:DRtgNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - InsLtg"	Proj:RunResults[6]:DRtgOtherTDV			= {	if (LocalRef( RunResults[6]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - InsLtg"	Proj:RunResults[6]:DesignRatingTDV[1]	= {	LocalRef( RunResults[6]:DRtgElecTDV ) + LocalRef( RunResults[6]:DRtgNatGasTDV ) + LocalRef( RunResults[6]:DRtgOtherTDV )   }
	"Calculate TDV - TOTAL  - InsLtg"	Proj:RunResults[6]:DesignRatingTDV[2]	= {	RunResults[6]:DesignRatingTDV[1]   }
	"Calculate Elec Demand  - InsLtg"	Proj:RunResults[6]:DRtgElecDemand		= {	if (LocalRef( RunResults[6]:DRtgElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Lit" ) / 3.412  endif  }

  ; Appliances & Cooking
	"Calculate TDV - Elec   - AppCkg"	Proj:RunResults[7]:DRtgElecTDV			= {	if (LocalRef( RunResults[7]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - AppCkg"	Proj:RunResults[7]:DRtgNatGasTDV			= {	if (LocalRef( RunResults[7]:DRtgNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - AppCkg"	Proj:RunResults[7]:DRtgOtherTDV			= {	if (LocalRef( RunResults[7]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - AppCkg"	Proj:RunResults[7]:DesignRatingTDV[1]	= {	LocalRef( RunResults[7]:DRtgElecTDV ) + LocalRef( RunResults[7]:DRtgNatGasTDV ) + LocalRef( RunResults[7]:DRtgOtherTDV )   }
	"Calculate TDV - TOTAL  - AppCkg"	Proj:RunResults[7]:DesignRatingTDV[2]	= {	if (T24R_EDRFuelAdjustment:AppCkg( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr, "Metric", TDVEDRFuelMultMetric ) > 0)
																												then	LocalRef( RunResults[7]:DRtgElecTDV ) + ((LocalRef( RunResults[7]:DRtgNatGasTDV ) + LocalRef( RunResults[7]:DRtgOtherTDV )) /
																																												T24R_EDRFuelAdjustment:AppCkg( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr, "Metric", TDVEDRFuelMultMetric ))
																												else	RunResults[5]:DesignRatingTDV[1]  endif   }
	"Calculate Elec Demand  - AppCkg"	Proj:RunResults[7]:DRtgElecDemand		= {	if (LocalRef( RunResults[7]:DRtgElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / 3.412  endif  }

  ; Plug Loads
	"Calculate TDV - Elec   - Plugs"		Proj:RunResults[8]:DRtgElecTDV			= {	if (LocalRef( RunResults[8]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - Plugs"		Proj:RunResults[8]:DRtgNatGasTDV			= {	if (LocalRef( RunResults[8]:DRtgNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - Plugs"		Proj:RunResults[8]:DRtgOtherTDV			= {	if (LocalRef( RunResults[8]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - Plugs"		Proj:RunResults[8]:DesignRatingTDV[1]	= {	LocalRef( RunResults[8]:DRtgElecTDV ) + LocalRef( RunResults[8]:DRtgNatGasTDV ) + LocalRef( RunResults[8]:DRtgOtherTDV )   }
	"Calculate TDV - TOTAL  - Plugs"		Proj:RunResults[8]:DesignRatingTDV[2]	= {	RunResults[8]:DesignRatingTDV[1]   }
	"Calculate Elec Demand  - Plugs"		Proj:RunResults[8]:DRtgElecDemand		= {	if (LocalRef( RunResults[8]:DRtgElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Rcp" ) / 3.412  endif  }

  ; Exterior
	"Calculate TDV - Elec   - Ext"		Proj:RunResults[9]:DRtgElecTDV			= {	if (LocalRef( RunResults[9]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - Ext"		Proj:RunResults[9]:DRtgNatGasTDV			= {	if (LocalRef( RunResults[9]:DRtgNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - Ext"		Proj:RunResults[9]:DRtgOtherTDV			= {	if (LocalRef( RunResults[9]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - Ext"		Proj:RunResults[9]:DesignRatingTDV[1]	= {	LocalRef( RunResults[9]:DRtgElecTDV ) + LocalRef( RunResults[9]:DRtgNatGasTDV ) + LocalRef( RunResults[9]:DRtgOtherTDV )   }
	"Calculate TDV - TOTAL  - Ext"		Proj:RunResults[9]:DesignRatingTDV[2]	= {	RunResults[9]:DesignRatingTDV[1]   }
	"Calculate Elec Demand  - Ext"		Proj:RunResults[9]:DRtgElecDemand		= {	if (LocalRef( RunResults[9]:DRtgElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Ext" ) / 3.412  endif  }

  ; PV
	"Calculate TDV - Elec   - PV"			Proj:RunResults[13]:DRtgElecTDV			= {	if (LocalRef( RunResults[13]:DRtgElecEnergy		) > -0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "PVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - PV"			Proj:RunResults[13]:DRtgNatGasTDV		= {	0  }
	"Calculate TDV - Other  - PV"			Proj:RunResults[13]:DRtgOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - PV"			Proj:RunResults[13]:DesignRatingTDV[1]	= {	LocalRef( RunResults[13]:DRtgElecTDV )   }
	"Calculate TDV - TOTAL  - PV"			Proj:RunResults[13]:DesignRatingTDV[2]	= {	RunResults[13]:DesignRatingTDV[1]   }
	"Calculate Elec Demand  - PV"			Proj:RunResults[13]:DRtgElecDemand		= {	if (LocalRef( RunResults[13]:DRtgElecEnergy	) > -0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "PV" ) / 3.412  endif  }

  ; Battery - SAC 12/15/16
	"Calculate TDV - Elec   - Battery"	Proj:RunResults[14]:DRtgElecTDV			= {	if (LocalRef( RunResults[14]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "BTTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "BT" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - Battery"	Proj:RunResults[14]:DRtgNatGasTDV		= {	0  }
	"Calculate TDV - Other  - Battery"	Proj:RunResults[14]:DRtgOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - Battery"	Proj:RunResults[14]:DesignRatingTDV[1]	= {	LocalRef( RunResults[14]:DRtgElecTDV )   }
	"Calculate TDV - TOTAL  - Battery"	Proj:RunResults[14]:DesignRatingTDV[2]	= {	RunResults[14]:DesignRatingTDV[1]   }
	"Calculate Elec Demand  - Battery"	Proj:RunResults[14]:DRtgElecDemand		= {	if (LocalRef( RunResults[14]:DRtgElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "BT" ) / 3.412  endif  }

  ; Compliance Total
  ; SAC 1/14/13 - added in PVCredit to Std (elec) TDV
; mjb-10/16/13	remove PVCredit from Std Design
	"Calculate TDV - Elec   - Comp Ttl"	Proj:RunResults[11]:DRtgElecTDV			= {	RunResults[1]:DRtgElecTDV    + RunResults[2]:DRtgElecTDV    + RunResults[3]:DRtgElecTDV    + RunResults[4]:DRtgElecTDV    + RunResults[5]:DRtgElecTDV     }
	"Calculate TDV - NatGas - Comp Ttl"	Proj:RunResults[11]:DRtgNatGasTDV		= {	RunResults[1]:DRtgNatGasTDV  + RunResults[2]:DRtgNatGasTDV  + RunResults[3]:DRtgNatGasTDV  + RunResults[4]:DRtgNatGasTDV  + RunResults[5]:DRtgNatGasTDV   }
	"Calculate TDV - Other  - Comp Ttl"	Proj:RunResults[11]:DRtgOtherTDV			= {	RunResults[1]:DRtgOtherTDV   + RunResults[2]:DRtgOtherTDV   + RunResults[3]:DRtgOtherTDV   + RunResults[4]:DRtgOtherTDV   + RunResults[5]:DRtgOtherTDV    }
	"Calculate TDV - TOTAL  - Comp Ttl"	Proj:RunResults[11]:DesignRatingTDV[1]	= {	RunResults[1]:DesignRatingTDV[1]   + RunResults[2]:DesignRatingTDV[1]   + RunResults[3]:DesignRatingTDV[1]   + RunResults[4]:DesignRatingTDV[1]   + RunResults[5]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - Comp Ttl"	Proj:RunResults[11]:DesignRatingTDV[2]	= {	RunResults[1]:DesignRatingTDV[2]   + RunResults[2]:DesignRatingTDV[2]   + RunResults[3]:DesignRatingTDV[2]   + RunResults[4]:DesignRatingTDV[2]   + RunResults[5]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - Comp Ttl"	Proj:RunResults[11]:DRtgElecDemand		= {	RunResults[1]:DRtgElecDemand + RunResults[2]:DRtgElecDemand + RunResults[3]:DRtgElecDemand + RunResults[4]:DRtgElecDemand + RunResults[5]:DRtgElecDemand  }

  ; Total
	"Calculate TDV - Elec   - Total"		Proj:RunResults[10]:DRtgElecTDV			= {	RunResults[11]:DRtgElecTDV    + RunResults[6]:DRtgElecTDV    + RunResults[7]:DRtgElecTDV    + RunResults[8]:DRtgElecTDV    + RunResults[9]:DRtgElecTDV     }
	"Calculate TDV - NatGas - Total"		Proj:RunResults[10]:DRtgNatGasTDV		= {	RunResults[11]:DRtgNatGasTDV  + RunResults[6]:DRtgNatGasTDV  + RunResults[7]:DRtgNatGasTDV  + RunResults[8]:DRtgNatGasTDV  + RunResults[9]:DRtgNatGasTDV   }
	"Calculate TDV - Other  - Total"		Proj:RunResults[10]:DRtgOtherTDV			= {	RunResults[11]:DRtgOtherTDV   + RunResults[6]:DRtgOtherTDV   + RunResults[7]:DRtgOtherTDV   + RunResults[8]:DRtgOtherTDV   + RunResults[9]:DRtgOtherTDV    }
	"Calculate TDV - TOTAL  - Total"		Proj:RunResults[10]:DesignRatingTDV[1]	= {	RunResults[11]:DesignRatingTDV[1]   + RunResults[6]:DesignRatingTDV[1]   + RunResults[7]:DesignRatingTDV[1]   + RunResults[8]:DesignRatingTDV[1]   + RunResults[9]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - Total"		Proj:RunResults[10]:DesignRatingTDV[2]	= {	RunResults[11]:DesignRatingTDV[2]   + RunResults[6]:DesignRatingTDV[2]   + RunResults[7]:DesignRatingTDV[2]   + RunResults[8]:DesignRatingTDV[2]   + RunResults[9]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - Total"		Proj:RunResults[10]:DRtgElecDemand		= {	RunResults[11]:DRtgElecDemand + RunResults[6]:DRtgElecDemand + RunResults[7]:DRtgElecDemand + RunResults[8]:DRtgElecDemand + RunResults[9]:DRtgElecDemand  }

  ; SAC 2/1/16 - inserted RE-calc of Standard model PVCredit (so that it is available for analysis results reporting following design rating run)
	"Set Proj:PVBaseTDV"						Proj:PVBaseTDV	= {	ValidOr( RunResults[11]:StandardTDV, 0 ) * CondFloorArea  }		; SAC 4/14/15 - switched from elecTotalTDV to totalCompTDV - was: RunResults[10]:StdElecTDV
	"Perform PV calcs if applicable"		Proj:Action		= {	if (PVGenCredit < 1 .OR. StandardsVersion == 2014 .OR. CondFloorArea < 0.01) then  UNCHANGED
																				else	switch ( CompCodeBase )
																							case  2013 :	EvalRulelist( "CARes_CalculatePVCredit_2013Compliance" )
																							case  2016 :	EvalRulelist( "CARes_CalculatePVCredit_2016Compliance" )
																							default    :	UNCHANGED   ; no specific PV credit for 2019 or 2022
																						endswitch  endif  }

	; SAC 4/2/14 - moved PV credit calcs into subordinate rulelist
	"Set Proj:PVBaseTDV - DRtg"						Proj:PVBaseTDV	= {	ValidOr( RunResults[10]:DesignRatingTDV[1], 0 ) * CondFloorArea  }		; SAC 4/14/15 - switched from elecTDV to totalTDV - was: RunResults[10]:DRtgElecTDV
		; SAC 3/24/16 - removed logic 'PVGenCredit < 1 .OR.' preventing call to CARes_CalculatePVCredit_2016DesignRating when compliance PV credit toggled off
	"Perform PV calcs if applicable - DRtg"		Proj:Action		= {	if ((StdDesignBase == 2013 .AND. StandardsVersion == 2014) .OR. CondFloorArea < 0.01) then  UNCHANGED
																							else	switch ( CompCodeBase )
																										case  2016 :	EvalRulelist( "CARes_CalculatePVCredit_2016DesignRating" )
																										case  2019 :	EvalRulelist( "CARes_CalculatePVCredit_2016DesignRating" )  ; DsgnRtg PVCredit for 2016 & 2019 same
																										case  2022 :	EvalRulelist( "CARes_CalculatePVCredit_2016DesignRating" )  ; DsgnRtg PVCredit for 2016, 2019 & 2022 same ??
																										default    :	UNCHANGED
																									endswitch  endif  }
	; SAC 4/3/15 - set new EnergyUse:PropPVCreditTDV property (needed to track & pass PVCredit from first to second Proposed EnergyUse data)
	"Store PropPVCreditTDV[2]"				Proj:RunResults[6]:PropPVCreditTDV[2]		= {	PVCredit[2]  }			; SAC 1/28/16 - still track this under InsLtg enduse ??
	; SAC SAC 4/8/15 - adjust RunResults[6]:Prop*[2] properties for DRtgLtgReduction
	"Adjust - Elec   - InsLtg for DRtgLtgReduction"	Proj:RunResults[6]:PropElecEnergy[2]	= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropElecEnergy[2]   <= 0) then  UNCHANGED
			 			  																										else               RunResults[6]:PropElecEnergy[2]   * (100 - DRtgLtgReduction) / 100  endif  }
	"Adjust - NatGas - InsLtg for DRtgLtgReduction"	Proj:RunResults[6]:PropNatGasEnergy[2]	= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropNatGasEnergy[2] <= 0) then  UNCHANGED
			 			  																										else               RunResults[6]:PropNatGasEnergy[2] * (100 - DRtgLtgReduction) / 100  endif  }
	"Adjust - Other  - InsLtg for DRtgLtgReduction"	Proj:RunResults[6]:PropOtherEnergy[2]	= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropOtherEnergy[2]  <= 0) then  UNCHANGED
			 			  																										else               RunResults[6]:PropOtherEnergy[2]  * (100 - DRtgLtgReduction) / 100  endif  }
	"Adjust - Elec   - InsLtg for DRtgLtgReduction"	Proj:RunResults[6]:PropElecTDV[2]		= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropElecTDV[2]      <= 0) then  UNCHANGED
			 			  																										else  int( (100 * (RunResults[6]:PropElecTDV[2]      * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
;	"Adjust - NatGas - InsLtg for DRtgLtgReduction"	Proj:RunResults[6]:PropNatGasTDV			= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropNatGasTDV[2]    <= 0) then  UNCHANGED
;			 			  																										else  int( (100 * (RunResults[6]:PropNatGasTDV[2]    * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
;	"Adjust - Other  - InsLtg for DRtgLtgReduction"	Proj:RunResults[6]:PropOtherTDV			= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropOtherTDV[2]     <= 0) then  UNCHANGED
;																																else  int( (100 * (RunResults[6]:PropOtherTDV[2]     * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
	"Adjust E Demand - InsLtg for DRtgLtgReduction"	Proj:RunResults[6]:PropElecDemand[2]	= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropElecDemand[2]   <= 0) then  UNCHANGED
			 			  																										else               RunResults[6]:PropElecDemand[2]   * (100 - DRtgLtgReduction) / 100  endif  }
	"Recalc - TOTAL  - InsLtg for DRtgLtgReduction"	Proj:RunResults[6]:PropTotalEnergy[2]	= {	RunResults[6]:PropElecEnergy[2] + RunResults[6]:PropNatGasEnergy[2] + RunResults[6]:PropOtherEnergy[2]   }
	"Recalc - TOTAL  - InsLtg for DRtgLtgReduction"	Proj:RunResults[6]:ProposedTDV[2]		= {	RunResults[6]:PropElecTDV[2]    + RunResults[6]:PropNatGasTDV       + RunResults[6]:PropOtherTDV         }
	"Recalc - TOTAL  - InsLtg for DRtgLtgReduction"	Proj:RunResults[6]:ProposedTDV[3]		= {	RunResults[6]:ProposedTDV[2]  }
; ADJUST certain Proposed results that now are to have PVCredit applied to them
; mjb-10/16/13	subtracted PVCredit from Proposed Design Elec and TOTAL 
; SAC 4/9/15 - updated to also recalc energy use sums (to catch mods for design rating lighting credit)
; SAC 4/7/17 - shifted PV & Batt from CompTot to Tot for 2019
	"Recalc total - Elec   - Comp Ttl"	Proj:RunResults[11]:PropElecEnergy[2]		= {	if (EnergyCodeYearNum < 2019)
                                                                                       then  RunResults[1]:PropElecEnergy[2]    + RunResults[2]:PropElecEnergy[2]   + RunResults[3]:PropElecEnergy[2]   + RunResults[4]:PropElecEnergy[2]   + RunResults[5]:PropElecEnergy[2]   + RunResults[13]:PropElecEnergy[2]   + RunResults[14]:PropElecEnergy[2]   	; SAC 2/1/16 - PV  - SAC 12/15/16 - Battery
                                                                                       else  RunResults[1]:PropElecEnergy[2]    + RunResults[2]:PropElecEnergy[2]   + RunResults[3]:PropElecEnergy[2]   + RunResults[4]:PropElecEnergy[2]   + RunResults[5]:PropElecEnergy[2]     endif  }
	"Recalc total - NatGas - Comp Ttl"	Proj:RunResults[11]:PropNatGasEnergy[2]	= {	if (EnergyCodeYearNum < 2019)
                                                                                       then  RunResults[1]:PropNatGasEnergy[2]  + RunResults[2]:PropNatGasEnergy[2] + RunResults[3]:PropNatGasEnergy[2] + RunResults[4]:PropNatGasEnergy[2] + RunResults[5]:PropNatGasEnergy[2] + RunResults[13]:PropNatGasEnergy[2] + RunResults[14]:PropNatGasEnergy[2] 
                                                                                       else  RunResults[1]:PropNatGasEnergy[2]  + RunResults[2]:PropNatGasEnergy[2] + RunResults[3]:PropNatGasEnergy[2] + RunResults[4]:PropNatGasEnergy[2] + RunResults[5]:PropNatGasEnergy[2]   endif  }
	"Recalc total - Other  - Comp Ttl"	Proj:RunResults[11]:PropOtherEnergy[2]		= {	if (EnergyCodeYearNum < 2019)
                                                                                       then  RunResults[1]:PropOtherEnergy[2]   + RunResults[2]:PropOtherEnergy[2]  + RunResults[3]:PropOtherEnergy[2]  + RunResults[4]:PropOtherEnergy[2]  + RunResults[5]:PropOtherEnergy[2]  + RunResults[13]:PropOtherEnergy[2]  + RunResults[14]:PropOtherEnergy[2]  
                                                                                       else  RunResults[1]:PropOtherEnergy[2]   + RunResults[2]:PropOtherEnergy[2]  + RunResults[3]:PropOtherEnergy[2]  + RunResults[4]:PropOtherEnergy[2]  + RunResults[5]:PropOtherEnergy[2]    endif  }
	"Recalc total - TOTAL  - Comp Ttl"	Proj:RunResults[11]:PropTotalEnergy[2]		= {	if (EnergyCodeYearNum < 2019)
                                                                                       then  RunResults[1]:PropTotalEnergy[2]   + RunResults[2]:PropTotalEnergy[2]  + RunResults[3]:PropTotalEnergy[2]  + RunResults[4]:PropTotalEnergy[2]  + RunResults[5]:PropTotalEnergy[2]  + RunResults[13]:PropTotalEnergy[2]  + RunResults[14]:PropTotalEnergy[2]  
                                                                                       else  RunResults[1]:PropTotalEnergy[2]   + RunResults[2]:PropTotalEnergy[2]  + RunResults[3]:PropTotalEnergy[2]  + RunResults[4]:PropTotalEnergy[2]  + RunResults[5]:PropTotalEnergy[2]    endif  }
	"Recalc TDV - Elec   - Comp Ttl"		Proj:RunResults[11]:PropElecTDV[2]			= {	if (EnergyCodeYearNum < 2019)
                                                                                       then  RunResults[1]:PropElecTDV[2]       + RunResults[2]:PropElecTDV[2]      + RunResults[3]:PropElecTDV[2]      + RunResults[4]:PropElecTDV[2]      + RunResults[5]:PropElecTDV[2]      + RunResults[13]:PropElecTDV[2]      + RunResults[14]:PropElecTDV[2]       ; - PVCredit[2]  }
                                                                                       else  RunResults[1]:PropElecTDV[2]       + RunResults[2]:PropElecTDV[2]      + RunResults[3]:PropElecTDV[2]      + RunResults[4]:PropElecTDV[2]      + RunResults[5]:PropElecTDV[2]        endif  } 
	"Recalc TDV - TOTAL  - Comp Ttl"		Proj:RunResults[11]:ProposedTDV[2]			= {	if (EnergyCodeYearNum < 2019)
                                                                                       then  RunResults[1]:ProposedTDV[2]       + RunResults[2]:ProposedTDV[2]      + RunResults[3]:ProposedTDV[2]      + RunResults[4]:ProposedTDV[2]      + RunResults[5]:ProposedTDV[2]      + RunResults[13]:ProposedTDV[2]      + RunResults[14]:ProposedTDV[2]       ; - PVCredit[2]  }
                                                                                       else  RunResults[1]:ProposedTDV[2]       + RunResults[2]:ProposedTDV[2]      + RunResults[3]:ProposedTDV[2]      + RunResults[4]:ProposedTDV[2]      + RunResults[5]:ProposedTDV[2]        endif  }
	"Recalc TDV - TOTAL  - Comp Ttl"		Proj:RunResults[11]:ProposedTDV[3]			= {	if (EnergyCodeYearNum < 2019)
                                                                                       then  RunResults[1]:ProposedTDV[3]       + RunResults[2]:ProposedTDV[3]      + RunResults[3]:ProposedTDV[3]      + RunResults[4]:ProposedTDV[3]      + RunResults[5]:ProposedTDV[3]      + RunResults[13]:ProposedTDV[3]      + RunResults[14]:ProposedTDV[3]       ; - PVCredit[2]  }
                                                                                       else  RunResults[1]:ProposedTDV[3]       + RunResults[2]:ProposedTDV[3]      + RunResults[3]:ProposedTDV[3]      + RunResults[4]:ProposedTDV[3]      + RunResults[5]:ProposedTDV[3]        endif  }
	"Recalc total - ElDem - Comp Ttl"	Proj:RunResults[11]:PropElecDemand[2]		= {	if (EnergyCodeYearNum < 2019)
                                                                                       then  RunResults[1]:PropElecDemand[2]    + RunResults[2]:PropElecDemand[2]   + RunResults[3]:PropElecDemand[2]   + RunResults[4]:PropElecDemand[2]   + RunResults[5]:PropElecDemand[2]   + RunResults[13]:PropElecDemand[2]   + RunResults[14]:PropElecDemand[2]   	; SAC 5/1/15
                                                                                       else  RunResults[1]:PropElecDemand[2]    + RunResults[2]:PropElecDemand[2]   + RunResults[3]:PropElecDemand[2]   + RunResults[4]:PropElecDemand[2]   + RunResults[5]:PropElecDemand[2]     endif  }
	"Recalc total - Elec   - Total"		Proj:RunResults[10]:PropElecEnergy[2]		= {	if (EnergyCodeYearNum < 2019)
                                                                                       then  RunResults[11]:PropElecEnergy[2]   + RunResults[6]:PropElecEnergy[2]   + RunResults[7]:PropElecEnergy[2]   + RunResults[8]:PropElecEnergy[2]   + RunResults[9]:PropElecEnergy[2]    
                                                                                       else  RunResults[11]:PropElecEnergy[2]   + RunResults[6]:PropElecEnergy[2]   + RunResults[7]:PropElecEnergy[2]   + RunResults[8]:PropElecEnergy[2]   + RunResults[9]:PropElecEnergy[2]   + RunResults[13]:PropElecEnergy[2]   + RunResults[14]:PropElecEnergy[2]    endif  }
	"Recalc total - NatGas - Total"		Proj:RunResults[10]:PropNatGasEnergy[2]	= {	if (EnergyCodeYearNum < 2019)
                                                                                       then  RunResults[11]:PropNatGasEnergy[2] + RunResults[6]:PropNatGasEnergy[2] + RunResults[7]:PropNatGasEnergy[2] + RunResults[8]:PropNatGasEnergy[2] + RunResults[9]:PropNatGasEnergy[2]  
                                                                                       else  RunResults[11]:PropNatGasEnergy[2] + RunResults[6]:PropNatGasEnergy[2] + RunResults[7]:PropNatGasEnergy[2] + RunResults[8]:PropNatGasEnergy[2] + RunResults[9]:PropNatGasEnergy[2] + RunResults[13]:PropNatGasEnergy[2] + RunResults[14]:PropNatGasEnergy[2]  endif  }
	"Recalc total - Other  - Total"		Proj:RunResults[10]:PropOtherEnergy[2]		= {	if (EnergyCodeYearNum < 2019)
                                                                                       then  RunResults[11]:PropOtherEnergy[2]  + RunResults[6]:PropOtherEnergy[2]  + RunResults[7]:PropOtherEnergy[2]  + RunResults[8]:PropOtherEnergy[2]  + RunResults[9]:PropOtherEnergy[2]   
                                                                                       else  RunResults[11]:PropOtherEnergy[2]  + RunResults[6]:PropOtherEnergy[2]  + RunResults[7]:PropOtherEnergy[2]  + RunResults[8]:PropOtherEnergy[2]  + RunResults[9]:PropOtherEnergy[2]  + RunResults[13]:PropOtherEnergy[2]  + RunResults[14]:PropOtherEnergy[2]   endif  }
	"Recalc total - TOTAL  - Total"		Proj:RunResults[10]:PropTotalEnergy[2]		= {	if (EnergyCodeYearNum < 2019)
                                                                                       then  RunResults[11]:PropTotalEnergy[2]  + RunResults[6]:PropTotalEnergy[2]  + RunResults[7]:PropTotalEnergy[2]  + RunResults[8]:PropTotalEnergy[2]  + RunResults[9]:PropTotalEnergy[2]   
                                                                                       else  RunResults[11]:PropTotalEnergy[2]  + RunResults[6]:PropTotalEnergy[2]  + RunResults[7]:PropTotalEnergy[2]  + RunResults[8]:PropTotalEnergy[2]  + RunResults[9]:PropTotalEnergy[2]  + RunResults[13]:PropTotalEnergy[2]  + RunResults[14]:PropTotalEnergy[2]   endif  }
	"Recalc TDV - Elec   - Total"			Proj:RunResults[10]:PropElecTDV[2]			= {	if (EnergyCodeYearNum < 2019)
                                                                                       then  RunResults[11]:PropElecTDV[2]      + RunResults[6]:PropElecTDV[2]      + RunResults[7]:PropElecTDV[2]      + RunResults[8]:PropElecTDV[2]      + RunResults[9]:PropElecTDV[2]       
                                                                                       else  RunResults[11]:PropElecTDV[2]      + RunResults[6]:PropElecTDV[2]      + RunResults[7]:PropElecTDV[2]      + RunResults[8]:PropElecTDV[2]      + RunResults[9]:PropElecTDV[2]      + RunResults[13]:PropElecTDV[2]      + RunResults[14]:PropElecTDV[2]       endif  }
	"Recalc TDV - TOTAL  - Total"			Proj:RunResults[10]:ProposedTDV[2]			= {	if (EnergyCodeYearNum < 2019)
                                                                                       then  RunResults[11]:ProposedTDV[2]      + RunResults[6]:ProposedTDV[2]      + RunResults[7]:ProposedTDV[2]      + RunResults[8]:ProposedTDV[2]      + RunResults[9]:ProposedTDV[2]       
                                                                                       else  RunResults[11]:ProposedTDV[2]      + RunResults[6]:ProposedTDV[2]      + RunResults[7]:ProposedTDV[2]      + RunResults[8]:ProposedTDV[2]      + RunResults[9]:ProposedTDV[2]      + RunResults[13]:ProposedTDV[2]      + RunResults[14]:ProposedTDV[2]       endif  }
	"Recalc TDV - TOTAL  - Total"			Proj:RunResults[10]:ProposedTDV[3]			= {	if (EnergyCodeYearNum < 2019)
                                                                                       then  RunResults[11]:ProposedTDV[3]      + RunResults[6]:ProposedTDV[3]      + RunResults[7]:ProposedTDV[3]      + RunResults[8]:ProposedTDV[3]      + RunResults[9]:ProposedTDV[3]       
                                                                                       else  RunResults[11]:ProposedTDV[3]      + RunResults[6]:ProposedTDV[3]      + RunResults[7]:ProposedTDV[3]      + RunResults[8]:ProposedTDV[3]      + RunResults[9]:ProposedTDV[3]      + RunResults[13]:ProposedTDV[3]      + RunResults[14]:ProposedTDV[3]       endif  }
	"Recalc total - ElDem - Total"		Proj:RunResults[10]:PropElecDemand[2]		= {	if (EnergyCodeYearNum < 2019)
                                                                                       then  RunResults[11]:PropElecDemand[2]   + RunResults[6]:PropElecDemand[2]   + RunResults[7]:PropElecDemand[2]   + RunResults[8]:PropElecDemand[2]   + RunResults[9]:PropElecDemand[2]    ; SAC 5/1/15
                                                                                       else  RunResults[11]:PropElecDemand[2]   + RunResults[6]:PropElecDemand[2]   + RunResults[7]:PropElecDemand[2]   + RunResults[8]:PropElecDemand[2]   + RunResults[9]:PropElecDemand[2]   + RunResults[13]:PropElecDemand[2]   + RunResults[14]:PropElecDemand[2]    endif  }	; SAC 5/1/15

  ; Percent Improvement
   ; SAC 10/2/17 - switched from reporting delta with DRtgTDV w/o fuel adjustment mult applied to DRtgTDV W/ fuel adjustment mult applied
	"Calc TDV Pct Improve - SpcHt"    	Proj:RunResults[1]:DRtgPctSavTDV		= {	if (LocalRef( RunResults[1]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResults[1]:DesignRatingTDV[2]  ) - LocalRef( RunResults[1]:ProposedTDV[2]  )) * 100 / LocalRef( RunResults[1]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - SpcCl"    	Proj:RunResults[2]:DRtgPctSavTDV		= {	if (LocalRef( RunResults[2]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResults[2]:DesignRatingTDV[2]  ) - LocalRef( RunResults[2]:ProposedTDV[2]  )) * 100 / LocalRef( RunResults[2]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - IAQVent"  	Proj:RunResults[3]:DRtgPctSavTDV		= {	if (LocalRef( RunResults[3]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResults[3]:DesignRatingTDV[2]  ) - LocalRef( RunResults[3]:ProposedTDV[2]  )) * 100 / LocalRef( RunResults[3]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - OthrHVAC" 	Proj:RunResults[4]:DRtgPctSavTDV		= {	if (LocalRef( RunResults[4]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResults[4]:DesignRatingTDV[2]  ) - LocalRef( RunResults[4]:ProposedTDV[2]  )) * 100 / LocalRef( RunResults[4]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - WtrHt"    	Proj:RunResults[5]:DRtgPctSavTDV		= {	if (LocalRef( RunResults[5]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResults[5]:DesignRatingTDV[2]  ) - LocalRef( RunResults[5]:ProposedTDV[2]  )) * 100 / LocalRef( RunResults[5]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - InsLtg"   	Proj:RunResults[6]:DRtgPctSavTDV		= {	if (LocalRef( RunResults[6]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResults[6]:DesignRatingTDV[2]  ) - LocalRef( RunResults[6]:ProposedTDV[2]  )) * 100 / LocalRef( RunResults[6]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - AppCkg"   	Proj:RunResults[7]:DRtgPctSavTDV		= {	if (LocalRef( RunResults[7]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResults[7]:DesignRatingTDV[2]  ) - LocalRef( RunResults[7]:ProposedTDV[2]  )) * 100 / LocalRef( RunResults[7]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - Plugs"    	Proj:RunResults[8]:DRtgPctSavTDV		= {	if (LocalRef( RunResults[8]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResults[8]:DesignRatingTDV[2]  ) - LocalRef( RunResults[8]:ProposedTDV[2]  )) * 100 / LocalRef( RunResults[8]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - Ext"      	Proj:RunResults[9]:DRtgPctSavTDV		= {	if (LocalRef( RunResults[9]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResults[9]:DesignRatingTDV[2]  ) - LocalRef( RunResults[9]:ProposedTDV[2]  )) * 100 / LocalRef( RunResults[9]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - PV"      	Proj:RunResults[13]:DRtgPctSavTDV	= {	if (LocalRef( RunResults[13]:DesignRatingTDV[2] ) == 0) then  0  else  (LocalRef( RunResults[13]:DesignRatingTDV[2] ) - LocalRef( RunResults[13]:ProposedTDV[2] )) * 100 / LocalRef( RunResults[13]:DesignRatingTDV[2] )  endif  }
	"Calc TDV Pct Improve - Battery"  	Proj:RunResults[14]:DRtgPctSavTDV	= {	if (LocalRef( RunResults[14]:DesignRatingTDV[2] ) == 0) then  0  else  (LocalRef( RunResults[14]:DesignRatingTDV[2] ) - LocalRef( RunResults[14]:ProposedTDV[2] )) * 100 / LocalRef( RunResults[13]:DesignRatingTDV[2] )  endif  }
	"Calc TDV Pct Improve - Total"    	Proj:RunResults[10]:DRtgPctSavTDV	= {	if (LocalRef( RunResults[10]:DesignRatingTDV[2] ) == 0) then  0  else  (LocalRef( RunResults[10]:DesignRatingTDV[2] ) - LocalRef( RunResults[10]:ProposedTDV[2] )) * 100 / LocalRef( RunResults[10]:DesignRatingTDV[2] )  endif  }
	"Calc TDV Pct Improve - Comp Ttl"  	Proj:RunResults[11]:DRtgPctSavTDV	= {	if (LocalRef( RunResults[11]:DesignRatingTDV[2] ) == 0) then  0  else  (LocalRef( RunResults[11]:DesignRatingTDV[2] ) - LocalRef( RunResults[11]:ProposedTDV[2] )) * 100 / LocalRef( RunResults[11]:DesignRatingTDV[2] )  endif  }

  ; Delta Demand
	"Calc Delta El Demand - SpcHt"    	Proj:RunResults[1]:DRtgDeltaDemand	= {	LocalRef( RunResults[1]:DRtgElecDemand  ) - LocalRef( RunResults[1]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - SpcCl"    	Proj:RunResults[2]:DRtgDeltaDemand	= {	LocalRef( RunResults[2]:DRtgElecDemand  ) - LocalRef( RunResults[2]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - IAQVent"  	Proj:RunResults[3]:DRtgDeltaDemand	= {	LocalRef( RunResults[3]:DRtgElecDemand  ) - LocalRef( RunResults[3]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - OthrHVAC" 	Proj:RunResults[4]:DRtgDeltaDemand	= {	LocalRef( RunResults[4]:DRtgElecDemand  ) - LocalRef( RunResults[4]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - WtrHt"    	Proj:RunResults[5]:DRtgDeltaDemand	= {	LocalRef( RunResults[5]:DRtgElecDemand  ) - LocalRef( RunResults[5]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - InsLtg"   	Proj:RunResults[6]:DRtgDeltaDemand	= {	LocalRef( RunResults[6]:DRtgElecDemand  ) - LocalRef( RunResults[6]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - AppCkg"   	Proj:RunResults[7]:DRtgDeltaDemand	= {	LocalRef( RunResults[7]:DRtgElecDemand  ) - LocalRef( RunResults[7]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - Plugs"    	Proj:RunResults[8]:DRtgDeltaDemand	= {	LocalRef( RunResults[8]:DRtgElecDemand  ) - LocalRef( RunResults[8]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - Ext"      	Proj:RunResults[9]:DRtgDeltaDemand	= {	LocalRef( RunResults[9]:DRtgElecDemand  ) - LocalRef( RunResults[9]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - PV"      	Proj:RunResults[13]:DRtgDeltaDemand	= {	LocalRef( RunResults[13]:DRtgElecDemand ) - LocalRef( RunResults[13]:PropElecDemand[2] )   }
	"Calc Delta El Demand - Battery"  	Proj:RunResults[14]:DRtgDeltaDemand	= {	LocalRef( RunResults[14]:DRtgElecDemand ) - LocalRef( RunResults[14]:PropElecDemand[2] )   }
	"Calc Delta El Demand - Total"    	Proj:RunResults[10]:DRtgDeltaDemand	= {	LocalRef( RunResults[10]:DRtgElecDemand ) - LocalRef( RunResults[10]:PropElecDemand[2] )   }
	"Calc Delta El Demand - Comp Ttl" 	Proj:RunResults[11]:DRtgDeltaDemand	= {	LocalRef( RunResults[11]:DRtgElecDemand ) - LocalRef( RunResults[11]:PropElecDemand[2] )   }

END


;*************************************************************************
RULELIST "CARes_StandardTDVResults_NESW" 1 0 0 1
;*************************************************************************

; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
         ; SAC 8/24/19 - replaced 1/3.413 & 0.01 TDV table multipliers with Proj:TDVSecMult_Elec & TDVSecMult_Fuel to accommodate 2022+ switch to native (E3) TDV table units
         ; SAC 8/26/19 - added primary table multipliers (of 1.0) to all ApplyHourlyResultMult* function calls (to accommodate 2022+ TDV table unit switch)
  ; Space Heating (& heating fan)
	"Calculate TDV - Elec   - N-SpcHt"		Proj:RunResultsN[1]:StdElecTDV			= {	if (LocalRef( RunResultsN[1]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-SpcHt"		Proj:RunResultsN[1]:StdNatGasTDV			= {	if (LocalRef( RunResultsN[1]:StdNatGasEnergy		) < 0.0001) then  0                                                                                                        
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-SpcHt"		Proj:RunResultsN[1]:StdOtherTDV			= {	if (LocalRef( RunResultsN[1]:StdOtherEnergy		) < 0.0001) then  0                                                                                                        
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-SpcHt"		Proj:RunResultsN[1]:StandardTDV			= {	LocalRef( RunResultsN[1]:StdElecTDV ) + LocalRef( RunResultsN[1]:StdNatGasTDV ) + LocalRef( RunResultsN[1]:StdOtherTDV )   }
  ; SAC 8/23/14 - added rules to set elec demand
	"Calculate Elec Demand  - N-SpcHt"		Proj:RunResultsN[1]:StdElecDemand		= {	if (LocalRef( RunResultsN[1]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / 3.412  endif  }

  ; Space Cooling (& cooling fan)
	"Calculate TDV - Elec   - N-SpcCl"		Proj:RunResultsN[2]:StdElecTDV			= {	if (LocalRef( RunResultsN[2]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-SpcCl"		Proj:RunResultsN[2]:StdNatGasTDV			= {	if (LocalRef( RunResultsN[2]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-SpcCl"		Proj:RunResultsN[2]:StdOtherTDV			= {	if (LocalRef( RunResultsN[2]:StdOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-SpcCl"		Proj:RunResultsN[2]:StandardTDV			= {	LocalRef( RunResultsN[2]:StdElecTDV ) + LocalRef( RunResultsN[2]:StdNatGasTDV ) + LocalRef( RunResultsN[2]:StdOtherTDV )   }
	"Calculate Elec Demand  - N-SpcCl"		Proj:RunResultsN[2]:StdElecDemand		= {	if (LocalRef( RunResultsN[2]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Clg", "FanC" ) / 3.412  endif  }

  ; IAQ Ventilation Fans
	"Calculate TDV - Elec   - N-IAQVent"	Proj:RunResultsN[3]:StdElecTDV			= {	if (LocalRef( RunResultsN[3]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "IAQVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "FanV" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-IAQVent"	Proj:RunResultsN[3]:StdNatGasTDV			= {	0  }
	"Calculate TDV - Other  - N-IAQVent"	Proj:RunResultsN[3]:StdOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - N-IAQVent"	Proj:RunResultsN[3]:StandardTDV			= {	LocalRef( RunResultsN[3]:StdElecTDV )   }
	"Calculate Elec Demand  - N-IAQVent"	Proj:RunResultsN[3]:StdElecDemand		= {	if (LocalRef( RunResultsN[3]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "FanV" ) / 3.412  endif  }

; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
  ; Other HVAC (aux & misc fans)
	"Calculate TDV - Elec   - N-OthrHVAC"	Proj:RunResultsN[4]:StdElecTDV			= {	0  }
	"Calculate TDV - NatGas - N-OthrHVAC"	Proj:RunResultsN[4]:StdNatGasTDV			= {	0  }
	"Calculate TDV - Other  - N-OthrHVAC"	Proj:RunResultsN[4]:StdOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:StandardTDV			= {	0  }
	"Calculate Elec Demand  - N-OthrHVAC"	Proj:RunResultsN[4]:StdElecDemand		= {	0  }

  ; Water Heating
	"Calculate TDV - Elec   - N-WtrHt"		Proj:RunResultsN[5]:StdElecTDV			= {	if (LocalRef( RunResultsN[5]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else if (CSEinclDHWMFL_EU)
			 			  																							then  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / CondFloorArea) + 0.5) / 100
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate TDV - NatGas - N-WtrHt"		Proj:RunResultsN[5]:StdNatGasTDV			= {	if (LocalRef( RunResultsN[5]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-WtrHt"		Proj:RunResultsN[5]:StdOtherTDV			= {	if (LocalRef( RunResultsN[5]:StdOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-WtrHt"		Proj:RunResultsN[5]:StandardTDV			= {	LocalRef( RunResultsN[5]:StdElecTDV ) + LocalRef( RunResultsN[5]:StdNatGasTDV ) + LocalRef( RunResultsN[5]:StdOtherTDV )   }
	"Calculate Elec Demand  - N-WtrHt"		Proj:RunResultsN[5]:StdElecDemand		= {	if (LocalRef( RunResultsN[5]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else if (CSEinclDHWMFL_EU)
			 			  																							then  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / 3.412
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / 3.412  endif endif  }

  ; Inside Lighting
	"Calculate TDV - Elec   - N-InsLtg"		Proj:RunResultsN[6]:StdElecTDV			= {	if (LocalRef( RunResultsN[6]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-InsLtg"		Proj:RunResultsN[6]:StdNatGasTDV			= {	if (LocalRef( RunResultsN[6]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-InsLtg"		Proj:RunResultsN[6]:StdOtherTDV			= {	if (LocalRef( RunResultsN[6]:StdOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-InsLtg"		Proj:RunResultsN[6]:StandardTDV			= {	LocalRef( RunResultsN[6]:StdElecTDV ) + LocalRef( RunResultsN[6]:StdNatGasTDV ) + LocalRef( RunResultsN[6]:StdOtherTDV )   }
	"Calculate Elec Demand  - N-InsLtg"		Proj:RunResultsN[6]:StdElecDemand		= {	if (LocalRef( RunResultsN[6]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Lit" ) / 3.412  endif  }

  ; Appliances & Cooking
	"Calculate TDV - Elec   - N-AppCkg"		Proj:RunResultsN[7]:StdElecTDV			= {	if (LocalRef( RunResultsN[7]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-AppCkg"		Proj:RunResultsN[7]:StdNatGasTDV			= {	if (LocalRef( RunResultsN[7]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-AppCkg"		Proj:RunResultsN[7]:StdOtherTDV			= {	if (LocalRef( RunResultsN[7]:StdOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-AppCkg"		Proj:RunResultsN[7]:StandardTDV			= {	LocalRef( RunResultsN[7]:StdElecTDV ) + LocalRef( RunResultsN[7]:StdNatGasTDV ) + LocalRef( RunResultsN[7]:StdOtherTDV )   }
	"Calculate Elec Demand  - N-AppCkg"		Proj:RunResultsN[7]:StdElecDemand		= {	if (LocalRef( RunResultsN[7]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / 3.412  endif  }

  ; Plug Loads
	"Calculate TDV - Elec   - N-Plugs"		Proj:RunResultsN[8]:StdElecTDV			= {	if (LocalRef( RunResultsN[8]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-Plugs"		Proj:RunResultsN[8]:StdNatGasTDV			= {	if (LocalRef( RunResultsN[8]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-Plugs"		Proj:RunResultsN[8]:StdOtherTDV			= {	if (LocalRef( RunResultsN[8]:StdOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-Plugs"		Proj:RunResultsN[8]:StandardTDV			= {	LocalRef( RunResultsN[8]:StdElecTDV ) + LocalRef( RunResultsN[8]:StdNatGasTDV ) + LocalRef( RunResultsN[8]:StdOtherTDV )   }
	"Calculate Elec Demand  - N-Plugs"		Proj:RunResultsN[8]:StdElecDemand		= {	if (LocalRef( RunResultsN[8]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Rcp" ) / 3.412  endif  }

  ; Exterior
	"Calculate TDV - Elec   - N-Ext"			Proj:RunResultsN[9]:StdElecTDV			= {	if (LocalRef( RunResultsN[9]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-Ext"			Proj:RunResultsN[9]:StdNatGasTDV			= {	if (LocalRef( RunResultsN[9]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-Ext"			Proj:RunResultsN[9]:StdOtherTDV			= {	if (LocalRef( RunResultsN[9]:StdOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-Ext"			Proj:RunResultsN[9]:StandardTDV			= {	LocalRef( RunResultsN[9]:StdElecTDV ) + LocalRef( RunResultsN[9]:StdNatGasTDV ) + LocalRef( RunResultsN[9]:StdOtherTDV )   }
	"Calculate Elec Demand  - N-Ext"			Proj:RunResultsN[9]:StdElecDemand		= {	if (LocalRef( RunResultsN[9]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Ext" ) / 3.412  endif  }

  ; PV
   ; mods to calc NEM-adjusted PV TDV (StdElecTDV) & Elec Demand (StdElecDemand) for 2019 analysis
	"Calculate TDV - Elec   - N-PV"			Proj:RunResultsN[13]:StdElecTDV			= {	if (LocalRef( RunResultsN[13]:StdElecEnergy		) > -0.0001) then  0
		else if (IfValidAnd( NetEnergyMeteringTDVAdj != 0) .OR. IfValidAnd( HrlyNEMTableCol > 0 ))
      then  if (LocalRef( RunResultsN[14]:PropElecEnergy[1] ) = 0)
            then  int( (100 * ApplyHourlyResultMultipliers_NEM( "PVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor          ) / CondFloorArea) + 0.5) / 100
            else  int( (100 * ApplyHourlyResultMultipliers_NEM( "PVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, 1, "BT" ) / CondFloorArea) + 0.5) / 100  endif
      else        int( (100 * ApplyHourlyResultMultipliers(     "PVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV" ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate TDV - NatGas - N-PV"			Proj:RunResultsN[13]:StdNatGasTDV		= {	0  }
	"Calculate TDV - Other  - N-PV"			Proj:RunResultsN[13]:StdOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - N-PV"			Proj:RunResultsN[13]:StandardTDV			= {	LocalRef( RunResultsN[13]:StdElecTDV )   }
	"Calculate Elec Demand  - N-PV"			Proj:RunResultsN[13]:StdElecDemand		= {	if (LocalRef( RunResultsN[13]:PropElecEnergy[1]		) > -0.0001) then  0
			 			  																						   else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec", "PV" ) / 3.412  endif  }

  ; Battery
   ; mods to calc NEM-adjusted Battery TDV (StdElecTDV) & Elec Demand (StdElecDemand) for 2019 analysis
	"Calculate TDV - Elec   - N-Battery"	Proj:RunResultsN[14]:StdElecTDV			= {	if (LocalRef( RunResultsN[14]:StdElecEnergy		) < 0.0001) then  0
		else if (IfValidAnd( NetEnergyMeteringTDVAdj != 0) .OR. IfValidAnd( HrlyNEMTableCol > 0 ))
      then  if (LocalRef( RunResultsN[13]:PropElecEnergy[1] ) = 0)
            then  int( (100 * ApplyHourlyResultMultipliers_NEM( "BTTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "BT", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor          ) / CondFloorArea) + 0.5) / 100
            else  int( (100 * ApplyHourlyResultMultipliers_NEM( "BTTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "BT", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, 1, "PV" ) / CondFloorArea) + 0.5) / 100  endif
      else        int( (100 * ApplyHourlyResultMultipliers(     "BTTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "BT" ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate TDV - NatGas - N-Battery"	Proj:RunResultsN[14]:StdNatGasTDV		= {	0  }
	"Calculate TDV - Other  - N-Battery"	Proj:RunResultsN[14]:StdOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - N-Battery"	Proj:RunResultsN[14]:StandardTDV			= {	LocalRef( RunResultsN[14]:StdElecTDV )   }
	"Calculate Elec Demand  - N-Battery"	Proj:RunResultsN[14]:StdElecDemand		= {	if (LocalRef( RunResultsN[14]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec", "BT" ) / 3.412  endif  }

  ; Compliance Total
  ; SAC 1/14/13 - added in PVCredit to Std (elec) TDV
; mjb-10/16/13	remove PVCredit from Std Design
	"Calculate TDV - Elec   - N-Comp Ttl"	Proj:RunResultsN[11]:StdElecTDV			= {	RunResultsN[1]:StdElecTDV    + RunResultsN[2]:StdElecTDV    + RunResultsN[3]:StdElecTDV    + RunResultsN[4]:StdElecTDV    + RunResultsN[5]:StdElecTDV     }
	"Calculate TDV - NatGas - N-Comp Ttl"	Proj:RunResultsN[11]:StdNatGasTDV		= {	RunResultsN[1]:StdNatGasTDV  + RunResultsN[2]:StdNatGasTDV  + RunResultsN[3]:StdNatGasTDV  + RunResultsN[4]:StdNatGasTDV  + RunResultsN[5]:StdNatGasTDV   }
	"Calculate TDV - Other  - N-Comp Ttl"	Proj:RunResultsN[11]:StdOtherTDV			= {	RunResultsN[1]:StdOtherTDV   + RunResultsN[2]:StdOtherTDV   + RunResultsN[3]:StdOtherTDV   + RunResultsN[4]:StdOtherTDV   + RunResultsN[5]:StdOtherTDV    }
	"Calculate TDV - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:StandardTDV			= {	RunResultsN[1]:StandardTDV   + RunResultsN[2]:StandardTDV   + RunResultsN[3]:StandardTDV   + RunResultsN[4]:StandardTDV   + RunResultsN[5]:StandardTDV    }
	"Calculate Elec Demand  - N-Comp Ttl"	Proj:RunResultsN[11]:StdElecDemand		= {	RunResultsN[1]:StdElecDemand + RunResultsN[2]:StdElecDemand + RunResultsN[3]:StdElecDemand + RunResultsN[4]:StdElecDemand + RunResultsN[5]:StdElecDemand  }

  ; Total
	"Calculate TDV - Elec   - N-Total"		Proj:RunResultsN[10]:StdElecTDV			= {	RunResultsN[11]:StdElecTDV    + RunResultsN[6]:StdElecTDV    + RunResultsN[7]:StdElecTDV    + RunResultsN[8]:StdElecTDV    + RunResultsN[9]:StdElecTDV    + RunResultsN[13]:StdElecTDV    + RunResultsN[14]:StdElecTDV     }
	"Calculate TDV - NatGas - N-Total"		Proj:RunResultsN[10]:StdNatGasTDV		= {	RunResultsN[11]:StdNatGasTDV  + RunResultsN[6]:StdNatGasTDV  + RunResultsN[7]:StdNatGasTDV  + RunResultsN[8]:StdNatGasTDV  + RunResultsN[9]:StdNatGasTDV  + RunResultsN[13]:StdNatGasTDV  + RunResultsN[14]:StdNatGasTDV   }
	"Calculate TDV - Other  - N-Total"		Proj:RunResultsN[10]:StdOtherTDV			= {	RunResultsN[11]:StdOtherTDV   + RunResultsN[6]:StdOtherTDV   + RunResultsN[7]:StdOtherTDV   + RunResultsN[8]:StdOtherTDV   + RunResultsN[9]:StdOtherTDV   + RunResultsN[13]:StdOtherTDV   + RunResultsN[14]:StdOtherTDV    }
	"Calculate TDV - TOTAL  - N-Total"		Proj:RunResultsN[10]:StandardTDV			= {	RunResultsN[11]:StandardTDV   + RunResultsN[6]:StandardTDV   + RunResultsN[7]:StandardTDV   + RunResultsN[8]:StandardTDV   + RunResultsN[9]:StandardTDV   + RunResultsN[13]:StandardTDV   + RunResultsN[14]:StandardTDV    }
	"Calculate Elec Demand  - N-Total"		Proj:RunResultsN[10]:StdElecDemand		= {	RunResultsN[11]:StdElecDemand + RunResultsN[6]:StdElecDemand + RunResultsN[7]:StdElecDemand + RunResultsN[8]:StdElecDemand + RunResultsN[9]:StdElecDemand + RunResultsN[13]:StdElecDemand + RunResultsN[14]:StdElecDemand  }


	; SAC 4/2/14 - moved PV credit calcs into subordinate rulelist
	"Set Proj:PVBaseTDV"						Proj:PVBaseTDV	= {	RunResultsN[11]:StandardTDV * CondFloorArea  }		; SAC 4/14/15 - switched from elecTotalTDV to totalCompTDV - was: RunResultsN[10]:StdElecTDV
	"Perform PV calcs if applicable"		Proj:Action		= {	if (PVGenCredit < 1 .OR. StandardsVersion == 2014 .OR. CondFloorArea < 0.01) then  UNCHANGED
																				else	switch ( CompCodeBase )
																							case  2013 :	EvalRulelist( "CARes_CalculatePVCredit_2013Compliance" )
																							case  2016 :	EvalRulelist( "CARes_CalculatePVCredit_2016Compliance" )
																							default    :	UNCHANGED   ; no specific PV credit for 2019 or 2022
																						endswitch  endif  }
	; SAC 4/3/15 - set new EnergyUse:PropPVCreditTDV property (needed to track & pass PVCredit from first to second Proposed EnergyUse data)
	"Store PropPVCreditTDV[1] - N"			Proj:RunResultsN[6]:PropPVCreditTDV[1]		= {	PVCredit[1]  }
	"Store PropPVCreditTDV[1] - E"			Proj:RunResultsE[6]:PropPVCreditTDV[1]		= {	PVCredit[1]  }
	"Store PropPVCreditTDV[1] - S"			Proj:RunResultsS[6]:PropPVCreditTDV[1]		= {	PVCredit[1]  }
	"Store PropPVCreditTDV[1] - W"			Proj:RunResultsW[6]:PropPVCreditTDV[1]		= {	PVCredit[1]  }
; ADJUST certain Proposed results that now are to have PVCredit applied to them
; mjb-10/16/13	subtracted PVCredit from Elec and TOTAL
	"Calculate TDV - Elec   - N-Comp Ttl"	Proj:RunResultsN[11]:PropElecTDV[1]			= {	RunResultsN[11]:PropElecTDV[1]  - PVCredit[1]  }
	"Calculate TDV - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:ProposedTDV[1]			= {	RunResultsN[11]:ProposedTDV[1]  - PVCredit[1]  }
	"Calculate TDV - Elec   - N-Total"		Proj:RunResultsN[10]:PropElecTDV[1]			= {	RunResultsN[10]:PropElecTDV[1]  - PVCredit[1]  }
	"Calculate TDV - TOTAL  - N-Total"		Proj:RunResultsN[10]:ProposedTDV[1]			= {	RunResultsN[10]:ProposedTDV[1]  - PVCredit[1]  }

	"Calculate TDV - Elec   - E-Comp Ttl"	Proj:RunResultsE[11]:PropElecTDV[1]			= {	RunResultsE[11]:PropElecTDV[1]  - PVCredit[1]  }
	"Calculate TDV - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:ProposedTDV[1]			= {	RunResultsE[11]:ProposedTDV[1]  - PVCredit[1]  }
	"Calculate TDV - Elec   - E-Total"		Proj:RunResultsE[10]:PropElecTDV[1]			= {	RunResultsE[10]:PropElecTDV[1]  - PVCredit[1]  }
	"Calculate TDV - TOTAL  - E-Total"		Proj:RunResultsE[10]:ProposedTDV[1]			= {	RunResultsE[10]:ProposedTDV[1]  - PVCredit[1]  }

	"Calculate TDV - Elec   - S-Comp Ttl"	Proj:RunResultsS[11]:PropElecTDV[1]			= {	RunResultsS[11]:PropElecTDV[1]  - PVCredit[1]  }
	"Calculate TDV - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:ProposedTDV[1]			= {	RunResultsS[11]:ProposedTDV[1]  - PVCredit[1]  }
	"Calculate TDV - Elec   - S-Total"		Proj:RunResultsS[10]:PropElecTDV[1]			= {	RunResultsS[10]:PropElecTDV[1]  - PVCredit[1]  }
	"Calculate TDV - TOTAL  - S-Total"		Proj:RunResultsS[10]:ProposedTDV[1]			= {	RunResultsS[10]:ProposedTDV[1]  - PVCredit[1]  }

	"Calculate TDV - Elec   - W-Comp Ttl"	Proj:RunResultsW[11]:PropElecTDV[1]			= {	RunResultsW[11]:PropElecTDV[1]  - PVCredit[1]  }
	"Calculate TDV - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:ProposedTDV[1]			= {	RunResultsW[11]:ProposedTDV[1]  - PVCredit[1]  }
	"Calculate TDV - Elec   - W-Total"		Proj:RunResultsW[10]:PropElecTDV[1]			= {	RunResultsW[10]:PropElecTDV[1]  - PVCredit[1]  }
	"Calculate TDV - TOTAL  - W-Total"		Proj:RunResultsW[10]:ProposedTDV[1]			= {	RunResultsW[10]:ProposedTDV[1]  - PVCredit[1]  }


; -- COPY N results to E --
  ; Space Heating (& heating fan)
	"Calculate TDV - Elec   - E-SpcHt"		Proj:RunResultsE[1]:StdElecTDV			= {	RunResultsN[1]:StdElecTDV        }
	"Calculate TDV - NatGas - E-SpcHt"		Proj:RunResultsE[1]:StdNatGasTDV			= {	RunResultsN[1]:StdNatGasTDV      }
	"Calculate TDV - Other  - E-SpcHt"		Proj:RunResultsE[1]:StdOtherTDV			= {	RunResultsN[1]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - E-SpcHt"		Proj:RunResultsE[1]:StandardTDV			= {	RunResultsN[1]:StandardTDV       }
  ; SAC 8/23/14 - added rules to set elec demand
	"Calculate Elec Demand  - E-SpcHt"		Proj:RunResultsE[1]:StdElecDemand		= {	RunResultsN[1]:StdElecDemand     }
  ; Space Cooling (& cooling fan)                                                                                     
	"Calculate TDV - Elec   - E-SpcCl"		Proj:RunResultsE[2]:StdElecTDV			= {	RunResultsN[2]:StdElecTDV        }
	"Calculate TDV - NatGas - E-SpcCl"		Proj:RunResultsE[2]:StdNatGasTDV			= {	RunResultsN[2]:StdNatGasTDV      }
	"Calculate TDV - Other  - E-SpcCl"		Proj:RunResultsE[2]:StdOtherTDV			= {	RunResultsN[2]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - E-SpcCl"		Proj:RunResultsE[2]:StandardTDV			= {	RunResultsN[2]:StandardTDV       }
	"Calculate Elec Demand  - E-SpcCl"		Proj:RunResultsE[2]:StdElecDemand		= {	RunResultsN[2]:StdElecDemand     }
  ; IAQ Ventilation Fans                                                                                              
	"Calculate TDV - Elec   - E-IAQVent"	Proj:RunResultsE[3]:StdElecTDV			= {	RunResultsN[3]:StdElecTDV        }
	"Calculate TDV - NatGas - E-IAQVent"	Proj:RunResultsE[3]:StdNatGasTDV			= {	RunResultsN[3]:StdNatGasTDV      }
	"Calculate TDV - Other  - E-IAQVent"	Proj:RunResultsE[3]:StdOtherTDV			= {	RunResultsN[3]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - E-IAQVent"	Proj:RunResultsE[3]:StandardTDV			= {	RunResultsN[3]:StandardTDV       }
	"Calculate Elec Demand  - E-IAQVent"	Proj:RunResultsE[3]:StdElecDemand		= {	RunResultsN[3]:StdElecDemand     }
  ; Other HVAC (aux & misc fans)                                                                                      
	"Calculate TDV - Elec   - E-OthrHVAC"	Proj:RunResultsE[4]:StdElecTDV			= {	RunResultsN[4]:StdElecTDV        }
	"Calculate TDV - NatGas - E-OthrHVAC"	Proj:RunResultsE[4]:StdNatGasTDV			= {	RunResultsN[4]:StdNatGasTDV      }
	"Calculate TDV - Other  - E-OthrHVAC"	Proj:RunResultsE[4]:StdOtherTDV			= {	RunResultsN[4]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - E-OthrHVAC"	Proj:RunResultsE[4]:StandardTDV			= {	RunResultsN[4]:StandardTDV       }
	"Calculate Elec Demand  - E-OthrHVAC"	Proj:RunResultsE[4]:StdElecDemand		= {	RunResultsN[4]:StdElecDemand     }
  ; Water Heating                                                                                                     
	"Calculate TDV - Elec   - E-WtrHt"		Proj:RunResultsE[5]:StdElecTDV			= {	RunResultsN[5]:StdElecTDV        }
	"Calculate TDV - NatGas - E-WtrHt"		Proj:RunResultsE[5]:StdNatGasTDV			= {	RunResultsN[5]:StdNatGasTDV      }
	"Calculate TDV - Other  - E-WtrHt"		Proj:RunResultsE[5]:StdOtherTDV			= {	RunResultsN[5]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - E-WtrHt"		Proj:RunResultsE[5]:StandardTDV			= {	RunResultsN[5]:StandardTDV       }
	"Calculate Elec Demand  - E-WtrHt"		Proj:RunResultsE[5]:StdElecDemand		= {	RunResultsN[5]:StdElecDemand     }
  ; Inside Lighting                                                                                                   
	"Calculate TDV - Elec   - E-InsLtg"		Proj:RunResultsE[6]:StdElecTDV			= {	RunResultsN[6]:StdElecTDV        }
	"Calculate TDV - NatGas - E-InsLtg"		Proj:RunResultsE[6]:StdNatGasTDV			= {	RunResultsN[6]:StdNatGasTDV      }
	"Calculate TDV - Other  - E-InsLtg"		Proj:RunResultsE[6]:StdOtherTDV			= {	RunResultsN[6]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - E-InsLtg"		Proj:RunResultsE[6]:StandardTDV			= {	RunResultsN[6]:StandardTDV       }
	"Calculate Elec Demand  - E-InsLtg"		Proj:RunResultsE[6]:StdElecDemand		= {	RunResultsN[6]:StdElecDemand     }
  ; Appliances & Cooking                                                                                              
	"Calculate TDV - Elec   - E-AppCkg"		Proj:RunResultsE[7]:StdElecTDV			= {	RunResultsN[7]:StdElecTDV        }
	"Calculate TDV - NatGas - E-AppCkg"		Proj:RunResultsE[7]:StdNatGasTDV			= {	RunResultsN[7]:StdNatGasTDV      }
	"Calculate TDV - Other  - E-AppCkg"		Proj:RunResultsE[7]:StdOtherTDV			= {	RunResultsN[7]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - E-AppCkg"		Proj:RunResultsE[7]:StandardTDV			= {	RunResultsN[7]:StandardTDV       }
	"Calculate Elec Demand  - E-AppCkg"		Proj:RunResultsE[7]:StdElecDemand		= {	RunResultsN[7]:StdElecDemand     }
  ; Plug Loads                                                                                                        
	"Calculate TDV - Elec   - E-Plugs"		Proj:RunResultsE[8]:StdElecTDV			= {	RunResultsN[8]:StdElecTDV        }
	"Calculate TDV - NatGas - E-Plugs"		Proj:RunResultsE[8]:StdNatGasTDV			= {	RunResultsN[8]:StdNatGasTDV      }
	"Calculate TDV - Other  - E-Plugs"		Proj:RunResultsE[8]:StdOtherTDV			= {	RunResultsN[8]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - E-Plugs"		Proj:RunResultsE[8]:StandardTDV			= {	RunResultsN[8]:StandardTDV       }
	"Calculate Elec Demand  - E-Plugs"		Proj:RunResultsE[8]:StdElecDemand		= {	RunResultsN[8]:StdElecDemand     }
  ; Exterior                                                                                                          
	"Calculate TDV - Elec   - E-Ext"			Proj:RunResultsE[9]:StdElecTDV			= {	RunResultsN[9]:StdElecTDV        }
	"Calculate TDV - NatGas - E-Ext"			Proj:RunResultsE[9]:StdNatGasTDV			= {	RunResultsN[9]:StdNatGasTDV      }
	"Calculate TDV - Other  - E-Ext"			Proj:RunResultsE[9]:StdOtherTDV			= {	RunResultsN[9]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - E-Ext"			Proj:RunResultsE[9]:StandardTDV			= {	RunResultsN[9]:StandardTDV       }
	"Calculate Elec Demand  - E-Ext"			Proj:RunResultsE[9]:StdElecDemand		= {	RunResultsN[9]:StdElecDemand     }
  ; PV
	"Calculate TDV - Elec   - E-PV"			Proj:RunResultsE[13]:StdElecTDV			= {	RunResultsN[13]:StdElecTDV       }
	"Calculate TDV - NatGas - E-PV"			Proj:RunResultsE[13]:StdNatGasTDV		= {	RunResultsN[13]:StdNatGasTDV     }
	"Calculate TDV - Other  - E-PV"			Proj:RunResultsE[13]:StdOtherTDV			= {	RunResultsN[13]:StdOtherTDV      }
	"Calculate TDV - TOTAL  - E-PV"			Proj:RunResultsE[13]:StandardTDV			= {	RunResultsN[13]:StandardTDV      }
	"Calculate Elec Demand  - E-PV"			Proj:RunResultsE[13]:StdElecDemand		= {	RunResultsN[13]:StdElecDemand    }
  ; Battery
	"Calculate TDV - Elec   - E-Battery"	Proj:RunResultsE[14]:StdElecTDV			= {	RunResultsN[14]:StdElecTDV       }
	"Calculate TDV - NatGas - E-Battery"	Proj:RunResultsE[14]:StdNatGasTDV		= {	RunResultsN[14]:StdNatGasTDV     }
	"Calculate TDV - Other  - E-Battery"	Proj:RunResultsE[14]:StdOtherTDV			= {	RunResultsN[14]:StdOtherTDV      }
	"Calculate TDV - TOTAL  - E-Battery"	Proj:RunResultsE[14]:StandardTDV			= {	RunResultsN[14]:StandardTDV      }
	"Calculate Elec Demand  - E-Battery"	Proj:RunResultsE[14]:StdElecDemand		= {	RunResultsN[14]:StdElecDemand    }
  ; Compliance Total                                                                                                  
	"Calculate TDV - Elec   - E-Comp Ttl"	Proj:RunResultsE[11]:StdElecTDV			= {	RunResultsN[11]:StdElecTDV       }
	"Calculate TDV - NatGas - E-Comp Ttl"	Proj:RunResultsE[11]:StdNatGasTDV		= {	RunResultsN[11]:StdNatGasTDV     }
	"Calculate TDV - Other  - E-Comp Ttl"	Proj:RunResultsE[11]:StdOtherTDV			= {	RunResultsN[11]:StdOtherTDV      }
	"Calculate TDV - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:StandardTDV			= {	RunResultsN[11]:StandardTDV      }
	"Calculate Elec Demand  - E-Comp Ttl"	Proj:RunResultsE[11]:StdElecDemand		= {	RunResultsN[11]:StdElecDemand    }
  ; Total                                                                                                             
	"Calculate TDV - Elec   - E-Total"		Proj:RunResultsE[10]:StdElecTDV			= {	RunResultsN[10]:StdElecTDV       }
	"Calculate TDV - NatGas - E-Total"		Proj:RunResultsE[10]:StdNatGasTDV		= {	RunResultsN[10]:StdNatGasTDV     }
	"Calculate TDV - Other  - E-Total"		Proj:RunResultsE[10]:StdOtherTDV			= {	RunResultsN[10]:StdOtherTDV      }
	"Calculate TDV - TOTAL  - E-Total"		Proj:RunResultsE[10]:StandardTDV			= {	RunResultsN[10]:StandardTDV      }
	"Calculate Elec Demand  - E-Total"		Proj:RunResultsE[10]:StdElecDemand		= {	RunResultsN[10]:StdElecDemand    }

; -- COPY N results to S --
  ; Space Heating (& heating fan)
	"Calculate TDV - Elec   - S-SpcHt"		Proj:RunResultsS[1]:StdElecTDV			= {	RunResultsN[1]:StdElecTDV        }
	"Calculate TDV - NatGas - S-SpcHt"		Proj:RunResultsS[1]:StdNatGasTDV			= {	RunResultsN[1]:StdNatGasTDV      }
	"Calculate TDV - Other  - S-SpcHt"		Proj:RunResultsS[1]:StdOtherTDV			= {	RunResultsN[1]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - S-SpcHt"		Proj:RunResultsS[1]:StandardTDV			= {	RunResultsN[1]:StandardTDV       }
	"Calculate Elec Demand  - S-SpcHt"		Proj:RunResultsS[1]:StdElecDemand		= {	RunResultsN[1]:StdElecDemand     }
  ; Space Cooling (& cooling fan)                                                                                     
	"Calculate TDV - Elec   - S-SpcCl"		Proj:RunResultsS[2]:StdElecTDV			= {	RunResultsN[2]:StdElecTDV        }
	"Calculate TDV - NatGas - S-SpcCl"		Proj:RunResultsS[2]:StdNatGasTDV			= {	RunResultsN[2]:StdNatGasTDV      }
	"Calculate TDV - Other  - S-SpcCl"		Proj:RunResultsS[2]:StdOtherTDV			= {	RunResultsN[2]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - S-SpcCl"		Proj:RunResultsS[2]:StandardTDV			= {	RunResultsN[2]:StandardTDV       }
	"Calculate Elec Demand  - S-SpcCl"     Proj:RunResultsS[2]:StdElecDemand		= {	RunResultsN[2]:StdElecDemand     }
  ; IAQ Ventilation Fans                                                                                              
	"Calculate TDV - Elec   - S-IAQVent"	Proj:RunResultsS[3]:StdElecTDV			= {	RunResultsN[3]:StdElecTDV        }
	"Calculate TDV - NatGas - S-IAQVent"	Proj:RunResultsS[3]:StdNatGasTDV			= {	RunResultsN[3]:StdNatGasTDV      }
	"Calculate TDV - Other  - S-IAQVent"	Proj:RunResultsS[3]:StdOtherTDV			= {	RunResultsN[3]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - S-IAQVent"	Proj:RunResultsS[3]:StandardTDV			= {	RunResultsN[3]:StandardTDV       }
	"Calculate Elec Demand  - S-IAQVent"   Proj:RunResultsS[3]:StdElecDemand		= {	RunResultsN[3]:StdElecDemand     }
  ; Other HVAC (aux & misc fans)                                                                                      
	"Calculate TDV - Elec   - S-OthrHVAC"	Proj:RunResultsS[4]:StdElecTDV			= {	RunResultsN[4]:StdElecTDV        }
	"Calculate TDV - NatGas - S-OthrHVAC"	Proj:RunResultsS[4]:StdNatGasTDV			= {	RunResultsN[4]:StdNatGasTDV      }
	"Calculate TDV - Other  - S-OthrHVAC"	Proj:RunResultsS[4]:StdOtherTDV			= {	RunResultsN[4]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - S-OthrHVAC"	Proj:RunResultsS[4]:StandardTDV			= {	RunResultsN[4]:StandardTDV       }
	"Calculate Elec Demand  - S-OthrHVAC"  Proj:RunResultsS[4]:StdElecDemand		= {	RunResultsN[4]:StdElecDemand     }
  ; Water Heating                                                                                                     
	"Calculate TDV - Elec   - S-WtrHt"		Proj:RunResultsS[5]:StdElecTDV			= {	RunResultsN[5]:StdElecTDV        }
	"Calculate TDV - NatGas - S-WtrHt"		Proj:RunResultsS[5]:StdNatGasTDV			= {	RunResultsN[5]:StdNatGasTDV      }
	"Calculate TDV - Other  - S-WtrHt"		Proj:RunResultsS[5]:StdOtherTDV			= {	RunResultsN[5]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - S-WtrHt"		Proj:RunResultsS[5]:StandardTDV			= {	RunResultsN[5]:StandardTDV       }
	"Calculate Elec Demand  - S-WtrHt"     Proj:RunResultsS[5]:StdElecDemand		= {	RunResultsN[5]:StdElecDemand     }
  ; Inside Lighting                                                                                                   
	"Calculate TDV - Elec   - S-InsLtg"		Proj:RunResultsS[6]:StdElecTDV			= {	RunResultsN[6]:StdElecTDV        }
	"Calculate TDV - NatGas - S-InsLtg"		Proj:RunResultsS[6]:StdNatGasTDV			= {	RunResultsN[6]:StdNatGasTDV      }
	"Calculate TDV - Other  - S-InsLtg"		Proj:RunResultsS[6]:StdOtherTDV			= {	RunResultsN[6]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - S-InsLtg"		Proj:RunResultsS[6]:StandardTDV			= {	RunResultsN[6]:StandardTDV       }
	"Calculate Elec Demand  - S-InsLtg"    Proj:RunResultsS[6]:StdElecDemand		= {	RunResultsN[6]:StdElecDemand     }
  ; Appliances & Cooking                                                                                              
	"Calculate TDV - Elec   - S-AppCkg"		Proj:RunResultsS[7]:StdElecTDV			= {	RunResultsN[7]:StdElecTDV        }
	"Calculate TDV - NatGas - S-AppCkg"		Proj:RunResultsS[7]:StdNatGasTDV			= {	RunResultsN[7]:StdNatGasTDV      }
	"Calculate TDV - Other  - S-AppCkg"		Proj:RunResultsS[7]:StdOtherTDV			= {	RunResultsN[7]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - S-AppCkg"		Proj:RunResultsS[7]:StandardTDV			= {	RunResultsN[7]:StandardTDV       }
	"Calculate Elec Demand  - S-AppCkg"    Proj:RunResultsS[7]:StdElecDemand		= {	RunResultsN[7]:StdElecDemand     }
  ; Plug Loads                                                                                                        
	"Calculate TDV - Elec   - S-Plugs"		Proj:RunResultsS[8]:StdElecTDV			= {	RunResultsN[8]:StdElecTDV        }
	"Calculate TDV - NatGas - S-Plugs"		Proj:RunResultsS[8]:StdNatGasTDV			= {	RunResultsN[8]:StdNatGasTDV      }
	"Calculate TDV - Other  - S-Plugs"		Proj:RunResultsS[8]:StdOtherTDV			= {	RunResultsN[8]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - S-Plugs"		Proj:RunResultsS[8]:StandardTDV			= {	RunResultsN[8]:StandardTDV       }
	"Calculate Elec Demand  - S-Plugs"     Proj:RunResultsS[8]:StdElecDemand		= {	RunResultsN[8]:StdElecDemand     }
  ; Exterior                                                                                                          
	"Calculate TDV - Elec   - S-Ext"			Proj:RunResultsS[9]:StdElecTDV			= {	RunResultsN[9]:StdElecTDV        }
	"Calculate TDV - NatGas - S-Ext"			Proj:RunResultsS[9]:StdNatGasTDV			= {	RunResultsN[9]:StdNatGasTDV      }
	"Calculate TDV - Other  - S-Ext"			Proj:RunResultsS[9]:StdOtherTDV			= {	RunResultsN[9]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - S-Ext"			Proj:RunResultsS[9]:StandardTDV			= {	RunResultsN[9]:StandardTDV       }
	"Calculate Elec Demand  - S-Ext"       Proj:RunResultsS[9]:StdElecDemand		= {	RunResultsN[9]:StdElecDemand     }
  ; PV
	"Calculate TDV - Elec   - S-PV"			Proj:RunResultsS[13]:StdElecTDV			= {	RunResultsN[13]:StdElecTDV       }
	"Calculate TDV - NatGas - S-PV"			Proj:RunResultsS[13]:StdNatGasTDV		= {	RunResultsN[13]:StdNatGasTDV     }
	"Calculate TDV - Other  - S-PV"			Proj:RunResultsS[13]:StdOtherTDV			= {	RunResultsN[13]:StdOtherTDV      }
	"Calculate TDV - TOTAL  - S-PV"			Proj:RunResultsS[13]:StandardTDV			= {	RunResultsN[13]:StandardTDV      }
	"Calculate Elec Demand  - S-PV"			Proj:RunResultsS[13]:StdElecDemand		= {	RunResultsN[13]:StdElecDemand    }
  ; Battery
	"Calculate TDV - Elec   - S-Battery"	Proj:RunResultsS[14]:StdElecTDV			= {	RunResultsN[14]:StdElecTDV       }
	"Calculate TDV - NatGas - S-Battery"	Proj:RunResultsS[14]:StdNatGasTDV		= {	RunResultsN[14]:StdNatGasTDV     }
	"Calculate TDV - Other  - S-Battery"	Proj:RunResultsS[14]:StdOtherTDV			= {	RunResultsN[14]:StdOtherTDV      }
	"Calculate TDV - TOTAL  - S-Battery"	Proj:RunResultsS[14]:StandardTDV			= {	RunResultsN[14]:StandardTDV      }
	"Calculate Elec Demand  - S-Battery"	Proj:RunResultsS[14]:StdElecDemand		= {	RunResultsN[14]:StdElecDemand    }
  ; Compliance Total                                                                                                  
	"Calculate TDV - Elec   - S-Comp Ttl"	Proj:RunResultsS[11]:StdElecTDV			= {	RunResultsN[11]:StdElecTDV       }
	"Calculate TDV - NatGas - S-Comp Ttl"	Proj:RunResultsS[11]:StdNatGasTDV		= {	RunResultsN[11]:StdNatGasTDV     }
	"Calculate TDV - Other  - S-Comp Ttl"	Proj:RunResultsS[11]:StdOtherTDV			= {	RunResultsN[11]:StdOtherTDV      }
	"Calculate TDV - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:StandardTDV			= {	RunResultsN[11]:StandardTDV      }
	"Calculate Elec Demand  - S-Comp Ttl"  Proj:RunResultsS[11]:StdElecDemand		= {	RunResultsN[11]:StdElecDemand    }
  ; Total                                                                                                             
	"Calculate TDV - Elec   - S-Total"		Proj:RunResultsS[10]:StdElecTDV			= {	RunResultsN[10]:StdElecTDV       }
	"Calculate TDV - NatGas - S-Total"		Proj:RunResultsS[10]:StdNatGasTDV		= {	RunResultsN[10]:StdNatGasTDV     }
	"Calculate TDV - Other  - S-Total"		Proj:RunResultsS[10]:StdOtherTDV			= {	RunResultsN[10]:StdOtherTDV      }
	"Calculate TDV - TOTAL  - S-Total"		Proj:RunResultsS[10]:StandardTDV			= {	RunResultsN[10]:StandardTDV      }
	"Calculate Elec Demand  - S-Total"     Proj:RunResultsS[10]:StdElecDemand		= {	RunResultsN[10]:StdElecDemand    }

; -- COPY N results to W --
  ; Space Heating (& heating fan)
	"Calculate TDV - Elec   - W-SpcHt"		Proj:RunResultsW[1]:StdElecTDV			= {	RunResultsN[1]:StdElecTDV        }
	"Calculate TDV - NatGas - W-SpcHt"		Proj:RunResultsW[1]:StdNatGasTDV			= {	RunResultsN[1]:StdNatGasTDV      }
	"Calculate TDV - Other  - W-SpcHt"		Proj:RunResultsW[1]:StdOtherTDV			= {	RunResultsN[1]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - W-SpcHt"		Proj:RunResultsW[1]:StandardTDV			= {	RunResultsN[1]:StandardTDV       }
	"Calculate Elec Demand  - W-SpcHt"		Proj:RunResultsW[1]:StdElecDemand		= {	RunResultsN[1]:StdElecDemand     }
  ; Space Cooling (& cooling fan)                                                                                     
	"Calculate TDV - Elec   - W-SpcCl"		Proj:RunResultsW[2]:StdElecTDV			= {	RunResultsN[2]:StdElecTDV        }
	"Calculate TDV - NatGas - W-SpcCl"		Proj:RunResultsW[2]:StdNatGasTDV			= {	RunResultsN[2]:StdNatGasTDV      }
	"Calculate TDV - Other  - W-SpcCl"		Proj:RunResultsW[2]:StdOtherTDV			= {	RunResultsN[2]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - W-SpcCl"		Proj:RunResultsW[2]:StandardTDV			= {	RunResultsN[2]:StandardTDV       }
	"Calculate Elec Demand  - W-SpcCl"     Proj:RunResultsW[2]:StdElecDemand		= {	RunResultsN[2]:StdElecDemand     }
  ; IAQ Ventilation Fans                                                                                              
	"Calculate TDV - Elec   - W-IAQVent"	Proj:RunResultsW[3]:StdElecTDV			= {	RunResultsN[3]:StdElecTDV        }
	"Calculate TDV - NatGas - W-IAQVent"	Proj:RunResultsW[3]:StdNatGasTDV			= {	RunResultsN[3]:StdNatGasTDV      }
	"Calculate TDV - Other  - W-IAQVent"	Proj:RunResultsW[3]:StdOtherTDV			= {	RunResultsN[3]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - W-IAQVent"	Proj:RunResultsW[3]:StandardTDV			= {	RunResultsN[3]:StandardTDV       }
	"Calculate Elec Demand  - W-IAQVent"   Proj:RunResultsW[3]:StdElecDemand		= {	RunResultsN[3]:StdElecDemand     }
  ; Other HVAC (aux & misc fans)                                                                                      
	"Calculate TDV - Elec   - W-OthrHVAC"	Proj:RunResultsW[4]:StdElecTDV			= {	RunResultsN[4]:StdElecTDV        }
	"Calculate TDV - NatGas - W-OthrHVAC"	Proj:RunResultsW[4]:StdNatGasTDV			= {	RunResultsN[4]:StdNatGasTDV      }
	"Calculate TDV - Other  - W-OthrHVAC"	Proj:RunResultsW[4]:StdOtherTDV			= {	RunResultsN[4]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - W-OthrHVAC"	Proj:RunResultsW[4]:StandardTDV			= {	RunResultsN[4]:StandardTDV       }
	"Calculate Elec Demand  - W-OthrHVAC"  Proj:RunResultsW[4]:StdElecDemand		= {	RunResultsN[4]:StdElecDemand     }
  ; Water Heating                                                                                                     
	"Calculate TDV - Elec   - W-WtrHt"		Proj:RunResultsW[5]:StdElecTDV			= {	RunResultsN[5]:StdElecTDV        }
	"Calculate TDV - NatGas - W-WtrHt"		Proj:RunResultsW[5]:StdNatGasTDV			= {	RunResultsN[5]:StdNatGasTDV      }
	"Calculate TDV - Other  - W-WtrHt"		Proj:RunResultsW[5]:StdOtherTDV			= {	RunResultsN[5]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - W-WtrHt"		Proj:RunResultsW[5]:StandardTDV			= {	RunResultsN[5]:StandardTDV       }
	"Calculate Elec Demand  - W-WtrHt"     Proj:RunResultsW[5]:StdElecDemand		= {	RunResultsN[5]:StdElecDemand     }
  ; Inside Lighting                                                                                                   
	"Calculate TDV - Elec   - W-InsLtg"		Proj:RunResultsW[6]:StdElecTDV			= {	RunResultsN[6]:StdElecTDV        }
	"Calculate TDV - NatGas - W-InsLtg"		Proj:RunResultsW[6]:StdNatGasTDV			= {	RunResultsN[6]:StdNatGasTDV      }
	"Calculate TDV - Other  - W-InsLtg"		Proj:RunResultsW[6]:StdOtherTDV			= {	RunResultsN[6]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - W-InsLtg"		Proj:RunResultsW[6]:StandardTDV			= {	RunResultsN[6]:StandardTDV       }
	"Calculate Elec Demand  - W-InsLtg"    Proj:RunResultsW[6]:StdElecDemand		= {	RunResultsN[6]:StdElecDemand     }
  ; Appliances & Cooking                                                                                              
	"Calculate TDV - Elec   - W-AppCkg"		Proj:RunResultsW[7]:StdElecTDV			= {	RunResultsN[7]:StdElecTDV        }
	"Calculate TDV - NatGas - W-AppCkg"		Proj:RunResultsW[7]:StdNatGasTDV			= {	RunResultsN[7]:StdNatGasTDV      }
	"Calculate TDV - Other  - W-AppCkg"		Proj:RunResultsW[7]:StdOtherTDV			= {	RunResultsN[7]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - W-AppCkg"		Proj:RunResultsW[7]:StandardTDV			= {	RunResultsN[7]:StandardTDV       }
	"Calculate Elec Demand  - W-AppCkg"    Proj:RunResultsW[7]:StdElecDemand		= {	RunResultsN[7]:StdElecDemand     }
  ; Plug Loads                                                                                                        
	"Calculate TDV - Elec   - W-Plugs"		Proj:RunResultsW[8]:StdElecTDV			= {	RunResultsN[8]:StdElecTDV        }
	"Calculate TDV - NatGas - W-Plugs"		Proj:RunResultsW[8]:StdNatGasTDV			= {	RunResultsN[8]:StdNatGasTDV      }
	"Calculate TDV - Other  - W-Plugs"		Proj:RunResultsW[8]:StdOtherTDV			= {	RunResultsN[8]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - W-Plugs"		Proj:RunResultsW[8]:StandardTDV			= {	RunResultsN[8]:StandardTDV       }
	"Calculate Elec Demand  - W-Plugs"     Proj:RunResultsW[8]:StdElecDemand		= {	RunResultsN[8]:StdElecDemand     }
  ; Exterior                                                                                                          
	"Calculate TDV - Elec   - W-Ext"			Proj:RunResultsW[9]:StdElecTDV			= {	RunResultsN[9]:StdElecTDV        }
	"Calculate TDV - NatGas - W-Ext"			Proj:RunResultsW[9]:StdNatGasTDV			= {	RunResultsN[9]:StdNatGasTDV      }
	"Calculate TDV - Other  - W-Ext"			Proj:RunResultsW[9]:StdOtherTDV			= {	RunResultsN[9]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - W-Ext"			Proj:RunResultsW[9]:StandardTDV			= {	RunResultsN[9]:StandardTDV       }
	"Calculate Elec Demand  - W-Ext"       Proj:RunResultsW[9]:StdElecDemand		= {	RunResultsN[9]:StdElecDemand     }
  ; PV
	"Calculate TDV - Elec   - W-PV"			Proj:RunResultsW[13]:StdElecTDV			= {	RunResultsN[13]:StdElecTDV       }
	"Calculate TDV - NatGas - W-PV"			Proj:RunResultsW[13]:StdNatGasTDV		= {	RunResultsN[13]:StdNatGasTDV     }
	"Calculate TDV - Other  - W-PV"			Proj:RunResultsW[13]:StdOtherTDV			= {	RunResultsN[13]:StdOtherTDV      }
	"Calculate TDV - TOTAL  - W-PV"			Proj:RunResultsW[13]:StandardTDV			= {	RunResultsN[13]:StandardTDV      }
	"Calculate Elec Demand  - W-PV"			Proj:RunResultsW[13]:StdElecDemand		= {	RunResultsN[13]:StdElecDemand    }
  ; Battery
	"Calculate TDV - Elec   - W-Battery"   Proj:RunResultsW[14]:StdElecTDV			= {	RunResultsN[14]:StdElecTDV       }
	"Calculate TDV - NatGas - W-Battery"	Proj:RunResultsW[14]:StdNatGasTDV		= {	RunResultsN[14]:StdNatGasTDV     }
	"Calculate TDV - Other  - W-Battery"	Proj:RunResultsW[14]:StdOtherTDV			= {	RunResultsN[14]:StdOtherTDV      }
	"Calculate TDV - TOTAL  - W-Battery"	Proj:RunResultsW[14]:StandardTDV			= {	RunResultsN[14]:StandardTDV      }
	"Calculate Elec Demand  - W-Battery"	Proj:RunResultsW[14]:StdElecDemand		= {	RunResultsN[14]:StdElecDemand    }
  ; Compliance Total                                                                                                  
	"Calculate TDV - Elec   - W-Comp Ttl"	Proj:RunResultsW[11]:StdElecTDV			= {	RunResultsN[11]:StdElecTDV       }
	"Calculate TDV - NatGas - W-Comp Ttl"	Proj:RunResultsW[11]:StdNatGasTDV		= {	RunResultsN[11]:StdNatGasTDV     }
	"Calculate TDV - Other  - W-Comp Ttl"	Proj:RunResultsW[11]:StdOtherTDV			= {	RunResultsN[11]:StdOtherTDV      }
	"Calculate TDV - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:StandardTDV			= {	RunResultsN[11]:StandardTDV      }
	"Calculate Elec Demand  - W-Comp Ttl"	Proj:RunResultsW[11]:StdElecDemand		= {	RunResultsN[11]:StdElecDemand    }
  ; Total                                                                                                             
	"Calculate TDV - Elec   - W-Total"		Proj:RunResultsW[10]:StdElecTDV			= {	RunResultsN[10]:StdElecTDV       }
	"Calculate TDV - NatGas - W-Total"		Proj:RunResultsW[10]:StdNatGasTDV		= {	RunResultsN[10]:StdNatGasTDV     }
	"Calculate TDV - Other  - W-Total"		Proj:RunResultsW[10]:StdOtherTDV			= {	RunResultsN[10]:StdOtherTDV      }
	"Calculate TDV - TOTAL  - W-Total"		Proj:RunResultsW[10]:StandardTDV			= {	RunResultsN[10]:StandardTDV      }
	"Calculate Elec Demand  - W-Total"     Proj:RunResultsW[10]:StdElecDemand		= {	RunResultsN[10]:StdElecDemand    }


  ; Compliance Margins - NORTH
	"Calc TDV Comp Margin - N-SpcHt"    	Proj:RunResultsN[1]:CompMarginTDV	= {	LocalRef( RunResultsN[1]:StandardTDV  ) - LocalRef( RunResultsN[1]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - N-SpcCl"    	Proj:RunResultsN[2]:CompMarginTDV	= {	LocalRef( RunResultsN[2]:StandardTDV  ) - LocalRef( RunResultsN[2]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - N-IAQVent"  	Proj:RunResultsN[3]:CompMarginTDV	= {	LocalRef( RunResultsN[3]:StandardTDV  ) - LocalRef( RunResultsN[3]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - N-OthrHVAC" 	Proj:RunResultsN[4]:CompMarginTDV	= {	LocalRef( RunResultsN[4]:StandardTDV  ) - LocalRef( RunResultsN[4]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - N-WtrHt"    	Proj:RunResultsN[5]:CompMarginTDV	= {	LocalRef( RunResultsN[5]:StandardTDV  ) - LocalRef( RunResultsN[5]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - N-InsLtg"   	Proj:RunResultsN[6]:CompMarginTDV	= {	LocalRef( RunResultsN[6]:StandardTDV  ) - LocalRef( RunResultsN[6]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - N-AppCkg"   	Proj:RunResultsN[7]:CompMarginTDV	= {	LocalRef( RunResultsN[7]:StandardTDV  ) - LocalRef( RunResultsN[7]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - N-Plugs"    	Proj:RunResultsN[8]:CompMarginTDV	= {	LocalRef( RunResultsN[8]:StandardTDV  ) - LocalRef( RunResultsN[8]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - N-Ext"      	Proj:RunResultsN[9]:CompMarginTDV	= {	LocalRef( RunResultsN[9]:StandardTDV  ) - LocalRef( RunResultsN[9]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - N-PV"     	 	Proj:RunResultsN[13]:CompMarginTDV	= {	LocalRef( RunResultsN[13]:StandardTDV ) - LocalRef( RunResultsN[13]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - N-Battery"     Proj:RunResultsN[14]:CompMarginTDV	= {	LocalRef( RunResultsN[14]:StandardTDV ) - LocalRef( RunResultsN[14]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - N-Total"    	Proj:RunResultsN[10]:CompMarginTDV	= {	LocalRef( RunResultsN[10]:StandardTDV ) - LocalRef( RunResultsN[10]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - N-Comp Ttl" 	Proj:RunResultsN[11]:CompMarginTDV	= {	LocalRef( RunResultsN[11]:StandardTDV ) - LocalRef( RunResultsN[11]:ProposedTDV[1] )   }
  ; Percent Improvement
	"Calc TDV Pct Improve - N-SpcHt"    	Proj:RunResultsN[1]:PctImproveTDV	= {	if (LocalRef( RunResultsN[1]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsN[1]:CompMarginTDV  ) * 100 / LocalRef( RunResultsN[1]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - N-SpcCl"    	Proj:RunResultsN[2]:PctImproveTDV	= {	if (LocalRef( RunResultsN[2]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsN[2]:CompMarginTDV  ) * 100 / LocalRef( RunResultsN[2]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - N-IAQVent"  	Proj:RunResultsN[3]:PctImproveTDV	= {	if (LocalRef( RunResultsN[3]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsN[3]:CompMarginTDV  ) * 100 / LocalRef( RunResultsN[3]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - N-OthrHVAC" 	Proj:RunResultsN[4]:PctImproveTDV	= {	if (LocalRef( RunResultsN[4]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsN[4]:CompMarginTDV  ) * 100 / LocalRef( RunResultsN[4]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - N-WtrHt"    	Proj:RunResultsN[5]:PctImproveTDV	= {	if (LocalRef( RunResultsN[5]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsN[5]:CompMarginTDV  ) * 100 / LocalRef( RunResultsN[5]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - N-InsLtg"   	Proj:RunResultsN[6]:PctImproveTDV	= {	if (LocalRef( RunResultsN[6]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsN[6]:CompMarginTDV  ) * 100 / LocalRef( RunResultsN[6]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - N-AppCkg"   	Proj:RunResultsN[7]:PctImproveTDV	= {	if (LocalRef( RunResultsN[7]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsN[7]:CompMarginTDV  ) * 100 / LocalRef( RunResultsN[7]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - N-Plugs"    	Proj:RunResultsN[8]:PctImproveTDV	= {	if (LocalRef( RunResultsN[8]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsN[8]:CompMarginTDV  ) * 100 / LocalRef( RunResultsN[8]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - N-Ext"      	Proj:RunResultsN[9]:PctImproveTDV	= {	if (LocalRef( RunResultsN[9]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsN[9]:CompMarginTDV  ) * 100 / LocalRef( RunResultsN[9]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - N-PV"     	 	Proj:RunResultsN[13]:PctImproveTDV	= {	if (LocalRef( RunResultsN[13]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsN[13]:CompMarginTDV ) * 100 / LocalRef( RunResultsN[13]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - N-Battery"     Proj:RunResultsN[14]:PctImproveTDV	= {	if (LocalRef( RunResultsN[14]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsN[14]:CompMarginTDV ) * 100 / LocalRef( RunResultsN[14]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - N-Total"    	Proj:RunResultsN[10]:PctImproveTDV	= {	if (LocalRef( RunResultsN[10]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsN[10]:CompMarginTDV ) * 100 / LocalRef( RunResultsN[10]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - N-Comp Ttl"  	Proj:RunResultsN[11]:PctImproveTDV	= {	if (LocalRef( RunResultsN[11]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsN[11]:CompMarginTDV ) * 100 / LocalRef( RunResultsN[11]:StandardTDV )  endif  }
  ; Delta Demand   - SAC 8/23/14
	"Calc Delta El Demand - N-SpcHt"    	Proj:RunResultsN[1]:DeltaDemand		= {	LocalRef( RunResultsN[1]:StdElecDemand  ) - LocalRef( RunResultsN[1]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - N-SpcCl"    	Proj:RunResultsN[2]:DeltaDemand		= {	LocalRef( RunResultsN[2]:StdElecDemand  ) - LocalRef( RunResultsN[2]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - N-IAQVent"  	Proj:RunResultsN[3]:DeltaDemand		= {	LocalRef( RunResultsN[3]:StdElecDemand  ) - LocalRef( RunResultsN[3]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - N-OthrHVAC" 	Proj:RunResultsN[4]:DeltaDemand		= {	LocalRef( RunResultsN[4]:StdElecDemand  ) - LocalRef( RunResultsN[4]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - N-WtrHt"    	Proj:RunResultsN[5]:DeltaDemand		= {	LocalRef( RunResultsN[5]:StdElecDemand  ) - LocalRef( RunResultsN[5]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - N-InsLtg"   	Proj:RunResultsN[6]:DeltaDemand		= {	LocalRef( RunResultsN[6]:StdElecDemand  ) - LocalRef( RunResultsN[6]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - N-AppCkg"   	Proj:RunResultsN[7]:DeltaDemand		= {	LocalRef( RunResultsN[7]:StdElecDemand  ) - LocalRef( RunResultsN[7]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - N-Plugs"    	Proj:RunResultsN[8]:DeltaDemand		= {	LocalRef( RunResultsN[8]:StdElecDemand  ) - LocalRef( RunResultsN[8]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - N-Ext"      	Proj:RunResultsN[9]:DeltaDemand		= {	LocalRef( RunResultsN[9]:StdElecDemand  ) - LocalRef( RunResultsN[9]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - N-PV"      		Proj:RunResultsN[13]:DeltaDemand		= {	LocalRef( RunResultsN[13]:StdElecDemand ) - LocalRef( RunResultsN[13]:PropElecDemand[1] )   }
	"Calc Delta El Demand - N-Battery"     Proj:RunResultsN[14]:DeltaDemand		= {	LocalRef( RunResultsN[14]:StdElecDemand ) - LocalRef( RunResultsN[14]:PropElecDemand[1] )   }
	"Calc Delta El Demand - N-Total"    	Proj:RunResultsN[10]:DeltaDemand		= {	LocalRef( RunResultsN[10]:StdElecDemand ) - LocalRef( RunResultsN[10]:PropElecDemand[1] )   }
	"Calc Delta El Demand - N-Comp Ttl" 	Proj:RunResultsN[11]:DeltaDemand		= {	LocalRef( RunResultsN[11]:StdElecDemand ) - LocalRef( RunResultsN[11]:PropElecDemand[1] )   }

  ; Compliance Margins - EAST
	"Calc TDV Comp Margin - E-SpcHt"    	Proj:RunResultsE[1]:CompMarginTDV	= {	LocalRef( RunResultsE[1]:StandardTDV  ) - LocalRef( RunResultsE[1]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - E-SpcCl"    	Proj:RunResultsE[2]:CompMarginTDV	= {	LocalRef( RunResultsE[2]:StandardTDV  ) - LocalRef( RunResultsE[2]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - E-IAQVent"  	Proj:RunResultsE[3]:CompMarginTDV	= {	LocalRef( RunResultsE[3]:StandardTDV  ) - LocalRef( RunResultsE[3]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - E-OthrHVAC" 	Proj:RunResultsE[4]:CompMarginTDV	= {	LocalRef( RunResultsE[4]:StandardTDV  ) - LocalRef( RunResultsE[4]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - E-WtrHt"    	Proj:RunResultsE[5]:CompMarginTDV	= {	LocalRef( RunResultsE[5]:StandardTDV  ) - LocalRef( RunResultsE[5]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - E-InsLtg"   	Proj:RunResultsE[6]:CompMarginTDV	= {	LocalRef( RunResultsE[6]:StandardTDV  ) - LocalRef( RunResultsE[6]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - E-AppCkg"   	Proj:RunResultsE[7]:CompMarginTDV	= {	LocalRef( RunResultsE[7]:StandardTDV  ) - LocalRef( RunResultsE[7]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - E-Plugs"    	Proj:RunResultsE[8]:CompMarginTDV	= {	LocalRef( RunResultsE[8]:StandardTDV  ) - LocalRef( RunResultsE[8]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - E-Ext"      	Proj:RunResultsE[9]:CompMarginTDV	= {	LocalRef( RunResultsE[9]:StandardTDV  ) - LocalRef( RunResultsE[9]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - E-PV"     	 	Proj:RunResultsE[13]:CompMarginTDV	= {	LocalRef( RunResultsE[13]:StandardTDV ) - LocalRef( RunResultsE[13]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - E-Battery"     Proj:RunResultsE[14]:CompMarginTDV	= {	LocalRef( RunResultsE[14]:StandardTDV ) - LocalRef( RunResultsE[14]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - E-Total"    	Proj:RunResultsE[10]:CompMarginTDV	= {	LocalRef( RunResultsE[10]:StandardTDV ) - LocalRef( RunResultsE[10]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - E-Comp Ttl" 	Proj:RunResultsE[11]:CompMarginTDV	= {	LocalRef( RunResultsE[11]:StandardTDV ) - LocalRef( RunResultsE[11]:ProposedTDV[1] )   }
  ; Percent Improvement
	"Calc TDV Pct Improve - E-SpcHt"    	Proj:RunResultsE[1]:PctImproveTDV	= {	if (LocalRef( RunResultsE[1]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsE[1]:CompMarginTDV  ) * 100 / LocalRef( RunResultsE[1]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - E-SpcCl"    	Proj:RunResultsE[2]:PctImproveTDV	= {	if (LocalRef( RunResultsE[2]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsE[2]:CompMarginTDV  ) * 100 / LocalRef( RunResultsE[2]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - E-IAQVent"  	Proj:RunResultsE[3]:PctImproveTDV	= {	if (LocalRef( RunResultsE[3]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsE[3]:CompMarginTDV  ) * 100 / LocalRef( RunResultsE[3]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - E-OthrHVAC" 	Proj:RunResultsE[4]:PctImproveTDV	= {	if (LocalRef( RunResultsE[4]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsE[4]:CompMarginTDV  ) * 100 / LocalRef( RunResultsE[4]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - E-WtrHt"    	Proj:RunResultsE[5]:PctImproveTDV	= {	if (LocalRef( RunResultsE[5]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsE[5]:CompMarginTDV  ) * 100 / LocalRef( RunResultsE[5]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - E-InsLtg"   	Proj:RunResultsE[6]:PctImproveTDV	= {	if (LocalRef( RunResultsE[6]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsE[6]:CompMarginTDV  ) * 100 / LocalRef( RunResultsE[6]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - E-AppCkg"   	Proj:RunResultsE[7]:PctImproveTDV	= {	if (LocalRef( RunResultsE[7]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsE[7]:CompMarginTDV  ) * 100 / LocalRef( RunResultsE[7]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - E-Plugs"    	Proj:RunResultsE[8]:PctImproveTDV	= {	if (LocalRef( RunResultsE[8]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsE[8]:CompMarginTDV  ) * 100 / LocalRef( RunResultsE[8]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - E-Ext"      	Proj:RunResultsE[9]:PctImproveTDV	= {	if (LocalRef( RunResultsE[9]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsE[9]:CompMarginTDV  ) * 100 / LocalRef( RunResultsE[9]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - E-PV"     	 	Proj:RunResultsE[13]:PctImproveTDV	= {	if (LocalRef( RunResultsE[13]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsE[13]:CompMarginTDV ) * 100 / LocalRef( RunResultsE[13]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - E-Battery"     Proj:RunResultsE[14]:PctImproveTDV	= {	if (LocalRef( RunResultsE[14]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsE[14]:CompMarginTDV ) * 100 / LocalRef( RunResultsE[14]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - E-Total"    	Proj:RunResultsE[10]:PctImproveTDV	= {	if (LocalRef( RunResultsE[10]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsE[10]:CompMarginTDV ) * 100 / LocalRef( RunResultsE[10]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - E-Comp Ttl"  	Proj:RunResultsE[11]:PctImproveTDV	= {	if (LocalRef( RunResultsE[11]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsE[11]:CompMarginTDV ) * 100 / LocalRef( RunResultsE[11]:StandardTDV )  endif  }
  ; Delta Demand   - SAC 8/23/14
	"Calc Delta El Demand - E-SpcHt"    	Proj:RunResultsE[1]:DeltaDemand		= {	LocalRef( RunResultsE[1]:StdElecDemand  ) - LocalRef( RunResultsE[1]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - E-SpcCl"    	Proj:RunResultsE[2]:DeltaDemand		= {	LocalRef( RunResultsE[2]:StdElecDemand  ) - LocalRef( RunResultsE[2]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - E-IAQVent"  	Proj:RunResultsE[3]:DeltaDemand		= {	LocalRef( RunResultsE[3]:StdElecDemand  ) - LocalRef( RunResultsE[3]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - E-OthrHVAC" 	Proj:RunResultsE[4]:DeltaDemand		= {	LocalRef( RunResultsE[4]:StdElecDemand  ) - LocalRef( RunResultsE[4]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - E-WtrHt"    	Proj:RunResultsE[5]:DeltaDemand		= {	LocalRef( RunResultsE[5]:StdElecDemand  ) - LocalRef( RunResultsE[5]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - E-InsLtg"   	Proj:RunResultsE[6]:DeltaDemand		= {	LocalRef( RunResultsE[6]:StdElecDemand  ) - LocalRef( RunResultsE[6]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - E-AppCkg"   	Proj:RunResultsE[7]:DeltaDemand		= {	LocalRef( RunResultsE[7]:StdElecDemand  ) - LocalRef( RunResultsE[7]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - E-Plugs"    	Proj:RunResultsE[8]:DeltaDemand		= {	LocalRef( RunResultsE[8]:StdElecDemand  ) - LocalRef( RunResultsE[8]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - E-Ext"      	Proj:RunResultsE[9]:DeltaDemand		= {	LocalRef( RunResultsE[9]:StdElecDemand  ) - LocalRef( RunResultsE[9]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - E-PV"     	 	Proj:RunResultsE[13]:DeltaDemand		= {	LocalRef( RunResultsE[13]:StdElecDemand ) - LocalRef( RunResultsE[13]:PropElecDemand[1] )   }
	"Calc Delta El Demand - E-Battery"     Proj:RunResultsE[14]:DeltaDemand		= {	LocalRef( RunResultsE[14]:StdElecDemand ) - LocalRef( RunResultsE[14]:PropElecDemand[1] )   }
	"Calc Delta El Demand - E-Total"    	Proj:RunResultsE[10]:DeltaDemand		= {	LocalRef( RunResultsE[10]:StdElecDemand ) - LocalRef( RunResultsE[10]:PropElecDemand[1] )   }
	"Calc Delta El Demand - E-Comp Ttl" 	Proj:RunResultsE[11]:DeltaDemand		= {	LocalRef( RunResultsE[11]:StdElecDemand ) - LocalRef( RunResultsE[11]:PropElecDemand[1] )   }

  ; Compliance Margins - SOUTH
	"Calc TDV Comp Margin - S-SpcHt"    	Proj:RunResultsS[1]:CompMarginTDV	= {	LocalRef( RunResultsS[1]:StandardTDV  ) - LocalRef( RunResultsS[1]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - S-SpcCl"    	Proj:RunResultsS[2]:CompMarginTDV	= {	LocalRef( RunResultsS[2]:StandardTDV  ) - LocalRef( RunResultsS[2]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - S-IAQVent"  	Proj:RunResultsS[3]:CompMarginTDV	= {	LocalRef( RunResultsS[3]:StandardTDV  ) - LocalRef( RunResultsS[3]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - S-OthrHVAC" 	Proj:RunResultsS[4]:CompMarginTDV	= {	LocalRef( RunResultsS[4]:StandardTDV  ) - LocalRef( RunResultsS[4]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - S-WtrHt"    	Proj:RunResultsS[5]:CompMarginTDV	= {	LocalRef( RunResultsS[5]:StandardTDV  ) - LocalRef( RunResultsS[5]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - S-InsLtg"   	Proj:RunResultsS[6]:CompMarginTDV	= {	LocalRef( RunResultsS[6]:StandardTDV  ) - LocalRef( RunResultsS[6]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - S-AppCkg"   	Proj:RunResultsS[7]:CompMarginTDV	= {	LocalRef( RunResultsS[7]:StandardTDV  ) - LocalRef( RunResultsS[7]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - S-Plugs"    	Proj:RunResultsS[8]:CompMarginTDV	= {	LocalRef( RunResultsS[8]:StandardTDV  ) - LocalRef( RunResultsS[8]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - S-Ext"      	Proj:RunResultsS[9]:CompMarginTDV	= {	LocalRef( RunResultsS[9]:StandardTDV  ) - LocalRef( RunResultsS[9]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - S-PV"     	 	Proj:RunResultsS[13]:CompMarginTDV	= {	LocalRef( RunResultsS[13]:StandardTDV ) - LocalRef( RunResultsS[13]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - S-Battery"     Proj:RunResultsS[14]:CompMarginTDV	= {	LocalRef( RunResultsS[14]:StandardTDV ) - LocalRef( RunResultsS[14]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - S-Total"    	Proj:RunResultsS[10]:CompMarginTDV	= {	LocalRef( RunResultsS[10]:StandardTDV ) - LocalRef( RunResultsS[10]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - S-Comp Ttl" 	Proj:RunResultsS[11]:CompMarginTDV	= {	LocalRef( RunResultsS[11]:StandardTDV ) - LocalRef( RunResultsS[11]:ProposedTDV[1] )   }
  ; Percent Improvement
	"Calc TDV Pct Improve - S-SpcHt"    	Proj:RunResultsS[1]:PctImproveTDV	= {	if (LocalRef( RunResultsS[1]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsS[1]:CompMarginTDV  ) * 100 / LocalRef( RunResultsS[1]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - S-SpcCl"    	Proj:RunResultsS[2]:PctImproveTDV	= {	if (LocalRef( RunResultsS[2]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsS[2]:CompMarginTDV  ) * 100 / LocalRef( RunResultsS[2]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - S-IAQVent"  	Proj:RunResultsS[3]:PctImproveTDV	= {	if (LocalRef( RunResultsS[3]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsS[3]:CompMarginTDV  ) * 100 / LocalRef( RunResultsS[3]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - S-OthrHVAC" 	Proj:RunResultsS[4]:PctImproveTDV	= {	if (LocalRef( RunResultsS[4]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsS[4]:CompMarginTDV  ) * 100 / LocalRef( RunResultsS[4]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - S-WtrHt"    	Proj:RunResultsS[5]:PctImproveTDV	= {	if (LocalRef( RunResultsS[5]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsS[5]:CompMarginTDV  ) * 100 / LocalRef( RunResultsS[5]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - S-InsLtg"   	Proj:RunResultsS[6]:PctImproveTDV	= {	if (LocalRef( RunResultsS[6]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsS[6]:CompMarginTDV  ) * 100 / LocalRef( RunResultsS[6]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - S-AppCkg"   	Proj:RunResultsS[7]:PctImproveTDV	= {	if (LocalRef( RunResultsS[7]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsS[7]:CompMarginTDV  ) * 100 / LocalRef( RunResultsS[7]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - S-Plugs"    	Proj:RunResultsS[8]:PctImproveTDV	= {	if (LocalRef( RunResultsS[8]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsS[8]:CompMarginTDV  ) * 100 / LocalRef( RunResultsS[8]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - S-Ext"      	Proj:RunResultsS[9]:PctImproveTDV	= {	if (LocalRef( RunResultsS[9]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsS[9]:CompMarginTDV  ) * 100 / LocalRef( RunResultsS[9]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - S-PV"  	    	Proj:RunResultsS[13]:PctImproveTDV	= {	if (LocalRef( RunResultsS[13]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsS[13]:CompMarginTDV ) * 100 / LocalRef( RunResultsS[13]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - S-Battery"  	Proj:RunResultsS[14]:PctImproveTDV	= {	if (LocalRef( RunResultsS[14]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsS[14]:CompMarginTDV ) * 100 / LocalRef( RunResultsS[14]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - S-Total"    	Proj:RunResultsS[10]:PctImproveTDV	= {	if (LocalRef( RunResultsS[10]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsS[10]:CompMarginTDV ) * 100 / LocalRef( RunResultsS[10]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - S-Comp Ttl"  	Proj:RunResultsS[11]:PctImproveTDV	= {	if (LocalRef( RunResultsS[11]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsS[11]:CompMarginTDV ) * 100 / LocalRef( RunResultsS[11]:StandardTDV )  endif  }
  ; Delta Demand   - SAC 8/23/14
	"Calc Delta El Demand - S-SpcHt"    	Proj:RunResultsS[1]:DeltaDemand		= {	LocalRef( RunResultsS[1]:StdElecDemand  ) - LocalRef( RunResultsS[1]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - S-SpcCl"    	Proj:RunResultsS[2]:DeltaDemand		= {	LocalRef( RunResultsS[2]:StdElecDemand  ) - LocalRef( RunResultsS[2]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - S-IAQVent"  	Proj:RunResultsS[3]:DeltaDemand		= {	LocalRef( RunResultsS[3]:StdElecDemand  ) - LocalRef( RunResultsS[3]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - S-OthrHVAC" 	Proj:RunResultsS[4]:DeltaDemand		= {	LocalRef( RunResultsS[4]:StdElecDemand  ) - LocalRef( RunResultsS[4]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - S-WtrHt"    	Proj:RunResultsS[5]:DeltaDemand		= {	LocalRef( RunResultsS[5]:StdElecDemand  ) - LocalRef( RunResultsS[5]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - S-InsLtg"   	Proj:RunResultsS[6]:DeltaDemand		= {	LocalRef( RunResultsS[6]:StdElecDemand  ) - LocalRef( RunResultsS[6]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - S-AppCkg"   	Proj:RunResultsS[7]:DeltaDemand		= {	LocalRef( RunResultsS[7]:StdElecDemand  ) - LocalRef( RunResultsS[7]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - S-Plugs"    	Proj:RunResultsS[8]:DeltaDemand		= {	LocalRef( RunResultsS[8]:StdElecDemand  ) - LocalRef( RunResultsS[8]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - S-Ext"      	Proj:RunResultsS[9]:DeltaDemand		= {	LocalRef( RunResultsS[9]:StdElecDemand  ) - LocalRef( RunResultsS[9]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - S-PV"     	 	Proj:RunResultsS[13]:DeltaDemand		= {	LocalRef( RunResultsS[13]:StdElecDemand ) - LocalRef( RunResultsS[13]:PropElecDemand[1] )   }
	"Calc Delta El Demand - S-Battery"     Proj:RunResultsS[14]:DeltaDemand		= {	LocalRef( RunResultsS[14]:StdElecDemand ) - LocalRef( RunResultsS[14]:PropElecDemand[1] )   }
	"Calc Delta El Demand - S-Total"    	Proj:RunResultsS[10]:DeltaDemand		= {	LocalRef( RunResultsS[10]:StdElecDemand ) - LocalRef( RunResultsS[10]:PropElecDemand[1] )   }
	"Calc Delta El Demand - S-Comp Ttl" 	Proj:RunResultsS[11]:DeltaDemand		= {	LocalRef( RunResultsS[11]:StdElecDemand ) - LocalRef( RunResultsS[11]:PropElecDemand[1] )   }

  ; Compliance Margins - WEST
	"Calc TDV Comp Margin - W-SpcHt"    	Proj:RunResultsW[1]:CompMarginTDV	= {	LocalRef( RunResultsW[1]:StandardTDV  ) - LocalRef( RunResultsW[1]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - W-SpcCl"    	Proj:RunResultsW[2]:CompMarginTDV	= {	LocalRef( RunResultsW[2]:StandardTDV  ) - LocalRef( RunResultsW[2]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - W-IAQVent"  	Proj:RunResultsW[3]:CompMarginTDV	= {	LocalRef( RunResultsW[3]:StandardTDV  ) - LocalRef( RunResultsW[3]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - W-OthrHVAC" 	Proj:RunResultsW[4]:CompMarginTDV	= {	LocalRef( RunResultsW[4]:StandardTDV  ) - LocalRef( RunResultsW[4]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - W-WtrHt"    	Proj:RunResultsW[5]:CompMarginTDV	= {	LocalRef( RunResultsW[5]:StandardTDV  ) - LocalRef( RunResultsW[5]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - W-InsLtg"   	Proj:RunResultsW[6]:CompMarginTDV	= {	LocalRef( RunResultsW[6]:StandardTDV  ) - LocalRef( RunResultsW[6]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - W-AppCkg"   	Proj:RunResultsW[7]:CompMarginTDV	= {	LocalRef( RunResultsW[7]:StandardTDV  ) - LocalRef( RunResultsW[7]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - W-Plugs"    	Proj:RunResultsW[8]:CompMarginTDV	= {	LocalRef( RunResultsW[8]:StandardTDV  ) - LocalRef( RunResultsW[8]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - W-Ext"      	Proj:RunResultsW[9]:CompMarginTDV	= {	LocalRef( RunResultsW[9]:StandardTDV  ) - LocalRef( RunResultsW[9]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - W-PV"      		Proj:RunResultsW[13]:CompMarginTDV	= {	LocalRef( RunResultsW[13]:StandardTDV ) - LocalRef( RunResultsW[13]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - W-Battery"     Proj:RunResultsW[14]:CompMarginTDV	= {	LocalRef( RunResultsW[14]:StandardTDV ) - LocalRef( RunResultsW[14]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - W-Total"    	Proj:RunResultsW[10]:CompMarginTDV	= {	LocalRef( RunResultsW[10]:StandardTDV ) - LocalRef( RunResultsW[10]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - W-Comp Ttl" 	Proj:RunResultsW[11]:CompMarginTDV	= {	LocalRef( RunResultsW[11]:StandardTDV ) - LocalRef( RunResultsW[11]:ProposedTDV[1] )   }
  ; Percent Improvement
	"Calc TDV Pct Improve - W-SpcHt"    	Proj:RunResultsW[1]:PctImproveTDV	= {	if (LocalRef( RunResultsW[1]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsW[1]:CompMarginTDV  ) * 100 / LocalRef( RunResultsW[1]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - W-SpcCl"    	Proj:RunResultsW[2]:PctImproveTDV	= {	if (LocalRef( RunResultsW[2]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsW[2]:CompMarginTDV  ) * 100 / LocalRef( RunResultsW[2]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - W-IAQVent"  	Proj:RunResultsW[3]:PctImproveTDV	= {	if (LocalRef( RunResultsW[3]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsW[3]:CompMarginTDV  ) * 100 / LocalRef( RunResultsW[3]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - W-OthrHVAC" 	Proj:RunResultsW[4]:PctImproveTDV	= {	if (LocalRef( RunResultsW[4]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsW[4]:CompMarginTDV  ) * 100 / LocalRef( RunResultsW[4]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - W-WtrHt"    	Proj:RunResultsW[5]:PctImproveTDV	= {	if (LocalRef( RunResultsW[5]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsW[5]:CompMarginTDV  ) * 100 / LocalRef( RunResultsW[5]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - W-InsLtg"   	Proj:RunResultsW[6]:PctImproveTDV	= {	if (LocalRef( RunResultsW[6]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsW[6]:CompMarginTDV  ) * 100 / LocalRef( RunResultsW[6]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - W-AppCkg"   	Proj:RunResultsW[7]:PctImproveTDV	= {	if (LocalRef( RunResultsW[7]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsW[7]:CompMarginTDV  ) * 100 / LocalRef( RunResultsW[7]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - W-Plugs"    	Proj:RunResultsW[8]:PctImproveTDV	= {	if (LocalRef( RunResultsW[8]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsW[8]:CompMarginTDV  ) * 100 / LocalRef( RunResultsW[8]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - W-Ext"      	Proj:RunResultsW[9]:PctImproveTDV	= {	if (LocalRef( RunResultsW[9]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsW[9]:CompMarginTDV  ) * 100 / LocalRef( RunResultsW[9]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - W-PV"      		Proj:RunResultsW[13]:PctImproveTDV	= {	if (LocalRef( RunResultsW[13]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsW[13]:CompMarginTDV ) * 100 / LocalRef( RunResultsW[13]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - W-Battery"  	Proj:RunResultsW[14]:PctImproveTDV	= {	if (LocalRef( RunResultsW[14]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsW[14]:CompMarginTDV ) * 100 / LocalRef( RunResultsW[14]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - W-Total"    	Proj:RunResultsW[10]:PctImproveTDV	= {	if (LocalRef( RunResultsW[10]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsW[10]:CompMarginTDV ) * 100 / LocalRef( RunResultsW[10]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - W-Comp Ttl"  	Proj:RunResultsW[11]:PctImproveTDV	= {	if (LocalRef( RunResultsW[11]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsW[11]:CompMarginTDV ) * 100 / LocalRef( RunResultsW[11]:StandardTDV )  endif  }
  ; Delta Demand   - SAC 8/23/14
	"Calc Delta El Demand - W-SpcHt"    	Proj:RunResultsW[1]:DeltaDemand		= {	LocalRef( RunResultsW[1]:StdElecDemand  ) - LocalRef( RunResultsW[1]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - W-SpcCl"    	Proj:RunResultsW[2]:DeltaDemand		= {	LocalRef( RunResultsW[2]:StdElecDemand  ) - LocalRef( RunResultsW[2]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - W-IAQVent"  	Proj:RunResultsW[3]:DeltaDemand		= {	LocalRef( RunResultsW[3]:StdElecDemand  ) - LocalRef( RunResultsW[3]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - W-OthrHVAC" 	Proj:RunResultsW[4]:DeltaDemand		= {	LocalRef( RunResultsW[4]:StdElecDemand  ) - LocalRef( RunResultsW[4]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - W-WtrHt"    	Proj:RunResultsW[5]:DeltaDemand		= {	LocalRef( RunResultsW[5]:StdElecDemand  ) - LocalRef( RunResultsW[5]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - W-InsLtg"   	Proj:RunResultsW[6]:DeltaDemand		= {	LocalRef( RunResultsW[6]:StdElecDemand  ) - LocalRef( RunResultsW[6]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - W-AppCkg"   	Proj:RunResultsW[7]:DeltaDemand		= {	LocalRef( RunResultsW[7]:StdElecDemand  ) - LocalRef( RunResultsW[7]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - W-Plugs"    	Proj:RunResultsW[8]:DeltaDemand		= {	LocalRef( RunResultsW[8]:StdElecDemand  ) - LocalRef( RunResultsW[8]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - W-Ext"      	Proj:RunResultsW[9]:DeltaDemand		= {	LocalRef( RunResultsW[9]:StdElecDemand  ) - LocalRef( RunResultsW[9]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - W-PV"    	  	Proj:RunResultsW[13]:DeltaDemand		= {	LocalRef( RunResultsW[13]:StdElecDemand ) - LocalRef( RunResultsW[13]:PropElecDemand[1] )   }
	"Calc Delta El Demand - W-Battery"    	Proj:RunResultsW[14]:DeltaDemand		= {	LocalRef( RunResultsW[14]:StdElecDemand ) - LocalRef( RunResultsW[14]:PropElecDemand[1] )   }
	"Calc Delta El Demand - W-Total"    	Proj:RunResultsW[10]:DeltaDemand		= {	LocalRef( RunResultsW[10]:StdElecDemand ) - LocalRef( RunResultsW[10]:PropElecDemand[1] )   }
	"Calc Delta El Demand - W-Comp Ttl" 	Proj:RunResultsW[11]:DeltaDemand		= {	LocalRef( RunResultsW[11]:StdElecDemand ) - LocalRef( RunResultsW[11]:PropElecDemand[1] )   }

; -- NOW -- Calculate WORST case scenario and reference THOSE RunResults objects in the main RunResults[] elements
	"Determine which RunResults is Worst case"	Proj:WorstOrientation	= {
         if (EnergyCodeYearNum >= 2019 .AND. LocalStatus( WorstOrientation ) > 0) then  UNCHANGED
         else if (RunResultsN[11]:CompMarginTDV <= RunResultsE[11]:CompMarginTDV .AND.
						RunResultsN[11]:CompMarginTDV <= RunResultsS[11]:CompMarginTDV .AND.
						RunResultsN[11]:CompMarginTDV <= RunResultsW[11]:CompMarginTDV )	then	1
			else if (RunResultsE[11]:CompMarginTDV <= RunResultsN[11]:CompMarginTDV .AND.
						RunResultsE[11]:CompMarginTDV <= RunResultsS[11]:CompMarginTDV .AND.
						RunResultsE[11]:CompMarginTDV <= RunResultsW[11]:CompMarginTDV )	then	2
			else if (RunResultsS[11]:CompMarginTDV <= RunResultsN[11]:CompMarginTDV .AND.
						RunResultsS[11]:CompMarginTDV <= RunResultsE[11]:CompMarginTDV .AND.
						RunResultsS[11]:CompMarginTDV <= RunResultsW[11]:CompMarginTDV )	then	3	else	4	endif endif endif endif  }
;"dbg" Proj:Action = { PostMessageToLog( "   Setting worst orientation to %g", WorstOrientation )  }
	"Call rules to set Worst case RunResults"		Proj:Action		= {	switch (WorstOrientation)
																								case  2 :  EvalRulelist( "CARes_RunResults_SetWorst_E" )
																								case  3 :  EvalRulelist( "CARes_RunResults_SetWorst_S" )
																								case  4 :  EvalRulelist( "CARes_RunResults_SetWorst_W" )
																								default :  EvalRulelist( "CARes_RunResults_SetWorst_N" )
																							endswitch  }
END

;************************************************************************* SAC 07/20/23 (2025)
RULELIST "CARes_StandardTDVResults_PVonly_NESW" 1 0 0 1
;*************************************************************************
  ; PV
   ; mods to calc NEM-adjusted PV TDV (StdElecTDV) & Elec Demand (StdElecDemand) for 2019 analysis
	"Calculate TDV - Elec   - N-PV"			Proj:RunResultsN[13]:StdElecTDV			= {	if (LocalRef( RunResultsN[13]:StdElecEnergy		) > -0.0001) then  0
		else if (IfValidAnd( NetEnergyMeteringTDVAdj != 0) .OR. IfValidAnd( HrlyNEMTableCol > 0 ))
      then  if (LocalRef( RunResultsN[14]:PropElecEnergy[1] ) = 0)
            then  int( (100 * ApplyHourlyResultMultipliers_NEM( "PVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor          ) / CondFloorArea) + 0.5) / 100
            else  int( (100 * ApplyHourlyResultMultipliers_NEM( "PVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV", "Tot", NetEnergyMeteringTDVAdj, HrlyNEMTableName, HrlyNEMTableCol, NEMGrossUpFactor, 1, "BT" ) / CondFloorArea) + 0.5) / 100  endif
      else        int( (100 * ApplyHourlyResultMultipliers(     "PVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV" ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate TDV - NatGas - N-PV"			Proj:RunResultsN[13]:StdNatGasTDV		= {	0  }
	"Calculate TDV - Other  - N-PV"			Proj:RunResultsN[13]:StdOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - N-PV"			Proj:RunResultsN[13]:StandardTDV			= {	LocalRef( RunResultsN[13]:StdElecTDV )   }
	"Calculate Elec Demand  - N-PV"			Proj:RunResultsN[13]:StdElecDemand		= {	if (LocalRef( RunResultsN[13]:PropElecEnergy[1]		) > -0.0001) then  0
			 			  																						   else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec", "PV" ) / 3.412  endif  }

  ; Compliance Total
	"Calculate TDV - Elec   - N-Comp Ttl"	Proj:RunResultsN[11]:StdElecTDV			= {	RunResultsN[1]:StdElecTDV    + RunResultsN[2]:StdElecTDV    + RunResultsN[3]:StdElecTDV    + RunResultsN[4]:StdElecTDV    + RunResultsN[5]:StdElecTDV     }
	"Calculate TDV - NatGas - N-Comp Ttl"	Proj:RunResultsN[11]:StdNatGasTDV		= {	RunResultsN[1]:StdNatGasTDV  + RunResultsN[2]:StdNatGasTDV  + RunResultsN[3]:StdNatGasTDV  + RunResultsN[4]:StdNatGasTDV  + RunResultsN[5]:StdNatGasTDV   }
	"Calculate TDV - Other  - N-Comp Ttl"	Proj:RunResultsN[11]:StdOtherTDV			= {	RunResultsN[1]:StdOtherTDV   + RunResultsN[2]:StdOtherTDV   + RunResultsN[3]:StdOtherTDV   + RunResultsN[4]:StdOtherTDV   + RunResultsN[5]:StdOtherTDV    }
	"Calculate TDV - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:StandardTDV			= {	RunResultsN[1]:StandardTDV   + RunResultsN[2]:StandardTDV   + RunResultsN[3]:StandardTDV   + RunResultsN[4]:StandardTDV   + RunResultsN[5]:StandardTDV    }
	"Calculate Elec Demand  - N-Comp Ttl"	Proj:RunResultsN[11]:StdElecDemand		= {	RunResultsN[1]:StdElecDemand + RunResultsN[2]:StdElecDemand + RunResultsN[3]:StdElecDemand + RunResultsN[4]:StdElecDemand + RunResultsN[5]:StdElecDemand  }

  ; Total
	"Calculate TDV - Elec   - N-Total"		Proj:RunResultsN[10]:StdElecTDV			= {	RunResultsN[11]:StdElecTDV    + RunResultsN[6]:StdElecTDV    + RunResultsN[7]:StdElecTDV    + RunResultsN[8]:StdElecTDV    + RunResultsN[9]:StdElecTDV    + RunResultsN[13]:StdElecTDV    + RunResultsN[14]:StdElecTDV     }
	"Calculate TDV - NatGas - N-Total"		Proj:RunResultsN[10]:StdNatGasTDV		= {	RunResultsN[11]:StdNatGasTDV  + RunResultsN[6]:StdNatGasTDV  + RunResultsN[7]:StdNatGasTDV  + RunResultsN[8]:StdNatGasTDV  + RunResultsN[9]:StdNatGasTDV  + RunResultsN[13]:StdNatGasTDV  + RunResultsN[14]:StdNatGasTDV   }
	"Calculate TDV - Other  - N-Total"		Proj:RunResultsN[10]:StdOtherTDV			= {	RunResultsN[11]:StdOtherTDV   + RunResultsN[6]:StdOtherTDV   + RunResultsN[7]:StdOtherTDV   + RunResultsN[8]:StdOtherTDV   + RunResultsN[9]:StdOtherTDV   + RunResultsN[13]:StdOtherTDV   + RunResultsN[14]:StdOtherTDV    }
	"Calculate TDV - TOTAL  - N-Total"		Proj:RunResultsN[10]:StandardTDV			= {	RunResultsN[11]:StandardTDV   + RunResultsN[6]:StandardTDV   + RunResultsN[7]:StandardTDV   + RunResultsN[8]:StandardTDV   + RunResultsN[9]:StandardTDV   + RunResultsN[13]:StandardTDV   + RunResultsN[14]:StandardTDV    }
	"Calculate Elec Demand  - N-Total"		Proj:RunResultsN[10]:StdElecDemand		= {	RunResultsN[11]:StdElecDemand + RunResultsN[6]:StdElecDemand + RunResultsN[7]:StdElecDemand + RunResultsN[8]:StdElecDemand + RunResultsN[9]:StdElecDemand + RunResultsN[13]:StdElecDemand + RunResultsN[14]:StdElecDemand  }


; -- COPY N results to E --
  ; PV
	"Calculate TDV - Elec   - E-PV"			Proj:RunResultsE[13]:StdElecTDV			= {	RunResultsN[13]:StdElecTDV       }
	"Calculate TDV - NatGas - E-PV"			Proj:RunResultsE[13]:StdNatGasTDV		= {	RunResultsN[13]:StdNatGasTDV     }
	"Calculate TDV - Other  - E-PV"			Proj:RunResultsE[13]:StdOtherTDV			= {	RunResultsN[13]:StdOtherTDV      }
	"Calculate TDV - TOTAL  - E-PV"			Proj:RunResultsE[13]:StandardTDV			= {	RunResultsN[13]:StandardTDV      }
	"Calculate Elec Demand  - E-PV"			Proj:RunResultsE[13]:StdElecDemand		= {	RunResultsN[13]:StdElecDemand    }
  ; Compliance Total                                                                                                  
	"Calculate TDV - Elec   - E-Comp Ttl"	Proj:RunResultsE[11]:StdElecTDV			= {	RunResultsN[11]:StdElecTDV       }
	"Calculate TDV - NatGas - E-Comp Ttl"	Proj:RunResultsE[11]:StdNatGasTDV		= {	RunResultsN[11]:StdNatGasTDV     }
	"Calculate TDV - Other  - E-Comp Ttl"	Proj:RunResultsE[11]:StdOtherTDV			= {	RunResultsN[11]:StdOtherTDV      }
	"Calculate TDV - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:StandardTDV			= {	RunResultsN[11]:StandardTDV      }
	"Calculate Elec Demand  - E-Comp Ttl"	Proj:RunResultsE[11]:StdElecDemand		= {	RunResultsN[11]:StdElecDemand    }
  ; Total                                                                                                             
	"Calculate TDV - Elec   - E-Total"		Proj:RunResultsE[10]:StdElecTDV			= {	RunResultsN[10]:StdElecTDV       }
	"Calculate TDV - NatGas - E-Total"		Proj:RunResultsE[10]:StdNatGasTDV		= {	RunResultsN[10]:StdNatGasTDV     }
	"Calculate TDV - Other  - E-Total"		Proj:RunResultsE[10]:StdOtherTDV			= {	RunResultsN[10]:StdOtherTDV      }
	"Calculate TDV - TOTAL  - E-Total"		Proj:RunResultsE[10]:StandardTDV			= {	RunResultsN[10]:StandardTDV      }
	"Calculate Elec Demand  - E-Total"		Proj:RunResultsE[10]:StdElecDemand		= {	RunResultsN[10]:StdElecDemand    }

; -- COPY N results to S --
  ; PV
	"Calculate TDV - Elec   - S-PV"			Proj:RunResultsS[13]:StdElecTDV			= {	RunResultsN[13]:StdElecTDV       }
	"Calculate TDV - NatGas - S-PV"			Proj:RunResultsS[13]:StdNatGasTDV		= {	RunResultsN[13]:StdNatGasTDV     }
	"Calculate TDV - Other  - S-PV"			Proj:RunResultsS[13]:StdOtherTDV			= {	RunResultsN[13]:StdOtherTDV      }
	"Calculate TDV - TOTAL  - S-PV"			Proj:RunResultsS[13]:StandardTDV			= {	RunResultsN[13]:StandardTDV      }
	"Calculate Elec Demand  - S-PV"			Proj:RunResultsS[13]:StdElecDemand		= {	RunResultsN[13]:StdElecDemand    }
  ; Compliance Total                                                                                                  
	"Calculate TDV - Elec   - S-Comp Ttl"	Proj:RunResultsS[11]:StdElecTDV			= {	RunResultsN[11]:StdElecTDV       }
	"Calculate TDV - NatGas - S-Comp Ttl"	Proj:RunResultsS[11]:StdNatGasTDV		= {	RunResultsN[11]:StdNatGasTDV     }
	"Calculate TDV - Other  - S-Comp Ttl"	Proj:RunResultsS[11]:StdOtherTDV			= {	RunResultsN[11]:StdOtherTDV      }
	"Calculate TDV - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:StandardTDV			= {	RunResultsN[11]:StandardTDV      }
	"Calculate Elec Demand  - S-Comp Ttl"  Proj:RunResultsS[11]:StdElecDemand		= {	RunResultsN[11]:StdElecDemand    }
  ; Total                                                                                                             
	"Calculate TDV - Elec   - S-Total"		Proj:RunResultsS[10]:StdElecTDV			= {	RunResultsN[10]:StdElecTDV       }
	"Calculate TDV - NatGas - S-Total"		Proj:RunResultsS[10]:StdNatGasTDV		= {	RunResultsN[10]:StdNatGasTDV     }
	"Calculate TDV - Other  - S-Total"		Proj:RunResultsS[10]:StdOtherTDV			= {	RunResultsN[10]:StdOtherTDV      }
	"Calculate TDV - TOTAL  - S-Total"		Proj:RunResultsS[10]:StandardTDV			= {	RunResultsN[10]:StandardTDV      }
	"Calculate Elec Demand  - S-Total"     Proj:RunResultsS[10]:StdElecDemand		= {	RunResultsN[10]:StdElecDemand    }

; -- COPY N results to W --
  ; PV
	"Calculate TDV - Elec   - W-PV"			Proj:RunResultsW[13]:StdElecTDV			= {	RunResultsN[13]:StdElecTDV       }
	"Calculate TDV - NatGas - W-PV"			Proj:RunResultsW[13]:StdNatGasTDV		= {	RunResultsN[13]:StdNatGasTDV     }
	"Calculate TDV - Other  - W-PV"			Proj:RunResultsW[13]:StdOtherTDV			= {	RunResultsN[13]:StdOtherTDV      }
	"Calculate TDV - TOTAL  - W-PV"			Proj:RunResultsW[13]:StandardTDV			= {	RunResultsN[13]:StandardTDV      }
	"Calculate Elec Demand  - W-PV"			Proj:RunResultsW[13]:StdElecDemand		= {	RunResultsN[13]:StdElecDemand    }
  ; Compliance Total                                                                                                  
	"Calculate TDV - Elec   - W-Comp Ttl"	Proj:RunResultsW[11]:StdElecTDV			= {	RunResultsN[11]:StdElecTDV       }
	"Calculate TDV - NatGas - W-Comp Ttl"	Proj:RunResultsW[11]:StdNatGasTDV		= {	RunResultsN[11]:StdNatGasTDV     }
	"Calculate TDV - Other  - W-Comp Ttl"	Proj:RunResultsW[11]:StdOtherTDV			= {	RunResultsN[11]:StdOtherTDV      }
	"Calculate TDV - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:StandardTDV			= {	RunResultsN[11]:StandardTDV      }
	"Calculate Elec Demand  - W-Comp Ttl"	Proj:RunResultsW[11]:StdElecDemand		= {	RunResultsN[11]:StdElecDemand    }
  ; Total                                                                                                             
	"Calculate TDV - Elec   - W-Total"		Proj:RunResultsW[10]:StdElecTDV			= {	RunResultsN[10]:StdElecTDV       }
	"Calculate TDV - NatGas - W-Total"		Proj:RunResultsW[10]:StdNatGasTDV		= {	RunResultsN[10]:StdNatGasTDV     }
	"Calculate TDV - Other  - W-Total"		Proj:RunResultsW[10]:StdOtherTDV			= {	RunResultsN[10]:StdOtherTDV      }
	"Calculate TDV - TOTAL  - W-Total"		Proj:RunResultsW[10]:StandardTDV			= {	RunResultsN[10]:StandardTDV      }
	"Calculate Elec Demand  - W-Total"     Proj:RunResultsW[10]:StdElecDemand		= {	RunResultsN[10]:StdElecDemand    }


  ; Compliance Margins - NORTH
	"Calc TDV Comp Margin - N-PV"     	 	Proj:RunResultsN[13]:CompMarginTDV	= {	LocalRef( RunResultsN[13]:StandardTDV ) - LocalRef( RunResultsN[13]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - N-Total"    	Proj:RunResultsN[10]:CompMarginTDV	= {	LocalRef( RunResultsN[10]:StandardTDV ) - LocalRef( RunResultsN[10]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - N-Comp Ttl" 	Proj:RunResultsN[11]:CompMarginTDV	= {	LocalRef( RunResultsN[11]:StandardTDV ) - LocalRef( RunResultsN[11]:ProposedTDV[1] )   }
  ; Percent Improvement
	"Calc TDV Pct Improve - N-PV"     	 	Proj:RunResultsN[13]:PctImproveTDV	= {	if (LocalRef( RunResultsN[13]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsN[13]:CompMarginTDV ) * 100 / LocalRef( RunResultsN[13]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - N-Total"    	Proj:RunResultsN[10]:PctImproveTDV	= {	if (LocalRef( RunResultsN[10]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsN[10]:CompMarginTDV ) * 100 / LocalRef( RunResultsN[10]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - N-Comp Ttl"  	Proj:RunResultsN[11]:PctImproveTDV	= {	if (LocalRef( RunResultsN[11]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsN[11]:CompMarginTDV ) * 100 / LocalRef( RunResultsN[11]:StandardTDV )  endif  }

  ; Compliance Margins - EAST
	"Calc TDV Comp Margin - E-PV"     	 	Proj:RunResultsE[13]:CompMarginTDV	= {	LocalRef( RunResultsE[13]:StandardTDV ) - LocalRef( RunResultsE[13]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - E-Total"    	Proj:RunResultsE[10]:CompMarginTDV	= {	LocalRef( RunResultsE[10]:StandardTDV ) - LocalRef( RunResultsE[10]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - E-Comp Ttl" 	Proj:RunResultsE[11]:CompMarginTDV	= {	LocalRef( RunResultsE[11]:StandardTDV ) - LocalRef( RunResultsE[11]:ProposedTDV[1] )   }
  ; Percent Improvement
	"Calc TDV Pct Improve - E-PV"     	 	Proj:RunResultsE[13]:PctImproveTDV	= {	if (LocalRef( RunResultsE[13]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsE[13]:CompMarginTDV ) * 100 / LocalRef( RunResultsE[13]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - E-Total"    	Proj:RunResultsE[10]:PctImproveTDV	= {	if (LocalRef( RunResultsE[10]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsE[10]:CompMarginTDV ) * 100 / LocalRef( RunResultsE[10]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - E-Comp Ttl"  	Proj:RunResultsE[11]:PctImproveTDV	= {	if (LocalRef( RunResultsE[11]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsE[11]:CompMarginTDV ) * 100 / LocalRef( RunResultsE[11]:StandardTDV )  endif  }

  ; Compliance Margins - SOUTH
	"Calc TDV Comp Margin - S-PV"     	 	Proj:RunResultsS[13]:CompMarginTDV	= {	LocalRef( RunResultsS[13]:StandardTDV ) - LocalRef( RunResultsS[13]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - S-Total"    	Proj:RunResultsS[10]:CompMarginTDV	= {	LocalRef( RunResultsS[10]:StandardTDV ) - LocalRef( RunResultsS[10]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - S-Comp Ttl" 	Proj:RunResultsS[11]:CompMarginTDV	= {	LocalRef( RunResultsS[11]:StandardTDV ) - LocalRef( RunResultsS[11]:ProposedTDV[1] )   }
  ; Percent Improvement
	"Calc TDV Pct Improve - S-PV"  	    	Proj:RunResultsS[13]:PctImproveTDV	= {	if (LocalRef( RunResultsS[13]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsS[13]:CompMarginTDV ) * 100 / LocalRef( RunResultsS[13]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - S-Total"    	Proj:RunResultsS[10]:PctImproveTDV	= {	if (LocalRef( RunResultsS[10]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsS[10]:CompMarginTDV ) * 100 / LocalRef( RunResultsS[10]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - S-Comp Ttl"  	Proj:RunResultsS[11]:PctImproveTDV	= {	if (LocalRef( RunResultsS[11]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsS[11]:CompMarginTDV ) * 100 / LocalRef( RunResultsS[11]:StandardTDV )  endif  }

  ; Compliance Margins - WEST
	"Calc TDV Comp Margin - W-PV"      		Proj:RunResultsW[13]:CompMarginTDV	= {	LocalRef( RunResultsW[13]:StandardTDV ) - LocalRef( RunResultsW[13]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - W-Total"    	Proj:RunResultsW[10]:CompMarginTDV	= {	LocalRef( RunResultsW[10]:StandardTDV ) - LocalRef( RunResultsW[10]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - W-Comp Ttl" 	Proj:RunResultsW[11]:CompMarginTDV	= {	LocalRef( RunResultsW[11]:StandardTDV ) - LocalRef( RunResultsW[11]:ProposedTDV[1] )   }
  ; Percent Improvement
	"Calc TDV Pct Improve - W-PV"      		Proj:RunResultsW[13]:PctImproveTDV	= {	if (LocalRef( RunResultsW[13]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsW[13]:CompMarginTDV ) * 100 / LocalRef( RunResultsW[13]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - W-Total"    	Proj:RunResultsW[10]:PctImproveTDV	= {	if (LocalRef( RunResultsW[10]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsW[10]:CompMarginTDV ) * 100 / LocalRef( RunResultsW[10]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - W-Comp Ttl"  	Proj:RunResultsW[11]:PctImproveTDV	= {	if (LocalRef( RunResultsW[11]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsW[11]:CompMarginTDV ) * 100 / LocalRef( RunResultsW[11]:StandardTDV )  endif  }

; -- NOW -- Calculate WORST case scenario and reference THOSE RunResults objects in the main RunResults[] elements
	"Determine which RunResults is Worst case"	Proj:WorstOrientation	= {
         if (EnergyCodeYearNum >= 2019 .AND. LocalStatus( WorstOrientation ) > 0) then  UNCHANGED
         else if (RunResultsN[11]:CompMarginTDV <= RunResultsE[11]:CompMarginTDV .AND.
						RunResultsN[11]:CompMarginTDV <= RunResultsS[11]:CompMarginTDV .AND.
						RunResultsN[11]:CompMarginTDV <= RunResultsW[11]:CompMarginTDV )	then	1
			else if (RunResultsE[11]:CompMarginTDV <= RunResultsN[11]:CompMarginTDV .AND.
						RunResultsE[11]:CompMarginTDV <= RunResultsS[11]:CompMarginTDV .AND.
						RunResultsE[11]:CompMarginTDV <= RunResultsW[11]:CompMarginTDV )	then	2
			else if (RunResultsS[11]:CompMarginTDV <= RunResultsN[11]:CompMarginTDV .AND.
						RunResultsS[11]:CompMarginTDV <= RunResultsE[11]:CompMarginTDV .AND.
						RunResultsS[11]:CompMarginTDV <= RunResultsW[11]:CompMarginTDV )	then	3	else	4	endif endif endif endif  }
;"dbg" Proj:Action = { PostMessageToLog( "   Setting worst orientation to %g", WorstOrientation )  }
	"Call rules to set Worst case RunResults"		Proj:Action		= {	switch (WorstOrientation)
																								case  2 :  EvalRulelist( "CARes_RunResults_SetWorst_E" )
																								case  3 :  EvalRulelist( "CARes_RunResults_SetWorst_S" )
																								case  4 :  EvalRulelist( "CARes_RunResults_SetWorst_W" )
																								default :  EvalRulelist( "CARes_RunResults_SetWorst_N" )
																							endswitch  }
END

;*************************************************************************
RULELIST "CARes_DesignRatingTDVResults_NESW" 1 0 0 1
;*************************************************************************

	"Store DRtg Proposed TDV-multiplied results (N)"		Proj:Action = {	EvalRulelist( "CARes_DRtgPropMultTDVResults_N" )  }		; SAC 3/14/16
	"Store DRtg Proposed TDV-multiplied results (E)"		Proj:Action = {	EvalRulelist( "CARes_DRtgPropMultTDVResults_E" )  }
	"Store DRtg Proposed TDV-multiplied results (S)"		Proj:Action = {	EvalRulelist( "CARes_DRtgPropMultTDVResults_S" )  }
	"Store DRtg Proposed TDV-multiplied results (W)"		Proj:Action = {	EvalRulelist( "CARes_DRtgPropMultTDVResults_W" )  }

; 1,           "DesignRatingTDV",   BEMP_Flt,  1,  0,  0, "kTDV/ft2-yr",      0,  0,             39110, "Design Rating TDV run result for this enduse" 
; 1,           "DRtgPctSavTDV",     BEMP_Flt,  1,  0,  0, "%",                0,  0,             39110, "Percent improvement (DesignRtg -> Prop TDV) for this enduse" 
; 1,           "DRtgDeltaDemand",   BEMP_Flt,  1,  0,  0, "kW",               0,  0,             39110, "Difference (DRtg-Prop elec demand) for this enduse" 

; 1,           "DRtgElecEnergy",    BEMP_Flt,  1,  0,  0, "kBTU/ft2-yr",      0,  0,             39110, "Design Rating run Eletric energy use for this enduse" 
; 1,           "DRtgNatGasEnergy",  BEMP_Flt,  1,  0,  0, "kBTU/ft2-yr",      0,  0,             39110, "Design Rating run Natural Gas energy use for this enduse" 
; 1,           "DRtgOtherEnergy",   BEMP_Flt,  1,  0,  0, "kBTU/ft2-yr",      0,  0,             39110, "Design Rating run Other Fuel energy use for this enduse" 
; 1,           "DRtgTotalEnergy",   BEMP_Flt,  1,  0,  0, "kBTU/ft2-yr",      0,  0,             39110, "Design Rating run TOTAL energy use for this enduse" 
; 
; 1,           "DRtgElecTDV",       BEMP_Flt,  1,  0,  0, "kTDV/ft2-yr",      0,  0,             39110, "Design Rating run Eletric TDV for this enduse" 
; 1,           "DRtgNatGasTDV",     BEMP_Flt,  1,  0,  0, "kTDV/ft2-yr",      0,  0,             39110, "Design Rating run Natural Gas TDV for this enduse" 
; 1,           "DRtgOtherTDV",      BEMP_Flt,  1,  0,  0, "kTDV/ft2-yr",      0,  0,             39110, "Design Rating run Other Fuel TDV for this enduse" 
; 
; 1,           "DRtgElecDemand",    BEMP_Flt,  1,  0,  0, "kW",               0,  0,             39110, "Design Rating run Eletric TDV for this enduse" 

; SAC 3/31/16 - added rules to set RunResultsN[*]:DesignRatingTDV[2] to set fuel-adjusted design rating TDV for use in setting design rating score
; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
         ; SAC 8/24/19 - replaced 1/3.413 & 0.01 TDV table multipliers with Proj:TDVSecMult_Elec & TDVSecMult_Fuel to accommodate 2022+ switch to native (E3) TDV table units
         ; SAC 8/26/19 - added primary table multipliers (of 1.0) to all ApplyHourlyResultMult* function calls (to accommodate 2022+ TDV table unit switch)
  ; Space Heating (& heating fan)
	"Calculate TDV - Elec   - N-SpcHt"		Proj:RunResultsN[1]:DRtgElecTDV			= {	if (LocalRef( RunResultsN[1]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-SpcHt"		Proj:RunResultsN[1]:DRtgNatGasTDV		= {	if (LocalRef( RunResultsN[1]:DRtgNatGasEnergy	) < 0.0001) then  0                                                                                                        
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-SpcHt"		Proj:RunResultsN[1]:DRtgOtherTDV			= {	if (LocalRef( RunResultsN[1]:DRtgOtherEnergy		) < 0.0001) then  0                                                                                                        
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Htg", "HPBU", "Aux"                ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-SpcHt"		Proj:RunResultsN[1]:DesignRatingTDV[1]	= {	LocalRef( RunResultsN[1]:DRtgElecTDV ) + LocalRef( RunResultsN[1]:DRtgNatGasTDV ) + LocalRef( RunResultsN[1]:DRtgOtherTDV )   }
	"Calculate TDV - TOTAL  - N-SpcHt"		Proj:RunResultsN[1]:DesignRatingTDV[2]	= {	if (T24R_EDRFuelAdjustment:SpcHtg( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr, "Metric", TDVEDRFuelMultMetric ) > 0)
																													then	LocalRef( RunResultsN[1]:DRtgElecTDV ) + ((LocalRef( RunResultsN[1]:DRtgNatGasTDV ) + LocalRef( RunResultsN[1]:DRtgOtherTDV )) /
																																													T24R_EDRFuelAdjustment:SpcHtg( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr, "Metric", TDVEDRFuelMultMetric ))
																													else	RunResultsN[1]:DesignRatingTDV[1]  endif   }
  ; SAC 8/23/14 - added rules to set elec demand
	"Calculate Elec Demand  - N-SpcHt"		Proj:RunResultsN[1]:DRtgElecDemand		= {	if (LocalRef( RunResultsN[1]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Htg", "HPBU", "FanH", "Aux", "Fan" ) / 3.412  endif  }

  ; Space Cooling (& cooling fan)
	"Calculate TDV - Elec   - N-SpcCl"		Proj:RunResultsN[2]:DRtgElecTDV			= {	if (LocalRef( RunResultsN[2]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Clg", "FanC" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-SpcCl"		Proj:RunResultsN[2]:DRtgNatGasTDV		= {	if (LocalRef( RunResultsN[2]:DRtgNatGasEnergy	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-SpcCl"		Proj:RunResultsN[2]:DRtgOtherTDV			= {	if (LocalRef( RunResultsN[2]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Clg"         ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-SpcCl"		Proj:RunResultsN[2]:DesignRatingTDV[1]	= {	LocalRef( RunResultsN[2]:DRtgElecTDV ) + LocalRef( RunResultsN[2]:DRtgNatGasTDV ) + LocalRef( RunResultsN[2]:DRtgOtherTDV )   }
;"dbg" Proj:Action = { PostMessageToLog( "   Setting RunResultsN[2]:DesignRatingTDV[2] based on T24R_EDRFuelAdjustment:SpcClg( CZ %g, CodeBase %g, BldgType %s, Metric %s ) => %g", ClimateZone, CompCodeBase, BldgTypeTblStr, TDVEDRFuelMultMetric, T24R_EDRFuelAdjustment:SpcClg( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr, "Metric", TDVEDRFuelMultMetric ) )  }
	"Calculate TDV - TOTAL  - N-SpcCl"		Proj:RunResultsN[2]:DesignRatingTDV[2]	= {	if (T24R_EDRFuelAdjustment:SpcClg( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr, "Metric", TDVEDRFuelMultMetric ) > 0)
																													then	LocalRef( RunResultsN[2]:DRtgElecTDV ) + ((LocalRef( RunResultsN[2]:DRtgNatGasTDV ) + LocalRef( RunResultsN[2]:DRtgOtherTDV )) /
																																													T24R_EDRFuelAdjustment:SpcClg( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr, "Metric", TDVEDRFuelMultMetric ))
																													else	RunResultsN[2]:DesignRatingTDV[1]  endif   }
	"Calculate Elec Demand  - N-SpcCl"		Proj:RunResultsN[2]:DRtgElecDemand		= {	if (LocalRef( RunResultsN[2]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Clg", "FanC" ) / 3.412  endif  }

  ; IAQ Ventilation Fans
	"Calculate TDV - Elec   - N-IAQVent"	Proj:RunResultsN[3]:DRtgElecTDV			= {	if (LocalRef( RunResultsN[3]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "IAQVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "FanV" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-IAQVent"	Proj:RunResultsN[3]:DRtgNatGasTDV		= {	0  }
	"Calculate TDV - Other  - N-IAQVent"	Proj:RunResultsN[3]:DRtgOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - N-IAQVent"	Proj:RunResultsN[3]:DesignRatingTDV[1]	= {	LocalRef( RunResultsN[3]:DRtgElecTDV )   }
	"Calculate TDV - TOTAL  - N-IAQVent"	Proj:RunResultsN[3]:DesignRatingTDV[2]	= {	RunResultsN[3]:DesignRatingTDV[1]   }
	"Calculate Elec Demand  - N-IAQVent"	Proj:RunResultsN[3]:DRtgElecDemand		= {	if (LocalRef( RunResultsN[3]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "FanV" ) / 3.412  endif  }

; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
  ; Other HVAC (aux & misc fans)
	"Calculate TDV - Elec   - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgElecTDV			= {	if (LocalRef( RunResultsN[4]:DRtgElecEnergy ) < 0.0001 .AND. OthrHVAC_SpcHtFrac == 0) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "OHVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "User1" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgNatGasTDV		= {	0  }
	"Calculate TDV - Other  - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:DesignRatingTDV[1]	= {	LocalRef( RunResultsN[4]:DRtgElecTDV )   }
	"Calculate TDV - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:DesignRatingTDV[2]	= {	RunResultsN[4]:DesignRatingTDV[1]   }
	"Calculate Elec Demand  - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgElecDemand		= {	if (LocalRef( RunResultsN[4]:DRtgElecEnergy ) < 0.0001 .AND. OthrHVAC_SpcHtFrac == 0) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "User1" ) / 3.412  endif  }

; SAC 1/27/19 - REDISTRIBUTE OthrHVAC DRtg TDV across SpcHt & SpcCl by fuel based on ratio of total TDV (across all fuels) (tic #1053)
   "Set OthrHVAC_SpcHtFrac - N-DRtgTDV"      Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResultsN[4]:DesignRatingTDV[1] != 0 )==0) then  0
                                                                           else if (IfValidAnd( RunResultsN[1]:DesignRatingTDV[1] == 0 ) .AND.
                                                                                    IfValidAnd( RunResultsN[2]:DesignRatingTDV[1] == 0 )) then  0.5
                                                                           else   ValidOr( RunResultsN[1]:DesignRatingTDV[1], 0 ) / 
                                                                                 (ValidOr( RunResultsN[1]:DesignRatingTDV[1], 0 ) + ValidOr( RunResultsN[2]:DesignRatingTDV[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Elec   - N-SpcHt"     Proj:RunResultsN[1]:DRtgElecTDV[1]	   = {   if (IfValidAnd( RunResultsN[4]:DRtgElecTDV[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsN[1]:DRtgElecTDV[1] + (RunResultsN[4]:DRtgElecTDV[1]     * OthrHVAC_SpcHtFrac)  endif  }
	"REALLOC OthrHVAC - TOTAL  - N-SpcHt"		Proj:RunResultsN[1]:DesignRatingTDV[1]	= {	LocalRef( RunResultsN[1]:DRtgElecTDV[1] ) + LocalRef( RunResultsN[1]:DRtgNatGasTDV[1] ) + LocalRef( RunResultsN[1]:DRtgOtherTDV[1] )   }
	"REALLOC OthrHVAC - TOTAL  - N-SpcHt"		Proj:RunResultsN[1]:DesignRatingTDV[2]	= {	if (T24R_EDRFuelAdjustment:SpcHtg( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr, "Metric", TDVEDRFuelMultMetric ) > 0)
   																													then	LocalRef( RunResultsN[1]:DRtgElecTDV ) + ((LocalRef( RunResultsN[1]:DRtgNatGasTDV ) + LocalRef( RunResultsN[1]:DRtgOtherTDV )) /
	   																																												T24R_EDRFuelAdjustment:SpcHtg( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr, "Metric", TDVEDRFuelMultMetric ))
		   																											else	RunResultsN[1]:DesignRatingTDV[1]  endif   }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Elec   - N-SpcCl"		Proj:RunResultsN[2]:DRtgElecTDV[1]	   = {   if (IfValidAnd( RunResultsN[4]:DRtgElecTDV[1] != 0 )==0) then  UNCHANGED
                                                                                          else  RunResultsN[2]:DRtgElecTDV[1] + (RunResultsN[4]:DRtgElecTDV[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
	"REALLOC OthrHVAC - TOTAL  - N-SpcCl"		Proj:RunResultsN[2]:DesignRatingTDV[1]	= {	LocalRef( RunResultsN[2]:DRtgElecTDV[1] ) + LocalRef( RunResultsN[2]:DRtgNatGasTDV[1] ) + LocalRef( RunResultsN[2]:DRtgOtherTDV[1] )   }
	"REALLOC OthrHVAC - TOTAL  - N-SpcCl"		Proj:RunResultsN[2]:DesignRatingTDV[2]	= {	if (T24R_EDRFuelAdjustment:SpcClg( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr, "Metric", TDVEDRFuelMultMetric ) > 0)
   																													then	LocalRef( RunResultsN[2]:DRtgElecTDV ) + ((LocalRef( RunResultsN[2]:DRtgNatGasTDV ) + LocalRef( RunResultsN[2]:DRtgOtherTDV )) /
	   																																												T24R_EDRFuelAdjustment:SpcClg( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr, "Metric", TDVEDRFuelMultMetric ))
		   																											else	RunResultsN[2]:DesignRatingTDV[1]  endif   }
   ; SAC 1/27/19 - REDISTRIBUTE OthrHVAC Prop Demand across SpcHt & SpcCl by fuel based on ratio of total Demand (tic #1053)
   "Set OthrHVAC_SpcHtFrac - N-DRtgDemand"   Proj:OthrHVAC_SpcHtFrac  = {  if (IfValidAnd( RunResultsN[4]:DRtgElecDemand[1] != 0 )==0) then  0
                                                                           else if (IfValidAnd( RunResultsN[1]:DRtgElecDemand[1] == 0 ) .AND.
                                                                                    IfValidAnd( RunResultsN[2]:DRtgElecDemand[1] == 0 )) then  0.5
                                                                           else   ValidOr( RunResultsN[1]:DRtgElecDemand[1], 0 ) / 
                                                                                 (ValidOr( RunResultsN[1]:DRtgElecDemand[1], 0 ) + ValidOr( RunResultsN[2]:DRtgElecDemand[1], 0 ))  endif endif  }
  ; Space Heating (& heating fan)
	"REALLOC OthrHVAC - Demand - N-SpcHt"		Proj:RunResultsN[1]:DRtgElecDemand[1] = { if (IfValidAnd( RunResultsN[4]:DRtgElecDemand[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResultsN[1]:DRtgElecDemand[1] + (RunResultsN[4]:DRtgElecDemand[1]     * OthrHVAC_SpcHtFrac)  endif  }
  ; Space Cooling (& cooling fan)
	"REALLOC OthrHVAC - Demand - N-SpcCl"		Proj:RunResultsN[2]:DRtgElecDemand[1] = { if (IfValidAnd( RunResultsN[4]:DRtgElecDemand[1] != 0 )==0) then  UNCHANGED
                                                                                       else  RunResultsN[2]:DRtgElecDemand[1] + (RunResultsN[4]:DRtgElecDemand[1]     * (1-OthrHVAC_SpcHtFrac))  endif  }
  ; Other HVAC (aux & misc fans)
	"ZERO-OUT         - Elec   - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgElecTDV[1]	   = {	0  }
	"ZERO-OUT         - NatGas - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgNatGasTDV[1]	= {	0  }
	"ZERO-OUT         - Other  - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgOtherTDV[1]	   = {	0  }
	"ZERO-OUT         - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:DesignRatingTDV[1]	= {	0  }
	"ZERO-OUT         - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:DesignRatingTDV[2]	= {	0  }
	"ZERO-OUT         - Demand - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgElecDemand[1]  = {	0  }
   ; SAC 1/27/19 - end of - redistribution of OthrHVAC PropTDV

  ; Water Heating
	"Calculate TDV - Elec   - N-WtrHt"		Proj:RunResultsN[5]:DRtgElecTDV			= {	if (LocalRef( RunResultsN[5]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else if (CSEinclDHWMFL_EU)
			 			  																							then  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / CondFloorArea) + 0.5) / 100
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / CondFloorArea) + 0.5) / 100  endif endif  }
	"Calculate TDV - NatGas - N-WtrHt"		Proj:RunResultsN[5]:DRtgNatGasTDV		= {	if (LocalRef( RunResultsN[5]:DRtgNatGasEnergy	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-WtrHt"		Proj:RunResultsN[5]:DRtgOtherTDV			= {	if (LocalRef( RunResultsN[5]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Dhw", "DhwBU" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-WtrHt"		Proj:RunResultsN[5]:DesignRatingTDV[1]	= {	LocalRef( RunResultsN[5]:DRtgElecTDV ) + LocalRef( RunResultsN[5]:DRtgNatGasTDV ) + LocalRef( RunResultsN[5]:DRtgOtherTDV )   }
	"Calculate TDV - TOTAL  - N-WtrHt"		Proj:RunResultsN[5]:DesignRatingTDV[2]	= {	if (T24R_EDRFuelAdjustment:WtrHtg( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr, "Metric", TDVEDRFuelMultMetric ) > 0)
																													then	LocalRef( RunResultsN[5]:DRtgElecTDV ) + ((LocalRef( RunResultsN[5]:DRtgNatGasTDV ) + LocalRef( RunResultsN[5]:DRtgOtherTDV )) /
																																													T24R_EDRFuelAdjustment:WtrHtg( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr, "Metric", TDVEDRFuelMultMetric ))
																													else	RunResultsN[5]:DesignRatingTDV[1]  endif   }
	"Calculate Elec Demand  - N-WtrHt"		Proj:RunResultsN[5]:DRtgElecDemand		= {	if (LocalRef( RunResultsN[5]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else if (CSEinclDHWMFL_EU)
			 			  																							then  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2", "DhwMFL" ) / 3.412
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Dhw", "DhwBU", "DHWPmp", "User2"           ) / 3.412  endif endif  }

  ; Inside Lighting
	"Calculate TDV - Elec   - N-InsLtg"		Proj:RunResultsN[6]:DRtgElecTDV			= {	if (LocalRef( RunResultsN[6]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-InsLtg"		Proj:RunResultsN[6]:DRtgNatGasTDV		= {	if (LocalRef( RunResultsN[6]:DRtgNatGasEnergy	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-InsLtg"		Proj:RunResultsN[6]:DRtgOtherTDV			= {	if (LocalRef( RunResultsN[6]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Lit" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-InsLtg"		Proj:RunResultsN[6]:DesignRatingTDV[1]	= {	LocalRef( RunResultsN[6]:DRtgElecTDV ) + LocalRef( RunResultsN[6]:DRtgNatGasTDV ) + LocalRef( RunResultsN[6]:DRtgOtherTDV )   }
	"Calculate TDV - TOTAL  - N-InsLtg"		Proj:RunResultsN[6]:DesignRatingTDV[2]	= {	RunResultsN[6]:DesignRatingTDV[1]   }
	"Calculate Elec Demand  - N-InsLtg"		Proj:RunResultsN[6]:DRtgElecDemand		= {	if (LocalRef( RunResultsN[6]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Lit" ) / 3.412  endif  }

  ; Appliances & Cooking
	"Calculate TDV - Elec   - N-AppCkg"		Proj:RunResultsN[7]:DRtgElecTDV			= {	if (LocalRef( RunResultsN[7]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-AppCkg"		Proj:RunResultsN[7]:DRtgNatGasTDV		= {	if (LocalRef( RunResultsN[7]:DRtgNatGasEnergy	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-AppCkg"		Proj:RunResultsN[7]:DRtgOtherTDV			= {	if (LocalRef( RunResultsN[7]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-AppCkg"		Proj:RunResultsN[7]:DesignRatingTDV[1]	= {	LocalRef( RunResultsN[7]:DRtgElecTDV ) + LocalRef( RunResultsN[7]:DRtgNatGasTDV ) + LocalRef( RunResultsN[7]:DRtgOtherTDV )   }
	"Calculate TDV - TOTAL  - N-AppCkg"		Proj:RunResultsN[7]:DesignRatingTDV[2]	= {	if (T24R_EDRFuelAdjustment:AppCkg( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr, "Metric", TDVEDRFuelMultMetric ) > 0)
																													then	LocalRef( RunResultsN[7]:DRtgElecTDV ) + ((LocalRef( RunResultsN[7]:DRtgNatGasTDV ) + LocalRef( RunResultsN[7]:DRtgOtherTDV )) /
																																											T24R_EDRFuelAdjustment:AppCkg( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", BldgTypeTblStr, "Metric", TDVEDRFuelMultMetric ))
																													else	RunResultsN[7]:DesignRatingTDV[1]  endif   }
	"Calculate Elec Demand  - N-AppCkg"		Proj:RunResultsN[7]:DRtgElecDemand		= {	if (LocalRef( RunResultsN[7]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / 3.412  endif  }

  ; Plug Loads
	"Calculate TDV - Elec   - N-Plugs"		Proj:RunResultsN[8]:DRtgElecTDV			= {	if (LocalRef( RunResultsN[8]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-Plugs"		Proj:RunResultsN[8]:DRtgNatGasTDV		= {	if (LocalRef( RunResultsN[8]:DRtgNatGasEnergy	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-Plugs"		Proj:RunResultsN[8]:DRtgOtherTDV			= {	if (LocalRef( RunResultsN[8]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Rcp" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-Plugs"		Proj:RunResultsN[8]:DesignRatingTDV[1]	= {	LocalRef( RunResultsN[8]:DRtgElecTDV ) + LocalRef( RunResultsN[8]:DRtgNatGasTDV ) + LocalRef( RunResultsN[8]:DRtgOtherTDV )   }
	"Calculate TDV - TOTAL  - N-Plugs"		Proj:RunResultsN[8]:DesignRatingTDV[2]	= {	RunResultsN[8]:DesignRatingTDV[1]   }
	"Calculate Elec Demand  - N-Plugs"		Proj:RunResultsN[8]:DRtgElecDemand		= {	if (LocalRef( RunResultsN[8]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Rcp" ) / 3.412  endif  }

  ; Exterior
	"Calculate TDV - Elec   - N-Ext"			Proj:RunResultsN[9]:DRtgElecTDV			= {	if (LocalRef( RunResultsN[9]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-Ext"			Proj:RunResultsN[9]:DRtgNatGasTDV		= {	if (LocalRef( RunResultsN[9]:DRtgNatGasEnergy	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", TDVTableName, ((ClimateZone-1) * 3) + 2, TDVMult_Fuel, TDVSecTbl_NGas, ClimateZone, TDVSecMult_Fuel, RunID, "MtrNatGas", "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-Ext"			Proj:RunResultsN[9]:DRtgOtherTDV			= {	if (LocalRef( RunResultsN[9]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", TDVTableName, ((ClimateZone-1) * 3) + 3, TDVMult_Fuel, TDVSecTbl_Othr, ClimateZone, TDVSecMult_Fuel, RunID, "MtrOther",  "Ext" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-Ext"			Proj:RunResultsN[9]:DesignRatingTDV[1]	= {	LocalRef( RunResultsN[9]:DRtgElecTDV ) + LocalRef( RunResultsN[9]:DRtgNatGasTDV ) + LocalRef( RunResultsN[9]:DRtgOtherTDV )   }
	"Calculate TDV - TOTAL  - N-Ext"			Proj:RunResultsN[9]:DesignRatingTDV[2]	= {	RunResultsN[9]:DesignRatingTDV[1]   }
	"Calculate Elec Demand  - N-Ext"			Proj:RunResultsN[9]:DRtgElecDemand		= {	if (LocalRef( RunResultsN[9]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "Ext" ) / 3.412  endif  }

  ; PV
	"Calculate TDV - Elec   - N-PV"			Proj:RunResultsN[13]:DRtgElecTDV			= {	if (LocalRef( RunResultsN[13]:DRtgElecEnergy		) > -0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "PVTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec", "PV" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-PV"			Proj:RunResultsN[13]:DRtgNatGasTDV		= {	0  }
	"Calculate TDV - Other  - N-PV"			Proj:RunResultsN[13]:DRtgOtherTDV		= {	0  }
	"Calculate TDV - TOTAL  - N-PV"			Proj:RunResultsN[13]:DesignRatingTDV[1] = {	LocalRef( RunResultsN[13]:DRtgElecTDV )   }
	"Calculate TDV - TOTAL  - N-PV"			Proj:RunResultsN[13]:DesignRatingTDV[2] = {	RunResultsN[13]:DesignRatingTDV[1]   }
	"Calculate Elec Demand  - N-PV"			Proj:RunResultsN[13]:DRtgElecDemand		= {	if (LocalRef( RunResultsN[13]:DRtgElecEnergy		) > -0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "PV" ) / 3.412  endif  }

  ; Battery
	"Calculate TDV - Elec   - N-Battery"	Proj:RunResultsN[14]:DRtgElecTDV			= {	if (LocalRef( RunResultsN[14]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "BTTDV", TDVTableName, ((ClimateZone-1) * 3) + 1, TDVMult_Elec, TDVSecTbl_Elec, ClimateZone, TDVSecMult_Elec, RunID, "MtrElec",   "BT" ) / CondFloorArea) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-Battery"	Proj:RunResultsN[14]:DRtgNatGasTDV		= {	0  }
	"Calculate TDV - Other  - N-Battery"	Proj:RunResultsN[14]:DRtgOtherTDV		= {	0  }
	"Calculate TDV - TOTAL  - N-Battery"	Proj:RunResultsN[14]:DesignRatingTDV[1] = {	LocalRef( RunResultsN[14]:DRtgElecTDV )   }
	"Calculate TDV - TOTAL  - N-Battery"	Proj:RunResultsN[14]:DesignRatingTDV[2] = {	RunResultsN[14]:DesignRatingTDV[1]   }
	"Calculate Elec Demand  - N-Battery"	Proj:RunResultsN[14]:DRtgElecDemand		= {	if (LocalRef( RunResultsN[14]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, 1, "none", 0, 0, RunID, "MtrElec",   "BT" ) / 3.412  endif  }

  ; Compliance Total
	"Calculate TDV - Elec   - N-Comp Ttl"	Proj:RunResultsN[11]:DRtgElecTDV			= {	RunResultsN[1]:DRtgElecTDV     + RunResultsN[2]:DRtgElecTDV     + RunResultsN[3]:DRtgElecTDV     + RunResultsN[4]:DRtgElecTDV     + RunResultsN[5]:DRtgElecTDV      }
	"Calculate TDV - NatGas - N-Comp Ttl"	Proj:RunResultsN[11]:DRtgNatGasTDV		= {	RunResultsN[1]:DRtgNatGasTDV   + RunResultsN[2]:DRtgNatGasTDV   + RunResultsN[3]:DRtgNatGasTDV   + RunResultsN[4]:DRtgNatGasTDV   + RunResultsN[5]:DRtgNatGasTDV    }
	"Calculate TDV - Other  - N-Comp Ttl"	Proj:RunResultsN[11]:DRtgOtherTDV		= {	RunResultsN[1]:DRtgOtherTDV    + RunResultsN[2]:DRtgOtherTDV    + RunResultsN[3]:DRtgOtherTDV    + RunResultsN[4]:DRtgOtherTDV    + RunResultsN[5]:DRtgOtherTDV     }
	"Calculate TDV - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:DesignRatingTDV[1] = {	RunResultsN[1]:DesignRatingTDV[1] + RunResultsN[2]:DesignRatingTDV[1] + RunResultsN[3]:DesignRatingTDV[1] + RunResultsN[4]:DesignRatingTDV[1] + RunResultsN[5]:DesignRatingTDV[1]  }
	"Calculate TDV - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:DesignRatingTDV[2] = {	RunResultsN[1]:DesignRatingTDV[2] + RunResultsN[2]:DesignRatingTDV[2] + RunResultsN[3]:DesignRatingTDV[2] + RunResultsN[4]:DesignRatingTDV[2] + RunResultsN[5]:DesignRatingTDV[2]  }
	"Calculate Elec Demand  - N-Comp Ttl"	Proj:RunResultsN[11]:DRtgElecDemand		= {	RunResultsN[1]:DRtgElecDemand  + RunResultsN[2]:DRtgElecDemand  + RunResultsN[3]:DRtgElecDemand  + RunResultsN[4]:DRtgElecDemand  + RunResultsN[5]:DRtgElecDemand   }

  ; Total
	"Calculate TDV - Elec   - N-Total"		Proj:RunResultsN[10]:DRtgElecTDV			= {	RunResultsN[11]:DRtgElecTDV     + RunResultsN[6]:DRtgElecTDV     + RunResultsN[7]:DRtgElecTDV     + RunResultsN[8]:DRtgElecTDV     + RunResultsN[9]:DRtgElecTDV      }
	"Calculate TDV - NatGas - N-Total"		Proj:RunResultsN[10]:DRtgNatGasTDV		= {	RunResultsN[11]:DRtgNatGasTDV   + RunResultsN[6]:DRtgNatGasTDV   + RunResultsN[7]:DRtgNatGasTDV   + RunResultsN[8]:DRtgNatGasTDV   + RunResultsN[9]:DRtgNatGasTDV    }
	"Calculate TDV - Other  - N-Total"		Proj:RunResultsN[10]:DRtgOtherTDV		= {	RunResultsN[11]:DRtgOtherTDV    + RunResultsN[6]:DRtgOtherTDV    + RunResultsN[7]:DRtgOtherTDV    + RunResultsN[8]:DRtgOtherTDV    + RunResultsN[9]:DRtgOtherTDV     }
	"Calculate TDV - TOTAL  - N-Total"		Proj:RunResultsN[10]:DesignRatingTDV[1] = {	RunResultsN[11]:DesignRatingTDV[1] + RunResultsN[6]:DesignRatingTDV[1] + RunResultsN[7]:DesignRatingTDV[1] + RunResultsN[8]:DesignRatingTDV[1] + RunResultsN[9]:DesignRatingTDV[1]  }
	"Calculate TDV - TOTAL  - N-Total"		Proj:RunResultsN[10]:DesignRatingTDV[2] = {	RunResultsN[11]:DesignRatingTDV[2] + RunResultsN[6]:DesignRatingTDV[2] + RunResultsN[7]:DesignRatingTDV[2] + RunResultsN[8]:DesignRatingTDV[2] + RunResultsN[9]:DesignRatingTDV[2]  }
	"Calculate Elec Demand  - N-Total"		Proj:RunResultsN[10]:DRtgElecDemand		= {	RunResultsN[11]:DRtgElecDemand  + RunResultsN[6]:DRtgElecDemand  + RunResultsN[7]:DRtgElecDemand  + RunResultsN[8]:DRtgElecDemand  + RunResultsN[9]:DRtgElecDemand   }


  ; SAC 2/1/16 - inserted RE-calc of Standard model PVCredit (so that it is available for analysis results reporting following design rating run)
	"Set Proj:PVBaseTDV"						Proj:PVBaseTDV	= {	RunResultsN[11]:StandardTDV * CondFloorArea  }		; SAC 4/14/15 - switched from elecTotalTDV to totalCompTDV - was: RunResultsN[10]:StdElecTDV
	"Perform PV calcs if applicable"		Proj:Action		= {	if (PVGenCredit < 1 .OR. StandardsVersion == 2014 .OR. CondFloorArea < 0.01) then  UNCHANGED
																				else	switch ( CompCodeBase )
																							case  2013 :	EvalRulelist( "CARes_CalculatePVCredit_2013Compliance" )
																							case  2016 :	EvalRulelist( "CARes_CalculatePVCredit_2016Compliance" )
																							default    :	UNCHANGED   ; no specific PV credit for 2019 or 2022
																						endswitch  endif  }

	; SAC 4/2/14 - moved PV credit calcs into subordinate rulelist
	"Set Proj:PVBaseTDV - DRtg"						Proj:PVBaseTDV	= {	RunResultsN[10]:DesignRatingTDV[1] * CondFloorArea  }		; SAC 4/14/15 - switched from elecTDV to totalTDV - was: RunResultsN[10]:DRtgElecTDV
		; SAC 2/7/18 - removed logic 'PVGenCredit < 1 .OR.' preventing call to CARes_CalculatePVCredit_2016DesignRating when compliance PV credit toggled off  (repeat of mod made above 3/24/16)
	"Perform PV calcs if applicable - DRtg"		Proj:Action		= {	if ((StdDesignBase == 2013 .AND. StandardsVersion == 2014) .OR. CondFloorArea < 0.01) then  UNCHANGED
																							else	switch ( CompCodeBase )
																										case  2016 :	EvalRulelist( "CARes_CalculatePVCredit_2016DesignRating" )
																										case  2019 :	EvalRulelist( "CARes_CalculatePVCredit_2016DesignRating" )  ; DsgnRtg PVCredit for 2016 & 2019 same
																										case  2022 :	EvalRulelist( "CARes_CalculatePVCredit_2016DesignRating" )  ; DsgnRtg PVCredit for 2016, 2019 & 2022 same ??
																										default    :	UNCHANGED
																									endswitch  endif  }
	; SAC 4/3/15 - set new EnergyUse:PropPVCreditTDV property (needed to track & pass PVCredit from first to second Proposed EnergyUse data)
	"Store PropPVCreditTDV[2] - N"			Proj:RunResultsN[6]:PropPVCreditTDV[2]		= {	PVCredit[2]  }
	"Store PropPVCreditTDV[2] - E"			Proj:RunResultsE[6]:PropPVCreditTDV[2]		= {	PVCredit[2]  }
	"Store PropPVCreditTDV[2] - S"			Proj:RunResultsS[6]:PropPVCreditTDV[2]		= {	PVCredit[2]  }
	"Store PropPVCreditTDV[2] - W"			Proj:RunResultsW[6]:PropPVCreditTDV[2]		= {	PVCredit[2]  }

	; SAC 4/9/15 - adjust RunResults[6]:Prop*[2] properties for DRtgLtgReduction
	"Adjust - Elec   - N-InsLtg for DRtgLtgReduction"	Proj:RunResultsN[6]:PropElecEnergy[2]		= {	if (DRtgLtgReduction <= 0 .OR. RunResultsN[6]:PropElecEnergy[2]   <= 0) then  UNCHANGED
			 			  																												else                           RunResultsN[6]:PropElecEnergy[2]   * (100 - DRtgLtgReduction) / 100  endif  }
	"Adjust - NatGas - N-InsLtg for DRtgLtgReduction"	Proj:RunResultsN[6]:PropNatGasEnergy[2]	= {	if (DRtgLtgReduction <= 0 .OR. RunResultsN[6]:PropNatGasEnergy[2] <= 0) then  UNCHANGED
			 			  																												else                           RunResultsN[6]:PropNatGasEnergy[2] * (100 - DRtgLtgReduction) / 100  endif  }
	"Adjust - Other  - N-InsLtg for DRtgLtgReduction"	Proj:RunResultsN[6]:PropOtherEnergy[2]		= {	if (DRtgLtgReduction <= 0 .OR. RunResultsN[6]:PropOtherEnergy[2]  <= 0) then  UNCHANGED
			 			  																												else                           RunResultsN[6]:PropOtherEnergy[2]  * (100 - DRtgLtgReduction) / 100  endif  }
	"Adjust - Elec   - N-InsLtg for DRtgLtgReduction"	Proj:RunResultsN[6]:PropElecTDV[2]			= {	if (DRtgLtgReduction <= 0 .OR. RunResultsN[6]:PropElecTDV[2]      <= 0) then  UNCHANGED
			 			  																												else              int( (100 * (RunResultsN[6]:PropElecTDV[2]      * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
;	"Adjust - NatGas - N-InsLtg for DRtgLtgReduction"	Proj:RunResultsN[6]:PropNatGasTDV			= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropNatGasTDV[2]    <= 0) then  UNCHANGED
;			 			  																												else              int( (100 * (RunResults[6]:PropNatGasTDV[2]    * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
;	"Adjust - Other  - N-InsLtg for DRtgLtgReduction"	Proj:RunResultsN[6]:PropOtherTDV				= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropOtherTDV[2]     <= 0) then  UNCHANGED
;																																		else              int( (100 * (RunResults[6]:PropOtherTDV[2]     * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
	"Adjust E Demand - N-InsLtg for DRtgLtgReduction"	Proj:RunResultsN[6]:PropElecDemand[2]		= {	if (DRtgLtgReduction <= 0 .OR. RunResultsN[6]:PropElecDemand[2]   <= 0) then  UNCHANGED
			 			  																												else                           RunResultsN[6]:PropElecDemand[2]   * (100 - DRtgLtgReduction) / 100  endif  }
	"Recalc - TOTAL  - N-InsLtg for DRtgLtgReduction"	Proj:RunResultsN[6]:PropTotalEnergy[2]		= {	RunResultsN[6]:PropElecEnergy[2] + RunResultsN[6]:PropNatGasEnergy[2] + RunResultsN[6]:PropOtherEnergy[2]   }
	"Recalc - TOTAL  - N-InsLtg for DRtgLtgReduction"	Proj:RunResultsN[6]:ProposedTDV[2]			= {	RunResultsN[6]:PropElecTDV[2]    + RunResultsN[6]:PropNatGasTDV       + RunResultsN[6]:PropOtherTDV         }
	"Recalc - TOTAL  - N-InsLtg for DRtgLtgReduction"	Proj:RunResultsN[6]:ProposedTDV[3]			= {	RunResultsN[6]:ProposedTDV[2]  }

	"Adjust - Elec   - E-InsLtg for DRtgLtgReduction"	Proj:RunResultsE[6]:PropElecEnergy[2]		= {	if (DRtgLtgReduction <= 0 .OR. RunResultsE[6]:PropElecEnergy[2]   <= 0) then  UNCHANGED
			 			  																												else                           RunResultsE[6]:PropElecEnergy[2]   * (100 - DRtgLtgReduction) / 100  endif  }
	"Adjust - NatGas - E-InsLtg for DRtgLtgReduction"	Proj:RunResultsE[6]:PropNatGasEnergy[2]	= {	if (DRtgLtgReduction <= 0 .OR. RunResultsE[6]:PropNatGasEnergy[2] <= 0) then  UNCHANGED
			 			  																												else                           RunResultsE[6]:PropNatGasEnergy[2] * (100 - DRtgLtgReduction) / 100  endif  }
	"Adjust - Other  - E-InsLtg for DRtgLtgReduction"	Proj:RunResultsE[6]:PropOtherEnergy[2]		= {	if (DRtgLtgReduction <= 0 .OR. RunResultsE[6]:PropOtherEnergy[2]  <= 0) then  UNCHANGED
			 			  																												else                           RunResultsE[6]:PropOtherEnergy[2]  * (100 - DRtgLtgReduction) / 100  endif  }
	"Adjust - Elec   - E-InsLtg for DRtgLtgReduction"	Proj:RunResultsE[6]:PropElecTDV[2]			= {	if (DRtgLtgReduction <= 0 .OR. RunResultsE[6]:PropElecTDV[2]      <= 0) then  UNCHANGED
			 			  																												else              int( (100 * (RunResultsE[6]:PropElecTDV[2]      * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
;	"Adjust - NatGas - E-InsLtg for DRtgLtgReduction"	Proj:RunResultsE[6]:PropNatGasTDV			= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropNatGasTDV[2]    <= 0) then  UNCHANGED
;			 			  																												else              int( (100 * (RunResults[6]:PropNatGasTDV[2]    * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
;	"Adjust - Other  - E-InsLtg for DRtgLtgReduction"	Proj:RunResultsE[6]:PropOtherTDV				= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropOtherTDV[2]     <= 0) then  UNCHANGED
;																																		else              int( (100 * (RunResults[6]:PropOtherTDV[2]     * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
	"Adjust E Demand - E-InsLtg for DRtgLtgReduction"	Proj:RunResultsE[6]:PropElecDemand[2]		= {	if (DRtgLtgReduction <= 0 .OR. RunResultsE[6]:PropElecDemand[2]   <= 0) then  UNCHANGED
			 			  																												else                           RunResultsE[6]:PropElecDemand[2]   * (100 - DRtgLtgReduction) / 100  endif  }
	"Recalc - TOTAL  - E-InsLtg for DRtgLtgReduction"	Proj:RunResultsE[6]:PropTotalEnergy[2]		= {	RunResultsE[6]:PropElecEnergy[2] + RunResultsE[6]:PropNatGasEnergy[2] + RunResultsE[6]:PropOtherEnergy[2]   }
	"Recalc - TOTAL  - E-InsLtg for DRtgLtgReduction"	Proj:RunResultsE[6]:ProposedTDV[2]			= {	RunResultsE[6]:PropElecTDV[2]    + RunResultsE[6]:PropNatGasTDV       + RunResultsE[6]:PropOtherTDV         }
	"Recalc - TOTAL  - E-InsLtg for DRtgLtgReduction"	Proj:RunResultsE[6]:ProposedTDV[3]			= {	RunResultsE[6]:ProposedTDV[2]  }

	"Adjust - Elec   - S-InsLtg for DRtgLtgReduction"	Proj:RunResultsS[6]:PropElecEnergy[2]		= {	if (DRtgLtgReduction <= 0 .OR. RunResultsS[6]:PropElecEnergy[2]   <= 0) then  UNCHANGED
			 			  																												else                           RunResultsS[6]:PropElecEnergy[2]   * (100 - DRtgLtgReduction) / 100  endif  }
	"Adjust - NatGas - S-InsLtg for DRtgLtgReduction"	Proj:RunResultsS[6]:PropNatGasEnergy[2]	= {	if (DRtgLtgReduction <= 0 .OR. RunResultsS[6]:PropNatGasEnergy[2] <= 0) then  UNCHANGED
			 			  																												else                           RunResultsS[6]:PropNatGasEnergy[2] * (100 - DRtgLtgReduction) / 100  endif  }
	"Adjust - Other  - S-InsLtg for DRtgLtgReduction"	Proj:RunResultsS[6]:PropOtherEnergy[2]		= {	if (DRtgLtgReduction <= 0 .OR. RunResultsS[6]:PropOtherEnergy[2]  <= 0) then  UNCHANGED
			 			  																												else                           RunResultsS[6]:PropOtherEnergy[2]  * (100 - DRtgLtgReduction) / 100  endif  }
	"Adjust - Elec   - S-InsLtg for DRtgLtgReduction"	Proj:RunResultsS[6]:PropElecTDV[2]			= {	if (DRtgLtgReduction <= 0 .OR. RunResultsS[6]:PropElecTDV[2]      <= 0) then  UNCHANGED
			 			  																												else              int( (100 * (RunResultsS[6]:PropElecTDV[2]      * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
;	"Adjust - NatGas - S-InsLtg for DRtgLtgReduction"	Proj:RunResultsS[6]:PropNatGasTDV			= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropNatGasTDV[2]    <= 0) then  UNCHANGED
;			 			  																												else              int( (100 * (RunResults[6]:PropNatGasTDV[2]    * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
;	"Adjust - Other  - S-InsLtg for DRtgLtgReduction"	Proj:RunResultsS[6]:PropOtherTDV				= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropOtherTDV[2]     <= 0) then  UNCHANGED
;																																		else              int( (100 * (RunResults[6]:PropOtherTDV[2]     * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
	"Adjust E Demand - S-InsLtg for DRtgLtgReduction"	Proj:RunResultsS[6]:PropElecDemand[2]		= {	if (DRtgLtgReduction <= 0 .OR. RunResultsS[6]:PropElecDemand[2]   <= 0) then  UNCHANGED
			 			  																												else                           RunResultsS[6]:PropElecDemand[2]   * (100 - DRtgLtgReduction) / 100  endif  }
	"Recalc - TOTAL  - S-InsLtg for DRtgLtgReduction"	Proj:RunResultsS[6]:PropTotalEnergy[2]		= {	RunResultsS[6]:PropElecEnergy[2] + RunResultsS[6]:PropNatGasEnergy[2] + RunResultsS[6]:PropOtherEnergy[2]   }
	"Recalc - TOTAL  - S-InsLtg for DRtgLtgReduction"	Proj:RunResultsS[6]:ProposedTDV[2]			= {	RunResultsS[6]:PropElecTDV[2]    + RunResultsS[6]:PropNatGasTDV       + RunResultsS[6]:PropOtherTDV         }
	"Recalc - TOTAL  - S-InsLtg for DRtgLtgReduction"	Proj:RunResultsS[6]:ProposedTDV[3]			= {	RunResultsS[6]:ProposedTDV[2]  }

	"Adjust - Elec   - W-InsLtg for DRtgLtgReduction"	Proj:RunResultsW[6]:PropElecEnergy[2]		= {	if (DRtgLtgReduction <= 0 .OR. RunResultsW[6]:PropElecEnergy[2]   <= 0) then  UNCHANGED
			 			  																												else                           RunResultsW[6]:PropElecEnergy[2]   * (100 - DRtgLtgReduction) / 100  endif  }
	"Adjust - NatGas - W-InsLtg for DRtgLtgReduction"	Proj:RunResultsW[6]:PropNatGasEnergy[2]	= {	if (DRtgLtgReduction <= 0 .OR. RunResultsW[6]:PropNatGasEnergy[2] <= 0) then  UNCHANGED
			 			  																												else                           RunResultsW[6]:PropNatGasEnergy[2] * (100 - DRtgLtgReduction) / 100  endif  }
	"Adjust - Other  - W-InsLtg for DRtgLtgReduction"	Proj:RunResultsW[6]:PropOtherEnergy[2]		= {	if (DRtgLtgReduction <= 0 .OR. RunResultsW[6]:PropOtherEnergy[2]  <= 0) then  UNCHANGED
			 			  																												else                           RunResultsW[6]:PropOtherEnergy[2]  * (100 - DRtgLtgReduction) / 100  endif  }
	"Adjust - Elec   - W-InsLtg for DRtgLtgReduction"	Proj:RunResultsW[6]:PropElecTDV[2]			= {	if (DRtgLtgReduction <= 0 .OR. RunResultsW[6]:PropElecTDV[2]      <= 0) then  UNCHANGED
			 			  																												else              int( (100 * (RunResultsW[6]:PropElecTDV[2]      * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
;	"Adjust - NatGas - W-InsLtg for DRtgLtgReduction"	Proj:RunResultsW[6]:PropNatGasTDV			= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropNatGasTDV[2]    <= 0) then  UNCHANGED
;			 			  																												else              int( (100 * (RunResults[6]:PropNatGasTDV[2]    * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
;	"Adjust - Other  - W-InsLtg for DRtgLtgReduction"	Proj:RunResultsW[6]:PropOtherTDV				= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropOtherTDV[2]     <= 0) then  UNCHANGED
;																																		else              int( (100 * (RunResults[6]:PropOtherTDV[2]     * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
	"Adjust E Demand - W-InsLtg for DRtgLtgReduction"	Proj:RunResultsW[6]:PropElecDemand[2]		= {	if (DRtgLtgReduction <= 0 .OR. RunResultsW[6]:PropElecDemand[2]   <= 0) then  UNCHANGED
			 			  																												else                           RunResultsW[6]:PropElecDemand[2]   * (100 - DRtgLtgReduction) / 100  endif  }
	"Recalc - TOTAL  - W-InsLtg for DRtgLtgReduction"	Proj:RunResultsW[6]:PropTotalEnergy[2]		= {	RunResultsW[6]:PropElecEnergy[2] + RunResultsW[6]:PropNatGasEnergy[2] + RunResultsW[6]:PropOtherEnergy[2]   }
	"Recalc - TOTAL  - W-InsLtg for DRtgLtgReduction"	Proj:RunResultsW[6]:ProposedTDV[2]			= {	RunResultsW[6]:PropElecTDV[2]    + RunResultsW[6]:PropNatGasTDV       + RunResultsW[6]:PropOtherTDV         }
	"Recalc - TOTAL  - W-InsLtg for DRtgLtgReduction"	Proj:RunResultsW[6]:ProposedTDV[3]			= {	RunResultsW[6]:ProposedTDV[2]  }

; ADJUST certain Proposed results that now are to have PVCredit applied to them
; mjb-10/16/13	subtracted PVCredit from Proposed Design Elec and TOTAL 
; SAC 4/9/15 - updated to also recalc energy use sums (to catch mods for design rating lighting credit)
; SAC 3/3/18 - shifted PV & Batt from CompTot to Tot for 2019 (done on 4/7/17 for single orientation runs) (tic #973)
	"Recalc total - Elec   - N-Comp Ttl"	Proj:RunResultsN[11]:PropElecEnergy[2]		= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsN[1]:PropElecEnergy[2]    + RunResultsN[2]:PropElecEnergy[2]   + RunResultsN[3]:PropElecEnergy[2]   + RunResultsN[4]:PropElecEnergy[2]   + RunResultsN[5]:PropElecEnergy[2]   + RunResultsN[13]:PropElecEnergy[2]   + RunResultsN[14]:PropElecEnergy[2]    
                                                                                          else  RunResultsN[1]:PropElecEnergy[2]    + RunResultsN[2]:PropElecEnergy[2]   + RunResultsN[3]:PropElecEnergy[2]   + RunResultsN[4]:PropElecEnergy[2]   + RunResultsN[5]:PropElecEnergy[2]    endif  }
	"Recalc total - NatGas - N-Comp Ttl"	Proj:RunResultsN[11]:PropNatGasEnergy[2]	= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsN[1]:PropNatGasEnergy[2]  + RunResultsN[2]:PropNatGasEnergy[2] + RunResultsN[3]:PropNatGasEnergy[2] + RunResultsN[4]:PropNatGasEnergy[2] + RunResultsN[5]:PropNatGasEnergy[2] + RunResultsN[13]:PropNatGasEnergy[2] + RunResultsN[14]:PropNatGasEnergy[2]  
                                                                                          else  RunResultsN[1]:PropNatGasEnergy[2]  + RunResultsN[2]:PropNatGasEnergy[2] + RunResultsN[3]:PropNatGasEnergy[2] + RunResultsN[4]:PropNatGasEnergy[2] + RunResultsN[5]:PropNatGasEnergy[2]  endif  }
	"Recalc total - Other  - N-Comp Ttl"	Proj:RunResultsN[11]:PropOtherEnergy[2]	= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsN[1]:PropOtherEnergy[2]   + RunResultsN[2]:PropOtherEnergy[2]  + RunResultsN[3]:PropOtherEnergy[2]  + RunResultsN[4]:PropOtherEnergy[2]  + RunResultsN[5]:PropOtherEnergy[2]  + RunResultsN[13]:PropOtherEnergy[2]  + RunResultsN[14]:PropOtherEnergy[2]   
                                                                                          else  RunResultsN[1]:PropOtherEnergy[2]   + RunResultsN[2]:PropOtherEnergy[2]  + RunResultsN[3]:PropOtherEnergy[2]  + RunResultsN[4]:PropOtherEnergy[2]  + RunResultsN[5]:PropOtherEnergy[2]   endif  }
	"Recalc total - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:PropTotalEnergy[2]	= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsN[1]:PropTotalEnergy[2]   + RunResultsN[2]:PropTotalEnergy[2]  + RunResultsN[3]:PropTotalEnergy[2]  + RunResultsN[4]:PropTotalEnergy[2]  + RunResultsN[5]:PropTotalEnergy[2]  + RunResultsN[13]:PropTotalEnergy[2]  + RunResultsN[14]:PropTotalEnergy[2]   
                                                                                          else  RunResultsN[1]:PropTotalEnergy[2]   + RunResultsN[2]:PropTotalEnergy[2]  + RunResultsN[3]:PropTotalEnergy[2]  + RunResultsN[4]:PropTotalEnergy[2]  + RunResultsN[5]:PropTotalEnergy[2]   endif  }
	"Recalc TDV   - Elec   - N-Comp Ttl"	Proj:RunResultsN[11]:PropElecTDV[2]			= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsN[1]:PropElecTDV[2]       + RunResultsN[2]:PropElecTDV[2]      + RunResultsN[3]:PropElecTDV[2]      + RunResultsN[4]:PropElecTDV[2]      + RunResultsN[5]:PropElecTDV[2]      + RunResultsN[13]:PropElecTDV[2]      + RunResultsN[14]:PropElecTDV[2]        ; - PVCredit[2]  }
                                                                                          else  RunResultsN[1]:PropElecTDV[2]       + RunResultsN[2]:PropElecTDV[2]      + RunResultsN[3]:PropElecTDV[2]      + RunResultsN[4]:PropElecTDV[2]      + RunResultsN[5]:PropElecTDV[2]       endif  } ; - PVCredit[2]  }
	"Recalc TDV   - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:ProposedTDV[2]			= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsN[1]:ProposedTDV[2]       + RunResultsN[2]:ProposedTDV[2]      + RunResultsN[3]:ProposedTDV[2]      + RunResultsN[4]:ProposedTDV[2]      + RunResultsN[5]:ProposedTDV[2]      + RunResultsN[13]:ProposedTDV[2]      + RunResultsN[14]:ProposedTDV[2]        ; - PVCredit[2]  }
                                                                                          else  RunResultsN[1]:ProposedTDV[2]       + RunResultsN[2]:ProposedTDV[2]      + RunResultsN[3]:ProposedTDV[2]      + RunResultsN[4]:ProposedTDV[2]      + RunResultsN[5]:ProposedTDV[2]       endif  } ; - PVCredit[2]  }
	"Recalc TDV   - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:ProposedTDV[3]			= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsN[1]:ProposedTDV[3]       + RunResultsN[2]:ProposedTDV[3]      + RunResultsN[3]:ProposedTDV[3]      + RunResultsN[4]:ProposedTDV[3]      + RunResultsN[5]:ProposedTDV[3]      + RunResultsN[13]:ProposedTDV[3]      + RunResultsN[14]:ProposedTDV[3]        ; - PVCredit[2]  }
                                                                                          else  RunResultsN[1]:ProposedTDV[3]       + RunResultsN[2]:ProposedTDV[3]      + RunResultsN[3]:ProposedTDV[3]      + RunResultsN[4]:ProposedTDV[3]      + RunResultsN[5]:ProposedTDV[3]       endif  } ; - PVCredit[2]  }
	"Recalc total - Elec   - N-Total"		Proj:RunResultsN[10]:PropElecEnergy[2]		= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsN[11]:PropElecEnergy[2]   + RunResultsN[6]:PropElecEnergy[2]   + RunResultsN[7]:PropElecEnergy[2]   + RunResultsN[8]:PropElecEnergy[2]   + RunResultsN[9]:PropElecEnergy[2]   
                                                                                          else  RunResultsN[11]:PropElecEnergy[2]   + RunResultsN[6]:PropElecEnergy[2]   + RunResultsN[7]:PropElecEnergy[2]   + RunResultsN[8]:PropElecEnergy[2]   + RunResultsN[9]:PropElecEnergy[2]   + RunResultsN[13]:PropElecEnergy[2]   + RunResultsN[14]:PropElecEnergy[2]    endif  }
	"Recalc total - NatGas - N-Total"		Proj:RunResultsN[10]:PropNatGasEnergy[2]	= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsN[11]:PropNatGasEnergy[2] + RunResultsN[6]:PropNatGasEnergy[2] + RunResultsN[7]:PropNatGasEnergy[2] + RunResultsN[8]:PropNatGasEnergy[2] + RunResultsN[9]:PropNatGasEnergy[2] 
                                                                                          else  RunResultsN[11]:PropNatGasEnergy[2] + RunResultsN[6]:PropNatGasEnergy[2] + RunResultsN[7]:PropNatGasEnergy[2] + RunResultsN[8]:PropNatGasEnergy[2] + RunResultsN[9]:PropNatGasEnergy[2] + RunResultsN[13]:PropNatGasEnergy[2] + RunResultsN[14]:PropNatGasEnergy[2]  endif  }
	"Recalc total - Other  - N-Total"		Proj:RunResultsN[10]:PropOtherEnergy[2]	= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsN[11]:PropOtherEnergy[2]  + RunResultsN[6]:PropOtherEnergy[2]  + RunResultsN[7]:PropOtherEnergy[2]  + RunResultsN[8]:PropOtherEnergy[2]  + RunResultsN[9]:PropOtherEnergy[2]  
                                                                                          else  RunResultsN[11]:PropOtherEnergy[2]  + RunResultsN[6]:PropOtherEnergy[2]  + RunResultsN[7]:PropOtherEnergy[2]  + RunResultsN[8]:PropOtherEnergy[2]  + RunResultsN[9]:PropOtherEnergy[2]  + RunResultsN[13]:PropOtherEnergy[2]  + RunResultsN[14]:PropOtherEnergy[2]   endif  }
	"Recalc total - TOTAL  - N-Total"		Proj:RunResultsN[10]:PropTotalEnergy[2]	= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsN[11]:PropTotalEnergy[2]  + RunResultsN[6]:PropTotalEnergy[2]  + RunResultsN[7]:PropTotalEnergy[2]  + RunResultsN[8]:PropTotalEnergy[2]  + RunResultsN[9]:PropTotalEnergy[2]  
                                                                                          else  RunResultsN[11]:PropTotalEnergy[2]  + RunResultsN[6]:PropTotalEnergy[2]  + RunResultsN[7]:PropTotalEnergy[2]  + RunResultsN[8]:PropTotalEnergy[2]  + RunResultsN[9]:PropTotalEnergy[2]  + RunResultsN[13]:PropTotalEnergy[2]  + RunResultsN[14]:PropTotalEnergy[2]   endif  }
	"Recalc TDV   - Elec   - N-Total"		Proj:RunResultsN[10]:PropElecTDV[2]			= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsN[11]:PropElecTDV[2]      + RunResultsN[6]:PropElecTDV[2]      + RunResultsN[7]:PropElecTDV[2]      + RunResultsN[8]:PropElecTDV[2]      + RunResultsN[9]:PropElecTDV[2]      
                                                                                          else  RunResultsN[11]:PropElecTDV[2]      + RunResultsN[6]:PropElecTDV[2]      + RunResultsN[7]:PropElecTDV[2]      + RunResultsN[8]:PropElecTDV[2]      + RunResultsN[9]:PropElecTDV[2]      + RunResultsN[13]:PropElecTDV[2]      + RunResultsN[14]:PropElecTDV[2]       endif  }
	"Recalc TDV   - TOTAL  - N-Total"		Proj:RunResultsN[10]:ProposedTDV[2]			= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsN[11]:ProposedTDV[2]      + RunResultsN[6]:ProposedTDV[2]      + RunResultsN[7]:ProposedTDV[2]      + RunResultsN[8]:ProposedTDV[2]      + RunResultsN[9]:ProposedTDV[2]      
                                                                                          else  RunResultsN[11]:ProposedTDV[2]      + RunResultsN[6]:ProposedTDV[2]      + RunResultsN[7]:ProposedTDV[2]      + RunResultsN[8]:ProposedTDV[2]      + RunResultsN[9]:ProposedTDV[2]      + RunResultsN[13]:ProposedTDV[2]      + RunResultsN[14]:ProposedTDV[2]       endif  }
	"Recalc TDV   - TOTAL  - N-Total"		Proj:RunResultsN[10]:ProposedTDV[3]			= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsN[11]:ProposedTDV[3]      + RunResultsN[6]:ProposedTDV[3]      + RunResultsN[7]:ProposedTDV[3]      + RunResultsN[8]:ProposedTDV[3]      + RunResultsN[9]:ProposedTDV[3]      
                                                                                          else  RunResultsN[11]:ProposedTDV[3]      + RunResultsN[6]:ProposedTDV[3]      + RunResultsN[7]:ProposedTDV[3]      + RunResultsN[8]:ProposedTDV[3]      + RunResultsN[9]:ProposedTDV[3]      + RunResultsN[13]:ProposedTDV[3]      + RunResultsN[14]:ProposedTDV[3]       endif  }

	"Recalc total - Elec   - E-Comp Ttl"	Proj:RunResultsE[11]:PropElecEnergy[2]		= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsE[1]:PropElecEnergy[2]    + RunResultsE[2]:PropElecEnergy[2]   + RunResultsE[3]:PropElecEnergy[2]   + RunResultsE[4]:PropElecEnergy[2]   + RunResultsE[5]:PropElecEnergy[2]   + RunResultsE[13]:PropElecEnergy[2]   + RunResultsE[14]:PropElecEnergy[2]    
                                                                                          else  RunResultsE[1]:PropElecEnergy[2]    + RunResultsE[2]:PropElecEnergy[2]   + RunResultsE[3]:PropElecEnergy[2]   + RunResultsE[4]:PropElecEnergy[2]   + RunResultsE[5]:PropElecEnergy[2]    endif  }
	"Recalc total - NatGas - E-Comp Ttl"	Proj:RunResultsE[11]:PropNatGasEnergy[2]	= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsE[1]:PropNatGasEnergy[2]  + RunResultsE[2]:PropNatGasEnergy[2] + RunResultsE[3]:PropNatGasEnergy[2] + RunResultsE[4]:PropNatGasEnergy[2] + RunResultsE[5]:PropNatGasEnergy[2] + RunResultsE[13]:PropNatGasEnergy[2] + RunResultsE[14]:PropNatGasEnergy[2]  
                                                                                          else  RunResultsE[1]:PropNatGasEnergy[2]  + RunResultsE[2]:PropNatGasEnergy[2] + RunResultsE[3]:PropNatGasEnergy[2] + RunResultsE[4]:PropNatGasEnergy[2] + RunResultsE[5]:PropNatGasEnergy[2]  endif  }
	"Recalc total - Other  - E-Comp Ttl"	Proj:RunResultsE[11]:PropOtherEnergy[2]	= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsE[1]:PropOtherEnergy[2]   + RunResultsE[2]:PropOtherEnergy[2]  + RunResultsE[3]:PropOtherEnergy[2]  + RunResultsE[4]:PropOtherEnergy[2]  + RunResultsE[5]:PropOtherEnergy[2]  + RunResultsE[13]:PropOtherEnergy[2]  + RunResultsE[14]:PropOtherEnergy[2]   
                                                                                          else  RunResultsE[1]:PropOtherEnergy[2]   + RunResultsE[2]:PropOtherEnergy[2]  + RunResultsE[3]:PropOtherEnergy[2]  + RunResultsE[4]:PropOtherEnergy[2]  + RunResultsE[5]:PropOtherEnergy[2]   endif  }
	"Recalc total - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:PropTotalEnergy[2]	= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsE[1]:PropTotalEnergy[2]   + RunResultsE[2]:PropTotalEnergy[2]  + RunResultsE[3]:PropTotalEnergy[2]  + RunResultsE[4]:PropTotalEnergy[2]  + RunResultsE[5]:PropTotalEnergy[2]  + RunResultsE[13]:PropTotalEnergy[2]  + RunResultsE[14]:PropTotalEnergy[2]   
                                                                                          else  RunResultsE[1]:PropTotalEnergy[2]   + RunResultsE[2]:PropTotalEnergy[2]  + RunResultsE[3]:PropTotalEnergy[2]  + RunResultsE[4]:PropTotalEnergy[2]  + RunResultsE[5]:PropTotalEnergy[2]   endif  }
	"Recalc TDV   - Elec   - E-Comp Ttl"	Proj:RunResultsE[11]:PropElecTDV[2]			= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsE[1]:PropElecTDV[2]       + RunResultsE[2]:PropElecTDV[2]      + RunResultsE[3]:PropElecTDV[2]      + RunResultsE[4]:PropElecTDV[2]      + RunResultsE[5]:PropElecTDV[2]      + RunResultsE[13]:PropElecTDV[2]      + RunResultsE[14]:PropElecTDV[2]        ; - PVCredit[2]  }
                                                                                          else  RunResultsE[1]:PropElecTDV[2]       + RunResultsE[2]:PropElecTDV[2]      + RunResultsE[3]:PropElecTDV[2]      + RunResultsE[4]:PropElecTDV[2]      + RunResultsE[5]:PropElecTDV[2]       endif  } ; - PVCredit[2]  }
	"Recalc TDV   - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:ProposedTDV[2]			= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsE[1]:ProposedTDV[2]       + RunResultsE[2]:ProposedTDV[2]      + RunResultsE[3]:ProposedTDV[2]      + RunResultsE[4]:ProposedTDV[2]      + RunResultsE[5]:ProposedTDV[2]      + RunResultsE[13]:ProposedTDV[2]      + RunResultsE[14]:ProposedTDV[2]        ; - PVCredit[2]  }
                                                                                          else  RunResultsE[1]:ProposedTDV[2]       + RunResultsE[2]:ProposedTDV[2]      + RunResultsE[3]:ProposedTDV[2]      + RunResultsE[4]:ProposedTDV[2]      + RunResultsE[5]:ProposedTDV[2]       endif  } ; - PVCredit[2]  }
	"Recalc TDV   - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:ProposedTDV[3]			= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsE[1]:ProposedTDV[3]       + RunResultsE[2]:ProposedTDV[3]      + RunResultsE[3]:ProposedTDV[3]      + RunResultsE[4]:ProposedTDV[3]      + RunResultsE[5]:ProposedTDV[3]      + RunResultsE[13]:ProposedTDV[3]      + RunResultsE[14]:ProposedTDV[3]        ; - PVCredit[2]  }
                                                                                          else  RunResultsE[1]:ProposedTDV[3]       + RunResultsE[2]:ProposedTDV[3]      + RunResultsE[3]:ProposedTDV[3]      + RunResultsE[4]:ProposedTDV[3]      + RunResultsE[5]:ProposedTDV[3]       endif  } ; - PVCredit[2]  }
	"Recalc total - Elec   - E-Total"		Proj:RunResultsE[10]:PropElecEnergy[2]		= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsE[11]:PropElecEnergy[2]   + RunResultsE[6]:PropElecEnergy[2]   + RunResultsE[7]:PropElecEnergy[2]   + RunResultsE[8]:PropElecEnergy[2]   + RunResultsE[9]:PropElecEnergy[2]   
                                                                                          else  RunResultsE[11]:PropElecEnergy[2]   + RunResultsE[6]:PropElecEnergy[2]   + RunResultsE[7]:PropElecEnergy[2]   + RunResultsE[8]:PropElecEnergy[2]   + RunResultsE[9]:PropElecEnergy[2]   + RunResultsE[13]:PropElecEnergy[2]   + RunResultsE[14]:PropElecEnergy[2]    endif  }
	"Recalc total - NatGas - E-Total"		Proj:RunResultsE[10]:PropNatGasEnergy[2]	= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsE[11]:PropNatGasEnergy[2] + RunResultsE[6]:PropNatGasEnergy[2] + RunResultsE[7]:PropNatGasEnergy[2] + RunResultsE[8]:PropNatGasEnergy[2] + RunResultsE[9]:PropNatGasEnergy[2] 
                                                                                          else  RunResultsE[11]:PropNatGasEnergy[2] + RunResultsE[6]:PropNatGasEnergy[2] + RunResultsE[7]:PropNatGasEnergy[2] + RunResultsE[8]:PropNatGasEnergy[2] + RunResultsE[9]:PropNatGasEnergy[2] + RunResultsE[13]:PropNatGasEnergy[2] + RunResultsE[14]:PropNatGasEnergy[2]  endif  }
	"Recalc total - Other  - E-Total"		Proj:RunResultsE[10]:PropOtherEnergy[2]	= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsE[11]:PropOtherEnergy[2]  + RunResultsE[6]:PropOtherEnergy[2]  + RunResultsE[7]:PropOtherEnergy[2]  + RunResultsE[8]:PropOtherEnergy[2]  + RunResultsE[9]:PropOtherEnergy[2]  
                                                                                          else  RunResultsE[11]:PropOtherEnergy[2]  + RunResultsE[6]:PropOtherEnergy[2]  + RunResultsE[7]:PropOtherEnergy[2]  + RunResultsE[8]:PropOtherEnergy[2]  + RunResultsE[9]:PropOtherEnergy[2]  + RunResultsE[13]:PropOtherEnergy[2]  + RunResultsE[14]:PropOtherEnergy[2]   endif  }
	"Recalc total - TOTAL  - E-Total"		Proj:RunResultsE[10]:PropTotalEnergy[2]	= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsE[11]:PropTotalEnergy[2]  + RunResultsE[6]:PropTotalEnergy[2]  + RunResultsE[7]:PropTotalEnergy[2]  + RunResultsE[8]:PropTotalEnergy[2]  + RunResultsE[9]:PropTotalEnergy[2]  
                                                                                          else  RunResultsE[11]:PropTotalEnergy[2]  + RunResultsE[6]:PropTotalEnergy[2]  + RunResultsE[7]:PropTotalEnergy[2]  + RunResultsE[8]:PropTotalEnergy[2]  + RunResultsE[9]:PropTotalEnergy[2]  + RunResultsE[13]:PropTotalEnergy[2]  + RunResultsE[14]:PropTotalEnergy[2]   endif  }
	"Recalc TDV   - Elec   - E-Total"		Proj:RunResultsE[10]:PropElecTDV[2]			= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsE[11]:PropElecTDV[2]      + RunResultsE[6]:PropElecTDV[2]      + RunResultsE[7]:PropElecTDV[2]      + RunResultsE[8]:PropElecTDV[2]      + RunResultsE[9]:PropElecTDV[2]      
                                                                                          else  RunResultsE[11]:PropElecTDV[2]      + RunResultsE[6]:PropElecTDV[2]      + RunResultsE[7]:PropElecTDV[2]      + RunResultsE[8]:PropElecTDV[2]      + RunResultsE[9]:PropElecTDV[2]      + RunResultsE[13]:PropElecTDV[2]      + RunResultsE[14]:PropElecTDV[2]       endif  }
	"Recalc TDV   - TOTAL  - E-Total"		Proj:RunResultsE[10]:ProposedTDV[2]			= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsE[11]:ProposedTDV[2]      + RunResultsE[6]:ProposedTDV[2]      + RunResultsE[7]:ProposedTDV[2]      + RunResultsE[8]:ProposedTDV[2]      + RunResultsE[9]:ProposedTDV[2]      
                                                                                          else  RunResultsE[11]:ProposedTDV[2]      + RunResultsE[6]:ProposedTDV[2]      + RunResultsE[7]:ProposedTDV[2]      + RunResultsE[8]:ProposedTDV[2]      + RunResultsE[9]:ProposedTDV[2]      + RunResultsE[13]:ProposedTDV[2]      + RunResultsE[14]:ProposedTDV[2]       endif  }
	"Recalc TDV   - TOTAL  - E-Total"		Proj:RunResultsE[10]:ProposedTDV[3]			= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsE[11]:ProposedTDV[3]      + RunResultsE[6]:ProposedTDV[3]      + RunResultsE[7]:ProposedTDV[3]      + RunResultsE[8]:ProposedTDV[3]      + RunResultsE[9]:ProposedTDV[3]      
                                                                                          else  RunResultsE[11]:ProposedTDV[3]      + RunResultsE[6]:ProposedTDV[3]      + RunResultsE[7]:ProposedTDV[3]      + RunResultsE[8]:ProposedTDV[3]      + RunResultsE[9]:ProposedTDV[3]      + RunResultsE[13]:ProposedTDV[3]      + RunResultsE[14]:ProposedTDV[3]       endif  }
                                                                                                                                                                                                                                                          
	"Recalc total - Elec   - S-Comp Ttl"	Proj:RunResultsS[11]:PropElecEnergy[2]		= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsS[1]:PropElecEnergy[2]    + RunResultsS[2]:PropElecEnergy[2]   + RunResultsS[3]:PropElecEnergy[2]   + RunResultsS[4]:PropElecEnergy[2]   + RunResultsS[5]:PropElecEnergy[2]   + RunResultsS[13]:PropElecEnergy[2]   + RunResultsS[14]:PropElecEnergy[2]    
                                                                                          else  RunResultsS[1]:PropElecEnergy[2]    + RunResultsS[2]:PropElecEnergy[2]   + RunResultsS[3]:PropElecEnergy[2]   + RunResultsS[4]:PropElecEnergy[2]   + RunResultsS[5]:PropElecEnergy[2]    endif  }
	"Recalc total - NatGas - S-Comp Ttl"	Proj:RunResultsS[11]:PropNatGasEnergy[2]	= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsS[1]:PropNatGasEnergy[2]  + RunResultsS[2]:PropNatGasEnergy[2] + RunResultsS[3]:PropNatGasEnergy[2] + RunResultsS[4]:PropNatGasEnergy[2] + RunResultsS[5]:PropNatGasEnergy[2] + RunResultsS[13]:PropNatGasEnergy[2] + RunResultsS[14]:PropNatGasEnergy[2]  
                                                                                          else  RunResultsS[1]:PropNatGasEnergy[2]  + RunResultsS[2]:PropNatGasEnergy[2] + RunResultsS[3]:PropNatGasEnergy[2] + RunResultsS[4]:PropNatGasEnergy[2] + RunResultsS[5]:PropNatGasEnergy[2]  endif  }
	"Recalc total - Other  - S-Comp Ttl"	Proj:RunResultsS[11]:PropOtherEnergy[2]	= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsS[1]:PropOtherEnergy[2]   + RunResultsS[2]:PropOtherEnergy[2]  + RunResultsS[3]:PropOtherEnergy[2]  + RunResultsS[4]:PropOtherEnergy[2]  + RunResultsS[5]:PropOtherEnergy[2]  + RunResultsS[13]:PropOtherEnergy[2]  + RunResultsS[14]:PropOtherEnergy[2]   
                                                                                          else  RunResultsS[1]:PropOtherEnergy[2]   + RunResultsS[2]:PropOtherEnergy[2]  + RunResultsS[3]:PropOtherEnergy[2]  + RunResultsS[4]:PropOtherEnergy[2]  + RunResultsS[5]:PropOtherEnergy[2]   endif  }
	"Recalc total - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:PropTotalEnergy[2]	= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsS[1]:PropTotalEnergy[2]   + RunResultsS[2]:PropTotalEnergy[2]  + RunResultsS[3]:PropTotalEnergy[2]  + RunResultsS[4]:PropTotalEnergy[2]  + RunResultsS[5]:PropTotalEnergy[2]  + RunResultsS[13]:PropTotalEnergy[2]  + RunResultsS[14]:PropTotalEnergy[2]   
                                                                                          else  RunResultsS[1]:PropTotalEnergy[2]   + RunResultsS[2]:PropTotalEnergy[2]  + RunResultsS[3]:PropTotalEnergy[2]  + RunResultsS[4]:PropTotalEnergy[2]  + RunResultsS[5]:PropTotalEnergy[2]   endif  }
	"Recalc TDV   - Elec   - S-Comp Ttl"	Proj:RunResultsS[11]:PropElecTDV[2]			= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsS[1]:PropElecTDV[2]       + RunResultsS[2]:PropElecTDV[2]      + RunResultsS[3]:PropElecTDV[2]      + RunResultsS[4]:PropElecTDV[2]      + RunResultsS[5]:PropElecTDV[2]      + RunResultsS[13]:PropElecTDV[2]      + RunResultsS[14]:PropElecTDV[2]        ; - PVCredit[2]  }
                                                                                          else  RunResultsS[1]:PropElecTDV[2]       + RunResultsS[2]:PropElecTDV[2]      + RunResultsS[3]:PropElecTDV[2]      + RunResultsS[4]:PropElecTDV[2]      + RunResultsS[5]:PropElecTDV[2]       endif  } ; - PVCredit[2]  }
	"Recalc TDV   - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:ProposedTDV[2]			= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsS[1]:ProposedTDV[2]       + RunResultsS[2]:ProposedTDV[2]      + RunResultsS[3]:ProposedTDV[2]      + RunResultsS[4]:ProposedTDV[2]      + RunResultsS[5]:ProposedTDV[2]      + RunResultsS[13]:ProposedTDV[2]      + RunResultsS[14]:ProposedTDV[2]        ; - PVCredit[2]  }
                                                                                          else  RunResultsS[1]:ProposedTDV[2]       + RunResultsS[2]:ProposedTDV[2]      + RunResultsS[3]:ProposedTDV[2]      + RunResultsS[4]:ProposedTDV[2]      + RunResultsS[5]:ProposedTDV[2]       endif  } ; - PVCredit[2]  }
	"Recalc TDV   - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:ProposedTDV[3]			= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsS[1]:ProposedTDV[3]       + RunResultsS[2]:ProposedTDV[3]      + RunResultsS[3]:ProposedTDV[3]      + RunResultsS[4]:ProposedTDV[3]      + RunResultsS[5]:ProposedTDV[3]      + RunResultsS[13]:ProposedTDV[3]      + RunResultsS[14]:ProposedTDV[3]        ; - PVCredit[2]  }
                                                                                          else  RunResultsS[1]:ProposedTDV[3]       + RunResultsS[2]:ProposedTDV[3]      + RunResultsS[3]:ProposedTDV[3]      + RunResultsS[4]:ProposedTDV[3]      + RunResultsS[5]:ProposedTDV[3]       endif  } ; - PVCredit[2]  }
	"Recalc total - Elec   - S-Total"		Proj:RunResultsS[10]:PropElecEnergy[2]		= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsS[11]:PropElecEnergy[2]   + RunResultsS[6]:PropElecEnergy[2]   + RunResultsS[7]:PropElecEnergy[2]   + RunResultsS[8]:PropElecEnergy[2]   + RunResultsS[9]:PropElecEnergy[2]    
                                                                                          else  RunResultsS[11]:PropElecEnergy[2]   + RunResultsS[6]:PropElecEnergy[2]   + RunResultsS[7]:PropElecEnergy[2]   + RunResultsS[8]:PropElecEnergy[2]   + RunResultsS[9]:PropElecEnergy[2]   + RunResultsS[13]:PropElecEnergy[2]   + RunResultsS[14]:PropElecEnergy[2]    endif  }
	"Recalc total - NatGas - S-Total"		Proj:RunResultsS[10]:PropNatGasEnergy[2]	= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsS[11]:PropNatGasEnergy[2] + RunResultsS[6]:PropNatGasEnergy[2] + RunResultsS[7]:PropNatGasEnergy[2] + RunResultsS[8]:PropNatGasEnergy[2] + RunResultsS[9]:PropNatGasEnergy[2] 
                                                                                          else  RunResultsS[11]:PropNatGasEnergy[2] + RunResultsS[6]:PropNatGasEnergy[2] + RunResultsS[7]:PropNatGasEnergy[2] + RunResultsS[8]:PropNatGasEnergy[2] + RunResultsS[9]:PropNatGasEnergy[2] + RunResultsS[13]:PropNatGasEnergy[2] + RunResultsS[14]:PropNatGasEnergy[2]  endif  }
	"Recalc total - Other  - S-Total"		Proj:RunResultsS[10]:PropOtherEnergy[2]	= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsS[11]:PropOtherEnergy[2]  + RunResultsS[6]:PropOtherEnergy[2]  + RunResultsS[7]:PropOtherEnergy[2]  + RunResultsS[8]:PropOtherEnergy[2]  + RunResultsS[9]:PropOtherEnergy[2]  
                                                                                          else  RunResultsS[11]:PropOtherEnergy[2]  + RunResultsS[6]:PropOtherEnergy[2]  + RunResultsS[7]:PropOtherEnergy[2]  + RunResultsS[8]:PropOtherEnergy[2]  + RunResultsS[9]:PropOtherEnergy[2]  + RunResultsS[13]:PropOtherEnergy[2]  + RunResultsS[14]:PropOtherEnergy[2]   endif  }
	"Recalc total - TOTAL  - S-Total"		Proj:RunResultsS[10]:PropTotalEnergy[2]	= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsS[11]:PropTotalEnergy[2]  + RunResultsS[6]:PropTotalEnergy[2]  + RunResultsS[7]:PropTotalEnergy[2]  + RunResultsS[8]:PropTotalEnergy[2]  + RunResultsS[9]:PropTotalEnergy[2]  
                                                                                          else  RunResultsS[11]:PropTotalEnergy[2]  + RunResultsS[6]:PropTotalEnergy[2]  + RunResultsS[7]:PropTotalEnergy[2]  + RunResultsS[8]:PropTotalEnergy[2]  + RunResultsS[9]:PropTotalEnergy[2]  + RunResultsS[13]:PropTotalEnergy[2]  + RunResultsS[14]:PropTotalEnergy[2]   endif  }
	"Recalc TDV   - Elec   - S-Total"		Proj:RunResultsS[10]:PropElecTDV[2]			= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsS[11]:PropElecTDV[2]      + RunResultsS[6]:PropElecTDV[2]      + RunResultsS[7]:PropElecTDV[2]      + RunResultsS[8]:PropElecTDV[2]      + RunResultsS[9]:PropElecTDV[2]      
                                                                                          else  RunResultsS[11]:PropElecTDV[2]      + RunResultsS[6]:PropElecTDV[2]      + RunResultsS[7]:PropElecTDV[2]      + RunResultsS[8]:PropElecTDV[2]      + RunResultsS[9]:PropElecTDV[2]      + RunResultsS[13]:PropElecTDV[2]      + RunResultsS[14]:PropElecTDV[2]       endif  }
	"Recalc TDV   - TOTAL  - S-Total"		Proj:RunResultsS[10]:ProposedTDV[2]			= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsS[11]:ProposedTDV[2]      + RunResultsS[6]:ProposedTDV[2]      + RunResultsS[7]:ProposedTDV[2]      + RunResultsS[8]:ProposedTDV[2]      + RunResultsS[9]:ProposedTDV[2]      
                                                                                          else  RunResultsS[11]:ProposedTDV[2]      + RunResultsS[6]:ProposedTDV[2]      + RunResultsS[7]:ProposedTDV[2]      + RunResultsS[8]:ProposedTDV[2]      + RunResultsS[9]:ProposedTDV[2]      + RunResultsS[13]:ProposedTDV[2]      + RunResultsS[14]:ProposedTDV[2]       endif  }
	"Recalc TDV   - TOTAL  - S-Total"		Proj:RunResultsS[10]:ProposedTDV[3]			= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsS[11]:ProposedTDV[3]      + RunResultsS[6]:ProposedTDV[3]      + RunResultsS[7]:ProposedTDV[3]      + RunResultsS[8]:ProposedTDV[3]      + RunResultsS[9]:ProposedTDV[3]      
                                                                                          else  RunResultsS[11]:ProposedTDV[3]      + RunResultsS[6]:ProposedTDV[3]      + RunResultsS[7]:ProposedTDV[3]      + RunResultsS[8]:ProposedTDV[3]      + RunResultsS[9]:ProposedTDV[3]      + RunResultsS[13]:ProposedTDV[3]      + RunResultsS[14]:ProposedTDV[3]       endif  }
                                                                                                                                                                                                                                                          
	"Recalc total - Elec   - W-Comp Ttl"	Proj:RunResultsW[11]:PropElecEnergy[2]		= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsW[1]:PropElecEnergy[2]    + RunResultsW[2]:PropElecEnergy[2]   + RunResultsW[3]:PropElecEnergy[2]   + RunResultsW[4]:PropElecEnergy[2]   + RunResultsW[5]:PropElecEnergy[2]   + RunResultsW[13]:PropElecEnergy[2]   + RunResultsW[14]:PropElecEnergy[2]    
                                                                                          else  RunResultsW[1]:PropElecEnergy[2]    + RunResultsW[2]:PropElecEnergy[2]   + RunResultsW[3]:PropElecEnergy[2]   + RunResultsW[4]:PropElecEnergy[2]   + RunResultsW[5]:PropElecEnergy[2]    endif  }
	"Recalc total - NatGas - W-Comp Ttl"	Proj:RunResultsW[11]:PropNatGasEnergy[2]	= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsW[1]:PropNatGasEnergy[2]  + RunResultsW[2]:PropNatGasEnergy[2] + RunResultsW[3]:PropNatGasEnergy[2] + RunResultsW[4]:PropNatGasEnergy[2] + RunResultsW[5]:PropNatGasEnergy[2] + RunResultsW[13]:PropNatGasEnergy[2] + RunResultsW[14]:PropNatGasEnergy[2]  
                                                                                          else  RunResultsW[1]:PropNatGasEnergy[2]  + RunResultsW[2]:PropNatGasEnergy[2] + RunResultsW[3]:PropNatGasEnergy[2] + RunResultsW[4]:PropNatGasEnergy[2] + RunResultsW[5]:PropNatGasEnergy[2]  endif  }
	"Recalc total - Other  - W-Comp Ttl"	Proj:RunResultsW[11]:PropOtherEnergy[2]	= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsW[1]:PropOtherEnergy[2]   + RunResultsW[2]:PropOtherEnergy[2]  + RunResultsW[3]:PropOtherEnergy[2]  + RunResultsW[4]:PropOtherEnergy[2]  + RunResultsW[5]:PropOtherEnergy[2]  + RunResultsW[13]:PropOtherEnergy[2]  + RunResultsW[14]:PropOtherEnergy[2]   
                                                                                          else  RunResultsW[1]:PropOtherEnergy[2]   + RunResultsW[2]:PropOtherEnergy[2]  + RunResultsW[3]:PropOtherEnergy[2]  + RunResultsW[4]:PropOtherEnergy[2]  + RunResultsW[5]:PropOtherEnergy[2]   endif  }
	"Recalc total - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:PropTotalEnergy[2]	= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsW[1]:PropTotalEnergy[2]   + RunResultsW[2]:PropTotalEnergy[2]  + RunResultsW[3]:PropTotalEnergy[2]  + RunResultsW[4]:PropTotalEnergy[2]  + RunResultsW[5]:PropTotalEnergy[2]  + RunResultsW[13]:PropTotalEnergy[2]  + RunResultsW[14]:PropTotalEnergy[2]   
                                                                                          else  RunResultsW[1]:PropTotalEnergy[2]   + RunResultsW[2]:PropTotalEnergy[2]  + RunResultsW[3]:PropTotalEnergy[2]  + RunResultsW[4]:PropTotalEnergy[2]  + RunResultsW[5]:PropTotalEnergy[2]   endif  }
	"Recalc TDV   - Elec   - W-Comp Ttl"	Proj:RunResultsW[11]:PropElecTDV[2]			= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsW[1]:PropElecTDV[2]       + RunResultsW[2]:PropElecTDV[2]      + RunResultsW[3]:PropElecTDV[2]      + RunResultsW[4]:PropElecTDV[2]      + RunResultsW[5]:PropElecTDV[2]      + RunResultsW[13]:PropElecTDV[2]      + RunResultsW[14]:PropElecTDV[2]        ; - PVCredit[2]  }
                                                                                          else  RunResultsW[1]:PropElecTDV[2]       + RunResultsW[2]:PropElecTDV[2]      + RunResultsW[3]:PropElecTDV[2]      + RunResultsW[4]:PropElecTDV[2]      + RunResultsW[5]:PropElecTDV[2]       endif  } ; - PVCredit[2]  }
	"Recalc TDV   - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:ProposedTDV[2]			= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsW[1]:ProposedTDV[2]       + RunResultsW[2]:ProposedTDV[2]      + RunResultsW[3]:ProposedTDV[2]      + RunResultsW[4]:ProposedTDV[2]      + RunResultsW[5]:ProposedTDV[2]      + RunResultsW[13]:ProposedTDV[2]      + RunResultsW[14]:ProposedTDV[2]        ; - PVCredit[2]  }
                                                                                          else  RunResultsW[1]:ProposedTDV[2]       + RunResultsW[2]:ProposedTDV[2]      + RunResultsW[3]:ProposedTDV[2]      + RunResultsW[4]:ProposedTDV[2]      + RunResultsW[5]:ProposedTDV[2]       endif  } ; - PVCredit[2]  }
	"Recalc TDV   - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:ProposedTDV[3]			= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsW[1]:ProposedTDV[3]       + RunResultsW[2]:ProposedTDV[3]      + RunResultsW[3]:ProposedTDV[3]      + RunResultsW[4]:ProposedTDV[3]      + RunResultsW[5]:ProposedTDV[3]      + RunResultsW[13]:ProposedTDV[3]      + RunResultsW[14]:ProposedTDV[3]        ; - PVCredit[2]  }
                                                                                          else  RunResultsW[1]:ProposedTDV[3]       + RunResultsW[2]:ProposedTDV[3]      + RunResultsW[3]:ProposedTDV[3]      + RunResultsW[4]:ProposedTDV[3]      + RunResultsW[5]:ProposedTDV[3]       endif  } ; - PVCredit[2]  }
	"Recalc total - Elec   - W-Total"		Proj:RunResultsW[10]:PropElecEnergy[2]		= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsW[11]:PropElecEnergy[2]   + RunResultsW[6]:PropElecEnergy[2]   + RunResultsW[7]:PropElecEnergy[2]   + RunResultsW[8]:PropElecEnergy[2]   + RunResultsW[9]:PropElecEnergy[2]   
                                                                                          else  RunResultsW[11]:PropElecEnergy[2]   + RunResultsW[6]:PropElecEnergy[2]   + RunResultsW[7]:PropElecEnergy[2]   + RunResultsW[8]:PropElecEnergy[2]   + RunResultsW[9]:PropElecEnergy[2]   + RunResultsW[13]:PropElecEnergy[2]   + RunResultsW[14]:PropElecEnergy[2]    endif  }
	"Recalc total - NatGas - W-Total"		Proj:RunResultsW[10]:PropNatGasEnergy[2]	= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsW[11]:PropNatGasEnergy[2] + RunResultsW[6]:PropNatGasEnergy[2] + RunResultsW[7]:PropNatGasEnergy[2] + RunResultsW[8]:PropNatGasEnergy[2] + RunResultsW[9]:PropNatGasEnergy[2] 
                                                                                          else  RunResultsW[11]:PropNatGasEnergy[2] + RunResultsW[6]:PropNatGasEnergy[2] + RunResultsW[7]:PropNatGasEnergy[2] + RunResultsW[8]:PropNatGasEnergy[2] + RunResultsW[9]:PropNatGasEnergy[2] + RunResultsW[13]:PropNatGasEnergy[2] + RunResultsW[14]:PropNatGasEnergy[2]  endif  }
	"Recalc total - Other  - W-Total"		Proj:RunResultsW[10]:PropOtherEnergy[2]	= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsW[11]:PropOtherEnergy[2]  + RunResultsW[6]:PropOtherEnergy[2]  + RunResultsW[7]:PropOtherEnergy[2]  + RunResultsW[8]:PropOtherEnergy[2]  + RunResultsW[9]:PropOtherEnergy[2]  
                                                                                          else  RunResultsW[11]:PropOtherEnergy[2]  + RunResultsW[6]:PropOtherEnergy[2]  + RunResultsW[7]:PropOtherEnergy[2]  + RunResultsW[8]:PropOtherEnergy[2]  + RunResultsW[9]:PropOtherEnergy[2]  + RunResultsW[13]:PropOtherEnergy[2]  + RunResultsW[14]:PropOtherEnergy[2]   endif  }
	"Recalc total - TOTAL  - W-Total"		Proj:RunResultsW[10]:PropTotalEnergy[2]	= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsW[11]:PropTotalEnergy[2]  + RunResultsW[6]:PropTotalEnergy[2]  + RunResultsW[7]:PropTotalEnergy[2]  + RunResultsW[8]:PropTotalEnergy[2]  + RunResultsW[9]:PropTotalEnergy[2]  
                                                                                          else  RunResultsW[11]:PropTotalEnergy[2]  + RunResultsW[6]:PropTotalEnergy[2]  + RunResultsW[7]:PropTotalEnergy[2]  + RunResultsW[8]:PropTotalEnergy[2]  + RunResultsW[9]:PropTotalEnergy[2]  + RunResultsW[13]:PropTotalEnergy[2]  + RunResultsW[14]:PropTotalEnergy[2]   endif  }
	"Recalc TDV   - Elec   - W-Total"		Proj:RunResultsW[10]:PropElecTDV[2]			= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsW[11]:PropElecTDV[2]      + RunResultsW[6]:PropElecTDV[2]      + RunResultsW[7]:PropElecTDV[2]      + RunResultsW[8]:PropElecTDV[2]      + RunResultsW[9]:PropElecTDV[2]      
                                                                                          else  RunResultsW[11]:PropElecTDV[2]      + RunResultsW[6]:PropElecTDV[2]      + RunResultsW[7]:PropElecTDV[2]      + RunResultsW[8]:PropElecTDV[2]      + RunResultsW[9]:PropElecTDV[2]      + RunResultsW[13]:PropElecTDV[2]      + RunResultsW[14]:PropElecTDV[2]       endif  }
	"Recalc TDV   - TOTAL  - W-Total"		Proj:RunResultsW[10]:ProposedTDV[2]			= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsW[11]:ProposedTDV[2]      + RunResultsW[6]:ProposedTDV[2]      + RunResultsW[7]:ProposedTDV[2]      + RunResultsW[8]:ProposedTDV[2]      + RunResultsW[9]:ProposedTDV[2]      
                                                                                          else  RunResultsW[11]:ProposedTDV[2]      + RunResultsW[6]:ProposedTDV[2]      + RunResultsW[7]:ProposedTDV[2]      + RunResultsW[8]:ProposedTDV[2]      + RunResultsW[9]:ProposedTDV[2]      + RunResultsW[13]:ProposedTDV[2]      + RunResultsW[14]:ProposedTDV[2]       endif  }
	"Recalc TDV   - TOTAL  - W-Total"		Proj:RunResultsW[10]:ProposedTDV[3]			= {	if (EnergyCodeYearNum < 2019)
                                                                                          then  RunResultsW[11]:ProposedTDV[3]      + RunResultsW[6]:ProposedTDV[3]      + RunResultsW[7]:ProposedTDV[3]      + RunResultsW[8]:ProposedTDV[3]      + RunResultsW[9]:ProposedTDV[3]      
                                                                                          else  RunResultsW[11]:ProposedTDV[3]      + RunResultsW[6]:ProposedTDV[3]      + RunResultsW[7]:ProposedTDV[3]      + RunResultsW[8]:ProposedTDV[3]      + RunResultsW[9]:ProposedTDV[3]      + RunResultsW[13]:ProposedTDV[3]      + RunResultsW[14]:ProposedTDV[3]       endif  }

  ; Compliance Total
  ; SAC 1/14/13 - added in PVCredit to Std (elec) TDV
; mjb-10/16/13	remove PVCredit from Std Design
	"Calculate TDV - Elec   - N-Comp Ttl"	Proj:RunResultsN[11]:DRtgElecTDV			= {	RunResultsN[1]:DRtgElecTDV     + RunResultsN[2]:DRtgElecTDV     + RunResultsN[3]:DRtgElecTDV     + RunResultsN[4]:DRtgElecTDV     + RunResultsN[5]:DRtgElecTDV     + RunResultsN[13]:DRtgElecTDV    + RunResultsN[14]:DRtgElecTDV     }
	"Calculate TDV - NatGas - N-Comp Ttl"	Proj:RunResultsN[11]:DRtgNatGasTDV		= {	RunResultsN[1]:DRtgNatGasTDV   + RunResultsN[2]:DRtgNatGasTDV   + RunResultsN[3]:DRtgNatGasTDV   + RunResultsN[4]:DRtgNatGasTDV   + RunResultsN[5]:DRtgNatGasTDV   + RunResultsN[13]:DRtgNatGasTDV  + RunResultsN[14]:DRtgNatGasTDV   }
	"Calculate TDV - Other  - N-Comp Ttl"	Proj:RunResultsN[11]:DRtgOtherTDV		= {	RunResultsN[1]:DRtgOtherTDV    + RunResultsN[2]:DRtgOtherTDV    + RunResultsN[3]:DRtgOtherTDV    + RunResultsN[4]:DRtgOtherTDV    + RunResultsN[5]:DRtgOtherTDV    + RunResultsN[13]:DRtgOtherTDV   + RunResultsN[14]:DRtgOtherTDV    }
	"Calculate TDV - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:DesignRatingTDV[1] = {	RunResultsN[1]:DesignRatingTDV[1] + RunResultsN[2]:DesignRatingTDV[1] + RunResultsN[3]:DesignRatingTDV[1] + RunResultsN[4]:DesignRatingTDV[1] + RunResultsN[5]:DesignRatingTDV[1] + RunResultsN[13]:DesignRatingTDV[1] + RunResultsN[14]:DesignRatingTDV[1] }
	"Calculate TDV - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:DesignRatingTDV[2] = {	RunResultsN[1]:DesignRatingTDV[2] + RunResultsN[2]:DesignRatingTDV[2] + RunResultsN[3]:DesignRatingTDV[2] + RunResultsN[4]:DesignRatingTDV[2] + RunResultsN[5]:DesignRatingTDV[2] + RunResultsN[13]:DesignRatingTDV[2] + RunResultsN[14]:DesignRatingTDV[2] }
	"Calculate Elec Demand  - N-Comp Ttl"	Proj:RunResultsN[11]:DRtgElecDemand		= {	RunResultsN[1]:DRtgElecDemand  + RunResultsN[2]:DRtgElecDemand  + RunResultsN[3]:DRtgElecDemand  + RunResultsN[4]:DRtgElecDemand  + RunResultsN[5]:DRtgElecDemand  + RunResultsN[13]:DRtgElecDemand + RunResultsN[14]:DRtgElecDemand  }

  ; Total
	"Calculate TDV - Elec   - N-Total"		Proj:RunResultsN[10]:DRtgElecTDV			= {	RunResultsN[11]:DRtgElecTDV     + RunResultsN[6]:DRtgElecTDV     + RunResultsN[7]:DRtgElecTDV     + RunResultsN[8]:DRtgElecTDV     + RunResultsN[9]:DRtgElecTDV      }
	"Calculate TDV - NatGas - N-Total"		Proj:RunResultsN[10]:DRtgNatGasTDV		= {	RunResultsN[11]:DRtgNatGasTDV   + RunResultsN[6]:DRtgNatGasTDV   + RunResultsN[7]:DRtgNatGasTDV   + RunResultsN[8]:DRtgNatGasTDV   + RunResultsN[9]:DRtgNatGasTDV    }
	"Calculate TDV - Other  - N-Total"		Proj:RunResultsN[10]:DRtgOtherTDV		= {	RunResultsN[11]:DRtgOtherTDV    + RunResultsN[6]:DRtgOtherTDV    + RunResultsN[7]:DRtgOtherTDV    + RunResultsN[8]:DRtgOtherTDV    + RunResultsN[9]:DRtgOtherTDV     }
	"Calculate TDV - TOTAL  - N-Total"		Proj:RunResultsN[10]:DesignRatingTDV[1] = {	RunResultsN[11]:DesignRatingTDV[1] + RunResultsN[6]:DesignRatingTDV[1] + RunResultsN[7]:DesignRatingTDV[1] + RunResultsN[8]:DesignRatingTDV[1] + RunResultsN[9]:DesignRatingTDV[1]  }
	"Calculate TDV - TOTAL  - N-Total"		Proj:RunResultsN[10]:DesignRatingTDV[2] = {	RunResultsN[11]:DesignRatingTDV[2] + RunResultsN[6]:DesignRatingTDV[2] + RunResultsN[7]:DesignRatingTDV[2] + RunResultsN[8]:DesignRatingTDV[2] + RunResultsN[9]:DesignRatingTDV[2]  }
	"Calculate Elec Demand  - N-Total"		Proj:RunResultsN[10]:DRtgElecDemand		= {	RunResultsN[11]:DRtgElecDemand  + RunResultsN[6]:DRtgElecDemand  + RunResultsN[7]:DRtgElecDemand  + RunResultsN[8]:DRtgElecDemand  + RunResultsN[9]:DRtgElecDemand   }

; -- COPY N results to E --
  ; Space Heating (& heating fan)
	"Calculate TDV - Elec   - E-SpcHt"		Proj:RunResultsE[1]:DRtgElecTDV			= {	RunResultsN[1]:DRtgElecTDV        }
	"Calculate TDV - NatGas - E-SpcHt"		Proj:RunResultsE[1]:DRtgNatGasTDV		= {	RunResultsN[1]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - E-SpcHt"		Proj:RunResultsE[1]:DRtgOtherTDV			= {	RunResultsN[1]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - E-SpcHt"		Proj:RunResultsE[1]:DesignRatingTDV[1]	= {	RunResultsN[1]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - E-SpcHt"		Proj:RunResultsE[1]:DesignRatingTDV[2]	= {	RunResultsN[1]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - E-SpcHt"		Proj:RunResultsE[1]:DRtgElecDemand		= {	RunResultsN[1]:DRtgElecDemand     }
  ; Space Cooling (& cooling fan)                                                                                     
	"Calculate TDV - Elec   - E-SpcCl"		Proj:RunResultsE[2]:DRtgElecTDV			= {	RunResultsN[2]:DRtgElecTDV        }
	"Calculate TDV - NatGas - E-SpcCl"		Proj:RunResultsE[2]:DRtgNatGasTDV		= {	RunResultsN[2]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - E-SpcCl"		Proj:RunResultsE[2]:DRtgOtherTDV			= {	RunResultsN[2]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - E-SpcCl"		Proj:RunResultsE[2]:DesignRatingTDV[1]	= {	RunResultsN[2]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - E-SpcCl"		Proj:RunResultsE[2]:DesignRatingTDV[2]	= {	RunResultsN[2]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - E-SpcCl"		Proj:RunResultsE[2]:DRtgElecDemand		= {	RunResultsN[2]:DRtgElecDemand     }
  ; IAQ Ventilation Fans                                                                                              
	"Calculate TDV - Elec   - E-IAQVent"	Proj:RunResultsE[3]:DRtgElecTDV			= {	RunResultsN[3]:DRtgElecTDV        }
	"Calculate TDV - NatGas - E-IAQVent"	Proj:RunResultsE[3]:DRtgNatGasTDV		= {	RunResultsN[3]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - E-IAQVent"	Proj:RunResultsE[3]:DRtgOtherTDV			= {	RunResultsN[3]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - E-IAQVent"	Proj:RunResultsE[3]:DesignRatingTDV[1]	= {	RunResultsN[3]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - E-IAQVent"	Proj:RunResultsE[3]:DesignRatingTDV[2]	= {	RunResultsN[3]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - E-IAQVent"	Proj:RunResultsE[3]:DRtgElecDemand		= {	RunResultsN[3]:DRtgElecDemand     }
  ; Other HVAC (aux & misc fans)                                                                                      
	"Calculate TDV - Elec   - E-OthrHVAC"	Proj:RunResultsE[4]:DRtgElecTDV			= {	RunResultsN[4]:DRtgElecTDV        }
	"Calculate TDV - NatGas - E-OthrHVAC"	Proj:RunResultsE[4]:DRtgNatGasTDV		= {	RunResultsN[4]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - E-OthrHVAC"	Proj:RunResultsE[4]:DRtgOtherTDV			= {	RunResultsN[4]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - E-OthrHVAC"	Proj:RunResultsE[4]:DesignRatingTDV[1]	= {	RunResultsN[4]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - E-OthrHVAC"	Proj:RunResultsE[4]:DesignRatingTDV[2]	= {	RunResultsN[4]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - E-OthrHVAC"	Proj:RunResultsE[4]:DRtgElecDemand		= {	RunResultsN[4]:DRtgElecDemand     }
  ; Water Heating                                                                                                     
	"Calculate TDV - Elec   - E-WtrHt"		Proj:RunResultsE[5]:DRtgElecTDV			= {	RunResultsN[5]:DRtgElecTDV        }
	"Calculate TDV - NatGas - E-WtrHt"		Proj:RunResultsE[5]:DRtgNatGasTDV		= {	RunResultsN[5]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - E-WtrHt"		Proj:RunResultsE[5]:DRtgOtherTDV			= {	RunResultsN[5]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - E-WtrHt"		Proj:RunResultsE[5]:DesignRatingTDV[1]	= {	RunResultsN[5]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - E-WtrHt"		Proj:RunResultsE[5]:DesignRatingTDV[2]	= {	RunResultsN[5]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - E-WtrHt"		Proj:RunResultsE[5]:DRtgElecDemand		= {	RunResultsN[5]:DRtgElecDemand     }
  ; Inside Lighting                                                                                                   
	"Calculate TDV - Elec   - E-InsLtg"		Proj:RunResultsE[6]:DRtgElecTDV			= {	RunResultsN[6]:DRtgElecTDV        }
	"Calculate TDV - NatGas - E-InsLtg"		Proj:RunResultsE[6]:DRtgNatGasTDV		= {	RunResultsN[6]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - E-InsLtg"		Proj:RunResultsE[6]:DRtgOtherTDV			= {	RunResultsN[6]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - E-InsLtg"		Proj:RunResultsE[6]:DesignRatingTDV[1]	= {	RunResultsN[6]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - E-InsLtg"		Proj:RunResultsE[6]:DesignRatingTDV[2]	= {	RunResultsN[6]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - E-InsLtg"		Proj:RunResultsE[6]:DRtgElecDemand		= {	RunResultsN[6]:DRtgElecDemand     }
  ; Appliances & Cooking                                                                                              
	"Calculate TDV - Elec   - E-AppCkg"		Proj:RunResultsE[7]:DRtgElecTDV			= {	RunResultsN[7]:DRtgElecTDV        }
	"Calculate TDV - NatGas - E-AppCkg"		Proj:RunResultsE[7]:DRtgNatGasTDV		= {	RunResultsN[7]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - E-AppCkg"		Proj:RunResultsE[7]:DRtgOtherTDV			= {	RunResultsN[7]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - E-AppCkg"		Proj:RunResultsE[7]:DesignRatingTDV[1]	= {	RunResultsN[7]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - E-AppCkg"		Proj:RunResultsE[7]:DesignRatingTDV[2]	= {	RunResultsN[7]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - E-AppCkg"		Proj:RunResultsE[7]:DRtgElecDemand		= {	RunResultsN[7]:DRtgElecDemand     }
  ; Plug Loads                                                                                                        
	"Calculate TDV - Elec   - E-Plugs"		Proj:RunResultsE[8]:DRtgElecTDV			= {	RunResultsN[8]:DRtgElecTDV        }
	"Calculate TDV - NatGas - E-Plugs"		Proj:RunResultsE[8]:DRtgNatGasTDV		= {	RunResultsN[8]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - E-Plugs"		Proj:RunResultsE[8]:DRtgOtherTDV			= {	RunResultsN[8]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - E-Plugs"		Proj:RunResultsE[8]:DesignRatingTDV[1]	= {	RunResultsN[8]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - E-Plugs"		Proj:RunResultsE[8]:DesignRatingTDV[2]	= {	RunResultsN[8]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - E-Plugs"		Proj:RunResultsE[8]:DRtgElecDemand		= {	RunResultsN[8]:DRtgElecDemand     }
  ; Exterior                                                                                                          
	"Calculate TDV - Elec   - E-Ext"			Proj:RunResultsE[9]:DRtgElecTDV			= {	RunResultsN[9]:DRtgElecTDV        }
	"Calculate TDV - NatGas - E-Ext"			Proj:RunResultsE[9]:DRtgNatGasTDV		= {	RunResultsN[9]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - E-Ext"			Proj:RunResultsE[9]:DRtgOtherTDV			= {	RunResultsN[9]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - E-Ext"			Proj:RunResultsE[9]:DesignRatingTDV[1]	= {	RunResultsN[9]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - E-Ext"			Proj:RunResultsE[9]:DesignRatingTDV[2]	= {	RunResultsN[9]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - E-Ext"			Proj:RunResultsE[9]:DRtgElecDemand		= {	RunResultsN[9]:DRtgElecDemand     }
  ; PV
	"Calculate TDV - Elec   - E-PV"			Proj:RunResultsE[13]:DRtgElecTDV			= {	RunResultsN[13]:DRtgElecTDV       }
	"Calculate TDV - NatGas - E-PV"			Proj:RunResultsE[13]:DRtgNatGasTDV		= {	RunResultsN[13]:DRtgNatGasTDV     }
	"Calculate TDV - Other  - E-PV"			Proj:RunResultsE[13]:DRtgOtherTDV		= {	RunResultsN[13]:DRtgOtherTDV      }
	"Calculate TDV - TOTAL  - E-PV"			Proj:RunResultsE[13]:DesignRatingTDV[1] = {	RunResultsN[13]:DesignRatingTDV[1]   }
	"Calculate TDV - TOTAL  - E-PV"			Proj:RunResultsE[13]:DesignRatingTDV[2] = {	RunResultsN[13]:DesignRatingTDV[2]   }
	"Calculate Elec Demand  - E-PV"			Proj:RunResultsE[13]:DRtgElecDemand		= {	RunResultsN[13]:DRtgElecDemand    }
  ; Battery
	"Calculate TDV - Elec   - E-Battery"	Proj:RunResultsE[14]:DRtgElecTDV			= {	RunResultsN[14]:DRtgElecTDV       }
	"Calculate TDV - NatGas - E-Battery"	Proj:RunResultsE[14]:DRtgNatGasTDV		= {	RunResultsN[14]:DRtgNatGasTDV     }
	"Calculate TDV - Other  - E-Battery"	Proj:RunResultsE[14]:DRtgOtherTDV		= {	RunResultsN[14]:DRtgOtherTDV      }
	"Calculate TDV - TOTAL  - E-Battery"	Proj:RunResultsE[14]:DesignRatingTDV[1] = {	RunResultsN[14]:DesignRatingTDV[1]   }
	"Calculate TDV - TOTAL  - E-Battery"	Proj:RunResultsE[14]:DesignRatingTDV[2] = {	RunResultsN[14]:DesignRatingTDV[2]   }
	"Calculate Elec Demand  - E-Battery"	Proj:RunResultsE[14]:DRtgElecDemand		= {	RunResultsN[14]:DRtgElecDemand    }
  ; Compliance Total                                                                                                  
	"Calculate TDV - Elec   - E-Comp Ttl"	Proj:RunResultsE[11]:DRtgElecTDV			= {	RunResultsN[11]:DRtgElecTDV       }
	"Calculate TDV - NatGas - E-Comp Ttl"	Proj:RunResultsE[11]:DRtgNatGasTDV		= {	RunResultsN[11]:DRtgNatGasTDV     }
	"Calculate TDV - Other  - E-Comp Ttl"	Proj:RunResultsE[11]:DRtgOtherTDV		= {	RunResultsN[11]:DRtgOtherTDV      }
	"Calculate TDV - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:DesignRatingTDV[1] = {	RunResultsN[11]:DesignRatingTDV[1]   }
	"Calculate TDV - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:DesignRatingTDV[2] = {	RunResultsN[11]:DesignRatingTDV[2]   }
	"Calculate Elec Demand  - E-Comp Ttl"	Proj:RunResultsE[11]:DRtgElecDemand		= {	RunResultsN[11]:DRtgElecDemand    }
  ; Total                                                                                                             
	"Calculate TDV - Elec   - E-Total"		Proj:RunResultsE[10]:DRtgElecTDV			= {	RunResultsN[10]:DRtgElecTDV       }
	"Calculate TDV - NatGas - E-Total"		Proj:RunResultsE[10]:DRtgNatGasTDV		= {	RunResultsN[10]:DRtgNatGasTDV     }
	"Calculate TDV - Other  - E-Total"		Proj:RunResultsE[10]:DRtgOtherTDV		= {	RunResultsN[10]:DRtgOtherTDV      }
	"Calculate TDV - TOTAL  - E-Total"		Proj:RunResultsE[10]:DesignRatingTDV[1] = {	RunResultsN[10]:DesignRatingTDV[1]   }
	"Calculate TDV - TOTAL  - E-Total"		Proj:RunResultsE[10]:DesignRatingTDV[2] = {	RunResultsN[10]:DesignRatingTDV[2]   }
	"Calculate Elec Demand  - E-Total"		Proj:RunResultsE[10]:DRtgElecDemand		= {	RunResultsN[10]:DRtgElecDemand    }

; -- COPY N results to S --
  ; Space Heating (& heating fan)
	"Calculate TDV - Elec   - S-SpcHt"		Proj:RunResultsS[1]:DRtgElecTDV			= {	RunResultsN[1]:DRtgElecTDV        }
	"Calculate TDV - NatGas - S-SpcHt"		Proj:RunResultsS[1]:DRtgNatGasTDV		= {	RunResultsN[1]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - S-SpcHt"		Proj:RunResultsS[1]:DRtgOtherTDV			= {	RunResultsN[1]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - S-SpcHt"		Proj:RunResultsS[1]:DesignRatingTDV[1]	= {	RunResultsN[1]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - S-SpcHt"		Proj:RunResultsS[1]:DesignRatingTDV[2]	= {	RunResultsN[1]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - S-SpcHt"		Proj:RunResultsS[1]:DRtgElecDemand		= {	RunResultsN[1]:DRtgElecDemand     }
  ; Space Cooling (& cooling fan)                                                                                     
	"Calculate TDV - Elec   - S-SpcCl"		Proj:RunResultsS[2]:DRtgElecTDV			= {	RunResultsN[2]:DRtgElecTDV        }
	"Calculate TDV - NatGas - S-SpcCl"		Proj:RunResultsS[2]:DRtgNatGasTDV		= {	RunResultsN[2]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - S-SpcCl"		Proj:RunResultsS[2]:DRtgOtherTDV			= {	RunResultsN[2]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - S-SpcCl"		Proj:RunResultsS[2]:DesignRatingTDV[1]	= {	RunResultsN[2]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - S-SpcCl"		Proj:RunResultsS[2]:DesignRatingTDV[2]	= {	RunResultsN[2]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - S-SpcCl"     Proj:RunResultsS[2]:DRtgElecDemand		= {	RunResultsN[2]:DRtgElecDemand     }
  ; IAQ Ventilation Fans                                                                                              
	"Calculate TDV - Elec   - S-IAQVent"	Proj:RunResultsS[3]:DRtgElecTDV			= {	RunResultsN[3]:DRtgElecTDV        }
	"Calculate TDV - NatGas - S-IAQVent"	Proj:RunResultsS[3]:DRtgNatGasTDV		= {	RunResultsN[3]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - S-IAQVent"	Proj:RunResultsS[3]:DRtgOtherTDV			= {	RunResultsN[3]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - S-IAQVent"	Proj:RunResultsS[3]:DesignRatingTDV[1]	= {	RunResultsN[3]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - S-IAQVent"	Proj:RunResultsS[3]:DesignRatingTDV[2]	= {	RunResultsN[3]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - S-IAQVent"   Proj:RunResultsS[3]:DRtgElecDemand		= {	RunResultsN[3]:DRtgElecDemand     }
  ; Other HVAC (aux & misc fans)                                                                                      
	"Calculate TDV - Elec   - S-OthrHVAC"	Proj:RunResultsS[4]:DRtgElecTDV			= {	RunResultsN[4]:DRtgElecTDV        }
	"Calculate TDV - NatGas - S-OthrHVAC"	Proj:RunResultsS[4]:DRtgNatGasTDV		= {	RunResultsN[4]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - S-OthrHVAC"	Proj:RunResultsS[4]:DRtgOtherTDV			= {	RunResultsN[4]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - S-OthrHVAC"	Proj:RunResultsS[4]:DesignRatingTDV[1]	= {	RunResultsN[4]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - S-OthrHVAC"	Proj:RunResultsS[4]:DesignRatingTDV[2]	= {	RunResultsN[4]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - S-OthrHVAC"  Proj:RunResultsS[4]:DRtgElecDemand		= {	RunResultsN[4]:DRtgElecDemand     }
  ; Water Heating                                                                                                     
	"Calculate TDV - Elec   - S-WtrHt"		Proj:RunResultsS[5]:DRtgElecTDV			= {	RunResultsN[5]:DRtgElecTDV        }
	"Calculate TDV - NatGas - S-WtrHt"		Proj:RunResultsS[5]:DRtgNatGasTDV		= {	RunResultsN[5]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - S-WtrHt"		Proj:RunResultsS[5]:DRtgOtherTDV			= {	RunResultsN[5]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - S-WtrHt"		Proj:RunResultsS[5]:DesignRatingTDV[1]	= {	RunResultsN[5]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - S-WtrHt"		Proj:RunResultsS[5]:DesignRatingTDV[2]	= {	RunResultsN[5]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - S-WtrHt"     Proj:RunResultsS[5]:DRtgElecDemand		= {	RunResultsN[5]:DRtgElecDemand     }
  ; Inside Lighting                                                                                                   
	"Calculate TDV - Elec   - S-InsLtg"		Proj:RunResultsS[6]:DRtgElecTDV			= {	RunResultsN[6]:DRtgElecTDV        }
	"Calculate TDV - NatGas - S-InsLtg"		Proj:RunResultsS[6]:DRtgNatGasTDV		= {	RunResultsN[6]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - S-InsLtg"		Proj:RunResultsS[6]:DRtgOtherTDV			= {	RunResultsN[6]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - S-InsLtg"		Proj:RunResultsS[6]:DesignRatingTDV[1]	= {	RunResultsN[6]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - S-InsLtg"		Proj:RunResultsS[6]:DesignRatingTDV[2]	= {	RunResultsN[6]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - S-InsLtg"    Proj:RunResultsS[6]:DRtgElecDemand		= {	RunResultsN[6]:DRtgElecDemand     }
  ; Appliances & Cooking                                                                                              
	"Calculate TDV - Elec   - S-AppCkg"		Proj:RunResultsS[7]:DRtgElecTDV			= {	RunResultsN[7]:DRtgElecTDV        }
	"Calculate TDV - NatGas - S-AppCkg"		Proj:RunResultsS[7]:DRtgNatGasTDV		= {	RunResultsN[7]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - S-AppCkg"		Proj:RunResultsS[7]:DRtgOtherTDV			= {	RunResultsN[7]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - S-AppCkg"		Proj:RunResultsS[7]:DesignRatingTDV[1]	= {	RunResultsN[7]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - S-AppCkg"		Proj:RunResultsS[7]:DesignRatingTDV[2]	= {	RunResultsN[7]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - S-AppCkg"    Proj:RunResultsS[7]:DRtgElecDemand		= {	RunResultsN[7]:DRtgElecDemand     }
  ; Plug Loads                                                                                                        
	"Calculate TDV - Elec   - S-Plugs"		Proj:RunResultsS[8]:DRtgElecTDV			= {	RunResultsN[8]:DRtgElecTDV        }
	"Calculate TDV - NatGas - S-Plugs"		Proj:RunResultsS[8]:DRtgNatGasTDV		= {	RunResultsN[8]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - S-Plugs"		Proj:RunResultsS[8]:DRtgOtherTDV			= {	RunResultsN[8]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - S-Plugs"		Proj:RunResultsS[8]:DesignRatingTDV[1]	= {	RunResultsN[8]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - S-Plugs"		Proj:RunResultsS[8]:DesignRatingTDV[2]	= {	RunResultsN[8]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - S-Plugs"     Proj:RunResultsS[8]:DRtgElecDemand		= {	RunResultsN[8]:DRtgElecDemand     }
  ; Exterior                                                                                                          
	"Calculate TDV - Elec   - S-Ext"			Proj:RunResultsS[9]:DRtgElecTDV			= {	RunResultsN[9]:DRtgElecTDV        }
	"Calculate TDV - NatGas - S-Ext"			Proj:RunResultsS[9]:DRtgNatGasTDV		= {	RunResultsN[9]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - S-Ext"			Proj:RunResultsS[9]:DRtgOtherTDV			= {	RunResultsN[9]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - S-Ext"			Proj:RunResultsS[9]:DesignRatingTDV[1]	= {	RunResultsN[9]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - S-Ext"			Proj:RunResultsS[9]:DesignRatingTDV[2]	= {	RunResultsN[9]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - S-Ext"       Proj:RunResultsS[9]:DRtgElecDemand		= {	RunResultsN[9]:DRtgElecDemand     }
  ; PV
	"Calculate TDV - Elec   - S-PV"			Proj:RunResultsS[13]:DRtgElecTDV			= {	RunResultsN[13]:DRtgElecTDV       }
	"Calculate TDV - NatGas - S-PV"			Proj:RunResultsS[13]:DRtgNatGasTDV		= {	RunResultsN[13]:DRtgNatGasTDV     }
	"Calculate TDV - Other  - S-PV"			Proj:RunResultsS[13]:DRtgOtherTDV		= {	RunResultsN[13]:DRtgOtherTDV      }
	"Calculate TDV - TOTAL  - S-PV"			Proj:RunResultsS[13]:DesignRatingTDV[1] = {	RunResultsN[13]:DesignRatingTDV[1]   }
	"Calculate TDV - TOTAL  - S-PV"			Proj:RunResultsS[13]:DesignRatingTDV[2] = {	RunResultsN[13]:DesignRatingTDV[2]   }
	"Calculate Elec Demand  - S-PV"			Proj:RunResultsS[13]:DRtgElecDemand		= {	RunResultsN[13]:DRtgElecDemand    }
  ; Battery
	"Calculate TDV - Elec   - S-Battery"	Proj:RunResultsS[14]:DRtgElecTDV			= {	RunResultsN[14]:DRtgElecTDV       }
	"Calculate TDV - NatGas - S-Battery"	Proj:RunResultsS[14]:DRtgNatGasTDV		= {	RunResultsN[14]:DRtgNatGasTDV     }
	"Calculate TDV - Other  - S-Battery"	Proj:RunResultsS[14]:DRtgOtherTDV		= {	RunResultsN[14]:DRtgOtherTDV      }
	"Calculate TDV - TOTAL  - S-Battery"	Proj:RunResultsS[14]:DesignRatingTDV[1] = {	RunResultsN[14]:DesignRatingTDV[1]   }
	"Calculate TDV - TOTAL  - S-Battery"	Proj:RunResultsS[14]:DesignRatingTDV[2] = {	RunResultsN[14]:DesignRatingTDV[2]   }
	"Calculate Elec Demand  - S-Battery"	Proj:RunResultsS[14]:DRtgElecDemand		= {	RunResultsN[14]:DRtgElecDemand    }
  ; Compliance Total                                                                                                  
	"Calculate TDV - Elec   - S-Comp Ttl"	Proj:RunResultsS[11]:DRtgElecTDV			= {	RunResultsN[11]:DRtgElecTDV       }
	"Calculate TDV - NatGas - S-Comp Ttl"	Proj:RunResultsS[11]:DRtgNatGasTDV		= {	RunResultsN[11]:DRtgNatGasTDV     }
	"Calculate TDV - Other  - S-Comp Ttl"	Proj:RunResultsS[11]:DRtgOtherTDV		= {	RunResultsN[11]:DRtgOtherTDV      }
	"Calculate TDV - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:DesignRatingTDV[1] = {	RunResultsN[11]:DesignRatingTDV[1]   }
	"Calculate TDV - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:DesignRatingTDV[2] = {	RunResultsN[11]:DesignRatingTDV[2]   }
	"Calculate Elec Demand  - S-Comp Ttl"  Proj:RunResultsS[11]:DRtgElecDemand		= {	RunResultsN[11]:DRtgElecDemand    }
  ; Total                                                                                                             
	"Calculate TDV - Elec   - S-Total"		Proj:RunResultsS[10]:DRtgElecTDV			= {	RunResultsN[10]:DRtgElecTDV       }
	"Calculate TDV - NatGas - S-Total"		Proj:RunResultsS[10]:DRtgNatGasTDV		= {	RunResultsN[10]:DRtgNatGasTDV     }
	"Calculate TDV - Other  - S-Total"		Proj:RunResultsS[10]:DRtgOtherTDV		= {	RunResultsN[10]:DRtgOtherTDV      }
	"Calculate TDV - TOTAL  - S-Total"		Proj:RunResultsS[10]:DesignRatingTDV[1] = {	RunResultsN[10]:DesignRatingTDV[1]   }
	"Calculate TDV - TOTAL  - S-Total"		Proj:RunResultsS[10]:DesignRatingTDV[2] = {	RunResultsN[10]:DesignRatingTDV[2]   }
	"Calculate Elec Demand  - S-Total"     Proj:RunResultsS[10]:DRtgElecDemand		= {	RunResultsN[10]:DRtgElecDemand    }

; -- COPY N results to W --
  ; Space Heating (& heating fan)
	"Calculate TDV - Elec   - W-SpcHt"		Proj:RunResultsW[1]:DRtgElecTDV			= {	RunResultsN[1]:DRtgElecTDV        }
	"Calculate TDV - NatGas - W-SpcHt"		Proj:RunResultsW[1]:DRtgNatGasTDV		= {	RunResultsN[1]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - W-SpcHt"		Proj:RunResultsW[1]:DRtgOtherTDV			= {	RunResultsN[1]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - W-SpcHt"		Proj:RunResultsW[1]:DesignRatingTDV[1]	= {	RunResultsN[1]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - W-SpcHt"		Proj:RunResultsW[1]:DesignRatingTDV[2]	= {	RunResultsN[1]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - W-SpcHt"		Proj:RunResultsW[1]:DRtgElecDemand		= {	RunResultsN[1]:DRtgElecDemand     }
  ; Space Cooling (& cooling fan)                                                                                     
	"Calculate TDV - Elec   - W-SpcCl"		Proj:RunResultsW[2]:DRtgElecTDV			= {	RunResultsN[2]:DRtgElecTDV        }
	"Calculate TDV - NatGas - W-SpcCl"		Proj:RunResultsW[2]:DRtgNatGasTDV		= {	RunResultsN[2]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - W-SpcCl"		Proj:RunResultsW[2]:DRtgOtherTDV			= {	RunResultsN[2]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - W-SpcCl"		Proj:RunResultsW[2]:DesignRatingTDV[1]	= {	RunResultsN[2]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - W-SpcCl"		Proj:RunResultsW[2]:DesignRatingTDV[2]	= {	RunResultsN[2]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - W-SpcCl"     Proj:RunResultsW[2]:DRtgElecDemand		= {	RunResultsN[2]:DRtgElecDemand     }
  ; IAQ Ventilation Fans                                                                                              
	"Calculate TDV - Elec   - W-IAQVent"	Proj:RunResultsW[3]:DRtgElecTDV			= {	RunResultsN[3]:DRtgElecTDV        }
	"Calculate TDV - NatGas - W-IAQVent"	Proj:RunResultsW[3]:DRtgNatGasTDV		= {	RunResultsN[3]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - W-IAQVent"	Proj:RunResultsW[3]:DRtgOtherTDV			= {	RunResultsN[3]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - W-IAQVent"	Proj:RunResultsW[3]:DesignRatingTDV[1]	= {	RunResultsN[3]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - W-IAQVent"	Proj:RunResultsW[3]:DesignRatingTDV[2]	= {	RunResultsN[3]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - W-IAQVent"   Proj:RunResultsW[3]:DRtgElecDemand		= {	RunResultsN[3]:DRtgElecDemand     }
  ; Other HVAC (aux & misc fans)                                                                                      
	"Calculate TDV - Elec   - W-OthrHVAC"	Proj:RunResultsW[4]:DRtgElecTDV			= {	RunResultsN[4]:DRtgElecTDV        }
	"Calculate TDV - NatGas - W-OthrHVAC"	Proj:RunResultsW[4]:DRtgNatGasTDV		= {	RunResultsN[4]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - W-OthrHVAC"	Proj:RunResultsW[4]:DRtgOtherTDV			= {	RunResultsN[4]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - W-OthrHVAC"	Proj:RunResultsW[4]:DesignRatingTDV[1]	= {	RunResultsN[4]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - W-OthrHVAC"	Proj:RunResultsW[4]:DesignRatingTDV[2]	= {	RunResultsN[4]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - W-OthrHVAC"  Proj:RunResultsW[4]:DRtgElecDemand		= {	RunResultsN[4]:DRtgElecDemand     }
  ; Water Heating                                                                                                     
	"Calculate TDV - Elec   - W-WtrHt"		Proj:RunResultsW[5]:DRtgElecTDV			= {	RunResultsN[5]:DRtgElecTDV        }
	"Calculate TDV - NatGas - W-WtrHt"		Proj:RunResultsW[5]:DRtgNatGasTDV		= {	RunResultsN[5]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - W-WtrHt"		Proj:RunResultsW[5]:DRtgOtherTDV			= {	RunResultsN[5]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - W-WtrHt"		Proj:RunResultsW[5]:DesignRatingTDV[1]	= {	RunResultsN[5]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - W-WtrHt"		Proj:RunResultsW[5]:DesignRatingTDV[2]	= {	RunResultsN[5]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - W-WtrHt"     Proj:RunResultsW[5]:DRtgElecDemand		= {	RunResultsN[5]:DRtgElecDemand     }
  ; Inside Lighting                                                                                                   
	"Calculate TDV - Elec   - W-InsLtg"		Proj:RunResultsW[6]:DRtgElecTDV			= {	RunResultsN[6]:DRtgElecTDV        }
	"Calculate TDV - NatGas - W-InsLtg"		Proj:RunResultsW[6]:DRtgNatGasTDV		= {	RunResultsN[6]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - W-InsLtg"		Proj:RunResultsW[6]:DRtgOtherTDV			= {	RunResultsN[6]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - W-InsLtg"		Proj:RunResultsW[6]:DesignRatingTDV[1]	= {	RunResultsN[6]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - W-InsLtg"		Proj:RunResultsW[6]:DesignRatingTDV[2]	= {	RunResultsN[6]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - W-InsLtg"    Proj:RunResultsW[6]:DRtgElecDemand		= {	RunResultsN[6]:DRtgElecDemand     }
  ; Appliances & Cooking                                                                                              
	"Calculate TDV - Elec   - W-AppCkg"		Proj:RunResultsW[7]:DRtgElecTDV			= {	RunResultsN[7]:DRtgElecTDV        }
	"Calculate TDV - NatGas - W-AppCkg"		Proj:RunResultsW[7]:DRtgNatGasTDV		= {	RunResultsN[7]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - W-AppCkg"		Proj:RunResultsW[7]:DRtgOtherTDV			= {	RunResultsN[7]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - W-AppCkg"		Proj:RunResultsW[7]:DesignRatingTDV[1]	= {	RunResultsN[7]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - W-AppCkg"		Proj:RunResultsW[7]:DesignRatingTDV[2]	= {	RunResultsN[7]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - W-AppCkg"    Proj:RunResultsW[7]:DRtgElecDemand		= {	RunResultsN[7]:DRtgElecDemand     }
  ; Plug Loads                                                                                                        
	"Calculate TDV - Elec   - W-Plugs"		Proj:RunResultsW[8]:DRtgElecTDV			= {	RunResultsN[8]:DRtgElecTDV        }
	"Calculate TDV - NatGas - W-Plugs"		Proj:RunResultsW[8]:DRtgNatGasTDV		= {	RunResultsN[8]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - W-Plugs"		Proj:RunResultsW[8]:DRtgOtherTDV			= {	RunResultsN[8]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - W-Plugs"		Proj:RunResultsW[8]:DesignRatingTDV[1]	= {	RunResultsN[8]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - W-Plugs"		Proj:RunResultsW[8]:DesignRatingTDV[2]	= {	RunResultsN[8]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - W-Plugs"     Proj:RunResultsW[8]:DRtgElecDemand		= {	RunResultsN[8]:DRtgElecDemand     }
  ; Exterior                                                                                                          
	"Calculate TDV - Elec   - W-Ext"			Proj:RunResultsW[9]:DRtgElecTDV			= {	RunResultsN[9]:DRtgElecTDV        }
	"Calculate TDV - NatGas - W-Ext"			Proj:RunResultsW[9]:DRtgNatGasTDV		= {	RunResultsN[9]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - W-Ext"			Proj:RunResultsW[9]:DRtgOtherTDV			= {	RunResultsN[9]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - W-Ext"			Proj:RunResultsW[9]:DesignRatingTDV[1]	= {	RunResultsN[9]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - W-Ext"			Proj:RunResultsW[9]:DesignRatingTDV[2]	= {	RunResultsN[9]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - W-Ext"       Proj:RunResultsW[9]:DRtgElecDemand		= {	RunResultsN[9]:DRtgElecDemand     }
  ; PV
	"Calculate TDV - Elec   - W-PV"			Proj:RunResultsW[13]:DRtgElecTDV			= {	RunResultsN[13]:DRtgElecTDV       }
	"Calculate TDV - NatGas - W-PV"			Proj:RunResultsW[13]:DRtgNatGasTDV		= {	RunResultsN[13]:DRtgNatGasTDV     }
	"Calculate TDV - Other  - W-PV"			Proj:RunResultsW[13]:DRtgOtherTDV		= {	RunResultsN[13]:DRtgOtherTDV      }
	"Calculate TDV - TOTAL  - W-PV"			Proj:RunResultsW[13]:DesignRatingTDV[1] = {	RunResultsN[13]:DesignRatingTDV[1]   }
	"Calculate TDV - TOTAL  - W-PV"			Proj:RunResultsW[13]:DesignRatingTDV[2] = {	RunResultsN[13]:DesignRatingTDV[2]   }
	"Calculate Elec Demand  - W-PV"			Proj:RunResultsW[13]:DRtgElecDemand		= {	RunResultsN[13]:DRtgElecDemand    }
  ; Battery
	"Calculate TDV - Elec   - W-Battery"	Proj:RunResultsW[14]:DRtgElecTDV			= {	RunResultsN[14]:DRtgElecTDV       }
	"Calculate TDV - NatGas - W-Battery"	Proj:RunResultsW[14]:DRtgNatGasTDV		= {	RunResultsN[14]:DRtgNatGasTDV     }
	"Calculate TDV - Other  - W-Battery"	Proj:RunResultsW[14]:DRtgOtherTDV		= {	RunResultsN[14]:DRtgOtherTDV      }
	"Calculate TDV - TOTAL  - W-Battery"	Proj:RunResultsW[14]:DesignRatingTDV[1] = {	RunResultsN[14]:DesignRatingTDV[1]   }
	"Calculate TDV - TOTAL  - W-Battery"	Proj:RunResultsW[14]:DesignRatingTDV[2] = {	RunResultsN[14]:DesignRatingTDV[2]   }
	"Calculate Elec Demand  - W-Battery"	Proj:RunResultsW[14]:DRtgElecDemand		= {	RunResultsN[14]:DRtgElecDemand    }
  ; Compliance Total                                                                                                  
	"Calculate TDV - Elec   - W-Comp Ttl"	Proj:RunResultsW[11]:DRtgElecTDV			= {	RunResultsN[11]:DRtgElecTDV       }
	"Calculate TDV - NatGas - W-Comp Ttl"	Proj:RunResultsW[11]:DRtgNatGasTDV		= {	RunResultsN[11]:DRtgNatGasTDV     }
	"Calculate TDV - Other  - W-Comp Ttl"	Proj:RunResultsW[11]:DRtgOtherTDV		= {	RunResultsN[11]:DRtgOtherTDV      }
	"Calculate TDV - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:DesignRatingTDV[1] = {	RunResultsN[11]:DesignRatingTDV[1]   }
	"Calculate TDV - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:DesignRatingTDV[2] = {	RunResultsN[11]:DesignRatingTDV[2]   }
	"Calculate Elec Demand  - W-Comp Ttl"	Proj:RunResultsW[11]:DRtgElecDemand		= {	RunResultsN[11]:DRtgElecDemand    }
  ; Total                                                                                                             
	"Calculate TDV - Elec   - W-Total"		Proj:RunResultsW[10]:DRtgElecTDV			= {	RunResultsN[10]:DRtgElecTDV       }
	"Calculate TDV - NatGas - W-Total"		Proj:RunResultsW[10]:DRtgNatGasTDV		= {	RunResultsN[10]:DRtgNatGasTDV     }
	"Calculate TDV - Other  - W-Total"		Proj:RunResultsW[10]:DRtgOtherTDV		= {	RunResultsN[10]:DRtgOtherTDV      }
	"Calculate TDV - TOTAL  - W-Total"		Proj:RunResultsW[10]:DesignRatingTDV[1] = {	RunResultsN[10]:DesignRatingTDV[1]   }
	"Calculate TDV - TOTAL  - W-Total"		Proj:RunResultsW[10]:DesignRatingTDV[2] = {	RunResultsN[10]:DesignRatingTDV[2]   }
	"Calculate Elec Demand  - W-Total"     Proj:RunResultsW[10]:DRtgElecDemand		= {	RunResultsN[10]:DRtgElecDemand    }


  ; Percent Improvement - NORTH
   ; SAC 10/2/17 - switched from reporting delta with DRtgTDV w/o fuel adjustment mult applied to DRtgTDV W/ fuel adjustment mult applied
	"Calc TDV Pct Improve - N-SpcHt"    	Proj:RunResultsN[1]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsN[1]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsN[1]:DesignRatingTDV[2]  ) - LocalRef( RunResultsN[1]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsN[1]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - N-SpcCl"    	Proj:RunResultsN[2]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsN[2]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsN[2]:DesignRatingTDV[2]  ) - LocalRef( RunResultsN[2]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsN[2]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - N-IAQVent"  	Proj:RunResultsN[3]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsN[3]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsN[3]:DesignRatingTDV[2]  ) - LocalRef( RunResultsN[3]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsN[3]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - N-OthrHVAC" 	Proj:RunResultsN[4]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsN[4]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsN[4]:DesignRatingTDV[2]  ) - LocalRef( RunResultsN[4]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsN[4]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - N-WtrHt"    	Proj:RunResultsN[5]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsN[5]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsN[5]:DesignRatingTDV[2]  ) - LocalRef( RunResultsN[5]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsN[5]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - N-InsLtg"   	Proj:RunResultsN[6]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsN[6]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsN[6]:DesignRatingTDV[2]  ) - LocalRef( RunResultsN[6]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsN[6]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - N-AppCkg"   	Proj:RunResultsN[7]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsN[7]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsN[7]:DesignRatingTDV[2]  ) - LocalRef( RunResultsN[7]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsN[7]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - N-Plugs"    	Proj:RunResultsN[8]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsN[8]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsN[8]:DesignRatingTDV[2]  ) - LocalRef( RunResultsN[8]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsN[8]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - N-Ext"      	Proj:RunResultsN[9]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsN[9]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsN[9]:DesignRatingTDV[2]  ) - LocalRef( RunResultsN[9]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsN[9]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - N-PV"     	 	Proj:RunResultsN[13]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsN[13]:DesignRatingTDV[2] ) == 0) then  0  else  (LocalRef( RunResultsN[13]:DesignRatingTDV[2] ) - LocalRef( RunResultsN[13]:ProposedTDV[2] )) * 100 / LocalRef( RunResultsN[13]:DesignRatingTDV[2] )  endif  }
	"Calc TDV Pct Improve - N-Battery"     Proj:RunResultsN[14]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsN[14]:DesignRatingTDV[2] ) == 0) then  0  else  (LocalRef( RunResultsN[14]:DesignRatingTDV[2] ) - LocalRef( RunResultsN[14]:ProposedTDV[2] )) * 100 / LocalRef( RunResultsN[14]:DesignRatingTDV[2] )  endif  }
	"Calc TDV Pct Improve - N-Total"    	Proj:RunResultsN[10]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsN[10]:DesignRatingTDV[2] ) == 0) then  0  else  (LocalRef( RunResultsN[10]:DesignRatingTDV[2] ) - LocalRef( RunResultsN[10]:ProposedTDV[2] )) * 100 / LocalRef( RunResultsN[10]:DesignRatingTDV[2] )  endif  }
	"Calc TDV Pct Improve - N-Comp Ttl"  	Proj:RunResultsN[11]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsN[11]:DesignRatingTDV[2] ) == 0) then  0  else  (LocalRef( RunResultsN[11]:DesignRatingTDV[2] ) - LocalRef( RunResultsN[11]:ProposedTDV[2] )) * 100 / LocalRef( RunResultsN[11]:DesignRatingTDV[2] )  endif  }
  ; Delta Demand
	"Calc Delta El Demand - N-SpcHt"    	Proj:RunResultsN[1]:DRtgDeltaDemand		= {	LocalRef( RunResultsN[1]:DRtgElecDemand  ) - LocalRef( RunResultsN[1]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - N-SpcCl"    	Proj:RunResultsN[2]:DRtgDeltaDemand		= {	LocalRef( RunResultsN[2]:DRtgElecDemand  ) - LocalRef( RunResultsN[2]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - N-IAQVent"  	Proj:RunResultsN[3]:DRtgDeltaDemand		= {	LocalRef( RunResultsN[3]:DRtgElecDemand  ) - LocalRef( RunResultsN[3]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - N-OthrHVAC" 	Proj:RunResultsN[4]:DRtgDeltaDemand		= {	LocalRef( RunResultsN[4]:DRtgElecDemand  ) - LocalRef( RunResultsN[4]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - N-WtrHt"    	Proj:RunResultsN[5]:DRtgDeltaDemand		= {	LocalRef( RunResultsN[5]:DRtgElecDemand  ) - LocalRef( RunResultsN[5]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - N-InsLtg"   	Proj:RunResultsN[6]:DRtgDeltaDemand		= {	LocalRef( RunResultsN[6]:DRtgElecDemand  ) - LocalRef( RunResultsN[6]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - N-AppCkg"   	Proj:RunResultsN[7]:DRtgDeltaDemand		= {	LocalRef( RunResultsN[7]:DRtgElecDemand  ) - LocalRef( RunResultsN[7]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - N-Plugs"    	Proj:RunResultsN[8]:DRtgDeltaDemand		= {	LocalRef( RunResultsN[8]:DRtgElecDemand  ) - LocalRef( RunResultsN[8]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - N-Ext"      	Proj:RunResultsN[9]:DRtgDeltaDemand		= {	LocalRef( RunResultsN[9]:DRtgElecDemand  ) - LocalRef( RunResultsN[9]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - N-PV"     	 	Proj:RunResultsN[13]:DRtgDeltaDemand	= {	LocalRef( RunResultsN[13]:DRtgElecDemand ) - LocalRef( RunResultsN[13]:PropElecDemand[2] )   }
	"Calc Delta El Demand - N-Battery" 	 	Proj:RunResultsN[14]:DRtgDeltaDemand	= {	LocalRef( RunResultsN[14]:DRtgElecDemand ) - LocalRef( RunResultsN[14]:PropElecDemand[2] )   }
	"Calc Delta El Demand - N-Total"    	Proj:RunResultsN[10]:DRtgDeltaDemand	= {	LocalRef( RunResultsN[10]:DRtgElecDemand ) - LocalRef( RunResultsN[10]:PropElecDemand[2] )   }
	"Calc Delta El Demand - N-Comp Ttl" 	Proj:RunResultsN[11]:DRtgDeltaDemand	= {	LocalRef( RunResultsN[11]:DRtgElecDemand ) - LocalRef( RunResultsN[11]:PropElecDemand[2] )   }

  ; Percent Improvement - EAST
   ; SAC 10/2/17 - switched from reporting delta with DRtgTDV w/o fuel adjustment mult applied to DRtgTDV W/ fuel adjustment mult applied
	"Calc TDV Pct Improve - E-SpcHt"    	Proj:RunResultsE[1]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsE[1]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsE[1]:DesignRatingTDV[2]  ) - LocalRef( RunResultsE[1]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsE[1]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - E-SpcCl"    	Proj:RunResultsE[2]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsE[2]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsE[2]:DesignRatingTDV[2]  ) - LocalRef( RunResultsE[2]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsE[2]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - E-IAQVent"  	Proj:RunResultsE[3]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsE[3]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsE[3]:DesignRatingTDV[2]  ) - LocalRef( RunResultsE[3]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsE[3]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - E-OthrHVAC" 	Proj:RunResultsE[4]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsE[4]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsE[4]:DesignRatingTDV[2]  ) - LocalRef( RunResultsE[4]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsE[4]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - E-WtrHt"    	Proj:RunResultsE[5]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsE[5]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsE[5]:DesignRatingTDV[2]  ) - LocalRef( RunResultsE[5]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsE[5]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - E-InsLtg"   	Proj:RunResultsE[6]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsE[6]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsE[6]:DesignRatingTDV[2]  ) - LocalRef( RunResultsE[6]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsE[6]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - E-AppCkg"   	Proj:RunResultsE[7]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsE[7]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsE[7]:DesignRatingTDV[2]  ) - LocalRef( RunResultsE[7]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsE[7]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - E-Plugs"    	Proj:RunResultsE[8]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsE[8]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsE[8]:DesignRatingTDV[2]  ) - LocalRef( RunResultsE[8]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsE[8]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - E-Ext"      	Proj:RunResultsE[9]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsE[9]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsE[9]:DesignRatingTDV[2]  ) - LocalRef( RunResultsE[9]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsE[9]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - E-PV"     	 	Proj:RunResultsE[13]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsE[13]:DesignRatingTDV[2] ) == 0) then  0  else  (LocalRef( RunResultsE[13]:DesignRatingTDV[2] ) - LocalRef( RunResultsE[13]:ProposedTDV[2] )) * 100 / LocalRef( RunResultsE[13]:DesignRatingTDV[2] )  endif  }
	"Calc TDV Pct Improve - E-Battery"     Proj:RunResultsE[14]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsE[14]:DesignRatingTDV[2] ) == 0) then  0  else  (LocalRef( RunResultsE[14]:DesignRatingTDV[2] ) - LocalRef( RunResultsE[14]:ProposedTDV[2] )) * 100 / LocalRef( RunResultsE[14]:DesignRatingTDV[2] )  endif  }
	"Calc TDV Pct Improve - E-Total"    	Proj:RunResultsE[10]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsE[10]:DesignRatingTDV[2] ) == 0) then  0  else  (LocalRef( RunResultsE[10]:DesignRatingTDV[2] ) - LocalRef( RunResultsE[10]:ProposedTDV[2] )) * 100 / LocalRef( RunResultsE[10]:DesignRatingTDV[2] )  endif  }
	"Calc TDV Pct Improve - E-Comp Ttl"  	Proj:RunResultsE[11]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsE[11]:DesignRatingTDV[2] ) == 0) then  0  else  (LocalRef( RunResultsE[11]:DesignRatingTDV[2] ) - LocalRef( RunResultsE[11]:ProposedTDV[2] )) * 100 / LocalRef( RunResultsE[11]:DesignRatingTDV[2] )  endif  }
  ; Delta Demand
	"Calc Delta El Demand - E-SpcHt"    	Proj:RunResultsE[1]:DRtgDeltaDemand		= {	LocalRef( RunResultsE[1]:DRtgElecDemand  ) - LocalRef( RunResultsE[1]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - E-SpcCl"    	Proj:RunResultsE[2]:DRtgDeltaDemand		= {	LocalRef( RunResultsE[2]:DRtgElecDemand  ) - LocalRef( RunResultsE[2]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - E-IAQVent"  	Proj:RunResultsE[3]:DRtgDeltaDemand		= {	LocalRef( RunResultsE[3]:DRtgElecDemand  ) - LocalRef( RunResultsE[3]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - E-OthrHVAC" 	Proj:RunResultsE[4]:DRtgDeltaDemand		= {	LocalRef( RunResultsE[4]:DRtgElecDemand  ) - LocalRef( RunResultsE[4]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - E-WtrHt"    	Proj:RunResultsE[5]:DRtgDeltaDemand		= {	LocalRef( RunResultsE[5]:DRtgElecDemand  ) - LocalRef( RunResultsE[5]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - E-InsLtg"   	Proj:RunResultsE[6]:DRtgDeltaDemand		= {	LocalRef( RunResultsE[6]:DRtgElecDemand  ) - LocalRef( RunResultsE[6]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - E-AppCkg"   	Proj:RunResultsE[7]:DRtgDeltaDemand		= {	LocalRef( RunResultsE[7]:DRtgElecDemand  ) - LocalRef( RunResultsE[7]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - E-Plugs"    	Proj:RunResultsE[8]:DRtgDeltaDemand		= {	LocalRef( RunResultsE[8]:DRtgElecDemand  ) - LocalRef( RunResultsE[8]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - E-Ext"      	Proj:RunResultsE[9]:DRtgDeltaDemand		= {	LocalRef( RunResultsE[9]:DRtgElecDemand  ) - LocalRef( RunResultsE[9]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - E-PV"     	 	Proj:RunResultsE[13]:DRtgDeltaDemand	= {	LocalRef( RunResultsE[13]:DRtgElecDemand ) - LocalRef( RunResultsE[13]:PropElecDemand[2] )   }
	"Calc Delta El Demand - E-Battery"     Proj:RunResultsE[14]:DRtgDeltaDemand	= {	LocalRef( RunResultsE[14]:DRtgElecDemand ) - LocalRef( RunResultsE[14]:PropElecDemand[2] )   }
	"Calc Delta El Demand - E-Total"    	Proj:RunResultsE[10]:DRtgDeltaDemand	= {	LocalRef( RunResultsE[10]:DRtgElecDemand ) - LocalRef( RunResultsE[10]:PropElecDemand[2] )   }
	"Calc Delta El Demand - E-Comp Ttl" 	Proj:RunResultsE[11]:DRtgDeltaDemand	= {	LocalRef( RunResultsE[11]:DRtgElecDemand ) - LocalRef( RunResultsE[11]:PropElecDemand[2] )   }

  ; Percent Improvement - SOUTH
   ; SAC 10/2/17 - switched from reporting delta with DRtgTDV w/o fuel adjustment mult applied to DRtgTDV W/ fuel adjustment mult applied
	"Calc TDV Pct Improve - S-SpcHt"    	Proj:RunResultsS[1]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsS[1]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsS[1]:DesignRatingTDV[2]  ) - LocalRef( RunResultsS[1]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsS[1]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - S-SpcCl"    	Proj:RunResultsS[2]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsS[2]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsS[2]:DesignRatingTDV[2]  ) - LocalRef( RunResultsS[2]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsS[2]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - S-IAQVent"  	Proj:RunResultsS[3]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsS[3]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsS[3]:DesignRatingTDV[2]  ) - LocalRef( RunResultsS[3]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsS[3]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - S-OthrHVAC" 	Proj:RunResultsS[4]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsS[4]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsS[4]:DesignRatingTDV[2]  ) - LocalRef( RunResultsS[4]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsS[4]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - S-WtrHt"    	Proj:RunResultsS[5]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsS[5]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsS[5]:DesignRatingTDV[2]  ) - LocalRef( RunResultsS[5]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsS[5]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - S-InsLtg"   	Proj:RunResultsS[6]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsS[6]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsS[6]:DesignRatingTDV[2]  ) - LocalRef( RunResultsS[6]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsS[6]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - S-AppCkg"   	Proj:RunResultsS[7]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsS[7]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsS[7]:DesignRatingTDV[2]  ) - LocalRef( RunResultsS[7]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsS[7]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - S-Plugs"    	Proj:RunResultsS[8]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsS[8]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsS[8]:DesignRatingTDV[2]  ) - LocalRef( RunResultsS[8]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsS[8]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - S-Ext"      	Proj:RunResultsS[9]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsS[9]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsS[9]:DesignRatingTDV[2]  ) - LocalRef( RunResultsS[9]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsS[9]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - S-PV"    	  	Proj:RunResultsS[13]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsS[13]:DesignRatingTDV[2] ) == 0) then  0  else  (LocalRef( RunResultsS[13]:DesignRatingTDV[2] ) - LocalRef( RunResultsS[13]:ProposedTDV[2] )) * 100 / LocalRef( RunResultsS[13]:DesignRatingTDV[2] )  endif  }
	"Calc TDV Pct Improve - S-Battery"    	Proj:RunResultsS[14]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsS[14]:DesignRatingTDV[2] ) == 0) then  0  else  (LocalRef( RunResultsS[14]:DesignRatingTDV[2] ) - LocalRef( RunResultsS[14]:ProposedTDV[2] )) * 100 / LocalRef( RunResultsS[14]:DesignRatingTDV[2] )  endif  }
	"Calc TDV Pct Improve - S-Total"    	Proj:RunResultsS[10]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsS[10]:DesignRatingTDV[2] ) == 0) then  0  else  (LocalRef( RunResultsS[10]:DesignRatingTDV[2] ) - LocalRef( RunResultsS[10]:ProposedTDV[2] )) * 100 / LocalRef( RunResultsS[10]:DesignRatingTDV[2] )  endif  }
	"Calc TDV Pct Improve - S-Comp Ttl"  	Proj:RunResultsS[11]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsS[11]:DesignRatingTDV[2] ) == 0) then  0  else  (LocalRef( RunResultsS[11]:DesignRatingTDV[2] ) - LocalRef( RunResultsS[11]:ProposedTDV[2] )) * 100 / LocalRef( RunResultsS[11]:DesignRatingTDV[2] )  endif  }
  ; Delta Demand
	"Calc Delta El Demand - S-SpcHt"    	Proj:RunResultsS[1]:DRtgDeltaDemand		= {	LocalRef( RunResultsS[1]:DRtgElecDemand  ) - LocalRef( RunResultsS[1]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - S-SpcCl"    	Proj:RunResultsS[2]:DRtgDeltaDemand		= {	LocalRef( RunResultsS[2]:DRtgElecDemand  ) - LocalRef( RunResultsS[2]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - S-IAQVent"  	Proj:RunResultsS[3]:DRtgDeltaDemand		= {	LocalRef( RunResultsS[3]:DRtgElecDemand  ) - LocalRef( RunResultsS[3]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - S-OthrHVAC" 	Proj:RunResultsS[4]:DRtgDeltaDemand		= {	LocalRef( RunResultsS[4]:DRtgElecDemand  ) - LocalRef( RunResultsS[4]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - S-WtrHt"    	Proj:RunResultsS[5]:DRtgDeltaDemand		= {	LocalRef( RunResultsS[5]:DRtgElecDemand  ) - LocalRef( RunResultsS[5]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - S-InsLtg"   	Proj:RunResultsS[6]:DRtgDeltaDemand		= {	LocalRef( RunResultsS[6]:DRtgElecDemand  ) - LocalRef( RunResultsS[6]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - S-AppCkg"   	Proj:RunResultsS[7]:DRtgDeltaDemand		= {	LocalRef( RunResultsS[7]:DRtgElecDemand  ) - LocalRef( RunResultsS[7]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - S-Plugs"    	Proj:RunResultsS[8]:DRtgDeltaDemand		= {	LocalRef( RunResultsS[8]:DRtgElecDemand  ) - LocalRef( RunResultsS[8]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - S-Ext"      	Proj:RunResultsS[9]:DRtgDeltaDemand		= {	LocalRef( RunResultsS[9]:DRtgElecDemand  ) - LocalRef( RunResultsS[9]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - S-PV"   	   	Proj:RunResultsS[13]:DRtgDeltaDemand	= {	LocalRef( RunResultsS[13]:DRtgElecDemand ) - LocalRef( RunResultsS[13]:PropElecDemand[2] )   }
	"Calc Delta El Demand - S-Battery"   	Proj:RunResultsS[14]:DRtgDeltaDemand	= {	LocalRef( RunResultsS[14]:DRtgElecDemand ) - LocalRef( RunResultsS[14]:PropElecDemand[2] )   }
	"Calc Delta El Demand - S-Total"    	Proj:RunResultsS[10]:DRtgDeltaDemand	= {	LocalRef( RunResultsS[10]:DRtgElecDemand ) - LocalRef( RunResultsS[10]:PropElecDemand[2] )   }
	"Calc Delta El Demand - S-Comp Ttl" 	Proj:RunResultsS[11]:DRtgDeltaDemand	= {	LocalRef( RunResultsS[11]:DRtgElecDemand ) - LocalRef( RunResultsS[11]:PropElecDemand[2] )   }

  ; Percent Improvement - WEST
   ; SAC 10/2/17 - switched from reporting delta with DRtgTDV w/o fuel adjustment mult applied to DRtgTDV W/ fuel adjustment mult applied
	"Calc TDV Pct Improve - W-SpcHt"    	Proj:RunResultsW[1]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsW[1]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsW[1]:DesignRatingTDV[2]  ) - LocalRef( RunResultsW[1]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsW[1]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - W-SpcCl"    	Proj:RunResultsW[2]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsW[2]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsW[2]:DesignRatingTDV[2]  ) - LocalRef( RunResultsW[2]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsW[2]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - W-IAQVent"  	Proj:RunResultsW[3]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsW[3]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsW[3]:DesignRatingTDV[2]  ) - LocalRef( RunResultsW[3]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsW[3]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - W-OthrHVAC" 	Proj:RunResultsW[4]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsW[4]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsW[4]:DesignRatingTDV[2]  ) - LocalRef( RunResultsW[4]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsW[4]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - W-WtrHt"    	Proj:RunResultsW[5]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsW[5]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsW[5]:DesignRatingTDV[2]  ) - LocalRef( RunResultsW[5]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsW[5]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - W-InsLtg"   	Proj:RunResultsW[6]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsW[6]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsW[6]:DesignRatingTDV[2]  ) - LocalRef( RunResultsW[6]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsW[6]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - W-AppCkg"   	Proj:RunResultsW[7]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsW[7]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsW[7]:DesignRatingTDV[2]  ) - LocalRef( RunResultsW[7]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsW[7]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - W-Plugs"    	Proj:RunResultsW[8]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsW[8]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsW[8]:DesignRatingTDV[2]  ) - LocalRef( RunResultsW[8]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsW[8]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - W-Ext"      	Proj:RunResultsW[9]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsW[9]:DesignRatingTDV[2]  ) == 0) then  0  else  (LocalRef( RunResultsW[9]:DesignRatingTDV[2]  ) - LocalRef( RunResultsW[9]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsW[9]:DesignRatingTDV[2]  )  endif  }
	"Calc TDV Pct Improve - W-PV"     	 	Proj:RunResultsW[13]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsW[13]:DesignRatingTDV[2] ) == 0) then  0  else  (LocalRef( RunResultsW[13]:DesignRatingTDV[2] ) - LocalRef( RunResultsW[13]:ProposedTDV[2] )) * 100 / LocalRef( RunResultsW[13]:DesignRatingTDV[2] )  endif  }
	"Calc TDV Pct Improve - W-Battery"     Proj:RunResultsW[14]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsW[14]:DesignRatingTDV[2] ) == 0) then  0  else  (LocalRef( RunResultsW[14]:DesignRatingTDV[2] ) - LocalRef( RunResultsW[14]:ProposedTDV[2] )) * 100 / LocalRef( RunResultsW[14]:DesignRatingTDV[2] )  endif  }
	"Calc TDV Pct Improve - W-Total"    	Proj:RunResultsW[10]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsW[10]:DesignRatingTDV[2] ) == 0) then  0  else  (LocalRef( RunResultsW[10]:DesignRatingTDV[2] ) - LocalRef( RunResultsW[10]:ProposedTDV[2] )) * 100 / LocalRef( RunResultsW[10]:DesignRatingTDV[2] )  endif  }
	"Calc TDV Pct Improve - W-Comp Ttl"  	Proj:RunResultsW[11]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsW[11]:DesignRatingTDV[2] ) == 0) then  0  else  (LocalRef( RunResultsW[11]:DesignRatingTDV[2] ) - LocalRef( RunResultsW[11]:ProposedTDV[2] )) * 100 / LocalRef( RunResultsW[11]:DesignRatingTDV[2] )  endif  }
  ; Delta Demand
	"Calc Delta El Demand - W-SpcHt"    	Proj:RunResultsW[1]:DRtgDeltaDemand		= {	LocalRef( RunResultsW[1]:DRtgElecDemand  ) - LocalRef( RunResultsW[1]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - W-SpcCl"    	Proj:RunResultsW[2]:DRtgDeltaDemand		= {	LocalRef( RunResultsW[2]:DRtgElecDemand  ) - LocalRef( RunResultsW[2]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - W-IAQVent"  	Proj:RunResultsW[3]:DRtgDeltaDemand		= {	LocalRef( RunResultsW[3]:DRtgElecDemand  ) - LocalRef( RunResultsW[3]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - W-OthrHVAC" 	Proj:RunResultsW[4]:DRtgDeltaDemand		= {	LocalRef( RunResultsW[4]:DRtgElecDemand  ) - LocalRef( RunResultsW[4]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - W-WtrHt"    	Proj:RunResultsW[5]:DRtgDeltaDemand		= {	LocalRef( RunResultsW[5]:DRtgElecDemand  ) - LocalRef( RunResultsW[5]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - W-InsLtg"   	Proj:RunResultsW[6]:DRtgDeltaDemand		= {	LocalRef( RunResultsW[6]:DRtgElecDemand  ) - LocalRef( RunResultsW[6]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - W-AppCkg"   	Proj:RunResultsW[7]:DRtgDeltaDemand		= {	LocalRef( RunResultsW[7]:DRtgElecDemand  ) - LocalRef( RunResultsW[7]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - W-Plugs"    	Proj:RunResultsW[8]:DRtgDeltaDemand		= {	LocalRef( RunResultsW[8]:DRtgElecDemand  ) - LocalRef( RunResultsW[8]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - W-Ext"      	Proj:RunResultsW[9]:DRtgDeltaDemand		= {	LocalRef( RunResultsW[9]:DRtgElecDemand  ) - LocalRef( RunResultsW[9]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - W-PV"      		Proj:RunResultsW[13]:DRtgDeltaDemand	= {	LocalRef( RunResultsW[13]:DRtgElecDemand ) - LocalRef( RunResultsW[13]:PropElecDemand[2] )   }
	"Calc Delta El Demand - W-Battery"     Proj:RunResultsW[14]:DRtgDeltaDemand	= {	LocalRef( RunResultsW[14]:DRtgElecDemand ) - LocalRef( RunResultsW[14]:PropElecDemand[2] )   }
	"Calc Delta El Demand - W-Total"    	Proj:RunResultsW[10]:DRtgDeltaDemand	= {	LocalRef( RunResultsW[10]:DRtgElecDemand ) - LocalRef( RunResultsW[10]:PropElecDemand[2] )   }
	"Calc Delta El Demand - W-Comp Ttl" 	Proj:RunResultsW[11]:DRtgDeltaDemand	= {	LocalRef( RunResultsW[11]:DRtgElecDemand ) - LocalRef( RunResultsW[11]:PropElecDemand[2] )   }
END

;*************************************************************************   - SAC 6/25/13
RULELIST "CARes_RunResults_SetWorst_N" 1 0 1 1
;*************************************************************************
	"Revise 'Worst Case' EUseSummary name"			Proj:ResultSummary[1]:Name	= {	"Worst Case (N)"  }
	"Set worst case RunResults to N - SpcHt"    	Proj:RunResults[1]	= {	RunResultsN[1]    }
	"Set worst case RunResults to N - SpcCl"    	Proj:RunResults[2]	= {	RunResultsN[2]    }
	"Set worst case RunResults to N - IAQVent"  	Proj:RunResults[3]	= {	RunResultsN[3]    }
	"Set worst case RunResults to N - OthrHVAC" 	Proj:RunResults[4]	= {	RunResultsN[4]    }
	"Set worst case RunResults to N - WtrHt"    	Proj:RunResults[5]	= {	RunResultsN[5]    }
	"Set worst case RunResults to N - InsLtg"   	Proj:RunResults[6]	= {	RunResultsN[6]    }
	"Set worst case RunResults to N - AppCkg"   	Proj:RunResults[7]	= {	RunResultsN[7]    }
	"Set worst case RunResults to N - Plugs"    	Proj:RunResults[8]	= {	RunResultsN[8]    }
	"Set worst case RunResults to N - Ext"      	Proj:RunResults[9]	= {	RunResultsN[9]    }
	"Set worst case RunResults to N - PV"      	Proj:RunResults[13]	= {	RunResultsN[13]   }
	"Set worst case RunResults to N - Battery"  	Proj:RunResults[14]	= {	RunResultsN[14]   }
	"Set worst case RunResults to N - Total"    	Proj:RunResults[10]	= {	RunResultsN[10]   }
	"Set worst case RunResults to N - Comp Ttl"  Proj:RunResults[11]	= {	RunResultsN[11]   }
	"Set worst case ResultSummary[1]:ResultsAnalysisVer"     Proj:ResultSummary[1]:ResultsAnalysisVer     = {  ResultSummary[2]:ResultsAnalysisVer  }  ; SAC 11/28/22
	"Set worst case ResultSummary[1]:AllOrientations"        Proj:ResultSummary[1]:AllOrientations        = {  ResultSummary[2]:AllOrientations     }
	"Set worst case ResultSummary[1]:PropInputPVMult"        Proj:ResultSummary[1]:PropInputPVMult        = {  ResultSummary[2]:PropInputPVMult      }  ; SAC 1/12/18
	"Set worst case ResultSummary[1]:PropPVScaleFactor"      Proj:ResultSummary[1]:PropPVScaleFactor      = {  ResultSummary[2]:PropPVScaleFactor    }  ; SAC 6/13/17
	"Set worst case ResultSummary[1]:NetSurpPVProduction"    Proj:ResultSummary[1]:NetSurpPVProduction    = {  ResultSummary[2]:NetSurpPVProduction  }
	"Set worst case ResultSummary[1]:UnscaledPropPVRatio"    Proj:ResultSummary[1]:UnscaledPropPVRatio    = {  ResultSummary[2]:UnscaledPropPVRatio  }
   "Set worst case ResultSummary[1]:StdDesignPVSize"        Proj:ResultSummary[1]:StdDesignPVSize        = {  ResultSummary[2]:StdDesignPVSize        }    ; SAC 1/7/18
   "Set worst case ResultSummary[1]:DesignRating"           Proj:ResultSummary[1]:DesignRating           = {  ResultSummary[2]:DesignRating           }
   "Set worst case ResultSummary[1]:DesignRatingNoPV"       Proj:ResultSummary[1]:DesignRatingNoPV       = {  ResultSummary[2]:DesignRatingNoPV       }
   "Set worst case ResultSummary[1]:DesignRatingPVOnly"     Proj:ResultSummary[1]:DesignRatingPVOnly     = {  ResultSummary[2]:DesignRatingPVOnly     }
   "Set worst case ResultSummary[1]:DesignRatingStd"        Proj:ResultSummary[1]:DesignRatingStd        = {  ResultSummary[2]:DesignRatingStd        }
   "Set worst case ResultSummary[1]:DesignRatingStdNoPV"    Proj:ResultSummary[1]:DesignRatingStdNoPV    = {  ResultSummary[2]:DesignRatingStdNoPV    }
   "Set worst case ResultSummary[1]:DesignRatingStdPVOnly"  Proj:ResultSummary[1]:DesignRatingStdPVOnly  = {  ResultSummary[2]:DesignRatingStdPVOnly  }
   "Set worst case ResultSummary[1]:Enduse98[15]"           Proj:ResultSummary[1]:Enduse98[15]           = {  if (LocalStatus( ResultSummary[2]:Enduse98[15]          ) > 0) then  ResultSummary[2]:Enduse98[15]            else  UNDEFINED  endif  }    ; SAC 1/27/19 (tic #1053)
   "Set worst case ResultSummary[1]:Enduse99[15]"           Proj:ResultSummary[1]:Enduse99[15]           = {  if (LocalStatus( ResultSummary[2]:Enduse99[15]          ) > 0) then  ResultSummary[2]:Enduse99[15]            else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:Enduse14[15]"           Proj:ResultSummary[1]:Enduse14[15]           = {  if (LocalStatus( ResultSummary[2]:Enduse14[15]          ) > 0) then  ResultSummary[2]:Enduse14[15]            else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse98[17]"           Proj:ResultSummary[1]:Enduse98[17]           = {  if (LocalStatus( ResultSummary[2]:Enduse98[17]          ) > 0) then  ResultSummary[2]:Enduse98[17]            else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse99[17]"           Proj:ResultSummary[1]:Enduse99[17]           = {  if (LocalStatus( ResultSummary[2]:Enduse99[17]          ) > 0) then  ResultSummary[2]:Enduse99[17]            else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:Enduse14[17]"           Proj:ResultSummary[1]:Enduse14[17]           = {  if (LocalStatus( ResultSummary[2]:Enduse14[17]          ) > 0) then  ResultSummary[2]:Enduse14[17]            else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse98[19]"           Proj:ResultSummary[1]:Enduse98[19]           = {  if (LocalStatus( ResultSummary[2]:Enduse98[19]          ) > 0) then  ResultSummary[2]:Enduse98[19]            else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse99[19]"           Proj:ResultSummary[1]:Enduse99[19]           = {  if (LocalStatus( ResultSummary[2]:Enduse99[19]          ) > 0) then  ResultSummary[2]:Enduse99[19]            else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:Enduse14[19]"           Proj:ResultSummary[1]:Enduse14[19]           = {  if (LocalStatus( ResultSummary[2]:Enduse14[19]          ) > 0) then  ResultSummary[2]:Enduse14[19]            else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse98[8]"            Proj:ResultSummary[1]:Enduse98[8]            = {  if (LocalStatus( ResultSummary[2]:Enduse98[8]           ) > 0) then  ResultSummary[2]:Enduse98[8]             else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse99[8]"            Proj:ResultSummary[1]:Enduse99[8]            = {  if (LocalStatus( ResultSummary[2]:Enduse99[8]           ) > 0) then  ResultSummary[2]:Enduse99[8]             else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:Enduse14[8]"            Proj:ResultSummary[1]:Enduse14[8]            = {  if (LocalStatus( ResultSummary[2]:Enduse14[8]           ) > 0) then  ResultSummary[2]:Enduse14[8]             else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse98[2]"            Proj:ResultSummary[1]:Enduse98[2]            = {  if (LocalStatus( ResultSummary[2]:Enduse98[2]           ) > 0) then  ResultSummary[2]:Enduse98[2]             else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse99[2]"            Proj:ResultSummary[1]:Enduse99[2]            = {  if (LocalStatus( ResultSummary[2]:Enduse99[2]           ) > 0) then  ResultSummary[2]:Enduse99[2]             else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:Enduse14[2]"            Proj:ResultSummary[1]:Enduse14[2]            = {  if (LocalStatus( ResultSummary[2]:Enduse14[2]           ) > 0) then  ResultSummary[2]:Enduse14[2]             else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse98[4]"            Proj:ResultSummary[1]:Enduse98[4]            = {  if (LocalStatus( ResultSummary[2]:Enduse98[4]           ) > 0) then  ResultSummary[2]:Enduse98[4]             else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse99[4]"            Proj:ResultSummary[1]:Enduse99[4]            = {  if (LocalStatus( ResultSummary[2]:Enduse99[4]           ) > 0) then  ResultSummary[2]:Enduse99[4]             else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:Enduse14[4]"            Proj:ResultSummary[1]:Enduse14[4]            = {  if (LocalStatus( ResultSummary[2]:Enduse14[4]           ) > 0) then  ResultSummary[2]:Enduse14[4]             else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:ResultsNotes[1]"        Proj:ResultSummary[1]:ResultsNotes[1]        = {  if (LocalStatus( ResultSummary[2]:ResultsNotes[1]       ) > 0) then  ResultSummary[2]:ResultsNotes[1]         else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:HaveResultsNotesPV[1]"  Proj:ResultSummary[1]:HaveResultsNotesPV[1]  = {  if (LocalStatus( ResultSummary[2]:HaveResultsNotesPV[1] ) > 0) then  ResultSummary[2]:HaveResultsNotesPV[1]   else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:ResultsNotes[2]"        Proj:ResultSummary[1]:ResultsNotes[2]        = {  if (LocalStatus( ResultSummary[2]:ResultsNotes[2]       ) > 0) then  ResultSummary[2]:ResultsNotes[2]         else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:HaveResultsNotesPV[2]"  Proj:ResultSummary[1]:HaveResultsNotesPV[2]  = {  if (LocalStatus( ResultSummary[2]:HaveResultsNotesPV[2] ) > 0) then  ResultSummary[2]:HaveResultsNotesPV[2]   else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:ResultsNotes[3]"        Proj:ResultSummary[1]:ResultsNotes[3]        = {  if (LocalStatus( ResultSummary[2]:ResultsNotes[3]       ) > 0) then  ResultSummary[2]:ResultsNotes[3]         else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:HaveResultsNotesPV[3]"  Proj:ResultSummary[1]:HaveResultsNotesPV[3]  = {  if (LocalStatus( ResultSummary[2]:HaveResultsNotesPV[3] ) > 0) then  ResultSummary[2]:HaveResultsNotesPV[3]   else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:ResultsNotes[4]"        Proj:ResultSummary[1]:ResultsNotes[4]        = {  if (LocalStatus( ResultSummary[2]:ResultsNotes[4]       ) > 0) then  ResultSummary[2]:ResultsNotes[4]         else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:HaveResultsNotesPV[4]"  Proj:ResultSummary[1]:HaveResultsNotesPV[4]  = {  if (LocalStatus( ResultSummary[2]:HaveResultsNotesPV[4] ) > 0) then  ResultSummary[2]:HaveResultsNotesPV[4]   else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:ResultsNotes[5]"        Proj:ResultSummary[1]:ResultsNotes[5]        = {  if (LocalStatus( ResultSummary[2]:ResultsNotes[5]       ) > 0) then  ResultSummary[2]:ResultsNotes[5]         else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:HaveResultsNotesPV[5]"  Proj:ResultSummary[1]:HaveResultsNotesPV[5]  = {  if (LocalStatus( ResultSummary[2]:HaveResultsNotesPV[5] ) > 0) then  ResultSummary[2]:HaveResultsNotesPV[5]   else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:ResultsNotes[6]"        Proj:ResultSummary[1]:ResultsNotes[6]        = {  if (LocalStatus( ResultSummary[2]:ResultsNotes[6]       ) > 0) then  ResultSummary[2]:ResultsNotes[6]        else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:HaveResultsNotesPV[6]"  Proj:ResultSummary[1]:HaveResultsNotesPV[6]  = {  if (LocalStatus( ResultSummary[2]:HaveResultsNotesPV[6] ) > 0) then  ResultSummary[2]:HaveResultsNotesPV[6]  else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:GHCEnergyEffCap"        Proj:ResultSummary[1]:GHCEnergyEffCap        = {  if (LocalStatus( ResultSummary[2]:GHCEnergyEffCap       ) > 0) then  ResultSummary[2]:GHCEnergyEffCap         else  UNDEFINED  endif  }   ; SAC 1/12/18
	"Set worst case ResultSummary[1]:GHCEnergyEffTDV"        Proj:ResultSummary[1]:GHCEnergyEffTDV        = {  if (LocalStatus( ResultSummary[2]:GHCEnergyEffTDV       ) > 0) then  ResultSummary[2]:GHCEnergyEffTDV         else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:GHCEnergyEffElec"       Proj:ResultSummary[1]:GHCEnergyEffElec       = {  if (LocalStatus( ResultSummary[2]:GHCEnergyEffElec      ) > 0) then  ResultSummary[2]:GHCEnergyEffElec        else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:GHCEnergyEffBattFrac"   Proj:ResultSummary[1]:GHCEnergyEffBattFrac   = {  if (LocalStatus( ResultSummary[2]:GHCEnergyEffBattFrac  ) > 0) then  ResultSummary[2]:GHCEnergyEffBattFrac    else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:GHCEnergyEffCO2"        Proj:ResultSummary[1]:GHCEnergyEffCO2        = {  if (LocalStatus( ResultSummary[2]:GHCEnergyEffCO2       ) > 0) then  ResultSummary[2]:GHCEnergyEffCO2        else  UNDEFINED  endif  }   ; SAC 1/27/18
	"Set worst case ResultSummary[1]:StdDHWNoSlrSysEnergy"   Proj:ResultSummary[1]:StdDHWNoSlrSysEnergy   = {  if (LocalStatus( ResultSummary[2]:StdDHWNoSlrSysEnergy  ) > 0) then  ResultSummary[2]:StdDHWNoSlrSysEnergy   else  UNDEFINED  endif  }   ; SAC 5/5/20
	"Set worst case ResultSummary[1]:StdDHWNoSlrSysTDV"      Proj:ResultSummary[1]:StdDHWNoSlrSysTDV      = {  if (LocalStatus( ResultSummary[2]:StdDHWNoSlrSysTDV     ) > 0) then  ResultSummary[2]:StdDHWNoSlrSysTDV      else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:StdDHWNoSlrSysTotTDV"   Proj:ResultSummary[1]:StdDHWNoSlrSysTotTDV   = {  if (LocalStatus( ResultSummary[2]:StdDHWNoSlrSysTotTDV  ) > 0) then  ResultSummary[2]:StdDHWNoSlrSysTotTDV   else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:StdDHWNoSlrSysTDVpSF"   Proj:ResultSummary[1]:StdDHWNoSlrSysTDVpSF   = {  if (LocalStatus( ResultSummary[2]:StdDHWNoSlrSysTDVpSF  ) > 0) then  ResultSummary[2]:StdDHWNoSlrSysTDVpSF   else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:DHWSlrPVCreditFrac"     Proj:ResultSummary[1]:DHWSlrPVCreditFrac     = {  if (LocalStatus( ResultSummary[2]:DHWSlrPVCreditFrac    ) > 0) then  ResultSummary[2]:DHWSlrPVCreditFrac     else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:DHWSlrPVCreditTDV"      Proj:ResultSummary[1]:DHWSlrPVCreditTDV      = {  if (LocalStatus( ResultSummary[2]:DHWSlrPVCreditTDV     ) > 0) then  ResultSummary[2]:DHWSlrPVCreditTDV      else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:DHWSlrPVCreditElec"     Proj:ResultSummary[1]:DHWSlrPVCreditElec     = {  if (LocalStatus( ResultSummary[2]:DHWSlrPVCreditElec    ) > 0) then  ResultSummary[2]:DHWSlrPVCreditElec     else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:DHWSlrPVCreditCO2"      Proj:ResultSummary[1]:DHWSlrPVCreditCO2      = {  if (LocalStatus( ResultSummary[2]:DHWSlrPVCreditCO2     ) > 0) then  ResultSummary[2]:DHWSlrPVCreditCO2      else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:Enduse11[4]"            Proj:ResultSummary[1]:Enduse11[4]            = {  if (LocalStatus( ResultSummary[2]:Enduse11[4]           ) > 0) then  ResultSummary[2]:Enduse11[4]            else  UNDEFINED  endif  }   ;  SAC 1/22/18
	"Set worst case ResultSummary[1]:Enduse11[8]"            Proj:ResultSummary[1]:Enduse11[8]            = {  if (LocalStatus( ResultSummary[2]:Enduse11[8]           ) > 0) then  ResultSummary[2]:Enduse11[8]            else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PctSavingsCmpTDV"       Proj:ResultSummary[1]:PctSavingsCmpTDV       = {  if (LocalStatus( ResultSummary[2]:PctSavingsCmpTDV      ) > 0) then  ResultSummary[2]:PctSavingsCmpTDV       else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PctSavCmpTDVLbl"        Proj:ResultSummary[1]:PctSavCmpTDVLbl        = {  if (LocalStatus( ResultSummary[2]:PctSavCmpTDVLbl       ) > 0) then  ResultSummary[2]:PctSavCmpTDVLbl        else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PFlxElecEnergy[1]"      Proj:ResultSummary[1]:PFlxElecEnergy[1]      = {  if (LocalStatus( ResultSummary[2]:PFlxElecEnergy[1]     ) > 0) then  ResultSummary[2]:PFlxElecEnergy[1]      else  UNDEFINED  endif  }  ; SAC 2/1/19 (tic #1053)
	"Set worst case ResultSummary[1]:PFlxElecEnergy[2]"      Proj:ResultSummary[1]:PFlxElecEnergy[2]      = {  if (LocalStatus( ResultSummary[2]:PFlxElecEnergy[2]     ) > 0) then  ResultSummary[2]:PFlxElecEnergy[2]      else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PFlxNatGasEnergy[1]"    Proj:ResultSummary[1]:PFlxNatGasEnergy[1]    = {  if (LocalStatus( ResultSummary[2]:PFlxNatGasEnergy[1]   ) > 0) then  ResultSummary[2]:PFlxNatGasEnergy[1]    else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PFlxNatGasEnergy[2]"    Proj:ResultSummary[1]:PFlxNatGasEnergy[2]    = {  if (LocalStatus( ResultSummary[2]:PFlxNatGasEnergy[2]   ) > 0) then  ResultSummary[2]:PFlxNatGasEnergy[2]    else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PFlxOtherEnergy[1]"     Proj:ResultSummary[1]:PFlxOtherEnergy[1]     = {  if (LocalStatus( ResultSummary[2]:PFlxOtherEnergy[1]    ) > 0) then  ResultSummary[2]:PFlxOtherEnergy[1]     else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PFlxOtherEnergy[2]"     Proj:ResultSummary[1]:PFlxOtherEnergy[2]     = {  if (LocalStatus( ResultSummary[2]:PFlxOtherEnergy[2]    ) > 0) then  ResultSummary[2]:PFlxOtherEnergy[2]     else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PFlxTDV[1]"             Proj:ResultSummary[1]:PFlxTDV[1]             = {  if (LocalStatus( ResultSummary[2]:PFlxTDV[1]            ) > 0) then  ResultSummary[2]:PFlxTDV[1]             else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PFlxTDV[2]"             Proj:ResultSummary[1]:PFlxTDV[2]             = {  if (LocalStatus( ResultSummary[2]:PFlxTDV[2]            ) > 0) then  ResultSummary[2]:PFlxTDV[2]             else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PropDHWNames_SSF[1]"    Proj:ResultSummary[1]:PropDHWNames_SSF[1]    = {  if (LocalStatus( ResultSummary[2]:PropDHWNames_SSF[1]   ) > 0) then  ResultSummary[2]:PropDHWNames_SSF[1]    else  UNDEFINED  endif  }  ; SAC 6/23/20 (tic #1210)
	"Set worst case ResultSummary[1]:PropDHWNames_SSF[2]"    Proj:ResultSummary[1]:PropDHWNames_SSF[2]    = {  if (LocalStatus( ResultSummary[2]:PropDHWNames_SSF[2]   ) > 0) then  ResultSummary[2]:PropDHWNames_SSF[2]    else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PropDHWNames_SSF[3]"    Proj:ResultSummary[1]:PropDHWNames_SSF[3]    = {  if (LocalStatus( ResultSummary[2]:PropDHWNames_SSF[3]   ) > 0) then  ResultSummary[2]:PropDHWNames_SSF[3]    else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PropDHW_SSF[1]"         Proj:ResultSummary[1]:PropDHW_SSF[1]         = {  if (LocalStatus( ResultSummary[2]:PropDHW_SSF[1]        ) > 0) then  ResultSummary[2]:PropDHW_SSF[1]         else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PropDHW_SSF[2]"         Proj:ResultSummary[1]:PropDHW_SSF[2]         = {  if (LocalStatus( ResultSummary[2]:PropDHW_SSF[2]        ) > 0) then  ResultSummary[2]:PropDHW_SSF[2]         else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PropDHW_SSF[3]"         Proj:ResultSummary[1]:PropDHW_SSF[3]         = {  if (LocalStatus( ResultSummary[2]:PropDHW_SSF[3]        ) > 0) then  ResultSummary[2]:PropDHW_SSF[3]         else  UNDEFINED  endif  }

   "Set Proj:ResultSummary[1]:PropPV_Total kWh"       Proj:ResultSummary[1]:PropPV_Total     = {  ResultSummary[2]:PropPV_Total      }    ; SAC 12/02/20
   "Set Proj:ResultSummary[1]:PropPV_Export kWh"      Proj:ResultSummary[1]:PropPV_Export    = {  ResultSummary[2]:PropPV_Export     }
   "Set Proj:ResultSummary[1]:PropPV_PctExport %"     Proj:ResultSummary[1]:PropPV_PctExport = {  ResultSummary[2]:PropPV_PctExport  }
   "Set Proj:ResultSummary[1]:StdPV_Total kWh"        Proj:ResultSummary[1]:StdPV_Total      = {  ResultSummary[2]:StdPV_Total       }
   "Set Proj:ResultSummary[1]:StdPV_Export kWh"       Proj:ResultSummary[1]:StdPV_Export     = {  ResultSummary[2]:StdPV_Export      }
   "Set Proj:ResultSummary[1]:StdPV_PctExport %"      Proj:ResultSummary[1]:StdPV_PctExport  = {  ResultSummary[2]:StdPV_PctExport   }
   "Set Proj:ResultSummary[1]:PropDesignBattCap kWh"  Proj:ResultSummary[1]:PropDesignBattCap  = {  ResultSummary[2]:PropDesignBattCap  }    ; SAC 11/27/22
   "Set Proj:ResultSummary[1]:PropDesignBattPwr kW"   Proj:ResultSummary[1]:PropDesignBattPwr  = {  ResultSummary[2]:PropDesignBattPwr  }

   "Set Proj:ResultSummary[1]:NumPropHVACSystems"                    Proj:ResultSummary[1]:NumPropHVACSystems   = {  ResultSummary[2]:NumPropHVACSystems   }   ; SAC 03/16/21
   "Set Proj:ResultSummary[1]:NumPropHVACEquips"                     Proj:ResultSummary[1]:NumPropHVACEquips    = {  ResultSummary[2]:NumPropHVACEquips    }
   "Set Proj:ResultSummary[1]:TotalHVACHtgCap[1-10]"  for:#A=(1-10)  Proj:ResultSummary[1]:TotalHVACHtgCap[#A]  = {  ResultSummary[2]:TotalHVACHtgCap[#A]  }
   "Set Proj:ResultSummary[1]:TotalHVACClgCap[1-10]"  for:#A=(1-10)  Proj:ResultSummary[1]:TotalHVACClgCap[#A]  = {  ResultSummary[2]:TotalHVACClgCap[#A]  }
   "Set Proj:ResultSummary[1]:TotalHVACHtgCap[1]-worst"              Proj:ResultSummary[1]:TotalHVACHtgCap[1]   = {  ResultSummary[2]:TotalHVACHtgCap[2]   }
   "Set Proj:ResultSummary[1]:TotalHVACClgCap[1]-worst"              Proj:ResultSummary[1]:TotalHVACClgCap[1]   = {  ResultSummary[2]:TotalHVACClgCap[2]   }

   "Set worst case Carbon results"     Proj:Action  =       ; SAC 2/4/19 (tic #1053)
      {  if (EnergyCodeYearNum < 2019) then  UNCHANGED
         else  EvalRulelist( "CARes_RunResults_SetWorstCarbon_N" )  endif  }
END
;*************************************************************************   - SAC 6/25/13
RULELIST "CARes_RunResults_SetWorst_E" 1 0 1 1
;*************************************************************************
	"Revise 'Worst Case' EUseSummary name"			Proj:ResultSummary[1]:Name	= {	"Worst Case (E)"  }
	"Set worst case RunResults to E - SpcHt"    	Proj:RunResults[1]	= {	RunResultsE[1]    }
	"Set worst case RunResults to E - SpcCl"    	Proj:RunResults[2]	= {	RunResultsE[2]    }
	"Set worst case RunResults to E - IAQVent"  	Proj:RunResults[3]	= {	RunResultsE[3]    }
	"Set worst case RunResults to E - OthrHVAC" 	Proj:RunResults[4]	= {	RunResultsE[4]    }
	"Set worst case RunResults to E - WtrHt"    	Proj:RunResults[5]	= {	RunResultsE[5]    }
	"Set worst case RunResults to E - InsLtg"   	Proj:RunResults[6]	= {	RunResultsE[6]    }
	"Set worst case RunResults to E - AppCkg"   	Proj:RunResults[7]	= {	RunResultsE[7]    }
	"Set worst case RunResults to E - Plugs"    	Proj:RunResults[8]	= {	RunResultsE[8]    }
	"Set worst case RunResults to E - Ext"      	Proj:RunResults[9]	= {	RunResultsE[9]    }
	"Set worst case RunResults to E - PV"      	Proj:RunResults[13]	= {	RunResultsE[13]   }
	"Set worst case RunResults to E - Battery"   Proj:RunResults[14]	= {	RunResultsE[14]   }
	"Set worst case RunResults to E - Total"    	Proj:RunResults[10]	= {	RunResultsE[10]   }
	"Set worst case RunResults to E - Comp Ttl"  Proj:RunResults[11]	= {	RunResultsE[11]   }
	"Set worst case ResultSummary[1]:ResultsAnalysisVer"     Proj:ResultSummary[1]:ResultsAnalysisVer     = {  ResultSummary[3]:ResultsAnalysisVer  }  ; SAC 11/28/22
	"Set worst case ResultSummary[1]:AllOrientations"        Proj:ResultSummary[1]:AllOrientations        = {  ResultSummary[3]:AllOrientations     }
	"Set worst case ResultSummary[1]:PropInputPVMult"        Proj:ResultSummary[1]:PropInputPVMult        = {  ResultSummary[3]:PropInputPVMult      }  ; SAC 1/12/18
	"Set worst case ResultSummary[1]:PropPVScaleFactor"      Proj:ResultSummary[1]:PropPVScaleFactor      = {  ResultSummary[3]:PropPVScaleFactor    }  ; SAC 6/13/17
	"Set worst case ResultSummary[1]:NetSurpPVProduction"    Proj:ResultSummary[1]:NetSurpPVProduction    = {  ResultSummary[3]:NetSurpPVProduction  }
	"Set worst case ResultSummary[1]:UnscaledPropPVRatio"    Proj:ResultSummary[1]:UnscaledPropPVRatio    = {  ResultSummary[3]:UnscaledPropPVRatio  }
   "Set worst case ResultSummary[1]:StdDesignPVSize"        Proj:ResultSummary[1]:StdDesignPVSize        = {  ResultSummary[3]:StdDesignPVSize  }    ; SAC 1/7/18
   "Set worst case ResultSummary[1]:DesignRating"           Proj:ResultSummary[1]:DesignRating           = {  ResultSummary[3]:DesignRating           }
   "Set worst case ResultSummary[1]:DesignRatingNoPV"       Proj:ResultSummary[1]:DesignRatingNoPV       = {  ResultSummary[3]:DesignRatingNoPV       }
   "Set worst case ResultSummary[1]:DesignRatingPVOnly"     Proj:ResultSummary[1]:DesignRatingPVOnly     = {  ResultSummary[3]:DesignRatingPVOnly     }
   "Set worst case ResultSummary[1]:DesignRatingStd"        Proj:ResultSummary[1]:DesignRatingStd        = {  ResultSummary[3]:DesignRatingStd        }
   "Set worst case ResultSummary[1]:DesignRatingStdNoPV"    Proj:ResultSummary[1]:DesignRatingStdNoPV    = {  ResultSummary[3]:DesignRatingStdNoPV    }
   "Set worst case ResultSummary[1]:DesignRatingStdPVOnly"  Proj:ResultSummary[1]:DesignRatingStdPVOnly  = {  ResultSummary[3]:DesignRatingStdPVOnly  }
   "Set worst case ResultSummary[1]:Enduse98[15]"           Proj:ResultSummary[1]:Enduse98[15]           = {  if (LocalStatus( ResultSummary[3]:Enduse98[15]          ) > 0) then  ResultSummary[3]:Enduse98[15]           else  UNDEFINED  endif  }     ; SAC 1/27/19 (tic #1053)
   "Set worst case ResultSummary[1]:Enduse99[15]"           Proj:ResultSummary[1]:Enduse99[15]           = {  if (LocalStatus( ResultSummary[3]:Enduse99[15]          ) > 0) then  ResultSummary[3]:Enduse99[15]           else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:Enduse14[15]"           Proj:ResultSummary[1]:Enduse14[15]           = {  if (LocalStatus( ResultSummary[3]:Enduse14[15]          ) > 0) then  ResultSummary[3]:Enduse14[15]           else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse98[17]"           Proj:ResultSummary[1]:Enduse98[17]           = {  if (LocalStatus( ResultSummary[3]:Enduse98[17]          ) > 0) then  ResultSummary[3]:Enduse98[17]           else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse99[17]"           Proj:ResultSummary[1]:Enduse99[17]           = {  if (LocalStatus( ResultSummary[3]:Enduse99[17]          ) > 0) then  ResultSummary[3]:Enduse99[17]           else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:Enduse14[17]"           Proj:ResultSummary[1]:Enduse14[17]           = {  if (LocalStatus( ResultSummary[3]:Enduse14[17]          ) > 0) then  ResultSummary[3]:Enduse14[17]           else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse98[19]"           Proj:ResultSummary[1]:Enduse98[19]           = {  if (LocalStatus( ResultSummary[3]:Enduse98[19]          ) > 0) then  ResultSummary[3]:Enduse98[19]           else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse99[19]"           Proj:ResultSummary[1]:Enduse99[19]           = {  if (LocalStatus( ResultSummary[3]:Enduse99[19]          ) > 0) then  ResultSummary[3]:Enduse99[19]           else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:Enduse14[19]"           Proj:ResultSummary[1]:Enduse14[19]           = {  if (LocalStatus( ResultSummary[3]:Enduse14[19]          ) > 0) then  ResultSummary[3]:Enduse14[19]           else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse98[8]"            Proj:ResultSummary[1]:Enduse98[8]            = {  if (LocalStatus( ResultSummary[3]:Enduse98[8]           ) > 0) then  ResultSummary[3]:Enduse98[8]            else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse99[8]"            Proj:ResultSummary[1]:Enduse99[8]            = {  if (LocalStatus( ResultSummary[3]:Enduse99[8]           ) > 0) then  ResultSummary[3]:Enduse99[8]            else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:Enduse14[8]"            Proj:ResultSummary[1]:Enduse14[8]            = {  if (LocalStatus( ResultSummary[3]:Enduse14[8]           ) > 0) then  ResultSummary[3]:Enduse14[8]            else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse98[2]"            Proj:ResultSummary[1]:Enduse98[2]            = {  if (LocalStatus( ResultSummary[3]:Enduse98[2]           ) > 0) then  ResultSummary[3]:Enduse98[2]            else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse99[2]"            Proj:ResultSummary[1]:Enduse99[2]            = {  if (LocalStatus( ResultSummary[3]:Enduse99[2]           ) > 0) then  ResultSummary[3]:Enduse99[2]            else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:Enduse14[2]"            Proj:ResultSummary[1]:Enduse14[2]            = {  if (LocalStatus( ResultSummary[3]:Enduse14[2]           ) > 0) then  ResultSummary[3]:Enduse14[2]            else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse98[4]"            Proj:ResultSummary[1]:Enduse98[4]            = {  if (LocalStatus( ResultSummary[3]:Enduse98[4]           ) > 0) then  ResultSummary[3]:Enduse98[4]            else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse99[4]"            Proj:ResultSummary[1]:Enduse99[4]            = {  if (LocalStatus( ResultSummary[3]:Enduse99[4]           ) > 0) then  ResultSummary[3]:Enduse99[4]            else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:Enduse14[4]"            Proj:ResultSummary[1]:Enduse14[4]            = {  if (LocalStatus( ResultSummary[3]:Enduse14[4]           ) > 0) then  ResultSummary[3]:Enduse14[4]            else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:ResultsNotes[1]"        Proj:ResultSummary[1]:ResultsNotes[1]        = {  if (LocalStatus( ResultSummary[3]:ResultsNotes[1]       ) > 0) then  ResultSummary[3]:ResultsNotes[1]        else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:HaveResultsNotesPV[1]"  Proj:ResultSummary[1]:HaveResultsNotesPV[1]  = {  if (LocalStatus( ResultSummary[3]:HaveResultsNotesPV[1] ) > 0) then  ResultSummary[3]:HaveResultsNotesPV[1]  else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:ResultsNotes[2]"        Proj:ResultSummary[1]:ResultsNotes[2]        = {  if (LocalStatus( ResultSummary[3]:ResultsNotes[2]       ) > 0) then  ResultSummary[3]:ResultsNotes[2]        else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:HaveResultsNotesPV[2]"  Proj:ResultSummary[1]:HaveResultsNotesPV[2]  = {  if (LocalStatus( ResultSummary[3]:HaveResultsNotesPV[2] ) > 0) then  ResultSummary[3]:HaveResultsNotesPV[2]  else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:ResultsNotes[3]"        Proj:ResultSummary[1]:ResultsNotes[3]        = {  if (LocalStatus( ResultSummary[3]:ResultsNotes[3]       ) > 0) then  ResultSummary[3]:ResultsNotes[3]        else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:HaveResultsNotesPV[3]"  Proj:ResultSummary[1]:HaveResultsNotesPV[3]  = {  if (LocalStatus( ResultSummary[3]:HaveResultsNotesPV[3] ) > 0) then  ResultSummary[3]:HaveResultsNotesPV[3]  else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:ResultsNotes[4]"        Proj:ResultSummary[1]:ResultsNotes[4]        = {  if (LocalStatus( ResultSummary[3]:ResultsNotes[4]       ) > 0) then  ResultSummary[3]:ResultsNotes[4]        else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:HaveResultsNotesPV[4]"  Proj:ResultSummary[1]:HaveResultsNotesPV[4]  = {  if (LocalStatus( ResultSummary[3]:HaveResultsNotesPV[4] ) > 0) then  ResultSummary[3]:HaveResultsNotesPV[4]  else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:ResultsNotes[5]"        Proj:ResultSummary[1]:ResultsNotes[5]        = {  if (LocalStatus( ResultSummary[3]:ResultsNotes[5]       ) > 0) then  ResultSummary[3]:ResultsNotes[5]        else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:HaveResultsNotesPV[5]"  Proj:ResultSummary[1]:HaveResultsNotesPV[5]  = {  if (LocalStatus( ResultSummary[3]:HaveResultsNotesPV[5] ) > 0) then  ResultSummary[3]:HaveResultsNotesPV[5]  else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:ResultsNotes[6]"        Proj:ResultSummary[1]:ResultsNotes[6]        = {  if (LocalStatus( ResultSummary[3]:ResultsNotes[6]       ) > 0) then  ResultSummary[3]:ResultsNotes[6]        else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:HaveResultsNotesPV[6]"  Proj:ResultSummary[1]:HaveResultsNotesPV[6]  = {  if (LocalStatus( ResultSummary[3]:HaveResultsNotesPV[6] ) > 0) then  ResultSummary[3]:HaveResultsNotesPV[6]  else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:GHCEnergyEffCap"        Proj:ResultSummary[1]:GHCEnergyEffCap        = {  if (LocalStatus( ResultSummary[3]:GHCEnergyEffCap       ) > 0) then  ResultSummary[3]:GHCEnergyEffCap        else  UNDEFINED  endif  }   ; SAC 1/12/18
	"Set worst case ResultSummary[1]:GHCEnergyEffTDV"        Proj:ResultSummary[1]:GHCEnergyEffTDV        = {  if (LocalStatus( ResultSummary[3]:GHCEnergyEffTDV       ) > 0) then  ResultSummary[3]:GHCEnergyEffTDV        else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:GHCEnergyEffElec"       Proj:ResultSummary[1]:GHCEnergyEffElec       = {  if (LocalStatus( ResultSummary[3]:GHCEnergyEffElec      ) > 0) then  ResultSummary[3]:GHCEnergyEffElec       else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:GHCEnergyEffBattFrac"   Proj:ResultSummary[1]:GHCEnergyEffBattFrac   = {  if (LocalStatus( ResultSummary[3]:GHCEnergyEffBattFrac  ) > 0) then  ResultSummary[3]:GHCEnergyEffBattFrac   else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:GHCEnergyEffCO2"        Proj:ResultSummary[1]:GHCEnergyEffCO2        = {  if (LocalStatus( ResultSummary[3]:GHCEnergyEffCO2       ) > 0) then  ResultSummary[3]:GHCEnergyEffCO2        else  UNDEFINED  endif  }   ; SAC 1/27/18
	"Set worst case ResultSummary[1]:StdDHWNoSlrSysEnergy"   Proj:ResultSummary[1]:StdDHWNoSlrSysEnergy   = {  if (LocalStatus( ResultSummary[3]:StdDHWNoSlrSysEnergy  ) > 0) then  ResultSummary[3]:StdDHWNoSlrSysEnergy   else  UNDEFINED  endif  }   ; SAC 5/5/20
	"Set worst case ResultSummary[1]:StdDHWNoSlrSysTDV"      Proj:ResultSummary[1]:StdDHWNoSlrSysTDV      = {  if (LocalStatus( ResultSummary[3]:StdDHWNoSlrSysTDV     ) > 0) then  ResultSummary[3]:StdDHWNoSlrSysTDV      else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:StdDHWNoSlrSysTotTDV"   Proj:ResultSummary[1]:StdDHWNoSlrSysTotTDV   = {  if (LocalStatus( ResultSummary[3]:StdDHWNoSlrSysTotTDV  ) > 0) then  ResultSummary[3]:StdDHWNoSlrSysTotTDV   else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:StdDHWNoSlrSysTDVpSF"   Proj:ResultSummary[1]:StdDHWNoSlrSysTDVpSF   = {  if (LocalStatus( ResultSummary[3]:StdDHWNoSlrSysTDVpSF  ) > 0) then  ResultSummary[3]:StdDHWNoSlrSysTDVpSF   else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:DHWSlrPVCreditFrac"     Proj:ResultSummary[1]:DHWSlrPVCreditFrac     = {  if (LocalStatus( ResultSummary[3]:DHWSlrPVCreditFrac    ) > 0) then  ResultSummary[3]:DHWSlrPVCreditFrac     else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:DHWSlrPVCreditTDV"      Proj:ResultSummary[1]:DHWSlrPVCreditTDV      = {  if (LocalStatus( ResultSummary[3]:DHWSlrPVCreditTDV     ) > 0) then  ResultSummary[3]:DHWSlrPVCreditTDV      else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:DHWSlrPVCreditElec"     Proj:ResultSummary[1]:DHWSlrPVCreditElec     = {  if (LocalStatus( ResultSummary[3]:DHWSlrPVCreditElec    ) > 0) then  ResultSummary[3]:DHWSlrPVCreditElec     else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:DHWSlrPVCreditCO2"      Proj:ResultSummary[1]:DHWSlrPVCreditCO2      = {  if (LocalStatus( ResultSummary[3]:DHWSlrPVCreditCO2     ) > 0) then  ResultSummary[3]:DHWSlrPVCreditCO2      else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:Enduse11[4]"            Proj:ResultSummary[1]:Enduse11[4]            = {  if (LocalStatus( ResultSummary[3]:Enduse11[4]           ) > 0) then  ResultSummary[3]:Enduse11[4]            else  UNDEFINED  endif  }   ;  SAC 1/22/18
	"Set worst case ResultSummary[1]:Enduse11[8]"            Proj:ResultSummary[1]:Enduse11[8]            = {  if (LocalStatus( ResultSummary[3]:Enduse11[8]           ) > 0) then  ResultSummary[3]:Enduse11[8]            else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PctSavingsCmpTDV"       Proj:ResultSummary[1]:PctSavingsCmpTDV       = {  if (LocalStatus( ResultSummary[3]:PctSavingsCmpTDV      ) > 0) then  ResultSummary[3]:PctSavingsCmpTDV       else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PctSavCmpTDVLbl"        Proj:ResultSummary[1]:PctSavCmpTDVLbl        = {  if (LocalStatus( ResultSummary[3]:PctSavCmpTDVLbl       ) > 0) then  ResultSummary[3]:PctSavCmpTDVLbl        else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PFlxElecEnergy[1]"      Proj:ResultSummary[1]:PFlxElecEnergy[1]      = {  if (LocalStatus( ResultSummary[3]:PFlxElecEnergy[1]     ) > 0) then  ResultSummary[3]:PFlxElecEnergy[1]      else  UNDEFINED  endif  }  ; SAC 2/1/19 (tic #1053)
	"Set worst case ResultSummary[1]:PFlxElecEnergy[2]"      Proj:ResultSummary[1]:PFlxElecEnergy[2]      = {  if (LocalStatus( ResultSummary[3]:PFlxElecEnergy[2]     ) > 0) then  ResultSummary[3]:PFlxElecEnergy[2]      else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PFlxNatGasEnergy[1]"    Proj:ResultSummary[1]:PFlxNatGasEnergy[1]    = {  if (LocalStatus( ResultSummary[3]:PFlxNatGasEnergy[1]   ) > 0) then  ResultSummary[3]:PFlxNatGasEnergy[1]    else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PFlxNatGasEnergy[2]"    Proj:ResultSummary[1]:PFlxNatGasEnergy[2]    = {  if (LocalStatus( ResultSummary[3]:PFlxNatGasEnergy[2]   ) > 0) then  ResultSummary[3]:PFlxNatGasEnergy[2]    else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PFlxOtherEnergy[1]"     Proj:ResultSummary[1]:PFlxOtherEnergy[1]     = {  if (LocalStatus( ResultSummary[3]:PFlxOtherEnergy[1]    ) > 0) then  ResultSummary[3]:PFlxOtherEnergy[1]     else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PFlxOtherEnergy[2]"     Proj:ResultSummary[1]:PFlxOtherEnergy[2]     = {  if (LocalStatus( ResultSummary[3]:PFlxOtherEnergy[2]    ) > 0) then  ResultSummary[3]:PFlxOtherEnergy[2]     else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PFlxTDV[1]"             Proj:ResultSummary[1]:PFlxTDV[1]             = {  if (LocalStatus( ResultSummary[3]:PFlxTDV[1]            ) > 0) then  ResultSummary[3]:PFlxTDV[1]             else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PFlxTDV[2]"             Proj:ResultSummary[1]:PFlxTDV[2]             = {  if (LocalStatus( ResultSummary[3]:PFlxTDV[2]            ) > 0) then  ResultSummary[3]:PFlxTDV[2]             else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PropDHWNames_SSF[1]"    Proj:ResultSummary[1]:PropDHWNames_SSF[1]    = {  if (LocalStatus( ResultSummary[3]:PropDHWNames_SSF[1]   ) > 0) then  ResultSummary[3]:PropDHWNames_SSF[1]    else  UNDEFINED  endif  }  ; SAC 6/23/20 (tic #1210)
	"Set worst case ResultSummary[1]:PropDHWNames_SSF[2]"    Proj:ResultSummary[1]:PropDHWNames_SSF[2]    = {  if (LocalStatus( ResultSummary[3]:PropDHWNames_SSF[2]   ) > 0) then  ResultSummary[3]:PropDHWNames_SSF[2]    else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PropDHWNames_SSF[3]"    Proj:ResultSummary[1]:PropDHWNames_SSF[3]    = {  if (LocalStatus( ResultSummary[3]:PropDHWNames_SSF[3]   ) > 0) then  ResultSummary[3]:PropDHWNames_SSF[3]    else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PropDHW_SSF[1]"         Proj:ResultSummary[1]:PropDHW_SSF[1]         = {  if (LocalStatus( ResultSummary[3]:PropDHW_SSF[1]        ) > 0) then  ResultSummary[3]:PropDHW_SSF[1]         else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PropDHW_SSF[2]"         Proj:ResultSummary[1]:PropDHW_SSF[2]         = {  if (LocalStatus( ResultSummary[3]:PropDHW_SSF[2]        ) > 0) then  ResultSummary[3]:PropDHW_SSF[2]         else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PropDHW_SSF[3]"         Proj:ResultSummary[1]:PropDHW_SSF[3]         = {  if (LocalStatus( ResultSummary[3]:PropDHW_SSF[3]        ) > 0) then  ResultSummary[3]:PropDHW_SSF[3]         else  UNDEFINED  endif  }

   "Set Proj:ResultSummary[1]:PropPV_Total kWh"       Proj:ResultSummary[1]:PropPV_Total     = {  ResultSummary[3]:PropPV_Total      }    ; SAC 12/02/20
   "Set Proj:ResultSummary[1]:PropPV_Export kWh"      Proj:ResultSummary[1]:PropPV_Export    = {  ResultSummary[3]:PropPV_Export     }
   "Set Proj:ResultSummary[1]:PropPV_PctExport %"     Proj:ResultSummary[1]:PropPV_PctExport = {  ResultSummary[3]:PropPV_PctExport  }
   "Set Proj:ResultSummary[1]:StdPV_Total kWh"        Proj:ResultSummary[1]:StdPV_Total      = {  ResultSummary[3]:StdPV_Total       }
   "Set Proj:ResultSummary[1]:StdPV_Export kWh"       Proj:ResultSummary[1]:StdPV_Export     = {  ResultSummary[3]:StdPV_Export      }
   "Set Proj:ResultSummary[1]:StdPV_PctExport %"      Proj:ResultSummary[1]:StdPV_PctExport  = {  ResultSummary[3]:StdPV_PctExport   }
   "Set Proj:ResultSummary[1]:PropDesignBattCap kWh"  Proj:ResultSummary[1]:PropDesignBattCap  = {  ResultSummary[3]:PropDesignBattCap  }    ; SAC 11/27/22
   "Set Proj:ResultSummary[1]:PropDesignBattPwr kW"   Proj:ResultSummary[1]:PropDesignBattPwr  = {  ResultSummary[3]:PropDesignBattPwr  }

   "Set Proj:ResultSummary[1]:NumPropHVACSystems"                    Proj:ResultSummary[1]:NumPropHVACSystems   = {  ResultSummary[3]:NumPropHVACSystems   }   ; SAC 03/16/21
   "Set Proj:ResultSummary[1]:NumPropHVACEquips"                     Proj:ResultSummary[1]:NumPropHVACEquips    = {  ResultSummary[3]:NumPropHVACEquips    }
   "Set Proj:ResultSummary[1]:TotalHVACHtgCap[1-10]"  for:#A=(1-10)  Proj:ResultSummary[1]:TotalHVACHtgCap[#A]  = {  ResultSummary[3]:TotalHVACHtgCap[#A]  }
   "Set Proj:ResultSummary[1]:TotalHVACClgCap[1-10]"  for:#A=(1-10)  Proj:ResultSummary[1]:TotalHVACClgCap[#A]  = {  ResultSummary[3]:TotalHVACClgCap[#A]  }
   "Set Proj:ResultSummary[1]:TotalHVACHtgCap[1]-worst"              Proj:ResultSummary[1]:TotalHVACHtgCap[1]   = {  ResultSummary[3]:TotalHVACHtgCap[3]   }
   "Set Proj:ResultSummary[1]:TotalHVACClgCap[1]-worst"              Proj:ResultSummary[1]:TotalHVACClgCap[1]   = {  ResultSummary[3]:TotalHVACClgCap[3]   }

   "Set worst case Carbon results"     Proj:Action  =       ; SAC 2/4/19 (tic #1053) 
      {  if (EnergyCodeYearNum < 2019) then  UNCHANGED
         else  EvalRulelist( "CARes_RunResults_SetWorstCarbon_E" )  endif  }
END
;*************************************************************************   - SAC 6/25/13
RULELIST "CARes_RunResults_SetWorst_S" 1 0 1 1
;*************************************************************************
	"Revise 'Worst Case' EUseSummary name"			Proj:ResultSummary[1]:Name	= {	"Worst Case (S)"  }
	"Set worst case RunResults to S - SpcHt"    	Proj:RunResults[1]	= {	RunResultsS[1]    }
	"Set worst case RunResults to S - SpcCl"    	Proj:RunResults[2]	= {	RunResultsS[2]    }
	"Set worst case RunResults to S - IAQVent"  	Proj:RunResults[3]	= {	RunResultsS[3]    }
	"Set worst case RunResults to S - OthrHVAC" 	Proj:RunResults[4]	= {	RunResultsS[4]    }
	"Set worst case RunResults to S - WtrHt"    	Proj:RunResults[5]	= {	RunResultsS[5]    }
	"Set worst case RunResults to S - InsLtg"   	Proj:RunResults[6]	= {	RunResultsS[6]    }
	"Set worst case RunResults to S - AppCkg"   	Proj:RunResults[7]	= {	RunResultsS[7]    }
	"Set worst case RunResults to S - Plugs"    	Proj:RunResults[8]	= {	RunResultsS[8]    }
	"Set worst case RunResults to S - Ext"      	Proj:RunResults[9]	= {	RunResultsS[9]    }
	"Set worst case RunResults to S - PV"      	Proj:RunResults[13]	= {	RunResultsS[13]   }
	"Set worst case RunResults to S - Battery"  	Proj:RunResults[14]	= {	RunResultsS[14]   }
	"Set worst case RunResults to S - Total"    	Proj:RunResults[10]	= {	RunResultsS[10]   }
	"Set worst case RunResults to S - Comp Ttl"  Proj:RunResults[11]	= {	RunResultsS[11]   }
	"Set worst case ResultSummary[1]:ResultsAnalysisVer"     Proj:ResultSummary[1]:ResultsAnalysisVer     = {  ResultSummary[4]:ResultsAnalysisVer  }  ; SAC 11/28/22
	"Set worst case ResultSummary[1]:AllOrientations"        Proj:ResultSummary[1]:AllOrientations        = {  ResultSummary[4]:AllOrientations     }
	"Set worst case ResultSummary[1]:PropInputPVMult"        Proj:ResultSummary[1]:PropInputPVMult        = {  ResultSummary[4]:PropInputPVMult      }  ; SAC 1/12/18
	"Set worst case ResultSummary[1]:PropPVScaleFactor"      Proj:ResultSummary[1]:PropPVScaleFactor      = {  ResultSummary[4]:PropPVScaleFactor    }  ; SAC 6/13/17
	"Set worst case ResultSummary[1]:NetSurpPVProduction"    Proj:ResultSummary[1]:NetSurpPVProduction    = {  ResultSummary[4]:NetSurpPVProduction  }
	"Set worst case ResultSummary[1]:UnscaledPropPVRatio"    Proj:ResultSummary[1]:UnscaledPropPVRatio    = {  ResultSummary[4]:UnscaledPropPVRatio  }
   "Set worst case ResultSummary[1]:StdDesignPVSize"        Proj:ResultSummary[1]:StdDesignPVSize        = {  ResultSummary[4]:StdDesignPVSize  }    ; SAC 1/7/18
   "Set worst case ResultSummary[1]:DesignRating"           Proj:ResultSummary[1]:DesignRating           = {  ResultSummary[4]:DesignRating           }
   "Set worst case ResultSummary[1]:DesignRatingNoPV"       Proj:ResultSummary[1]:DesignRatingNoPV       = {  ResultSummary[4]:DesignRatingNoPV       }
   "Set worst case ResultSummary[1]:DesignRatingPVOnly"     Proj:ResultSummary[1]:DesignRatingPVOnly     = {  ResultSummary[4]:DesignRatingPVOnly     }
   "Set worst case ResultSummary[1]:DesignRatingStd"        Proj:ResultSummary[1]:DesignRatingStd        = {  ResultSummary[4]:DesignRatingStd        }
   "Set worst case ResultSummary[1]:DesignRatingStdNoPV"    Proj:ResultSummary[1]:DesignRatingStdNoPV    = {  ResultSummary[4]:DesignRatingStdNoPV    }
   "Set worst case ResultSummary[1]:DesignRatingStdPVOnly"  Proj:ResultSummary[1]:DesignRatingStdPVOnly  = {  ResultSummary[4]:DesignRatingStdPVOnly  }
   "Set worst case ResultSummary[1]:Enduse98[15]"           Proj:ResultSummary[1]:Enduse98[15]           = {  if (LocalStatus( ResultSummary[4]:Enduse98[15]          ) > 0) then  ResultSummary[4]:Enduse98[15]           else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse99[15]"           Proj:ResultSummary[1]:Enduse99[15]           = {  if (LocalStatus( ResultSummary[4]:Enduse99[15]          ) > 0) then  ResultSummary[4]:Enduse99[15]           else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:Enduse14[15]"           Proj:ResultSummary[1]:Enduse14[15]           = {  if (LocalStatus( ResultSummary[4]:Enduse14[15]          ) > 0) then  ResultSummary[4]:Enduse14[15]           else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse98[17]"           Proj:ResultSummary[1]:Enduse98[17]           = {  if (LocalStatus( ResultSummary[4]:Enduse98[17]          ) > 0) then  ResultSummary[4]:Enduse98[17]           else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse99[17]"           Proj:ResultSummary[1]:Enduse99[17]           = {  if (LocalStatus( ResultSummary[4]:Enduse99[17]          ) > 0) then  ResultSummary[4]:Enduse99[17]           else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:Enduse14[17]"           Proj:ResultSummary[1]:Enduse14[17]           = {  if (LocalStatus( ResultSummary[4]:Enduse14[17]          ) > 0) then  ResultSummary[4]:Enduse14[17]           else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse98[19]"           Proj:ResultSummary[1]:Enduse98[19]           = {  if (LocalStatus( ResultSummary[4]:Enduse98[19]          ) > 0) then  ResultSummary[4]:Enduse98[19]           else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse99[19]"           Proj:ResultSummary[1]:Enduse99[19]           = {  if (LocalStatus( ResultSummary[4]:Enduse99[19]          ) > 0) then  ResultSummary[4]:Enduse99[19]           else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:Enduse14[19]"           Proj:ResultSummary[1]:Enduse14[19]           = {  if (LocalStatus( ResultSummary[4]:Enduse14[19]          ) > 0) then  ResultSummary[4]:Enduse14[19]           else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse98[8]"            Proj:ResultSummary[1]:Enduse98[8]            = {  if (LocalStatus( ResultSummary[4]:Enduse98[8]           ) > 0) then  ResultSummary[4]:Enduse98[8]            else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse99[8]"            Proj:ResultSummary[1]:Enduse99[8]            = {  if (LocalStatus( ResultSummary[4]:Enduse99[8]           ) > 0) then  ResultSummary[4]:Enduse99[8]            else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:Enduse14[8]"            Proj:ResultSummary[1]:Enduse14[8]            = {  if (LocalStatus( ResultSummary[4]:Enduse14[8]           ) > 0) then  ResultSummary[4]:Enduse14[8]            else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse98[2]"            Proj:ResultSummary[1]:Enduse98[2]            = {  if (LocalStatus( ResultSummary[4]:Enduse98[2]           ) > 0) then  ResultSummary[4]:Enduse98[2]            else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse99[2]"            Proj:ResultSummary[1]:Enduse99[2]            = {  if (LocalStatus( ResultSummary[4]:Enduse99[2]           ) > 0) then  ResultSummary[4]:Enduse99[2]            else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:Enduse14[2]"            Proj:ResultSummary[1]:Enduse14[2]            = {  if (LocalStatus( ResultSummary[4]:Enduse14[2]           ) > 0) then  ResultSummary[4]:Enduse14[2]            else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse98[4]"            Proj:ResultSummary[1]:Enduse98[4]            = {  if (LocalStatus( ResultSummary[4]:Enduse98[4]           ) > 0) then  ResultSummary[4]:Enduse98[4]            else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse99[4]"            Proj:ResultSummary[1]:Enduse99[4]            = {  if (LocalStatus( ResultSummary[4]:Enduse99[4]           ) > 0) then  ResultSummary[4]:Enduse99[4]            else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:Enduse14[4]"            Proj:ResultSummary[1]:Enduse14[4]            = {  if (LocalStatus( ResultSummary[4]:Enduse14[4]           ) > 0) then  ResultSummary[4]:Enduse14[4]            else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:ResultsNotes[1]"        Proj:ResultSummary[1]:ResultsNotes[1]        = {  if (LocalStatus( ResultSummary[4]:ResultsNotes[1]       ) > 0) then  ResultSummary[4]:ResultsNotes[1]        else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:HaveResultsNotesPV[1]"  Proj:ResultSummary[1]:HaveResultsNotesPV[1]  = {  if (LocalStatus( ResultSummary[4]:HaveResultsNotesPV[1] ) > 0) then  ResultSummary[4]:HaveResultsNotesPV[1]  else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:ResultsNotes[2]"        Proj:ResultSummary[1]:ResultsNotes[2]        = {  if (LocalStatus( ResultSummary[4]:ResultsNotes[2]       ) > 0) then  ResultSummary[4]:ResultsNotes[2]        else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:HaveResultsNotesPV[2]"  Proj:ResultSummary[1]:HaveResultsNotesPV[2]  = {  if (LocalStatus( ResultSummary[4]:HaveResultsNotesPV[2] ) > 0) then  ResultSummary[4]:HaveResultsNotesPV[2]  else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:ResultsNotes[3]"        Proj:ResultSummary[1]:ResultsNotes[3]        = {  if (LocalStatus( ResultSummary[4]:ResultsNotes[3]       ) > 0) then  ResultSummary[4]:ResultsNotes[3]        else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:HaveResultsNotesPV[3]"  Proj:ResultSummary[1]:HaveResultsNotesPV[3]  = {  if (LocalStatus( ResultSummary[4]:HaveResultsNotesPV[3] ) > 0) then  ResultSummary[4]:HaveResultsNotesPV[3]  else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:ResultsNotes[4]"        Proj:ResultSummary[1]:ResultsNotes[4]        = {  if (LocalStatus( ResultSummary[4]:ResultsNotes[4]       ) > 0) then  ResultSummary[4]:ResultsNotes[4]        else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:HaveResultsNotesPV[4]"  Proj:ResultSummary[1]:HaveResultsNotesPV[4]  = {  if (LocalStatus( ResultSummary[4]:HaveResultsNotesPV[4] ) > 0) then  ResultSummary[4]:HaveResultsNotesPV[4]  else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:ResultsNotes[5]"        Proj:ResultSummary[1]:ResultsNotes[5]        = {  if (LocalStatus( ResultSummary[4]:ResultsNotes[5]       ) > 0) then  ResultSummary[4]:ResultsNotes[5]        else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:HaveResultsNotesPV[5]"  Proj:ResultSummary[1]:HaveResultsNotesPV[5]  = {  if (LocalStatus( ResultSummary[4]:HaveResultsNotesPV[5] ) > 0) then  ResultSummary[4]:HaveResultsNotesPV[5]  else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:ResultsNotes[6]"        Proj:ResultSummary[1]:ResultsNotes[6]        = {  if (LocalStatus( ResultSummary[4]:ResultsNotes[6]       ) > 0) then  ResultSummary[4]:ResultsNotes[6]        else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:HaveResultsNotesPV[6]"  Proj:ResultSummary[1]:HaveResultsNotesPV[6]  = {  if (LocalStatus( ResultSummary[4]:HaveResultsNotesPV[6] ) > 0) then  ResultSummary[4]:HaveResultsNotesPV[6]  else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:GHCEnergyEffCap"        Proj:ResultSummary[1]:GHCEnergyEffCap        = {  if (LocalStatus( ResultSummary[4]:GHCEnergyEffCap       ) > 0) then  ResultSummary[4]:GHCEnergyEffCap        else  UNDEFINED  endif  }   ; SAC 1/12/18
	"Set worst case ResultSummary[1]:GHCEnergyEffTDV"        Proj:ResultSummary[1]:GHCEnergyEffTDV        = {  if (LocalStatus( ResultSummary[4]:GHCEnergyEffTDV       ) > 0) then  ResultSummary[4]:GHCEnergyEffTDV        else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:GHCEnergyEffElec"       Proj:ResultSummary[1]:GHCEnergyEffElec       = {  if (LocalStatus( ResultSummary[4]:GHCEnergyEffElec      ) > 0) then  ResultSummary[4]:GHCEnergyEffElec       else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:GHCEnergyEffBattFrac"   Proj:ResultSummary[1]:GHCEnergyEffBattFrac   = {  if (LocalStatus( ResultSummary[4]:GHCEnergyEffBattFrac  ) > 0) then  ResultSummary[4]:GHCEnergyEffBattFrac   else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:GHCEnergyEffCO2"        Proj:ResultSummary[1]:GHCEnergyEffCO2        = {  if (LocalStatus( ResultSummary[4]:GHCEnergyEffCO2       ) > 0) then  ResultSummary[4]:GHCEnergyEffCO2        else  UNDEFINED  endif  }   ; SAC 1/27/18
	"Set worst case ResultSummary[1]:StdDHWNoSlrSysEnergy"   Proj:ResultSummary[1]:StdDHWNoSlrSysEnergy   = {  if (LocalStatus( ResultSummary[4]:StdDHWNoSlrSysEnergy  ) > 0) then  ResultSummary[4]:StdDHWNoSlrSysEnergy   else  UNDEFINED  endif  }   ; SAC 5/5/20
	"Set worst case ResultSummary[1]:StdDHWNoSlrSysTDV"      Proj:ResultSummary[1]:StdDHWNoSlrSysTDV      = {  if (LocalStatus( ResultSummary[4]:StdDHWNoSlrSysTDV     ) > 0) then  ResultSummary[4]:StdDHWNoSlrSysTDV      else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:StdDHWNoSlrSysTotTDV"   Proj:ResultSummary[1]:StdDHWNoSlrSysTotTDV   = {  if (LocalStatus( ResultSummary[4]:StdDHWNoSlrSysTotTDV  ) > 0) then  ResultSummary[4]:StdDHWNoSlrSysTotTDV   else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:StdDHWNoSlrSysTDVpSF"   Proj:ResultSummary[1]:StdDHWNoSlrSysTDVpSF   = {  if (LocalStatus( ResultSummary[4]:StdDHWNoSlrSysTDVpSF  ) > 0) then  ResultSummary[4]:StdDHWNoSlrSysTDVpSF   else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:DHWSlrPVCreditFrac"     Proj:ResultSummary[1]:DHWSlrPVCreditFrac     = {  if (LocalStatus( ResultSummary[4]:DHWSlrPVCreditFrac    ) > 0) then  ResultSummary[4]:DHWSlrPVCreditFrac     else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:DHWSlrPVCreditTDV"      Proj:ResultSummary[1]:DHWSlrPVCreditTDV      = {  if (LocalStatus( ResultSummary[4]:DHWSlrPVCreditTDV     ) > 0) then  ResultSummary[4]:DHWSlrPVCreditTDV      else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:DHWSlrPVCreditElec"     Proj:ResultSummary[1]:DHWSlrPVCreditElec     = {  if (LocalStatus( ResultSummary[4]:DHWSlrPVCreditElec    ) > 0) then  ResultSummary[4]:DHWSlrPVCreditElec     else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:DHWSlrPVCreditCO2"      Proj:ResultSummary[1]:DHWSlrPVCreditCO2      = {  if (LocalStatus( ResultSummary[4]:DHWSlrPVCreditCO2     ) > 0) then  ResultSummary[4]:DHWSlrPVCreditCO2      else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:Enduse11[4]"            Proj:ResultSummary[1]:Enduse11[4]            = {  if (LocalStatus( ResultSummary[4]:Enduse11[4]           ) > 0) then  ResultSummary[4]:Enduse11[4]            else  UNDEFINED  endif  }   ;  SAC 1/22/18
	"Set worst case ResultSummary[1]:Enduse11[8]"            Proj:ResultSummary[1]:Enduse11[8]            = {  if (LocalStatus( ResultSummary[4]:Enduse11[8]           ) > 0) then  ResultSummary[4]:Enduse11[8]            else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PctSavingsCmpTDV"       Proj:ResultSummary[1]:PctSavingsCmpTDV       = {  if (LocalStatus( ResultSummary[4]:PctSavingsCmpTDV      ) > 0) then  ResultSummary[4]:PctSavingsCmpTDV       else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PctSavCmpTDVLbl"        Proj:ResultSummary[1]:PctSavCmpTDVLbl        = {  if (LocalStatus( ResultSummary[4]:PctSavCmpTDVLbl       ) > 0) then  ResultSummary[4]:PctSavCmpTDVLbl        else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PFlxElecEnergy[1]"      Proj:ResultSummary[1]:PFlxElecEnergy[1]      = {  if (LocalStatus( ResultSummary[4]:PFlxElecEnergy[1]     ) > 0) then  ResultSummary[4]:PFlxElecEnergy[1]      else  UNDEFINED  endif  }  ; SAC 2/1/19 (tic #1053)
	"Set worst case ResultSummary[1]:PFlxElecEnergy[2]"      Proj:ResultSummary[1]:PFlxElecEnergy[2]      = {  if (LocalStatus( ResultSummary[4]:PFlxElecEnergy[2]     ) > 0) then  ResultSummary[4]:PFlxElecEnergy[2]      else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PFlxNatGasEnergy[1]"    Proj:ResultSummary[1]:PFlxNatGasEnergy[1]    = {  if (LocalStatus( ResultSummary[4]:PFlxNatGasEnergy[1]   ) > 0) then  ResultSummary[4]:PFlxNatGasEnergy[1]    else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PFlxNatGasEnergy[2]"    Proj:ResultSummary[1]:PFlxNatGasEnergy[2]    = {  if (LocalStatus( ResultSummary[4]:PFlxNatGasEnergy[2]   ) > 0) then  ResultSummary[4]:PFlxNatGasEnergy[2]    else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PFlxOtherEnergy[1]"     Proj:ResultSummary[1]:PFlxOtherEnergy[1]     = {  if (LocalStatus( ResultSummary[4]:PFlxOtherEnergy[1]    ) > 0) then  ResultSummary[4]:PFlxOtherEnergy[1]     else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PFlxOtherEnergy[2]"     Proj:ResultSummary[1]:PFlxOtherEnergy[2]     = {  if (LocalStatus( ResultSummary[4]:PFlxOtherEnergy[2]    ) > 0) then  ResultSummary[4]:PFlxOtherEnergy[2]     else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PFlxTDV[1]"             Proj:ResultSummary[1]:PFlxTDV[1]             = {  if (LocalStatus( ResultSummary[4]:PFlxTDV[1]            ) > 0) then  ResultSummary[4]:PFlxTDV[1]             else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PFlxTDV[2]"             Proj:ResultSummary[1]:PFlxTDV[2]             = {  if (LocalStatus( ResultSummary[4]:PFlxTDV[2]            ) > 0) then  ResultSummary[4]:PFlxTDV[2]             else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PropDHWNames_SSF[1]"    Proj:ResultSummary[1]:PropDHWNames_SSF[1]    = {  if (LocalStatus( ResultSummary[4]:PropDHWNames_SSF[1]   ) > 0) then  ResultSummary[4]:PropDHWNames_SSF[1]    else  UNDEFINED  endif  }  ; SAC 6/23/20 (tic #1210)
	"Set worst case ResultSummary[1]:PropDHWNames_SSF[2]"    Proj:ResultSummary[1]:PropDHWNames_SSF[2]    = {  if (LocalStatus( ResultSummary[4]:PropDHWNames_SSF[2]   ) > 0) then  ResultSummary[4]:PropDHWNames_SSF[2]    else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PropDHWNames_SSF[3]"    Proj:ResultSummary[1]:PropDHWNames_SSF[3]    = {  if (LocalStatus( ResultSummary[4]:PropDHWNames_SSF[3]   ) > 0) then  ResultSummary[4]:PropDHWNames_SSF[3]    else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PropDHW_SSF[1]"         Proj:ResultSummary[1]:PropDHW_SSF[1]         = {  if (LocalStatus( ResultSummary[4]:PropDHW_SSF[1]        ) > 0) then  ResultSummary[4]:PropDHW_SSF[1]         else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PropDHW_SSF[2]"         Proj:ResultSummary[1]:PropDHW_SSF[2]         = {  if (LocalStatus( ResultSummary[4]:PropDHW_SSF[2]        ) > 0) then  ResultSummary[4]:PropDHW_SSF[2]         else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PropDHW_SSF[3]"         Proj:ResultSummary[1]:PropDHW_SSF[3]         = {  if (LocalStatus( ResultSummary[4]:PropDHW_SSF[3]        ) > 0) then  ResultSummary[4]:PropDHW_SSF[3]         else  UNDEFINED  endif  }

   "Set Proj:ResultSummary[1]:PropPV_Total kWh"       Proj:ResultSummary[1]:PropPV_Total     = {  ResultSummary[4]:PropPV_Total      }    ; SAC 12/02/20
   "Set Proj:ResultSummary[1]:PropPV_Export kWh"      Proj:ResultSummary[1]:PropPV_Export    = {  ResultSummary[4]:PropPV_Export     }
   "Set Proj:ResultSummary[1]:PropPV_PctExport %"     Proj:ResultSummary[1]:PropPV_PctExport = {  ResultSummary[4]:PropPV_PctExport  }
   "Set Proj:ResultSummary[1]:StdPV_Total kWh"        Proj:ResultSummary[1]:StdPV_Total      = {  ResultSummary[4]:StdPV_Total       }
   "Set Proj:ResultSummary[1]:StdPV_Export kWh"       Proj:ResultSummary[1]:StdPV_Export     = {  ResultSummary[4]:StdPV_Export      }
   "Set Proj:ResultSummary[1]:StdPV_PctExport %"      Proj:ResultSummary[1]:StdPV_PctExport  = {  ResultSummary[4]:StdPV_PctExport   }
   "Set Proj:ResultSummary[1]:PropDesignBattCap kWh"  Proj:ResultSummary[1]:PropDesignBattCap  = {  ResultSummary[4]:PropDesignBattCap  }    ; SAC 11/27/22
   "Set Proj:ResultSummary[1]:PropDesignBattPwr kW"   Proj:ResultSummary[1]:PropDesignBattPwr  = {  ResultSummary[4]:PropDesignBattPwr  }

   "Set Proj:ResultSummary[1]:NumPropHVACSystems"                    Proj:ResultSummary[1]:NumPropHVACSystems   = {  ResultSummary[4]:NumPropHVACSystems   }   ; SAC 03/16/21
   "Set Proj:ResultSummary[1]:NumPropHVACEquips"                     Proj:ResultSummary[1]:NumPropHVACEquips    = {  ResultSummary[4]:NumPropHVACEquips    }
   "Set Proj:ResultSummary[1]:TotalHVACHtgCap[1-10]"  for:#A=(1-10)  Proj:ResultSummary[1]:TotalHVACHtgCap[#A]  = {  ResultSummary[4]:TotalHVACHtgCap[#A]  }
   "Set Proj:ResultSummary[1]:TotalHVACClgCap[1-10]"  for:#A=(1-10)  Proj:ResultSummary[1]:TotalHVACClgCap[#A]  = {  ResultSummary[4]:TotalHVACClgCap[#A]  }
   "Set Proj:ResultSummary[1]:TotalHVACHtgCap[1]-worst"              Proj:ResultSummary[1]:TotalHVACHtgCap[1]   = {  ResultSummary[4]:TotalHVACHtgCap[4]   }
   "Set Proj:ResultSummary[1]:TotalHVACClgCap[1]-worst"              Proj:ResultSummary[1]:TotalHVACClgCap[1]   = {  ResultSummary[4]:TotalHVACClgCap[4]   }

   "Set worst case Carbon results"     Proj:Action  =       ; SAC 2/4/19 (tic #1053)
      {  if (EnergyCodeYearNum < 2019) then  UNCHANGED
         else  EvalRulelist( "CARes_RunResults_SetWorstCarbon_S" )  endif  }
END
;*************************************************************************   - SAC 6/25/13
RULELIST "CARes_RunResults_SetWorst_W" 1 0 1 1
;*************************************************************************
	"Revise 'Worst Case' EUseSummary name"			Proj:ResultSummary[1]:Name	= {	"Worst Case (W)"  }
	"Set worst case RunResults to W - SpcHt"    	Proj:RunResults[1]	= {	RunResultsW[1]    }
	"Set worst case RunResults to W - SpcCl"    	Proj:RunResults[2]	= {	RunResultsW[2]    }
	"Set worst case RunResults to W - IAQVent"  	Proj:RunResults[3]	= {	RunResultsW[3]    }
	"Set worst case RunResults to W - OthrHVAC" 	Proj:RunResults[4]	= {	RunResultsW[4]    }
	"Set worst case RunResults to W - WtrHt"    	Proj:RunResults[5]	= {	RunResultsW[5]    }
	"Set worst case RunResults to W - InsLtg"   	Proj:RunResults[6]	= {	RunResultsW[6]    }
	"Set worst case RunResults to W - AppCkg"   	Proj:RunResults[7]	= {	RunResultsW[7]    }
	"Set worst case RunResults to W - Plugs"    	Proj:RunResults[8]	= {	RunResultsW[8]    }
	"Set worst case RunResults to W - Ext"      	Proj:RunResults[9]	= {	RunResultsW[9]    }
	"Set worst case RunResults to W - PV"      	Proj:RunResults[13]	= {	RunResultsW[13]   }
	"Set worst case RunResults to W - Battery"  	Proj:RunResults[14]	= {	RunResultsW[14]   }
	"Set worst case RunResults to W - Total"    	Proj:RunResults[10]	= {	RunResultsW[10]   }
	"Set worst case RunResults to W - Comp Ttl"  Proj:RunResults[11]	= {	RunResultsW[11]   }
	"Set worst case ResultSummary[1]:ResultsAnalysisVer"     Proj:ResultSummary[1]:ResultsAnalysisVer     = {  ResultSummary[5]:ResultsAnalysisVer  }  ; SAC 11/28/22
	"Set worst case ResultSummary[1]:AllOrientations"        Proj:ResultSummary[1]:AllOrientations        = {  ResultSummary[5]:AllOrientations     }
	"Set worst case ResultSummary[1]:PropInputPVMult"        Proj:ResultSummary[1]:PropInputPVMult        = {  ResultSummary[5]:PropInputPVMult      }  ; SAC 1/12/18
	"Set worst case ResultSummary[1]:PropPVScaleFactor"      Proj:ResultSummary[1]:PropPVScaleFactor      = {  ResultSummary[5]:PropPVScaleFactor    }  ; SAC 6/13/17
	"Set worst case ResultSummary[1]:NetSurpPVProduction"    Proj:ResultSummary[1]:NetSurpPVProduction    = {  ResultSummary[5]:NetSurpPVProduction  }
	"Set worst case ResultSummary[1]:UnscaledPropPVRatio"    Proj:ResultSummary[1]:UnscaledPropPVRatio    = {  ResultSummary[5]:UnscaledPropPVRatio  }
   "Set worst case ResultSummary[1]:StdDesignPVSize"        Proj:ResultSummary[1]:StdDesignPVSize        = {  ResultSummary[5]:StdDesignPVSize  }    ; SAC 1/7/18
   "Set worst case ResultSummary[1]:DesignRating"           Proj:ResultSummary[1]:DesignRating           = {  ResultSummary[5]:DesignRating           }
   "Set worst case ResultSummary[1]:DesignRatingNoPV"       Proj:ResultSummary[1]:DesignRatingNoPV       = {  ResultSummary[5]:DesignRatingNoPV       }
   "Set worst case ResultSummary[1]:DesignRatingPVOnly"     Proj:ResultSummary[1]:DesignRatingPVOnly     = {  ResultSummary[5]:DesignRatingPVOnly     }
   "Set worst case ResultSummary[1]:DesignRatingStd"        Proj:ResultSummary[1]:DesignRatingStd        = {  ResultSummary[5]:DesignRatingStd        }
   "Set worst case ResultSummary[1]:DesignRatingStdNoPV"    Proj:ResultSummary[1]:DesignRatingStdNoPV    = {  ResultSummary[5]:DesignRatingStdNoPV    }
   "Set worst case ResultSummary[1]:DesignRatingStdPVOnly"  Proj:ResultSummary[1]:DesignRatingStdPVOnly  = {  ResultSummary[5]:DesignRatingStdPVOnly  }
   "Set worst case ResultSummary[1]:Enduse98[15]"           Proj:ResultSummary[1]:Enduse98[15]           = {  if (LocalStatus( ResultSummary[5]:Enduse98[15]          ) > 0) then  ResultSummary[5]:Enduse98[15]           else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse99[15]"           Proj:ResultSummary[1]:Enduse99[15]           = {  if (LocalStatus( ResultSummary[5]:Enduse99[15]          ) > 0) then  ResultSummary[5]:Enduse99[15]           else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:Enduse14[15]"           Proj:ResultSummary[1]:Enduse14[15]           = {  if (LocalStatus( ResultSummary[5]:Enduse14[15]          ) > 0) then  ResultSummary[5]:Enduse14[15]           else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse98[17]"           Proj:ResultSummary[1]:Enduse98[17]           = {  if (LocalStatus( ResultSummary[5]:Enduse98[17]          ) > 0) then  ResultSummary[5]:Enduse98[17]           else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse99[17]"           Proj:ResultSummary[1]:Enduse99[17]           = {  if (LocalStatus( ResultSummary[5]:Enduse99[17]          ) > 0) then  ResultSummary[5]:Enduse99[17]           else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:Enduse14[17]"           Proj:ResultSummary[1]:Enduse14[17]           = {  if (LocalStatus( ResultSummary[5]:Enduse14[17]          ) > 0) then  ResultSummary[5]:Enduse14[17]           else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse98[19]"           Proj:ResultSummary[1]:Enduse98[19]           = {  if (LocalStatus( ResultSummary[5]:Enduse98[19]          ) > 0) then  ResultSummary[5]:Enduse98[19]           else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse99[19]"           Proj:ResultSummary[1]:Enduse99[19]           = {  if (LocalStatus( ResultSummary[5]:Enduse99[19]          ) > 0) then  ResultSummary[5]:Enduse99[19]           else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:Enduse14[19]"           Proj:ResultSummary[1]:Enduse14[19]           = {  if (LocalStatus( ResultSummary[5]:Enduse14[19]          ) > 0) then  ResultSummary[5]:Enduse14[19]           else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse98[8]"            Proj:ResultSummary[1]:Enduse98[8]            = {  if (LocalStatus( ResultSummary[5]:Enduse98[8]           ) > 0) then  ResultSummary[5]:Enduse98[8]            else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse99[8]"            Proj:ResultSummary[1]:Enduse99[8]            = {  if (LocalStatus( ResultSummary[5]:Enduse99[8]           ) > 0) then  ResultSummary[5]:Enduse99[8]            else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:Enduse14[8]"            Proj:ResultSummary[1]:Enduse14[8]            = {  if (LocalStatus( ResultSummary[5]:Enduse14[8]           ) > 0) then  ResultSummary[5]:Enduse14[8]            else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse98[2]"            Proj:ResultSummary[1]:Enduse98[2]            = {  if (LocalStatus( ResultSummary[5]:Enduse98[2]           ) > 0) then  ResultSummary[5]:Enduse98[2]            else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse99[2]"            Proj:ResultSummary[1]:Enduse99[2]            = {  if (LocalStatus( ResultSummary[5]:Enduse99[2]           ) > 0) then  ResultSummary[5]:Enduse99[2]            else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:Enduse14[2]"            Proj:ResultSummary[1]:Enduse14[2]            = {  if (LocalStatus( ResultSummary[5]:Enduse14[2]           ) > 0) then  ResultSummary[5]:Enduse14[2]            else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse98[4]"            Proj:ResultSummary[1]:Enduse98[4]            = {  if (LocalStatus( ResultSummary[5]:Enduse98[4]           ) > 0) then  ResultSummary[5]:Enduse98[4]            else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:Enduse99[4]"            Proj:ResultSummary[1]:Enduse99[4]            = {  if (LocalStatus( ResultSummary[5]:Enduse99[4]           ) > 0) then  ResultSummary[5]:Enduse99[4]            else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:Enduse14[4]"            Proj:ResultSummary[1]:Enduse14[4]            = {  if (LocalStatus( ResultSummary[5]:Enduse14[4]           ) > 0) then  ResultSummary[5]:Enduse14[4]            else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:ResultsNotes[1]"        Proj:ResultSummary[1]:ResultsNotes[1]        = {  if (LocalStatus( ResultSummary[5]:ResultsNotes[1]       ) > 0) then  ResultSummary[5]:ResultsNotes[1]        else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:HaveResultsNotesPV[1]"  Proj:ResultSummary[1]:HaveResultsNotesPV[1]  = {  if (LocalStatus( ResultSummary[5]:HaveResultsNotesPV[1] ) > 0) then  ResultSummary[5]:HaveResultsNotesPV[1]  else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:ResultsNotes[2]"        Proj:ResultSummary[1]:ResultsNotes[2]        = {  if (LocalStatus( ResultSummary[5]:ResultsNotes[2]       ) > 0) then  ResultSummary[5]:ResultsNotes[2]        else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:HaveResultsNotesPV[2]"  Proj:ResultSummary[1]:HaveResultsNotesPV[2]  = {  if (LocalStatus( ResultSummary[5]:HaveResultsNotesPV[2] ) > 0) then  ResultSummary[5]:HaveResultsNotesPV[2]  else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:ResultsNotes[3]"        Proj:ResultSummary[1]:ResultsNotes[3]        = {  if (LocalStatus( ResultSummary[5]:ResultsNotes[3]       ) > 0) then  ResultSummary[5]:ResultsNotes[3]        else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:HaveResultsNotesPV[3]"  Proj:ResultSummary[1]:HaveResultsNotesPV[3]  = {  if (LocalStatus( ResultSummary[5]:HaveResultsNotesPV[3] ) > 0) then  ResultSummary[5]:HaveResultsNotesPV[3]  else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:ResultsNotes[4]"        Proj:ResultSummary[1]:ResultsNotes[4]        = {  if (LocalStatus( ResultSummary[5]:ResultsNotes[4]       ) > 0) then  ResultSummary[5]:ResultsNotes[4]        else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:HaveResultsNotesPV[4]"  Proj:ResultSummary[1]:HaveResultsNotesPV[4]  = {  if (LocalStatus( ResultSummary[5]:HaveResultsNotesPV[4] ) > 0) then  ResultSummary[5]:HaveResultsNotesPV[4]  else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:ResultsNotes[5]"        Proj:ResultSummary[1]:ResultsNotes[5]        = {  if (LocalStatus( ResultSummary[5]:ResultsNotes[5]       ) > 0) then  ResultSummary[5]:ResultsNotes[5]        else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:HaveResultsNotesPV[5]"  Proj:ResultSummary[1]:HaveResultsNotesPV[5]  = {  if (LocalStatus( ResultSummary[5]:HaveResultsNotesPV[5] ) > 0) then  ResultSummary[5]:HaveResultsNotesPV[5]  else  UNDEFINED  endif  }
   "Set worst case ResultSummary[1]:ResultsNotes[6]"        Proj:ResultSummary[1]:ResultsNotes[6]        = {  if (LocalStatus( ResultSummary[5]:ResultsNotes[6]       ) > 0) then  ResultSummary[5]:ResultsNotes[6]        else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:HaveResultsNotesPV[6]"  Proj:ResultSummary[1]:HaveResultsNotesPV[6]  = {  if (LocalStatus( ResultSummary[5]:HaveResultsNotesPV[6] ) > 0) then  ResultSummary[5]:HaveResultsNotesPV[6]  else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:GHCEnergyEffCap"        Proj:ResultSummary[1]:GHCEnergyEffCap        = {  if (LocalStatus( ResultSummary[5]:GHCEnergyEffCap       ) > 0) then  ResultSummary[5]:GHCEnergyEffCap        else  UNDEFINED  endif  }   ; SAC 1/12/18
	"Set worst case ResultSummary[1]:GHCEnergyEffTDV"        Proj:ResultSummary[1]:GHCEnergyEffTDV        = {  if (LocalStatus( ResultSummary[5]:GHCEnergyEffTDV       ) > 0) then  ResultSummary[5]:GHCEnergyEffTDV        else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:GHCEnergyEffElec"       Proj:ResultSummary[1]:GHCEnergyEffElec       = {  if (LocalStatus( ResultSummary[5]:GHCEnergyEffElec      ) > 0) then  ResultSummary[5]:GHCEnergyEffElec       else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:GHCEnergyEffBattFrac"   Proj:ResultSummary[1]:GHCEnergyEffBattFrac   = {  if (LocalStatus( ResultSummary[5]:GHCEnergyEffBattFrac  ) > 0) then  ResultSummary[5]:GHCEnergyEffBattFrac   else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:GHCEnergyEffCO2"        Proj:ResultSummary[1]:GHCEnergyEffCO2        = {  if (LocalStatus( ResultSummary[5]:GHCEnergyEffCO2       ) > 0) then  ResultSummary[5]:GHCEnergyEffCO2        else  UNDEFINED  endif  }   ; SAC 1/27/18
	"Set worst case ResultSummary[1]:StdDHWNoSlrSysEnergy"   Proj:ResultSummary[1]:StdDHWNoSlrSysEnergy   = {  if (LocalStatus( ResultSummary[5]:StdDHWNoSlrSysEnergy  ) > 0) then  ResultSummary[5]:StdDHWNoSlrSysEnergy   else  UNDEFINED  endif  }   ; SAC 5/5/20
	"Set worst case ResultSummary[1]:StdDHWNoSlrSysTDV"      Proj:ResultSummary[1]:StdDHWNoSlrSysTDV      = {  if (LocalStatus( ResultSummary[5]:StdDHWNoSlrSysTDV     ) > 0) then  ResultSummary[5]:StdDHWNoSlrSysTDV      else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:StdDHWNoSlrSysTotTDV"   Proj:ResultSummary[1]:StdDHWNoSlrSysTotTDV   = {  if (LocalStatus( ResultSummary[5]:StdDHWNoSlrSysTotTDV  ) > 0) then  ResultSummary[5]:StdDHWNoSlrSysTotTDV   else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:StdDHWNoSlrSysTDVpSF"   Proj:ResultSummary[1]:StdDHWNoSlrSysTDVpSF   = {  if (LocalStatus( ResultSummary[5]:StdDHWNoSlrSysTDVpSF  ) > 0) then  ResultSummary[5]:StdDHWNoSlrSysTDVpSF   else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:DHWSlrPVCreditFrac"     Proj:ResultSummary[1]:DHWSlrPVCreditFrac     = {  if (LocalStatus( ResultSummary[5]:DHWSlrPVCreditFrac    ) > 0) then  ResultSummary[5]:DHWSlrPVCreditFrac     else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:DHWSlrPVCreditTDV"      Proj:ResultSummary[1]:DHWSlrPVCreditTDV      = {  if (LocalStatus( ResultSummary[5]:DHWSlrPVCreditTDV     ) > 0) then  ResultSummary[5]:DHWSlrPVCreditTDV      else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:DHWSlrPVCreditElec"     Proj:ResultSummary[1]:DHWSlrPVCreditElec     = {  if (LocalStatus( ResultSummary[5]:DHWSlrPVCreditElec    ) > 0) then  ResultSummary[5]:DHWSlrPVCreditElec     else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:DHWSlrPVCreditCO2"      Proj:ResultSummary[1]:DHWSlrPVCreditCO2      = {  if (LocalStatus( ResultSummary[5]:DHWSlrPVCreditCO2     ) > 0) then  ResultSummary[5]:DHWSlrPVCreditCO2      else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:Enduse11[4]"            Proj:ResultSummary[1]:Enduse11[4]            = {  if (LocalStatus( ResultSummary[5]:Enduse11[4]           ) > 0) then  ResultSummary[5]:Enduse11[4]            else  UNDEFINED  endif  }   ;  SAC 1/22/18
	"Set worst case ResultSummary[1]:Enduse11[8]"            Proj:ResultSummary[1]:Enduse11[8]            = {  if (LocalStatus( ResultSummary[5]:Enduse11[8]           ) > 0) then  ResultSummary[5]:Enduse11[8]            else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PctSavingsCmpTDV"       Proj:ResultSummary[1]:PctSavingsCmpTDV       = {  if (LocalStatus( ResultSummary[5]:PctSavingsCmpTDV      ) > 0) then  ResultSummary[5]:PctSavingsCmpTDV       else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PctSavCmpTDVLbl"        Proj:ResultSummary[1]:PctSavCmpTDVLbl        = {  if (LocalStatus( ResultSummary[5]:PctSavCmpTDVLbl       ) > 0) then  ResultSummary[5]:PctSavCmpTDVLbl        else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PFlxElecEnergy[1]"      Proj:ResultSummary[1]:PFlxElecEnergy[1]      = {  if (LocalStatus( ResultSummary[5]:PFlxElecEnergy[1]     ) > 0) then  ResultSummary[5]:PFlxElecEnergy[1]      else  UNDEFINED  endif  }  ; SAC 2/1/19 (tic #1053)
	"Set worst case ResultSummary[1]:PFlxElecEnergy[2]"      Proj:ResultSummary[1]:PFlxElecEnergy[2]      = {  if (LocalStatus( ResultSummary[5]:PFlxElecEnergy[2]     ) > 0) then  ResultSummary[5]:PFlxElecEnergy[2]      else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PFlxNatGasEnergy[1]"    Proj:ResultSummary[1]:PFlxNatGasEnergy[1]    = {  if (LocalStatus( ResultSummary[5]:PFlxNatGasEnergy[1]   ) > 0) then  ResultSummary[5]:PFlxNatGasEnergy[1]    else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PFlxNatGasEnergy[2]"    Proj:ResultSummary[1]:PFlxNatGasEnergy[2]    = {  if (LocalStatus( ResultSummary[5]:PFlxNatGasEnergy[2]   ) > 0) then  ResultSummary[5]:PFlxNatGasEnergy[2]    else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PFlxOtherEnergy[1]"     Proj:ResultSummary[1]:PFlxOtherEnergy[1]     = {  if (LocalStatus( ResultSummary[5]:PFlxOtherEnergy[1]    ) > 0) then  ResultSummary[5]:PFlxOtherEnergy[1]     else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PFlxOtherEnergy[2]"     Proj:ResultSummary[1]:PFlxOtherEnergy[2]     = {  if (LocalStatus( ResultSummary[5]:PFlxOtherEnergy[2]    ) > 0) then  ResultSummary[5]:PFlxOtherEnergy[2]     else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PFlxTDV[1]"             Proj:ResultSummary[1]:PFlxTDV[1]             = {  if (LocalStatus( ResultSummary[5]:PFlxTDV[1]            ) > 0) then  ResultSummary[5]:PFlxTDV[1]             else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PFlxTDV[2]"             Proj:ResultSummary[1]:PFlxTDV[2]             = {  if (LocalStatus( ResultSummary[5]:PFlxTDV[2]            ) > 0) then  ResultSummary[5]:PFlxTDV[2]             else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PropDHWNames_SSF[1]"    Proj:ResultSummary[1]:PropDHWNames_SSF[1]    = {  if (LocalStatus( ResultSummary[5]:PropDHWNames_SSF[1]   ) > 0) then  ResultSummary[5]:PropDHWNames_SSF[1]    else  UNDEFINED  endif  }  ; SAC 6/23/20 (tic #1210)
	"Set worst case ResultSummary[1]:PropDHWNames_SSF[2]"    Proj:ResultSummary[1]:PropDHWNames_SSF[2]    = {  if (LocalStatus( ResultSummary[5]:PropDHWNames_SSF[2]   ) > 0) then  ResultSummary[5]:PropDHWNames_SSF[2]    else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PropDHWNames_SSF[3]"    Proj:ResultSummary[1]:PropDHWNames_SSF[3]    = {  if (LocalStatus( ResultSummary[5]:PropDHWNames_SSF[3]   ) > 0) then  ResultSummary[5]:PropDHWNames_SSF[3]    else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PropDHW_SSF[1]"         Proj:ResultSummary[1]:PropDHW_SSF[1]         = {  if (LocalStatus( ResultSummary[5]:PropDHW_SSF[1]        ) > 0) then  ResultSummary[5]:PropDHW_SSF[1]         else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PropDHW_SSF[2]"         Proj:ResultSummary[1]:PropDHW_SSF[2]         = {  if (LocalStatus( ResultSummary[5]:PropDHW_SSF[2]        ) > 0) then  ResultSummary[5]:PropDHW_SSF[2]         else  UNDEFINED  endif  }
	"Set worst case ResultSummary[1]:PropDHW_SSF[3]"         Proj:ResultSummary[1]:PropDHW_SSF[3]         = {  if (LocalStatus( ResultSummary[5]:PropDHW_SSF[3]        ) > 0) then  ResultSummary[5]:PropDHW_SSF[3]         else  UNDEFINED  endif  }

   "Set Proj:ResultSummary[1]:PropPV_Total kWh"       Proj:ResultSummary[1]:PropPV_Total     = {  ResultSummary[5]:PropPV_Total      }    ; SAC 12/02/20
   "Set Proj:ResultSummary[1]:PropPV_Export kWh"      Proj:ResultSummary[1]:PropPV_Export    = {  ResultSummary[5]:PropPV_Export     }
   "Set Proj:ResultSummary[1]:PropPV_PctExport %"     Proj:ResultSummary[1]:PropPV_PctExport = {  ResultSummary[5]:PropPV_PctExport  }
   "Set Proj:ResultSummary[1]:StdPV_Total kWh"        Proj:ResultSummary[1]:StdPV_Total      = {  ResultSummary[5]:StdPV_Total       }
   "Set Proj:ResultSummary[1]:StdPV_Export kWh"       Proj:ResultSummary[1]:StdPV_Export     = {  ResultSummary[5]:StdPV_Export      }
   "Set Proj:ResultSummary[1]:StdPV_PctExport %"      Proj:ResultSummary[1]:StdPV_PctExport  = {  ResultSummary[5]:StdPV_PctExport   }
   "Set Proj:ResultSummary[1]:PropDesignBattCap kWh"  Proj:ResultSummary[1]:PropDesignBattCap  = {  ResultSummary[5]:PropDesignBattCap  }    ; SAC 11/27/22
   "Set Proj:ResultSummary[1]:PropDesignBattPwr kW"   Proj:ResultSummary[1]:PropDesignBattPwr  = {  ResultSummary[5]:PropDesignBattPwr  }

   "Set Proj:ResultSummary[1]:NumPropHVACSystems"                    Proj:ResultSummary[1]:NumPropHVACSystems   = {  ResultSummary[5]:NumPropHVACSystems   }   ; SAC 03/16/21
   "Set Proj:ResultSummary[1]:NumPropHVACEquips"                     Proj:ResultSummary[1]:NumPropHVACEquips    = {  ResultSummary[5]:NumPropHVACEquips    }
   "Set Proj:ResultSummary[1]:TotalHVACHtgCap[1-10]"  for:#A=(1-10)  Proj:ResultSummary[1]:TotalHVACHtgCap[#A]  = {  ResultSummary[5]:TotalHVACHtgCap[#A]  }
   "Set Proj:ResultSummary[1]:TotalHVACClgCap[1-10]"  for:#A=(1-10)  Proj:ResultSummary[1]:TotalHVACClgCap[#A]  = {  ResultSummary[5]:TotalHVACClgCap[#A]  }
   "Set Proj:ResultSummary[1]:TotalHVACHtgCap[1]-worst"              Proj:ResultSummary[1]:TotalHVACHtgCap[1]   = {  ResultSummary[5]:TotalHVACHtgCap[5]   }
   "Set Proj:ResultSummary[1]:TotalHVACClgCap[1]-worst"              Proj:ResultSummary[1]:TotalHVACClgCap[1]   = {  ResultSummary[5]:TotalHVACClgCap[5]   }

   "Set worst case Carbon results"     Proj:Action  =       ; SAC 2/4/19 (tic #1053)
      {  if (EnergyCodeYearNum < 2019) then  UNCHANGED
         else  EvalRulelist( "CARes_RunResults_SetWorstCarbon_W" )  endif  }
END
;*************************************************************************


;*************************************************************************
RULELIST "CARes_ProposedSummary" 1 0 1 1
;*************************************************************************
; SAC 12/21/17 - moved into CARes_Refresh_RunResults
;	"Blast all EUseSummary components if this is the first run of an analysis"	Proj:Action	= {	DeleteAllComps( EUseSummary )  }
;	"Create energy use summary component"				Proj:ResultSummary[1]					= {	CreateComp( EUseSummary, "EUSummary" )  }
;	"Set parent for energy use summary"					Proj:ResultSummary[1]:Parent			= {	Local( Name )  }
;	"Set ProjAssignFirst for energy use summary"		Proj:ResultSummary[1]:ProjAssignFirst	= {	1  }		; SAC 3/3/16 - tic #609

;"debugging"  Proj:Action = {
;      if (LocalStatus( TargetDesignRtg ) > 0)
;      then  PostMessageToLog( "   Testing for need to scale PV:  ScalePropPVResults = %g / MaxPropPVRatio = %g / PVResults:PropElecEnergy[1] = %g / TotResults:PropElecEnergy[1] = %g / TargetDesignRtg = %g", 
;                     ValidOr( ScalePropPVResults, -99 ), ValidOr( MaxPropPVRatio, -99 ), ValidOr( RunResults[13]:PropElecEnergy[1], -99 ), ValidOr( RunResults[10]:PropElecEnergy[1], -99 ), TargetDesignRtg )
;      else  PostMessageToLog( "   Testing for need to scale PV:  ScalePropPVResults = %g / MaxPropPVRatio = %g / PVResults:PropElecEnergy[1] = %g / TotResults:PropElecEnergy[1] = %g / TargetDesignRtg = (undefined) /  %g > %g?", 
;                     ValidOr( ScalePropPVResults, -99 ), ValidOr( MaxPropPVRatio, -99 ), ValidOr( RunResults[13]:PropElecEnergy[1], -99 ), ValidOr( RunResults[10]:PropElecEnergy[1], -99 ),
;                     (MaxPropPVRatio * (RunResults[10]:PropElecEnergy[1] - RunResults[13]:PropElecEnergy[1])), (-1 * RunResults[13]:PropElecEnergy[1]) )
;      endif  }
;"debugging - store BEMProc details"		Proj:Action = {  StoreBEMProc( "B4ScalePropTDV", 0 )  }


;"debugging"  Proj:Action = {  PostMessageToLog( "      ScalePropPVResults: %g", ValidOr( ScalePropPVResults, -999 ) )  }
;"debugging"  Proj:Action = {  PostMessageToLog( "      MaxPropPVRatio:     %g", ValidOr( MaxPropPVRatio, -999 ) )  }
;"debugging"  Proj:Action = {  PostMessageToLog( "      RunResults[13]:PropElecEnergy[1]: %g", ValidOr( RunResults[13]:PropElecEnergy[1], -999 ) )  }
;"debugging"  Proj:Action = {  PostMessageToLog( "      RunResults[10]:PropElecEnergy[1]: %g", ValidOr( RunResults[10]:PropElecEnergy[1], -999 ) )  }

   "Set Proj:ResultSummary[1]:UnscaledPropPVRatio"   Proj:ResultSummary[1]:UnscaledPropPVRatio  = {
         if (IfValidAnd( ScalePropPVResults > 0.5 )==0 .OR.
             IfValidAnd( MaxPropPVRatio >= 0 )==0 .OR.
             IfValidAnd( RunResults[13]:PropElecEnergy[1] < 0 )==0 .OR.
             LocalStatus( RunResults[10]:PropElecEnergy[1] ) < 1) then  UNDEFINED
         else if (CompCodeBase == 2016)
         then  (-1 * RunResults[13]:PropElecEnergy[1] / min( 1, ValidOr( PVWDCSizeMultiplier[1], 1 ) )) /
                RunResults[10]:PropElecEnergy[1]
         else if (CompCodeBase >= 2019)
         then  (-1 * RunResults[13]:PropElecEnergy[1] / min( 1, ValidOr( PVWDCSizeMultiplier[1], 1 ) )) /
               (RunResults[10]:PropElecEnergy[1] - RunResults[13]:PropElecEnergy[1])
         else  UNDEFINED  endif endif endif  }

;"debugging"  Proj:Action = {  PostMessageToLog( "      UnscaledPropPVRatio: %g", ValidOr( ResultSummary[1]:UnscaledPropPVRatio, -999 ) )  }
;"debugging"  Proj:Action = {  PostMessageToLog( "      ValidOr( UnscaledPropPVRatio, 0 ): %g", ValidOr( ValidOr( ResultSummary[1]:UnscaledPropPVRatio, 0 ), -999 ) )  }
;"debugging"  Proj:Action = {  PostMessageToLog( "      ValidOr( MaxPropPVRatio,      1 ): %g", ValidOr( ValidOr( MaxPropPVRatio, 1 ), -999 ) )  }

;"Debug log msg"   Proj:Action  = {
;   if (IfValidAnd( ScalePropPVResults > 0.5 )==0 .OR. IfValidAnd( MaxPropPVRatio >= 0 )==0 .OR. IfValidAnd( RunResults[13]:PropElecEnergy[1] < 0 )==0) then  UNCHANGED
;   else if (CompCodeBase == 2016)
;   then  if (IfValidAnd( RunResults[10]:PropElecEnergy[1] != 0 )==0)
;         then  PostMessageToLog( "   Scale PV check:   currentPVRatio = <infinite>  |  Unscld = %.3f  |  Max = %.2f  |  TargetDRtgIterNum = %.0f of Max %.0f  |  PVWDCSizeMultiplier[1] = %.3f",
;                                                                                                 ResultSummary[1]:UnscaledPropPVRatio, MaxPropPVRatio, TargetDRtgIterNum, TargetDRtgMaxIter, ValidOr( PVWDCSizeMultiplier[1], -1 ), ValidOr( PVWDCSizeMultiplier[2], -1 ) )
;         else  PostMessageToLog( "   Scale PV check:   currentPVRatio = %.3f  |  Unscld = %.3f  |  Max = %.2f  |  TargetDRtgIterNum = %.0f of Max %.0f  |  PVWDCSizeMultiplier[1] = %.3f",
;                     (-1 * RunResults[13]:PropElecEnergy[1]) / RunResults[10]:PropElecEnergy[1], ResultSummary[1]:UnscaledPropPVRatio, MaxPropPVRatio, TargetDRtgIterNum, TargetDRtgMaxIter, ValidOr( PVWDCSizeMultiplier[1], -1 ), ValidOr( PVWDCSizeMultiplier[2], -1 ) )
;         endif
;   else if (CompCodeBase == 2019)
;   then  if (ValidOr( RunResults[10]:PropElecEnergy[1], -999 ) == ValidOr( RunResults[13]:PropElecEnergy[1], 999 ))
;         then  PostMessageToLog( "   Scale PV check:   currentPVRatio = <infinite>  |  Unscld = %.3f  |  Max = %.2f  |  TargetDRtgIterNum = %.0f of Max %.0f  |  PVWDCSizeMultiplier[1] = %.3f",
;                                                                                                 ResultSummary[1]:UnscaledPropPVRatio, MaxPropPVRatio, TargetDRtgIterNum, TargetDRtgMaxIter, ValidOr( PVWDCSizeMultiplier[1], -1 ), ValidOr( PVWDCSizeMultiplier[2], -1 ) )
;         else  PostMessageToLog( "   Scale PV check:   currentPVRatio = %.3f  |  Unscld = %.3f  |  Max = %.2f  |  TargetDRtgIterNum = %.0f of Max %.0f  |  PVWDCSizeMultiplier[1] = %.3f",
;                     (-1 * RunResults[13]:PropElecEnergy[1]) / (RunResults[10]:PropElecEnergy[1] - RunResults[13]:PropElecEnergy[1]), ResultSummary[1]:UnscaledPropPVRatio, MaxPropPVRatio, TargetDRtgIterNum, TargetDRtgMaxIter, ValidOr( PVWDCSizeMultiplier[1], -1 ), ValidOr( PVWDCSizeMultiplier[2], -1 ) )
;         endif
;   else  UNCHANGED  endif endif endif  }

   "Init PropPVScaleFactor"   Proj:ResultSummary[1]:PropPVScaleFactor  = {  UNDEFINED  }
   ; SAC 4/17/17 - added logic to prevent scaling Proposed PV here if Target EDR processing is activated
   ; SAC 4/27/17 - added 2016 logic (PV not added into Total @ this point
   ; SAC 12/30/17 - added 2019 logic to prevent PV scaling when PrelimProposed simulation already run, resulting in scaled PV in final Prop run
   "Scale Proposed PV & Battery if necessary"      Proj:Action  = {
         if (ValidOr( ResultSummary[1]:UnscaledPropPVRatio, -999 ) <= ValidOr( MaxPropPVRatio, 1 )) then  UNCHANGED
         else if (CompCodeBase == 2016)
         then  EvalRulelist( "CARes_ProposedSummary_ScalePV_2016" )
         else if (CompCodeBase >= 2019)
         then  if (LocalStatus( TargetDesignRtg ) > 0 .OR. IfValidAnd( ResultSummary[1]:PropInputPVMult > 0 ))
               then  UNCHANGED
            ;   then  if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0) then  UNCHANGED   - removed NSC adjustment during TEDR processing since final run ultimately will be clipped @ the max PV size
            ;         else  EvalRulelist( "CARes_ProposedSummary_TargetEDR_NetSurpComp" )  endif
               else  EvalRulelist( "CARes_ProposedSummary_ScalePV" )  endif
         else  UNCHANGED  endif endif endif  }
; SAC 5/3/17 - added calc of UnscaledPropPVRatio above and then replaced below w/ above
;   "Scale Proposed PV & Battery if necessary"      Proj:Action  = {
;         if (IfValidAnd( ScalePropPVResults > 0.5 )==0 .OR.
;             LocalStatus( TargetDesignRtg ) > 0 .OR.
;             IfValidAnd( MaxPropPVRatio >= 0 )==0 .OR.
;             IfValidAnd( RunResults[13]:PropElecEnergy[1] < 0 )==0 .OR.
;             LocalStatus( RunResults[10]:PropElecEnergy[1] ) < 1) then  UNCHANGED
;         else if (CompCodeBase == 2016)
;         then  if ((MaxPropPVRatio * RunResults[10]:PropElecEnergy[1]) >
;                   (-1 * RunResults[13]:PropElecEnergy[1]) ) then  UNCHANGED
;               else  EvalRulelist( "CARes_ProposedSummary_ScalePV_2016" )  endif
;         else if (CompCodeBase >= 2019)
;         then  if ((MaxPropPVRatio * (RunResults[10]:PropElecEnergy[1] -
;                                      RunResults[13]:PropElecEnergy[1])) >
;                   (-1 * RunResults[13]:PropElecEnergy[1]) ) then  UNCHANGED
;               else  EvalRulelist( "CARes_ProposedSummary_ScalePV" )  endif
;         else  UNCHANGED  endif endif endif  }

         ; SAC 12/01/20 - add in PV export results (primarily for 2022 research)
   "Set Proj:ResultSummary[1]:PropPV_Total kWh"       Proj:ResultSummary[1]:PropPV_Total     =
      {  -1 * ValidOr( RunResults[13]:PropElecEnergy[1], 0 ) * CondFloorArea / 3.412  }
   "Set Proj:ResultSummary[1]:PropPV_Export kWh"      Proj:ResultSummary[1]:PropPV_Export    =
      {  if (IfValidAnd( ResultSummary[1]:PropPV_Total > 0 )==0) then  0
         else if (RunAbbrev == "u")
         then  -1 * ApplyHourlyResultMultipliers_Neg( "none", "none", 1, 1, "none", 0, 0, "User"    , "MtrElec", "Tot" ) / 3.412
         else  -1 * ApplyHourlyResultMultipliers_Neg( "none", "none", 1, 1, "none", 0, 0, "Proposed", "MtrElec", "Tot" ) / 3.412
         endif endif  }
   "Set Proj:ResultSummary[1]:PropPV_PctExport %"     Proj:ResultSummary[1]:PropPV_PctExport =
      {  if (IfValidAnd( ResultSummary[1]:PropPV_Total > 0 )==0) then  0
         else  ValidOr( ResultSummary[1]:PropPV_Export, 0 ) * 100 / ResultSummary[1]:PropPV_Total  endif  }

  ; SAC 10/2/17 - added rules to calc carbon emissions by enduse   ; prevent calling Carbon rules for User model - SAC 09/20/21
   "Call rulelist to calculate carbon emissions"   Proj:Action    = {   if (EnergyCodeYearNum < 2019 .OR. RunAbbrev == "u") then  UNCHANGED
                                                                        else  EvalRulelist( "CARes_ProposedResults_Carbon" )  endif  }

	"Call subordinate rulelist to set all EUseSummary data"		Proj:Action = {	EvalRulelist( "CARes_ProposedSummary_Main" )  }
END


;************************************************************************* - SAC 4/27/17
RULELIST "CARes_ProposedSummary_ScalePV_2016" 1 0 1 1
;*************************************************************************
   "Set PropPVScaleFactor"    Proj:ResultSummary[1]:PropPVScaleFactor  = {
         (MaxPropPVRatio * RunResults[10]:PropElecEnergy[1])
         / (-1 * RunResults[13]:PropElecEnergy[1])  }
;"debugging"  Proj:Action = {  PostMessageToLog( "   Scaling PV 2016: %g", ResultSummary[1]:PropPVScaleFactor )  }

   ; SAC 4/30/17 - added NetSurpPVProduction to implement net surplus compensation
   "Set Proj:ResultSummary[1]:NetSurpPVProduction"   Proj:ResultSummary[1]:NetSurpPVProduction  = {
         (-1 * RunResults[13]:PropElecEnergy[1] * ValidOr( CondFloorArea, 0 ) / 3.412) * (1 - ResultSummary[1]:PropPVScaleFactor)  }

; PV not included in Totals for 2016
;   ; REMOVE effect of PV on Totals
;   "Subtrct PV frm Elec   - Total"   Proj:RunResults[10]:PropElecEnergy[1]   = {  RunResults[10]:PropElecEnergy[1]  - RunResults[13]:PropElecEnergy[1]   }  ; - RunResults[14]:PropElecEnergy[1]   }
;   "Subtrct PV frm TOTAL  - Total"   Proj:RunResults[10]:PropTotalEnergy[1]  = {  RunResults[10]:PropTotalEnergy[1] - RunResults[13]:PropTotalEnergy[1]  }  ; - RunResults[14]:PropTotalEnergy[1]  }
;   "Subtrct PV frm Elec   - Total"   Proj:RunResults[10]:PropElecTDV[1]      = {  RunResults[10]:PropElecTDV[1]     - RunResults[13]:PropElecTDV[1]      }  ; - RunResults[14]:PropElecTDV[1]      }
;   "Subtrct PV frm TOTAL  - Total"   Proj:RunResults[10]:ProposedTDV[1]      = {  RunResults[10]:ProposedTDV[1]     - RunResults[13]:ProposedTDV[1]      }  ; - RunResults[14]:ProposedTDV[1]      }
;   "Subtrct PV frm Elec Demand"      Proj:RunResults[10]:PropElecDemand[1]   = {  RunResults[10]:PropElecDemand[1]  - RunResults[13]:PropElecDemand[1]   }  ; - RunResults[14]:PropElecDemand[1]   }

   ; apply PV scaling factor
   "Scale energy use - Elec   - PV"       Proj:RunResults[13]:PropElecEnergy[1]   = {  ResultSummary[1]:PropPVScaleFactor * RunResults[13]:PropElecEnergy[1]   }
   "Scale energy use - TOTAL  - PV"       Proj:RunResults[13]:PropTotalEnergy[1]  = {  ResultSummary[1]:PropPVScaleFactor * RunResults[13]:PropTotalEnergy[1]  }
;   "Scale energy use - Elec   - Battery"  Proj:RunResults[14]:PropElecEnergy[1]   = {  ResultSummary[1]:PropPVScaleFactor * RunResults[14]:PropElecEnergy[1]   }
;   "Scale energy use - TOTAL  - Battery"  Proj:RunResults[14]:PropTotalEnergy[1]  = {  ResultSummary[1]:PropPVScaleFactor * RunResults[14]:PropTotalEnergy[1]  }
   "Scale TDV - Elec   - PV"              Proj:RunResults[13]:PropElecTDV[1]      = {  ResultSummary[1]:PropPVScaleFactor * RunResults[13]:PropElecTDV[1]      }
   "Scale TDV - TOTAL  - PV"              Proj:RunResults[13]:ProposedTDV[1]      = {  ResultSummary[1]:PropPVScaleFactor * RunResults[13]:ProposedTDV[1]      }
   "Scale Elec Demand  - PV"              Proj:RunResults[13]:PropElecDemand[1]   = {  ResultSummary[1]:PropPVScaleFactor * RunResults[13]:PropElecDemand[1]   }
;   "Scale TDV - Elec   - Battery"         Proj:RunResults[14]:PropElecTDV[1]      = {  ResultSummary[1]:PropPVScaleFactor * RunResults[14]:PropElecTDV[1]      }
;   "Scale TDV - TOTAL  - Battery"         Proj:RunResults[14]:ProposedTDV[1]      = {  ResultSummary[1]:PropPVScaleFactor * RunResults[14]:ProposedTDV[1]      }
;   "Scale Elec Demand  - Battery"         Proj:RunResults[14]:PropElecDemand[1]   = {  ResultSummary[1]:PropPVScaleFactor * RunResults[14]:PropElecDemand[1]   }

   ; apply Net Surplus Compensation to PV TDV results
;"debugging"  Proj:Action = {  if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0 .OR. IfValidAnd( ResultSummary[1]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
;                              else  PostMessageToLog( "   NSC adjustment of %g (%g * %g) to scaled PV TDV of %g", ResultSummary[1]:NetSurpPVProduction * NetEnergyMeteringNSCAdj, ResultSummary[1]:NetSurpPVProduction, NetEnergyMeteringNSCAdj, (RunResults[13]:PropElecTDV[1] * CondFloorArea) )  endif  }
   "Add NSC to TDV - Elec   - PV"   Proj:RunResults[13]:PropElecTDV[1]  = {
         if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0 .OR.
             IfValidAnd( ResultSummary[1]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
         else  RunResults[13]:PropElecTDV[1] - (ResultSummary[1]:NetSurpPVProduction * NetEnergyMeteringNSCAdj / CondFloorArea)  endif  }
   "Add NSC to TDV - TOTAL  - PV"   Proj:RunResults[13]:ProposedTDV[1]  = {
         if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0 .OR.
             IfValidAnd( ResultSummary[1]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
         else  RunResults[13]:ProposedTDV[1] - (ResultSummary[1]:NetSurpPVProduction * NetEnergyMeteringNSCAdj / CondFloorArea)  endif  }

; PV not included in Totals for 2016
;   ; RE-apply PV to Totals
;   "Restore PV to Elec   - Total"    Proj:RunResults[10]:PropElecEnergy[1]   = {  RunResults[10]:PropElecEnergy[1]  + RunResults[13]:PropElecEnergy[1]   }  ; + RunResults[14]:PropElecEnergy[1]   }
;   "Restore PV to TOTAL  - Total"    Proj:RunResults[10]:PropTotalEnergy[1]  = {  RunResults[10]:PropTotalEnergy[1] + RunResults[13]:PropTotalEnergy[1]  }  ; + RunResults[14]:PropTotalEnergy[1]  }
;   "Restore PV to Elec   - Total"    Proj:RunResults[10]:PropElecTDV[1]      = {  RunResults[10]:PropElecTDV[1]     + RunResults[13]:PropElecTDV[1]      }  ; + RunResults[14]:PropElecTDV[1]      }
;   "Restore PV to TOTAL  - Total"    Proj:RunResults[10]:ProposedTDV[1]      = {  RunResults[10]:ProposedTDV[1]     + RunResults[13]:ProposedTDV[1]      }  ; + RunResults[14]:ProposedTDV[1]      }
;   "Restore PV to Elec Demand"       Proj:RunResults[10]:PropElecDemand[1]   = {  RunResults[10]:PropElecDemand[1]  + RunResults[13]:PropElecDemand[1]   }  ; + RunResults[14]:PropElecDemand[1]   }

END

;************************************************************************* - SAC 4/10/17
RULELIST "CARes_ProposedSummary_ScalePV" 1 0 1 1
;*************************************************************************
   "Set PropPVScaleFactor"    Proj:ResultSummary[1]:PropPVScaleFactor  = {
         (MaxPropPVRatio * (RunResults[10]:PropElecEnergy[1] - RunResults[13]:PropElecEnergy[1]))
         / (-1 * RunResults[13]:PropElecEnergy[1])  }
;"debugging"  Proj:Action = {  PostMessageToLog( "   Scaling PV: %g", ResultSummary[1]:PropPVScaleFactor )  }

   ; SAC 4/30/17 - added NetSurpPVProduction to implement net surplus compensation
   "Set Proj:ResultSummary[1]:NetSurpPVProduction"   Proj:ResultSummary[1]:NetSurpPVProduction  = {
         (-1 * RunResults[13]:PropElecEnergy[1] * ValidOr( CondFloorArea, 0 ) / 3.412) * (1 - ResultSummary[1]:PropPVScaleFactor)  }

;   ; first STORE PV, Battery and Totals BEFORE scaling
;	"Store pre-scaled PV EnergyUse:ProposedTDV[4]"		Proj:RunResults[13]:ProposedTDV[4]	= {	RunResults[13]:ProposedTDV[1]  }
;	"Store pre-scaled Batt EnergyUse:ProposedTDV[4]"	Proj:RunResults[14]:ProposedTDV[4]	= {	RunResults[14]:ProposedTDV[1]  }
;	"Store pre-scaled Total EnergyUse:ProposedTDV[4]"	Proj:RunResults[10]:ProposedTDV[4]	= {	RunResults[10]:ProposedTDV[1]  }

   ; then REMOVE effect of PV on Totals
   "Subtrct PV frm Elec   - Total"   Proj:RunResults[10]:PropElecEnergy[1]   = {  RunResults[10]:PropElecEnergy[1]  - RunResults[13]:PropElecEnergy[1]   }  ; - RunResults[14]:PropElecEnergy[1]   }
   "Subtrct PV frm TOTAL  - Total"   Proj:RunResults[10]:PropTotalEnergy[1]  = {  RunResults[10]:PropTotalEnergy[1] - RunResults[13]:PropTotalEnergy[1]  }  ; - RunResults[14]:PropTotalEnergy[1]  }
   "Subtrct PV frm Elec   - Total"   Proj:RunResults[10]:PropElecTDV[1]      = {  RunResults[10]:PropElecTDV[1]     - RunResults[13]:PropElecTDV[1]      }  ; - RunResults[14]:PropElecTDV[1]      }
   "Subtrct PV frm TOTAL  - Total"   Proj:RunResults[10]:ProposedTDV[1]      = {  RunResults[10]:ProposedTDV[1]     - RunResults[13]:ProposedTDV[1]      }  ; - RunResults[14]:ProposedTDV[1]      }
   "Subtrct PV frm Elec Demand"      Proj:RunResults[10]:PropElecDemand[1]   = {  RunResults[10]:PropElecDemand[1]  - RunResults[13]:PropElecDemand[1]   }  ; - RunResults[14]:PropElecDemand[1]   }

   ; apply PV scaling factor
   "Scale energy use - Elec   - PV"       Proj:RunResults[13]:PropElecEnergy[1]   = {  ResultSummary[1]:PropPVScaleFactor * RunResults[13]:PropElecEnergy[1]   }
   "Scale energy use - TOTAL  - PV"       Proj:RunResults[13]:PropTotalEnergy[1]  = {  ResultSummary[1]:PropPVScaleFactor * RunResults[13]:PropTotalEnergy[1]  }
;   "Scale energy use - Elec   - Battery"  Proj:RunResults[14]:PropElecEnergy[1]   = {  ResultSummary[1]:PropPVScaleFactor * RunResults[14]:PropElecEnergy[1]   }
;   "Scale energy use - TOTAL  - Battery"  Proj:RunResults[14]:PropTotalEnergy[1]  = {  ResultSummary[1]:PropPVScaleFactor * RunResults[14]:PropTotalEnergy[1]  }
   "Scale TDV - Elec   - PV"              Proj:RunResults[13]:PropElecTDV[1]      = {  ResultSummary[1]:PropPVScaleFactor * RunResults[13]:PropElecTDV[1]      }
   "Scale TDV - TOTAL  - PV"              Proj:RunResults[13]:ProposedTDV[1]      = {  ResultSummary[1]:PropPVScaleFactor * RunResults[13]:ProposedTDV[1]      }
   "Scale Elec Demand  - PV"              Proj:RunResults[13]:PropElecDemand[1]   = {  ResultSummary[1]:PropPVScaleFactor * RunResults[13]:PropElecDemand[1]   }
;   "Scale TDV - Elec   - Battery"         Proj:RunResults[14]:PropElecTDV[1]      = {  ResultSummary[1]:PropPVScaleFactor * RunResults[14]:PropElecTDV[1]      }
;   "Scale TDV - TOTAL  - Battery"         Proj:RunResults[14]:ProposedTDV[1]      = {  ResultSummary[1]:PropPVScaleFactor * RunResults[14]:ProposedTDV[1]      }
;   "Scale Elec Demand  - Battery"         Proj:RunResults[14]:PropElecDemand[1]   = {  ResultSummary[1]:PropPVScaleFactor * RunResults[14]:PropElecDemand[1]   }

   ; apply Net Surplus Compensation to PV TDV results
;"debugging"  Proj:Action = {  if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0 .OR. IfValidAnd( ResultSummary[1]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
;                              else  PostMessageToLog( "   NSC adjustment of %g (%g * %g) to scaled PV TDV of %g", ResultSummary[1]:NetSurpPVProduction * NetEnergyMeteringNSCAdj, ResultSummary[1]:NetSurpPVProduction, NetEnergyMeteringNSCAdj, (RunResults[13]:PropElecTDV[1] * CondFloorArea) )  endif  }
   "Add NSC to TDV - Elec   - PV"   Proj:RunResults[13]:PropElecTDV[1]  = {
         if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0 .OR.
             IfValidAnd( ResultSummary[1]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
         else  RunResults[13]:PropElecTDV[1] - (ResultSummary[1]:NetSurpPVProduction * NetEnergyMeteringNSCAdj / CondFloorArea)  endif  }
   "Add NSC to TDV - TOTAL  - PV"   Proj:RunResults[13]:ProposedTDV[1]  = {
         if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0 .OR.
             IfValidAnd( ResultSummary[1]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
         else  RunResults[13]:ProposedTDV[1] - (ResultSummary[1]:NetSurpPVProduction * NetEnergyMeteringNSCAdj / CondFloorArea)  endif  }

   ; RE-apply PV to Totals
   "Restore PV to Elec   - Total"    Proj:RunResults[10]:PropElecEnergy[1]   = {  RunResults[10]:PropElecEnergy[1]  + RunResults[13]:PropElecEnergy[1]   }  ; + RunResults[14]:PropElecEnergy[1]   }
   "Restore PV to TOTAL  - Total"    Proj:RunResults[10]:PropTotalEnergy[1]  = {  RunResults[10]:PropTotalEnergy[1] + RunResults[13]:PropTotalEnergy[1]  }  ; + RunResults[14]:PropTotalEnergy[1]  }
   "Restore PV to Elec   - Total"    Proj:RunResults[10]:PropElecTDV[1]      = {  RunResults[10]:PropElecTDV[1]     + RunResults[13]:PropElecTDV[1]      }  ; + RunResults[14]:PropElecTDV[1]      }
   "Restore PV to TOTAL  - Total"    Proj:RunResults[10]:ProposedTDV[1]      = {  RunResults[10]:ProposedTDV[1]     + RunResults[13]:ProposedTDV[1]      }  ; + RunResults[14]:ProposedTDV[1]      }
   "Restore PV to Elec Demand"       Proj:RunResults[10]:PropElecDemand[1]   = {  RunResults[10]:PropElecDemand[1]  + RunResults[13]:PropElecDemand[1]   }  ; + RunResults[14]:PropElecDemand[1]   }
END

;************************************************************************* - SAC 6/13/17 - based on 'CARes_ProposedSummary_ScalePV'
RULELIST "CARes_ProposedSummary_N_ScalePV" 1 0 1 1
;*************************************************************************
   "Set PropPVScaleFactor (N)"    Proj:ResultSummary[2]:PropPVScaleFactor  = {
         (MaxPropPVRatio * (RunResultsN[10]:PropElecEnergy[1] - RunResultsN[13]:PropElecEnergy[1]))
         / (-1 * RunResultsN[13]:PropElecEnergy[1])  }
;"debugging"  Proj:Action = {  PostMessageToLog( "   N: Scaling PV: %g", ResultSummary[2]:PropPVScaleFactor )  }

   ; SAC 4/30/17 - added NetSurpPVProduction to implement net surplus compensation
   "Set Proj:ResultSummary[2]:NetSurpPVProduction (N)"   Proj:ResultSummary[2]:NetSurpPVProduction  = {
         (-1 * RunResultsN[13]:PropElecEnergy[1] * ValidOr( CondFloorArea, 0 ) / 3.412) * (1 - ResultSummary[2]:PropPVScaleFactor)  }

;   ; first STORE PV, Battery and Totals BEFORE scaling
;	"Store pre-scaled PV EnergyUse:ProposedTDV[4]"		Proj:RunResultsN[13]:ProposedTDV[4]	= {	RunResultsN[13]:ProposedTDV[1]  }
;	"Store pre-scaled Batt EnergyUse:ProposedTDV[4]"	Proj:RunResultsN[14]:ProposedTDV[4]	= {	RunResultsN[14]:ProposedTDV[1]  }
;	"Store pre-scaled Total EnergyUse:ProposedTDV[4]"	Proj:RunResultsN[10]:ProposedTDV[4]	= {	RunResultsN[10]:ProposedTDV[1]  }

   ; then REMOVE effect of PV on Totals
   "Subtrct PV frm Elec   - Total (N)"   Proj:RunResultsN[10]:PropElecEnergy[1]   = {  RunResultsN[10]:PropElecEnergy[1]  - RunResultsN[13]:PropElecEnergy[1]   }  ; - RunResultsN[14]:PropElecEnergy[1]   }
   "Subtrct PV frm TOTAL  - Total (N)"   Proj:RunResultsN[10]:PropTotalEnergy[1]  = {  RunResultsN[10]:PropTotalEnergy[1] - RunResultsN[13]:PropTotalEnergy[1]  }  ; - RunResultsN[14]:PropTotalEnergy[1]  }
   "Subtrct PV frm Elec   - Total (N)"   Proj:RunResultsN[10]:PropElecTDV[1]      = {  RunResultsN[10]:PropElecTDV[1]     - RunResultsN[13]:PropElecTDV[1]      }  ; - RunResultsN[14]:PropElecTDV[1]      }
   "Subtrct PV frm TOTAL  - Total (N)"   Proj:RunResultsN[10]:ProposedTDV[1]      = {  RunResultsN[10]:ProposedTDV[1]     - RunResultsN[13]:ProposedTDV[1]      }  ; - RunResultsN[14]:ProposedTDV[1]      }
   "Subtrct PV frm Elec Demand (N)"      Proj:RunResultsN[10]:PropElecDemand[1]   = {  RunResultsN[10]:PropElecDemand[1]  - RunResultsN[13]:PropElecDemand[1]   }  ; - RunResultsN[14]:PropElecDemand[1]   }

   ; apply PV scaling factor
   "Scale energy use - Elec   - PV (N)"       Proj:RunResultsN[13]:PropElecEnergy[1]   = {  ResultSummary[2]:PropPVScaleFactor * RunResultsN[13]:PropElecEnergy[1]   }
   "Scale energy use - TOTAL  - PV (N)"       Proj:RunResultsN[13]:PropTotalEnergy[1]  = {  ResultSummary[2]:PropPVScaleFactor * RunResultsN[13]:PropTotalEnergy[1]  }
;   "Scale energy use - Elec   - Battery (N)"  Proj:RunResultsN[14]:PropElecEnergy[1]   = {  ResultSummary[2]:PropPVScaleFactor * RunResultsN[14]:PropElecEnergy[1]   }
;   "Scale energy use - TOTAL  - Battery (N)"  Proj:RunResultsN[14]:PropTotalEnergy[1]  = {  ResultSummary[2]:PropPVScaleFactor * RunResultsN[14]:PropTotalEnergy[1]  }
   "Scale TDV - Elec   - PV (N)"              Proj:RunResultsN[13]:PropElecTDV[1]      = {  ResultSummary[2]:PropPVScaleFactor * RunResultsN[13]:PropElecTDV[1]      }
   "Scale TDV - TOTAL  - PV (N)"              Proj:RunResultsN[13]:ProposedTDV[1]      = {  ResultSummary[2]:PropPVScaleFactor * RunResultsN[13]:ProposedTDV[1]      }
   "Scale Elec Demand  - PV (N)"              Proj:RunResultsN[13]:PropElecDemand[1]   = {  ResultSummary[2]:PropPVScaleFactor * RunResultsN[13]:PropElecDemand[1]   }
;   "Scale TDV - Elec   - Battery (N)"         Proj:RunResultsN[14]:PropElecTDV[1]      = {  ResultSummary[2]:PropPVScaleFactor * RunResultsN[14]:PropElecTDV[1]      }
;   "Scale TDV - TOTAL  - Battery (N)"         Proj:RunResultsN[14]:ProposedTDV[1]      = {  ResultSummary[2]:PropPVScaleFactor * RunResultsN[14]:ProposedTDV[1]      }
;   "Scale Elec Demand  - Battery (N)"         Proj:RunResultsN[14]:PropElecDemand[1]   = {  ResultSummary[2]:PropPVScaleFactor * RunResultsN[14]:PropElecDemand[1]   }

   ; apply Net Surplus Compensation to PV TDV results
;"debugging"  Proj:Action = {  if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0 .OR. IfValidAnd( ResultSummary[2]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
;                              else  PostMessageToLog( "   N: NSC adjustment of %g (%g * %g) to scaled PV TDV of %g", ResultSummary[2]:NetSurpPVProduction * NetEnergyMeteringNSCAdj, ResultSummary[2]:NetSurpPVProduction, NetEnergyMeteringNSCAdj, (RunResultsN[13]:PropElecTDV[1] * CondFloorArea) )  endif  }
   "Add NSC to TDV - Elec   - PV (N)"   Proj:RunResultsN[13]:PropElecTDV[1]  = {
         if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0 .OR.
             IfValidAnd( ResultSummary[2]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
         else  RunResultsN[13]:PropElecTDV[1] - (ResultSummary[2]:NetSurpPVProduction * NetEnergyMeteringNSCAdj / CondFloorArea)  endif  }
   "Add NSC to TDV - TOTAL  - PV (N)"   Proj:RunResultsN[13]:ProposedTDV[1]  = {
         if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0 .OR.
             IfValidAnd( ResultSummary[2]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
         else  RunResultsN[13]:ProposedTDV[1] - (ResultSummary[2]:NetSurpPVProduction * NetEnergyMeteringNSCAdj / CondFloorArea)  endif  }

   ; RE-apply PV to Totals
   "Restore PV to Elec   - Total (N)"    Proj:RunResultsN[10]:PropElecEnergy[1]   = {  RunResultsN[10]:PropElecEnergy[1]  + RunResultsN[13]:PropElecEnergy[1]   }  ; + RunResultsN[14]:PropElecEnergy[1]   }
   "Restore PV to TOTAL  - Total (N)"    Proj:RunResultsN[10]:PropTotalEnergy[1]  = {  RunResultsN[10]:PropTotalEnergy[1] + RunResultsN[13]:PropTotalEnergy[1]  }  ; + RunResultsN[14]:PropTotalEnergy[1]  }
   "Restore PV to Elec   - Total (N)"    Proj:RunResultsN[10]:PropElecTDV[1]      = {  RunResultsN[10]:PropElecTDV[1]     + RunResultsN[13]:PropElecTDV[1]      }  ; + RunResultsN[14]:PropElecTDV[1]      }
   "Restore PV to TOTAL  - Total (N)"    Proj:RunResultsN[10]:ProposedTDV[1]      = {  RunResultsN[10]:ProposedTDV[1]     + RunResultsN[13]:ProposedTDV[1]      }  ; + RunResultsN[14]:ProposedTDV[1]      }
   "Restore PV to Elec Demand (N)"       Proj:RunResultsN[10]:PropElecDemand[1]   = {  RunResultsN[10]:PropElecDemand[1]  + RunResultsN[13]:PropElecDemand[1]   }  ; + RunResultsN[14]:PropElecDemand[1]   }
END
;************************************************************************* - SAC 6/13/17 - based on CARes_ProposedSummary_ScalePV_2016
RULELIST "CARes_ProposedSummary_N_ScalePV_2016" 1 0 1 1
;*************************************************************************
   "Set PropPVScaleFactor (N)"    Proj:ResultSummary[2]:PropPVScaleFactor  = {
         (MaxPropPVRatio * RunResultsN[10]:PropElecEnergy[1])
         / (-1 * RunResultsN[13]:PropElecEnergy[1])  }
;"debugging"  Proj:Action = {  PostMessageToLog( "   N: Scaling PV 2016: %g", ResultSummary[2]:PropPVScaleFactor )  }

   ; SAC 4/30/17 - added NetSurpPVProduction to implement net surplus compensation
   "Set Proj:ResultSummary[2]:NetSurpPVProduction (N)"   Proj:ResultSummary[2]:NetSurpPVProduction  = {
         (-1 * RunResultsN[13]:PropElecEnergy[1] * ValidOr( CondFloorArea, 0 ) / 3.412) * (1 - ResultSummary[2]:PropPVScaleFactor)  }

   ; apply PV scaling factor
   "Scale energy use - Elec   - PV (N)"       Proj:RunResultsN[13]:PropElecEnergy[1]   = {  ResultSummary[2]:PropPVScaleFactor * RunResultsN[13]:PropElecEnergy[1]   }
   "Scale energy use - TOTAL  - PV (N)"       Proj:RunResultsN[13]:PropTotalEnergy[1]  = {  ResultSummary[2]:PropPVScaleFactor * RunResultsN[13]:PropTotalEnergy[1]  }
;   "Scale energy use - Elec   - Battery (N)"  Proj:RunResultsN[14]:PropElecEnergy[1]   = {  ResultSummary[2]:PropPVScaleFactor * RunResultsN[14]:PropElecEnergy[1]   }
;   "Scale energy use - TOTAL  - Battery (N)"  Proj:RunResultsN[14]:PropTotalEnergy[1]  = {  ResultSummary[2]:PropPVScaleFactor * RunResultsN[14]:PropTotalEnergy[1]  }
   "Scale TDV - Elec   - PV (N)"              Proj:RunResultsN[13]:PropElecTDV[1]      = {  ResultSummary[2]:PropPVScaleFactor * RunResultsN[13]:PropElecTDV[1]      }
   "Scale TDV - TOTAL  - PV (N)"              Proj:RunResultsN[13]:ProposedTDV[1]      = {  ResultSummary[2]:PropPVScaleFactor * RunResultsN[13]:ProposedTDV[1]      }
   "Scale Elec Demand  - PV (N)"              Proj:RunResultsN[13]:PropElecDemand[1]   = {  ResultSummary[2]:PropPVScaleFactor * RunResultsN[13]:PropElecDemand[1]   }
;   "Scale TDV - Elec   - Battery (N)"         Proj:RunResultsN[14]:PropElecTDV[1]      = {  ResultSummary[2]:PropPVScaleFactor * RunResultsN[14]:PropElecTDV[1]      }
;   "Scale TDV - TOTAL  - Battery (N)"         Proj:RunResultsN[14]:ProposedTDV[1]      = {  ResultSummary[2]:PropPVScaleFactor * RunResultsN[14]:ProposedTDV[1]      }
;   "Scale Elec Demand  - Battery (N)"         Proj:RunResultsN[14]:PropElecDemand[1]   = {  ResultSummary[2]:PropPVScaleFactor * RunResultsN[14]:PropElecDemand[1]   }

   ; apply Net Surplus Compensation to PV TDV results
;"debugging"  Proj:Action = {  if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0 .OR. IfValidAnd( ResultSummary[2]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
;                              else  PostMessageToLog( "   N: NSC adjustment of %g (%g * %g) to scaled PV TDV of %g", ResultSummary[2]:NetSurpPVProduction * NetEnergyMeteringNSCAdj, ResultSummary[2]:NetSurpPVProduction, NetEnergyMeteringNSCAdj, (RunResultsN[13]:PropElecTDV[1] * CondFloorArea) )  endif  }
   "Add NSC to TDV - Elec   - PV (N)"   Proj:RunResultsN[13]:PropElecTDV[1]  = {
         if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0 .OR.
             IfValidAnd( ResultSummary[2]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
         else  RunResultsN[13]:PropElecTDV[1] - (ResultSummary[2]:NetSurpPVProduction * NetEnergyMeteringNSCAdj / CondFloorArea)  endif  }
   "Add NSC to TDV - TOTAL  - PV (N)"   Proj:RunResultsN[13]:ProposedTDV[1]  = {
         if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0 .OR.
             IfValidAnd( ResultSummary[2]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
         else  RunResultsN[13]:ProposedTDV[1] - (ResultSummary[2]:NetSurpPVProduction * NetEnergyMeteringNSCAdj / CondFloorArea)  endif  }

END

;************************************************************************* - SAC 6/13/17 - based on 'CARes_ProposedSummary_ScalePV'
RULELIST "CARes_ProposedSummary_E_ScalePV" 1 0 1 1
;*************************************************************************
   "Set PropPVScaleFactor (E)"    Proj:ResultSummary[3]:PropPVScaleFactor  = {
         (MaxPropPVRatio * (RunResultsE[10]:PropElecEnergy[1] - RunResultsE[13]:PropElecEnergy[1]))
         / (-1 * RunResultsE[13]:PropElecEnergy[1])  }
;"debugging"  Proj:Action = {  PostMessageToLog( "   E: Scaling PV: %g", ResultSummary[3]:PropPVScaleFactor )  }

   ; SAC 4/30/17 - added NetSurpPVProduction to implement net surplus compensation
   "Set Proj:ResultSummary[3]:NetSurpPVProduction (E)"   Proj:ResultSummary[3]:NetSurpPVProduction  = {
         (-1 * RunResultsE[13]:PropElecEnergy[1] * ValidOr( CondFloorArea, 0 ) / 3.412) * (1 - ResultSummary[3]:PropPVScaleFactor)  }

;   ; first STORE PV, Battery and Totals BEFORE scaling
;	"Store pre-scaled PV EnergyUse:ProposedTDV[4]"		Proj:RunResultsE[13]:ProposedTDV[4]	= {	RunResultsE[13]:ProposedTDV[1]  }
;	"Store pre-scaled Batt EnergyUse:ProposedTDV[4]"	Proj:RunResultsE[14]:ProposedTDV[4]	= {	RunResultsE[14]:ProposedTDV[1]  }
;	"Store pre-scaled Total EnergyUse:ProposedTDV[4]"	Proj:RunResultsE[10]:ProposedTDV[4]	= {	RunResultsE[10]:ProposedTDV[1]  }

   ; then REMOVE effect of PV on Totals
   "Subtrct PV frm Elec   - Total (E)"   Proj:RunResultsE[10]:PropElecEnergy[1]   = {  RunResultsE[10]:PropElecEnergy[1]  - RunResultsE[13]:PropElecEnergy[1]   }  ; - RunResultsE[14]:PropElecEnergy[1]   }
   "Subtrct PV frm TOTAL  - Total (E)"   Proj:RunResultsE[10]:PropTotalEnergy[1]  = {  RunResultsE[10]:PropTotalEnergy[1] - RunResultsE[13]:PropTotalEnergy[1]  }  ; - RunResultsE[14]:PropTotalEnergy[1]  }
   "Subtrct PV frm Elec   - Total (E)"   Proj:RunResultsE[10]:PropElecTDV[1]      = {  RunResultsE[10]:PropElecTDV[1]     - RunResultsE[13]:PropElecTDV[1]      }  ; - RunResultsE[14]:PropElecTDV[1]      }
   "Subtrct PV frm TOTAL  - Total (E)"   Proj:RunResultsE[10]:ProposedTDV[1]      = {  RunResultsE[10]:ProposedTDV[1]     - RunResultsE[13]:ProposedTDV[1]      }  ; - RunResultsE[14]:ProposedTDV[1]      }
   "Subtrct PV frm Elec Demand (E)"      Proj:RunResultsE[10]:PropElecDemand[1]   = {  RunResultsE[10]:PropElecDemand[1]  - RunResultsE[13]:PropElecDemand[1]   }  ; - RunResultsE[14]:PropElecDemand[1]   }

   ; apply PV scaling factor
   "Scale energy use - Elec   - PV (E)"       Proj:RunResultsE[13]:PropElecEnergy[1]   = {  ResultSummary[3]:PropPVScaleFactor * RunResultsE[13]:PropElecEnergy[1]   }
   "Scale energy use - TOTAL  - PV (E)"       Proj:RunResultsE[13]:PropTotalEnergy[1]  = {  ResultSummary[3]:PropPVScaleFactor * RunResultsE[13]:PropTotalEnergy[1]  }
;   "Scale energy use - Elec   - Battery (E)"  Proj:RunResultsE[14]:PropElecEnergy[1]   = {  ResultSummary[3]:PropPVScaleFactor * RunResultsE[14]:PropElecEnergy[1]   }
;   "Scale energy use - TOTAL  - Battery (E)"  Proj:RunResultsE[14]:PropTotalEnergy[1]  = {  ResultSummary[3]:PropPVScaleFactor * RunResultsE[14]:PropTotalEnergy[1]  }
   "Scale TDV - Elec   - PV (E)"              Proj:RunResultsE[13]:PropElecTDV[1]      = {  ResultSummary[3]:PropPVScaleFactor * RunResultsE[13]:PropElecTDV[1]      }
   "Scale TDV - TOTAL  - PV (E)"              Proj:RunResultsE[13]:ProposedTDV[1]      = {  ResultSummary[3]:PropPVScaleFactor * RunResultsE[13]:ProposedTDV[1]      }
   "Scale Elec Demand  - PV (E)"              Proj:RunResultsE[13]:PropElecDemand[1]   = {  ResultSummary[3]:PropPVScaleFactor * RunResultsE[13]:PropElecDemand[1]   }
;   "Scale TDV - Elec   - Battery (E)"         Proj:RunResultsE[14]:PropElecTDV[1]      = {  ResultSummary[3]:PropPVScaleFactor * RunResultsE[14]:PropElecTDV[1]      }
;   "Scale TDV - TOTAL  - Battery (E)"         Proj:RunResultsE[14]:ProposedTDV[1]      = {  ResultSummary[3]:PropPVScaleFactor * RunResultsE[14]:ProposedTDV[1]      }
;   "Scale Elec Demand  - Battery (E)"         Proj:RunResultsE[14]:PropElecDemand[1]   = {  ResultSummary[3]:PropPVScaleFactor * RunResultsE[14]:PropElecDemand[1]   }

   ; apply Net Surplus Compensation to PV TDV results
;"debugging"  Proj:Action = {  if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0 .OR. IfValidAnd( ResultSummary[3]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
;                              else  PostMessageToLog( "   E: NSC adjustment of %g (%g * %g) to scaled PV TDV of %g", ResultSummary[3]:NetSurpPVProduction * NetEnergyMeteringNSCAdj, ResultSummary[3]:NetSurpPVProduction, NetEnergyMeteringNSCAdj, (RunResultsE[13]:PropElecTDV[1] * CondFloorArea) )  endif  }
   "Add NSC to TDV - Elec   - PV (E)"   Proj:RunResultsE[13]:PropElecTDV[1]  = {
         if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0 .OR.
             IfValidAnd( ResultSummary[3]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
         else  RunResultsE[13]:PropElecTDV[1] - (ResultSummary[3]:NetSurpPVProduction * NetEnergyMeteringNSCAdj / CondFloorArea)  endif  }
   "Add NSC to TDV - TOTAL  - PV (E)"   Proj:RunResultsE[13]:ProposedTDV[1]  = {
         if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0 .OR.
             IfValidAnd( ResultSummary[3]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
         else  RunResultsE[13]:ProposedTDV[1] - (ResultSummary[3]:NetSurpPVProduction * NetEnergyMeteringNSCAdj / CondFloorArea)  endif  }

   ; RE-apply PV to Totals
   "Restore PV to Elec   - Total (E)"    Proj:RunResultsE[10]:PropElecEnergy[1]   = {  RunResultsE[10]:PropElecEnergy[1]  + RunResultsE[13]:PropElecEnergy[1]   }  ; + RunResultsE[14]:PropElecEnergy[1]   }
   "Restore PV to TOTAL  - Total (E)"    Proj:RunResultsE[10]:PropTotalEnergy[1]  = {  RunResultsE[10]:PropTotalEnergy[1] + RunResultsE[13]:PropTotalEnergy[1]  }  ; + RunResultsE[14]:PropTotalEnergy[1]  }
   "Restore PV to Elec   - Total (E)"    Proj:RunResultsE[10]:PropElecTDV[1]      = {  RunResultsE[10]:PropElecTDV[1]     + RunResultsE[13]:PropElecTDV[1]      }  ; + RunResultsE[14]:PropElecTDV[1]      }
   "Restore PV to TOTAL  - Total (E)"    Proj:RunResultsE[10]:ProposedTDV[1]      = {  RunResultsE[10]:ProposedTDV[1]     + RunResultsE[13]:ProposedTDV[1]      }  ; + RunResultsE[14]:ProposedTDV[1]      }
   "Restore PV to Elec Demand (E)"       Proj:RunResultsE[10]:PropElecDemand[1]   = {  RunResultsE[10]:PropElecDemand[1]  + RunResultsE[13]:PropElecDemand[1]   }  ; + RunResultsE[14]:PropElecDemand[1]   }
END
;************************************************************************* - SAC 6/25/17 - based on CARes_ProposedSummary_ScalePV_2016
RULELIST "CARes_ProposedSummary_E_ScalePV_2016" 1 0 1 1
;*************************************************************************
   "Set PropPVScaleFactor (E)"    Proj:ResultSummary[3]:PropPVScaleFactor  = {
         (MaxPropPVRatio * RunResultsE[10]:PropElecEnergy[1])
         / (-1 * RunResultsE[13]:PropElecEnergy[1])  }
;"debugging"  Proj:Action = {  PostMessageToLog( "   N: Scaling PV 2016: %g", ResultSummary[3]:PropPVScaleFactor )  }

   ; SAC 4/30/17 - added NetSurpPVProduction to implement net surplus compensation
   "Set Proj:ResultSummary[3]:NetSurpPVProduction (E)"   Proj:ResultSummary[3]:NetSurpPVProduction  = {
         (-1 * RunResultsE[13]:PropElecEnergy[1] * ValidOr( CondFloorArea, 0 ) / 3.412) * (1 - ResultSummary[3]:PropPVScaleFactor)  }

   ; apply PV scaling factor
   "Scale energy use - Elec   - PV (E)"       Proj:RunResultsE[13]:PropElecEnergy[1]   = {  ResultSummary[3]:PropPVScaleFactor * RunResultsE[13]:PropElecEnergy[1]   }
   "Scale energy use - TOTAL  - PV (E)"       Proj:RunResultsE[13]:PropTotalEnergy[1]  = {  ResultSummary[3]:PropPVScaleFactor * RunResultsE[13]:PropTotalEnergy[1]  }
;   "Scale energy use - Elec   - Battery (E)"  Proj:RunResultsE[14]:PropElecEnergy[1]   = {  ResultSummary[3]:PropPVScaleFactor * RunResultsE[14]:PropElecEnergy[1]   }
;   "Scale energy use - TOTAL  - Battery (E)"  Proj:RunResultsE[14]:PropTotalEnergy[1]  = {  ResultSummary[3]:PropPVScaleFactor * RunResultsE[14]:PropTotalEnergy[1]  }
   "Scale TDV - Elec   - PV (E)"              Proj:RunResultsE[13]:PropElecTDV[1]      = {  ResultSummary[3]:PropPVScaleFactor * RunResultsE[13]:PropElecTDV[1]      }
   "Scale TDV - TOTAL  - PV (E)"              Proj:RunResultsE[13]:ProposedTDV[1]      = {  ResultSummary[3]:PropPVScaleFactor * RunResultsE[13]:ProposedTDV[1]      }
   "Scale Elec Demand  - PV (E)"              Proj:RunResultsE[13]:PropElecDemand[1]   = {  ResultSummary[3]:PropPVScaleFactor * RunResultsE[13]:PropElecDemand[1]   }
;   "Scale TDV - Elec   - Battery (E)"         Proj:RunResultsE[14]:PropElecTDV[1]      = {  ResultSummary[3]:PropPVScaleFactor * RunResultsE[14]:PropElecTDV[1]      }
;   "Scale TDV - TOTAL  - Battery (E)"         Proj:RunResultsE[14]:ProposedTDV[1]      = {  ResultSummary[3]:PropPVScaleFactor * RunResultsE[14]:ProposedTDV[1]      }
;   "Scale Elec Demand  - Battery (E)"         Proj:RunResultsE[14]:PropElecDemand[1]   = {  ResultSummary[3]:PropPVScaleFactor * RunResultsE[14]:PropElecDemand[1]   }

   ; apply Net Surplus Compensation to PV TDV results
;"debugging"  Proj:Action = {  if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0 .OR. IfValidAnd( ResultSummary[3]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
;                              else  PostMessageToLog( "   N: NSC adjustment of %g (%g * %g) to scaled PV TDV of %g", ResultSummary[3]:NetSurpPVProduction * NetEnergyMeteringNSCAdj, ResultSummary[3]:NetSurpPVProduction, NetEnergyMeteringNSCAdj, (RunResultsE[13]:PropElecTDV[1] * CondFloorArea) )  endif  }
   "Add NSC to TDV - Elec   - PV (E)"   Proj:RunResultsE[13]:PropElecTDV[1]  = {
         if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0 .OR.
             IfValidAnd( ResultSummary[3]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
         else  RunResultsE[13]:PropElecTDV[1] - (ResultSummary[3]:NetSurpPVProduction * NetEnergyMeteringNSCAdj / CondFloorArea)  endif  }
   "Add NSC to TDV - TOTAL  - PV (E)"   Proj:RunResultsE[13]:ProposedTDV[1]  = {
         if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0 .OR.
             IfValidAnd( ResultSummary[3]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
         else  RunResultsE[13]:ProposedTDV[1] - (ResultSummary[3]:NetSurpPVProduction * NetEnergyMeteringNSCAdj / CondFloorArea)  endif  }

END

;************************************************************************* - SAC 6/13/17 - based on 'CARes_ProposedSummary_ScalePV'
RULELIST "CARes_ProposedSummary_S_ScalePV" 1 0 1 1
;*************************************************************************
   "Set PropPVScaleFactor (S)"    Proj:ResultSummary[4]:PropPVScaleFactor  = {
         (MaxPropPVRatio * (RunResultsS[10]:PropElecEnergy[1] - RunResultsS[13]:PropElecEnergy[1]))
         / (-1 * RunResultsS[13]:PropElecEnergy[1])  }
;"debugging"  Proj:Action = {  PostMessageToLog( "   S: Scaling PV: %g", ResultSummary[4]:PropPVScaleFactor )  }

   ; SAC 4/30/17 - added NetSurpPVProduction to implement net surplus compensation
   "Set Proj:ResultSummary[4]:NetSurpPVProduction (S)"   Proj:ResultSummary[4]:NetSurpPVProduction  = {
         (-1 * RunResultsS[13]:PropElecEnergy[1] * ValidOr( CondFloorArea, 0 ) / 3.412) * (1 - ResultSummary[4]:PropPVScaleFactor)  }

;   ; first STORE PV, Battery and Totals BEFORE scaling
;	"Store pre-scaled PV EnergyUse:ProposedTDV[4]"		Proj:RunResultsS[13]:ProposedTDV[4]	= {	RunResultsS[13]:ProposedTDV[1]  }
;	"Store pre-scaled Batt EnergyUse:ProposedTDV[4]"	Proj:RunResultsS[14]:ProposedTDV[4]	= {	RunResultsS[14]:ProposedTDV[1]  }
;	"Store pre-scaled Total EnergyUse:ProposedTDV[4]"	Proj:RunResultsS[10]:ProposedTDV[4]	= {	RunResultsS[10]:ProposedTDV[1]  }

   ; then REMOVE effect of PV on Totals
   "Subtrct PV frm Elec   - Total (S)"   Proj:RunResultsS[10]:PropElecEnergy[1]   = {  RunResultsS[10]:PropElecEnergy[1]  - RunResultsS[13]:PropElecEnergy[1]   }  ; - RunResultsS[14]:PropElecEnergy[1]   }
   "Subtrct PV frm TOTAL  - Total (S)"   Proj:RunResultsS[10]:PropTotalEnergy[1]  = {  RunResultsS[10]:PropTotalEnergy[1] - RunResultsS[13]:PropTotalEnergy[1]  }  ; - RunResultsS[14]:PropTotalEnergy[1]  }
   "Subtrct PV frm Elec   - Total (S)"   Proj:RunResultsS[10]:PropElecTDV[1]      = {  RunResultsS[10]:PropElecTDV[1]     - RunResultsS[13]:PropElecTDV[1]      }  ; - RunResultsS[14]:PropElecTDV[1]      }
   "Subtrct PV frm TOTAL  - Total (S)"   Proj:RunResultsS[10]:ProposedTDV[1]      = {  RunResultsS[10]:ProposedTDV[1]     - RunResultsS[13]:ProposedTDV[1]      }  ; - RunResultsS[14]:ProposedTDV[1]      }
   "Subtrct PV frm Elec Demand (S)"      Proj:RunResultsS[10]:PropElecDemand[1]   = {  RunResultsS[10]:PropElecDemand[1]  - RunResultsS[13]:PropElecDemand[1]   }  ; - RunResultsS[14]:PropElecDemand[1]   }

   ; apply PV scaling factor
   "Scale energy use - Elec   - PV (S)"       Proj:RunResultsS[13]:PropElecEnergy[1]   = {  ResultSummary[4]:PropPVScaleFactor * RunResultsS[13]:PropElecEnergy[1]   }
   "Scale energy use - TOTAL  - PV (S)"       Proj:RunResultsS[13]:PropTotalEnergy[1]  = {  ResultSummary[4]:PropPVScaleFactor * RunResultsS[13]:PropTotalEnergy[1]  }
;   "Scale energy use - Elec   - Battery (S)"  Proj:RunResultsS[14]:PropElecEnergy[1]   = {  ResultSummary[4]:PropPVScaleFactor * RunResultsS[14]:PropElecEnergy[1]   }
;   "Scale energy use - TOTAL  - Battery (S)"  Proj:RunResultsS[14]:PropTotalEnergy[1]  = {  ResultSummary[4]:PropPVScaleFactor * RunResultsS[14]:PropTotalEnergy[1]  }
   "Scale TDV - Elec   - PV (S)"              Proj:RunResultsS[13]:PropElecTDV[1]      = {  ResultSummary[4]:PropPVScaleFactor * RunResultsS[13]:PropElecTDV[1]      }
   "Scale TDV - TOTAL  - PV (S)"              Proj:RunResultsS[13]:ProposedTDV[1]      = {  ResultSummary[4]:PropPVScaleFactor * RunResultsS[13]:ProposedTDV[1]      }
   "Scale Elec Demand  - PV (S)"              Proj:RunResultsS[13]:PropElecDemand[1]   = {  ResultSummary[4]:PropPVScaleFactor * RunResultsS[13]:PropElecDemand[1]   }
;   "Scale TDV - Elec   - Battery (S)"         Proj:RunResultsS[14]:PropElecTDV[1]      = {  ResultSummary[4]:PropPVScaleFactor * RunResultsS[14]:PropElecTDV[1]      }
;   "Scale TDV - TOTAL  - Battery (S)"         Proj:RunResultsS[14]:ProposedTDV[1]      = {  ResultSummary[4]:PropPVScaleFactor * RunResultsS[14]:ProposedTDV[1]      }
;   "Scale Elec Demand  - Battery (S)"         Proj:RunResultsS[14]:PropElecDemand[1]   = {  ResultSummary[4]:PropPVScaleFactor * RunResultsS[14]:PropElecDemand[1]   }

   ; apply Net Surplus Compensation to PV TDV results
;"debugging"  Proj:Action = {  if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0 .OR. IfValidAnd( ResultSummary[4]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
;                              else  PostMessageToLog( "   S: NSC adjustment of %g (%g * %g) to scaled PV TDV of %g", ResultSummary[4]:NetSurpPVProduction * NetEnergyMeteringNSCAdj, ResultSummary[4]:NetSurpPVProduction, NetEnergyMeteringNSCAdj, (RunResultsS[13]:PropElecTDV[1] * CondFloorArea) )  endif  }
   "Add NSC to TDV - Elec   - PV (S)"   Proj:RunResultsS[13]:PropElecTDV[1]  = {
         if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0 .OR.
             IfValidAnd( ResultSummary[4]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
         else  RunResultsS[13]:PropElecTDV[1] - (ResultSummary[4]:NetSurpPVProduction * NetEnergyMeteringNSCAdj / CondFloorArea)  endif  }
   "Add NSC to TDV - TOTAL  - PV (S)"   Proj:RunResultsS[13]:ProposedTDV[1]  = {
         if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0 .OR.
             IfValidAnd( ResultSummary[4]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
         else  RunResultsS[13]:ProposedTDV[1] - (ResultSummary[4]:NetSurpPVProduction * NetEnergyMeteringNSCAdj / CondFloorArea)  endif  }

   ; RE-apply PV to Totals
   "Restore PV to Elec   - Total (S)"    Proj:RunResultsS[10]:PropElecEnergy[1]   = {  RunResultsS[10]:PropElecEnergy[1]  + RunResultsS[13]:PropElecEnergy[1]   }  ; + RunResultsS[14]:PropElecEnergy[1]   }
   "Restore PV to TOTAL  - Total (S)"    Proj:RunResultsS[10]:PropTotalEnergy[1]  = {  RunResultsS[10]:PropTotalEnergy[1] + RunResultsS[13]:PropTotalEnergy[1]  }  ; + RunResultsS[14]:PropTotalEnergy[1]  }
   "Restore PV to Elec   - Total (S)"    Proj:RunResultsS[10]:PropElecTDV[1]      = {  RunResultsS[10]:PropElecTDV[1]     + RunResultsS[13]:PropElecTDV[1]      }  ; + RunResultsS[14]:PropElecTDV[1]      }
   "Restore PV to TOTAL  - Total (S)"    Proj:RunResultsS[10]:ProposedTDV[1]      = {  RunResultsS[10]:ProposedTDV[1]     + RunResultsS[13]:ProposedTDV[1]      }  ; + RunResultsS[14]:ProposedTDV[1]      }
   "Restore PV to Elec Demand (S)"       Proj:RunResultsS[10]:PropElecDemand[1]   = {  RunResultsS[10]:PropElecDemand[1]  + RunResultsS[13]:PropElecDemand[1]   }  ; + RunResultsS[14]:PropElecDemand[1]   }
END
;************************************************************************* - SAC 6/25/17 - based on CARes_ProposedSummary_ScalePV_2016
RULELIST "CARes_ProposedSummary_S_ScalePV_2016" 1 0 1 1
;*************************************************************************
   "Set PropPVScaleFactor (S)"    Proj:ResultSummary[4]:PropPVScaleFactor  = {
         (MaxPropPVRatio * RunResultsS[10]:PropElecEnergy[1])
         / (-1 * RunResultsS[13]:PropElecEnergy[1])  }
;"debugging"  Proj:Action = {  PostMessageToLog( "   N: Scaling PV 2016: %g", ResultSummary[4]:PropPVScaleFactor )  }

   ; SAC 4/30/17 - added NetSurpPVProduction to implement net surplus compensation
   "Set Proj:ResultSummary[4]:NetSurpPVProduction (S)"   Proj:ResultSummary[4]:NetSurpPVProduction  = {
         (-1 * RunResultsS[13]:PropElecEnergy[1] * ValidOr( CondFloorArea, 0 ) / 3.412) * (1 - ResultSummary[4]:PropPVScaleFactor)  }

   ; apply PV scaling factor
   "Scale energy use - Elec   - PV (S)"       Proj:RunResultsS[13]:PropElecEnergy[1]   = {  ResultSummary[4]:PropPVScaleFactor * RunResultsS[13]:PropElecEnergy[1]   }
   "Scale energy use - TOTAL  - PV (S)"       Proj:RunResultsS[13]:PropTotalEnergy[1]  = {  ResultSummary[4]:PropPVScaleFactor * RunResultsS[13]:PropTotalEnergy[1]  }
;   "Scale energy use - Elec   - Battery (S)"  Proj:RunResultsS[14]:PropElecEnergy[1]   = {  ResultSummary[4]:PropPVScaleFactor * RunResultsS[14]:PropElecEnergy[1]   }
;   "Scale energy use - TOTAL  - Battery (S)"  Proj:RunResultsS[14]:PropTotalEnergy[1]  = {  ResultSummary[4]:PropPVScaleFactor * RunResultsS[14]:PropTotalEnergy[1]  }
   "Scale TDV - Elec   - PV (S)"              Proj:RunResultsS[13]:PropElecTDV[1]      = {  ResultSummary[4]:PropPVScaleFactor * RunResultsS[13]:PropElecTDV[1]      }
   "Scale TDV - TOTAL  - PV (S)"              Proj:RunResultsS[13]:ProposedTDV[1]      = {  ResultSummary[4]:PropPVScaleFactor * RunResultsS[13]:ProposedTDV[1]      }
   "Scale Elec Demand  - PV (S)"              Proj:RunResultsS[13]:PropElecDemand[1]   = {  ResultSummary[4]:PropPVScaleFactor * RunResultsS[13]:PropElecDemand[1]   }
;   "Scale TDV - Elec   - Battery (S)"         Proj:RunResultsS[14]:PropElecTDV[1]      = {  ResultSummary[4]:PropPVScaleFactor * RunResultsS[14]:PropElecTDV[1]      }
;   "Scale TDV - TOTAL  - Battery (S)"         Proj:RunResultsS[14]:ProposedTDV[1]      = {  ResultSummary[4]:PropPVScaleFactor * RunResultsS[14]:ProposedTDV[1]      }
;   "Scale Elec Demand  - Battery (S)"         Proj:RunResultsS[14]:PropElecDemand[1]   = {  ResultSummary[4]:PropPVScaleFactor * RunResultsS[14]:PropElecDemand[1]   }

   ; apply Net Surplus Compensation to PV TDV results
;"debugging"  Proj:Action = {  if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0 .OR. IfValidAnd( ResultSummary[4]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
;                              else  PostMessageToLog( "   N: NSC adjustment of %g (%g * %g) to scaled PV TDV of %g", ResultSummary[4]:NetSurpPVProduction * NetEnergyMeteringNSCAdj, ResultSummary[4]:NetSurpPVProduction, NetEnergyMeteringNSCAdj, (RunResultsS[13]:PropElecTDV[1] * CondFloorArea) )  endif  }
   "Add NSC to TDV - Elec   - PV (S)"   Proj:RunResultsS[13]:PropElecTDV[1]  = {
         if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0 .OR.
             IfValidAnd( ResultSummary[4]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
         else  RunResultsS[13]:PropElecTDV[1] - (ResultSummary[4]:NetSurpPVProduction * NetEnergyMeteringNSCAdj / CondFloorArea)  endif  }
   "Add NSC to TDV - TOTAL  - PV (S)"   Proj:RunResultsS[13]:ProposedTDV[1]  = {
         if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0 .OR.
             IfValidAnd( ResultSummary[4]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
         else  RunResultsS[13]:ProposedTDV[1] - (ResultSummary[4]:NetSurpPVProduction * NetEnergyMeteringNSCAdj / CondFloorArea)  endif  }

END

;************************************************************************* - SAC 6/13/17 - based on 'CARes_ProposedSummary_ScalePV'
RULELIST "CARes_ProposedSummary_W_ScalePV" 1 0 1 1
;*************************************************************************
   "Set PropPVScaleFactor (W)"    Proj:ResultSummary[5]:PropPVScaleFactor  = {
         (MaxPropPVRatio * (RunResultsW[10]:PropElecEnergy[1] - RunResultsW[13]:PropElecEnergy[1]))
         / (-1 * RunResultsW[13]:PropElecEnergy[1])  }
;"debugging"  Proj:Action = {  PostMessageToLog( "   W: Scaling PV: %g", ResultSummary[5]:PropPVScaleFactor )  }

   ; SAC 4/30/17 - added NetSurpPVProduction to implement net surplus compensation
   "Set Proj:ResultSummary[5]:NetSurpPVProduction (W)"   Proj:ResultSummary[5]:NetSurpPVProduction  = {
         (-1 * RunResultsW[13]:PropElecEnergy[1] * ValidOr( CondFloorArea, 0 ) / 3.412) * (1 - ResultSummary[5]:PropPVScaleFactor)  }

;   ; first STORE PV, Battery and Totals BEFORE scaling
;	"Store pre-scaled PV EnergyUse:ProposedTDV[4]"		Proj:RunResultsW[13]:ProposedTDV[4]	= {	RunResultsW[13]:ProposedTDV[1]  }
;	"Store pre-scaled Batt EnergyUse:ProposedTDV[4]"	Proj:RunResultsW[14]:ProposedTDV[4]	= {	RunResultsW[14]:ProposedTDV[1]  }
;	"Store pre-scaled Total EnergyUse:ProposedTDV[4]"	Proj:RunResultsW[10]:ProposedTDV[4]	= {	RunResultsW[10]:ProposedTDV[1]  }

   ; then REMOVE effect of PV on Totals
   "Subtrct PV frm Elec   - Total (W)"   Proj:RunResultsW[10]:PropElecEnergy[1]   = {  RunResultsW[10]:PropElecEnergy[1]  - RunResultsW[13]:PropElecEnergy[1]   }  ; - RunResultsW[14]:PropElecEnergy[1]   }
   "Subtrct PV frm TOTAL  - Total (W)"   Proj:RunResultsW[10]:PropTotalEnergy[1]  = {  RunResultsW[10]:PropTotalEnergy[1] - RunResultsW[13]:PropTotalEnergy[1]  }  ; - RunResultsW[14]:PropTotalEnergy[1]  }
   "Subtrct PV frm Elec   - Total (W)"   Proj:RunResultsW[10]:PropElecTDV[1]      = {  RunResultsW[10]:PropElecTDV[1]     - RunResultsW[13]:PropElecTDV[1]      }  ; - RunResultsW[14]:PropElecTDV[1]      }
   "Subtrct PV frm TOTAL  - Total (W)"   Proj:RunResultsW[10]:ProposedTDV[1]      = {  RunResultsW[10]:ProposedTDV[1]     - RunResultsW[13]:ProposedTDV[1]      }  ; - RunResultsW[14]:ProposedTDV[1]      }
   "Subtrct PV frm Elec Demand (W)"      Proj:RunResultsW[10]:PropElecDemand[1]   = {  RunResultsW[10]:PropElecDemand[1]  - RunResultsW[13]:PropElecDemand[1]   }  ; - RunResultsW[14]:PropElecDemand[1]   }

   ; apply PV scaling factor
   "Scale energy use - Elec   - PV (W)"       Proj:RunResultsW[13]:PropElecEnergy[1]   = {  ResultSummary[5]:PropPVScaleFactor * RunResultsW[13]:PropElecEnergy[1]   }
   "Scale energy use - TOTAL  - PV (W)"       Proj:RunResultsW[13]:PropTotalEnergy[1]  = {  ResultSummary[5]:PropPVScaleFactor * RunResultsW[13]:PropTotalEnergy[1]  }
;   "Scale energy use - Elec   - Battery (W)"  Proj:RunResultsW[14]:PropElecEnergy[1]   = {  ResultSummary[5]:PropPVScaleFactor * RunResultsW[14]:PropElecEnergy[1]   }
;   "Scale energy use - TOTAL  - Battery (W)"  Proj:RunResultsW[14]:PropTotalEnergy[1]  = {  ResultSummary[5]:PropPVScaleFactor * RunResultsW[14]:PropTotalEnergy[1]  }
   "Scale TDV - Elec   - PV (W)"              Proj:RunResultsW[13]:PropElecTDV[1]      = {  ResultSummary[5]:PropPVScaleFactor * RunResultsW[13]:PropElecTDV[1]      }
   "Scale TDV - TOTAL  - PV (W)"              Proj:RunResultsW[13]:ProposedTDV[1]      = {  ResultSummary[5]:PropPVScaleFactor * RunResultsW[13]:ProposedTDV[1]      }
   "Scale Elec Demand  - PV (W)"              Proj:RunResultsW[13]:PropElecDemand[1]   = {  ResultSummary[5]:PropPVScaleFactor * RunResultsW[13]:PropElecDemand[1]   }
;   "Scale TDV - Elec   - Battery (W)"         Proj:RunResultsW[14]:PropElecTDV[1]      = {  ResultSummary[5]:PropPVScaleFactor * RunResultsW[14]:PropElecTDV[1]      }
;   "Scale TDV - TOTAL  - Battery (W)"         Proj:RunResultsW[14]:ProposedTDV[1]      = {  ResultSummary[5]:PropPVScaleFactor * RunResultsW[14]:ProposedTDV[1]      }
;   "Scale Elec Demand  - Battery (W)"         Proj:RunResultsW[14]:PropElecDemand[1]   = {  ResultSummary[5]:PropPVScaleFactor * RunResultsW[14]:PropElecDemand[1]   }

   ; apply Net Surplus Compensation to PV TDV results
;"debugging"  Proj:Action = {  if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0 .OR. IfValidAnd( ResultSummary[5]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
;                              else  PostMessageToLog( "   W: NSC adjustment of %g (%g * %g) to scaled PV TDV of %g", ResultSummary[5]:NetSurpPVProduction * NetEnergyMeteringNSCAdj, ResultSummary[5]:NetSurpPVProduction, NetEnergyMeteringNSCAdj, (RunResultsW[13]:PropElecTDV[1] * CondFloorArea) )  endif  }
   "Add NSC to TDV - Elec   - PV (W)"   Proj:RunResultsW[13]:PropElecTDV[1]  = {
         if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0 .OR.
             IfValidAnd( ResultSummary[5]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
         else  RunResultsW[13]:PropElecTDV[1] - (ResultSummary[5]:NetSurpPVProduction * NetEnergyMeteringNSCAdj / CondFloorArea)  endif  }
   "Add NSC to TDV - TOTAL  - PV (W)"   Proj:RunResultsW[13]:ProposedTDV[1]  = {
         if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0 .OR.
             IfValidAnd( ResultSummary[5]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
         else  RunResultsW[13]:ProposedTDV[1] - (ResultSummary[5]:NetSurpPVProduction * NetEnergyMeteringNSCAdj / CondFloorArea)  endif  }

   ; RE-apply PV to Totals
   "Restore PV to Elec   - Total (W)"    Proj:RunResultsW[10]:PropElecEnergy[1]   = {  RunResultsW[10]:PropElecEnergy[1]  + RunResultsW[13]:PropElecEnergy[1]   }  ; + RunResultsW[14]:PropElecEnergy[1]   }
   "Restore PV to TOTAL  - Total (W)"    Proj:RunResultsW[10]:PropTotalEnergy[1]  = {  RunResultsW[10]:PropTotalEnergy[1] + RunResultsW[13]:PropTotalEnergy[1]  }  ; + RunResultsW[14]:PropTotalEnergy[1]  }
   "Restore PV to Elec   - Total (W)"    Proj:RunResultsW[10]:PropElecTDV[1]      = {  RunResultsW[10]:PropElecTDV[1]     + RunResultsW[13]:PropElecTDV[1]      }  ; + RunResultsW[14]:PropElecTDV[1]      }
   "Restore PV to TOTAL  - Total (W)"    Proj:RunResultsW[10]:ProposedTDV[1]      = {  RunResultsW[10]:ProposedTDV[1]     + RunResultsW[13]:ProposedTDV[1]      }  ; + RunResultsW[14]:ProposedTDV[1]      }
   "Restore PV to Elec Demand (W)"       Proj:RunResultsW[10]:PropElecDemand[1]   = {  RunResultsW[10]:PropElecDemand[1]  + RunResultsW[13]:PropElecDemand[1]   }  ; + RunResultsW[14]:PropElecDemand[1]   }
END
;************************************************************************* - SAC 6/25/17 - based on CARes_ProposedSummary_ScalePV_2016
RULELIST "CARes_ProposedSummary_W_ScalePV_2016" 1 0 1 1
;*************************************************************************
   "Set PropPVScaleFactor (W)"    Proj:ResultSummary[5]:PropPVScaleFactor  = {
         (MaxPropPVRatio * RunResultsW[10]:PropElecEnergy[1])
         / (-1 * RunResultsW[13]:PropElecEnergy[1])  }
;"debugging"  Proj:Action = {  PostMessageToLog( "   N: Scaling PV 2016: %g", ResultSummary[5]:PropPVScaleFactor )  }

   ; SAC 4/30/17 - added NetSurpPVProduction to implement net surplus compensation
   "Set Proj:ResultSummary[5]:NetSurpPVProduction (W)"   Proj:ResultSummary[5]:NetSurpPVProduction  = {
         (-1 * RunResultsW[13]:PropElecEnergy[1] * ValidOr( CondFloorArea, 0 ) / 3.412) * (1 - ResultSummary[5]:PropPVScaleFactor)  }

   ; apply PV scaling factor
   "Scale energy use - Elec   - PV (W)"       Proj:RunResultsW[13]:PropElecEnergy[1]   = {  ResultSummary[5]:PropPVScaleFactor * RunResultsW[13]:PropElecEnergy[1]   }
   "Scale energy use - TOTAL  - PV (W)"       Proj:RunResultsW[13]:PropTotalEnergy[1]  = {  ResultSummary[5]:PropPVScaleFactor * RunResultsW[13]:PropTotalEnergy[1]  }
;   "Scale energy use - Elec   - Battery (W)"  Proj:RunResultsW[14]:PropElecEnergy[1]   = {  ResultSummary[5]:PropPVScaleFactor * RunResultsW[14]:PropElecEnergy[1]   }
;   "Scale energy use - TOTAL  - Battery (W)"  Proj:RunResultsW[14]:PropTotalEnergy[1]  = {  ResultSummary[5]:PropPVScaleFactor * RunResultsW[14]:PropTotalEnergy[1]  }
   "Scale TDV - Elec   - PV (W)"              Proj:RunResultsW[13]:PropElecTDV[1]      = {  ResultSummary[5]:PropPVScaleFactor * RunResultsW[13]:PropElecTDV[1]      }
   "Scale TDV - TOTAL  - PV (W)"              Proj:RunResultsW[13]:ProposedTDV[1]      = {  ResultSummary[5]:PropPVScaleFactor * RunResultsW[13]:ProposedTDV[1]      }
   "Scale Elec Demand  - PV (W)"              Proj:RunResultsW[13]:PropElecDemand[1]   = {  ResultSummary[5]:PropPVScaleFactor * RunResultsW[13]:PropElecDemand[1]   }
;   "Scale TDV - Elec   - Battery (W)"         Proj:RunResultsW[14]:PropElecTDV[1]      = {  ResultSummary[5]:PropPVScaleFactor * RunResultsW[14]:PropElecTDV[1]      }
;   "Scale TDV - TOTAL  - Battery (W)"         Proj:RunResultsW[14]:ProposedTDV[1]      = {  ResultSummary[5]:PropPVScaleFactor * RunResultsW[14]:ProposedTDV[1]      }
;   "Scale Elec Demand  - Battery (W)"         Proj:RunResultsW[14]:PropElecDemand[1]   = {  ResultSummary[5]:PropPVScaleFactor * RunResultsW[14]:PropElecDemand[1]   }

   ; apply Net Surplus Compensation to PV TDV results
;"debugging"  Proj:Action = {  if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0 .OR. IfValidAnd( ResultSummary[5]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
;                              else  PostMessageToLog( "   N: NSC adjustment of %g (%g * %g) to scaled PV TDV of %g", ResultSummary[5]:NetSurpPVProduction * NetEnergyMeteringNSCAdj, ResultSummary[5]:NetSurpPVProduction, NetEnergyMeteringNSCAdj, (RunResultsW[13]:PropElecTDV[1] * CondFloorArea) )  endif  }
   "Add NSC to TDV - Elec   - PV (W)"   Proj:RunResultsW[13]:PropElecTDV[1]  = {
         if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0 .OR.
             IfValidAnd( ResultSummary[5]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
         else  RunResultsW[13]:PropElecTDV[1] - (ResultSummary[5]:NetSurpPVProduction * NetEnergyMeteringNSCAdj / CondFloorArea)  endif  }
   "Add NSC to TDV - TOTAL  - PV (W)"   Proj:RunResultsW[13]:ProposedTDV[1]  = {
         if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0 .OR.
             IfValidAnd( ResultSummary[5]:NetSurpPVProduction > 0 )==0) then  UNCHANGED
         else  RunResultsW[13]:ProposedTDV[1] - (ResultSummary[5]:NetSurpPVProduction * NetEnergyMeteringNSCAdj / CondFloorArea)  endif  }

END

; SAC 5/3/17 - this rulelist no longer called as it was during TEDR processing since final run ultimately will be clipped @ the max PV size
; ;************************************************************************* - SAC 5/3/17
; RULELIST "CARes_ProposedSummary_TargetEDR_NetSurpComp" 1 0 1 1
; ;*************************************************************************
;    "Set PropPVScaleFactor"    Proj:ResultSummary[1]:PropPVScaleFactor  = {
;          MaxPropPVRatio / UnscaledPropPVRatio  }
; ;         (MaxPropPVRatio * (RunResults[10]:PropElecEnergy[1] - RunResults[13]:PropElecEnergy[1]))
; ;         / (-1 * RunResults[13]:PropElecEnergy[1])  }
; ;"debugging"  Proj:Action = {  PostMessageToLog( "   Scaling PV: %g", ResultSummary[1]:PropPVScaleFactor )  }
; 
;    ; SAC 4/30/17 - added NetSurpPVProduction to implement net surplus compensation
;    "Set Proj:NetSurpPVProduction"   Proj:NetSurpPVProduction  = {
;          ((-1 * RunResults[13]:PropElecEnergy[1] / min( 1, ValidOr( PVWDCSizeMultiplier[1], 1 ) )) * ValidOr( CondFloorArea, 0 ) / 3.412) * (1 - ResultSummary[1]:PropPVScaleFactor)  }
; 
;    ; apply Net Surplus Compensation to PV TDV results
; "debugging"  Proj:Action = {  PostMessageToLog( "   NSC adjustment of %g (%g * %g) to PV TDV of %g", NetSurpPVProduction * NetEnergyMeteringNSCAdj, NetSurpPVProduction, NetEnergyMeteringNSCAdj, (RunResults[13]:PropElecTDV[1] * CondFloorArea) )  }
;    "Add NSC to TDV - Elec   - PV"   Proj:RunResults[13]:PropElecTDV[1]  = {
;          RunResults[13]:PropElecTDV[1] - (NetSurpPVProduction * NetEnergyMeteringNSCAdj / CondFloorArea)  }
;    "Add NSC to TDV - TOTAL  - PV"   Proj:RunResults[13]:ProposedTDV[1]  = {
;          RunResults[13]:ProposedTDV[1] - (NetSurpPVProduction * NetEnergyMeteringNSCAdj / CondFloorArea)  }
;    ; and also adjust PV to Totals
;    "Adjust Elec   - Total for NSC"  Proj:RunResults[10]:PropElecTDV[1]  = {
;          RunResults[10]:PropElecTDV[1] - (NetSurpPVProduction * NetEnergyMeteringNSCAdj / CondFloorArea)  }
;    "Adjust TOTAL  - Total for NSC"  Proj:RunResults[10]:ProposedTDV[1]  = {
;          RunResults[10]:ProposedTDV[1] - (NetSurpPVProduction * NetEnergyMeteringNSCAdj / CondFloorArea)  }
; END


;*************************************************************************
RULELIST "CARes_ProposedSummary_Main" 1 0 1 1
;*************************************************************************
	"Set ResultSummary[1]:Title3[1]"				Proj:ResultSummary[1]:Title3[1]		= {	"End Use"  }

	"Set ResultSummary[1]:Enduse1[1]"			Proj:ResultSummary[1]:Enduse1[1]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0) then  UNDEFINED  else  LocalRef( RunResults[1]:EnduseName  )  endif  }
	"Set ResultSummary[1]:Enduse2[1]"			Proj:ResultSummary[1]:Enduse2[1]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0) then  UNDEFINED  else  LocalRef( RunResults[2]:EnduseName  )  endif  }
	"Set ResultSummary[1]:Enduse3[1]"			Proj:ResultSummary[1]:Enduse3[1]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0) then  UNDEFINED  else  LocalRef( RunResults[3]:EnduseName  )  endif  }
	"Set ResultSummary[1]:Enduse4[1]"			Proj:ResultSummary[1]:Enduse4[1]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0) then  UNDEFINED  else  LocalRef( RunResults[4]:EnduseName  )  endif  }
	"Set ResultSummary[1]:Enduse5[1]"			Proj:ResultSummary[1]:Enduse5[1]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  LocalRef( RunResults[5]:EnduseName  )  endif  }
   "Set ResultSummary[1]:Enduse98[1]"			Proj:ResultSummary[1]:Enduse98[1]	= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  "Flexibility"  endif  }    ; SAC 1/27/19 (tic #1053)
  ;"Set ResultSummary[1]:Enduse99[1]"			Proj:ResultSummary[1]:Enduse99[1]	= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  "Grid Harmonization"  endif  }
  ;"Set ResultSummary[1]:Enduse99[1]"			Proj:ResultSummary[1]:Enduse99[1]	= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  "Self Utilization Credit"  endif  }  ; SAC 3/6/18 - label change from CEC-LF
	"Set ResultSummary[1]:Enduse99[1]"			Proj:ResultSummary[1]:Enduse99[1]	= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  "Self Util/Flexibility Credit"  endif  }  ; SAC 5/4/20 - label change from CEC-DT
	"Set ResultSummary[1]:Enduse14[1]"			Proj:ResultSummary[1]:Enduse14[1]	= {	if (LocalCompAssigned( RunResults[14] ) == 0) then  UNDEFINED  else  LocalRef( RunResults[14]:EnduseName )  endif  }
	"Set ResultSummary[1]:Enduse6[1]"			Proj:ResultSummary[1]:Enduse6[1]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  LocalRef( RunResults[6]:EnduseName  )  endif  }
	"Set ResultSummary[1]:Enduse7[1]"			Proj:ResultSummary[1]:Enduse7[1]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0) then  UNDEFINED  else  LocalRef( RunResults[7]:EnduseName  )  endif  }
	"Set ResultSummary[1]:Enduse8[1]"			Proj:ResultSummary[1]:Enduse8[1]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0) then  UNDEFINED  else  LocalRef( RunResults[8]:EnduseName  )  endif  }
	"Set ResultSummary[1]:Enduse9[1]"			Proj:ResultSummary[1]:Enduse9[1]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0) then  UNDEFINED  else  LocalRef( RunResults[9]:EnduseName  )  endif  }
	"Set ResultSummary[1]:Enduse10[1]"			Proj:ResultSummary[1]:Enduse10[1]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  LocalRef( RunResults[10]:EnduseName )  endif  }
	"Set ResultSummary[1]:Enduse11[1]"			Proj:ResultSummary[1]:Enduse11[1]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  LocalRef( RunResults[11]:EnduseName )  endif  }
	"Set ResultSummary[1]:Enduse12[1]"			Proj:ResultSummary[1]:Enduse12[1]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  LocalRef( RunResults[12]:EnduseName )  endif  }
  ; SAC 1/14/13 - added PVCredit stuff
; 	"Set ResultSummary[1]:Enduse13[1]"			Proj:ResultSummary[1]:Enduse13[1]	= {	"PV Credit"  }
  ; SAC 1/28/16 - PV now a separate enduse w/ assigned RunResults[13]
	"Set ResultSummary[1]:Enduse13[1]"			Proj:ResultSummary[1]:Enduse13[1]	= {	if (LocalCompAssigned( RunResults[13] ) == 0) then  UNDEFINED  else  LocalRef( RunResults[13]:EnduseName )  endif  }

; SAC 12/10/12 - revised rule to calc TDV for Research simulations
	"Call subordinate rulelist to setup remaining summary data"		Proj:Action = {	switch (Local( AnalysisType ))
																													case  0 :	EvalRulelist( "CARes_Summary_Prop_Only" )			; Research  (revised to calc & report TDV)
																													case 12 :	EvalRulelist( "CARes_Summary_Prop_Only" )			; Proposed Only
																												;	case 13 :	EvalRulelist( "CARes_Summary_Prop_AndStd" )		; Proposed and Standard
																													case 13 :	EvalRulelist( "CARes_Summary_Prop_Only" )			; Proposed and Standard
																													case 14 :	EvalRulelist( "CARes_Summary_Prop_Only" )			; Mixed Fuel Baseline Comparison    ; SAC 12/29/21 (MxdFuel)
																													case 15 :	EvalRulelist( "CARes_Summary_Prop_Only" )			; All Electric Baseline Comparison
																													case  2 :	EvalRulelist( "CARes_Summary_Prop_Only" )			; Existing Building EDR
																													default :	EvalRulelist( "CARes_Summary_Prop_Research" )	; Research
																												endswitch  }
END

;*************************************************************************
RULELIST "CARes_Summary_Prop_Only" 1 0 1 1
;*************************************************************************
;  ; Proposed Energy
;	"Set ResultSummary[1]:Title1[2]"				Proj:ResultSummary[1]:Title1[2]		= {	"Proposed"  }
;	"Set ResultSummary[1]:Title2[2]"				Proj:ResultSummary[1]:Title2[2]		= {	"Design"  }
;	"Set ResultSummary[1]:Title3[2]"				Proj:ResultSummary[1]:Title3[2]		= {	"(kBTU/ft-yr)"  }
;	"Set ResultSummary[1]:Enduse1[2]"			Proj:ResultSummary[1]:Enduse1[2]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[1]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary[1]:Enduse2[2]"			Proj:ResultSummary[1]:Enduse2[2]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[2]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary[1]:Enduse3[2]"			Proj:ResultSummary[1]:Enduse3[2]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[3]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary[1]:Enduse4[2]"			Proj:ResultSummary[1]:Enduse4[2]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[4]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary[1]:Enduse5[2]"			Proj:ResultSummary[1]:Enduse5[2]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[5]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary[1]:Enduse6[2]"			Proj:ResultSummary[1]:Enduse6[2]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[6]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary[1]:Enduse7[2]"			Proj:ResultSummary[1]:Enduse7[2]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[7]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary[1]:Enduse8[2]"			Proj:ResultSummary[1]:Enduse8[2]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[8]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary[1]:Enduse9[2]"			Proj:ResultSummary[1]:Enduse9[2]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[9]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary[1]:Enduse10[2]"			Proj:ResultSummary[1]:Enduse10[2]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[10]:PropTotalEnergy ), 2 )  endif  }
;	"Set ResultSummary[1]:Enduse11[2]"			Proj:ResultSummary[1]:Enduse11[2]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[11]:PropTotalEnergy ), 2 )  endif  }
;	"Set ResultSummary[1]:Enduse12[2]"			Proj:ResultSummary[1]:Enduse12[2]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:PropTotalEnergy ), 2 )  endif  }
;	"Set ResultSummary[1]:Enduse13[2]"			Proj:ResultSummary[1]:Enduse13[2]	= {	if (LocalCompAssigned( RunResults[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[13]:PropTotalEnergy ), 2 )  endif  }

; Rounding:  int( (<100 *> VALUE) + 0.5 ) </ 100>

  ; Proposed Site Electric Use
	"Set ResultSummary[1]:Title1[2]"				Proj:ResultSummary[1]:Title1[2]		= {	if (EnergyCodeYearNum < 2022) then  "Proposed"    else if (EnergyCodeYearNum < 2025) then  "Proposed Design:"  else  "Proposed Design"  endif endif  }
	"Set ResultSummary[1]:Title2[2]"				Proj:ResultSummary[1]:Title2[2]		= {	if (EnergyCodeYearNum < 2022) then  "Design"      else if (EnergyCodeYearNum < 2025) then  "Site"              else  "Site Elec."       endif endif  }
	"Set ResultSummary[1]:Title3[2]"				Proj:ResultSummary[1]:Title3[2]		= {	if (EnergyCodeYearNum < 2022) then  "Site (kWh)"  else  "(kWh/yr)"             endif  }
	"Set ResultSummary[1]:Enduse1[2]"			Proj:ResultSummary[1]:Enduse1[2]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0 .OR. RunResults[1]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[1]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse2[2]"			Proj:ResultSummary[1]:Enduse2[2]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0 .OR. RunResults[2]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[2]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse3[2]"			Proj:ResultSummary[1]:Enduse3[2]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0 .OR. RunResults[3]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[3]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse4[2]"			Proj:ResultSummary[1]:Enduse4[2]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0 .OR. RunResults[4]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[4]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
; SAC 7/18/13 - added "- none -" label for when user did not define (or assign) DHWSys objects
	"Set ResultSummary[1]:Enduse5[2]"			Proj:ResultSummary[1]:Enduse5[2]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0 .OR. RunResults[5]:PropElecEnergy[1]  < 0.00001) then
																														if (Proj:ModelingDHW < 0.5) then  "- none -"  else  UNDEFINED  endif
																													else  FltToStr( (int( (RunResults[5]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse14[2]"			Proj:ResultSummary[1]:Enduse14[2]	= {	if (LocalCompAssigned( RunResults[14] ) == 0 .OR. RunResults[14]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[14]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse6[2]"			Proj:ResultSummary[1]:Enduse6[2]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0 .OR. RunResults[6]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[6]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse7[2]"			Proj:ResultSummary[1]:Enduse7[2]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0 .OR. RunResults[7]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[7]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse8[2]"			Proj:ResultSummary[1]:Enduse8[2]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0 .OR. RunResults[8]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[8]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse9[2]"			Proj:ResultSummary[1]:Enduse9[2]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0 .OR. RunResults[9]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[9]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse10[2]"			Proj:ResultSummary[1]:Enduse10[2]	= {	if (LocalCompAssigned( RunResults[10] ) == 0 .OR. LocalStatus( RunResults[10]:PropElecEnergy[1] ) < 1) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse11[2]"			Proj:ResultSummary[1]:Enduse11[2]	= {	if (LocalCompAssigned( RunResults[11] ) == 0 .OR. LocalStatus( RunResults[11]:PropElecEnergy[1] ) < 1) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[11]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse12[2]"			Proj:ResultSummary[1]:Enduse12[2]	= {	if (LocalCompAssigned( RunResults[12] ) == 0 .OR. RunResults[12]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[12]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse13[2]"			Proj:ResultSummary[1]:Enduse13[2]	= {	if (LocalCompAssigned( RunResults[13] ) == 0 .OR. RunResults[13]:PropElecEnergy[1] > -0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[13]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }

  ; Proposed Site FUEL Use
	"Set ResultSummary[1]:Title1[3]"				Proj:ResultSummary[1]:Title1[3]		= {	if (EnergyCodeYearNum < 2022) then  "Proposed"       else  UNDEFINED   endif  }
	"Set ResultSummary[1]:Title2[3]"				Proj:ResultSummary[1]:Title2[3]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "Site"  else  "Site Gas"  endif endif  }
	"Set ResultSummary[1]:Title3[3]"				Proj:ResultSummary[1]:Title3[3]		= {	if (EnergyCodeYearNum < 2022) then  "Site (therms)"  else  "(therms/yr)"  endif  }
	"Set ResultSummary[1]:Enduse1[3]"			Proj:ResultSummary[1]:Enduse1[3]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0 .OR. (RunResults[1]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[1]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[1]:PropNatGasEnergy[1]  + RunResults[1]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse2[3]"			Proj:ResultSummary[1]:Enduse2[3]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0 .OR. (RunResults[2]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[2]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[2]:PropNatGasEnergy[1]  + RunResults[2]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse3[3]"			Proj:ResultSummary[1]:Enduse3[3]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0 .OR. (RunResults[3]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[3]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[3]:PropNatGasEnergy[1]  + RunResults[3]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse4[3]"			Proj:ResultSummary[1]:Enduse4[3]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0 .OR. (RunResults[4]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[4]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[4]:PropNatGasEnergy[1]  + RunResults[4]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse5[3]"			Proj:ResultSummary[1]:Enduse5[3]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0 .OR. (RunResults[5]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[5]:PropOtherEnergy[1]  < 0.00001)) then
																														if (Proj:ModelingDHW < 0.5) then  "- none -"  else  UNDEFINED  endif
																													else  FltToStr( ((RunResults[5]:PropNatGasEnergy[1]  + RunResults[5]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse14[3]"			Proj:ResultSummary[1]:Enduse14[3]	= {	if (LocalCompAssigned( RunResults[14] ) == 0 .OR. (RunResults[14]:PropNatGasEnergy[1] < 0.00001 .AND. RunResults[14]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[14]:PropNatGasEnergy[1] + RunResults[14]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse6[3]"			Proj:ResultSummary[1]:Enduse6[3]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0 .OR. (RunResults[6]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[6]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[6]:PropNatGasEnergy[1]  + RunResults[6]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse7[3]"			Proj:ResultSummary[1]:Enduse7[3]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0 .OR. (RunResults[7]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[7]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[7]:PropNatGasEnergy[1]  + RunResults[7]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse8[3]"			Proj:ResultSummary[1]:Enduse8[3]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0 .OR. (RunResults[8]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[8]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[8]:PropNatGasEnergy[1]  + RunResults[8]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse9[3]"			Proj:ResultSummary[1]:Enduse9[3]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0 .OR. (RunResults[9]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[9]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[9]:PropNatGasEnergy[1]  + RunResults[9]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse10[3]"			Proj:ResultSummary[1]:Enduse10[3]	= {	if (LocalCompAssigned( RunResults[10] ) == 0 .OR. (RunResults[10]:PropNatGasEnergy[1] < 0.00001 .AND. RunResults[10]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[10]:PropNatGasEnergy[1] + RunResults[10]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse11[3]"			Proj:ResultSummary[1]:Enduse11[3]	= {	if (LocalCompAssigned( RunResults[11] ) == 0 .OR. (RunResults[11]:PropNatGasEnergy[1] < 0.00001 .AND. RunResults[11]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[11]:PropNatGasEnergy[1] + RunResults[11]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse12[3]"			Proj:ResultSummary[1]:Enduse12[3]	= {	if (LocalCompAssigned( RunResults[12] ) == 0 .OR. (RunResults[12]:PropNatGasEnergy[1] < 0.00001 .AND. RunResults[12]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[12]:PropNatGasEnergy[1] + RunResults[12]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse13[3]"			Proj:ResultSummary[1]:Enduse13[3]	= {	UNDEFINED  }		; PV

  ; Proposed TDV
	"Set ResultSummary[1]:Title1[4]"				Proj:ResultSummary[1]:Title1[4]		= {	if (EnergyCodeYearNum < 2022) then  "Proposed"       else  UNDEFINED        endif  }
	"Set ResultSummary[1]:Title2[4]"				Proj:ResultSummary[1]:Title2[4]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "EDR2"  else  Proj:CompMetricLbl_Short + ""  endif endif  }   ; SAC 01/29/23
	"Set ResultSummary[1]:Title3[4]"				Proj:ResultSummary[1]:Title3[4]		= {	if (EnergyCodeYearNum < 2022) then  "(kTDV/ft-yr)"  else if (EnergyCodeYearNum < 2025) then  "(kTDV/ft-yr)"  else  "($/ft)"  endif endif  }
	"Set ResultSummary[1]:Enduse1[4]"			Proj:ResultSummary[1]:Enduse1[4]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[1]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse2[4]"			Proj:ResultSummary[1]:Enduse2[4]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[2]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse3[4]"			Proj:ResultSummary[1]:Enduse3[4]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[3]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse4[4]"			Proj:ResultSummary[1]:Enduse4[4]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[4]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse5[4]"			Proj:ResultSummary[1]:Enduse5[4]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[5]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse14[4]"			Proj:ResultSummary[1]:Enduse14[4]	= {	if (LocalCompAssigned( RunResults[14] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[14]:ProposedTDV[1] ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse6[4]"			Proj:ResultSummary[1]:Enduse6[4]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[6]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse7[4]"			Proj:ResultSummary[1]:Enduse7[4]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[7]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse8[4]"			Proj:ResultSummary[1]:Enduse8[4]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[8]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse9[4]"			Proj:ResultSummary[1]:Enduse9[4]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[9]:ProposedTDV[1]  ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse10[4]"			Proj:ResultSummary[1]:Enduse10[4]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[10]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse11[4]"			Proj:ResultSummary[1]:Enduse11[4]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[11]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse12[4]"			Proj:ResultSummary[1]:Enduse12[4]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse13[4]"			Proj:ResultSummary[1]:Enduse13[4]	= {	if (LocalCompAssigned( RunResults[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[13]:ProposedTDV[1] ), 2 )  endif  }

  ; Proposed Electric Demand
	"Set ResultSummary[1]:Title1[10]"			Proj:ResultSummary[1]:Title1[10]		= {	"Proposed"  }
	"Set ResultSummary[1]:Title2[10]"			Proj:ResultSummary[1]:Title2[10]		= {	"Design"  }
	"Set ResultSummary[1]:Title3[10]"			Proj:ResultSummary[1]:Title3[10]		= {	"(kW)"  }
	"Set ResultSummary[1]:Enduse1[10]"			Proj:ResultSummary[1]:Enduse1[10]	= {	if (LocalCompAssigned( RunResults[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[1]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse2[10]"			Proj:ResultSummary[1]:Enduse2[10]	= {	if (LocalCompAssigned( RunResults[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[2]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse3[10]"			Proj:ResultSummary[1]:Enduse3[10]	= {	if (LocalCompAssigned( RunResults[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[3]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse4[10]"			Proj:ResultSummary[1]:Enduse4[10]	= {	if (LocalCompAssigned( RunResults[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[4]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse5[10]"			Proj:ResultSummary[1]:Enduse5[10]	= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[5]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse14[10]"			Proj:ResultSummary[1]:Enduse14[10]	= {	if (LocalCompAssigned( RunResults[14] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[14]:PropElecDemand[1] ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse6[10]"			Proj:ResultSummary[1]:Enduse6[10]	= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[6]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse7[10]"			Proj:ResultSummary[1]:Enduse7[10]	= {	if (LocalCompAssigned( RunResults[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[7]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse8[10]"			Proj:ResultSummary[1]:Enduse8[10]	= {	if (LocalCompAssigned( RunResults[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[8]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse9[10]"			Proj:ResultSummary[1]:Enduse9[10]	= {	if (LocalCompAssigned( RunResults[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[9]:PropElecDemand[1]  ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse10[10]"			Proj:ResultSummary[1]:Enduse10[10]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[10]:PropElecDemand[1] ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse11[10]"			Proj:ResultSummary[1]:Enduse11[10]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[11]:PropElecDemand[1] ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse12[10]"			Proj:ResultSummary[1]:Enduse12[10]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:PropElecDemand[1] ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse13[10]"			Proj:ResultSummary[1]:Enduse13[10]	= {	if (LocalCompAssigned( RunResults[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[13]:PropElecDemand[1] ), 2 )  endif  }
END

;;*************************************************************************
;RULELIST "CARes_Summary_Prop_AndStd" 1 0 1 1
;;*************************************************************************
;
;	"Call above rulelist to setup Proposed model results"		Proj:Action = {	EvalRulelist( "CARes_Summary_Prop_Only" )  }
;
;  ; Standard Site Electric Use
;	"Set ResultSummary:Title1[5]"				Proj:ResultSummary:Title1[5]		= {	"Standard"  }
;	"Set ResultSummary:Title2[5]"				Proj:ResultSummary:Title2[5]		= {	"Design"  }
;	"Set ResultSummary:Title3[5]"				Proj:ResultSummary:Title3[5]		= {	"Site (kWh)"  }
;	"Set ResultSummary:Enduse1[5]"			Proj:ResultSummary:Enduse1[5]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0 .OR. RunResults[1]:StdElecEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[1]:StdElecEnergy  * Proj:CondFloorArea / 3.413), 0 )  endif  }
;	"Set ResultSummary:Enduse2[5]"			Proj:ResultSummary:Enduse2[5]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0 .OR. RunResults[2]:StdElecEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[2]:StdElecEnergy  * Proj:CondFloorArea / 3.413), 0 )  endif  }
;	"Set ResultSummary:Enduse3[5]"			Proj:ResultSummary:Enduse3[5]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0 .OR. RunResults[3]:StdElecEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[3]:StdElecEnergy  * Proj:CondFloorArea / 3.413), 0 )  endif  }
;	"Set ResultSummary:Enduse4[5]"			Proj:ResultSummary:Enduse4[5]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0 .OR. RunResults[4]:StdElecEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[4]:StdElecEnergy  * Proj:CondFloorArea / 3.413), 0 )  endif  }
;	"Set ResultSummary:Enduse5[5]"			Proj:ResultSummary:Enduse5[5]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0 .OR. RunResults[5]:StdElecEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[5]:StdElecEnergy  * Proj:CondFloorArea / 3.413), 0 )  endif  }
;	"Set ResultSummary:Enduse6[5]"			Proj:ResultSummary:Enduse6[5]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0 .OR. RunResults[6]:StdElecEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[6]:StdElecEnergy  * Proj:CondFloorArea / 3.413), 0 )  endif  }
;	"Set ResultSummary:Enduse7[5]"			Proj:ResultSummary:Enduse7[5]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0 .OR. RunResults[7]:StdElecEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[7]:StdElecEnergy  * Proj:CondFloorArea / 3.413), 0 )  endif  }
;	"Set ResultSummary:Enduse8[5]"			Proj:ResultSummary:Enduse8[5]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0 .OR. RunResults[8]:StdElecEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[8]:StdElecEnergy  * Proj:CondFloorArea / 3.413), 0 )  endif  }
;	"Set ResultSummary:Enduse9[5]"			Proj:ResultSummary:Enduse9[5]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0 .OR. RunResults[9]:StdElecEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[9]:StdElecEnergy  * Proj:CondFloorArea / 3.413), 0 )  endif  }
;	"Set ResultSummary:Enduse10[5]"			Proj:ResultSummary:Enduse10[5]	= {	if (LocalCompAssigned( RunResults[10] ) == 0 .OR. RunResults[10]:StdElecEnergy < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[10]:StdElecEnergy * Proj:CondFloorArea / 3.413), 0 )  endif  }
;	"Set ResultSummary:Enduse11[5]"			Proj:ResultSummary:Enduse11[5]	= {	if (LocalCompAssigned( RunResults[11] ) == 0 .OR. RunResults[11]:StdElecEnergy < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[11]:StdElecEnergy * Proj:CondFloorArea / 3.413), 0 )  endif  }
;	"Set ResultSummary:Enduse12[5]"			Proj:ResultSummary:Enduse12[5]	= {	if (LocalCompAssigned( RunResults[12] ) == 0 .OR. RunResults[12]:StdElecEnergy < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[12]:StdElecEnergy * Proj:CondFloorArea / 3.413), 0 )  endif  }
;
;  ; Standard Site Natural Gas Use
;	"Set ResultSummary:Title1[6]"				Proj:ResultSummary:Title1[6]		= {	"Standard"  }
;	"Set ResultSummary:Title2[6]"				Proj:ResultSummary:Title2[6]		= {	"Design"  }
;	"Set ResultSummary:Title3[6]"				Proj:ResultSummary:Title3[6]		= {	"Site (therms)"  }
;	"Set ResultSummary:Enduse1[6]"			Proj:ResultSummary:Enduse1[6]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0 .OR. RunResults[1]:StdNatGasEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[1]:StdNatGasEnergy  * Proj:CondFloorArea / 100), 1 )  endif  }
;	"Set ResultSummary:Enduse2[6]"			Proj:ResultSummary:Enduse2[6]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0 .OR. RunResults[2]:StdNatGasEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[2]:StdNatGasEnergy  * Proj:CondFloorArea / 100), 1 )  endif  }
;	"Set ResultSummary:Enduse3[6]"			Proj:ResultSummary:Enduse3[6]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0 .OR. RunResults[3]:StdNatGasEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[3]:StdNatGasEnergy  * Proj:CondFloorArea / 100), 1 )  endif  }
;	"Set ResultSummary:Enduse4[6]"			Proj:ResultSummary:Enduse4[6]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0 .OR. RunResults[4]:StdNatGasEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[4]:StdNatGasEnergy  * Proj:CondFloorArea / 100), 1 )  endif  }
;	"Set ResultSummary:Enduse5[6]"			Proj:ResultSummary:Enduse5[6]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0 .OR. RunResults[5]:StdNatGasEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[5]:StdNatGasEnergy  * Proj:CondFloorArea / 100), 1 )  endif  }
;	"Set ResultSummary:Enduse6[6]"			Proj:ResultSummary:Enduse6[6]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0 .OR. RunResults[6]:StdNatGasEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[6]:StdNatGasEnergy  * Proj:CondFloorArea / 100), 1 )  endif  }
;	"Set ResultSummary:Enduse7[6]"			Proj:ResultSummary:Enduse7[6]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0 .OR. RunResults[7]:StdNatGasEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[7]:StdNatGasEnergy  * Proj:CondFloorArea / 100), 1 )  endif  }
;	"Set ResultSummary:Enduse8[6]"			Proj:ResultSummary:Enduse8[6]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0 .OR. RunResults[8]:StdNatGasEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[8]:StdNatGasEnergy  * Proj:CondFloorArea / 100), 1 )  endif  }
;	"Set ResultSummary:Enduse9[6]"			Proj:ResultSummary:Enduse9[6]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0 .OR. RunResults[9]:StdNatGasEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[9]:StdNatGasEnergy  * Proj:CondFloorArea / 100), 1 )  endif  }
;	"Set ResultSummary:Enduse10[6]"			Proj:ResultSummary:Enduse10[6]	= {	if (LocalCompAssigned( RunResults[10] ) == 0 .OR. RunResults[10]:StdNatGasEnergy < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[10]:StdNatGasEnergy * Proj:CondFloorArea / 100), 1 )  endif  }
;	"Set ResultSummary:Enduse11[6]"			Proj:ResultSummary:Enduse11[6]	= {	if (LocalCompAssigned( RunResults[11] ) == 0 .OR. RunResults[11]:StdNatGasEnergy < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[11]:StdNatGasEnergy * Proj:CondFloorArea / 100), 1 )  endif  }
;	"Set ResultSummary:Enduse12[6]"			Proj:ResultSummary:Enduse12[6]	= {	if (LocalCompAssigned( RunResults[12] ) == 0 .OR. RunResults[12]:StdNatGasEnergy < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[12]:StdNatGasEnergy * Proj:CondFloorArea / 100), 1 )  endif  }
;
;  ; Standard TDV
;	"Set ResultSummary:Title1[7]"				Proj:ResultSummary:Title1[7]		= {	"Standard"  }
;	"Set ResultSummary:Title2[7]"				Proj:ResultSummary:Title2[7]		= {	"Design"  }
;	"Set ResultSummary:Title3[7]"				Proj:ResultSummary:Title3[7]		= {	"(kTDV/ft-yr)"  }
;	"Set ResultSummary:Enduse1[7]"			Proj:ResultSummary:Enduse1[7]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[1]:StandardTDV  ), 2 )  endif  }
;	"Set ResultSummary:Enduse2[7]"			Proj:ResultSummary:Enduse2[7]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[2]:StandardTDV  ), 2 )  endif  }
;	"Set ResultSummary:Enduse3[7]"			Proj:ResultSummary:Enduse3[7]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[3]:StandardTDV  ), 2 )  endif  }
;	"Set ResultSummary:Enduse4[7]"			Proj:ResultSummary:Enduse4[7]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[4]:StandardTDV  ), 2 )  endif  }
;	"Set ResultSummary:Enduse5[7]"			Proj:ResultSummary:Enduse5[7]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[5]:StandardTDV  ), 2 )  endif  }
;	"Set ResultSummary:Enduse6[7]"			Proj:ResultSummary:Enduse6[7]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[6]:StandardTDV  ), 2 )  endif  }
;	"Set ResultSummary:Enduse7[7]"			Proj:ResultSummary:Enduse7[7]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[7]:StandardTDV  ), 2 )  endif  }
;	"Set ResultSummary:Enduse8[7]"			Proj:ResultSummary:Enduse8[7]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[8]:StandardTDV  ), 2 )  endif  }
;	"Set ResultSummary:Enduse9[7]"			Proj:ResultSummary:Enduse9[7]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[9]:StandardTDV  ), 2 )  endif  }
; 	"Set ResultSummary:Enduse10[7]"			Proj:ResultSummary:Enduse10[7]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[10]:StandardTDV ), 2 )  endif  }
; 	"Set ResultSummary:Enduse11[7]"			Proj:ResultSummary:Enduse11[7]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[11]:StandardTDV ), 2 )  endif  }
; 	"Set ResultSummary:Enduse12[7]"			Proj:ResultSummary:Enduse12[7]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:StandardTDV ), 2 )  endif  }
;END

;*************************************************************************
RULELIST "CARes_Summary_Prop_Research" 1 0 1 1
;*************************************************************************
;  ; Proposed Energy
;	"Set ResultSummary:Title1[2]"				Proj:ResultSummary:Title1[2]		= {	"Proposed"  }
;	"Set ResultSummary:Title2[2]"				Proj:ResultSummary:Title2[2]		= {	"Design"  }
;	"Set ResultSummary:Title3[2]"				Proj:ResultSummary:Title3[2]		= {	"(kBTU/ft-yr)"  }
;	"Set ResultSummary:Enduse1[2]"			Proj:ResultSummary:Enduse1[2]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[1]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary:Enduse2[2]"			Proj:ResultSummary:Enduse2[2]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[2]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary:Enduse3[2]"			Proj:ResultSummary:Enduse3[2]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[3]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary:Enduse4[2]"			Proj:ResultSummary:Enduse4[2]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[4]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary:Enduse5[2]"			Proj:ResultSummary:Enduse5[2]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[5]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary:Enduse6[2]"			Proj:ResultSummary:Enduse6[2]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[6]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary:Enduse7[2]"			Proj:ResultSummary:Enduse7[2]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[7]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary:Enduse8[2]"			Proj:ResultSummary:Enduse8[2]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[8]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary:Enduse9[2]"			Proj:ResultSummary:Enduse9[2]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[9]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary:Enduse10[2]"			Proj:ResultSummary:Enduse10[2]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[10]:PropTotalEnergy ), 2 )  endif  }
;	"Set ResultSummary:Enduse11[2]"			Proj:ResultSummary:Enduse11[2]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[11]:PropTotalEnergy ), 2 )  endif  }
;	"Set ResultSummary:Enduse12[2]"			Proj:ResultSummary:Enduse12[2]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:PropTotalEnergy ), 2 )  endif  }
;	"Set ResultSummary:Enduse13[2]"			Proj:ResultSummary:Enduse13[2]	= {	if (LocalCompAssigned( RunResults[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[13]:PropTotalEnergy ), 2 )  endif  }

  ; Proposed Site Electric Use
	"Set ResultSummary[1]:Title1[2]"				Proj:ResultSummary[1]:Title1[2]		= {	if (EnergyCodeYearNum < 2022) then  "Proposed"    else if (EnergyCodeYearNum < 2025) then  "Proposed Design:"  else  "Proposed Design"  endif endif  }
	"Set ResultSummary[1]:Title2[2]"				Proj:ResultSummary[1]:Title2[2]		= {	if (EnergyCodeYearNum < 2022) then  "Design"      else if (EnergyCodeYearNum < 2025) then  "Site"              else  "Site Elec."       endif endif  }
	"Set ResultSummary[1]:Title3[2]"				Proj:ResultSummary[1]:Title3[2]		= {	if (EnergyCodeYearNum < 2022) then  "Site (kWh)"  else  "(kWh/yr)"             endif  }
	"Set ResultSummary[1]:Enduse1[2]"			Proj:ResultSummary[1]:Enduse1[2]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0 .OR. RunResults[1]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[1]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse2[2]"			Proj:ResultSummary[1]:Enduse2[2]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0 .OR. RunResults[2]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[2]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse3[2]"			Proj:ResultSummary[1]:Enduse3[2]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0 .OR. RunResults[3]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[3]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse4[2]"			Proj:ResultSummary[1]:Enduse4[2]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0 .OR. RunResults[4]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[4]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse5[2]"			Proj:ResultSummary[1]:Enduse5[2]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0 .OR. RunResults[5]:PropElecEnergy[1]  < 0.00001) then 
																														if (Proj:ModelingDHW < 0.5) then  "- none -"  else  UNDEFINED  endif
																													else  FltToStr( (int( (RunResults[5]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse14[2]"			Proj:ResultSummary[1]:Enduse14[2]	= {	if (LocalCompAssigned( RunResults[14] ) == 0 .OR. RunResults[14]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[14]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse6[2]"			Proj:ResultSummary[1]:Enduse6[2]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0 .OR. RunResults[6]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[6]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse7[2]"			Proj:ResultSummary[1]:Enduse7[2]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0 .OR. RunResults[7]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[7]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse8[2]"			Proj:ResultSummary[1]:Enduse8[2]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0 .OR. RunResults[8]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[8]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse9[2]"			Proj:ResultSummary[1]:Enduse9[2]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0 .OR. RunResults[9]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[9]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse10[2]"			Proj:ResultSummary[1]:Enduse10[2]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse11[2]"			Proj:ResultSummary[1]:Enduse11[2]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[11]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse12[2]"			Proj:ResultSummary[1]:Enduse12[2]	= {	if (LocalCompAssigned( RunResults[12] ) == 0 .OR. RunResults[12]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[12]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse13[2]"			Proj:ResultSummary[1]:Enduse13[2]	= {	if (LocalCompAssigned( RunResults[13] ) == 0 .OR. RunResults[13]:PropElecEnergy[1] > -0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[13]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }

  ; Proposed Site FUEL Use
	"Set ResultSummary[1]:Title1[3]"				Proj:ResultSummary[1]:Title1[3]		= {	if (EnergyCodeYearNum < 2022) then  "Proposed"       else  UNDEFINED   endif  }
	"Set ResultSummary[1]:Title2[3]"				Proj:ResultSummary[1]:Title2[3]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "Site"  else  "Site Gas"  endif endif  }
	"Set ResultSummary[1]:Title3[3]"				Proj:ResultSummary[1]:Title3[3]		= {	if (EnergyCodeYearNum < 2022) then  "Site (therms)"  else  "(therms/yr)"  endif  }
	"Set ResultSummary[1]:Enduse1[3]"			Proj:ResultSummary[1]:Enduse1[3]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0 .OR. (RunResults[1]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[1]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[1]:PropNatGasEnergy[1]  + RunResults[1]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse2[3]"			Proj:ResultSummary[1]:Enduse2[3]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0 .OR. (RunResults[2]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[2]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[2]:PropNatGasEnergy[1]  + RunResults[2]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse3[3]"			Proj:ResultSummary[1]:Enduse3[3]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0 .OR. (RunResults[3]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[3]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[3]:PropNatGasEnergy[1]  + RunResults[3]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse4[3]"			Proj:ResultSummary[1]:Enduse4[3]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0 .OR. (RunResults[4]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[4]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[4]:PropNatGasEnergy[1]  + RunResults[4]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse5[3]"			Proj:ResultSummary[1]:Enduse5[3]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0 .OR. (RunResults[5]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[5]:PropOtherEnergy[1]  < 0.00001)) then
																														if (Proj:ModelingDHW < 0.5) then  "- none -"  else  UNDEFINED  endif
																													else  FltToStr( ((RunResults[5]:PropNatGasEnergy[1]  + RunResults[5]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse14[3]"			Proj:ResultSummary[1]:Enduse14[3]	= {	if (LocalCompAssigned( RunResults[14] ) == 0 .OR. (RunResults[14]:PropNatGasEnergy[1] < 0.00001 .AND. RunResults[14]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[14]:PropNatGasEnergy[1] + RunResults[14]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse6[3]"			Proj:ResultSummary[1]:Enduse6[3]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0 .OR. (RunResults[6]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[6]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[6]:PropNatGasEnergy[1]  + RunResults[6]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse7[3]"			Proj:ResultSummary[1]:Enduse7[3]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0 .OR. (RunResults[7]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[7]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[7]:PropNatGasEnergy[1]  + RunResults[7]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse8[3]"			Proj:ResultSummary[1]:Enduse8[3]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0 .OR. (RunResults[8]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[8]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[8]:PropNatGasEnergy[1]  + RunResults[8]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse9[3]"			Proj:ResultSummary[1]:Enduse9[3]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0 .OR. (RunResults[9]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[9]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[9]:PropNatGasEnergy[1]  + RunResults[9]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse10[3]"			Proj:ResultSummary[1]:Enduse10[3]	= {	if (LocalCompAssigned( RunResults[10] ) == 0 .OR. (RunResults[10]:PropNatGasEnergy[1] < 0.00001 .AND. RunResults[10]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[10]:PropNatGasEnergy[1] + RunResults[10]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse11[3]"			Proj:ResultSummary[1]:Enduse11[3]	= {	if (LocalCompAssigned( RunResults[11] ) == 0 .OR. (RunResults[11]:PropNatGasEnergy[1] < 0.00001 .AND. RunResults[11]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[11]:PropNatGasEnergy[1] + RunResults[11]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse12[3]"			Proj:ResultSummary[1]:Enduse12[3]	= {	if (LocalCompAssigned( RunResults[12] ) == 0 .OR. (RunResults[12]:PropNatGasEnergy[1] < 0.00001 .AND. RunResults[12]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[12]:PropNatGasEnergy[1] + RunResults[12]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse13[3]"			Proj:ResultSummary[1]:Enduse13[3]	= {	UNDEFINED  }		; PV
END

;*************************************************************************
RULELIST "CARes_StandardSummary" 1 0 1 1
;*************************************************************************
  ; Standard Site Electric Use
	"Set ResultSummary[1]:Title1[5]"				Proj:ResultSummary[1]:Title1[5]		= {	if (EnergyCodeYearNum < 2022) then  "Standard"    else if (EnergyCodeYearNum < 2025) then  "Standard Design:"  else  "Standard Design"  endif endif  }
	"Set ResultSummary[1]:Title2[5]"				Proj:ResultSummary[1]:Title2[5]		= {	if (EnergyCodeYearNum < 2022) then  "Design"      else if (EnergyCodeYearNum < 2025) then  "Site"              else  "Site Elec."       endif endif  }
	"Set ResultSummary[1]:Title3[5]"				Proj:ResultSummary[1]:Title3[5]		= {	if (EnergyCodeYearNum < 2022) then  "Site (kWh)"  else  "(kWh/yr)"             endif  }
	"Set ResultSummary[1]:Enduse1[5]"			Proj:ResultSummary[1]:Enduse1[5]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0 .OR. RunResults[1]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[1]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse2[5]"			Proj:ResultSummary[1]:Enduse2[5]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0 .OR. RunResults[2]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[2]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse3[5]"			Proj:ResultSummary[1]:Enduse3[5]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0 .OR. RunResults[3]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[3]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse4[5]"			Proj:ResultSummary[1]:Enduse4[5]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0 .OR. RunResults[4]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[4]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse5[5]"			Proj:ResultSummary[1]:Enduse5[5]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0 .OR. RunResults[5]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[5]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse14[5]"			Proj:ResultSummary[1]:Enduse14[5]	= {	if (LocalCompAssigned( RunResults[14] ) == 0 .OR. RunResults[14]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[14]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse6[5]"			Proj:ResultSummary[1]:Enduse6[5]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0 .OR. RunResults[6]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[6]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse7[5]"			Proj:ResultSummary[1]:Enduse7[5]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0 .OR. RunResults[7]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[7]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse8[5]"			Proj:ResultSummary[1]:Enduse8[5]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0 .OR. RunResults[8]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[8]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse9[5]"			Proj:ResultSummary[1]:Enduse9[5]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0 .OR. RunResults[9]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[9]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse10[5]"			Proj:ResultSummary[1]:Enduse10[5]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[10]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse11[5]"			Proj:ResultSummary[1]:Enduse11[5]	= {	if (LocalCompAssigned( RunResults[11] ) == 0 .OR. RunResults[11]:StdElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[11]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse12[5]"			Proj:ResultSummary[1]:Enduse12[5]	= {	if (LocalCompAssigned( RunResults[12] ) == 0 .OR. RunResults[12]:StdElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[12]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse13[5]"			Proj:ResultSummary[1]:Enduse13[5]	= {	if (LocalCompAssigned( RunResults[13] ) == 0 .OR. RunResults[13]:StdElecEnergy > -0.00001) then  UNDEFINED  ; SAC 1/11/18
																													else  FltToStr( (int( (RunResults[13]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
	"Set ResultSummary[1]:Enduse10[2]"			Proj:ResultSummary[1]:Enduse10[2]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse11[2]"			Proj:ResultSummary[1]:Enduse11[2]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[11]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse12[2]"			Proj:ResultSummary[1]:Enduse12[2]	= {	if (LocalCompAssigned( RunResults[12] ) == 0 .OR. RunResults[12]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[12]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }

  ; Standard Site Natural Gas Use
	"Set ResultSummary[1]:Title1[6]"				Proj:ResultSummary[1]:Title1[6]		= {	if (EnergyCodeYearNum < 2022) then  "Standard"       else  UNDEFINED   endif  }
	"Set ResultSummary[1]:Title2[6]"				Proj:ResultSummary[1]:Title2[6]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "Site"  else  "Site Gas"  endif endif  }
	"Set ResultSummary[1]:Title3[6]"				Proj:ResultSummary[1]:Title3[6]		= {	if (EnergyCodeYearNum < 2022) then  "Site (therms)"  else  "(therms/yr)"  endif  }
	"Set ResultSummary[1]:Enduse1[6]"			Proj:ResultSummary[1]:Enduse1[6]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0 .OR. (RunResults[1]:StdNatGasEnergy  < 0.00001 .AND. RunResults[1]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[1]:StdNatGasEnergy  + RunResults[1]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse2[6]"			Proj:ResultSummary[1]:Enduse2[6]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0 .OR. (RunResults[2]:StdNatGasEnergy  < 0.00001 .AND. RunResults[2]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[2]:StdNatGasEnergy  + RunResults[2]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse3[6]"			Proj:ResultSummary[1]:Enduse3[6]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0 .OR. (RunResults[3]:StdNatGasEnergy  < 0.00001 .AND. RunResults[3]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[3]:StdNatGasEnergy  + RunResults[3]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse4[6]"			Proj:ResultSummary[1]:Enduse4[6]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0 .OR. (RunResults[4]:StdNatGasEnergy  < 0.00001 .AND. RunResults[4]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[4]:StdNatGasEnergy  + RunResults[4]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse5[6]"			Proj:ResultSummary[1]:Enduse5[6]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0 .OR. (RunResults[5]:StdNatGasEnergy  < 0.00001 .AND. RunResults[5]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[5]:StdNatGasEnergy  + RunResults[5]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse14[6]"			Proj:ResultSummary[1]:Enduse14[6]	= {	if (LocalCompAssigned( RunResults[14] ) == 0 .OR. (RunResults[14]:StdNatGasEnergy < 0.00001 .AND. RunResults[14]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[14]:StdNatGasEnergy + RunResults[14]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse6[6]"			Proj:ResultSummary[1]:Enduse6[6]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0 .OR. (RunResults[6]:StdNatGasEnergy  < 0.00001 .AND. RunResults[6]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[6]:StdNatGasEnergy  + RunResults[6]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse7[6]"			Proj:ResultSummary[1]:Enduse7[6]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0 .OR. (RunResults[7]:StdNatGasEnergy  < 0.00001 .AND. RunResults[7]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[7]:StdNatGasEnergy  + RunResults[7]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse8[6]"			Proj:ResultSummary[1]:Enduse8[6]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0 .OR. (RunResults[8]:StdNatGasEnergy  < 0.00001 .AND. RunResults[8]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[8]:StdNatGasEnergy  + RunResults[8]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse9[6]"			Proj:ResultSummary[1]:Enduse9[6]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0 .OR. (RunResults[9]:StdNatGasEnergy  < 0.00001 .AND. RunResults[9]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[9]:StdNatGasEnergy  + RunResults[9]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse10[6]"			Proj:ResultSummary[1]:Enduse10[6]	= {	if (LocalCompAssigned( RunResults[10] ) == 0 .OR. (RunResults[10]:StdNatGasEnergy < 0.00001 .AND. RunResults[10]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[10]:StdNatGasEnergy + RunResults[10]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse11[6]"			Proj:ResultSummary[1]:Enduse11[6]	= {	if (LocalCompAssigned( RunResults[11] ) == 0 .OR. (RunResults[11]:StdNatGasEnergy < 0.00001 .AND. RunResults[11]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[11]:StdNatGasEnergy + RunResults[11]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse12[6]"			Proj:ResultSummary[1]:Enduse12[6]	= {	if (LocalCompAssigned( RunResults[12] ) == 0 .OR. (RunResults[12]:StdNatGasEnergy < 0.00001 .AND. RunResults[12]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[12]:StdNatGasEnergy + RunResults[12]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }

  ; Standard TDV
	"Set ResultSummary[1]:Title1[7]"				Proj:ResultSummary[1]:Title1[7]		= {	if (EnergyCodeYearNum < 2022) then  "Standard"       else  UNDEFINED        endif  }
	"Set ResultSummary[1]:Title2[7]"				Proj:ResultSummary[1]:Title2[7]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "EDR2"  else  Proj:CompMetricLbl_Short + ""  endif endif  }   ; SAC 01/29/23
	"Set ResultSummary[1]:Title3[7]"				Proj:ResultSummary[1]:Title3[7]		= {	if (EnergyCodeYearNum < 2022) then  "(kTDV/ft-yr)"  else if (EnergyCodeYearNum < 2025) then  "(kTDV/ft-yr)"  else  "($/ft)"  endif endif  }
	"Set ResultSummary[1]:Enduse1[7]"			Proj:ResultSummary[1]:Enduse1[7]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[1]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse2[7]"			Proj:ResultSummary[1]:Enduse2[7]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[2]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse3[7]"			Proj:ResultSummary[1]:Enduse3[7]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[3]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse4[7]"			Proj:ResultSummary[1]:Enduse4[7]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[4]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse5[7]"			Proj:ResultSummary[1]:Enduse5[7]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[5]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse6[7]"			Proj:ResultSummary[1]:Enduse6[7]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[6]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse7[7]"			Proj:ResultSummary[1]:Enduse7[7]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[7]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse8[7]"			Proj:ResultSummary[1]:Enduse8[7]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[8]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse9[7]"			Proj:ResultSummary[1]:Enduse9[7]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[9]:StandardTDV  ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse10[7]"			Proj:ResultSummary[1]:Enduse10[7]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[10]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse11[7]"			Proj:ResultSummary[1]:Enduse11[7]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[11]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse12[7]"			Proj:ResultSummary[1]:Enduse12[7]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:StandardTDV ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse13[7]"			Proj:ResultSummary[1]:Enduse13[7]	= {	if (LocalCompAssigned( RunResults[13] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResults[13]:StandardTDV = 0 )) then  " "  else  FltToStr( LocalRef( RunResults[13]:StandardTDV ), 2 )  endif endif  }
	"Set ResultSummary[1]:Enduse14[7]"			Proj:ResultSummary[1]:Enduse14[7]	= {	if (LocalCompAssigned( RunResults[14] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResults[14]:StandardTDV = 0 )) then  " "  else  FltToStr( LocalRef( RunResults[14]:StandardTDV ), 2 )  endif endif  }
 ; mjb-10/16/13	subtract PVCredit from Prop Design
	;"Set ResultSummary[1]:Enduse13[4]"			Proj:ResultSummary[1]:Enduse13[4]	= {	FltToStr( (PVCredit[1] * -1), 2 )  }
   ; SAC 10/6/16 - 2019 PV
	"Set ResultSummary[1]:Enduse13[4]"			Proj:ResultSummary[1]:Enduse13[4]	= {	if (EnergyCodeYearNum >= 2019)
                                                                                 then  if (LocalCompAssigned( RunResults[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[13]:ProposedTDV ), 2 )  endif
                                                                                 else  if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( (RunResults[6]:PropPVCreditTDV[1] * -1), 2 )  endif  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
	"Set ResultSummary[1]:Enduse10[4]"			Proj:ResultSummary[1]:Enduse10[4]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[10]:ProposedTDV[1] ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse11[4]"			Proj:ResultSummary[1]:Enduse11[4]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[11]:ProposedTDV[1] ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse12[4]"			Proj:ResultSummary[1]:Enduse12[4]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:ProposedTDV[1] ), 2 )  endif  }
  ; SAC 4/17/15 - copy CompResultsMsg down from Proj into EUseSummary (to ensure that it is carried into subsequent models and back to user input)
	"Set ResultSummary[1]:CompResultsMsg"		Proj:ResultSummary[1]:CompResultsMsg	= {	if (GlobalStatus( Proj:CompResultsMsg ) > 0) then  Proj:CompResultsMsg  else  UNCHANGED  endif  }
  ; SAC 3/3/16 - ensure access to PVMinRatedPower in projects following analysis (tic #609)
	"Set ResultSummary[1]:PVMinRatedPower"		Proj:ResultSummary[1]:PVMinRatedPower	= {	if (IfValidAnd( Proj:PVCompCredit > 0 ) .AND. IfValidAnd( Proj:PVCredit[1] > 0 ) .AND. IfValidAnd( Proj:PVMinRatedPower[2] > 0 ))
																														then  Proj:PVMinRatedPower[2]  else  UNCHANGED  endif  }

  ; Compliance Margin TDV
	"Set ResultSummary[1]:Title1[8]"				Proj:ResultSummary[1]:Title1[8]		= {	if (EnergyCodeYearNum < 2022) then  "Compliance"     else if (EnergyCodeYearNum < 2025) then  "Compliance Margins:"  else "Compliance Margins"  endif endif  }   ; SAC 11/24/22
	"Set ResultSummary[1]:Title2[8]"				Proj:ResultSummary[1]:Title2[8]		= {	if (EnergyCodeYearNum < 2022) then  "Margin"         else if (EnergyCodeYearNum < 2025) then  "EDR2"                 else  Proj:CompMetricLbl_Short + ""  endif endif  }   ; SAC 01/29/23
	"Set ResultSummary[1]:Title3[8]"				Proj:ResultSummary[1]:Title3[8]		= {	if (EnergyCodeYearNum < 2022) then  "(kTDV/ft-yr)"  else if (EnergyCodeYearNum < 2025) then  "(kTDV/ft-yr)"        else  "($/ft)"  endif endif  }
	"Set ResultSummary[1]:Enduse1[8]"			Proj:ResultSummary[1]:Enduse1[8]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[1]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse2[8]"			Proj:ResultSummary[1]:Enduse2[8]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[2]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse3[8]"			Proj:ResultSummary[1]:Enduse3[8]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[3]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse4[8]"			Proj:ResultSummary[1]:Enduse4[8]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[4]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse5[8]"			Proj:ResultSummary[1]:Enduse5[8]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[5]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse14[8]"			Proj:ResultSummary[1]:Enduse14[8]	= {	if (LocalCompAssigned( RunResults[14] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[14]:CompMarginTDV ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse6[8]"			Proj:ResultSummary[1]:Enduse6[8]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[6]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse7[8]"			Proj:ResultSummary[1]:Enduse7[8]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[7]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse8[8]"			Proj:ResultSummary[1]:Enduse8[8]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[8]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse9[8]"			Proj:ResultSummary[1]:Enduse9[8]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[9]:CompMarginTDV  ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse10[8]"			Proj:ResultSummary[1]:Enduse10[8]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[10]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse11[8]"			Proj:ResultSummary[1]:Enduse11[8]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[11]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse12[8]"			Proj:ResultSummary[1]:Enduse12[8]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:CompMarginTDV ), 2 )  endif  }
   ; SAC 1/14/13 - added PVCredit stuff
 	;"Set ResultSummary[1]:Enduse13[8]"			Proj:ResultSummary[1]:Enduse13[8]	= {	FltToStr( PVCredit[1], 2 )  }
   ; SAC 10/6/16 - 2019 PV
 	"Set ResultSummary[1]:Enduse13[8]"			Proj:ResultSummary[1]:Enduse13[8]	= {	if (EnergyCodeYearNum >= 2019)
                                                                                 then  if (LocalCompAssigned( RunResults[13] ) == 0) then  UNDEFINED  else  FltToStr( RunResults[13]:CompMarginTDV,     2 )  endif
                                                                                 else  if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[6]:PropPVCreditTDV[1], 2 )  endif  endif  }	; SAC 1/28/16 - leave std PV credit alone

	"Adjust Summary SelfUtilizationCredit (SUC) results"	         Proj:Action =        ; SAC 07/22/23 (2025)
      {  if (RunAbbrev == "s3") then	EvalRulelist( "CARes_SelfUtilizationCredit_2025" )
         else  UNCHANGED  endif  }

; 	"Set ResultSummary[1]:MetricPassFail[1] (SLCC-Eff)"   Proj:ResultSummary[1]:MetricPassFail[1] = {	if (EnergyCodeYearNum < 2025 .OR. LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  if (RunResults[11]:CompMarginTDV >= 0) then "Pass"  else  "Fail"  endif endif  }  ; SAC 11/22/22 (2025)   - now done below - SAC 07/31/23
 	"Set ResultSummary[1]:MetricPassFail[2] (SLCC-Tot)"   Proj:ResultSummary[1]:MetricPassFail[2] = {	if (EnergyCodeYearNum < 2025 .OR. LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  if (RunResults[10]:CompMarginTDV >= 0) then "Pass"  else  "Fail"  endif endif  } 
 	"Set ResultSummary[1]:MetricPassFail[3] (Src-Tot)"    Proj:ResultSummary[1]:MetricPassFail[3] = {	if (EnergyCodeYearNum < 2025 .OR. LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  if (RunResults[10]:CompMarginSrc >= 0) then "Pass"  else  "Fail"  endif endif  } 
 	"Set ResultSummary[1]:PassFail"				Proj:ResultSummary[1]:PassFail		= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  if (RunResults[11]:CompMarginTDV >= 0) then "PASS"  else  "FAIL"  endif endif  }

  ; Standard Electric Demand
	"Set ResultSummary[1]:Title1[11]"			Proj:ResultSummary[1]:Title1[11]		= {	"Standard"  }
	"Set ResultSummary[1]:Title2[11]"			Proj:ResultSummary[1]:Title2[11]		= {	"Design"  }
	"Set ResultSummary[1]:Title3[11]"			Proj:ResultSummary[1]:Title3[11]		= {	"(kW)"  }
	"Set ResultSummary[1]:Enduse1[11]"			Proj:ResultSummary[1]:Enduse1[11]	= {	if (LocalCompAssigned( RunResults[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[1]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse2[11]"			Proj:ResultSummary[1]:Enduse2[11]	= {	if (LocalCompAssigned( RunResults[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[2]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse3[11]"			Proj:ResultSummary[1]:Enduse3[11]	= {	if (LocalCompAssigned( RunResults[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[3]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse4[11]"			Proj:ResultSummary[1]:Enduse4[11]	= {	if (LocalCompAssigned( RunResults[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[4]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse5[11]"			Proj:ResultSummary[1]:Enduse5[11]	= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[5]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse14[11]"			Proj:ResultSummary[1]:Enduse14[11]	= {	if (LocalCompAssigned( RunResults[14] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[14]:StdElecDemand ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse6[11]"			Proj:ResultSummary[1]:Enduse6[11]	= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[6]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse7[11]"			Proj:ResultSummary[1]:Enduse7[11]	= {	if (LocalCompAssigned( RunResults[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[7]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse8[11]"			Proj:ResultSummary[1]:Enduse8[11]	= {	if (LocalCompAssigned( RunResults[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[8]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse9[11]"			Proj:ResultSummary[1]:Enduse9[11]	= {	if (LocalCompAssigned( RunResults[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[9]:StdElecDemand  ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse10[11]"			Proj:ResultSummary[1]:Enduse10[11]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[10]:StdElecDemand ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse11[11]"			Proj:ResultSummary[1]:Enduse11[11]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[11]:StdElecDemand ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse12[11]"			Proj:ResultSummary[1]:Enduse12[11]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:StdElecDemand ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse12[11]"			Proj:ResultSummary[1]:Enduse12[11]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:StdElecDemand ), 2 )  endif  }

  ; Demand & Energy Use Margins (added w/ CAHP mods 10/8/14)
      ; SAC 12/7/17 - implemented rounding to prevent illogical screen display and CAHP report NaN - MarginkW & MarginTherms to nearest 0.01, MarginkWh & PctSavings* to nearest 0.1
	"Set ResultSummary[1]:MarginkW[1]"		Proj:ResultSummary[1]:MarginkW[1]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED
																												else  int(((ValidOr( RunResults[10]:StdElecDemand, 0 ) - ValidOr( RunResults[10]:PropElecDemand[1], 0 )) * 100) +0.5 ) / 100  endif  }
	"Set ResultSummary[1]:MarginkWh"			Proj:ResultSummary[1]:MarginkWh		= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED
																												else  int((((ValidOr( RunResults[10]:StdElecEnergy, 0 ) - ValidOr( RunResults[10]:PropElecEnergy[1], 0 )) * CondFloorArea / 3.413) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[1]:MarginTherms"		Proj:ResultSummary[1]:MarginTherms	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED
																												else  int((((ValidOr( RunResults[10]:StdNatGasEnergy, 0 ) - ValidOr( RunResults[10]:PropNatGasEnergy[1], 0 )) * CondFloorArea / 100) * 100) +0.5 ) / 100  endif  }
  ; Additional elec demand storage (SAC 10/7/16)
   "Set ResultSummary[1]:PropElecDemand[1]"  Proj:ResultSummary[1]:PropElecDemand[1]   = {   if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED
																												         else  ValidOr( RunResults[10]:PropElecDemand[1], 0 )  endif  }
   "Set ResultSummary[1]:PropElecDemand[2]"  Proj:ResultSummary[1]:PropElecDemand[2]   = {   if (LocalCompAssigned( RunResults[10] ) == 0 .OR. LocalStatus( RunResults[10]:PropElecDemand[2] ) < 1) then  UNDEFINED
																												         else  ValidOr( RunResults[10]:PropElecDemand[2], 0 )  endif  }
   "Set ResultSummary[1]:StdElecDemand"      Proj:ResultSummary[1]:StdElecDemand       = {   if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED
																												         else  ValidOr( RunResults[10]:StdElecDemand, 0 )  endif  }
   "Set ResultSummary[1]:DRtgElecDemand"     Proj:ResultSummary[1]:DRtgElecDemand      = {   if (LocalCompAssigned( RunResults[10] ) == 0 .OR. LocalStatus( RunResults[10]:DRtgElecDemand ) < 1) then  UNDEFINED
																												         else  ValidOr( RunResults[10]:DRtgElecDemand, 0 )  endif  }
	"Set ResultSummary[1]:MarginkW[2]"		   Proj:ResultSummary[1]:MarginkW[2]	      = {	if (LocalCompAssigned( RunResults[10] ) == 0 .OR. LocalStatus( ResultSummary[1]:PropElecDemand[2] ) < 1) then  UNDEFINED
																												         else  int(((ResultSummary[1]:DRtgElecDemand - ResultSummary[1]:PropElecDemand[2]) * 100) +0.5 ) / 100  endif  }
  ; Percent Savings values for reporting
	"Set ResultSummary[1]:PctSavingskW"			Proj:ResultSummary[1]:PctSavingskW		= {	if (IfValidAnd( RunResults[10]:StdElecDemand > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[10]:StdElecDemand   - ValidOr( RunResults[10]:PropElecDemand[1],   0 )) * 100 / RunResults[10]:StdElecDemand  ) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[1]:PctSavingskWh"		Proj:ResultSummary[1]:PctSavingskWh		= {	if (IfValidAnd( RunResults[10]:StdElecEnergy > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[10]:StdElecEnergy   - ValidOr( RunResults[10]:PropElecEnergy[1],   0 )) * 100 / RunResults[10]:StdElecEnergy  ) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[1]:PctSavingsTherms"	Proj:ResultSummary[1]:PctSavingsTherms	= {	if (IfValidAnd( RunResults[10]:StdNatGasEnergy > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[10]:StdNatGasEnergy - ValidOr( RunResults[10]:PropNatGasEnergy[1], 0 )) * 100 / RunResults[10]:StdNatGasEnergy) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[1]:PctSavingsTDV"		Proj:ResultSummary[1]:PctSavingsTDV		= {	if (IfValidAnd( RunResults[10]:StandardTDV     > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[10]:StandardTDV     - ValidOr( RunResults[10]:ProposedTDV[1],      0 )) * 100 / RunResults[10]:StandardTDV    ) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[1]:PctSavingsCmpTDV"	Proj:ResultSummary[1]:PctSavingsCmpTDV	= {	if (IfValidAnd( RunResults[11]:StandardTDV     > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[11]:StandardTDV     - ValidOr( RunResults[11]:ProposedTDV[1],      0 )) * 100 / RunResults[11]:StandardTDV    ) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[1]:PctSavingsSrc"		Proj:ResultSummary[1]:PctSavingsSrc		= {	if (IfValidAnd( RunResults[10]:StandardSrc     > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[10]:StandardSrc     - ValidOr( RunResults[10]:ProposedSrc[1],      0 )) * 100 / RunResults[10]:StandardSrc    ) * 10) +0.5 ) / 10  endif  }     ; SAC 11/26/22
	"Set ResultSummary[1]:PctSavkWLbl"			Proj:ResultSummary[1]:PctSavkWLbl		= {	if (IfValidAnd( ResultSummary[1]:PctSavingskW     > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[1]:PctSavingskW     < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[1]:PctSavingskW     )  endif  }
	"Set ResultSummary[1]:PctSavkWhLbl"			Proj:ResultSummary[1]:PctSavkWhLbl		= {	if (IfValidAnd( ResultSummary[1]:PctSavingskWh    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[1]:PctSavingskWh    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[1]:PctSavingskWh    )  endif  }
	"Set ResultSummary[1]:PctSavThermsLbl"		Proj:ResultSummary[1]:PctSavThermsLbl	= {	if (IfValidAnd( ResultSummary[1]:PctSavingsTherms > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[1]:PctSavingsTherms < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[1]:PctSavingsTherms )  endif  }
	"Set ResultSummary[1]:PctSavTDVLbl"			Proj:ResultSummary[1]:PctSavTDVLbl		= {	if (IfValidAnd( ResultSummary[1]:PctSavingsTDV    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[1]:PctSavingsTDV    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[1]:PctSavingsTDV    )  endif  }
	"Set ResultSummary[1]:PctSavCmpTDVLbl"		Proj:ResultSummary[1]:PctSavCmpTDVLbl	= {	if (EnergyCodeYearNum >= 2025 .AND. LocalStatus( ResultSummary[1]:PctSavCmpTDVLbl ) > 0) then  UNCHANGED  else if (IfValidAnd( ResultSummary[1]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[1]:PctSavingsCmpTDV < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[1]:PctSavingsCmpTDV )  endif endif  }   ; avoid overwrite of label set in SUC credit rules - SAC 07/31/23 (2025)
	"Set ResultSummary[1]:PctSavSrcLbl"			Proj:ResultSummary[1]:PctSavSrcLbl		= {	if (IfValidAnd( ResultSummary[1]:PctSavingsSrc    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[1]:PctSavingsSrc    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[1]:PctSavingsSrc    )  endif  }   ; SAC 11/26/22
	; SAC 3/21/16 - added tier results
	; SAC 5/23/16 - modified to require QII (tic #671)
	"Set ResultSummary[1]:MeetsTier1"			Proj:ResultSummary[1]:MeetsTier1		= {	if (StdDesignBase >= 2016 .AND. IfValidAnd( ResultSummary[1]:PctSavingsCmpTDV >= 14.95 ) .AND.
																															IfValidAnd( HERSProj:QII > 0.5 )) then  1  else  0  endif  }
	"Set ResultSummary[1]:MeetsTier2"			Proj:ResultSummary[1]:MeetsTier2		= {	if (StdDesignBase >= 2016 .AND. IfValidAnd( ResultSummary[1]:PctSavingsCmpTDV >= 29.95 ) .AND.
																															IfValidAnd( HERSProj:QII > 0.5 )) then  1  else  0  endif  }
	; SAC 3/25/16 - moved MeetsZNETier rule down into ...DesignRatingSummary rulelist
	;"Set ResultSummary[1]:MeetsZNETier"			Proj:ResultSummary[1]:MeetsZNETier	= {	if (IfValidAnd( HERSProj:QII > 0.5 )==0 .OR. IfValidAnd( ResultSummary[1]:DesignRating < 0.05 )==0) then  0
	;																												else if (ResultSummary[1]:MeetsTier2 > 0.5) then  1
	;																												else if (ResultSummary[1]:MeetsTier1 > 0.5 .AND. IsMultiFamily < 0.5)
	;																												then  if (T24RClimateZoneCodeBase:MinZNETier( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) < 1.5) then  1  else  0  endif
	;																												else if (ResultSummary[1]:MeetsTier1 > 0.5 .AND. IsMultiFamily > 0.5)
	;																												then  if (T24RClimateZoneCodeBase:MinZNETier( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) < 1.5) then  1  else  0  endif
	;																												else  0  endif endif endif endif  }

         ; SAC 12/02/20 - add in PV export results (primarily for 2022 research)
   "Set Proj:ResultSummary[1]:StdPV_Total kWh"        Proj:ResultSummary[1]:StdPV_Total     =
      {  -1 * ValidOr( RunResults[13]:StdElecEnergy[1], 0 ) * CondFloorArea / 3.412  }
   "Set Proj:ResultSummary[1]:StdPV_Export kWh"       Proj:ResultSummary[1]:StdPV_Export    =
      {  if (IfValidAnd( ResultSummary[1]:StdPV_Total > 0 )==0) then  0
         else  -1 * ApplyHourlyResultMultipliers_Neg( "none", "none", 1, 1, "none", 0, 0, "Standard", "MtrElec", "Tot" ) / 3.412
         endif  }
   "Set Proj:ResultSummary[1]:StdPV_PctExport %"      Proj:ResultSummary[1]:StdPV_PctExport =
      {  if (IfValidAnd( ResultSummary[1]:StdPV_Export > 0 )==0) then  0
         else  ResultSummary[1]:StdPV_Export * 100 / ResultSummary[1]:StdPV_Total  endif  }

   ; SAC 4/11/19 - moved HERE from DRtg results rules so that calced for EAA runs as well
   "Set CO2 details results"   Proj:Action  =         ; SAC 2/4/19 - split out from CO2DesignRatings results above
      {  if (IfValidAnd( EnergyCodeYearNum >= 2019 ))
         then  if (AllOrientations < 0.5)
               then  EvalRulelist( "CARes_CO2Details_SingleOrientation" )
               else  EvalRulelist( "CARes_CO2Details_AllOrientations" )  endif
         else  UNCHANGED  endif  }
END

;************************************************************************* SAC 07/19/23 (2025)
RULELIST "CARes_StandardSummary_PVonly" 1 0 1 1
;*************************************************************************
  ; Standard TDV
 	"Set ResultSummary[1]:Enduse10[7]"			Proj:ResultSummary[1]:Enduse10[7]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[10]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse11[7]"			Proj:ResultSummary[1]:Enduse11[7]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[11]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse12[7]"			Proj:ResultSummary[1]:Enduse12[7]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:StandardTDV ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse13[7]"			Proj:ResultSummary[1]:Enduse13[7]	= {	if (LocalCompAssigned( RunResults[13] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResults[13]:StandardTDV = 0 )) then  " "  else  FltToStr( LocalRef( RunResults[13]:StandardTDV ), 2 )  endif endif  }
	"Set ResultSummary[1]:Enduse14[7]"			Proj:ResultSummary[1]:Enduse14[7]	= {	if (LocalCompAssigned( RunResults[14] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResults[14]:StandardTDV = 0 )) then  " "  else  FltToStr( LocalRef( RunResults[14]:StandardTDV ), 2 )  endif endif  }
  ; SAC 4/17/15 - copy CompResultsMsg down from Proj into EUseSummary (to ensure that it is carried into subsequent models and back to user input)
	"Set ResultSummary[1]:CompResultsMsg"		Proj:ResultSummary[1]:CompResultsMsg	= {	if (GlobalStatus( Proj:CompResultsMsg ) > 0) then  Proj:CompResultsMsg  else  UNCHANGED  endif  }
  ; SAC 3/3/16 - ensure access to PVMinRatedPower in projects following analysis (tic #609)
	"Set ResultSummary[1]:PVMinRatedPower"		Proj:ResultSummary[1]:PVMinRatedPower	= {	if (IfValidAnd( Proj:PVCompCredit > 0 ) .AND. IfValidAnd( Proj:PVCredit[1] > 0 ) .AND. IfValidAnd( Proj:PVMinRatedPower[2] > 0 ))
																														then  Proj:PVMinRatedPower[2]  else  UNCHANGED  endif  }

  ; Compliance Margin TDV
 	"Set ResultSummary[1]:Enduse10[8]"			Proj:ResultSummary[1]:Enduse10[8]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[10]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse11[8]"			Proj:ResultSummary[1]:Enduse11[8]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[11]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse12[8]"			Proj:ResultSummary[1]:Enduse12[8]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:CompMarginTDV ), 2 )  endif  }
   ; SAC 1/14/13 - added PVCredit stuff
 	;"Set ResultSummary[1]:Enduse13[8]"			Proj:ResultSummary[1]:Enduse13[8]	= {	FltToStr( PVCredit[1], 2 )  }
   ; SAC 10/6/16 - 2019 PV
 	"Set ResultSummary[1]:Enduse13[8]"			Proj:ResultSummary[1]:Enduse13[8]	= {	if (EnergyCodeYearNum >= 2019)
                                                                                 then  if (LocalCompAssigned( RunResults[13] ) == 0) then  UNDEFINED  else  FltToStr( RunResults[13]:CompMarginTDV,     2 )  endif
                                                                                 else  if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[6]:PropPVCreditTDV[1], 2 )  endif  endif  }	; SAC 1/28/16 - leave std PV credit alone

 	"Set ResultSummary[1]:MetricPassFail[1] (SLCC-Eff)"   Proj:ResultSummary[1]:MetricPassFail[1] = {	if (EnergyCodeYearNum < 2025 .OR. LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  if (RunResults[11]:CompMarginTDV >= 0) then "Pass"  else  "Fail"  endif endif  }  ; SAC 11/22/22 (2025)
 	"Set ResultSummary[1]:MetricPassFail[2] (SLCC-Tot)"   Proj:ResultSummary[1]:MetricPassFail[2] = {	if (EnergyCodeYearNum < 2025 .OR. LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  if (RunResults[10]:CompMarginTDV >= 0) then "Pass"  else  "Fail"  endif endif  } 
 	"Set ResultSummary[1]:MetricPassFail[3] (Src-Tot)"    Proj:ResultSummary[1]:MetricPassFail[3] = {	if (EnergyCodeYearNum < 2025 .OR. LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  if (RunResults[10]:CompMarginSrc >= 0) then "Pass"  else  "Fail"  endif endif  } 
 	"Set ResultSummary[1]:PassFail"				Proj:ResultSummary[1]:PassFail		= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  if (RunResults[11]:CompMarginTDV >= 0) then "PASS"  else  "FAIL"  endif endif  }

  ; Percent Savings values for reporting
	"Set ResultSummary[1]:PctSavingsTDV"		Proj:ResultSummary[1]:PctSavingsTDV		= {	if (IfValidAnd( RunResults[10]:StandardTDV     > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[10]:StandardTDV     - ValidOr( RunResults[10]:ProposedTDV[1],      0 )) * 100 / RunResults[10]:StandardTDV    ) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[1]:PctSavingsCmpTDV"	Proj:ResultSummary[1]:PctSavingsCmpTDV	= {	if (IfValidAnd( RunResults[11]:StandardTDV     > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[11]:StandardTDV     - ValidOr( RunResults[11]:ProposedTDV[1],      0 )) * 100 / RunResults[11]:StandardTDV    ) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[1]:PctSavTDVLbl"			Proj:ResultSummary[1]:PctSavTDVLbl		= {	if (IfValidAnd( ResultSummary[1]:PctSavingsTDV    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[1]:PctSavingsTDV    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[1]:PctSavingsTDV    )  endif  }
	"Set ResultSummary[1]:PctSavCmpTDVLbl"		Proj:ResultSummary[1]:PctSavCmpTDVLbl	= {	if (IfValidAnd( ResultSummary[1]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[1]:PctSavingsCmpTDV < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[1]:PctSavingsCmpTDV )  endif  }
	; SAC 3/21/16 - added tier results
	; SAC 5/23/16 - modified to require QII (tic #671)
	"Set ResultSummary[1]:MeetsTier1"			Proj:ResultSummary[1]:MeetsTier1		= {	if (StdDesignBase >= 2016 .AND. IfValidAnd( ResultSummary[1]:PctSavingsCmpTDV >= 14.95 ) .AND.
																															IfValidAnd( HERSProj:QII > 0.5 )) then  1  else  0  endif  }
	"Set ResultSummary[1]:MeetsTier2"			Proj:ResultSummary[1]:MeetsTier2		= {	if (StdDesignBase >= 2016 .AND. IfValidAnd( ResultSummary[1]:PctSavingsCmpTDV >= 29.95 ) .AND.
																															IfValidAnd( HERSProj:QII > 0.5 )) then  1  else  0  endif  }

         ; SAC 12/02/20 - add in PV export results (primarily for 2022 research)
   "Set Proj:ResultSummary[1]:StdPV_Total kWh"        Proj:ResultSummary[1]:StdPV_Total     =
      {  -1 * ValidOr( RunResults[13]:StdElecEnergy[1], 0 ) * CondFloorArea / 3.412  }
   "Set Proj:ResultSummary[1]:StdPV_Export kWh"       Proj:ResultSummary[1]:StdPV_Export    =
      {  if (IfValidAnd( ResultSummary[1]:StdPV_Total > 0 )==0) then  0
         else  -1 * ApplyHourlyResultMultipliers_Neg( "none", "none", 1, 1, "none", 0, 0, "Standard", "MtrElec", "Tot" ) / 3.412
         endif  }
   "Set Proj:ResultSummary[1]:StdPV_PctExport %"      Proj:ResultSummary[1]:StdPV_PctExport =
      {  if (IfValidAnd( ResultSummary[1]:StdPV_Export > 0 )==0) then  0
         else  ResultSummary[1]:StdPV_Export * 100 / ResultSummary[1]:StdPV_Total  endif  }

;   ; SAC 4/11/19 - moved HERE from DRtg results rules so that calced for EAA runs as well
;   "Set CO2 details results"   Proj:Action  =         ; SAC 2/4/19 - split out from CO2DesignRatings results above
;      {  if (IfValidAnd( EnergyCodeYearNum >= 2019 ))
;         then  if (AllOrientations < 0.5)
;               then  EvalRulelist( "CARes_CO2Details_SingleOrientation" )
;               else  EvalRulelist( "CARes_CO2Details_AllOrientations" )  endif
;         else  UNCHANGED  endif  }
END

;************************************************************************* SAC 07/21/23
RULELIST "CARes_SelfUtilizationCredit_2025" 1 0 1 1
;*************************************************************************
   ; SAC 1/22/18 - Battery adjustments for GHC to Compliance Enduse Details (grid harmonization credit)
	"Set ResultSummary[1]:Enduse99[2]"			Proj:ResultSummary[1]:Enduse99[2]	= {
         if (IfValidAnd( ResultSummary[1]:GHCEnergyEffElec   > 0.00001 )==0 .AND.
             IfValidAnd( ResultSummary[1]:DHWSlrPVCreditElec < -0.0001 )==0) then  UNDEFINED  
         else  FltToStr( (int(       ValidOr( ResultSummary[1]:GHCEnergyEffElec  , 0 )  + 0.5 ) -
                          int( (-1 * ValidOr( ResultSummary[1]:DHWSlrPVCreditElec, 0 )) + 0.5 )), 0 )  endif  }
	"Adj ResultSummary[1]:Enduse14[2]"			Proj:ResultSummary[1]:Enduse14[2]	= {
         if (LocalStatus( ResultSummary[1]:Enduse99[2] ) < 1) then  UNCHANGED  
         else if (ResultSummary[1]:GHCEnergyEffCap >= (-1 * RunResults[14]:ProposedTDV[1])) then  UNDEFINED
         else  FltToStr( (int( (RunResults[14]:PropElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 ) -
                          int( ResultSummary[1]:GHCEnergyEffElec + 0.5 )), 0 )  endif endif  }
	"Adj ResultSummary[1]:Enduse13[2]"			Proj:ResultSummary[1]:Enduse13[2]	= {
         if (LocalStatus( ResultSummary[1]:Enduse99[2] ) < 1) then  UNCHANGED  
         else if (IfValidAnd( ResultSummary[1]:DHWSlrPVCreditFrac > 0.999 )) then  UNDEFINED
         else  FltToStr( (int( (RunResults[13]:PropElecEnergy * Proj:CondFloorArea / 3.413) - 0.5 ) +
                          int( (-1 * ValidOr( ResultSummary[1]:DHWSlrPVCreditElec, 0 )) + 0.5 )), 0 )  endif endif  }
	"Adj ResultSummary[1]:Enduse11[2]"			Proj:ResultSummary[1]:Enduse11[2]	=        ; added adjustment to Enduse11[2] (CompElecUse) - SAC 07/31/23 (2025)
      {  if (IfValidAnd( ResultSummary[1]:GHCEnergyEffElec   > 0.00001 )==0 .AND.
             IfValidAnd( ResultSummary[1]:DHWSlrPVCreditElec < -0.0001 )==0) then  UNCHANGED
         else  FltToStr( ( int( (RunResults[11]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 ) +
                           int(       ValidOr( ResultSummary[1]:GHCEnergyEffElec  , 0 )  + 0.5 ) -
                           int( (-1 * ValidOr( ResultSummary[1]:DHWSlrPVCreditElec, 0 )) + 0.5 ) ), 0 )  endif  }

   ; SAC 1/27/19 - Reporting of Flexibility credit (tic #1053)
   ; SAC 2/2/19 - revised logic to reference new PFlxTDV property (tic #1053)
	"Set ResultSummary[1]:Enduse98[17]"			Proj:ResultSummary[1]:Enduse98[17]	= {
			if (LocalStatus( ResultSummary[1]:PFlxElecEnergy[1] ) < 1) then  UNDEFINED
         else  FltToStr( ResultSummary[1]:PFlxElecEnergy[1], 0 )  endif  }
	"Set ResultSummary[1]:Enduse98[2]"			Proj:ResultSummary[1]:Enduse98[2]	= {  ResultSummary[1]:Enduse98[17]  }
   ; SAC 1/27/19 - included Flexibility credit (tic #1053)
	"Set ResultSummary[1]:Enduse10[2]"			Proj:ResultSummary[1]:Enduse10[2]	= {
	      if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  
			else  FltToStr( (int( ( RunResults[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )) + ValidOr( ResultSummary[1]:PFlxElecEnergy[1], 0 ), 0 )  endif  }

   ; SAC 1/22/18 - Battery adjustments for GHC to Compliance Enduse Details (grid harmonization credit)
	"Set ResultSummary[1]:Enduse99[4]"			Proj:ResultSummary[1]:Enduse99[4]	= {
         if (IfValidAnd( ResultSummary[1]:GHCEnergyEffTDV   > 0.00001 )==0 .AND.
             IfValidAnd( ResultSummary[1]:DHWSlrPVCreditTDV > 0.00001 )==0) then  "0.00"  
         else  FltToStr( (-1 * (ValidOr( ResultSummary[1]:GHCEnergyEffTDV  , 0 ) +
                                ValidOr( ResultSummary[1]:DHWSlrPVCreditTDV, 0 ))), 2 )  endif  }
	"Adj ResultSummary[1]:Enduse14[4]"			Proj:ResultSummary[1]:Enduse14[4]	= {
         if (IfValidAnd( ResultSummary[1]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResults[14]:ProposedTDV[1] + ResultSummary[1]:GHCEnergyEffTDV), 2 )  endif  }
	"Adj ResultSummary[1]:Enduse13[4]"			Proj:ResultSummary[1]:Enduse13[4]	= {
         if (IfValidAnd( ResultSummary[1]:DHWSlrPVCreditTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResults[13]:ProposedTDV[1] + ResultSummary[1]:DHWSlrPVCreditTDV), 2 )  endif  }

   ; SAC 1/27/19 - Reporting of Flexibility credit (tic #1053)
   ; SAC 2/2/19 - revised logic to reference new PFlxTDV property (tic #1053)    ; SAC 07/22/23
	"Set ResultSummary[1]:Enduse98[19]"			Proj:ResultSummary[1]:Enduse98[19]	= {
			if (LocalStatus( ResultSummary[1]:PFlxTDV[1] ) < 1) then  UNDEFINED
         else  FltToStr( ResultSummary[1]:PFlxTDV[1], 2 )  endif  }
	"Set ResultSummary[1]:Enduse98[4]"			Proj:ResultSummary[1]:Enduse98[4]	= {  ResultSummary[1]:Enduse98[19]  }
   ; SAC 1/27/19 - included Flexibility credit (tic #1053)
	"Set ResultSummary[1]:Enduse10[4]"			Proj:ResultSummary[1]:Enduse10[4]	= {
	      if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED
	      else  FltToStr( (int(RunResults[10]:ProposedTDV[1]*100+0.5)/100) + ValidOr( ResultSummary[1]:PFlxTDV[1], 0 ), 2 )  endif  }

   ; SAC 1/22/18 - Battery adjustments for GHC to Compliance Enduse Details (grid harmonization credit)
	"Set ResultSummary[1]:Enduse99[8]"			Proj:ResultSummary[1]:Enduse99[8]	= {
         if (IfValidAnd( ResultSummary[1]:GHCEnergyEffTDV   > 0.00001 )==0 .AND.
             IfValidAnd( ResultSummary[1]:DHWSlrPVCreditTDV > 0.00001 )==0) then  "0.00"  
         else  FltToStr( (ValidOr( ResultSummary[1]:GHCEnergyEffTDV  , 0 ) +
                          ValidOr( ResultSummary[1]:DHWSlrPVCreditTDV, 0 )), 2 )  endif  }
	"Adj ResultSummary[1]:Enduse14[8]"			Proj:ResultSummary[1]:Enduse14[8]	= {
         if (IfValidAnd( ResultSummary[1]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResults[14]:StandardTDV - RunResults[14]:ProposedTDV[1] - ResultSummary[1]:GHCEnergyEffTDV), 2 )  endif  }
	"Adj ResultSummary[1]:Enduse13[8]"			Proj:ResultSummary[1]:Enduse13[8]	= {
         if (IfValidAnd( ResultSummary[1]:DHWSlrPVCreditTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResults[13]:StandardTDV - RunResults[13]:ProposedTDV[1] - ResultSummary[1]:DHWSlrPVCreditTDV), 2 )  endif  }

   ; SAC 1/22/18 - Compliance Total adjustments for Battery GHC (grid harmonization credit)
	"Adj ResultSummary[1]:Enduse11[4]"			Proj:ResultSummary[1]:Enduse11[4]	= {
         if (LocalCompAssigned( RunResults[11] ) == 0 .OR. (IfValidAnd( ResultSummary[1]:GHCEnergyEffTDV   > 0.00001 )==0 .AND.
                                                            IfValidAnd( ResultSummary[1]:DHWSlrPVCreditTDV > 0.00001 )==0)) then  UNCHANGED
         else  FltToStr( (RunResults[11]:ProposedTDV[1] - ValidOr( ResultSummary[1]:GHCEnergyEffTDV  , 0 ) -
                                                          ValidOr( ResultSummary[1]:DHWSlrPVCreditTDV, 0 )), 2 )  endif  }
 	"Adj ResultSummary[1]:Enduse11[8]"			Proj:ResultSummary[1]:Enduse11[8]	= {
         if (LocalCompAssigned( RunResults[11] ) == 0 .OR. (IfValidAnd( ResultSummary[1]:GHCEnergyEffTDV   > 0.00001 )==0 .AND.
                                                            IfValidAnd( ResultSummary[1]:DHWSlrPVCreditTDV > 0.00001 )==0)) then  UNCHANGED
         else  FltToStr( (RunResults[11]:CompMarginTDV + ValidOr( ResultSummary[1]:GHCEnergyEffTDV  , 0 ) +
                                                         ValidOr( ResultSummary[1]:DHWSlrPVCreditTDV, 0 )), 2 )  endif  }
   ;"RE-Calc TDV Comp Margin - Comp Ttl" 	Proj:RunResults[11]:CompMarginTDV	=
   ;   {  if (IfValidAnd( RunResults[11]:StandardTDV > 0.001 )==0 .OR. (IfValidAnd( ResultSummary[1]:GHCEnergyEffTDV   > 0.00001 )==0 .AND.
   ;                                                                    IfValidAnd( ResultSummary[1]:DHWSlrPVCreditTDV > 0.00001 )==0)) then  UNCHANGED
   ;      else  RunResults[11]:StandardTDV - ValidOr( RunResults[11]:ProposedTDV[1], 0 ) +
   ;            ValidOr( ResultSummary[1]:GHCEnergyEffTDV, 0 ) + ValidOr( ResultSummary[1]:DHWSlrPVCreditTDV, 0 )
   ;         }
	"Adj ResultSummary[1]:PctSavingsCmpTDV"	Proj:ResultSummary[1]:PctSavingsCmpTDV	= {
         if (IfValidAnd( RunResults[11]:StandardTDV > 0.001 )==0) then  UNCHANGED
         else  int((((RunResults[11]:StandardTDV - ValidOr( RunResults[11]:ProposedTDV[1], 0 ) +
                      ValidOr( ResultSummary[1]:GHCEnergyEffTDV, 0 ) + ValidOr( ResultSummary[1]:DHWSlrPVCreditTDV, 0 )) * 100 / RunResults[11]:StandardTDV ) * 10) +0.5 ) / 10  endif  }
      ;   if (IfValidAnd( RunResults[11]:StandardTDV > 0.001 )==0 .OR. (IfValidAnd( ResultSummary[1]:GHCEnergyEffTDV   > 0.00001 )==0 .AND.
      ;                                                                 IfValidAnd( ResultSummary[1]:DHWSlrPVCreditTDV > 0.00001 )==0)) then  UNCHANGED
	"Adj ResultSummary[1]:PctSavCmpTDVLbl"		Proj:ResultSummary[1]:PctSavCmpTDVLbl	= {
         if (IfValidAnd( ResultSummary[1]:GHCEnergyEffTDV   > 0.00001 )==0 .AND.
             IfValidAnd( ResultSummary[1]:DHWSlrPVCreditTDV > 0.00001 )==0) then  UNCHANGED
         else if (IfValidAnd( ResultSummary[1]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[1]:PctSavingsCmpTDV < -0.0001 )==0) then  "-" 
         else  Format( "%.1f", ResultSummary[1]:PctSavingsCmpTDV )  endif endif  }
 	"Set ResultSummary[1]:MetricPassFail[1] (LSC-Eff)"   Proj:ResultSummary[1]:MetricPassFail[1] =        ; moved from rulelist above - SAC 07/31/23 (2025)
      {  if (IfValidAnd( ResultSummary[1]:PctSavingsCmpTDV >= -0.0001 )) then  "Pass"  else  "Fail"  endif  }
END


;*************************************************************************
RULELIST "CARes_DesignRatingSummary" 1 0 1 1
;*************************************************************************
   "Set GridHarmCred & StdDesign results for single orientation run"    Proj:Action = {
         if (AllOrientations < 0.5)
         then  EvalRulelist( "CARes_DesignRatingSummary_SingleOrientation" )
         else  EvalRulelist( "CARes_DesignRatingSummary_AllOrientations" )  endif  }

  ; DesignRating Site Electric Use
	"Set ResultSummary[1]:Title1[12]"			Proj:ResultSummary[1]:Title1[12]		= {	if (EnergyCodeYearNum < 2022) then  "Reference"   else if (EnergyCodeYearNum < 2025) then  "Reference Design:"  else  "Reference Design"  endif endif  }  // SAC 12/01/22
	"Set ResultSummary[1]:Title2[12]"			Proj:ResultSummary[1]:Title2[12]		= {	if (EnergyCodeYearNum < 2022) then  "Design"      else if (EnergyCodeYearNum < 2025) then  "Site"               else  "Site Elec."        endif endif  }
	"Set ResultSummary[1]:Title3[12]"			Proj:ResultSummary[1]:Title3[12]		= {	if (EnergyCodeYearNum < 2022) then  "Site (kWh)"  else  "(kWh/yr)"              endif  }
	"Set ResultSummary[1]:Enduse1[12]"			Proj:ResultSummary[1]:Enduse1[12]	= {	if (LocalCompAssigned( RunResults[1]  ) == 0 .OR. RunResults[1]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[1]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse2[12]"			Proj:ResultSummary[1]:Enduse2[12]	= {	if (LocalCompAssigned( RunResults[2]  ) == 0 .OR. RunResults[2]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[2]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse3[12]"			Proj:ResultSummary[1]:Enduse3[12]	= {	if (LocalCompAssigned( RunResults[3]  ) == 0 .OR. RunResults[3]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[3]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse4[12]"			Proj:ResultSummary[1]:Enduse4[12]	= {	if (LocalCompAssigned( RunResults[4]  ) == 0 .OR. RunResults[4]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[4]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse5[12]"			Proj:ResultSummary[1]:Enduse5[12]	= {	if (LocalCompAssigned( RunResults[5]  ) == 0 .OR. RunResults[5]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[5]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse14[12]"			Proj:ResultSummary[1]:Enduse14[12]	= {	if (LocalCompAssigned( RunResults[14] ) == 0 .OR. RunResults[14]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[14]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse6[12]"			Proj:ResultSummary[1]:Enduse6[12]	= {	if (LocalCompAssigned( RunResults[6]  ) == 0 .OR. RunResults[6]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[6]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse7[12]"			Proj:ResultSummary[1]:Enduse7[12]	= {	if (LocalCompAssigned( RunResults[7]  ) == 0 .OR. RunResults[7]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[7]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse8[12]"			Proj:ResultSummary[1]:Enduse8[12]	= {	if (LocalCompAssigned( RunResults[8]  ) == 0 .OR. RunResults[8]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[8]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse9[12]"			Proj:ResultSummary[1]:Enduse9[12]	= {	if (LocalCompAssigned( RunResults[9]  ) == 0 .OR. RunResults[9]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[9]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse10[12]"			Proj:ResultSummary[1]:Enduse10[12]	= {	if (LocalCompAssigned( RunResults[10] ) == 0 .OR. RunResults[10]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[10]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse11[12]"			Proj:ResultSummary[1]:Enduse11[12]	= {	if (LocalCompAssigned( RunResults[11] ) == 0 .OR. RunResults[11]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[11]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse12[12]"			Proj:ResultSummary[1]:Enduse12[12]	= {	if (LocalCompAssigned( RunResults[12] ) == 0 .OR. RunResults[12]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[12]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse13[12]"			Proj:ResultSummary[1]:Enduse13[12]	= {	if (LocalCompAssigned( RunResults[13] ) == 0 .OR. RunResults[13]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[13]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
	"Set ResultSummary[1]:Enduse10[17]"			Proj:ResultSummary[1]:Enduse10[17]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[10]:PropElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse11[17]"			Proj:ResultSummary[1]:Enduse11[17]	= {	if (LocalCompAssigned( RunResults[11] ) == 0 .OR. RunResults[11]:PropElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[11]:PropElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse12[17]"			Proj:ResultSummary[1]:Enduse12[17]	= {	if (LocalCompAssigned( RunResults[12] ) == 0 .OR. RunResults[12]:PropElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[12]:PropElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse13[17]"			Proj:ResultSummary[1]:Enduse13[17]	= {	if (LocalCompAssigned( RunResults[13] ) == 0 .OR. RunResults[13]:PropElecEnergy > 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[13]:PropElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
   ; SAC 12/28/17 - Battery adjustments for GHC (grid harmonization credit)
   ; PLUS adjustments for DHW StdSolar PV credit - SAC 5/5/20 (FlexibilityCredit)
	"Set ResultSummary[1]:Enduse99[17]"			Proj:ResultSummary[1]:Enduse99[17]	= {
         if (IfValidAnd( ResultSummary[1]:GHCEnergyEffElec   > 0.00001 )==0 .AND.
             IfValidAnd( ResultSummary[1]:DHWSlrPVCreditElec < -0.0001 )==0) then  UNDEFINED  
         else  FltToStr( (int(       ValidOr( ResultSummary[1]:GHCEnergyEffElec  , 0 )  + 0.5 ) -
                          int( (-1 * ValidOr( ResultSummary[1]:DHWSlrPVCreditElec, 0 )) + 0.5 )), 0 )  endif  }
	"Adj ResultSummary[1]:Enduse14[17]"			Proj:ResultSummary[1]:Enduse14[17]	= {
         if (LocalStatus( ResultSummary[1]:Enduse99[17] ) < 1) then  UNCHANGED  
         else if (ResultSummary[1]:GHCEnergyEffCap >= (-1 * RunResults[14]:ProposedTDV[3])) then  UNDEFINED
         else  FltToStr( (int( (RunResults[14]:PropElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 ) -
                          int( ResultSummary[1]:GHCEnergyEffElec + 0.5 )), 0 )  endif endif  }
	"Adj ResultSummary[1]:Enduse13[17]"			Proj:ResultSummary[1]:Enduse13[17]	= {
         if (LocalStatus( ResultSummary[1]:Enduse99[17] ) < 1) then  UNCHANGED  
         else if (IfValidAnd( ResultSummary[1]:DHWSlrPVCreditFrac > 0.999 )) then  UNDEFINED
         else  FltToStr( (int( (RunResults[13]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) - 0.5 ) +
                          int( (-1 * ValidOr( ResultSummary[1]:DHWSlrPVCreditElec, 0 )) + 0.5 )), 0 )  endif endif  }
   ; SAC 1/22/18 - Battery adjustments for GHC to Compliance Enduse Details (grid harmonization credit)
	"Set ResultSummary[1]:Enduse99[2]"			Proj:ResultSummary[1]:Enduse99[2]	= {
         if (IfValidAnd( ResultSummary[1]:GHCEnergyEffElec   > 0.00001 )==0 .AND.
             IfValidAnd( ResultSummary[1]:DHWSlrPVCreditElec < -0.0001 )==0) then  UNDEFINED  
         else  FltToStr( (int(       ValidOr( ResultSummary[1]:GHCEnergyEffElec  , 0 )  + 0.5 ) -
                          int( (-1 * ValidOr( ResultSummary[1]:DHWSlrPVCreditElec, 0 )) + 0.5 )), 0 )  endif  }
	"Adj ResultSummary[1]:Enduse14[2]"			Proj:ResultSummary[1]:Enduse14[2]	= {
         if (LocalStatus( ResultSummary[1]:Enduse99[2] ) < 1) then  UNCHANGED  
         else if (ResultSummary[1]:GHCEnergyEffCap >= (-1 * RunResults[14]:ProposedTDV[1])) then  UNDEFINED
         else  FltToStr( (int( (RunResults[14]:PropElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 ) -
                          int( ResultSummary[1]:GHCEnergyEffElec + 0.5 )), 0 )  endif endif  }
	"Adj ResultSummary[1]:Enduse13[2]"			Proj:ResultSummary[1]:Enduse13[2]	= {
         if (LocalStatus( ResultSummary[1]:Enduse99[2] ) < 1) then  UNCHANGED  
         else if (IfValidAnd( ResultSummary[1]:DHWSlrPVCreditFrac > 0.999 )) then  UNDEFINED
         else  FltToStr( (int( (RunResults[13]:PropElecEnergy * Proj:CondFloorArea / 3.413) - 0.5 ) +
                          int( (-1 * ValidOr( ResultSummary[1]:DHWSlrPVCreditElec, 0 )) + 0.5 )), 0 )  endif endif  }
   ; SAC 1/27/19 - Reporting of Flexibility credit (tic #1053)
   ; SAC 2/2/19 - revised logic to reference new PFlxTDV property (tic #1053)
	"Set ResultSummary[1]:Enduse98[17]"			Proj:ResultSummary[1]:Enduse98[17]	= {
			if (LocalStatus( ResultSummary[1]:PFlxElecEnergy[1] ) < 1) then  UNDEFINED
         else  FltToStr( ResultSummary[1]:PFlxElecEnergy[1], 0 )  endif  }
	"Set ResultSummary[1]:Enduse98[2]"			Proj:ResultSummary[1]:Enduse98[2]	= {  ResultSummary[1]:Enduse98[17]  }
   ; SAC 1/27/19 - included Flexibility credit (tic #1053)
	"Set ResultSummary[1]:Enduse10[2]"			Proj:ResultSummary[1]:Enduse10[2]	= {
	      if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  
			else  FltToStr( (int( ( RunResults[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )) + ValidOr( ResultSummary[1]:PFlxElecEnergy[1], 0 ), 0 )  endif  }

  ; DesignRating Site Natural Gas Use
	"Set ResultSummary[1]:Title1[13]"			Proj:ResultSummary[1]:Title1[13]		= {	if (EnergyCodeYearNum < 2022) then  "Reference"      else  UNDEFINED   endif  }
	"Set ResultSummary[1]:Title2[13]"			Proj:ResultSummary[1]:Title2[13]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "Site"  else  "Site Gas"  endif endif  }  ; SAC 12/01/22
	"Set ResultSummary[1]:Title3[13]"			Proj:ResultSummary[1]:Title3[13]		= {	if (EnergyCodeYearNum < 2022) then  "Site (therms)"  else  "(therms/yr)"  endif  }
	"Set ResultSummary[1]:Enduse1[13]"			Proj:ResultSummary[1]:Enduse1[13]	= {	if (LocalCompAssigned( RunResults[1]  ) == 0 .OR.  (RunResults[1]:DRtgNatGasEnergy  < 0.00001 .AND. RunResults[1]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[1]:DRtgNatGasEnergy  + RunResults[1]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse2[13]"			Proj:ResultSummary[1]:Enduse2[13]	= {	if (LocalCompAssigned( RunResults[2]  ) == 0 .OR.  (RunResults[2]:DRtgNatGasEnergy  < 0.00001 .AND. RunResults[2]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[2]:DRtgNatGasEnergy  + RunResults[2]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse3[13]"			Proj:ResultSummary[1]:Enduse3[13]	= {	if (LocalCompAssigned( RunResults[3]  ) == 0 .OR.  (RunResults[3]:DRtgNatGasEnergy  < 0.00001 .AND. RunResults[3]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[3]:DRtgNatGasEnergy  + RunResults[3]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse4[13]"			Proj:ResultSummary[1]:Enduse4[13]	= {	if (LocalCompAssigned( RunResults[4]  ) == 0 .OR.  (RunResults[4]:DRtgNatGasEnergy  < 0.00001 .AND. RunResults[4]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[4]:DRtgNatGasEnergy  + RunResults[4]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse5[13]"			Proj:ResultSummary[1]:Enduse5[13]	= {	if (LocalCompAssigned( RunResults[5]  ) == 0 .OR.  (RunResults[5]:DRtgNatGasEnergy  < 0.00001 .AND. RunResults[5]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[5]:DRtgNatGasEnergy  + RunResults[5]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse14[13]"			Proj:ResultSummary[1]:Enduse14[13]	= {	if (LocalCompAssigned( RunResults[14] ) == 0 .OR.  (RunResults[14]:DRtgNatGasEnergy < 0.00001 .AND. RunResults[14]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[14]:DRtgNatGasEnergy + RunResults[14]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse6[13]"			Proj:ResultSummary[1]:Enduse6[13]	= {	if (LocalCompAssigned( RunResults[6]  ) == 0 .OR.  (RunResults[6]:DRtgNatGasEnergy  < 0.00001 .AND. RunResults[6]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[6]:DRtgNatGasEnergy  + RunResults[6]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse7[13]"			Proj:ResultSummary[1]:Enduse7[13]	= {	if (LocalCompAssigned( RunResults[7]  ) == 0 .OR.  (RunResults[7]:DRtgNatGasEnergy  < 0.00001 .AND. RunResults[7]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[7]:DRtgNatGasEnergy  + RunResults[7]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse8[13]"			Proj:ResultSummary[1]:Enduse8[13]	= {	if (LocalCompAssigned( RunResults[8]  ) == 0 .OR.  (RunResults[8]:DRtgNatGasEnergy  < 0.00001 .AND. RunResults[8]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[8]:DRtgNatGasEnergy  + RunResults[8]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse9[13]"			Proj:ResultSummary[1]:Enduse9[13]	= {	if (LocalCompAssigned( RunResults[9]  ) == 0 .OR.  (RunResults[9]:DRtgNatGasEnergy  < 0.00001 .AND. RunResults[9]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[9]:DRtgNatGasEnergy  + RunResults[9]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse10[13]"			Proj:ResultSummary[1]:Enduse10[13]	= {	if (LocalCompAssigned( RunResults[10] ) == 0 .OR.  (RunResults[10]:DRtgNatGasEnergy < 0.00001 .AND. RunResults[10]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[10]:DRtgNatGasEnergy + RunResults[10]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse11[13]"			Proj:ResultSummary[1]:Enduse11[13]	= {	if (LocalCompAssigned( RunResults[11] ) == 0 .OR.  (RunResults[11]:DRtgNatGasEnergy < 0.00001 .AND. RunResults[11]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[11]:DRtgNatGasEnergy + RunResults[11]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse12[13]"			Proj:ResultSummary[1]:Enduse12[13]	= {	if (LocalCompAssigned( RunResults[12] ) == 0 .OR.  (RunResults[12]:DRtgNatGasEnergy < 0.00001 .AND. RunResults[12]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[12]:DRtgNatGasEnergy + RunResults[12]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse13[13]"			Proj:ResultSummary[1]:Enduse13[13]	= {	UNDEFINED  }		; PV
   ; SAC 1/27/19 - Reporting of Flexibility credit (tic #1053)
   ; SAC 2/2/19 - revised logic to reference new PFlxTDV property (tic #1053)
	"Set ResultSummary[1]:Enduse98[18]"			Proj:ResultSummary[1]:Enduse98[18]	= {
         if (LocalStatus( ResultSummary[1]:PFlxNatGasEnergy[1] ) < 1 .AND. LocalStatus( ResultSummary[1]:PFlxOtherEnergy[1] ) < 1) then  UNDEFINED  
         else  FltToStr( ValidOr( ResultSummary[1]:PFlxNatGasEnergy[1], 0 ) + ValidOr( ResultSummary[1]:PFlxOtherEnergy[1], 0 ), 1 )  endif  }
	"Set ResultSummary[1]:Enduse98[3]"			Proj:ResultSummary[1]:Enduse98[3]	= {  ResultSummary[1]:Enduse98[18]  }
   ; SAC 1/27/19 - included Flexibility credit (tic #1053)
	"Set ResultSummary[1]:Enduse10[3]"			Proj:ResultSummary[1]:Enduse10[3]	= {
	      if (LocalCompAssigned( RunResults[10] ) == 0 .OR. (RunResults[10]:PropNatGasEnergy[1] < 0.00001 .AND. RunResults[10]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
			else  FltToStr( (int(((RunResults[10]:PropNatGasEnergy[1] + RunResults[10]:PropOtherEnergy[1]) * Proj:CondFloorArea / 10)+0.5) / 10) +
                        ValidOr( ResultSummary[1]:PFlxNatGasEnergy[1], 0 ) + ValidOr( ResultSummary[1]:PFlxOtherEnergy[1], 0 ), 1 )  endif  }

  ; DesignRating TDV
	"Set ResultSummary[1]:Title1[14]"			Proj:ResultSummary[1]:Title1[14]		= {	if (EnergyCodeYearNum < 2022) then  "Reference"      else  UNDEFINED        endif  }
	"Set ResultSummary[1]:Title2[14]"			Proj:ResultSummary[1]:Title2[14]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else  "EDR2"           endif  }
	"Set ResultSummary[1]:Title3[14]"			Proj:ResultSummary[1]:Title3[14]		= {	if (EnergyCodeYearNum < 2022) then  "(kTDV/ft-yr)"  else if (EnergyCodeYearNum < 2025) then  "(kTDV/ft-yr)"  else  "($/ft)"  endif endif  }  ; SAC 12/01/22
   ; SAC 10/2/17 - switched from reporting DRtgTDV w/o fuel adjustment mult applied to DRtgTDV W/ fuel adjustment mult applied
	"Set ResultSummary[1]:Enduse1[14]"			Proj:ResultSummary[1]:Enduse1[14]	= {	if (LocalCompAssigned( RunResults[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[1]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse2[14]"			Proj:ResultSummary[1]:Enduse2[14]	= {	if (LocalCompAssigned( RunResults[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[2]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse3[14]"			Proj:ResultSummary[1]:Enduse3[14]	= {	if (LocalCompAssigned( RunResults[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[3]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse4[14]"			Proj:ResultSummary[1]:Enduse4[14]	= {	if (LocalCompAssigned( RunResults[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[4]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse5[14]"			Proj:ResultSummary[1]:Enduse5[14]	= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[5]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse14[14]"			Proj:ResultSummary[1]:Enduse14[14]	= {	if (LocalCompAssigned( RunResults[14] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResults[14]:DesignRatingTDV[2] = 0 )) then  " "  else  FltToStr( LocalRef( RunResults[14]:DesignRatingTDV[2] ), 2 )  endif endif  }
	"Set ResultSummary[1]:Enduse6[14]"			Proj:ResultSummary[1]:Enduse6[14]	= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[6]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse7[14]"			Proj:ResultSummary[1]:Enduse7[14]	= {	if (LocalCompAssigned( RunResults[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[7]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse8[14]"			Proj:ResultSummary[1]:Enduse8[14]	= {	if (LocalCompAssigned( RunResults[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[8]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse9[14]"			Proj:ResultSummary[1]:Enduse9[14]	= {	if (LocalCompAssigned( RunResults[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[9]:DesignRatingTDV[2]  ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse10[14]"			Proj:ResultSummary[1]:Enduse10[14]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[10]:DesignRatingTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse11[14]"			Proj:ResultSummary[1]:Enduse11[14]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[11]:DesignRatingTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse12[14]"			Proj:ResultSummary[1]:Enduse12[14]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:DesignRatingTDV[2] ), 2 )  endif  }
  ; SAC 1/14/13 - added PVCredit stuff
 ; mjb-10/16/13	remove PVCredit from Std Design
;	"Set ResultSummary[1]:Enduse13[14]"			Proj:ResultSummary[1]:Enduse13[14]	= {	FltToStr( PVCredit, 2 )  }
	"Set ResultSummary[1]:Enduse13[14]"			Proj:ResultSummary[1]:Enduse13[14]	= {	" "  }		; still blank out reference PV ??
 ; mjb-10/16/13	subtract PVCredit from Prop Design
;	"Set ResultSummary[1]:Enduse13[19]"			Proj:ResultSummary[1]:Enduse13[19]	= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( (RunResults[6]:PropPVCreditTDV[2] * -1), 2 )  endif  }
  ; SAC 1/28/16 - replaced old DRtg PV w/ new, PVWatts-based PV
	"Set ResultSummary[1]:Enduse13[19]"			Proj:ResultSummary[1]:Enduse13[19]	= {	if (LocalCompAssigned( RunResults[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[13]:ProposedTDV[2] ), 2 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
	"Set ResultSummary[1]:Enduse10[19]"			Proj:ResultSummary[1]:Enduse10[19]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[10]:ProposedTDV[2] ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse11[19]"			Proj:ResultSummary[1]:Enduse11[19]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[11]:ProposedTDV[2] ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse12[19]"			Proj:ResultSummary[1]:Enduse12[19]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:ProposedTDV[2] ), 2 )  endif  }
   ; SAC 12/28/17 - Battery adjustments for GHC (grid harmonization credit)
   ; PLUS adjustments for DHW StdSolar PV credit - SAC 5/5/20 (FlexibilityCredit)
	"Set ResultSummary[1]:Enduse99[19]"			Proj:ResultSummary[1]:Enduse99[19]	= {
         if (IfValidAnd( ResultSummary[1]:GHCEnergyEffTDV   > 0.00001 )==0 .AND.
             IfValidAnd( ResultSummary[1]:DHWSlrPVCreditTDV > 0.00001 )==0) then  "0.00"  
         else  FltToStr( (-1 * (ValidOr( ResultSummary[1]:GHCEnergyEffTDV  , 0 ) +
                                ValidOr( ResultSummary[1]:DHWSlrPVCreditTDV, 0 ))), 2 )  endif  }
	"Adj ResultSummary[1]:Enduse14[19]"			Proj:ResultSummary[1]:Enduse14[19]	= {
         if (IfValidAnd( ResultSummary[1]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResults[14]:ProposedTDV[3] + ResultSummary[1]:GHCEnergyEffTDV), 2 )  endif  }
	"Adj ResultSummary[1]:Enduse13[19]"			Proj:ResultSummary[1]:Enduse13[19]	= {
         if (IfValidAnd( ResultSummary[1]:DHWSlrPVCreditTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResults[13]:ProposedTDV[3] + ResultSummary[1]:DHWSlrPVCreditTDV), 2 )  endif  }
   ; SAC 1/22/18 - Battery adjustments for GHC to Compliance Enduse Details (grid harmonization credit)
	"Set ResultSummary[1]:Enduse99[4]"			Proj:ResultSummary[1]:Enduse99[4]	= {
         if (IfValidAnd( ResultSummary[1]:GHCEnergyEffTDV   > 0.00001 )==0 .AND.
             IfValidAnd( ResultSummary[1]:DHWSlrPVCreditTDV > 0.00001 )==0) then  "0.00"  
         else  FltToStr( (-1 * (ValidOr( ResultSummary[1]:GHCEnergyEffTDV  , 0 ) +
                                ValidOr( ResultSummary[1]:DHWSlrPVCreditTDV, 0 ))), 2 )  endif  }
	"Adj ResultSummary[1]:Enduse14[4]"			Proj:ResultSummary[1]:Enduse14[4]	= {
         if (IfValidAnd( ResultSummary[1]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResults[14]:ProposedTDV[1] + ResultSummary[1]:GHCEnergyEffTDV), 2 )  endif  }
	"Adj ResultSummary[1]:Enduse13[4]"			Proj:ResultSummary[1]:Enduse13[4]	= {
         if (IfValidAnd( ResultSummary[1]:DHWSlrPVCreditTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResults[13]:ProposedTDV[1] + ResultSummary[1]:DHWSlrPVCreditTDV), 2 )  endif  }
   ; SAC 1/27/19 - Reporting of Flexibility credit (tic #1053)
   ; SAC 2/2/19 - revised logic to reference new PFlxTDV property (tic #1053)
	"Set ResultSummary[1]:Enduse98[19]"			Proj:ResultSummary[1]:Enduse98[19]	= {
			if (LocalStatus( ResultSummary[1]:PFlxTDV[1] ) < 1) then  UNDEFINED
         else  FltToStr( ResultSummary[1]:PFlxTDV[1], 2 )  endif  }
	"Set ResultSummary[1]:Enduse98[4]"			Proj:ResultSummary[1]:Enduse98[4]	= {  ResultSummary[1]:Enduse98[19]  }
   ; SAC 1/27/19 - included Flexibility credit (tic #1053)
	"Set ResultSummary[1]:Enduse10[4]"			Proj:ResultSummary[1]:Enduse10[4]	= {
	      if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED
	      else  FltToStr( (int(RunResults[10]:ProposedTDV[1]*100+0.5)/100) + ValidOr( ResultSummary[1]:PFlxTDV[1], 0 ), 2 )  endif  }

  ; DesignRating Margin TDV
	"Set ResultSummary[1]:Title1[15]"			Proj:ResultSummary[1]:Title1[15]		= {	if (EnergyCodeYearNum < 2022) then  "Design Rating"  else if (EnergyCodeYearNum < 2025) then  "Design Rating Margins:"  else  "Design Rating Margins"  endif endif  }  ; SAC 12/01/22
	"Set ResultSummary[1]:Title2[15]"			Proj:ResultSummary[1]:Title2[15]		= {	if (EnergyCodeYearNum < 2022) then  "Margin"         else  "EDR2"                    endif  }
	"Set ResultSummary[1]:Title3[15]"			Proj:ResultSummary[1]:Title3[15]		= {	if (EnergyCodeYearNum < 2022) then  "(kTDV/ft-yr)"  else if (EnergyCodeYearNum < 2025) then  "(kTDV/ft-yr)"  else  "($/ft)"  endif endif  }  ; SAC 12/01/22
   ; SAC 10/2/17 - switched from reporting delta with DRtgTDV w/o fuel adjustment mult applied to DRtgTDV W/ fuel adjustment mult applied
	"Set ResultSummary[1]:Enduse1[15]"			Proj:ResultSummary[1]:Enduse1[15]	= {	if (LocalCompAssigned( RunResults[1]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[1]:DesignRatingTDV[2]  - RunResults[1]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse2[15]"			Proj:ResultSummary[1]:Enduse2[15]	= {	if (LocalCompAssigned( RunResults[2]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[2]:DesignRatingTDV[2]  - RunResults[2]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse3[15]"			Proj:ResultSummary[1]:Enduse3[15]	= {	if (LocalCompAssigned( RunResults[3]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[3]:DesignRatingTDV[2]  - RunResults[3]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse4[15]"			Proj:ResultSummary[1]:Enduse4[15]	= {	if (LocalCompAssigned( RunResults[4]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[4]:DesignRatingTDV[2]  - RunResults[4]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse5[15]"			Proj:ResultSummary[1]:Enduse5[15]	= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[5]:DesignRatingTDV[2]  - RunResults[5]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse14[15]"			Proj:ResultSummary[1]:Enduse14[15]	= {	if (LocalCompAssigned( RunResults[14] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[14]:DesignRatingTDV[2] - RunResults[14]:ProposedTDV[2] ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse6[15]"			Proj:ResultSummary[1]:Enduse6[15]	= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[6]:DesignRatingTDV[2]  - RunResults[6]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse7[15]"			Proj:ResultSummary[1]:Enduse7[15]	= {	if (LocalCompAssigned( RunResults[7]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[7]:DesignRatingTDV[2]  - RunResults[7]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse8[15]"			Proj:ResultSummary[1]:Enduse8[15]	= {	if (LocalCompAssigned( RunResults[8]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[8]:DesignRatingTDV[2]  - RunResults[8]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse9[15]"			Proj:ResultSummary[1]:Enduse9[15]	= {	if (LocalCompAssigned( RunResults[9]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[9]:DesignRatingTDV[2]  - RunResults[9]:ProposedTDV[2]  ), 2 )  endif  }
   ; SAC 2/2/19 - revised logic to reference new PFlxTDV property (tic #1053)
 	"Set ResultSummary[1]:Enduse10[15]"			Proj:ResultSummary[1]:Enduse10[15]	= {
 	      if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED
 	      else  FltToStr( (int((RunResults[10]:DesignRatingTDV[2]*100)+0.5) - int((RunResults[10]:ProposedTDV[2]*100)+0.5)) / 100 - ValidOr( ResultSummary[1]:PFlxTDV[1], 0 ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse11[15]"			Proj:ResultSummary[1]:Enduse11[15]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[11]:DesignRatingTDV[2] - RunResults[11]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse12[15]"			Proj:ResultSummary[1]:Enduse12[15]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[12]:DesignRatingTDV[2] - RunResults[12]:ProposedTDV[2] ), 2 )  endif  }
  ; SAC 1/14/13 - added PVCredit stuff
; 	"Set ResultSummary[1]:Enduse13[15]"			Proj:ResultSummary[1]:Enduse13[15]	= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[6]:PropPVCreditTDV[2], 2 )  endif  }
  ; SAC 1/28/16 - replaced old DRtg PV w/ new, PVWatts-based PV
 	"Set ResultSummary[1]:Enduse13[15]"			Proj:ResultSummary[1]:Enduse13[15]	= {	if (LocalCompAssigned( RunResults[13] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[13]:DesignRatingTDV[2] - RunResults[13]:ProposedTDV[2] ), 2 )  endif  }
   ; SAC 12/28/17 - Battery adjustments for GHC (grid harmonization credit)
   ; PLUS adjustments for DHW StdSolar PV credit - SAC 5/5/20 (FlexibilityCredit)
	"Set ResultSummary[1]:Enduse99[15]"			Proj:ResultSummary[1]:Enduse99[15]	= {
         if (IfValidAnd( ResultSummary[1]:GHCEnergyEffTDV   > 0.00001 )==0 .AND.
             IfValidAnd( ResultSummary[1]:DHWSlrPVCreditTDV > 0.00001 )==0) then  "0.00"  
         else  FltToStr( (ValidOr( ResultSummary[1]:GHCEnergyEffTDV  , 0 ) +
                          ValidOr( ResultSummary[1]:DHWSlrPVCreditTDV, 0 )), 2 )  endif  }
	"Adj ResultSummary[1]:Enduse14[15]"			Proj:ResultSummary[1]:Enduse14[15]	= {
         if (IfValidAnd( ResultSummary[1]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResults[14]:DesignRatingTDV[2] - RunResults[14]:ProposedTDV[2] - ResultSummary[1]:GHCEnergyEffTDV), 2 )  endif  }
	"Adj ResultSummary[1]:Enduse13[15]"			Proj:ResultSummary[1]:Enduse13[15]	= {
         if (IfValidAnd( ResultSummary[1]:DHWSlrPVCreditTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResults[13]:DesignRatingTDV[2] - RunResults[13]:ProposedTDV[2] - ResultSummary[1]:DHWSlrPVCreditTDV), 2 )  endif  }
   ; SAC 1/22/18 - Battery adjustments for GHC to Compliance Enduse Details (grid harmonization credit)
	"Set ResultSummary[1]:Enduse99[8]"			Proj:ResultSummary[1]:Enduse99[8]	= {
         if (IfValidAnd( ResultSummary[1]:GHCEnergyEffTDV   > 0.00001 )==0 .AND.
             IfValidAnd( ResultSummary[1]:DHWSlrPVCreditTDV > 0.00001 )==0) then  "0.00"  
         else  FltToStr( (ValidOr( ResultSummary[1]:GHCEnergyEffTDV  , 0 ) +
                          ValidOr( ResultSummary[1]:DHWSlrPVCreditTDV, 0 )), 2 )  endif  }
	"Adj ResultSummary[1]:Enduse14[8]"			Proj:ResultSummary[1]:Enduse14[8]	= {
         if (IfValidAnd( ResultSummary[1]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResults[14]:StandardTDV - RunResults[14]:ProposedTDV[1] - ResultSummary[1]:GHCEnergyEffTDV), 2 )  endif  }
	"Adj ResultSummary[1]:Enduse13[8]"			Proj:ResultSummary[1]:Enduse13[8]	= {
         if (IfValidAnd( ResultSummary[1]:DHWSlrPVCreditTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResults[13]:StandardTDV - RunResults[13]:ProposedTDV[1] - ResultSummary[1]:DHWSlrPVCreditTDV), 2 )  endif  }
   ; SAC 1/22/18 - Compliance Total adjustments for Battery GHC (grid harmonization credit)
	"Adj ResultSummary[1]:Enduse11[4]"			Proj:ResultSummary[1]:Enduse11[4]	= {
         if (LocalCompAssigned( RunResults[11] ) == 0 .OR. (IfValidAnd( ResultSummary[1]:GHCEnergyEffTDV   > 0.00001 )==0 .AND.
                                                            IfValidAnd( ResultSummary[1]:DHWSlrPVCreditTDV > 0.00001 )==0)) then  UNCHANGED
         else  FltToStr( (RunResults[11]:ProposedTDV[1] - ValidOr( ResultSummary[1]:GHCEnergyEffTDV  , 0 ) -
                                                          ValidOr( ResultSummary[1]:DHWSlrPVCreditTDV, 0 )), 2 )  endif  }
 	"Adj ResultSummary[1]:Enduse11[8]"			Proj:ResultSummary[1]:Enduse11[8]	= {
         if (LocalCompAssigned( RunResults[11] ) == 0 .OR. (IfValidAnd( ResultSummary[1]:GHCEnergyEffTDV   > 0.00001 )==0 .AND.
                                                            IfValidAnd( ResultSummary[1]:DHWSlrPVCreditTDV > 0.00001 )==0)) then  UNCHANGED
         else  FltToStr( (RunResults[11]:CompMarginTDV + ValidOr( ResultSummary[1]:GHCEnergyEffTDV  , 0 ) +
                                                         ValidOr( ResultSummary[1]:DHWSlrPVCreditTDV, 0 )), 2 )  endif  }
	"Adj ResultSummary[1]:PctSavingsCmpTDV"	Proj:ResultSummary[1]:PctSavingsCmpTDV	= {
         if (IfValidAnd( RunResults[11]:StandardTDV > 0.001 )==0 .OR. (IfValidAnd( ResultSummary[1]:GHCEnergyEffTDV   > 0.00001 )==0 .AND.
                                                                       IfValidAnd( ResultSummary[1]:DHWSlrPVCreditTDV > 0.00001 )==0)) then  UNCHANGED
         else  int((((RunResults[11]:StandardTDV - ValidOr( RunResults[11]:ProposedTDV[1], 0 ) +
                      ValidOr( ResultSummary[1]:GHCEnergyEffTDV, 0 ) + ValidOr( ResultSummary[1]:DHWSlrPVCreditTDV, 0 )) * 100 / RunResults[11]:StandardTDV ) * 10) +0.5 ) / 10  endif  }
	"Adj ResultSummary[1]:PctSavCmpTDVLbl"		Proj:ResultSummary[1]:PctSavCmpTDVLbl	= {
         if (IfValidAnd( ResultSummary[1]:GHCEnergyEffTDV   > 0.00001 )==0 .AND.
             IfValidAnd( ResultSummary[1]:DHWSlrPVCreditTDV > 0.00001 )==0) then  UNCHANGED
         else if (IfValidAnd( ResultSummary[1]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[1]:PctSavingsCmpTDV < -0.0001 )==0) then  "-" 
         else  Format( "%.1f", ResultSummary[1]:PctSavingsCmpTDV )  endif endif  }

   ; SAC 1/27/19 - Reporting of Flexibility credit (tic #1053)
   ; SAC 2/1/19 - revised logic to reference new PFlxTDV property (tic #1053)
	"Set ResultSummary[1]:Enduse98[15]"			Proj:ResultSummary[1]:Enduse98[15]	= {  FltToStr( -ValidOr( ResultSummary[1]:PFlxTDV[1], 0 ), 2 )  }

;	 	"Set ResultSummary[1]:PassFail"				Proj:ResultSummary[1]:PassFail		= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  if (RunResults[11]:CompMarginTDV >= 0) then "PASS"  else  "FAIL"  endif endif  }

  ; DesignRating Electric Demand
	"Set ResultSummary[1]:Title1[16]"			Proj:ResultSummary[1]:Title1[16]		= {	"Reference"  }
	"Set ResultSummary[1]:Title2[16]"			Proj:ResultSummary[1]:Title2[16]		= {	"Design"  }
	"Set ResultSummary[1]:Title3[16]"			Proj:ResultSummary[1]:Title3[16]		= {	"(kW)"  }
	"Set ResultSummary[1]:Enduse1[16]"			Proj:ResultSummary[1]:Enduse1[16]	= {	if (LocalCompAssigned( RunResults[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[1]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse2[16]"			Proj:ResultSummary[1]:Enduse2[16]	= {	if (LocalCompAssigned( RunResults[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[2]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse3[16]"			Proj:ResultSummary[1]:Enduse3[16]	= {	if (LocalCompAssigned( RunResults[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[3]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse4[16]"			Proj:ResultSummary[1]:Enduse4[16]	= {	if (LocalCompAssigned( RunResults[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[4]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse5[16]"			Proj:ResultSummary[1]:Enduse5[16]	= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[5]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse14[16]"			Proj:ResultSummary[1]:Enduse14[16]	= {	if (LocalCompAssigned( RunResults[14] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[14]:DRtgElecDemand ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse6[16]"			Proj:ResultSummary[1]:Enduse6[16]	= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[6]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse7[16]"			Proj:ResultSummary[1]:Enduse7[16]	= {	if (LocalCompAssigned( RunResults[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[7]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse8[16]"			Proj:ResultSummary[1]:Enduse8[16]	= {	if (LocalCompAssigned( RunResults[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[8]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse9[16]"			Proj:ResultSummary[1]:Enduse9[16]	= {	if (LocalCompAssigned( RunResults[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[9]:DRtgElecDemand  ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse10[16]"			Proj:ResultSummary[1]:Enduse10[16]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[10]:DRtgElecDemand ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse11[16]"			Proj:ResultSummary[1]:Enduse11[16]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[11]:DRtgElecDemand ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse12[16]"			Proj:ResultSummary[1]:Enduse12[16]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:DRtgElecDemand ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse13[16]"			Proj:ResultSummary[1]:Enduse13[16]	= {	UNDEFINED  }	; PV

   ; SAC 4/8/15 - refresh lighting and total Proposed results following (possible) resets due to design rating lighting credit reductions
   ; SAC 1/27/19 - Incorporate Flexibility credit into totals (tic #1053)
   ; SAC 2/2/19 - revised logic to reference new EUseSummary:PFlx* properties (tic #1053)
  ; Proposed Site ELEC Use
	"Set ResultSummary[1]:Enduse6[17]"			Proj:ResultSummary[1]:Enduse6[17]	= {	if (LocalCompAssigned( RunResults[6]  ) == 0 .OR. RunResults[6]:PropElecEnergy[2]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[6]:PropElecEnergy[2]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse10[17]"			Proj:ResultSummary[1]:Enduse10[17]	= {
	      if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  
			else  FltToStr( (int( (RunResults[10]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )) + ValidOr( ResultSummary[1]:PFlxElecEnergy[1], 0 ), 0 )  endif  }
	"Set ResultSummary[1]:Enduse11[17]"			Proj:ResultSummary[1]:Enduse11[17]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[11]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse12[17]"			Proj:ResultSummary[1]:Enduse12[17]	= {	if (LocalCompAssigned( RunResults[12] ) == 0 .OR. RunResults[12]:PropElecEnergy[2] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[12]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
; already set above - SAC 5/5/20 (FlexibilityCredit)
;	"Set ResultSummary[1]:Enduse13[17]"			Proj:ResultSummary[1]:Enduse13[17]	= {	if (LocalCompAssigned( RunResults[13] ) == 0 .OR. RunResults[13]:PropElecEnergy[2] > 0.00001) then  UNDEFINED  
;																													else  FltToStr( (int( (RunResults[13]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
  ; Proposed Site FUEL Use
	"Set ResultSummary[1]:Enduse6[18]"			Proj:ResultSummary[1]:Enduse6[18]	= {	if (LocalCompAssigned( RunResults[6]  ) == 0 .OR. (RunResults[6]:PropNatGasEnergy[2]  < 0.00001 .AND. RunResults[6]:PropOtherEnergy[2]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[6]:PropNatGasEnergy[2]  + RunResults[6]:PropOtherEnergy[2] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse10[18]"			Proj:ResultSummary[1]:Enduse10[18]	= {
	      if (LocalCompAssigned( RunResults[10] ) == 0 .OR. (RunResults[10]:PropNatGasEnergy[2] < 0.00001 .AND. RunResults[10]:PropOtherEnergy[2] < 0.00001)) then  UNDEFINED  
			else  FltToStr( ((RunResults[10]:PropNatGasEnergy[2] + RunResults[10]:PropOtherEnergy[2]) * Proj:CondFloorArea / 100) +
                         ValidOr( ResultSummary[1]:PFlxNatGasEnergy[1], 0 ) + ValidOr( ResultSummary[1]:PFlxOtherEnergy[1], 0 ), 1 )  endif  }
	"Set ResultSummary[1]:Enduse11[18]"			Proj:ResultSummary[1]:Enduse11[18]	= {	if (LocalCompAssigned( RunResults[10] ) == 0 .OR. (RunResults[10]:PropNatGasEnergy[2] < 0.00001 .AND. RunResults[10]:PropOtherEnergy[2] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[10]:PropNatGasEnergy[2] + RunResults[10]:PropOtherEnergy[2]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse12[18]"			Proj:ResultSummary[1]:Enduse12[18]	= {	if (LocalCompAssigned( RunResults[12] ) == 0 .OR. (RunResults[12]:PropNatGasEnergy[2] < 0.00001 .AND. RunResults[12]:PropOtherEnergy[2] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[12]:PropNatGasEnergy[2] + RunResults[12]:PropOtherEnergy[2]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse13[18]"			Proj:ResultSummary[1]:Enduse13[18]	= {	UNDEFINED  }  ; PV
  ; Proposed TDV
	"Set ResultSummary[1]:Enduse6[19]"			Proj:ResultSummary[1]:Enduse6[19]	= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[6]:ProposedTDV[2]  ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse10[19]"			Proj:ResultSummary[1]:Enduse10[19]	= {
 	      if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED
 	      else  FltToStr( (RunResults[10]:ProposedTDV[2] + ValidOr( ResultSummary[1]:PFlxTDV[1], 0 )), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse11[19]"			Proj:ResultSummary[1]:Enduse11[19]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[11]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse12[19]"			Proj:ResultSummary[1]:Enduse12[19]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:ProposedTDV[2] ), 2 )  endif  }
; 	"Set ResultSummary[1]:Enduse13[19]"			Proj:ResultSummary[1]:Enduse13[19]	= {	if (LocalCompAssigned( RunResults[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[13]:ProposedTDV[2] ), 2 )  endif  }

  ; Additional elec demand storage (SAC 10/26/16)
   "Set ResultSummary[1]:PropElecDemand[2]"  Proj:ResultSummary[1]:PropElecDemand[2]   = {   if (LocalCompAssigned( RunResults[10] ) == 0 .OR. LocalStatus( RunResults[10]:PropElecDemand[2] ) < 1) then  UNDEFINED
																												         else  ValidOr( RunResults[10]:PropElecDemand[2], 0 )  endif  }
   "Set ResultSummary[1]:DRtgElecDemand"     Proj:ResultSummary[1]:DRtgElecDemand      = {   if (LocalCompAssigned( RunResults[10] ) == 0 .OR. LocalStatus( RunResults[10]:DRtgElecDemand ) < 1) then  UNDEFINED
																												         else  ValidOr( RunResults[10]:DRtgElecDemand, 0 )  endif  }
	"Set ResultSummary[1]:MarginkW[2]"		   Proj:ResultSummary[1]:MarginkW[2]	      = {	if (LocalCompAssigned( RunResults[10] ) == 0 .OR. LocalStatus( ResultSummary[1]:PropElecDemand[2] ) < 1) then  UNDEFINED
																												         else  int(((ResultSummary[1]:DRtgElecDemand - ResultSummary[1]:PropElecDemand[2]) * 100) +0.5 ) / 100  endif  }

;	  ; Demand & Energy Use Margins (added w/ CAHP mods 10/8/14)
;		"Set ResultSummary[1]:MarginkW"			Proj:ResultSummary[1]:MarginkW		= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED
;																													else  ValidOr( RunResults[10]:StdElecDemand, 0 ) - ValidOr( RunResults[10]:PropElecDemand, 0 )  endif  }
;		"Set ResultSummary[1]:MarginkWh"			Proj:ResultSummary[1]:MarginkWh		= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED
;																													else  (ValidOr( RunResults[10]:StdElecEnergy, 0 ) - ValidOr( RunResults[10]:PropElecEnergy, 0 )) * CondFloorArea / 3.413  endif  }
;		"Set ResultSummary[1]:MarginTherms"		Proj:ResultSummary[1]:MarginTherms	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED
;																													else  (ValidOr( RunResults[10]:StdNatGasEnergy, 0 ) - ValidOr( RunResults[10]:PropNatGasEnergy, 0 )) * CondFloorArea / 100  endif  }
;	  ; Percent Savings values for reporting
;		"Set ResultSummary[1]:PctSavingskW"			Proj:ResultSummary[1]:PctSavingskW		= {	if (IfValidAnd( RunResults[10]:StdElecDemand > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StdElecDemand   - ValidOr( RunResults[10]:PropElecDemand,   0 )) * 100 / RunResults[10]:StdElecDemand    endif  }
;		"Set ResultSummary[1]:PctSavingskWh"		Proj:ResultSummary[1]:PctSavingskWh		= {	if (IfValidAnd( RunResults[10]:StdElecEnergy > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StdElecEnergy   - ValidOr( RunResults[10]:PropElecEnergy,   0 )) * 100 / RunResults[10]:StdElecEnergy    endif  }
;		"Set ResultSummary[1]:PctSavingsTherms"	Proj:ResultSummary[1]:PctSavingsTherms	= {	if (IfValidAnd( RunResults[10]:StdNatGasEnergy > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StdNatGasEnergy - ValidOr( RunResults[10]:PropNatGasEnergy, 0 )) * 100 / RunResults[10]:StdNatGasEnergy  endif  }
;		"Set ResultSummary[1]:PctSavingsTDV"		Proj:ResultSummary[1]:PctSavingsTDV		= {	if (IfValidAnd( RunResults[10]:StandardTDV     > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StandardTDV     - ValidOr( RunResults[10]:ProposedTDV,      0 )) * 100 / RunResults[10]:StandardTDV      endif  }
;		"Set ResultSummary[1]:PctSavingsCmpTDV"	Proj:ResultSummary[1]:PctSavingsCmpTDV	= {	if (IfValidAnd( RunResults[11]:StandardTDV     > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[11]:StandardTDV     - ValidOr( RunResults[11]:ProposedTDV,      0 )) * 100 / RunResults[11]:StandardTDV      endif  }
;		"Set ResultSummary[1]:PctSavkWLbl"			Proj:ResultSummary[1]:PctSavkWLbl		= {	if (IfValidAnd( ResultSummary[1]:PctSavingskW     > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[1]:PctSavingskW     < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[1]:PctSavingskW     )  endif  }
;		"Set ResultSummary[1]:PctSavkWhLbl"			Proj:ResultSummary[1]:PctSavkWhLbl		= {	if (IfValidAnd( ResultSummary[1]:PctSavingskWh    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[1]:PctSavingskWh    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[1]:PctSavingskWh    )  endif  }
;		"Set ResultSummary[1]:PctSavThermsLbl"		Proj:ResultSummary[1]:PctSavThermsLbl	= {	if (IfValidAnd( ResultSummary[1]:PctSavingsTherms > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[1]:PctSavingsTherms < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[1]:PctSavingsTherms )  endif  }
;		"Set ResultSummary[1]:PctSavTDVLbl"			Proj:ResultSummary[1]:PctSavTDVLbl		= {	if (IfValidAnd( ResultSummary[1]:PctSavingsTDV    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[1]:PctSavingsTDV    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[1]:PctSavingsTDV    )  endif  }
;		"Set ResultSummary[1]:PctSavCmpTDVLbl"		Proj:ResultSummary[1]:PctSavCmpTDVLbl	= {	if (IfValidAnd( ResultSummary[1]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[1]:PctSavingsCmpTDV < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[1]:PctSavingsCmpTDV )  endif  }
                          
END

;*************************************************************************  - SAC 07/21/23 (2025)
RULELIST "CARes_FinalRun_SelfUtilizationCredit" 1 0 1 1
;*************************************************************************
   ; SAC 1/8/18 - set grid harmonization credit values prior to being referenced in EDR calcs for 2019 (tic #957)
   "Set 2019 grid harmonization credit"   Proj:Action  = {
         if (IfValidAnd( EnergyCodeYearNum >= 2019 ))
         then  EvalRulelist( "CARes_DesignRating_2019GHC" )
         else  UNCHANGED  endif  }
   ; SAC 1/7/18 - eval rules to set grid harmonization credit data for 2019
   "Set 2019 grid harmonization credit-NESW"   Proj:Action  = {
         if (IfValidAnd( EnergyCodeYearNum >= 2019 ) .AND. AllOrientations > 0.5)
         then  EvalRulelist( "CARes_DesignRating_2019GHC_NESW" )
         else  UNCHANGED  endif  }
END

;*************************************************************************  - SAC 1/7/18
RULELIST "CARes_DesignRatingSummary_SingleOrientation" 1 0 1 1
;*************************************************************************

   ; REcalc CO2 stuff to take into account GHC & DHWStdSlrPV credits - SAC 5/6/20 (FlexibilityCredit)
   "Set CO2 details results (again)"   Proj:Action  =  
      {  if (IfValidAnd( EnergyCodeYearNum >= 2019 ))
         then  EvalRulelist( "CARes_CO2Details_SingleOrientation" )
         else  UNCHANGED  endif  }

   ; SAC 2/1/19 - Calc and storage of Flexibility credit (tic #1053)
   "Set ResultSummary[1]:PFlxElecEnergy[2]"     Proj:ResultSummary[1]:PFlxElecEnergy[2]  =
      {  if (IfValidAnd( PropFlexFrac > 0 )==0 .OR. LocalStatus( RunResults[11]:PFlxElecEnergy ) < 1 .OR.
                                                    LocalStatus( RunResults[11]:PropElecEnergy[1] ) < 1) then  UNDEFINED
         else if (RunResults[11]:PFlxElecEnergy = RunResults[11]:PropElecEnergy[1]) then  UNDEFINED
         else  (PropFlexFrac * (RunResults[11]:PFlxElecEnergy - RunResults[11]:PropElecEnergy[1])) * CondFloorArea / 3.413   endif endif  }
   "Set ResultSummary[1]:PFlxElecEnergy[1]"     Proj:ResultSummary[1]:PFlxElecEnergy[1]  =
      {  if (IfValidAnd( ResultSummary[1]:PFlxElecEnergy[2] > -1 )==0) then  UNDEFINED
         else  int( ResultSummary[1]:PFlxElecEnergy[2] + 0.5 )  endif  }
   "Set ResultSummary[1]:PFlxNatGasEnergy[2]"     Proj:ResultSummary[1]:PFlxNatGasEnergy[2]  =
      {  if (IfValidAnd( PropFlexFrac > 0 )==0 .OR. LocalStatus( RunResults[11]:PFlxNatGasEnergy ) < 1 .OR.
                                                    LocalStatus( RunResults[11]:PropNatGasEnergy[1] ) < 1) then  UNDEFINED
         else if (RunResults[11]:PFlxNatGasEnergy = RunResults[11]:PropNatGasEnergy[1]) then  UNDEFINED
         else  (PropFlexFrac * (RunResults[11]:PFlxNatGasEnergy - RunResults[11]:PropNatGasEnergy[1])) * CondFloorArea / 100   endif endif  }
   "Set ResultSummary[1]:PFlxNatGasEnergy[1]"     Proj:ResultSummary[1]:PFlxNatGasEnergy[1]  =
      {  if (IfValidAnd( ResultSummary[1]:PFlxNatGasEnergy[2] > -1 )==0) then  UNDEFINED
         else  int( (ResultSummary[1]:PFlxNatGasEnergy[2]*10) + 0.5 ) / 10  endif  }
   "Set ResultSummary[1]:PFlxOtherEnergy[2]"     Proj:ResultSummary[1]:PFlxOtherEnergy[2]  =
      {  if (IfValidAnd( PropFlexFrac > 0 )==0 .OR. LocalStatus( RunResults[11]:PFlxOtherEnergy ) < 1 .OR.
                                                    LocalStatus( RunResults[11]:PropOtherEnergy[1] ) < 1) then  UNDEFINED
         else if (RunResults[11]:PFlxOtherEnergy = RunResults[11]:PropOtherEnergy[1]) then  UNDEFINED
         else  (PropFlexFrac * (RunResults[11]:PFlxOtherEnergy - RunResults[11]:PropOtherEnergy[1])) * CondFloorArea / 100   endif endif  }
   "Set ResultSummary[1]:PFlxOtherEnergy[1]"     Proj:ResultSummary[1]:PFlxOtherEnergy[1]  =
      {  if (IfValidAnd( ResultSummary[1]:PFlxOtherEnergy[2] > -1 )==0) then  UNDEFINED
         else  int( (ResultSummary[1]:PFlxOtherEnergy[2]*10) + 0.5 ) / 10  endif  }
   "Set ResultSummary[1]:PFlxTDV[2]"     Proj:ResultSummary[1]:PFlxTDV[2]  =
      {  if (IfValidAnd( PropFlexFrac > 0 )==0 .OR. LocalStatus( RunResults[11]:PFlxTDV ) < 1 .OR.
                                                    LocalStatus( RunResults[11]:ProposedTDV[3] ) < 1) then  UNDEFINED  
         else  (PropFlexFrac * (RunResults[11]:PFlxTDV - RunResults[11]:ProposedTDV[3]))  endif  }
   "Set ResultSummary[1]:PFlxTDV[1]"     Proj:ResultSummary[1]:PFlxTDV[1]  =
      {  if (LocalStatus( ResultSummary[1]:PFlxTDV[2] ) < 1) then  UNDEFINED
         else  int( (ResultSummary[1]:PFlxTDV[2]*100) + 0.5 ) / 100  endif  }
   "Set ResultSummary[1]:PFlxElecDemand[2]"     Proj:ResultSummary[1]:PFlxElecDemand[2]  =      ; SAC 2/5/19
      {  if (IfValidAnd( PropFlexFrac > 0 )==0 .OR. LocalStatus( RunResults[11]:PFlxElecDemand ) < 1 .OR.
                                                    LocalStatus( RunResults[11]:PropElecDemand[1] ) < 1) then  UNDEFINED  
         else  (PropFlexFrac * (RunResults[11]:PFlxElecDemand - RunResults[11]:PropElecDemand[1]))  endif  }
   "Set ResultSummary[1]:PFlxElecDemand[1]"     Proj:ResultSummary[1]:PFlxElecDemand[1]  =
      {  if (LocalStatus( ResultSummary[1]:PFlxElecDemand[2] ) < 1) then  UNDEFINED
         else  int( (ResultSummary[1]:PFlxElecDemand[2]*100) + 0.5 ) / 100  endif  }

;"testing" Proj:Action = {
;        if (LocalStatus( RunResults[11]:PFlxTDV ) < 1) then  MessageBox( "RunResults[11]:PFlxTDV undefined" )
;   else if (LocalStatus( RunResults[11]:ProposedTDV[3] ) < 1) then  MessageBox( "RunResults[11]:ProposedTDV[3] undefined" )
;   else if (LocalStatus( PropFlexFrac ) < 1) then  MessageBox( "PropFlexFrac undefined" )
;   else  MessageBox( "PropFlexFrac = %g / RunResults[11]:PFlxTDV = %g / RunResults[11]:ProposedTDV[3] = %g",
;               PropFlexFrac, RunResults[11]:PFlxTDV, RunResults[11]:ProposedTDV[3] )  endif endif endif  }
   ; SAC 7/19/17 - added rounding of all design rating results to 0.1 (tic #864)
   ; SAC 8/10/17 - added logic to incorporate a fraction of benefit from PropFlex run into overall EDR score
   ; SAC 2/1/19 - revised logic to reference new PFlxTDV property (tic #1053)
 	"Set ResultSummary[1]:DesignRating"			Proj:ResultSummary[1]:DesignRating		= {
         if (IfValidAnd( RunResults[10]:DesignRatingTDV[2] != 0 )==0) then  UNDEFINED
         else if (LocalStatus( ResultSummary[1]:PFlxTDV[2] ) > 0 .AND. LocalStatus( RunResults[11]:ProposedTDV[3] ) > 0)
         then   int( ((ResultSummary[1]:PFlxTDV[2] +
                       ValidOr( RunResults[10]:ProposedTDV[3], 0 )) * 1000 / RunResults[10]:DesignRatingTDV[2])+0.5 )/10
         else   int( ( ValidOr( RunResults[10]:ProposedTDV[3], 0 )  * 1000 / RunResults[10]:DesignRatingTDV[2])+0.5 )/10
         endif endif  }

   ; SAC 12/19/16 - modified ...NoPV result to also exclude Battery TDV
   ; SAC 6/25/17 - altered logic to use 2019 EDR calcs for 2016
   ; SAC 12/28/17 - add effect of new GHC (grid harmonization credit)
   ; added effect of DHW StdSolar PV credit (& removed logic for code vints <2016) - SAC 5/5/20 (FlexibilityCredit)
   ; modified for 2022 to use (non-fuel adjusted) Compliance, not Total TDV in calc of design rating - SAC 02/06/21
 	"Set ResultSummary[1]:DesignRatingNoPV"	Proj:ResultSummary[1]:DesignRatingNoPV	=
      {  if (EnergyCodeYearNum >= 2022)
         then  if (IfValidAnd( RunResults[11]:DesignRatingTDV[1] != 0 )==0) then  UNDEFINED
               else  int( ((ValidOr( RunResults[11]:ProposedTDV[1], 0 ) - ValidOr( ResultSummary[1]:GHCEnergyEffTDV, 0 ) -
                            ValidOr( ResultSummary[1]:DHWSlrPVCreditTDV, 0 )) *
                           1000 / RunResults[11]:DesignRatingTDV[1])+0.5 )/10
               endif
         else  if (IfValidAnd( RunResults[10]:DesignRatingTDV[2] != 0 )==0) then  UNDEFINED
               else  int( ((ValidOr( RunResults[10]:ProposedTDV[3], 0 ) - ValidOr( RunResults[13]:ProposedTDV[3], 0 ) -
                            ValidOr( RunResults[14]:ProposedTDV[3], 0 ) - ValidOr( ResultSummary[1]:GHCEnergyEffTDV, 0 ) -
                            ValidOr( ResultSummary[1]:DHWSlrPVCreditTDV, 0 )) *
                           1000 / RunResults[10]:DesignRatingTDV[2])+0.5 )/10
               endif  endif  }
 	"Set ResultSummary[1]:ShowDesignRtgNoPV"	Proj:ResultSummary[1]:ShowDesignRtgNoPV =
      {  if (EnergyCodeYearNum >= 2019 .OR. ValidOr( RunResults[6]:PropPVCreditTDV[2], 0 ) >= 0.0001)
         then  1  else  0  endif  }
	; SAC 3/16/16 - added new DesignRatingPVOnly & DesignRatingStd - including detailed calc of DesignRatingStd w/ fuel adjustments to StdTDV results
   ; SAC 6/6/17 - flipped sign of PV-only EDR prior to 2019.0.4 release
   ; revised DesignRatingPVOnly calc for 2022 to include only PV, Battery & Flexibility (below line) - SAC 02/09/21
 	"Set ResultSummary[1]:DesignRatingPVOnly"	Proj:ResultSummary[1]:DesignRatingPVOnly	=
      {  if (LocalStatus( ResultSummary[1]:DesignRatingNoPV ) < 1 .OR. LocalStatus( ResultSummary[1]:DesignRating ) < 1) then  UNDEFINED
         else if (EnergyCodeYearNum >= 2022)
         then  (  int( ((ValidOr( RunResults[10]:ProposedTDV[3], 0 ) - ValidOr( RunResults[13]:ProposedTDV[3], 0 ) -
                         ValidOr( RunResults[14]:ProposedTDV[3], 0 ) - ValidOr( ResultSummary[1]:GHCEnergyEffTDV, 0 ) -
                         ValidOr( ResultSummary[1]:DHWSlrPVCreditTDV, 0 )) *
                        1000 / RunResults[10]:DesignRatingTDV[2])+0.5 )/10  )  - ResultSummary[1]:DesignRating
         else	ResultSummary[1]:DesignRatingNoPV - ResultSummary[1]:DesignRating  endif endif  }
; SAC 6/25/17 - testing
;"testing"  Proj:Action = {  PostMessageToLog( "DRtg TDV = %g / TotPropTDV = %g / PropPVCred[2] = %g / PropPVTDV = %g / PropBattTDV = %g // DR = %g / DRNoPV = %g / RDPVOnly = %g",
;       RunResults[10]:DesignRatingTDV[2], RunResults[10]:ProposedTDV[3], RunResults[6]:PropPVCreditTDV[2], RunResults[13]:ProposedTDV[3], RunResults[14]:ProposedTDV[3], ResultSummary[1]:DesignRating, ResultSummary[1]:DesignRatingNoPV, ResultSummary[1]:DesignRatingPVOnly )  }

 	"Set ResultSummary[1]:DesignRatingStd"		Proj:ResultSummary[1]:DesignRatingStd		= {
         if (IfValidAnd( RunResults[10]:DesignRatingTDV[2] != 0 )==0 .OR.
             AnalysisType < 3) then  UNDEFINED
			else	int( ((	RunResults[1]:StdElecTDV[1] + RunResults[1]:StdNatGasTDV + RunResults[1]:StdOtherTDV +  ; SpcHt
      					 +	RunResults[2]:StdElecTDV[1] + RunResults[2]:StdNatGasTDV + RunResults[2]:StdOtherTDV +  ; SpcCl
      					 +	RunResults[3]:StdElecTDV[1]    ; IAQVent
		      			 +	RunResults[4]:StandardTDV[1]   ; OthrHVAC
      					 +	RunResults[5]:StdElecTDV[1] + RunResults[5]:StdNatGasTDV + RunResults[5]:StdOtherTDV +  ; WtrHt
		      			 +	RunResults[6]:StandardTDV[1]   ; InsLtg
      					 +	RunResults[7]:StdElecTDV[1] + RunResults[7]:StdNatGasTDV + RunResults[7]:StdOtherTDV +  ; AppCkg
		      			 +	RunResults[8]:StandardTDV[1]   ; Plugs
				      	 +	RunResults[9]:StandardTDV[1]   ; Ext
      					 +	RunResults[13]:StandardTDV[1]   ; PV
		      			 +	RunResults[14]:StandardTDV[1] ) ; Battery
				      			* 1000 / RunResults[10]:DesignRatingTDV[2])+0.5 )/10    endif  }
; SAC 3/31/16 - revised rules REMOVING application of design rating fuel adjustment multipliers to ProposedTDV (mods made elsewhere to apply inverse adjustment to DR reference TDV)
;													else	(	RunResults[1]:StdElecTDV[1] + ((RunResults[1]:StdNatGasTDV + RunResults[1]:StdOtherTDV) *
;																											T24RClimateZoneCodeBase:HtgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))  ; SpcHt
;															 +	RunResults[2]:StdElecTDV[1] + ((RunResults[2]:StdNatGasTDV + RunResults[2]:StdOtherTDV) *
;																											T24RClimateZoneCodeBase:ClgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))  ; SpcCl
;															 +	RunResults[3]:StdElecTDV[1]    ; IAQVent
;															 +	RunResults[4]:StandardTDV[1]   ; OthrHVAC
;															 +	RunResults[5]:StdElecTDV[1] + ((RunResults[5]:StdNatGasTDV + RunResults[5]:StdOtherTDV) *
;																											T24RClimateZoneCodeBase:DHWDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))  ; WtrHt
;															 +	RunResults[6]:StandardTDV[1]   ; InsLtg
;															 +	RunResults[7]:StdElecTDV[1] + ((RunResults[7]:StdNatGasTDV + RunResults[7]:StdOtherTDV) *
;																											T24RClimateZoneCodeBase:AppDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))  ; AppCkg
;															 +	RunResults[8]:StandardTDV[1]   ; Plugs
;															 +	RunResults[9]:StandardTDV[1]   ; Ext
;															 +	RunResults[13]:StandardTDV[1] ) ; PV
;																	* 100 / RunResults[10]:DesignRatingTDV    endif  }

   ; SAC 4/6/17 - added rule to revise std model EDR for 2019
   "Set 2019 standard design EDR"   Proj:Action  = {
         if (IfValidAnd( EnergyCodeYearNum >= 2019 ))
         then  EvalRulelist( "CARes_DesignRating_2019Standard" )
         else  UNCHANGED  endif  }

   ; SAC 1/27/18 - added rule to revise std model EDR for 2019
   ; SAC 1/30/18 - modified to calc CDRs iff CalcCO2DesignRatings > 0
   "Set CO2 design ratings"   Proj:Action  = {
         if (IfValidAnd( EnergyCodeYearNum >= 2019 ) .AND. IfValidAnd( CalcCO2DesignRatings > 0 ))
         then  EvalRulelist( "CARes_CO2DesignRating_SingleOrientation" )
         else  UNCHANGED  endif  }

   ; SAC 4/11/19 - moved to Std results so that calced for EAA runs as well
;   "Set CO2 details results"   Proj:Action  =         ; SAC 2/4/19 - split out from CO2DesignRatings results above
;      {  if (IfValidAnd( EnergyCodeYearNum >= 2019 ))
;         then  EvalRulelist( "CARes_CO2Details_SingleOrientation" )
;         else  UNCHANGED  endif  }

;"store BEMProc details"		Proj:Action = {  StoreBEMProc( "ZNE", 0 )  }
;"testing"	Proj:Action	= {	MessageBox( "RunAbbrev = %s  / HERSProj:QII = %g  / ResultSummary[1]:DesignRating = %g  / EDRPVVerified = %g  / ResultSummary[1]:MeetsTier1 = %g  / StdDesignBase = %g",
;											ValidOr( RunAbbrev, "?" ), ValidOr( HERSProj:QII, -9 ), ValidOr( ResultSummary[1]:DesignRating, -9 ), ValidOr( EDRPVVerified, -9 ), ValidOr( ResultSummary[1]:MeetsTier1, -9 ), ValidOr( StdDesignBase, -9 ) )  }

	; SAC 3/25/16 - moved down from Standard results... AND revised MeetsZNETier to require HERSProj:QII & ResultSummary[*]:DesignRating <= 0
	; SAC 5/23/16 - added logic to enforce new requirement of EDRPVVerified (tic #671)
	; SAC 6/28/16 - switched StdDesignBase to CompCodeBase when performing T24RClimateZoneCodeBase look-ups, because StdDesignBase is set to the dr (design rating) code base when this rule is evaluated (tic #702) 
	"Set ResultSummary[1]:MeetsZNETier"			Proj:ResultSummary[1]:MeetsZNETier	= {
         if (IfValidAnd( HERSProj:QII > 0.5 )==0 .OR. IfValidAnd( ResultSummary[1]:DesignRating < 0.05 )==0 .OR. IfValidAnd( EDRPVVerified > 0.5 )==0) then  0
			else if (ResultSummary[1]:MeetsTier2 > 0.5) then  1
			else if (ResultSummary[1]:MeetsTier1 > 0.5)
			then  if (T24RClimateZoneCodeBase:MinZNETier( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase, "BldgType", Proj:BldgTypeTblStr ) < 1.5) then  1  else  0  endif
			else  0  endif endif endif  }
END
;*************************************************************************

;*************************************************************************  - SAC 1/7/18
RULELIST "CARes_DesignRatingSummary_AllOrientations" 1 0 1 1
;*************************************************************************

   ; SAC 1/6/18 - added rule to revise std model EDR for 2019 (since it CAN now vary by orientation due to differences in StdMixedFuel run elec use
   "Set 2016- standard design EDR[1] data"   Proj:Action  = {
         if (IfValidAnd( EnergyCodeYearNum < 2019 ))
         then  EvalRulelist( "CARes_DesignRatingSummary_SingleOrientation" )
         else  UNCHANGED  endif  }

   ; REcalc CO2 stuff to take into account GHC & DHWStdSlrPV credits - SAC 5/6/20 (FlexibilityCredit)
   "Set CO2 details results (again)"   Proj:Action  =  
      {  if (IfValidAnd( EnergyCodeYearNum >= 2019 ))
         then  EvalRulelist( "CARes_CO2Details_AllOrientations" )
         else  UNCHANGED  endif  }

; --- NORTH ---
   ; moved to end of Standard Summary rules so that it is evaluated BEFORE CO2 rules - SAC 5/6/20 (FlexibilityCredit)
   ;; SAC 1/7/18 - eval rules to set grid harmonization credit data for 2019
   ;"Set 2019 grid harmonization credit-N"   Proj:Action  = {
   ;      if (IfValidAnd( EnergyCodeYearNum >= 2019 ))
   ;      then  EvalRulelist( "CARes_DesignRating_2019GHC_N" )
   ;      else  UNCHANGED  endif  }

   ; SAC 2/2/19 - Calc and storage of Flexibility credit (tic #1053)
   "Set ResultSummary[2]:PFlxElecEnergy[2]"     Proj:ResultSummary[2]:PFlxElecEnergy[2]  =
      {  if (IfValidAnd( PropFlexFrac > 0 )==0 .OR. LocalStatus( RunResultsN[11]:PFlxElecEnergy ) < 1 .OR.
                                                    LocalStatus( RunResultsN[11]:PropElecEnergy[1] ) < 1) then  UNDEFINED
         else if (RunResultsN[11]:PFlxElecEnergy = RunResultsN[11]:PropElecEnergy[1]) then  UNDEFINED
         else  (PropFlexFrac * (RunResultsN[11]:PFlxElecEnergy - RunResultsN[11]:PropElecEnergy[1])) * CondFloorArea / 3.413   endif endif  }
   "Set ResultSummary[2]:PFlxElecEnergy[1]"     Proj:ResultSummary[2]:PFlxElecEnergy[1]  =
      {  if (IfValidAnd( ResultSummary[2]:PFlxElecEnergy[2] > -1 )==0) then  UNDEFINED
         else  int( ResultSummary[2]:PFlxElecEnergy[2] + 0.5 )  endif  }
   "Set ResultSummary[2]:PFlxNatGasEnergy[2]"     Proj:ResultSummary[2]:PFlxNatGasEnergy[2]  =
      {  if (IfValidAnd( PropFlexFrac > 0 )==0 .OR. LocalStatus( RunResultsN[11]:PFlxNatGasEnergy ) < 1 .OR.
                                                    LocalStatus( RunResultsN[11]:PropNatGasEnergy[1] ) < 1) then  UNDEFINED
         else if (RunResultsN[11]:PFlxNatGasEnergy = RunResultsN[11]:PropNatGasEnergy[1]) then  UNDEFINED
         else  (PropFlexFrac * (RunResultsN[11]:PFlxNatGasEnergy - RunResultsN[11]:PropNatGasEnergy[1])) * CondFloorArea / 100   endif endif  }
   "Set ResultSummary[2]:PFlxNatGasEnergy[1]"     Proj:ResultSummary[2]:PFlxNatGasEnergy[1]  =
      {  if (IfValidAnd( ResultSummary[2]:PFlxNatGasEnergy[2] > -1 )==0) then  UNDEFINED
         else  int( (ResultSummary[2]:PFlxNatGasEnergy[2]*10) + 0.5 ) / 10  endif  }
   "Set ResultSummary[2]:PFlxOtherEnergy[2]"     Proj:ResultSummary[2]:PFlxOtherEnergy[2]  =
      {  if (IfValidAnd( PropFlexFrac > 0 )==0 .OR. LocalStatus( RunResultsN[11]:PFlxOtherEnergy ) < 1 .OR.
                                                    LocalStatus( RunResultsN[11]:PropOtherEnergy[1] ) < 1) then  UNDEFINED
         else if (RunResultsN[11]:PFlxOtherEnergy = RunResultsN[11]:PropOtherEnergy[1]) then  UNDEFINED
         else  (PropFlexFrac * (RunResultsN[11]:PFlxOtherEnergy - RunResultsN[11]:PropOtherEnergy[1])) * CondFloorArea / 100   endif endif  }
   "Set ResultSummary[2]:PFlxOtherEnergy[1]"     Proj:ResultSummary[2]:PFlxOtherEnergy[1]  =
      {  if (IfValidAnd( ResultSummary[2]:PFlxOtherEnergy[2] > -1 )==0) then  UNDEFINED
         else  int( (ResultSummary[2]:PFlxOtherEnergy[2]*10) + 0.5 ) / 10  endif  }
   "Set ResultSummary[2]:PFlxTDV[2]"     Proj:ResultSummary[2]:PFlxTDV[2]  =
      {  if (IfValidAnd( PropFlexFrac > 0 )==0 .OR. LocalStatus( RunResultsN[11]:PFlxTDV ) < 1 .OR.
                                                    LocalStatus( RunResultsN[11]:ProposedTDV[3] ) < 1) then  UNDEFINED  
         else  (PropFlexFrac * (RunResultsN[11]:PFlxTDV - RunResultsN[11]:ProposedTDV[3]))  endif  }
   "Set ResultSummary[2]:PFlxTDV[1]"     Proj:ResultSummary[2]:PFlxTDV[1]  =
      {  if (LocalStatus( ResultSummary[2]:PFlxTDV[2] ) < 1) then  UNDEFINED
         else  int( (ResultSummary[2]:PFlxTDV[2]*100) + 0.5 ) / 100  endif  }
   "Set ResultSummary[2]:PFlxElecDemand[2]"     Proj:ResultSummary[2]:PFlxElecDemand[2]  =      ; SAC 2/5/19
      {  if (IfValidAnd( PropFlexFrac > 0 )==0 .OR. LocalStatus( RunResultsN[11]:PFlxElecDemand ) < 1 .OR.
                                                    LocalStatus( RunResultsN[11]:PropElecDemand[1] ) < 1) then  UNDEFINED  
         else  (PropFlexFrac * (RunResultsN[11]:PFlxElecDemand - RunResultsN[11]:PropElecDemand[1]))  endif  }
   "Set ResultSummary[2]:PFlxElecDemand[1]"     Proj:ResultSummary[2]:PFlxElecDemand[1]  =
      {  if (LocalStatus( ResultSummary[2]:PFlxElecDemand[2] ) < 1) then  UNDEFINED
         else  int( (ResultSummary[2]:PFlxElecDemand[2]*100) + 0.5 ) / 100  endif  }

   ; SAC 7/19/17 - added rounding of all design rating results to 0.1 (tic #864)
   ; SAC 8/10/17 - added logic to incorporate a fraction of benefit from PropFlex run into overall EDR score
   ; SAC 2/2/19 - revised to reference new PFlxTDV property (tic #1053)
 	"Set ResultSummary[2]:DesignRating"			Proj:ResultSummary[2]:DesignRating		= {
         if (IfValidAnd( RunResultsN[10]:DesignRatingTDV[2] != 0 )==0) then  UNDEFINED
         else if (LocalStatus( ResultSummary[2]:PFlxTDV[2] ) > 0 .AND. LocalStatus( RunResultsN[11]:ProposedTDV[3] ) > 0)
         then   int( ((ResultSummary[2]:PFlxTDV[2] +
                       ValidOr( RunResultsN[10]:ProposedTDV[3], 0 )) * 1000 / RunResultsN[10]:DesignRatingTDV[2])+0.5 )/10
         else   int( ( ValidOr( RunResultsN[10]:ProposedTDV[3], 0 )  * 1000 / RunResultsN[10]:DesignRatingTDV[2])+0.5 )/10
         endif endif  }
   ; SAC 12/19/16 - modified ...NoPV result to also exclude Battery TDV
   ; SAC 6/25/17 - altered logic to use 2019 EDR calcs for 2016
   ; SAC 12/28/17 - add effect of new GHC (grid harmonization credit)
   ; modified to exclude calcs for <2016 code and for 2022 to use (non-fuel adjusted) Compliance, not Total TDV in calc of design rating - SAC 02/06/21
 	"Set ResultSummary[2]:DesignRatingNoPV"	Proj:ResultSummary[2]:DesignRatingNoPV	=
      {  if (EnergyCodeYearNum >= 2022)
         then  if (IfValidAnd( RunResultsN[11]:DesignRatingTDV[1] != 0 )==0) then  UNDEFINED
               else  int( ((ValidOr( RunResultsN[11]:ProposedTDV[1], 0 ) - ValidOr( ResultSummary[2]:GHCEnergyEffTDV, 0 ) -
                            ValidOr( ResultSummary[2]:DHWSlrPVCreditTDV, 0 )) *
                           1000 / RunResultsN[11]:DesignRatingTDV[1])+0.5 )/10
               endif
         else  if (IfValidAnd( RunResultsN[10]:DesignRatingTDV[2] != 0 )==0) then  UNDEFINED
               else  int( ((ValidOr( RunResultsN[10]:ProposedTDV[3], 0 ) - ValidOr( RunResultsN[13]:ProposedTDV[3], 0 ) -
                            ValidOr( RunResultsN[14]:ProposedTDV[3], 0 ) - ValidOr( ResultSummary[2]:GHCEnergyEffTDV, 0 )) *
                           1000 /    RunResultsN[10]:DesignRatingTDV[2])+0.5 )/10
               endif  endif  }
 	"Set ResultSummary[2]:ShowDesignRtgNoPV"	Proj:ResultSummary[2]:ShowDesignRtgNoPV = {	if (EnergyCodeYearNum >= 2019 .OR. ValidOr( RunResultsN[6]:PropPVCreditTDV[2], 0 ) >= 0.0001) then  1  else  0  endif  }
	; SAC 3/16/16 - added new DesignRatingPVOnly & DesignRatingStd - including detailed calc of DesignRatingStd w/ fuel adjustments to StdTDV results
   ; SAC 6/6/17 - flipped sign of PV-only EDR prior to 2019.0.4 release
   ; revised DesignRatingPVOnly calc for 2022 to include only PV, Battery & Flexibility (below line) - SAC 02/09/21
 	"Set ResultSummary[2]:DesignRatingPVOnly"	Proj:ResultSummary[2]:DesignRatingPVOnly	=
      {  if (LocalStatus( ResultSummary[2]:DesignRatingNoPV ) < 1 .OR. LocalStatus( ResultSummary[2]:DesignRating ) < 1) then  UNDEFINED
         else if (EnergyCodeYearNum >= 2022)
         then  (  int( ((ValidOr( RunResultsN[10]:ProposedTDV[3], 0 ) - ValidOr( RunResultsN[13]:ProposedTDV[3], 0 ) -
                         ValidOr( RunResultsN[14]:ProposedTDV[3], 0 ) - ValidOr( ResultSummary[2]:GHCEnergyEffTDV, 0 )) *
                        1000 /    RunResultsN[10]:DesignRatingTDV[2])+0.5 )/10  )  - ResultSummary[2]:DesignRating
         else	ResultSummary[2]:DesignRatingNoPV - ResultSummary[2]:DesignRating  endif endif  }

; SAC 6/12/17 - no need to repeat Std design rating logic, as all orientations identical for std design run
   "Set ResultSummary[2]:DesignRatingStdNoPV"   Proj:ResultSummary[2]:DesignRatingStdNoPV   = {  ResultSummary[1]:DesignRatingStdNoPV    }
   "Set ResultSummary[2]:DesignRatingStd"       Proj:ResultSummary[2]:DesignRatingStd       = {  ResultSummary[1]:DesignRatingStd        }
   "Set ResultSummary[2]:DesignRatingStdPVOnly" Proj:ResultSummary[2]:DesignRatingStdPVOnly = {  ResultSummary[1]:DesignRatingStdPVOnly  }
   ; SAC 1/6/18 - added rule to revise std model EDR for 2019 (since it CAN now vary by orientation due to differences in StdMixedFuel run elec use
   "Set 2019 standard design EDR-N"   Proj:Action  = {
         if (IfValidAnd( EnergyCodeYearNum >= 2019 ))
         then  EvalRulelist( "CARes_DesignRating_2019Standard_N" )
         else  UNCHANGED  endif  }
;"dbg" Proj:Action = { PostMessageToLog( "   Just set ResultSummary[2]:DesignRatingStd = %g", ValidOr( ResultSummary[2]:DesignRatingStd, -999 ) )  }

	; SAC 3/25/16 - moved down from Standard results... AND revised MeetsZNETier to require HERSProj:QII & ResultSummary[*]:DesignRating <= 0
	"Set ResultSummary[2]:MeetsZNETier"			Proj:ResultSummary[2]:MeetsZNETier	= {
         if (IfValidAnd( HERSProj:QII > 0.5 )==0 .OR. IfValidAnd( ResultSummary[2]:DesignRating < 0.05 )==0 .OR. IfValidAnd( EDRPVVerified > 0.5 )==0) then  0
			else if (ResultSummary[2]:MeetsTier2 > 0.5) then  1
			else if (ResultSummary[2]:MeetsTier1 > 0.5)
			then  if (T24RClimateZoneCodeBase:MinZNETier( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) < 1.5) then  1  else  0  endif
			else  0  endif endif endif  }

; --- EAST ---
   ; moved to end of Standard Summary rules so that it is evaluated BEFORE CO2 rules - SAC 5/6/20 (FlexibilityCredit)
   ;; SAC 1/7/18 - eval rules to set grid harmonization credit data for 2019
   ;"Set 2019 grid harmonization credit-E"   Proj:Action  = {
   ;      if (IfValidAnd( EnergyCodeYearNum >= 2019 ))
   ;      then  EvalRulelist( "CARes_DesignRating_2019GHC_E" )
   ;      else  UNCHANGED  endif  }

   ; SAC 2/2/19 - Calc and storage of Flexibility credit (tic #1053)
   "Set ResultSummary[3]:PFlxElecEnergy[2]"     Proj:ResultSummary[3]:PFlxElecEnergy[2]  =
      {  if (IfValidAnd( PropFlexFrac > 0 )==0 .OR. LocalStatus( RunResultsE[11]:PFlxElecEnergy ) < 1 .OR.
                                                    LocalStatus( RunResultsE[11]:PropElecEnergy[1] ) < 1) then  UNDEFINED
         else if (RunResultsE[11]:PFlxElecEnergy = RunResultsE[11]:PropElecEnergy[1]) then  UNDEFINED
         else  (PropFlexFrac * (RunResultsE[11]:PFlxElecEnergy - RunResultsE[11]:PropElecEnergy[1])) * CondFloorArea / 3.413   endif endif  }
   "Set ResultSummary[3]:PFlxElecEnergy[1]"     Proj:ResultSummary[3]:PFlxElecEnergy[1]  =
      {  if (IfValidAnd( ResultSummary[3]:PFlxElecEnergy[2] > -1 )==0) then  UNDEFINED
         else  int( ResultSummary[3]:PFlxElecEnergy[2] + 0.5 )  endif  }
   "Set ResultSummary[3]:PFlxNatGasEnergy[2]"     Proj:ResultSummary[3]:PFlxNatGasEnergy[2]  =
      {  if (IfValidAnd( PropFlexFrac > 0 )==0 .OR. LocalStatus( RunResultsE[11]:PFlxNatGasEnergy ) < 1 .OR.
                                                    LocalStatus( RunResultsE[11]:PropNatGasEnergy[1] ) < 1) then  UNDEFINED
         else if (RunResultsE[11]:PFlxNatGasEnergy = RunResultsE[11]:PropNatGasEnergy[1]) then  UNDEFINED
         else  (PropFlexFrac * (RunResultsE[11]:PFlxNatGasEnergy - RunResultsE[11]:PropNatGasEnergy[1])) * CondFloorArea / 100   endif endif  }
   "Set ResultSummary[3]:PFlxNatGasEnergy[1]"     Proj:ResultSummary[3]:PFlxNatGasEnergy[1]  =
      {  if (IfValidAnd( ResultSummary[3]:PFlxNatGasEnergy[2] > -1 )==0) then  UNDEFINED
         else  int( (ResultSummary[3]:PFlxNatGasEnergy[2]*10) + 0.5 ) / 10  endif  }
   "Set ResultSummary[3]:PFlxOtherEnergy[2]"     Proj:ResultSummary[3]:PFlxOtherEnergy[2]  =
      {  if (IfValidAnd( PropFlexFrac > 0 )==0 .OR. LocalStatus( RunResultsE[11]:PFlxOtherEnergy ) < 1 .OR.
                                                    LocalStatus( RunResultsE[11]:PropOtherEnergy[1] ) < 1) then  UNDEFINED
         else if (RunResultsE[11]:PFlxOtherEnergy = RunResultsE[11]:PropOtherEnergy[1]) then  UNDEFINED
         else  (PropFlexFrac * (RunResultsE[11]:PFlxOtherEnergy - RunResultsE[11]:PropOtherEnergy[1])) * CondFloorArea / 100   endif endif  }
   "Set ResultSummary[3]:PFlxOtherEnergy[1]"     Proj:ResultSummary[3]:PFlxOtherEnergy[1]  =
      {  if (IfValidAnd( ResultSummary[3]:PFlxOtherEnergy[2] > -1 )==0) then  UNDEFINED
         else  int( (ResultSummary[3]:PFlxOtherEnergy[2]*10) + 0.5 ) / 10  endif  }
   "Set ResultSummary[3]:PFlxTDV[2]"     Proj:ResultSummary[3]:PFlxTDV[2]  =
      {  if (IfValidAnd( PropFlexFrac > 0 )==0 .OR. LocalStatus( RunResultsE[11]:PFlxTDV ) < 1 .OR.
                                                    LocalStatus( RunResultsE[11]:ProposedTDV[3] ) < 1) then  UNDEFINED  
         else  (PropFlexFrac * (RunResultsE[11]:PFlxTDV - RunResultsE[11]:ProposedTDV[3]))  endif  }
   "Set ResultSummary[3]:PFlxTDV[1]"     Proj:ResultSummary[3]:PFlxTDV[1]  =
      {  if (LocalStatus( ResultSummary[3]:PFlxTDV[2] ) < 1) then  UNDEFINED
         else  int( (ResultSummary[3]:PFlxTDV[2]*100) + 0.5 ) / 100  endif  }
   "Set ResultSummary[3]:PFlxElecDemand[2]"     Proj:ResultSummary[3]:PFlxElecDemand[2]  =      ; SAC 2/5/19
      {  if (IfValidAnd( PropFlexFrac > 0 )==0 .OR. LocalStatus( RunResultsE[11]:PFlxElecDemand ) < 1 .OR.
                                                    LocalStatus( RunResultsE[11]:PropElecDemand[1] ) < 1) then  UNDEFINED  
         else  (PropFlexFrac * (RunResultsE[11]:PFlxElecDemand - RunResultsE[11]:PropElecDemand[1]))  endif  }
   "Set ResultSummary[3]:PFlxElecDemand[1]"     Proj:ResultSummary[3]:PFlxElecDemand[1]  =
      {  if (LocalStatus( ResultSummary[3]:PFlxElecDemand[2] ) < 1) then  UNDEFINED
         else  int( (ResultSummary[3]:PFlxElecDemand[2]*100) + 0.5 ) / 100  endif  }

   ; SAC 7/19/17 - added rounding of all design rating results to 0.1 (tic #864)
   ; SAC 8/10/17 - added logic to incorporate a fraction of benefit from PropFlex run into overall EDR score
   ; SAC 2/2/19 - revised to reference new PFlxTDV property (tic #1053)
 	"Set ResultSummary[3]:DesignRating"			Proj:ResultSummary[3]:DesignRating		= {
         if (IfValidAnd( RunResultsE[10]:DesignRatingTDV[2] != 0 )==0) then  UNDEFINED
         else if (LocalStatus( ResultSummary[3]:PFlxTDV[2] ) > 0 .AND. LocalStatus( RunResultsE[11]:ProposedTDV[3] ) > 0)
         then   int( ((ResultSummary[3]:PFlxTDV[2] +
                       ValidOr( RunResultsE[10]:ProposedTDV[3], 0 )) * 1000 / RunResultsE[10]:DesignRatingTDV[2])+0.5 )/10
         else   int( ( ValidOr( RunResultsE[10]:ProposedTDV[3], 0 )  * 1000 / RunResultsE[10]:DesignRatingTDV[2])+0.5 )/10
         endif endif  }
   ; SAC 12/19/16 - modified ...NoPV result to also exclude Battery TDV
   ; SAC 6/25/17 - altered logic to use 2019 EDR calcs for 2016
   ; SAC 12/28/17 - add effect of new GHC (grid harmonization credit)
 	"Set ResultSummary[3]:DesignRatingNoPV"	Proj:ResultSummary[3]:DesignRatingNoPV	= 
      {  if (EnergyCodeYearNum >= 2022)
         then  if (IfValidAnd( RunResultsE[11]:DesignRatingTDV[1] != 0 )==0) then  UNDEFINED
               else  int( ((ValidOr( RunResultsE[11]:ProposedTDV[1], 0 ) - ValidOr( ResultSummary[3]:GHCEnergyEffTDV, 0 ) -
                            ValidOr( ResultSummary[3]:DHWSlrPVCreditTDV, 0 )) *
                           1000 / RunResultsE[11]:DesignRatingTDV[1])+0.5 )/10
               endif
         else  if (IfValidAnd( RunResultsE[10]:DesignRatingTDV[2] != 0 )==0) then  UNDEFINED
               else  int( ((ValidOr( RunResultsE[10]:ProposedTDV[3], 0 ) - ValidOr( RunResultsE[13]:ProposedTDV[3], 0 ) -
                            ValidOr( RunResultsE[14]:ProposedTDV[3], 0 ) - ValidOr( ResultSummary[3]:GHCEnergyEffTDV, 0 ) -
                            ValidOr( ResultSummary[3]:DHWSlrPVCreditTDV, 0 )) *
                           1000  /   RunResultsE[10]:DesignRatingTDV[2])+0.5 )/10
               endif  endif  }
 	"Set ResultSummary[3]:ShowDesignRtgNoPV"	Proj:ResultSummary[3]:ShowDesignRtgNoPV = {	if (EnergyCodeYearNum >= 2019 .OR. ValidOr( RunResultsE[6]:PropPVCreditTDV[2], 0 ) >= 0.0001) then  1  else  0  endif  }
	; SAC 3/16/16 - added new DesignRatingPVOnly & DesignRatingStd 
   ; revised DesignRatingPVOnly calc for 2022 to include only PV, Battery & Flexibility (below line) - SAC 02/09/21
 	"Set ResultSummary[3]:DesignRatingPVOnly"	Proj:ResultSummary[3]:DesignRatingPVOnly	=
      {  if (LocalStatus( ResultSummary[3]:DesignRatingNoPV ) < 1 .OR. LocalStatus( ResultSummary[3]:DesignRating ) < 1) then  UNDEFINED
         else if (EnergyCodeYearNum >= 2022)
         then  (  int( ((ValidOr( RunResultsE[10]:ProposedTDV[3], 0 ) - ValidOr( RunResultsE[13]:ProposedTDV[3], 0 ) -
                         ValidOr( RunResultsE[14]:ProposedTDV[3], 0 ) - ValidOr( ResultSummary[3]:GHCEnergyEffTDV, 0 ) -
                         ValidOr( ResultSummary[3]:DHWSlrPVCreditTDV, 0 )) *
                        1000  /   RunResultsE[10]:DesignRatingTDV[2])+0.5 )/10  )  - ResultSummary[3]:DesignRating
         else 	ResultSummary[3]:DesignRatingNoPV - ResultSummary[3]:DesignRating  endif endif  }
   "Set ResultSummary[3]:DesignRatingStdNoPV"   Proj:ResultSummary[3]:DesignRatingStdNoPV   = {  ResultSummary[1]:DesignRatingStdNoPV    }
   "Set ResultSummary[3]:DesignRatingStd"       Proj:ResultSummary[3]:DesignRatingStd       = {  ResultSummary[1]:DesignRatingStd        }
   "Set ResultSummary[3]:DesignRatingStdPVOnly" Proj:ResultSummary[3]:DesignRatingStdPVOnly = {  ResultSummary[1]:DesignRatingStdPVOnly  }
   ; SAC 1/6/18 - added rule to revise std model EDR for 2019 (since it CAN now vary by orientation due to differences in StdMixedFuel run elec use
   "Set 2019 standard design EDR-E"   Proj:Action  = {
         if (IfValidAnd( EnergyCodeYearNum >= 2019 ))
         then  EvalRulelist( "CARes_DesignRating_2019Standard_E" )
         else  UNCHANGED  endif  }
;"dbg" Proj:Action = { PostMessageToLog( "   Just set ResultSummary[3]:DesignRatingStd = %g", ValidOr( ResultSummary[3]:DesignRatingStd, -999 ) )  }

	; SAC 3/25/16 - moved down from Standard results... AND revised MeetsZNETier to require HERSProj:QII & ResultSummary[*]:DesignRating <= 0
	"Set ResultSummary[3]:MeetsZNETier"			Proj:ResultSummary[3]:MeetsZNETier	= {
         if (IfValidAnd( HERSProj:QII > 0.5 )==0 .OR. IfValidAnd( ResultSummary[3]:DesignRating < 0.05 )==0 .OR. IfValidAnd( EDRPVVerified > 0.5 )==0) then  0
         else if (ResultSummary[3]:MeetsTier2 > 0.5) then  1
         else if (ResultSummary[3]:MeetsTier1 > 0.5)
         then  if (T24RClimateZoneCodeBase:MinZNETier( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) < 1.5) then  1  else  0  endif
         else  0  endif endif endif  }

; --- SOUTH ---
   ; moved to end of Standard Summary rules so that it is evaluated BEFORE CO2 rules - SAC 5/6/20 (FlexibilityCredit)
   ;; SAC 1/7/18 - eval rules to set grid harmonization credit data for 2019
   ;"Set 2019 grid harmonization credit-S"   Proj:Action  = {
   ;      if (IfValidAnd( EnergyCodeYearNum >= 2019 ))
   ;      then  EvalRulelist( "CARes_DesignRating_2019GHC_S" )
   ;      else  UNCHANGED  endif  }

   ; SAC 2/2/19 - Calc and storage of Flexibility credit (tic #1053)
   "Set ResultSummary[4]:PFlxElecEnergy[2]"     Proj:ResultSummary[4]:PFlxElecEnergy[2]  =
      {  if (IfValidAnd( PropFlexFrac > 0 )==0 .OR. LocalStatus( RunResultsS[11]:PFlxElecEnergy ) < 1 .OR.
                                                    LocalStatus( RunResultsS[11]:PropElecEnergy[1] ) < 1) then  UNDEFINED
         else if (RunResultsS[11]:PFlxElecEnergy = RunResultsS[11]:PropElecEnergy[1]) then  UNDEFINED
         else  (PropFlexFrac * (RunResultsS[11]:PFlxElecEnergy - RunResultsS[11]:PropElecEnergy[1])) * CondFloorArea / 3.413   endif endif  }
   "Set ResultSummary[4]:PFlxElecEnergy[1]"     Proj:ResultSummary[4]:PFlxElecEnergy[1]  =
      {  if (IfValidAnd( ResultSummary[4]:PFlxElecEnergy[2] > -1 )==0) then  UNDEFINED
         else  int( ResultSummary[4]:PFlxElecEnergy[2] + 0.5 )  endif  }
   "Set ResultSummary[4]:PFlxNatGasEnergy[2]"     Proj:ResultSummary[4]:PFlxNatGasEnergy[2]  =
      {  if (IfValidAnd( PropFlexFrac > 0 )==0 .OR. LocalStatus( RunResultsS[11]:PFlxNatGasEnergy ) < 1 .OR.
                                                    LocalStatus( RunResultsS[11]:PropNatGasEnergy[1] ) < 1) then  UNDEFINED
         else if (RunResultsS[11]:PFlxNatGasEnergy = RunResultsS[11]:PropNatGasEnergy[1]) then  UNDEFINED
         else  (PropFlexFrac * (RunResultsS[11]:PFlxNatGasEnergy - RunResultsS[11]:PropNatGasEnergy[1])) * CondFloorArea / 100   endif endif  }
   "Set ResultSummary[4]:PFlxNatGasEnergy[1]"     Proj:ResultSummary[4]:PFlxNatGasEnergy[1]  =
      {  if (IfValidAnd( ResultSummary[4]:PFlxNatGasEnergy[2] > -1 )==0) then  UNDEFINED
         else  int( (ResultSummary[4]:PFlxNatGasEnergy[2]*10) + 0.5 ) / 10  endif  }
   "Set ResultSummary[4]:PFlxOtherEnergy[2]"     Proj:ResultSummary[4]:PFlxOtherEnergy[2]  =
      {  if (IfValidAnd( PropFlexFrac > 0 )==0 .OR. LocalStatus( RunResultsS[11]:PFlxOtherEnergy ) < 1 .OR.
                                                    LocalStatus( RunResultsS[11]:PropOtherEnergy[1] ) < 1) then  UNDEFINED
         else if (RunResultsS[11]:PFlxOtherEnergy = RunResultsS[11]:PropOtherEnergy[1]) then  UNDEFINED
         else  (PropFlexFrac * (RunResultsS[11]:PFlxOtherEnergy - RunResultsS[11]:PropOtherEnergy[1])) * CondFloorArea / 100   endif endif  }
   "Set ResultSummary[4]:PFlxOtherEnergy[1]"     Proj:ResultSummary[4]:PFlxOtherEnergy[1]  =
      {  if (IfValidAnd( ResultSummary[4]:PFlxOtherEnergy[2] > -1 )==0) then  UNDEFINED
         else  int( (ResultSummary[4]:PFlxOtherEnergy[2]*10) + 0.5 ) / 10  endif  }
   "Set ResultSummary[4]:PFlxTDV[2]"     Proj:ResultSummary[4]:PFlxTDV[2]  =
      {  if (IfValidAnd( PropFlexFrac > 0 )==0 .OR. LocalStatus( RunResultsS[11]:PFlxTDV ) < 1 .OR.
                                                    LocalStatus( RunResultsS[11]:ProposedTDV[3] ) < 1) then  UNDEFINED  
         else  (PropFlexFrac * (RunResultsS[11]:PFlxTDV - RunResultsS[11]:ProposedTDV[3]))  endif  }
   "Set ResultSummary[4]:PFlxTDV[1]"     Proj:ResultSummary[4]:PFlxTDV[1]  =
      {  if (LocalStatus( ResultSummary[4]:PFlxTDV[2] ) < 1) then  UNDEFINED
         else  int( (ResultSummary[4]:PFlxTDV[2]*100) + 0.5 ) / 100  endif  }
   "Set ResultSummary[4]:PFlxElecDemand[2]"     Proj:ResultSummary[4]:PFlxElecDemand[2]  =      ; SAC 2/5/19
      {  if (IfValidAnd( PropFlexFrac > 0 )==0 .OR. LocalStatus( RunResultsS[11]:PFlxElecDemand ) < 1 .OR.
                                                    LocalStatus( RunResultsS[11]:PropElecDemand[1] ) < 1) then  UNDEFINED  
         else  (PropFlexFrac * (RunResultsS[11]:PFlxElecDemand - RunResultsS[11]:PropElecDemand[1]))  endif  }
   "Set ResultSummary[4]:PFlxElecDemand[1]"     Proj:ResultSummary[4]:PFlxElecDemand[1]  =
      {  if (LocalStatus( ResultSummary[4]:PFlxElecDemand[2] ) < 1) then  UNDEFINED
         else  int( (ResultSummary[4]:PFlxElecDemand[2]*100) + 0.5 ) / 100  endif  }

   ; SAC 7/19/17 - added rounding of all design rating results to 0.1 (tic #864)
   ; SAC 8/10/17 - added logic to incorporate a fraction of benefit from PropFlex run into overall EDR score
   ; SAC 2/2/19 - revised to reference new PFlxTDV property (tic #1053)
 	"Set ResultSummary[4]:DesignRating"			Proj:ResultSummary[4]:DesignRating		= {
         if (IfValidAnd( RunResultsS[10]:DesignRatingTDV[2] != 0 )==0) then  UNDEFINED
         else if (LocalStatus( ResultSummary[4]:PFlxTDV[2] ) > 0 .AND. LocalStatus( RunResultsS[11]:ProposedTDV[3] ) > 0)
         then   int( ((ResultSummary[4]:PFlxTDV[2] +
                       ValidOr( RunResultsS[10]:ProposedTDV[3], 0 )) * 1000 / RunResultsS[10]:DesignRatingTDV[2])+0.5 )/10
         else   int( ( ValidOr( RunResultsS[10]:ProposedTDV[3], 0 )  * 1000 / RunResultsS[10]:DesignRatingTDV[2])+0.5 )/10
         endif endif  }
   ; SAC 12/19/16 - modified ...NoPV result to also exclude Battery TDV
   ; SAC 6/25/17 - altered logic to use 2019 EDR calcs for 2016
   ; SAC 12/28/17 - add effect of new GHC (grid harmonization credit)
   ; modified to exclude calcs for <2016 code and for 2022 to use (non-fuel adjusted) Compliance, not Total TDV in calc of design rating - SAC 02/06/21
 	"Set ResultSummary[4]:DesignRatingNoPV"	Proj:ResultSummary[4]:DesignRatingNoPV	=
      {  if (EnergyCodeYearNum >= 2022)
         then  if (IfValidAnd( RunResultsS[11]:DesignRatingTDV[1] != 0 )==0) then  UNDEFINED
               else  int( ((ValidOr( RunResultsS[11]:ProposedTDV[1], 0 ) - ValidOr( ResultSummary[4]:GHCEnergyEffTDV, 0 ) -
                            ValidOr( ResultSummary[4]:DHWSlrPVCreditTDV, 0 )) *
                           1000 / RunResultsS[11]:DesignRatingTDV[1])+0.5 )/10
               endif
         else  if (IfValidAnd( RunResultsS[10]:DesignRatingTDV[2] != 0 )==0) then  UNDEFINED
               else  int( ((ValidOr( RunResultsS[10]:ProposedTDV[3], 0 ) - ValidOr( RunResultsS[13]:ProposedTDV[3], 0 ) -
                            ValidOr( RunResultsS[14]:ProposedTDV[3], 0 ) - ValidOr( ResultSummary[4]:GHCEnergyEffTDV, 0 ) -
                            ValidOr( ResultSummary[4]:DHWSlrPVCreditTDV, 0 )) *
                           1000 /    RunResultsS[10]:DesignRatingTDV[2])+0.5 )/10
               endif  endif  }
 	"Set ResultSummary[4]:ShowDesignRtgNoPV"	Proj:ResultSummary[4]:ShowDesignRtgNoPV = {	if (EnergyCodeYearNum >= 2019 .OR. ValidOr( RunResultsS[6]:PropPVCreditTDV[2], 0 ) >= 0.0001) then  1  else  0  endif  }
	; SAC 3/16/16 - added new DesignRatingPVOnly & DesignRatingStd 
   ; revised DesignRatingPVOnly calc for 2022 to include only PV, Battery & Flexibility (below line) - SAC 02/09/21
 	"Set ResultSummary[4]:DesignRatingPVOnly"	Proj:ResultSummary[4]:DesignRatingPVOnly	=
      {  if (LocalStatus( ResultSummary[4]:DesignRatingNoPV ) < 1 .OR. LocalStatus( ResultSummary[4]:DesignRating ) < 1) then  UNDEFINED
         else if (EnergyCodeYearNum >= 2022)
         then  (  int( ((ValidOr( RunResultsS[10]:ProposedTDV[3], 0 ) - ValidOr( RunResultsS[13]:ProposedTDV[3], 0 ) -
                         ValidOr( RunResultsS[14]:ProposedTDV[3], 0 ) - ValidOr( ResultSummary[4]:GHCEnergyEffTDV, 0 ) -
                         ValidOr( ResultSummary[4]:DHWSlrPVCreditTDV, 0 )) *
                        1000 /    RunResultsS[10]:DesignRatingTDV[2])+0.5 )/10  )  - ResultSummary[4]:DesignRating
         else	ResultSummary[4]:DesignRatingNoPV - ResultSummary[4]:DesignRating  endif endif  }
   "Set ResultSummary[4]:DesignRatingStdNoPV"   Proj:ResultSummary[4]:DesignRatingStdNoPV   = {  ResultSummary[1]:DesignRatingStdNoPV    }
   "Set ResultSummary[4]:DesignRatingStd"       Proj:ResultSummary[4]:DesignRatingStd       = {  ResultSummary[1]:DesignRatingStd        }
   "Set ResultSummary[4]:DesignRatingStdPVOnly" Proj:ResultSummary[4]:DesignRatingStdPVOnly = {  ResultSummary[1]:DesignRatingStdPVOnly  }
   ; SAC 1/7/18 - added rule to revise std model EDR for 2019 (since it CAN now vary by orientation due to differences in StdMixedFuel run elec use
   "Set 2019 standard design EDR-S"   Proj:Action  = {
         if (IfValidAnd( EnergyCodeYearNum >= 2019 ))
         then  EvalRulelist( "CARes_DesignRating_2019Standard_S" )
         else  UNCHANGED  endif  }
;"dbg" Proj:Action = { PostMessageToLog( "   Just set ResultSummary[4]:DesignRatingStd = %g", ValidOr( ResultSummary[4]:DesignRatingStd, -999 ) )  }

	; SAC 3/25/16 - moved down from Standard results... AND revised MeetsZNETier to require HERSProj:QII & ResultSummary[*]:DesignRating <= 0
	"Set ResultSummary[4]:MeetsZNETier"			Proj:ResultSummary[4]:MeetsZNETier	= {
         if (IfValidAnd( HERSProj:QII > 0.5 )==0 .OR. IfValidAnd( ResultSummary[4]:DesignRating < 0.05 )==0 .OR. IfValidAnd( EDRPVVerified > 0.5 )==0) then  0
         else if (ResultSummary[4]:MeetsTier2 > 0.5) then  1
         else if (ResultSummary[4]:MeetsTier1 > 0.5)
         then  if (T24RClimateZoneCodeBase:MinZNETier( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) < 1.5) then  1  else  0  endif
         else  0  endif endif endif  }

; --- WEST ---
   ; moved to end of Standard Summary rules so that it is evaluated BEFORE CO2 rules - SAC 5/6/20 (FlexibilityCredit)
   ;; SAC 1/7/18 - eval rules to set grid harmonization credit data for 2019
   ;"Set 2019 grid harmonization credit-W"   Proj:Action  = {
   ;      if (IfValidAnd( EnergyCodeYearNum >= 2019 ))
   ;      then  EvalRulelist( "CARes_DesignRating_2019GHC_W" )
   ;      else  UNCHANGED  endif  }

   ; SAC 2/2/19 - Calc and storage of Flexibility credit (tic #1053)
   "Set ResultSummary[5]:PFlxElecEnergy[2]"     Proj:ResultSummary[5]:PFlxElecEnergy[2]  =
      {  if (IfValidAnd( PropFlexFrac > 0 )==0 .OR. LocalStatus( RunResultsW[11]:PFlxElecEnergy ) < 1 .OR.
                                                    LocalStatus( RunResultsW[11]:PropElecEnergy[1] ) < 1) then  UNDEFINED
         else if (RunResultsW[11]:PFlxElecEnergy = RunResultsW[11]:PropElecEnergy[1]) then  UNDEFINED
         else  (PropFlexFrac * (RunResultsW[11]:PFlxElecEnergy - RunResultsW[11]:PropElecEnergy[1])) * CondFloorArea / 3.413   endif endif  }
   "Set ResultSummary[5]:PFlxElecEnergy[1]"     Proj:ResultSummary[5]:PFlxElecEnergy[1]  =
      {  if (IfValidAnd( ResultSummary[5]:PFlxElecEnergy[2] > -1 )==0) then  UNDEFINED
         else  int( ResultSummary[5]:PFlxElecEnergy[2] + 0.5 )  endif  }
   "Set ResultSummary[5]:PFlxNatGasEnergy[2]"     Proj:ResultSummary[5]:PFlxNatGasEnergy[2]  =
      {  if (IfValidAnd( PropFlexFrac > 0 )==0 .OR. LocalStatus( RunResultsW[11]:PFlxNatGasEnergy ) < 1 .OR.
                                                    LocalStatus( RunResultsW[11]:PropNatGasEnergy[1] ) < 1) then  UNDEFINED
         else if (RunResultsW[11]:PFlxNatGasEnergy = RunResultsW[11]:PropNatGasEnergy[1]) then  UNDEFINED
         else  (PropFlexFrac * (RunResultsW[11]:PFlxNatGasEnergy - RunResultsW[11]:PropNatGasEnergy[1])) * CondFloorArea / 100   endif endif  }
   "Set ResultSummary[5]:PFlxNatGasEnergy[1]"     Proj:ResultSummary[5]:PFlxNatGasEnergy[1]  =
      {  if (IfValidAnd( ResultSummary[5]:PFlxNatGasEnergy[2] > -1 )==0) then  UNDEFINED
         else  int( (ResultSummary[5]:PFlxNatGasEnergy[2]*10) + 0.5 ) / 10  endif  }
   "Set ResultSummary[5]:PFlxOtherEnergy[2]"     Proj:ResultSummary[5]:PFlxOtherEnergy[2]  =
      {  if (IfValidAnd( PropFlexFrac > 0 )==0 .OR. LocalStatus( RunResultsW[11]:PFlxOtherEnergy ) < 1 .OR.
                                                    LocalStatus( RunResultsW[11]:PropOtherEnergy[1] ) < 1) then  UNDEFINED
         else if (RunResultsW[11]:PFlxOtherEnergy = RunResultsW[11]:PropOtherEnergy[1]) then  UNDEFINED
         else  (PropFlexFrac * (RunResultsW[11]:PFlxOtherEnergy - RunResultsW[11]:PropOtherEnergy[1])) * CondFloorArea / 100   endif endif  }
   "Set ResultSummary[5]:PFlxOtherEnergy[1]"     Proj:ResultSummary[5]:PFlxOtherEnergy[1]  =
      {  if (IfValidAnd( ResultSummary[5]:PFlxOtherEnergy[2] > -1 )==0) then  UNDEFINED
         else  int( (ResultSummary[5]:PFlxOtherEnergy[2]*10) + 0.5 ) / 10  endif  }
   "Set ResultSummary[5]:PFlxTDV[2]"     Proj:ResultSummary[5]:PFlxTDV[2]  =
      {  if (IfValidAnd( PropFlexFrac > 0 )==0 .OR. LocalStatus( RunResultsW[11]:PFlxTDV ) < 1 .OR.
                                                    LocalStatus( RunResultsW[11]:ProposedTDV[3] ) < 1) then  UNDEFINED  
         else  (PropFlexFrac * (RunResultsW[11]:PFlxTDV - RunResultsW[11]:ProposedTDV[3]))  endif  }
   "Set ResultSummary[5]:PFlxTDV[1]"     Proj:ResultSummary[5]:PFlxTDV[1]  =
      {  if (LocalStatus( ResultSummary[5]:PFlxTDV[2] ) < 1) then  UNDEFINED
         else  int( (ResultSummary[5]:PFlxTDV[2]*100) + 0.5 ) / 100  endif  }
   "Set ResultSummary[5]:PFlxElecDemand[2]"     Proj:ResultSummary[5]:PFlxElecDemand[2]  =      ; SAC 2/5/19
      {  if (IfValidAnd( PropFlexFrac > 0 )==0 .OR. LocalStatus( RunResultsW[11]:PFlxElecDemand ) < 1 .OR.
                                                    LocalStatus( RunResultsW[11]:PropElecDemand[1] ) < 1) then  UNDEFINED  
         else  (PropFlexFrac * (RunResultsW[11]:PFlxElecDemand - RunResultsW[11]:PropElecDemand[1]))  endif  }
   "Set ResultSummary[5]:PFlxElecDemand[1]"     Proj:ResultSummary[5]:PFlxElecDemand[1]  =
      {  if (LocalStatus( ResultSummary[5]:PFlxElecDemand[2] ) < 1) then  UNDEFINED
         else  int( (ResultSummary[5]:PFlxElecDemand[2]*100) + 0.5 ) / 100  endif  }

   ; SAC 7/19/17 - added rounding of all design rating results to 0.1 (tic #864)
   ; SAC 8/10/17 - added logic to incorporate a fraction of benefit from PropFlex run into overall EDR score
   ; SAC 2/2/19 - revised to reference new PFlxTDV property (tic #1053)
 	"Set ResultSummary[5]:DesignRating"			Proj:ResultSummary[5]:DesignRating		= {
         if (IfValidAnd( RunResultsW[10]:DesignRatingTDV[2] != 0 )==0) then  UNDEFINED
         else if (LocalStatus( ResultSummary[5]:PFlxTDV[2] ) > 0 .AND. LocalStatus( RunResultsW[11]:ProposedTDV[3] ) > 0)
         then   int( ((ResultSummary[5]:PFlxTDV[2] +
                       ValidOr( RunResultsW[10]:ProposedTDV[3], 0 )) * 1000 / RunResultsW[10]:DesignRatingTDV[2])+0.5 )/10
         else   int( ( ValidOr( RunResultsW[10]:ProposedTDV[3], 0 )  * 1000 / RunResultsW[10]:DesignRatingTDV[2])+0.5 )/10
         endif endif  }

   ; SAC 12/19/16 - modified ...NoPV result to also exclude Battery TDV
   ; SAC 6/25/17 - altered logic to use 2019 EDR calcs for 2016
   ; SAC 12/28/17 - add effect of new GHC (grid harmonization credit)
   ; modified to exclude calcs for <2016 code and for 2022 to use (non-fuel adjusted) Compliance, not Total TDV in calc of design rating - SAC 02/06/21
 	"Set ResultSummary[5]:DesignRatingNoPV"	Proj:ResultSummary[5]:DesignRatingNoPV	=
      {  if (EnergyCodeYearNum >= 2022)
         then  if (IfValidAnd( RunResultsW[11]:DesignRatingTDV[1] != 0 )==0) then  UNDEFINED
               else  int( ((ValidOr( RunResultsW[11]:ProposedTDV[1], 0 ) - ValidOr( ResultSummary[5]:GHCEnergyEffTDV, 0 ) -
                            ValidOr( ResultSummary[5]:DHWSlrPVCreditTDV, 0 )) *
                           1000 / RunResultsW[11]:DesignRatingTDV[1])+0.5 )/10
               endif
         else  if (IfValidAnd( RunResultsW[10]:DesignRatingTDV[2] != 0 )==0) then  UNDEFINED
               else  int( ((ValidOr( RunResultsW[10]:ProposedTDV[3], 0 ) - ValidOr( RunResultsW[13]:ProposedTDV[3], 0 ) -
                            ValidOr( RunResultsW[14]:ProposedTDV[3], 0 ) - ValidOr( ResultSummary[5]:GHCEnergyEffTDV, 0 ) -
                            ValidOr( ResultSummary[5]:DHWSlrPVCreditTDV, 0 )) *
                           1000 /    RunResultsW[10]:DesignRatingTDV[2])+0.5 )/10
               endif  endif  }
 	"Set ResultSummary[5]:ShowDesignRtgNoPV"	Proj:ResultSummary[5]:ShowDesignRtgNoPV = {	if (EnergyCodeYearNum >= 2019 .OR. ValidOr( RunResultsW[6]:PropPVCreditTDV[2], 0 ) >= 0.0001) then  1  else  0  endif  }
	; SAC 3/16/16 - added new DesignRatingPVOnly & DesignRatingStd 
   ; revised DesignRatingPVOnly calc for 2022 to include only PV, Battery & Flexibility (below line) - SAC 02/09/21
 	"Set ResultSummary[5]:DesignRatingPVOnly"	Proj:ResultSummary[5]:DesignRatingPVOnly	=
      {  if (LocalStatus( ResultSummary[5]:DesignRatingNoPV ) < 1 .OR. LocalStatus( ResultSummary[5]:DesignRating ) < 1) then  UNDEFINED
         else if (EnergyCodeYearNum >= 2022)
         then  ( int( ((ValidOr( RunResultsW[10]:ProposedTDV[3], 0 ) - ValidOr( RunResultsW[13]:ProposedTDV[3], 0 ) -
                        ValidOr( RunResultsW[14]:ProposedTDV[3], 0 ) - ValidOr( ResultSummary[5]:GHCEnergyEffTDV, 0 ) -
                        ValidOr( ResultSummary[5]:DHWSlrPVCreditTDV, 0 )) *
                       1000 /    RunResultsW[10]:DesignRatingTDV[2])+0.5 )/10 )  - ResultSummary[5]:DesignRating
         else	ResultSummary[5]:DesignRatingNoPV - ResultSummary[5]:DesignRating  endif endif  }
   "Set ResultSummary[5]:DesignRatingStdNoPV"   Proj:ResultSummary[5]:DesignRatingStdNoPV   = {  ResultSummary[1]:DesignRatingStdNoPV    }
   "Set ResultSummary[5]:DesignRatingStd"       Proj:ResultSummary[5]:DesignRatingStd       = {  ResultSummary[1]:DesignRatingStd        }
   "Set ResultSummary[5]:DesignRatingStdPVOnly" Proj:ResultSummary[5]:DesignRatingStdPVOnly = {  ResultSummary[1]:DesignRatingStdPVOnly  }
   ; SAC 1/6/18 - added rule to revise std model EDR for 2019 (since it CAN now vary by orientation due to differences in StdMixedFuel run elec use
   "Set 2019 standard design EDR-W"   Proj:Action  = {
         if (IfValidAnd( EnergyCodeYearNum >= 2019 ))
         then  EvalRulelist( "CARes_DesignRating_2019Standard_W" )
         else  UNCHANGED  endif  }
;"dbg" Proj:Action = { PostMessageToLog( "   Just set ResultSummary[5]:DesignRatingStd = %g", ValidOr( ResultSummary[5]:DesignRatingStd, -999 ) )  }

	; SAC 3/25/16 - moved down from Standard results... AND revised MeetsZNETier to require HERSProj:QII & ResultSummary[*]:DesignRating <= 0
	"Set ResultSummary[5]:MeetsZNETier"			Proj:ResultSummary[5]:MeetsZNETier	= {
         if (IfValidAnd( HERSProj:QII > 0.5 )==0 .OR. IfValidAnd( ResultSummary[5]:DesignRating < 0.05 )==0 .OR. IfValidAnd( EDRPVVerified > 0.5 )==0) then  0
         else if (ResultSummary[5]:MeetsTier2 > 0.5) then  1
         else if (ResultSummary[5]:MeetsTier1 > 0.5)
         then  if (T24RClimateZoneCodeBase:MinZNETier( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) < 1.5) then  1  else  0  endif
         else  0  endif endif endif  }

   ; SAC 4/11/19 - moved to Std summary rules so that available for EAA runs
;   "Set CO2 details results"   Proj:Action  =         ; SAC 2/4/19 - split out from CO2DesignRatings results above
;      {  if (IfValidAnd( EnergyCodeYearNum >= 2019 ))
;         then  EvalRulelist( "CARes_CO2Details_AllOrientations" )
;         else  UNCHANGED  endif  }

END
;*************************************************************************



;*************************************************************************   - SAC 6/25/13
RULELIST "CARes_ProposedSummary_N" 1 0 1 1
;*************************************************************************
   ; SAC 6/13/17 - port PV scaling logic from 'CARes_ProposedSummary' rulelist
;            "debugging"  Proj:Action = {  PostMessageToLog( "      ScalePropPVResults: %g", ValidOr( ScalePropPVResults, -999 ) )  }
;            "debugging"  Proj:Action = {  PostMessageToLog( "      MaxPropPVRatio:     %g", ValidOr( MaxPropPVRatio, -999 ) )  }
;            "debugging"  Proj:Action = {  PostMessageToLog( "      N: RunResultsN[13]:PropElecEnergy[1]: %g", ValidOr( RunResultsN[13]:PropElecEnergy[1], -999 ) )  }
;            "debugging"  Proj:Action = {  PostMessageToLog( "      N: RunResultsN[10]:PropElecEnergy[1]: %g", ValidOr( RunResultsN[10]:PropElecEnergy[1], -999 ) )  }

   "Set Proj:ResultSummary[2]:UnscaledPropPVRatio"   Proj:ResultSummary[2]:UnscaledPropPVRatio  = {
         if (IfValidAnd( ScalePropPVResults > 0.5 )==0 .OR.
             IfValidAnd( MaxPropPVRatio >= 0 )==0 .OR.
             IfValidAnd( RunResultsN[13]:PropElecEnergy[1] < 0 )==0 .OR.
             LocalStatus( RunResultsN[10]:PropElecEnergy[1] ) < 1) then  UNDEFINED
         else if (CompCodeBase == 2016)
         then  (-1 * RunResultsN[13]:PropElecEnergy[1] / min( 1, ValidOr( PVWDCSizeMultiplier[1], 1 ) )) /
                RunResultsN[10]:PropElecEnergy[1]
         else if (CompCodeBase >= 2019)
         then  (-1 * RunResultsN[13]:PropElecEnergy[1] / min( 1, ValidOr( PVWDCSizeMultiplier[1], 1 ) )) /
               (RunResultsN[10]:PropElecEnergy[1] - RunResultsN[13]:PropElecEnergy[1])
         else  UNDEFINED  endif endif endif  }

;            "debugging"  Proj:Action = {  PostMessageToLog( "      N: UnscaledPropPVRatio: %g", ValidOr( ResultSummary[2]:UnscaledPropPVRatio, -999 ) )  }
;            "debugging"  Proj:Action = {  PostMessageToLog( "      N: ValidOr( UnscaledPropPVRatio, 0 ): %g", ValidOr( ValidOr( ResultSummary[2]:UnscaledPropPVRatio, 0 ), -999 ) )  }
;            "debugging"  Proj:Action = {  PostMessageToLog( "      N: ValidOr( MaxPropPVRatio,      1 ): %g", ValidOr( ValidOr( MaxPropPVRatio, 1 ), -999 ) )  }

;            "Debug log msg"   Proj:Action  = {
;               if (IfValidAnd( ScalePropPVResults > 0.5 )==0 .OR. IfValidAnd( MaxPropPVRatio >= 0 )==0 .OR. IfValidAnd( RunResultsN[13]:PropElecEnergy[1] < 0 )==0) then  UNCHANGED
;               else if (CompCodeBase == 2016)
;               then  if (IfValidAnd( RunResultsN[10]:PropElecEnergy[1] != 0 )==0)
;                     then  PostMessageToLog( "   N: Scale PV check:   currentPVRatio = <infinite>  |  Unscld = %.3f  |  Max = %.2f  |  TargetDRtgIterNum = %.0f of Max %.0f  |  PVWDCSizeMultiplier[1] = %.3f",
;                                                                                                             ResultSummary[2]:UnscaledPropPVRatio, MaxPropPVRatio, TargetDRtgIterNum, TargetDRtgMaxIter, ValidOr( PVWDCSizeMultiplier[1], -1 ), ValidOr( PVWDCSizeMultiplier[2], -1 ) )
;                     else  PostMessageToLog( "   N: Scale PV check:   currentPVRatio = %.3f  |  Unscld = %.3f  |  Max = %.2f  |  TargetDRtgIterNum = %.0f of Max %.0f  |  PVWDCSizeMultiplier[1] = %.3f",
;                                 (-1 * RunResultsN[13]:PropElecEnergy[1]) / RunResultsN[10]:PropElecEnergy[1], ResultSummary[2]:UnscaledPropPVRatio, MaxPropPVRatio, TargetDRtgIterNum, TargetDRtgMaxIter, ValidOr( PVWDCSizeMultiplier[1], -1 ), ValidOr( PVWDCSizeMultiplier[2], -1 ) )
;                     endif
;               else if (CompCodeBase == 2019)
;               then  if (ValidOr( RunResultsN[10]:PropElecEnergy[1], -999 ) == ValidOr( RunResultsN[13]:PropElecEnergy[1], 999 ))
;                     then  PostMessageToLog( "   N: Scale PV check:   currentPVRatio = <infinite>  |  Unscld = %.3f  |  Max = %.2f  |  TargetDRtgIterNum = %.0f of Max %.0f  |  PVWDCSizeMultiplier[1] = %.3f",
;                                                                                                             ResultSummary[2]:UnscaledPropPVRatio, MaxPropPVRatio, TargetDRtgIterNum, TargetDRtgMaxIter, ValidOr( PVWDCSizeMultiplier[1], -1 ), ValidOr( PVWDCSizeMultiplier[2], -1 ) )
;                     else  PostMessageToLog( "   N: Scale PV check:   currentPVRatio = %.3f  |  Unscld = %.3f  |  Max = %.2f  |  TargetDRtgIterNum = %.0f of Max %.0f  |  PVWDCSizeMultiplier[1] = %.3f",
;                                 (-1 * RunResultsN[13]:PropElecEnergy[1]) / (RunResultsN[10]:PropElecEnergy[1] - RunResultsN[13]:PropElecEnergy[1]), ResultSummary[2]:UnscaledPropPVRatio, MaxPropPVRatio, TargetDRtgIterNum, TargetDRtgMaxIter, ValidOr( PVWDCSizeMultiplier[1], -1 ), ValidOr( PVWDCSizeMultiplier[2], -1 ) )
;                     endif
;               else  UNCHANGED  endif endif endif  }

   "Init PropPVScaleFactor"   Proj:ResultSummary[2]:PropPVScaleFactor  = {  UNDEFINED  }
   ; SAC 4/17/17 - added logic to prevent scaling Proposed PV here if Target EDR processing is activated
   ; SAC 4/27/17 - added 2016 logic (PV not added into Total @ this point
   ; SAC 1/18/18 - added reference to ResultSummary[]:PropInputPVMult to fix user input scaling bug (tic #965)
   "Scale Proposed PV & Battery if necessary"      Proj:Action  = {
         if (ValidOr( ResultSummary[2]:UnscaledPropPVRatio, -999 ) <= ValidOr( MaxPropPVRatio, 1 )) then  UNCHANGED
         else if (CompCodeBase == 2016)
         then  EvalRulelist( "CARes_ProposedSummary_N_ScalePV_2016" )
         else if (CompCodeBase >= 2019)
         then  if (LocalStatus( TargetDesignRtg ) > 0 .OR. IfValidAnd( ResultSummary[2]:PropInputPVMult > 0 ))
               then  UNCHANGED
            ;   then  if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0) then  UNCHANGED   - removed NSC adjustment during TEDR processing since final run ultimately will be clipped @ the max PV size
            ;         else  EvalRulelist( "CARes_ProposedSummary_TargetEDR_NetSurpComp" )  endif
               else  EvalRulelist( "CARes_ProposedSummary_N_ScalePV" )  endif
         else  UNCHANGED  endif endif endif  }
   ; SAC 6/13/17 - END OF - port PV scaling logic from 'CARes_ProposedSummary' rulelist

	"Set ResultSummary[2]:Title3[1]"				Proj:ResultSummary[2]:Title3[1]		= {	"End Use"  }

	"Set ResultSummary[2]:Enduse1[1]"			Proj:ResultSummary[2]:Enduse1[1]		= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsN[1]:EnduseName  )  endif  }
	"Set ResultSummary[2]:Enduse2[1]"			Proj:ResultSummary[2]:Enduse2[1]		= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsN[2]:EnduseName  )  endif  }
	"Set ResultSummary[2]:Enduse3[1]"			Proj:ResultSummary[2]:Enduse3[1]		= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsN[3]:EnduseName  )  endif  }
	"Set ResultSummary[2]:Enduse4[1]"			Proj:ResultSummary[2]:Enduse4[1]		= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsN[4]:EnduseName  )  endif  }
	"Set ResultSummary[2]:Enduse5[1]"			Proj:ResultSummary[2]:Enduse5[1]		= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsN[5]:EnduseName  )  endif  }
   "Set ResultSummary[2]:Enduse98[1]"			Proj:ResultSummary[2]:Enduse98[1]	= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0) then  UNDEFINED  else  "Flexibility"  endif  }    ; SAC 2/2/19 (tic #1053)
  ;"Set ResultSummary[2]:Enduse99[1]"			Proj:ResultSummary[2]:Enduse99[1]	= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0) then  UNDEFINED  else  "Grid Harmonization"  endif  }
  ;"Set ResultSummary[2]:Enduse99[1]"			Proj:ResultSummary[2]:Enduse99[1]	= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0) then  UNDEFINED  else  "Self Utilization Credit"  endif  }  ; SAC 3/6/18 - label change from CEC-LF
	"Set ResultSummary[2]:Enduse99[1]"			Proj:ResultSummary[2]:Enduse99[1]	= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0) then  UNDEFINED  else  "Self Util/Flexibility Credit"  endif  }  ; SAC 5/4/20 - label change from CEC-DT
	"Set ResultSummary[2]:Enduse14[1]"			Proj:ResultSummary[2]:Enduse14[1]	= {	if (LocalCompAssigned( RunResultsN[14] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsN[14]:EnduseName )  endif  }
	"Set ResultSummary[2]:Enduse6[1]"			Proj:ResultSummary[2]:Enduse6[1]		= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsN[6]:EnduseName  )  endif  }
	"Set ResultSummary[2]:Enduse7[1]"			Proj:ResultSummary[2]:Enduse7[1]		= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsN[7]:EnduseName  )  endif  }
	"Set ResultSummary[2]:Enduse8[1]"			Proj:ResultSummary[2]:Enduse8[1]		= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsN[8]:EnduseName  )  endif  }
	"Set ResultSummary[2]:Enduse9[1]"			Proj:ResultSummary[2]:Enduse9[1]		= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsN[9]:EnduseName  )  endif  }
	"Set ResultSummary[2]:Enduse10[1]"			Proj:ResultSummary[2]:Enduse10[1]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsN[10]:EnduseName )  endif  }
	"Set ResultSummary[2]:Enduse11[1]"			Proj:ResultSummary[2]:Enduse11[1]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsN[11]:EnduseName )  endif  }
	"Set ResultSummary[2]:Enduse12[1]"			Proj:ResultSummary[2]:Enduse12[1]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsN[12]:EnduseName )  endif  }
 	"Set ResultSummary[2]:Enduse13[1]"			Proj:ResultSummary[2]:Enduse13[1]	= {	if (LocalCompAssigned( RunResultsN[13] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsN[13]:EnduseName )  endif  }

  ; Proposed Site Electric Use
	"Set ResultSummary[2]:Title1[2]"				Proj:ResultSummary[2]:Title1[2]		= {	if (EnergyCodeYearNum < 2022) then  "Proposed"    else if (EnergyCodeYearNum < 2025) then  "Proposed Design:"  else  "Proposed Design"  endif endif  }
	"Set ResultSummary[2]:Title2[2]"				Proj:ResultSummary[2]:Title2[2]		= {	if (EnergyCodeYearNum < 2022) then  "Design"      else if (EnergyCodeYearNum < 2025) then  "Site"              else  "Site Elec."       endif endif  }
	"Set ResultSummary[2]:Title3[2]"				Proj:ResultSummary[2]:Title3[2]		= {	if (EnergyCodeYearNum < 2022) then  "Site (kWh)"  else  "(kWh/yr)"             endif  }
	"Set ResultSummary[2]:Enduse1[2]"			Proj:ResultSummary[2]:Enduse1[2]		= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0 .OR. RunResultsN[1]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsN[1]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse2[2]"			Proj:ResultSummary[2]:Enduse2[2]		= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0 .OR. RunResultsN[2]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsN[2]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse3[2]"			Proj:ResultSummary[2]:Enduse3[2]		= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0 .OR. RunResultsN[3]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsN[3]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse4[2]"			Proj:ResultSummary[2]:Enduse4[2]		= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0 .OR. RunResultsN[4]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsN[4]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse5[2]"			Proj:ResultSummary[2]:Enduse5[2]		= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0 .OR. RunResultsN[5]:PropElecEnergy[1]  < 0.00001) then
																														if (Proj:ModelingDHW < 0.5) then  "- none -"  else  UNDEFINED  endif
																													else  FltToStr(       (int( (RunResultsN[5]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse14[2]"			Proj:ResultSummary[2]:Enduse14[2]	= {	if (LocalCompAssigned( RunResultsN[14] ) == 0 .OR. RunResultsN[14]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsN[14]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse6[2]"			Proj:ResultSummary[2]:Enduse6[2]		= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0 .OR. RunResultsN[6]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsN[6]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse7[2]"			Proj:ResultSummary[2]:Enduse7[2]		= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0 .OR. RunResultsN[7]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsN[7]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse8[2]"			Proj:ResultSummary[2]:Enduse8[2]		= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0 .OR. RunResultsN[8]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsN[8]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse9[2]"			Proj:ResultSummary[2]:Enduse9[2]		= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0 .OR. RunResultsN[9]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsN[9]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse10[2]"			Proj:ResultSummary[2]:Enduse10[2]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsN[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse11[2]"			Proj:ResultSummary[2]:Enduse11[2]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsN[11]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse12[2]"			Proj:ResultSummary[2]:Enduse12[2]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0 .OR. RunResultsN[12]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsN[12]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
   ; SAC 10/6/16 - 2019 PV
	"Set ResultSummary[2]:Enduse13[2]"			Proj:ResultSummary[2]:Enduse13[2]	= {	if (IfValidAnd( RunResultsN[13]:PropElecEnergy[1] < -0.00001 )==0 .OR. EnergyCodeYearNum < 2019) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsN[13]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }

  ; Proposed Site FUEL Use
	"Set ResultSummary[2]:Title1[3]"				Proj:ResultSummary[2]:Title1[3]		= {	if (EnergyCodeYearNum < 2022) then  "Proposed"       else  UNDEFINED   endif  }
	"Set ResultSummary[2]:Title2[3]"				Proj:ResultSummary[2]:Title2[3]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "Site"  else  "Site Gas"  endif endif  }
	"Set ResultSummary[2]:Title3[3]"				Proj:ResultSummary[2]:Title3[3]		= {	if (EnergyCodeYearNum < 2022) then  "Site (therms)"  else  "(therms/yr)"  endif  }
	"Set ResultSummary[2]:Enduse1[3]"			Proj:ResultSummary[2]:Enduse1[3]		= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0 .OR.  (RunResultsN[1]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsN[1]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[1]:PropNatGasEnergy[1]  + RunResultsN[1]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse2[3]"			Proj:ResultSummary[2]:Enduse2[3]		= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0 .OR.  (RunResultsN[2]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsN[2]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[2]:PropNatGasEnergy[1]  + RunResultsN[2]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse3[3]"			Proj:ResultSummary[2]:Enduse3[3]		= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0 .OR.  (RunResultsN[3]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsN[3]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[3]:PropNatGasEnergy[1]  + RunResultsN[3]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse4[3]"			Proj:ResultSummary[2]:Enduse4[3]		= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0 .OR.  (RunResultsN[4]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsN[4]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[4]:PropNatGasEnergy[1]  + RunResultsN[4]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse5[3]"			Proj:ResultSummary[2]:Enduse5[3]		= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0 .OR.  (RunResultsN[5]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsN[5]:PropOtherEnergy[1]  < 0.00001)) then
																														if (Proj:ModelingDHW < 0.5) then  "- none -"  else  UNDEFINED  endif
																													else  FltToStr( ((RunResultsN[5]:PropNatGasEnergy[1]  + RunResultsN[5]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse6[3]"			Proj:ResultSummary[2]:Enduse6[3]		= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0 .OR.  (RunResultsN[6]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsN[6]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[6]:PropNatGasEnergy[1]  + RunResultsN[6]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse7[3]"			Proj:ResultSummary[2]:Enduse7[3]		= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0 .OR.  (RunResultsN[7]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsN[7]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[7]:PropNatGasEnergy[1]  + RunResultsN[7]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse8[3]"			Proj:ResultSummary[2]:Enduse8[3]		= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0 .OR.  (RunResultsN[8]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsN[8]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[8]:PropNatGasEnergy[1]  + RunResultsN[8]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse9[3]"			Proj:ResultSummary[2]:Enduse9[3]		= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0 .OR.  (RunResultsN[9]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsN[9]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[9]:PropNatGasEnergy[1]  + RunResultsN[9]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse10[3]"			Proj:ResultSummary[2]:Enduse10[3]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0 .OR.  (RunResultsN[10]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsN[10]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[10]:PropNatGasEnergy[1] + RunResultsN[10]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse11[3]"			Proj:ResultSummary[2]:Enduse11[3]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0 .OR.  (RunResultsN[11]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsN[11]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[11]:PropNatGasEnergy[1] + RunResultsN[11]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse12[3]"			Proj:ResultSummary[2]:Enduse12[3]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0 .OR.  (RunResultsN[12]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsN[12]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[12]:PropNatGasEnergy[1] + RunResultsN[12]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }

  ; Proposed TDV
	"Set ResultSummary[2]:Title1[4]"				Proj:ResultSummary[2]:Title1[4]		= {	if (EnergyCodeYearNum < 2022) then  "Proposed"       else  UNDEFINED        endif  }
	"Set ResultSummary[2]:Title2[4]"				Proj:ResultSummary[2]:Title2[4]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "EDR2"  else  Proj:CompMetricLbl_Short + ""  endif endif  }   ; SAC 01/29/23
	"Set ResultSummary[2]:Title3[4]"				Proj:ResultSummary[2]:Title3[4]		= {	if (EnergyCodeYearNum < 2022) then  "(kTDV/ft-yr)"  else if (EnergyCodeYearNum < 2025) then  "(kTDV/ft-yr)"  else  "($/ft)"  endif endif  }
	"Set ResultSummary[2]:Enduse1[4]"			Proj:ResultSummary[2]:Enduse1[4]		= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[1]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse2[4]"			Proj:ResultSummary[2]:Enduse2[4]		= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[2]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse3[4]"			Proj:ResultSummary[2]:Enduse3[4]		= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[3]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse4[4]"			Proj:ResultSummary[2]:Enduse4[4]		= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[4]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse5[4]"			Proj:ResultSummary[2]:Enduse5[4]		= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[5]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse14[4]"			Proj:ResultSummary[2]:Enduse14[4]	= {	if (LocalCompAssigned( RunResultsN[14] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[14]:ProposedTDV[1] ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse6[4]"			Proj:ResultSummary[2]:Enduse6[4]		= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[6]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse7[4]"			Proj:ResultSummary[2]:Enduse7[4]		= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[7]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse8[4]"			Proj:ResultSummary[2]:Enduse8[4]		= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[8]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse9[4]"			Proj:ResultSummary[2]:Enduse9[4]		= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[9]:ProposedTDV[1]  ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse10[4]"			Proj:ResultSummary[2]:Enduse10[4]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[10]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse11[4]"			Proj:ResultSummary[2]:Enduse11[4]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[11]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse12[4]"			Proj:ResultSummary[2]:Enduse12[4]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[12]:ProposedTDV[1] ), 2 )  endif  }
   ; SAC 10/6/16 - 2019 PV
 	"Set ResultSummary[2]:Enduse13[4]"			Proj:ResultSummary[2]:Enduse13[4]	= {	if (LocalCompAssigned( RunResultsN[13] ) == 0 .OR. EnergyCodeYearNum < 2019) then  UNDEFINED
                                                                                                                                                       else  FltToStr( LocalRef( RunResultsN[13]:ProposedTDV[1] ), 2 )  endif  }

  ; Proposed Electric Demand
	"Set ResultSummary[2]:Title1[10]"			Proj:ResultSummary[2]:Title1[10]		= {	"Proposed"  }
	"Set ResultSummary[2]:Title2[10]"			Proj:ResultSummary[2]:Title2[10]		= {	"Design"  }
	"Set ResultSummary[2]:Title3[10]"			Proj:ResultSummary[2]:Title3[10]		= {	"(kW)"  }
	"Set ResultSummary[2]:Enduse1[10]"			Proj:ResultSummary[2]:Enduse1[10]	= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[1]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse2[10]"			Proj:ResultSummary[2]:Enduse2[10]	= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[2]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse3[10]"			Proj:ResultSummary[2]:Enduse3[10]	= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[3]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse4[10]"			Proj:ResultSummary[2]:Enduse4[10]	= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[4]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse5[10]"			Proj:ResultSummary[2]:Enduse5[10]	= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[5]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse14[10]"			Proj:ResultSummary[2]:Enduse14[10]	= {	if (LocalCompAssigned( RunResultsN[14] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[14]:PropElecDemand[1] ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse6[10]"			Proj:ResultSummary[2]:Enduse6[10]	= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[6]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse7[10]"			Proj:ResultSummary[2]:Enduse7[10]	= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[7]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse8[10]"			Proj:ResultSummary[2]:Enduse8[10]	= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[8]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse9[10]"			Proj:ResultSummary[2]:Enduse9[10]	= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[9]:PropElecDemand[1]  ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse10[10]"			Proj:ResultSummary[2]:Enduse10[10]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[10]:PropElecDemand[1] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse11[10]"			Proj:ResultSummary[2]:Enduse11[10]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[11]:PropElecDemand[1] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse12[10]"			Proj:ResultSummary[2]:Enduse12[10]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[12]:PropElecDemand[1] ), 2 )  endif  }

         ; SAC 12/02/20 - add in PV export results (primarily for 2022 research)
   "Set Proj:ResultSummary[2]:PropPV_Total kWh"       Proj:ResultSummary[2]:PropPV_Total     =
      {  -1 * ValidOr( RunResultsN[13]:PropElecEnergy[1], 0 ) * CondFloorArea / 3.412  }
   "Set Proj:ResultSummary[2]:PropPV_Export kWh"      Proj:ResultSummary[2]:PropPV_Export    =
      {  if (IfValidAnd( ResultSummary[2]:PropPV_Total > 0 )==0) then  0
         else  -1 * ApplyHourlyResultMultipliers_Neg( "none", "none", 1, 1, "none", 0, 0, RunID, "MtrElec", "Tot" ) / 3.412
         endif  }
   "Set Proj:ResultSummary[2]:PropPV_PctExport %"     Proj:ResultSummary[2]:PropPV_PctExport =
      {  if (IfValidAnd( ResultSummary[2]:PropPV_Export > 0 )==0) then  0
         else  ResultSummary[2]:PropPV_Export * 100 / ResultSummary[2]:PropPV_Total  endif  }

  ; SAC 10/7/17 - added rules to calc carbon emissions by enduse   ; prevent calling Carbon rules for User model - SAC 09/20/21
   "Call rulelist to calculate Proposed-N carbon emissions"   Proj:Action    = {
         if (EnergyCodeYearNum < 2019 .OR. RunAbbrev == "u") then  UNCHANGED
         else  EvalRulelist( "CARes_ProposedResults_Carbon_N" )  endif  }
END

;*************************************************************************   - SAC 6/25/13
RULELIST "CARes_ProposedSummary_E" 1 0 1 1
;*************************************************************************
   ; SAC 6/13/17 - port PV scaling logic from 'CARes_ProposedSummary' rulelist
;            "debugging"  Proj:Action = {  PostMessageToLog( "      ScalePropPVResults: %g", ValidOr( ScalePropPVResults, -999 ) )  }
;            "debugging"  Proj:Action = {  PostMessageToLog( "      MaxPropPVRatio:     %g", ValidOr( MaxPropPVRatio, -999 ) )  }
;            "debugging"  Proj:Action = {  PostMessageToLog( "      E: RunResultsE[13]:PropElecEnergy[1]: %g", ValidOr( RunResultsE[13]:PropElecEnergy[1], -999 ) )  }
;            "debugging"  Proj:Action = {  PostMessageToLog( "      E: RunResultsE[10]:PropElecEnergy[1]: %g", ValidOr( RunResultsE[10]:PropElecEnergy[1], -999 ) )  }

   "Set Proj:ResultSummary[3]:UnscaledPropPVRatio"   Proj:ResultSummary[3]:UnscaledPropPVRatio  = {
         if (IfValidAnd( ScalePropPVResults > 0.5 )==0 .OR.
             IfValidAnd( MaxPropPVRatio >= 0 )==0 .OR.
             IfValidAnd( RunResultsE[13]:PropElecEnergy[1] < 0 )==0 .OR.
             LocalStatus( RunResultsE[10]:PropElecEnergy[1] ) < 1) then  UNDEFINED
         else if (CompCodeBase == 2016)
         then  (-1 * RunResultsE[13]:PropElecEnergy[1] / min( 1, ValidOr( PVWDCSizeMultiplier[1], 1 ) )) /
                RunResultsE[10]:PropElecEnergy[1]
         else if (CompCodeBase >= 2019)
         then  (-1 * RunResultsE[13]:PropElecEnergy[1] / min( 1, ValidOr( PVWDCSizeMultiplier[1], 1 ) )) /
               (RunResultsE[10]:PropElecEnergy[1] - RunResultsE[13]:PropElecEnergy[1])
         else  UNDEFINED  endif endif endif  }

;            "debugging"  Proj:Action = {  PostMessageToLog( "      E: UnscaledPropPVRatio: %g", ValidOr( ResultSummary[3]:UnscaledPropPVRatio, -999 ) )  }
;            "debugging"  Proj:Action = {  PostMessageToLog( "      E: ValidOr( UnscaledPropPVRatio, 0 ): %g", ValidOr( ValidOr( ResultSummary[3]:UnscaledPropPVRatio, 0 ), -999 ) )  }
;            "debugging"  Proj:Action = {  PostMessageToLog( "      E: ValidOr( MaxPropPVRatio,      1 ): %g", ValidOr( ValidOr( MaxPropPVRatio, 1 ), -999 ) )  }

;            "Debug log msg"   Proj:Action  = {
;               if (IfValidAnd( ScalePropPVResults > 0.5 )==0 .OR. IfValidAnd( MaxPropPVRatio >= 0 )==0 .OR. IfValidAnd( RunResultsE[13]:PropElecEnergy[1] < 0 )==0) then  UNCHANGED
;               else if (CompCodeBase == 2016)
;               then  if (IfValidAnd( RunResultsE[10]:PropElecEnergy[1] != 0 )==0)
;                     then  PostMessageToLog( "   E: Scale PV check:   currentPVRatio = <infinite>  |  Unscld = %.3f  |  Max = %.2f  |  TargetDRtgIterNum = %.0f of Max %.0f  |  PVWDCSizeMultiplier[1] = %.3f",
;                                                                                                             ResultSummary[3]:UnscaledPropPVRatio, MaxPropPVRatio, TargetDRtgIterNum, TargetDRtgMaxIter, ValidOr( PVWDCSizeMultiplier[1], -1 ), ValidOr( PVWDCSizeMultiplier[2], -1 ) )
;                     else  PostMessageToLog( "   E: Scale PV check:   currentPVRatio = %.3f  |  Unscld = %.3f  |  Max = %.2f  |  TargetDRtgIterNum = %.0f of Max %.0f  |  PVWDCSizeMultiplier[1] = %.3f",
;                                 (-1 * RunResultsE[13]:PropElecEnergy[1]) / RunResultsE[10]:PropElecEnergy[1], ResultSummary[3]:UnscaledPropPVRatio, MaxPropPVRatio, TargetDRtgIterNum, TargetDRtgMaxIter, ValidOr( PVWDCSizeMultiplier[1], -1 ), ValidOr( PVWDCSizeMultiplier[2], -1 ) )
;                     endif
;               else if (CompCodeBase == 2019)
;               then  if (ValidOr( RunResultsE[10]:PropElecEnergy[1], -999 ) == ValidOr( RunResultsE[13]:PropElecEnergy[1], 999 ))
;                     then  PostMessageToLog( "   E: Scale PV check:   currentPVRatio = <infinite>  |  Unscld = %.3f  |  Max = %.2f  |  TargetDRtgIterNum = %.0f of Max %.0f  |  PVWDCSizeMultiplier[1] = %.3f",
;                                                                                                             ResultSummary[3]:UnscaledPropPVRatio, MaxPropPVRatio, TargetDRtgIterNum, TargetDRtgMaxIter, ValidOr( PVWDCSizeMultiplier[1], -1 ), ValidOr( PVWDCSizeMultiplier[2], -1 ) )
;                     else  PostMessageToLog( "   E: Scale PV check:   currentPVRatio = %.3f  |  Unscld = %.3f  |  Max = %.2f  |  TargetDRtgIterNum = %.0f of Max %.0f  |  PVWDCSizeMultiplier[1] = %.3f",
;                                 (-1 * RunResultsE[13]:PropElecEnergy[1]) / (RunResultsE[10]:PropElecEnergy[1] - RunResultsE[13]:PropElecEnergy[1]), ResultSummary[3]:UnscaledPropPVRatio, MaxPropPVRatio, TargetDRtgIterNum, TargetDRtgMaxIter, ValidOr( PVWDCSizeMultiplier[1], -1 ), ValidOr( PVWDCSizeMultiplier[2], -1 ) )
;                     endif
;               else  UNCHANGED  endif endif endif  }

   "Init PropPVScaleFactor"   Proj:ResultSummary[3]:PropPVScaleFactor  = {  UNDEFINED  }
   ; SAC 4/17/17 - added logic to prevent scaling Proposed PV here if Target EDR processing is activated
   ; SAC 4/27/17 - added 2016 logic (PV not added into Total @ this point
   ; SAC 1/18/18 - added reference to ResultSummary[]:PropInputPVMult to fix user input scaling bug (tic #965)
   "Scale Proposed PV & Battery if necessary"      Proj:Action  = {
         if (ValidOr( ResultSummary[3]:UnscaledPropPVRatio, -999 ) <= ValidOr( MaxPropPVRatio, 1 )) then  UNCHANGED
         else if (CompCodeBase == 2016)
         then  EvalRulelist( "CARes_ProposedSummary_E_ScalePV_2016" )
         else if (CompCodeBase >= 2019)
         then  if (LocalStatus( TargetDesignRtg ) > 0 .OR. IfValidAnd( ResultSummary[3]:PropInputPVMult > 0 ))
               then  UNCHANGED
            ;   then  if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0) then  UNCHANGED   - removed NSC adjustment during TEDR processing since final run ultimately will be clipped @ the max PV size
            ;         else  EvalRulelist( "CARes_ProposedSummary_TargetEDR_NetSurpComp" )  endif
               else  EvalRulelist( "CARes_ProposedSummary_E_ScalePV" )  endif
         else  UNCHANGED  endif endif endif  }
   ; SAC 6/13/17 - END OF - port PV scaling logic from 'CARes_ProposedSummary' rulelist

	"Set ResultSummary[3]:Title3[1]"				Proj:ResultSummary[3]:Title3[1]		= {	"End Use"  }

	"Set ResultSummary[3]:Enduse1[1]"			Proj:ResultSummary[3]:Enduse1[1]		= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsE[1]:EnduseName  )  endif  }
	"Set ResultSummary[3]:Enduse2[1]"			Proj:ResultSummary[3]:Enduse2[1]		= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsE[2]:EnduseName  )  endif  }
	"Set ResultSummary[3]:Enduse3[1]"			Proj:ResultSummary[3]:Enduse3[1]		= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsE[3]:EnduseName  )  endif  }
	"Set ResultSummary[3]:Enduse4[1]"			Proj:ResultSummary[3]:Enduse4[1]		= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsE[4]:EnduseName  )  endif  }
	"Set ResultSummary[3]:Enduse5[1]"			Proj:ResultSummary[3]:Enduse5[1]		= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsE[5]:EnduseName  )  endif  }
   "Set ResultSummary[3]:Enduse98[1]"			Proj:ResultSummary[3]:Enduse98[1]	= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0) then  UNDEFINED  else  "Flexibility"  endif  }    ; SAC 2/2/19 (tic #1053)
  ;"Set ResultSummary[3]:Enduse99[1]"			Proj:ResultSummary[3]:Enduse99[1]	= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0) then  UNDEFINED  else  "Grid Harmonization"  endif  }
  ;"Set ResultSummary[3]:Enduse99[1]"			Proj:ResultSummary[3]:Enduse99[1]	= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0) then  UNDEFINED  else  "Self Utilization Credit"  endif  }  ; SAC 3/6/18 - label change from CEC-LF
	"Set ResultSummary[3]:Enduse99[1]"			Proj:ResultSummary[3]:Enduse99[1]	= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0) then  UNDEFINED  else  "Self Util/Flexibility Credit"  endif  }  ; SAC 5/4/20 - label change from CEC-DT
	"Set ResultSummary[3]:Enduse14[1]"			Proj:ResultSummary[3]:Enduse14[1]	= {	if (LocalCompAssigned( RunResultsE[14] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsE[14]:EnduseName )  endif  }
	"Set ResultSummary[3]:Enduse6[1]"			Proj:ResultSummary[3]:Enduse6[1]		= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsE[6]:EnduseName  )  endif  }
	"Set ResultSummary[3]:Enduse7[1]"			Proj:ResultSummary[3]:Enduse7[1]		= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsE[7]:EnduseName  )  endif  }
	"Set ResultSummary[3]:Enduse8[1]"			Proj:ResultSummary[3]:Enduse8[1]		= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsE[8]:EnduseName  )  endif  }
	"Set ResultSummary[3]:Enduse9[1]"			Proj:ResultSummary[3]:Enduse9[1]		= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsE[9]:EnduseName  )  endif  }
	"Set ResultSummary[3]:Enduse10[1]"			Proj:ResultSummary[3]:Enduse10[1]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsE[10]:EnduseName )  endif  }
	"Set ResultSummary[3]:Enduse11[1]"			Proj:ResultSummary[3]:Enduse11[1]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsE[11]:EnduseName )  endif  }
	"Set ResultSummary[3]:Enduse12[1]"			Proj:ResultSummary[3]:Enduse12[1]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsE[12]:EnduseName )  endif  }
 	"Set ResultSummary[3]:Enduse13[1]"			Proj:ResultSummary[3]:Enduse13[1]	= {	if (LocalCompAssigned( RunResultsE[13] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsE[13]:EnduseName )  endif  }

  ; Proposed Site Electric Use
	"Set ResultSummary[3]:Title1[2]"				Proj:ResultSummary[3]:Title1[2]		= {	if (EnergyCodeYearNum < 2022) then  "Proposed"    else if (EnergyCodeYearNum < 2025) then  "Proposed Design:"  else  "Proposed Design"  endif endif  }
	"Set ResultSummary[3]:Title2[2]"				Proj:ResultSummary[3]:Title2[2]		= {	if (EnergyCodeYearNum < 2022) then  "Design"      else if (EnergyCodeYearNum < 2025) then  "Site"              else  "Site Elec."       endif endif  }
	"Set ResultSummary[3]:Title3[2]"				Proj:ResultSummary[3]:Title3[2]		= {	if (EnergyCodeYearNum < 2022) then  "Site (kWh)"  else  "(kWh/yr)"             endif  }
	"Set ResultSummary[3]:Enduse1[2]"			Proj:ResultSummary[3]:Enduse1[2]		= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0 .OR. RunResultsE[1]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsE[1]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse2[2]"			Proj:ResultSummary[3]:Enduse2[2]		= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0 .OR. RunResultsE[2]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsE[2]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse3[2]"			Proj:ResultSummary[3]:Enduse3[2]		= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0 .OR. RunResultsE[3]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsE[3]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse4[2]"			Proj:ResultSummary[3]:Enduse4[2]		= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0 .OR. RunResultsE[4]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsE[4]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse5[2]"			Proj:ResultSummary[3]:Enduse5[2]		= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0 .OR. RunResultsE[5]:PropElecEnergy[1]  < 0.00001) then
																														if (Proj:ModelingDHW < 0.5) then  "- none -"  else  UNDEFINED  endif
																													else  FltToStr(       (int( (RunResultsE[5]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse14[2]"			Proj:ResultSummary[3]:Enduse14[2]	= {	if (LocalCompAssigned( RunResultsE[14] ) == 0 .OR. RunResultsE[14]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsE[14]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse6[2]"			Proj:ResultSummary[3]:Enduse6[2]		= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0 .OR. RunResultsE[6]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsE[6]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse7[2]"			Proj:ResultSummary[3]:Enduse7[2]		= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0 .OR. RunResultsE[7]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsE[7]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse8[2]"			Proj:ResultSummary[3]:Enduse8[2]		= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0 .OR. RunResultsE[8]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsE[8]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse9[2]"			Proj:ResultSummary[3]:Enduse9[2]		= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0 .OR. RunResultsE[9]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsE[9]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse10[2]"			Proj:ResultSummary[3]:Enduse10[2]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsE[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse11[2]"			Proj:ResultSummary[3]:Enduse11[2]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsE[11]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse12[2]"			Proj:ResultSummary[3]:Enduse12[2]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0 .OR. RunResultsE[12]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsE[12]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
   ; SAC 10/6/16 - 2019 PV
	"Set ResultSummary[3]:Enduse13[2]"			Proj:ResultSummary[3]:Enduse13[2]	= {	if (IfValidAnd( RunResultsE[13]:PropElecEnergy[1] < -0.00001 )==0 .OR. EnergyCodeYearNum < 2019) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsE[13]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }

  ; Proposed Site FUEL Use
	"Set ResultSummary[3]:Title1[3]"				Proj:ResultSummary[3]:Title1[3]		= {	if (EnergyCodeYearNum < 2022) then  "Proposed"       else  UNDEFINED   endif  }
	"Set ResultSummary[3]:Title2[3]"				Proj:ResultSummary[3]:Title2[3]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "Site"  else  "Site Gas"  endif endif  }
	"Set ResultSummary[3]:Title3[3]"				Proj:ResultSummary[3]:Title3[3]		= {	if (EnergyCodeYearNum < 2022) then  "Site (therms)"  else  "(therms/yr)"  endif  }
	"Set ResultSummary[3]:Enduse1[3]"			Proj:ResultSummary[3]:Enduse1[3]		= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0 .OR.  (RunResultsE[1]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsE[1]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[1]:PropNatGasEnergy[1]  + RunResultsE[1]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse2[3]"			Proj:ResultSummary[3]:Enduse2[3]		= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0 .OR.  (RunResultsE[2]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsE[2]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[2]:PropNatGasEnergy[1]  + RunResultsE[2]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse3[3]"			Proj:ResultSummary[3]:Enduse3[3]		= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0 .OR.  (RunResultsE[3]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsE[3]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[3]:PropNatGasEnergy[1]  + RunResultsE[3]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse4[3]"			Proj:ResultSummary[3]:Enduse4[3]		= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0 .OR.  (RunResultsE[4]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsE[4]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[4]:PropNatGasEnergy[1]  + RunResultsE[4]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse5[3]"			Proj:ResultSummary[3]:Enduse5[3]		= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0 .OR.  (RunResultsE[5]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsE[5]:PropOtherEnergy[1]  < 0.00001)) then
																														if (Proj:ModelingDHW < 0.5) then  "- none -"  else  UNDEFINED  endif
																													else  FltToStr( ((RunResultsE[5]:PropNatGasEnergy[1]  + RunResultsE[5]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse14[3]"			Proj:ResultSummary[3]:Enduse14[3]	= {	if (LocalCompAssigned( RunResultsE[14] ) == 0 .OR.  (RunResultsE[14]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsE[14]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[14]:PropNatGasEnergy[1] + RunResultsE[14]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse6[3]"			Proj:ResultSummary[3]:Enduse6[3]		= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0 .OR.  (RunResultsE[6]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsE[6]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[6]:PropNatGasEnergy[1]  + RunResultsE[6]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse7[3]"			Proj:ResultSummary[3]:Enduse7[3]		= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0 .OR.  (RunResultsE[7]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsE[7]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[7]:PropNatGasEnergy[1]  + RunResultsE[7]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse8[3]"			Proj:ResultSummary[3]:Enduse8[3]		= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0 .OR.  (RunResultsE[8]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsE[8]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[8]:PropNatGasEnergy[1]  + RunResultsE[8]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse9[3]"			Proj:ResultSummary[3]:Enduse9[3]		= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0 .OR.  (RunResultsE[9]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsE[9]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[9]:PropNatGasEnergy[1]  + RunResultsE[9]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse10[3]"			Proj:ResultSummary[3]:Enduse10[3]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0 .OR.  (RunResultsE[10]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsE[10]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[10]:PropNatGasEnergy[1] + RunResultsE[10]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse11[3]"			Proj:ResultSummary[3]:Enduse11[3]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0 .OR.  (RunResultsE[11]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsE[11]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[11]:PropNatGasEnergy[1] + RunResultsE[11]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse12[3]"			Proj:ResultSummary[3]:Enduse12[3]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0 .OR.  (RunResultsE[12]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsE[12]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[12]:PropNatGasEnergy[1] + RunResultsE[12]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }

  ; Proposed TDV
	"Set ResultSummary[3]:Title1[4]"				Proj:ResultSummary[3]:Title1[4]		= {	if (EnergyCodeYearNum < 2022) then  "Proposed"       else  UNDEFINED        endif  }
	"Set ResultSummary[3]:Title2[4]"				Proj:ResultSummary[3]:Title2[4]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "EDR2"  else  Proj:CompMetricLbl_Short + ""  endif endif  }   ; SAC 01/29/23
	"Set ResultSummary[3]:Title3[4]"				Proj:ResultSummary[3]:Title3[4]		= {	if (EnergyCodeYearNum < 2022) then  "(kTDV/ft-yr)"  else if (EnergyCodeYearNum < 2025) then  "(kTDV/ft-yr)"  else  "($/ft)"  endif endif  }
	"Set ResultSummary[3]:Enduse1[4]"			Proj:ResultSummary[3]:Enduse1[4]		= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[1]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse2[4]"			Proj:ResultSummary[3]:Enduse2[4]		= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[2]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse3[4]"			Proj:ResultSummary[3]:Enduse3[4]		= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[3]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse4[4]"			Proj:ResultSummary[3]:Enduse4[4]		= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[4]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse5[4]"			Proj:ResultSummary[3]:Enduse5[4]		= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[5]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse14[4]"			Proj:ResultSummary[3]:Enduse14[4]	= {	if (LocalCompAssigned( RunResultsE[14] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[14]:ProposedTDV[1] ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse6[4]"			Proj:ResultSummary[3]:Enduse6[4]		= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[6]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse7[4]"			Proj:ResultSummary[3]:Enduse7[4]		= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[7]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse8[4]"			Proj:ResultSummary[3]:Enduse8[4]		= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[8]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse9[4]"			Proj:ResultSummary[3]:Enduse9[4]		= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[9]:ProposedTDV[1]  ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse10[4]"			Proj:ResultSummary[3]:Enduse10[4]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[10]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse11[4]"			Proj:ResultSummary[3]:Enduse11[4]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[11]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse12[4]"			Proj:ResultSummary[3]:Enduse12[4]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[12]:ProposedTDV[1] ), 2 )  endif  }
   ; SAC 10/6/16 - 2019 PV
 	"Set ResultSummary[3]:Enduse13[4]"			Proj:ResultSummary[3]:Enduse13[4]	= {	if (LocalCompAssigned( RunResultsE[13] ) == 0 .OR. EnergyCodeYearNum < 2019) then  UNDEFINED
                                                                                                                                                       else  FltToStr( LocalRef( RunResultsE[13]:ProposedTDV[1] ), 2 )  endif  }

  ; Proposed Electric Demand
	"Set ResultSummary[3]:Title1[10]"			Proj:ResultSummary[3]:Title1[10]		= {	"Proposed"  }
	"Set ResultSummary[3]:Title2[10]"			Proj:ResultSummary[3]:Title2[10]		= {	"Design"  }
	"Set ResultSummary[3]:Title3[10]"			Proj:ResultSummary[3]:Title3[10]		= {	"(kW)"  }
	"Set ResultSummary[3]:Enduse1[10]"			Proj:ResultSummary[3]:Enduse1[10]	= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[1]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse2[10]"			Proj:ResultSummary[3]:Enduse2[10]	= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[2]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse3[10]"			Proj:ResultSummary[3]:Enduse3[10]	= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[3]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse4[10]"			Proj:ResultSummary[3]:Enduse4[10]	= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[4]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse5[10]"			Proj:ResultSummary[3]:Enduse5[10]	= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[5]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse14[10]"			Proj:ResultSummary[3]:Enduse14[10]	= {	if (LocalCompAssigned( RunResultsE[14] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[14]:PropElecDemand[1] ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse6[10]"			Proj:ResultSummary[3]:Enduse6[10]	= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[6]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse7[10]"			Proj:ResultSummary[3]:Enduse7[10]	= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[7]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse8[10]"			Proj:ResultSummary[3]:Enduse8[10]	= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[8]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse9[10]"			Proj:ResultSummary[3]:Enduse9[10]	= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[9]:PropElecDemand[1]  ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse10[10]"			Proj:ResultSummary[3]:Enduse10[10]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[10]:PropElecDemand[1] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse11[10]"			Proj:ResultSummary[3]:Enduse11[10]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[11]:PropElecDemand[1] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse12[10]"			Proj:ResultSummary[3]:Enduse12[10]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[12]:PropElecDemand[1] ), 2 )  endif  }

         ; SAC 12/02/20 - add in PV export results (primarily for 2022 research)
   "Set Proj:ResultSummary[3]:PropPV_Total kWh"       Proj:ResultSummary[3]:PropPV_Total     =
      {  -1 * ValidOr( RunResultsE[13]:PropElecEnergy[1], 0 ) * CondFloorArea / 3.412  }
   "Set Proj:ResultSummary[3]:PropPV_Export kWh"      Proj:ResultSummary[3]:PropPV_Export    =
      {  if (IfValidAnd( ResultSummary[3]:PropPV_Total > 0 )==0) then  0
         else  -1 * ApplyHourlyResultMultipliers_Neg( "none", "none", 1, 1, "none", 0, 0, RunID, "MtrElec", "Tot" ) / 3.412
         endif  }
   "Set Proj:ResultSummary[3]:PropPV_PctExport %"     Proj:ResultSummary[3]:PropPV_PctExport =
      {  if (IfValidAnd( ResultSummary[3]:PropPV_Export > 0 )==0) then  0
         else  ResultSummary[3]:PropPV_Export * 100 / ResultSummary[3]:PropPV_Total  endif  }

  ; SAC 10/7/17 - added rules to calc carbon emissions by enduse   ; prevent calling Carbon rules for User model - SAC 09/20/21
   "Call rulelist to calculate Proposed-E carbon emissions"   Proj:Action    = {
         if (EnergyCodeYearNum < 2019 .OR. RunAbbrev == "u") then  UNCHANGED
         else  EvalRulelist( "CARes_ProposedResults_Carbon_E" )  endif  }
END

;*************************************************************************   - SAC 6/25/13
RULELIST "CARes_ProposedSummary_S" 1 0 1 1
;*************************************************************************
   ; SAC 6/13/17 - port PV scaling logic from 'CARes_ProposedSummary' rulelist
;            "debugging"  Proj:Action = {  PostMessageToLog( "      ScalePropPVResults: %g", ValidOr( ScalePropPVResults, -999 ) )  }
;            "debugging"  Proj:Action = {  PostMessageToLog( "      MaxPropPVRatio:     %g", ValidOr( MaxPropPVRatio, -999 ) )  }
;            "debugging"  Proj:Action = {  PostMessageToLog( "      S: RunResultsS[13]:PropElecEnergy[1]: %g", ValidOr( RunResultsS[13]:PropElecEnergy[1], -999 ) )  }
;            "debugging"  Proj:Action = {  PostMessageToLog( "      S: RunResultsS[10]:PropElecEnergy[1]: %g", ValidOr( RunResultsS[10]:PropElecEnergy[1], -999 ) )  }

   "Set Proj:ResultSummary[4]:UnscaledPropPVRatio"   Proj:ResultSummary[4]:UnscaledPropPVRatio  = {
         if (IfValidAnd( ScalePropPVResults > 0.5 )==0 .OR.
             IfValidAnd( MaxPropPVRatio >= 0 )==0 .OR.
             IfValidAnd( RunResultsS[13]:PropElecEnergy[1] < 0 )==0 .OR.
             LocalStatus( RunResultsS[10]:PropElecEnergy[1] ) < 1) then  UNDEFINED
         else if (CompCodeBase == 2016)
         then  (-1 * RunResultsS[13]:PropElecEnergy[1] / min( 1, ValidOr( PVWDCSizeMultiplier[1], 1 ) )) /
                RunResultsS[10]:PropElecEnergy[1]
         else if (CompCodeBase >= 2019)
         then  (-1 * RunResultsS[13]:PropElecEnergy[1] / min( 1, ValidOr( PVWDCSizeMultiplier[1], 1 ) )) /
               (RunResultsS[10]:PropElecEnergy[1] - RunResultsS[13]:PropElecEnergy[1])
         else  UNDEFINED  endif endif endif  }

;            "debugging"  Proj:Action = {  PostMessageToLog( "      S: UnscaledPropPVRatio: %g", ValidOr( ResultSummary[4]:UnscaledPropPVRatio, -999 ) )  }
;            "debugging"  Proj:Action = {  PostMessageToLog( "      S: ValidOr( UnscaledPropPVRatio, 0 ): %g", ValidOr( ValidOr( ResultSummary[4]:UnscaledPropPVRatio, 0 ), -999 ) )  }
;            "debugging"  Proj:Action = {  PostMessageToLog( "      S: ValidOr( MaxPropPVRatio,      1 ): %g", ValidOr( ValidOr( MaxPropPVRatio, 1 ), -999 ) )  }

;            "Debug log msg"   Proj:Action  = {
;               if (IfValidAnd( ScalePropPVResults > 0.5 )==0 .OR. IfValidAnd( MaxPropPVRatio >= 0 )==0 .OR. IfValidAnd( RunResultsS[13]:PropElecEnergy[1] < 0 )==0) then  UNCHANGED
;               else if (CompCodeBase == 2016)
;               then  if (IfValidAnd( RunResultsS[10]:PropElecEnergy[1] != 0 )==0)
;                     then  PostMessageToLog( "   S: Scale PV check:   currentPVRatio = <infinite>  |  Unscld = %.3f  |  Max = %.2f  |  TargetDRtgIterNum = %.0f of Max %.0f  |  PVWDCSizeMultiplier[1] = %.3f",
;                                                                                                             ResultSummary[4]:UnscaledPropPVRatio, MaxPropPVRatio, TargetDRtgIterNum, TargetDRtgMaxIter, ValidOr( PVWDCSizeMultiplier[1], -1 ), ValidOr( PVWDCSizeMultiplier[2], -1 ) )
;                     else  PostMessageToLog( "   S: Scale PV check:   currentPVRatio = %.3f  |  Unscld = %.3f  |  Max = %.2f  |  TargetDRtgIterNum = %.0f of Max %.0f  |  PVWDCSizeMultiplier[1] = %.3f",
;                                 (-1 * RunResultsS[13]:PropElecEnergy[1]) / RunResultsS[10]:PropElecEnergy[1], ResultSummary[4]:UnscaledPropPVRatio, MaxPropPVRatio, TargetDRtgIterNum, TargetDRtgMaxIter, ValidOr( PVWDCSizeMultiplier[1], -1 ), ValidOr( PVWDCSizeMultiplier[2], -1 ) )
;                     endif
;               else if (CompCodeBase == 2019)
;               then  if (ValidOr( RunResultsS[10]:PropElecEnergy[1], -999 ) == ValidOr( RunResultsS[13]:PropElecEnergy[1], 999 ))
;                     then  PostMessageToLog( "   S: Scale PV check:   currentPVRatio = <infinite>  |  Unscld = %.3f  |  Max = %.2f  |  TargetDRtgIterNum = %.0f of Max %.0f  |  PVWDCSizeMultiplier[1] = %.3f",
;                                                                                                             ResultSummary[4]:UnscaledPropPVRatio, MaxPropPVRatio, TargetDRtgIterNum, TargetDRtgMaxIter, ValidOr( PVWDCSizeMultiplier[1], -1 ), ValidOr( PVWDCSizeMultiplier[2], -1 ) )
;                     else  PostMessageToLog( "   S: Scale PV check:   currentPVRatio = %.3f  |  Unscld = %.3f  |  Max = %.2f  |  TargetDRtgIterNum = %.0f of Max %.0f  |  PVWDCSizeMultiplier[1] = %.3f",
;                                 (-1 * RunResultsS[13]:PropElecEnergy[1]) / (RunResultsS[10]:PropElecEnergy[1] - RunResultsS[13]:PropElecEnergy[1]), ResultSummary[4]:UnscaledPropPVRatio, MaxPropPVRatio, TargetDRtgIterNum, TargetDRtgMaxIter, ValidOr( PVWDCSizeMultiplier[1], -1 ), ValidOr( PVWDCSizeMultiplier[2], -1 ) )
;                     endif
;               else  UNCHANGED  endif endif endif  }

   "Init PropPVScaleFactor"   Proj:ResultSummary[4]:PropPVScaleFactor  = {  UNDEFINED  }
   ; SAC 4/17/17 - added logic to prevent scaling Proposed PV here if Target EDR processing is activated
   ; SAC 4/27/17 - added 2016 logic (PV not added into Total @ this point
   ; SAC 1/18/18 - added reference to ResultSummary[]:PropInputPVMult to fix user input scaling bug (tic #965)
   "Scale Proposed PV & Battery if necessary"      Proj:Action  = {
         if (ValidOr( ResultSummary[4]:UnscaledPropPVRatio, -999 ) <= ValidOr( MaxPropPVRatio, 1 )) then  UNCHANGED
         else if (CompCodeBase == 2016)
         then  EvalRulelist( "CARes_ProposedSummary_S_ScalePV_2016" )
         else if (CompCodeBase >= 2019)
         then  if (LocalStatus( TargetDesignRtg ) > 0 .OR. IfValidAnd( ResultSummary[4]:PropInputPVMult > 0 ))
               then  UNCHANGED
            ;   then  if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0) then  UNCHANGED   - removed NSC adjustment during TEDR processing since final run ultimately will be clipped @ the max PV size
            ;         else  EvalRulelist( "CARes_ProposedSummary_TargetEDR_NetSurpComp" )  endif
               else  EvalRulelist( "CARes_ProposedSummary_S_ScalePV" )  endif
         else  UNCHANGED  endif endif endif  }
   ; SAC 6/13/17 - END OF - port PV scaling logic from 'CARes_ProposedSummary' rulelist

	"Set ResultSummary[4]:Title3[1]"				Proj:ResultSummary[4]:Title3[1]		= {	"End Use"  }

	"Set ResultSummary[4]:Enduse1[1]"			Proj:ResultSummary[4]:Enduse1[1]		= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsS[1]:EnduseName  )  endif  }
	"Set ResultSummary[4]:Enduse2[1]"			Proj:ResultSummary[4]:Enduse2[1]		= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsS[2]:EnduseName  )  endif  }
	"Set ResultSummary[4]:Enduse3[1]"			Proj:ResultSummary[4]:Enduse3[1]		= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsS[3]:EnduseName  )  endif  }
	"Set ResultSummary[4]:Enduse4[1]"			Proj:ResultSummary[4]:Enduse4[1]		= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsS[4]:EnduseName  )  endif  }
	"Set ResultSummary[4]:Enduse5[1]"			Proj:ResultSummary[4]:Enduse5[1]		= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsS[5]:EnduseName  )  endif  }
   "Set ResultSummary[4]:Enduse98[1]"			Proj:ResultSummary[4]:Enduse98[1]	= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0) then  UNDEFINED  else  "Flexibility"  endif  }    ; SAC 2/2/19 (tic #1053)
  ;"Set ResultSummary[4]:Enduse99[1]"			Proj:ResultSummary[4]:Enduse99[1]	= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0) then  UNDEFINED  else  "Grid Harmonization"  endif  }
  ;"Set ResultSummary[4]:Enduse99[1]"			Proj:ResultSummary[4]:Enduse99[1]	= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0) then  UNDEFINED  else  "Self Utilization Credit"  endif  }  ; SAC 3/6/18 - label change from CEC-LF
	"Set ResultSummary[4]:Enduse99[1]"			Proj:ResultSummary[4]:Enduse99[1]	= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0) then  UNDEFINED  else  "Self Util/Flexibility Credit"  endif  }  ; SAC 5/4/20 - label change from CEC-DT
	"Set ResultSummary[4]:Enduse14[1]"			Proj:ResultSummary[4]:Enduse14[1]	= {	if (LocalCompAssigned( RunResultsS[14] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsS[14]:EnduseName )  endif  }
	"Set ResultSummary[4]:Enduse6[1]"			Proj:ResultSummary[4]:Enduse6[1]		= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsS[6]:EnduseName  )  endif  }
	"Set ResultSummary[4]:Enduse7[1]"			Proj:ResultSummary[4]:Enduse7[1]		= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsS[7]:EnduseName  )  endif  }
	"Set ResultSummary[4]:Enduse8[1]"			Proj:ResultSummary[4]:Enduse8[1]		= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsS[8]:EnduseName  )  endif  }
	"Set ResultSummary[4]:Enduse9[1]"			Proj:ResultSummary[4]:Enduse9[1]		= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsS[9]:EnduseName  )  endif  }
	"Set ResultSummary[4]:Enduse10[1]"			Proj:ResultSummary[4]:Enduse10[1]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsS[10]:EnduseName )  endif  }
	"Set ResultSummary[4]:Enduse11[1]"			Proj:ResultSummary[4]:Enduse11[1]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsS[11]:EnduseName )  endif  }
	"Set ResultSummary[4]:Enduse12[1]"			Proj:ResultSummary[4]:Enduse12[1]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsS[12]:EnduseName )  endif  }
 	"Set ResultSummary[4]:Enduse13[1]"			Proj:ResultSummary[4]:Enduse13[1]	= {	if (LocalCompAssigned( RunResultsS[13] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsS[13]:EnduseName )  endif  }

  ; Proposed Site Electric Use
	"Set ResultSummary[4]:Title1[2]"				Proj:ResultSummary[4]:Title1[2]		= {	if (EnergyCodeYearNum < 2022) then  "Proposed"    else if (EnergyCodeYearNum < 2025) then  "Proposed Design:"  else  "Proposed Design"  endif endif  }
	"Set ResultSummary[4]:Title2[2]"				Proj:ResultSummary[4]:Title2[2]		= {	if (EnergyCodeYearNum < 2022) then  "Design"      else if (EnergyCodeYearNum < 2025) then  "Site"              else  "Site Elec."       endif endif  }
	"Set ResultSummary[4]:Title3[2]"				Proj:ResultSummary[4]:Title3[2]		= {	if (EnergyCodeYearNum < 2022) then  "Site (kWh)"  else  "(kWh/yr)"             endif  }
	"Set ResultSummary[4]:Enduse1[2]"			Proj:ResultSummary[4]:Enduse1[2]		= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0 .OR. RunResultsS[1]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[1]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse2[2]"			Proj:ResultSummary[4]:Enduse2[2]		= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0 .OR. RunResultsS[2]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[2]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse3[2]"			Proj:ResultSummary[4]:Enduse3[2]		= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0 .OR. RunResultsS[3]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[3]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse4[2]"			Proj:ResultSummary[4]:Enduse4[2]		= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0 .OR. RunResultsS[4]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[4]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse4[2]"			Proj:ResultSummary[4]:Enduse4[2]		= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0 .OR. RunResultsS[4]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[4]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse5[2]"			Proj:ResultSummary[4]:Enduse5[2]		= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0 .OR. RunResultsS[5]:PropElecEnergy[1]  < 0.00001) then
																														if (Proj:ModelingDHW < 0.5) then  "- none -"  else  UNDEFINED  endif
																													else  FltToStr(       (int( (RunResultsS[5]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse14[2]"			Proj:ResultSummary[4]:Enduse14[2]	= {	if (LocalCompAssigned( RunResultsS[14] ) == 0 .OR. RunResultsS[14]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[14]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse6[2]"			Proj:ResultSummary[4]:Enduse6[2]		= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0 .OR. RunResultsS[6]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[6]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse7[2]"			Proj:ResultSummary[4]:Enduse7[2]		= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0 .OR. RunResultsS[7]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[7]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse8[2]"			Proj:ResultSummary[4]:Enduse8[2]		= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0 .OR. RunResultsS[8]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[8]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse9[2]"			Proj:ResultSummary[4]:Enduse9[2]		= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0 .OR. RunResultsS[9]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[9]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse10[2]"			Proj:ResultSummary[4]:Enduse10[2]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse11[2]"			Proj:ResultSummary[4]:Enduse11[2]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[11]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse12[2]"			Proj:ResultSummary[4]:Enduse12[2]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0 .OR. RunResultsS[12]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[12]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
   ; SAC 10/6/16 - 2019 PV
	"Set ResultSummary[4]:Enduse13[2]"			Proj:ResultSummary[4]:Enduse13[2]	= {	if (IfValidAnd( RunResultsS[13]:PropElecEnergy[1] < -0.00001 )==0 .OR. EnergyCodeYearNum < 2019) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[13]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }

  ; Proposed Site FUEL Use
	"Set ResultSummary[4]:Title1[3]"				Proj:ResultSummary[4]:Title1[3]		= {	if (EnergyCodeYearNum < 2022) then  "Proposed"       else  UNDEFINED   endif  }
	"Set ResultSummary[4]:Title2[3]"				Proj:ResultSummary[4]:Title2[3]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "Site"  else  "Site Gas"  endif endif  }
	"Set ResultSummary[4]:Title3[3]"				Proj:ResultSummary[4]:Title3[3]		= {	if (EnergyCodeYearNum < 2022) then  "Site (therms)"  else  "(therms/yr)"  endif  }
	"Set ResultSummary[4]:Enduse1[3]"			Proj:ResultSummary[4]:Enduse1[3]		= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0 .OR.  (RunResultsS[1]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsS[1]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[1]:PropNatGasEnergy[1]  + RunResultsS[1]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse2[3]"			Proj:ResultSummary[4]:Enduse2[3]		= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0 .OR.  (RunResultsS[2]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsS[2]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[2]:PropNatGasEnergy[1]  + RunResultsS[2]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse3[3]"			Proj:ResultSummary[4]:Enduse3[3]		= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0 .OR.  (RunResultsS[3]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsS[3]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[3]:PropNatGasEnergy[1]  + RunResultsS[3]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse4[3]"			Proj:ResultSummary[4]:Enduse4[3]		= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0 .OR.  (RunResultsS[4]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsS[4]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[4]:PropNatGasEnergy[1]  + RunResultsS[4]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse5[3]"			Proj:ResultSummary[4]:Enduse5[3]		= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0 .OR.  (RunResultsS[5]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsS[5]:PropOtherEnergy[1]  < 0.00001)) then
																														if (Proj:ModelingDHW < 0.5) then  "- none -"  else  UNDEFINED  endif
																													else  FltToStr( ((RunResultsS[5]:PropNatGasEnergy[1]  + RunResultsS[5]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse14[3]"			Proj:ResultSummary[4]:Enduse14[3]	= {	if (LocalCompAssigned( RunResultsS[14] ) == 0 .OR.  (RunResultsS[14]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsS[14]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[14]:PropNatGasEnergy[1] + RunResultsS[14]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse6[3]"			Proj:ResultSummary[4]:Enduse6[3]		= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0 .OR.  (RunResultsS[6]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsS[6]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[6]:PropNatGasEnergy[1]  + RunResultsS[6]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse7[3]"			Proj:ResultSummary[4]:Enduse7[3]		= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0 .OR.  (RunResultsS[7]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsS[7]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[7]:PropNatGasEnergy[1]  + RunResultsS[7]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse8[3]"			Proj:ResultSummary[4]:Enduse8[3]		= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0 .OR.  (RunResultsS[8]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsS[8]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[8]:PropNatGasEnergy[1]  + RunResultsS[8]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse9[3]"			Proj:ResultSummary[4]:Enduse9[3]		= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0 .OR.  (RunResultsS[9]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsS[9]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[9]:PropNatGasEnergy[1]  + RunResultsS[9]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse10[3]"			Proj:ResultSummary[4]:Enduse10[3]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0 .OR.  (RunResultsS[10]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsS[10]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[10]:PropNatGasEnergy[1] + RunResultsS[10]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse11[3]"			Proj:ResultSummary[4]:Enduse11[3]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0 .OR.  (RunResultsS[11]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsS[11]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[11]:PropNatGasEnergy[1] + RunResultsS[11]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse12[3]"			Proj:ResultSummary[4]:Enduse12[3]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0 .OR.  (RunResultsS[12]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsS[12]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[12]:PropNatGasEnergy[1] + RunResultsS[12]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }

  ; Proposed TDV
	"Set ResultSummary[4]:Title1[4]"				Proj:ResultSummary[4]:Title1[4]		= {	if (EnergyCodeYearNum < 2022) then  "Proposed"       else  UNDEFINED        endif  }
	"Set ResultSummary[4]:Title2[4]"				Proj:ResultSummary[4]:Title2[4]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "EDR2"  else  Proj:CompMetricLbl_Short + ""  endif endif  }   ; SAC 01/29/23
	"Set ResultSummary[4]:Title3[4]"				Proj:ResultSummary[4]:Title3[4]		= {	if (EnergyCodeYearNum < 2022) then  "(kTDV/ft-yr)"  else if (EnergyCodeYearNum < 2025) then  "(kTDV/ft-yr)"  else  "($/ft)"  endif endif  }
	"Set ResultSummary[4]:Enduse1[4]"			Proj:ResultSummary[4]:Enduse1[4]		= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[1]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse2[4]"			Proj:ResultSummary[4]:Enduse2[4]		= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[2]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse3[4]"			Proj:ResultSummary[4]:Enduse3[4]		= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[3]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse4[4]"			Proj:ResultSummary[4]:Enduse4[4]		= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[4]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse5[4]"			Proj:ResultSummary[4]:Enduse5[4]		= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[5]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse14[4]"			Proj:ResultSummary[4]:Enduse14[4]	= {	if (LocalCompAssigned( RunResultsS[14] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[14]:ProposedTDV[1] ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse6[4]"			Proj:ResultSummary[4]:Enduse6[4]		= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[6]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse7[4]"			Proj:ResultSummary[4]:Enduse7[4]		= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[7]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse8[4]"			Proj:ResultSummary[4]:Enduse8[4]		= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[8]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse9[4]"			Proj:ResultSummary[4]:Enduse9[4]		= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[9]:ProposedTDV[1]  ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse10[4]"			Proj:ResultSummary[4]:Enduse10[4]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[10]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse11[4]"			Proj:ResultSummary[4]:Enduse11[4]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[11]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse12[4]"			Proj:ResultSummary[4]:Enduse12[4]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[12]:ProposedTDV[1] ), 2 )  endif  }
   ; SAC 10/6/16 - 2019 PV
 	"Set ResultSummary[4]:Enduse13[4]"			Proj:ResultSummary[4]:Enduse13[4]	= {	if (LocalCompAssigned( RunResultsS[13] ) == 0 .OR. EnergyCodeYearNum < 2019) then  UNDEFINED
                                                                                                                                                       else  FltToStr( LocalRef( RunResultsS[13]:ProposedTDV[1] ), 2 )  endif  }

  ; Proposed Electric Demand
	"Set ResultSummary[4]:Title1[10]"			Proj:ResultSummary[4]:Title1[10]		= {	"Proposed"  }
	"Set ResultSummary[4]:Title2[10]"			Proj:ResultSummary[4]:Title2[10]		= {	"Design"  }
	"Set ResultSummary[4]:Title3[10]"			Proj:ResultSummary[4]:Title3[10]		= {	"(kW)"  }
	"Set ResultSummary[4]:Enduse1[10]"			Proj:ResultSummary[4]:Enduse1[10]	= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[1]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse2[10]"			Proj:ResultSummary[4]:Enduse2[10]	= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[2]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse3[10]"			Proj:ResultSummary[4]:Enduse3[10]	= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[3]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse4[10]"			Proj:ResultSummary[4]:Enduse4[10]	= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[4]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse5[10]"			Proj:ResultSummary[4]:Enduse5[10]	= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[5]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse14[10]"			Proj:ResultSummary[4]:Enduse14[10]	= {	if (LocalCompAssigned( RunResultsS[14] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[14]:PropElecDemand[1] ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse6[10]"			Proj:ResultSummary[4]:Enduse6[10]	= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[6]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse7[10]"			Proj:ResultSummary[4]:Enduse7[10]	= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[7]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse8[10]"			Proj:ResultSummary[4]:Enduse8[10]	= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[8]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse9[10]"			Proj:ResultSummary[4]:Enduse9[10]	= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[9]:PropElecDemand[1]  ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse10[10]"			Proj:ResultSummary[4]:Enduse10[10]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[10]:PropElecDemand[1] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse11[10]"			Proj:ResultSummary[4]:Enduse11[10]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[11]:PropElecDemand[1] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse12[10]"			Proj:ResultSummary[4]:Enduse12[10]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[12]:PropElecDemand[1] ), 2 )  endif  }

         ; SAC 12/02/20 - add in PV export results (primarily for 2022 research)
   "Set Proj:ResultSummary[4]:PropPV_Total kWh"       Proj:ResultSummary[4]:PropPV_Total     =
      {  -1 * ValidOr( RunResultsS[13]:PropElecEnergy[1], 0 ) * CondFloorArea / 3.412  }
   "Set Proj:ResultSummary[4]:PropPV_Export kWh"      Proj:ResultSummary[4]:PropPV_Export    =
      {  if (IfValidAnd( ResultSummary[4]:PropPV_Total > 0 )==0) then  0
         else  -1 * ApplyHourlyResultMultipliers_Neg( "none", "none", 1, 1, "none", 0, 0, RunID, "MtrElec", "Tot" ) / 3.412
         endif  }
   "Set Proj:ResultSummary[4]:PropPV_PctExport %"     Proj:ResultSummary[4]:PropPV_PctExport =
      {  if (IfValidAnd( ResultSummary[4]:PropPV_Export > 0 )==0) then  0
         else  ResultSummary[4]:PropPV_Export * 100 / ResultSummary[3]:PropPV_Total  endif  }

  ; SAC 10/7/17 - added rules to calc carbon emissions by enduse   ; prevent calling Carbon rules for User model - SAC 09/20/21
   "Call rulelist to calculate Proposed-S carbon emissions"   Proj:Action    = {
         if (EnergyCodeYearNum < 2019 .OR. RunAbbrev == "u") then  UNCHANGED
         else  EvalRulelist( "CARes_ProposedResults_Carbon_S" )  endif  }
END

;*************************************************************************   - SAC 6/25/13
RULELIST "CARes_ProposedSummary_W" 1 0 1 1
;*************************************************************************
   ; SAC 6/13/17 - port PV scaling logic from 'CARes_ProposedSummary' rulelist
;            "debugging"  Proj:Action = {  PostMessageToLog( "      ScalePropPVResults: %g", ValidOr( ScalePropPVResults, -999 ) )  }
;            "debugging"  Proj:Action = {  PostMessageToLog( "      MaxPropPVRatio:     %g", ValidOr( MaxPropPVRatio, -999 ) )  }
;            "debugging"  Proj:Action = {  PostMessageToLog( "      W: RunResultsW[13]:PropElecEnergy[1]: %g", ValidOr( RunResultsW[13]:PropElecEnergy[1], -999 ) )  }
;            "debugging"  Proj:Action = {  PostMessageToLog( "      W: RunResultsW[10]:PropElecEnergy[1]: %g", ValidOr( RunResultsW[10]:PropElecEnergy[1], -999 ) )  }

   "Set Proj:ResultSummary[5]:UnscaledPropPVRatio"   Proj:ResultSummary[5]:UnscaledPropPVRatio  = {
         if (IfValidAnd( ScalePropPVResults > 0.5 )==0 .OR.
             IfValidAnd( MaxPropPVRatio >= 0 )==0 .OR.
             IfValidAnd( RunResultsW[13]:PropElecEnergy[1] < 0 )==0 .OR.
             LocalStatus( RunResultsW[10]:PropElecEnergy[1] ) < 1) then  UNDEFINED
         else if (CompCodeBase == 2016)
         then  (-1 * RunResultsW[13]:PropElecEnergy[1] / min( 1, ValidOr( PVWDCSizeMultiplier[1], 1 ) )) /
                RunResultsW[10]:PropElecEnergy[1]
         else if (CompCodeBase >= 2019)
         then  (-1 * RunResultsW[13]:PropElecEnergy[1] / min( 1, ValidOr( PVWDCSizeMultiplier[1], 1 ) )) /
               (RunResultsW[10]:PropElecEnergy[1] - RunResultsW[13]:PropElecEnergy[1])
         else  UNDEFINED  endif endif endif  }

;            "debugging"  Proj:Action = {  PostMessageToLog( "      W: UnscaledPropPVRatio: %g", ValidOr( ResultSummary[5]:UnscaledPropPVRatio, -999 ) )  }
;            "debugging"  Proj:Action = {  PostMessageToLog( "      W: ValidOr( UnscaledPropPVRatio, 0 ): %g", ValidOr( ValidOr( ResultSummary[5]:UnscaledPropPVRatio, 0 ), -999 ) )  }
;            "debugging"  Proj:Action = {  PostMessageToLog( "      W: ValidOr( MaxPropPVRatio,      1 ): %g", ValidOr( ValidOr( MaxPropPVRatio, 1 ), -999 ) )  }

;            "Debug log msg"   Proj:Action  = {
;               if (IfValidAnd( ScalePropPVResults > 0.5 )==0 .OR. IfValidAnd( MaxPropPVRatio >= 0 )==0 .OR. IfValidAnd( RunResultsW[13]:PropElecEnergy[1] < 0 )==0) then  UNCHANGED
;               else if (CompCodeBase == 2016)
;               then  if (IfValidAnd( RunResultsW[10]:PropElecEnergy[1] != 0 )==0)
;                     then  PostMessageToLog( "   W: Scale PV check:   currentPVRatio = <infinite>  |  Unscld = %.3f  |  Max = %.2f  |  TargetDRtgIterNum = %.0f of Max %.0f  |  PVWDCSizeMultiplier[1] = %.3f",
;                                                                                                             ResultSummary[5]:UnscaledPropPVRatio, MaxPropPVRatio, TargetDRtgIterNum, TargetDRtgMaxIter, ValidOr( PVWDCSizeMultiplier[1], -1 ), ValidOr( PVWDCSizeMultiplier[2], -1 ) )
;                     else  PostMessageToLog( "   W: Scale PV check:   currentPVRatio = %.3f  |  Unscld = %.3f  |  Max = %.2f  |  TargetDRtgIterNum = %.0f of Max %.0f  |  PVWDCSizeMultiplier[1] = %.3f",
;                                 (-1 * RunResultsW[13]:PropElecEnergy[1]) / RunResultsW[10]:PropElecEnergy[1], ResultSummary[5]:UnscaledPropPVRatio, MaxPropPVRatio, TargetDRtgIterNum, TargetDRtgMaxIter, ValidOr( PVWDCSizeMultiplier[1], -1 ), ValidOr( PVWDCSizeMultiplier[2], -1 ) )
;                     endif
;               else if (CompCodeBase == 2019)
;               then  if (ValidOr( RunResultsW[10]:PropElecEnergy[1], -999 ) == ValidOr( RunResultsW[13]:PropElecEnergy[1], 999 ))
;                     then  PostMessageToLog( "   W: Scale PV check:   currentPVRatio = <infinite>  |  Unscld = %.3f  |  Max = %.2f  |  TargetDRtgIterNum = %.0f of Max %.0f  |  PVWDCSizeMultiplier[1] = %.3f",
;                                                                                                             ResultSummary[5]:UnscaledPropPVRatio, MaxPropPVRatio, TargetDRtgIterNum, TargetDRtgMaxIter, ValidOr( PVWDCSizeMultiplier[1], -1 ), ValidOr( PVWDCSizeMultiplier[2], -1 ) )
;                     else  PostMessageToLog( "   W: Scale PV check:   currentPVRatio = %.3f  |  Unscld = %.3f  |  Max = %.2f  |  TargetDRtgIterNum = %.0f of Max %.0f  |  PVWDCSizeMultiplier[1] = %.3f",
;                                 (-1 * RunResultsW[13]:PropElecEnergy[1]) / (RunResultsW[10]:PropElecEnergy[1] - RunResultsW[13]:PropElecEnergy[1]), ResultSummary[5]:UnscaledPropPVRatio, MaxPropPVRatio, TargetDRtgIterNum, TargetDRtgMaxIter, ValidOr( PVWDCSizeMultiplier[1], -1 ), ValidOr( PVWDCSizeMultiplier[2], -1 ) )
;                     endif
;               else  UNCHANGED  endif endif endif  }

   "Init PropPVScaleFactor"   Proj:ResultSummary[5]:PropPVScaleFactor  = {  UNDEFINED  }
   ; SAC 4/17/17 - added logic to prevent scaling Proposed PV here if Target EDR processing is activated
   ; SAC 4/27/17 - added 2016 logic (PV not added into Total @ this point
   ; SAC 1/18/18 - added reference to ResultSummary[]:PropInputPVMult to fix user input scaling bug (tic #965)
   "Scale Proposed PV & Battery if necessary"      Proj:Action  = {
         if (ValidOr( ResultSummary[5]:UnscaledPropPVRatio, -999 ) <= ValidOr( MaxPropPVRatio, 1 )) then  UNCHANGED
         else if (CompCodeBase == 2016)
         then  EvalRulelist( "CARes_ProposedSummary_W_ScalePV_2016" )
         else if (CompCodeBase >= 2019)
         then  if (LocalStatus( TargetDesignRtg ) > 0 .OR. IfValidAnd( ResultSummary[5]:PropInputPVMult > 0 ))
               then  UNCHANGED
            ;   then  if (IfValidAnd( NetEnergyMeteringNSCAdj > 0 )==0) then  UNCHANGED   - removed NSC adjustment during TEDR processing since final run ultimately will be clipped @ the max PV size
            ;         else  EvalRulelist( "CARes_ProposedSummary_TargetEDR_NetSurpComp" )  endif
               else  EvalRulelist( "CARes_ProposedSummary_W_ScalePV" )  endif
         else  UNCHANGED  endif endif endif  }
   ; SAC 6/13/17 - END OF - port PV scaling logic from 'CARes_ProposedSummary' rulelist

	"Set ResultSummary[5]:Title3[1]"				Proj:ResultSummary[5]:Title3[1]		= {	"End Use"  }

	"Set ResultSummary[5]:Enduse1[1]"			Proj:ResultSummary[5]:Enduse1[1]		= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsW[1]:EnduseName  )  endif  }
	"Set ResultSummary[5]:Enduse2[1]"			Proj:ResultSummary[5]:Enduse2[1]		= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsW[2]:EnduseName  )  endif  }
	"Set ResultSummary[5]:Enduse3[1]"			Proj:ResultSummary[5]:Enduse3[1]		= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsW[3]:EnduseName  )  endif  }
	"Set ResultSummary[5]:Enduse4[1]"			Proj:ResultSummary[5]:Enduse4[1]		= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsW[4]:EnduseName  )  endif  }
	"Set ResultSummary[5]:Enduse5[1]"			Proj:ResultSummary[5]:Enduse5[1]		= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsW[5]:EnduseName  )  endif  }
   "Set ResultSummary[5]:Enduse98[1]"			Proj:ResultSummary[5]:Enduse98[1]	= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0) then  UNDEFINED  else  "Flexibility"  endif  }    ; SAC 2/2/19 (tic #1053)
  ;"Set ResultSummary[5]:Enduse99[1]"			Proj:ResultSummary[5]:Enduse99[1]	= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0) then  UNDEFINED  else  "Grid Harmonization"  endif  }
  ;"Set ResultSummary[5]:Enduse99[1]"			Proj:ResultSummary[5]:Enduse99[1]	= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0) then  UNDEFINED  else  "Self Utilization Credit"  endif  }  ; SAC 3/6/18 - label change from CEC-LF
	"Set ResultSummary[5]:Enduse99[1]"			Proj:ResultSummary[5]:Enduse99[1]	= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0) then  UNDEFINED  else  "Self Util/Flexibility Credit"  endif  }  ; SAC 5/4/20 - label change from CEC-DT
	"Set ResultSummary[5]:Enduse14[1]"			Proj:ResultSummary[5]:Enduse14[1]	= {	if (LocalCompAssigned( RunResultsW[14] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsW[14]:EnduseName )  endif  }
	"Set ResultSummary[5]:Enduse6[1]"			Proj:ResultSummary[5]:Enduse6[1]		= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsW[6]:EnduseName  )  endif  }
	"Set ResultSummary[5]:Enduse7[1]"			Proj:ResultSummary[5]:Enduse7[1]		= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsW[7]:EnduseName  )  endif  }
	"Set ResultSummary[5]:Enduse8[1]"			Proj:ResultSummary[5]:Enduse8[1]		= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsW[8]:EnduseName  )  endif  }
	"Set ResultSummary[5]:Enduse9[1]"			Proj:ResultSummary[5]:Enduse9[1]		= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsW[9]:EnduseName  )  endif  }
	"Set ResultSummary[5]:Enduse10[1]"			Proj:ResultSummary[5]:Enduse10[1]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsW[10]:EnduseName )  endif  }
	"Set ResultSummary[5]:Enduse11[1]"			Proj:ResultSummary[5]:Enduse11[1]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsW[11]:EnduseName )  endif  }
	"Set ResultSummary[5]:Enduse12[1]"			Proj:ResultSummary[5]:Enduse12[1]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsW[12]:EnduseName )  endif  }
 	"Set ResultSummary[5]:Enduse13[1]"			Proj:ResultSummary[5]:Enduse13[1]	= {	if (LocalCompAssigned( RunResultsW[13] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsW[13]:EnduseName )  endif  }

  ; Proposed Site Electric Use
	"Set ResultSummary[5]:Title1[2]"				Proj:ResultSummary[5]:Title1[2]		= {	if (EnergyCodeYearNum < 2022) then  "Proposed"    else if (EnergyCodeYearNum < 2025) then  "Proposed Design:"  else  "Proposed Design"  endif endif  }
	"Set ResultSummary[5]:Title2[2]"				Proj:ResultSummary[5]:Title2[2]		= {	if (EnergyCodeYearNum < 2022) then  "Design"      else if (EnergyCodeYearNum < 2025) then  "Site"              else  "Site Elec."       endif endif  }
	"Set ResultSummary[5]:Title3[2]"				Proj:ResultSummary[5]:Title3[2]		= {	if (EnergyCodeYearNum < 2022) then  "Site (kWh)"  else  "(kWh/yr)"             endif  }
	"Set ResultSummary[5]:Enduse1[2]"			Proj:ResultSummary[5]:Enduse1[2]		= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0 .OR. RunResultsW[1]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsW[1]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse2[2]"			Proj:ResultSummary[5]:Enduse2[2]		= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0 .OR. RunResultsW[2]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsW[2]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse3[2]"			Proj:ResultSummary[5]:Enduse3[2]		= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0 .OR. RunResultsW[3]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsW[3]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse4[2]"			Proj:ResultSummary[5]:Enduse4[2]		= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0 .OR. RunResultsW[4]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsW[4]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse5[2]"			Proj:ResultSummary[5]:Enduse5[2]		= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0 .OR. RunResultsW[5]:PropElecEnergy[1]  < 0.00001) then
																														if (Proj:ModelingDHW < 0.5) then  "- none -"  else  UNDEFINED  endif
																													else  FltToStr(       (int( (RunResultsW[5]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse14[2]"			Proj:ResultSummary[5]:Enduse14[2]	= {	if (LocalCompAssigned( RunResultsW[14] ) == 0 .OR. RunResultsW[14]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsW[14]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse6[2]"			Proj:ResultSummary[5]:Enduse6[2]		= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0 .OR. RunResultsW[6]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsW[6]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse7[2]"			Proj:ResultSummary[5]:Enduse7[2]		= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0 .OR. RunResultsW[7]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsW[7]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse8[2]"			Proj:ResultSummary[5]:Enduse8[2]		= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0 .OR. RunResultsW[8]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsW[8]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse9[2]"			Proj:ResultSummary[5]:Enduse9[2]		= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0 .OR. RunResultsW[9]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsW[9]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse10[2]"			Proj:ResultSummary[5]:Enduse10[2]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsW[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse11[2]"			Proj:ResultSummary[5]:Enduse11[2]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsW[11]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse12[2]"			Proj:ResultSummary[5]:Enduse12[2]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0 .OR. RunResultsW[12]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsW[12]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
   ; SAC 10/6/16 - 2019 PV
	"Set ResultSummary[5]:Enduse13[2]"			Proj:ResultSummary[5]:Enduse13[2]	= {	if (IfValidAnd( RunResultsW[13]:PropElecEnergy[1] < -0.00001 )==0 .OR. EnergyCodeYearNum < 2019) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsW[13]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }

  ; Proposed Site FUEL Use
	"Set ResultSummary[5]:Title1[3]"				Proj:ResultSummary[5]:Title1[3]		= {	if (EnergyCodeYearNum < 2022) then  "Proposed"       else  UNDEFINED   endif  }
	"Set ResultSummary[5]:Title2[3]"				Proj:ResultSummary[5]:Title2[3]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "Site"  else  "Site Gas"  endif endif  }
	"Set ResultSummary[5]:Title3[3]"				Proj:ResultSummary[5]:Title3[3]		= {	if (EnergyCodeYearNum < 2022) then  "Site (therms)"  else  "(therms/yr)"  endif  }
	"Set ResultSummary[5]:Enduse1[3]"			Proj:ResultSummary[5]:Enduse1[3]		= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0 .OR.  (RunResultsW[1]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsW[1]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[1]:PropNatGasEnergy[1]  + RunResultsW[1]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse2[3]"			Proj:ResultSummary[5]:Enduse2[3]		= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0 .OR.  (RunResultsW[2]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsW[2]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[2]:PropNatGasEnergy[1]  + RunResultsW[2]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse3[3]"			Proj:ResultSummary[5]:Enduse3[3]		= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0 .OR.  (RunResultsW[3]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsW[3]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[3]:PropNatGasEnergy[1]  + RunResultsW[3]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse4[3]"			Proj:ResultSummary[5]:Enduse4[3]		= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0 .OR.  (RunResultsW[4]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsW[4]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[4]:PropNatGasEnergy[1]  + RunResultsW[4]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse5[3]"			Proj:ResultSummary[5]:Enduse5[3]		= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0 .OR.  (RunResultsW[5]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsW[5]:PropOtherEnergy[1]  < 0.00001)) then
																														if (Proj:ModelingDHW < 0.5) then  "- none -"  else  UNDEFINED  endif
																													else  FltToStr( ((RunResultsW[5]:PropNatGasEnergy[1]  + RunResultsW[5]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse14[3]"			Proj:ResultSummary[5]:Enduse14[3]	= {	if (LocalCompAssigned( RunResultsW[14] ) == 0 .OR.  (RunResultsW[14]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsW[14]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[14]:PropNatGasEnergy[1] + RunResultsW[14]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse6[3]"			Proj:ResultSummary[5]:Enduse6[3]		= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0 .OR.  (RunResultsW[6]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsW[6]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[6]:PropNatGasEnergy[1]  + RunResultsW[6]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse7[3]"			Proj:ResultSummary[5]:Enduse7[3]		= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0 .OR.  (RunResultsW[7]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsW[7]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[7]:PropNatGasEnergy[1]  + RunResultsW[7]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse8[3]"			Proj:ResultSummary[5]:Enduse8[3]		= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0 .OR.  (RunResultsW[8]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsW[8]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[8]:PropNatGasEnergy[1]  + RunResultsW[8]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse9[3]"			Proj:ResultSummary[5]:Enduse9[3]		= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0 .OR.  (RunResultsW[9]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsW[9]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[9]:PropNatGasEnergy[1]  + RunResultsW[9]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse10[3]"			Proj:ResultSummary[5]:Enduse10[3]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0 .OR.  (RunResultsW[10]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsW[10]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[10]:PropNatGasEnergy[1] + RunResultsW[10]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse11[3]"			Proj:ResultSummary[5]:Enduse11[3]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0 .OR.  (RunResultsW[11]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsW[11]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[11]:PropNatGasEnergy[1] + RunResultsW[11]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse12[3]"			Proj:ResultSummary[5]:Enduse12[3]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0 .OR.  (RunResultsW[12]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsW[12]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[12]:PropNatGasEnergy[1] + RunResultsW[12]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }

  ; Proposed TDV
	"Set ResultSummary[5]:Title1[4]"				Proj:ResultSummary[5]:Title1[4]		= {	if (EnergyCodeYearNum < 2022) then  "Proposed"       else  UNDEFINED        endif  }
	"Set ResultSummary[5]:Title2[4]"				Proj:ResultSummary[5]:Title2[4]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "EDR2"  else  Proj:CompMetricLbl_Short + ""  endif endif  }   ; SAC 01/29/23
	"Set ResultSummary[5]:Title3[4]"				Proj:ResultSummary[5]:Title3[4]		= {	if (EnergyCodeYearNum < 2022) then  "(kTDV/ft-yr)"  else if (EnergyCodeYearNum < 2025) then  "(kTDV/ft-yr)"  else  "($/ft)"  endif endif  }
	"Set ResultSummary[5]:Enduse1[4]"			Proj:ResultSummary[5]:Enduse1[4]		= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[1]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse2[4]"			Proj:ResultSummary[5]:Enduse2[4]		= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[2]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse3[4]"			Proj:ResultSummary[5]:Enduse3[4]		= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[3]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse4[4]"			Proj:ResultSummary[5]:Enduse4[4]		= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[4]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse5[4]"			Proj:ResultSummary[5]:Enduse5[4]		= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[5]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse14[4]"			Proj:ResultSummary[5]:Enduse14[4]	= {	if (LocalCompAssigned( RunResultsW[14] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[14]:ProposedTDV[1] ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse6[4]"			Proj:ResultSummary[5]:Enduse6[4]		= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[6]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse7[4]"			Proj:ResultSummary[5]:Enduse7[4]		= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[7]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse8[4]"			Proj:ResultSummary[5]:Enduse8[4]		= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[8]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse9[4]"			Proj:ResultSummary[5]:Enduse9[4]		= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[9]:ProposedTDV[1]  ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse10[4]"			Proj:ResultSummary[5]:Enduse10[4]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[10]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse11[4]"			Proj:ResultSummary[5]:Enduse11[4]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[11]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse12[4]"			Proj:ResultSummary[5]:Enduse12[4]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[12]:ProposedTDV[1] ), 2 )  endif  }
   ; SAC 10/6/16 - 2019 PV
 	"Set ResultSummary[5]:Enduse13[4]"			Proj:ResultSummary[5]:Enduse13[4]	= {	if (LocalCompAssigned( RunResultsW[13] ) == 0 .OR. EnergyCodeYearNum < 2019) then  UNDEFINED
                                                                                                                                                       else  FltToStr( LocalRef( RunResultsW[13]:ProposedTDV[1] ), 2 )  endif  }

  ; Proposed Electric Demand
	"Set ResultSummary[5]:Title1[10]"			Proj:ResultSummary[5]:Title1[10]		= {	"Proposed"  }
	"Set ResultSummary[5]:Title2[10]"			Proj:ResultSummary[5]:Title2[10]		= {	"Design"  }
	"Set ResultSummary[5]:Title3[10]"			Proj:ResultSummary[5]:Title3[10]		= {	"(kW)"  }
	"Set ResultSummary[5]:Enduse1[10]"			Proj:ResultSummary[5]:Enduse1[10]	= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[1]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse2[10]"			Proj:ResultSummary[5]:Enduse2[10]	= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[2]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse3[10]"			Proj:ResultSummary[5]:Enduse3[10]	= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[3]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse4[10]"			Proj:ResultSummary[5]:Enduse4[10]	= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[4]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse5[10]"			Proj:ResultSummary[5]:Enduse5[10]	= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[5]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse14[10]"			Proj:ResultSummary[5]:Enduse14[10]	= {	if (LocalCompAssigned( RunResultsW[14] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[14]:PropElecDemand[1] ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse6[10]"			Proj:ResultSummary[5]:Enduse6[10]	= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[6]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse7[10]"			Proj:ResultSummary[5]:Enduse7[10]	= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[7]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse8[10]"			Proj:ResultSummary[5]:Enduse8[10]	= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[8]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse9[10]"			Proj:ResultSummary[5]:Enduse9[10]	= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[9]:PropElecDemand[1]  ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse10[10]"			Proj:ResultSummary[5]:Enduse10[10]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[10]:PropElecDemand[1] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse11[10]"			Proj:ResultSummary[5]:Enduse11[10]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[11]:PropElecDemand[1] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse12[10]"			Proj:ResultSummary[5]:Enduse12[10]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[12]:PropElecDemand[1] ), 2 )  endif  }

         ; SAC 12/02/20 - add in PV export results (primarily for 2022 research)
   "Set Proj:ResultSummary[5]:PropPV_Total kWh"       Proj:ResultSummary[5]:PropPV_Total     =
      {  -1 * ValidOr( RunResultsW[13]:PropElecEnergy[1], 0 ) * CondFloorArea / 3.412  }
   "Set Proj:ResultSummary[5]:PropPV_Export kWh"      Proj:ResultSummary[5]:PropPV_Export    =
      {  if (IfValidAnd( ResultSummary[5]:PropPV_Total > 0 )==0) then  0
         else  -1 * ApplyHourlyResultMultipliers_Neg( "none", "none", 1, 1, "none", 0, 0, RunID, "MtrElec", "Tot" ) / 3.412
         endif  }
   "Set Proj:ResultSummary[5]:PropPV_PctExport %"     Proj:ResultSummary[5]:PropPV_PctExport =
      {  if (IfValidAnd( ResultSummary[5]:PropPV_Export > 0 )==0) then  0
         else  ResultSummary[5]:PropPV_Export * 100 / ResultSummary[5]:PropPV_Total  endif  }

  ; SAC 10/7/17 - added rules to calc carbon emissions by enduse   ; prevent calling Carbon rules for User model - SAC 09/20/21
   "Call rulelist to calculate Proposed-W carbon emissions"   Proj:Action    = {
         if (EnergyCodeYearNum < 2019 .OR. RunAbbrev == "u") then  UNCHANGED
         else  EvalRulelist( "CARes_ProposedResults_Carbon_W" )  endif  }
END


;*************************************************************************
RULELIST "CARes_StandardSummary_NESW" 1 0 1 1
;*************************************************************************

	; Worst case run RunResults[*] all set now, so start by setting up PROPOSED summary data for the worst case run
	"Call subordinate rulelist to set worst case Proposed summary"		Proj:Action = {	EvalRulelist( "CARes_ProposedSummary_Main" )  }
	; can call generic StandardSummary rulelist to set worst case Standard summary data
	"Call subordinate rulelist to set worst case Standard summary"		Proj:Action = {	EvalRulelist( "CARes_StandardSummary" )  }

; -- NORTH Facing --
  ; Standard Site Electric Use
	"Set ResultSummary[2]:Title1[5]"				Proj:ResultSummary[2]:Title1[5]		= {	if (EnergyCodeYearNum < 2022) then  "Standard"    else if (EnergyCodeYearNum < 2025) then  "Standard Design:"  else  "Standard Design"  endif endif  }
	"Set ResultSummary[2]:Title2[5]"				Proj:ResultSummary[2]:Title2[5]		= {	if (EnergyCodeYearNum < 2022) then  "Design"      else if (EnergyCodeYearNum < 2025) then  "Site"              else  "Site Elec."       endif endif  }
	"Set ResultSummary[2]:Title3[5]"				Proj:ResultSummary[2]:Title3[5]		= {	if (EnergyCodeYearNum < 2022) then  "Site (kWh)"  else  "(kWh/yr)"             endif  }
	"Set ResultSummary[2]:Enduse1[5]"			Proj:ResultSummary[2]:Enduse1[5]		= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0 .OR. RunResultsN[1]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[1]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse2[5]"			Proj:ResultSummary[2]:Enduse2[5]		= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0 .OR. RunResultsN[2]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[2]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse3[5]"			Proj:ResultSummary[2]:Enduse3[5]		= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0 .OR. RunResultsN[3]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[3]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse4[5]"			Proj:ResultSummary[2]:Enduse4[5]		= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0 .OR. RunResultsN[4]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[4]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse5[5]"			Proj:ResultSummary[2]:Enduse5[5]		= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0 .OR. RunResultsN[5]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[5]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse14[5]"			Proj:ResultSummary[2]:Enduse14[5]	= {	if (LocalCompAssigned( RunResultsN[14] ) == 0 .OR. RunResultsN[14]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[14]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse6[5]"			Proj:ResultSummary[2]:Enduse6[5]		= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0 .OR. RunResultsN[6]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[6]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse7[5]"			Proj:ResultSummary[2]:Enduse7[5]		= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0 .OR. RunResultsN[7]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[7]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse8[5]"			Proj:ResultSummary[2]:Enduse8[5]		= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0 .OR. RunResultsN[8]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[8]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse9[5]"			Proj:ResultSummary[2]:Enduse9[5]		= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0 .OR. RunResultsN[9]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[9]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse10[5]"			Proj:ResultSummary[2]:Enduse10[5]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[10]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse11[5]"			Proj:ResultSummary[2]:Enduse11[5]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0 .OR. RunResultsN[11]:StdElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[11]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse12[5]"			Proj:ResultSummary[2]:Enduse12[5]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0 .OR. RunResultsN[12]:StdElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[12]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse13[5]"			Proj:ResultSummary[2]:Enduse13[5]	= {	if (LocalCompAssigned( RunResultsN[13] ) == 0 .OR. RunResultsN[13]:StdElecEnergy > -0.00001) then  UNDEFINED  ; SAC 1/11/18
																													else  FltToStr( (int( (RunResultsN[13]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
	"Set ResultSummary[2]:Enduse10[2]"			Proj:ResultSummary[2]:Enduse10[2]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsN[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse11[2]"			Proj:ResultSummary[2]:Enduse11[2]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsN[11]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse12[2]"			Proj:ResultSummary[2]:Enduse12[2]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0 .OR. RunResultsN[12]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsN[12]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }

  ; Standard Site Natural Gas Use
	"Set ResultSummary[2]:Title1[6]"				Proj:ResultSummary[2]:Title1[6]		= {	if (EnergyCodeYearNum < 2022) then  "Standard"       else  UNDEFINED   endif  }
	"Set ResultSummary[2]:Title2[6]"				Proj:ResultSummary[2]:Title2[6]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "Site"  else  "Site Gas"  endif endif  }
	"Set ResultSummary[2]:Title3[6]"				Proj:ResultSummary[2]:Title3[6]		= {	if (EnergyCodeYearNum < 2022) then  "Site (therms)"  else  "(therms/yr)"  endif  }
	"Set ResultSummary[2]:Enduse1[6]"			Proj:ResultSummary[2]:Enduse1[6]		= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0 .OR. (RunResultsN[1]:StdNatGasEnergy  < 0.00001 .AND. RunResultsN[1]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[1]:StdNatGasEnergy  + RunResultsN[1]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse2[6]"			Proj:ResultSummary[2]:Enduse2[6]		= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0 .OR. (RunResultsN[2]:StdNatGasEnergy  < 0.00001 .AND. RunResultsN[2]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[2]:StdNatGasEnergy  + RunResultsN[2]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse3[6]"			Proj:ResultSummary[2]:Enduse3[6]		= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0 .OR. (RunResultsN[3]:StdNatGasEnergy  < 0.00001 .AND. RunResultsN[3]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[3]:StdNatGasEnergy  + RunResultsN[3]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse4[6]"			Proj:ResultSummary[2]:Enduse4[6]		= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0 .OR. (RunResultsN[4]:StdNatGasEnergy  < 0.00001 .AND. RunResultsN[4]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[4]:StdNatGasEnergy  + RunResultsN[4]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse5[6]"			Proj:ResultSummary[2]:Enduse5[6]		= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0 .OR. (RunResultsN[5]:StdNatGasEnergy  < 0.00001 .AND. RunResultsN[5]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[5]:StdNatGasEnergy  + RunResultsN[5]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse14[6]"			Proj:ResultSummary[2]:Enduse14[6]	= {	if (LocalCompAssigned( RunResultsN[14] ) == 0 .OR. (RunResultsN[14]:StdNatGasEnergy < 0.00001 .AND. RunResultsN[14]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[14]:StdNatGasEnergy + RunResultsN[14]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse6[6]"			Proj:ResultSummary[2]:Enduse6[6]		= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0 .OR. (RunResultsN[6]:StdNatGasEnergy  < 0.00001 .AND. RunResultsN[6]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[6]:StdNatGasEnergy  + RunResultsN[6]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse7[6]"			Proj:ResultSummary[2]:Enduse7[6]		= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0 .OR. (RunResultsN[7]:StdNatGasEnergy  < 0.00001 .AND. RunResultsN[7]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[7]:StdNatGasEnergy  + RunResultsN[7]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse8[6]"			Proj:ResultSummary[2]:Enduse8[6]		= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0 .OR. (RunResultsN[8]:StdNatGasEnergy  < 0.00001 .AND. RunResultsN[8]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[8]:StdNatGasEnergy  + RunResultsN[8]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse9[6]"			Proj:ResultSummary[2]:Enduse9[6]		= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0 .OR. (RunResultsN[9]:StdNatGasEnergy  < 0.00001 .AND. RunResultsN[9]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[9]:StdNatGasEnergy  + RunResultsN[9]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse10[6]"			Proj:ResultSummary[2]:Enduse10[6]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0 .OR. (RunResultsN[10]:StdNatGasEnergy < 0.00001 .AND. RunResultsN[10]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[10]:StdNatGasEnergy + RunResultsN[10]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse11[6]"			Proj:ResultSummary[2]:Enduse11[6]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0 .OR. (RunResultsN[11]:StdNatGasEnergy < 0.00001 .AND. RunResultsN[11]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[11]:StdNatGasEnergy + RunResultsN[11]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse12[6]"			Proj:ResultSummary[2]:Enduse12[6]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0 .OR. (RunResultsN[12]:StdNatGasEnergy < 0.00001 .AND. RunResultsN[12]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[12]:StdNatGasEnergy + RunResultsN[12]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
  ; Standard TDV
	"Set ResultSummary[2]:Title1[7]"				Proj:ResultSummary[2]:Title1[7]		= {	if (EnergyCodeYearNum < 2022) then  "Standard"       else  UNDEFINED        endif  }
	"Set ResultSummary[2]:Title2[7]"				Proj:ResultSummary[2]:Title2[7]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "EDR2"  else  Proj:CompMetricLbl_Short + ""  endif endif  }   ; SAC 01/29/23
	"Set ResultSummary[2]:Title3[7]"				Proj:ResultSummary[2]:Title3[7]		= {	if (EnergyCodeYearNum < 2022) then  "(kTDV/ft-yr)"  else if (EnergyCodeYearNum < 2025) then  "(kTDV/ft-yr)"  else  "($/ft)"  endif endif  }
	"Set ResultSummary[2]:Enduse1[7]"			Proj:ResultSummary[2]:Enduse1[7]		= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[1]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse2[7]"			Proj:ResultSummary[2]:Enduse2[7]		= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[2]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse3[7]"			Proj:ResultSummary[2]:Enduse3[7]		= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[3]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse4[7]"			Proj:ResultSummary[2]:Enduse4[7]		= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[4]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse5[7]"			Proj:ResultSummary[2]:Enduse5[7]		= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[5]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse6[7]"			Proj:ResultSummary[2]:Enduse6[7]		= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[6]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse7[7]"			Proj:ResultSummary[2]:Enduse7[7]		= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[7]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse8[7]"			Proj:ResultSummary[2]:Enduse8[7]		= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[8]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse9[7]"			Proj:ResultSummary[2]:Enduse9[7]		= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[9]:StandardTDV  ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse10[7]"			Proj:ResultSummary[2]:Enduse10[7]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[10]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse11[7]"			Proj:ResultSummary[2]:Enduse11[7]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[11]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse12[7]"			Proj:ResultSummary[2]:Enduse12[7]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[12]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse13[7]"			Proj:ResultSummary[2]:Enduse13[7]	= {	if (LocalCompAssigned( RunResultsN[13] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsN[13]:StandardTDV = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsN[13]:StandardTDV ), 2 )  endif endif  }
	"Set ResultSummary[2]:Enduse14[7]"			Proj:ResultSummary[2]:Enduse14[7]	= {	if (LocalCompAssigned( RunResultsN[14] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsN[14]:StandardTDV = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsN[14]:StandardTDV ), 2 )  endif endif  }

; mjb-10/16/13	subtract PVCredit from Prop Design - N
	;"Set ResultSummary[2]:Enduse13[4]"			Proj:ResultSummary[2]:Enduse13[4]	= {	FltToStr( (PVCredit[1] * -1), 2 )  }
   ; SAC 10/6/16 - 2019 PV
	"Set ResultSummary[2]:Enduse13[4]"			Proj:ResultSummary[2]:Enduse13[4]	= {	if (EnergyCodeYearNum >= 2019)
                                                                                 then  if (LocalCompAssigned( RunResultsN[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[13]:ProposedTDV ), 2 )  endif
                                                                                 else  if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( (RunResultsN[6]:PropPVCreditTDV[1] * -1), 2 )  endif  endif  }

  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
 	"Set ResultSummary[2]:Enduse10[4]"			Proj:ResultSummary[2]:Enduse10[4]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[10]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse11[4]"			Proj:ResultSummary[2]:Enduse11[4]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[11]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse12[4]"			Proj:ResultSummary[2]:Enduse12[4]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[12]:ProposedTDV[1] ), 2 )  endif  }
  ; SAC 4/17/15 - copy CompResultsMsg down from Proj into EUseSummary (to ensure that it is carried into subsequent models and back to user input)
	"Set ResultSummary[2]:CompResultsMsg"		Proj:ResultSummary[2]:CompResultsMsg	= {	if (GlobalStatus( Proj:CompResultsMsg ) > 0) then  Proj:CompResultsMsg  else  UNCHANGED  endif  }
  ; SAC 3/3/16 - ensure access to PVMinRatedPower in projects following analysis (tic #609)
	"Set ResultSummary[2]:PVMinRatedPower"		Proj:ResultSummary[2]:PVMinRatedPower	= {	if (IfValidAnd( Proj:PVCompCredit > 0 ) .AND. IfValidAnd( Proj:PVCredit[1] > 0 ) .AND. IfValidAnd( Proj:PVMinRatedPower[2] > 0 ))
																														then  Proj:PVMinRatedPower[2]  else  UNCHANGED  endif  }

  ; Compliance Margin TDV
	"Set ResultSummary[2]:Title1[8]"				Proj:ResultSummary[2]:Title1[8]		= {	if (EnergyCodeYearNum < 2022) then  "Compliance"     else if (EnergyCodeYearNum < 2025) then  "Compliance Margins:"  else "Compliance Margins"  endif endif  }   ; SAC 11/24/22
	"Set ResultSummary[2]:Title2[8]"				Proj:ResultSummary[2]:Title2[8]		= {	if (EnergyCodeYearNum < 2022) then  "Margin"         else if (EnergyCodeYearNum < 2025) then  "EDR2"                 else  Proj:CompMetricLbl_Short + ""  endif endif  }   ; SAC 01/29/23
	"Set ResultSummary[2]:Title3[8]"				Proj:ResultSummary[2]:Title3[8]		= {	if (EnergyCodeYearNum < 2022) then  "(kTDV/ft-yr)"  else if (EnergyCodeYearNum < 2025) then  "(kTDV/ft-yr)"        else  "($/ft)"  endif endif  }
	"Set ResultSummary[2]:Enduse1[8]"			Proj:ResultSummary[2]:Enduse1[8]		= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[1]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse2[8]"			Proj:ResultSummary[2]:Enduse2[8]		= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[2]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse3[8]"			Proj:ResultSummary[2]:Enduse3[8]		= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[3]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse4[8]"			Proj:ResultSummary[2]:Enduse4[8]		= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[4]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse5[8]"			Proj:ResultSummary[2]:Enduse5[8]		= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[5]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse14[8]"			Proj:ResultSummary[2]:Enduse14[8]	= {	if (LocalCompAssigned( RunResultsN[14] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[14]:CompMarginTDV ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse6[8]"			Proj:ResultSummary[2]:Enduse6[8]		= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[6]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse7[8]"			Proj:ResultSummary[2]:Enduse7[8]		= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[7]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse8[8]"			Proj:ResultSummary[2]:Enduse8[8]		= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[8]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse9[8]"			Proj:ResultSummary[2]:Enduse9[8]		= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[9]:CompMarginTDV  ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse10[8]"			Proj:ResultSummary[2]:Enduse10[8]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[10]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse11[8]"			Proj:ResultSummary[2]:Enduse11[8]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[11]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse12[8]"			Proj:ResultSummary[2]:Enduse12[8]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[12]:CompMarginTDV ), 2 )  endif  }
   ; SAC 10/6/16 - 2019 PV
 	"Set ResultSummary[2]:Enduse13[8]"			Proj:ResultSummary[2]:Enduse13[8]	= {	if (EnergyCodeYearNum >= 2019)
                                                                                 then  if (LocalCompAssigned( RunResultsN[13] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[13]:CompMarginTDV,     2 )  endif
                                                                                 else  if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[6]:PropPVCreditTDV[1], 2 )  endif  endif  }

	"Adjust Summary SelfUtilizationCredit (SUC) results-N"	   Proj:Action =        ; SAC 07/22/23 (2025)
      {  if (RunAbbrev == "s3") then  EvalRulelist( "CARes_SelfUtilizationCredit_2025_N" )
         else  UNCHANGED  endif  }

  ; Pass/Fail result
 	"Set ResultSummary[2]:MetricPassFail[1] (SLCC-Eff)"   Proj:ResultSummary[2]:MetricPassFail[1] = {	if (EnergyCodeYearNum < 2025 .OR. LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  if (RunResultsN[11]:CompMarginTDV >= 0) then "Pass"  else  "Fail"  endif endif  }  ; SAC 11/22/22 (2025)
 	"Set ResultSummary[2]:MetricPassFail[2] (SLCC-Tot)"   Proj:ResultSummary[2]:MetricPassFail[2] = {	if (EnergyCodeYearNum < 2025 .OR. LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  if (RunResultsN[10]:CompMarginTDV >= 0) then "Pass"  else  "Fail"  endif endif  } 
 	"Set ResultSummary[2]:MetricPassFail[3] (Src-Tot)"    Proj:ResultSummary[2]:MetricPassFail[3] = {	if (EnergyCodeYearNum < 2025 .OR. LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  if (RunResultsN[10]:CompMarginSrc >= 0) then "Pass"  else  "Fail"  endif endif  } 
 	"Set ResultSummary[2]:PassFail"				Proj:ResultSummary[2]:PassFail		= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  if (RunResultsN[11]:CompMarginTDV >= 0) then "PASS"  else  "FAIL"  endif endif  }

  ; Standard Electric Demand
	"Set ResultSummary[2]:Title1[11]"			Proj:ResultSummary[2]:Title1[11]		= {	"Standard"  }
	"Set ResultSummary[2]:Title2[11]"			Proj:ResultSummary[2]:Title2[11]		= {	"Design"  }
	"Set ResultSummary[2]:Title3[11]"			Proj:ResultSummary[2]:Title3[11]		= {	"(kW)"  }
	"Set ResultSummary[2]:Enduse1[11]"			Proj:ResultSummary[2]:Enduse1[11]	= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[1]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse2[11]"			Proj:ResultSummary[2]:Enduse2[11]	= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[2]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse3[11]"			Proj:ResultSummary[2]:Enduse3[11]	= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[3]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse4[11]"			Proj:ResultSummary[2]:Enduse4[11]	= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[4]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse5[11]"			Proj:ResultSummary[2]:Enduse5[11]	= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[5]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse14[11]"			Proj:ResultSummary[2]:Enduse14[11]	= {	if (LocalCompAssigned( RunResultsN[14] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[14]:StdElecDemand ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse6[11]"			Proj:ResultSummary[2]:Enduse6[11]	= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[6]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse7[11]"			Proj:ResultSummary[2]:Enduse7[11]	= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[7]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse8[11]"			Proj:ResultSummary[2]:Enduse8[11]	= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[8]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse9[11]"			Proj:ResultSummary[2]:Enduse9[11]	= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[9]:StdElecDemand  ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse10[11]"			Proj:ResultSummary[2]:Enduse10[11]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[10]:StdElecDemand ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse11[11]"			Proj:ResultSummary[2]:Enduse11[11]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[11]:StdElecDemand ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse12[11]"			Proj:ResultSummary[2]:Enduse12[11]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[12]:StdElecDemand ), 2 )  endif  }

  ; Demand & Energy Use Margins (added w/ CAHP mods 10/8/14)
	"Set ResultSummary[2]:MarginkW[1]"		Proj:ResultSummary[2]:MarginkW[1]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED
																												else  int(((ValidOr( RunResults[10]:StdElecDemand, 0 ) - ValidOr( RunResultsN[10]:PropElecDemand[1], 0 )) * 100) +0.5 ) / 100  endif  }
	"Set ResultSummary[2]:MarginkWh"			Proj:ResultSummary[2]:MarginkWh		= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED
																												else  int((((ValidOr( RunResults[10]:StdElecEnergy, 0 ) - ValidOr( RunResultsN[10]:PropElecEnergy[1], 0 )) * CondFloorArea / 3.413) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[2]:MarginTherms"		Proj:ResultSummary[2]:MarginTherms	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED
																												else  int((((ValidOr( RunResults[10]:StdNatGasEnergy, 0 ) - ValidOr( RunResultsN[10]:PropNatGasEnergy[1], 0 )) * CondFloorArea / 100) * 100) +0.5 ) / 100  endif  }
  ; Additional elec demand storage (SAC 10/7/16)
   "Set ResultSummary[2]:PropElecDemand[1]"  Proj:ResultSummary[2]:PropElecDemand[1]   = {   if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED
																												         else  ValidOr( RunResultsN[10]:PropElecDemand[1], 0 )  endif  }
   "Set ResultSummary[2]:PropElecDemand[2]"  Proj:ResultSummary[2]:PropElecDemand[2]   = {   if (LocalCompAssigned( RunResultsN[10] ) == 0 .OR. LocalStatus( RunResultsN[10]:PropElecDemand[2] ) < 1) then  UNDEFINED
																												         else  ValidOr( RunResultsN[10]:PropElecDemand[2], 0 )  endif  }
   "Set ResultSummary[2]:StdElecDemand"      Proj:ResultSummary[2]:StdElecDemand       = {   if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED
																												         else  ValidOr( RunResults[10]:StdElecDemand, 0 )  endif  }
   "Set ResultSummary[2]:DRtgElecDemand"     Proj:ResultSummary[2]:DRtgElecDemand      = {   if (LocalCompAssigned( RunResultsN[10] ) == 0 .OR. LocalStatus( RunResultsN[10]:DRtgElecDemand ) < 1) then  UNDEFINED
																												         else  ValidOr( RunResultsN[10]:DRtgElecDemand, 0 )  endif  }
	"Set ResultSummary[2]:MarginkW[2]"		   Proj:ResultSummary[2]:MarginkW[2]	      = {	if (LocalCompAssigned( RunResultsN[10] ) == 0 .OR. LocalStatus( ResultSummary[2]:PropElecDemand[2] ) < 1) then  UNDEFINED
																												         else  int(((ResultSummary[2]:DRtgElecDemand - ResultSummary[2]:PropElecDemand[2]) * 100) +0.5 ) / 100  endif  }
  ; Percent Savings values for reporting
	"Set ResultSummary[2]:PctSavingskW"			Proj:ResultSummary[2]:PctSavingskW		= {	if (IfValidAnd( RunResults[10]:StdElecDemand > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[10]:StdElecDemand   - ValidOr( RunResultsN[10]:PropElecDemand[1],   0 )) * 100 / RunResults[10]:StdElecDemand  ) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[2]:PctSavingskWh"		Proj:ResultSummary[2]:PctSavingskWh		= {	if (IfValidAnd( RunResults[10]:StdElecEnergy > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[10]:StdElecEnergy   - ValidOr( RunResultsN[10]:PropElecEnergy[1],   0 )) * 100 / RunResults[10]:StdElecEnergy  ) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[2]:PctSavingsTherms"	Proj:ResultSummary[2]:PctSavingsTherms	= {	if (IfValidAnd( RunResults[10]:StdNatGasEnergy > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[10]:StdNatGasEnergy - ValidOr( RunResultsN[10]:PropNatGasEnergy[1], 0 )) * 100 / RunResults[10]:StdNatGasEnergy) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[2]:PctSavingsTDV"		Proj:ResultSummary[2]:PctSavingsTDV		= {	if (IfValidAnd( RunResults[10]:StandardTDV     > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[10]:StandardTDV     - ValidOr( RunResultsN[10]:ProposedTDV[1],      0 )) * 100 / RunResults[10]:StandardTDV    ) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[2]:PctSavingsCmpTDV"	Proj:ResultSummary[2]:PctSavingsCmpTDV	= {	if (IfValidAnd( RunResults[11]:StandardTDV     > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[11]:StandardTDV     - ValidOr( RunResultsN[11]:ProposedTDV[1],      0 )) * 100 / RunResults[11]:StandardTDV    ) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[2]:PctSavingsSrc"		Proj:ResultSummary[2]:PctSavingsSrc		= {	if (IfValidAnd( RunResults[10]:StandardSrc     > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[10]:StandardSrc     - ValidOr( RunResultsN[10]:ProposedSrc[1],      0 )) * 100 / RunResults[10]:StandardSrc    ) * 10) +0.5 ) / 10  endif  }     ; SAC 11/26/22
	"Set ResultSummary[2]:PctSavkWLbl"			Proj:ResultSummary[2]:PctSavkWLbl		= {	if (IfValidAnd( ResultSummary[2]:PctSavingskW     > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[2]:PctSavingskW     < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[2]:PctSavingskW     )  endif  }
	"Set ResultSummary[2]:PctSavkWhLbl"			Proj:ResultSummary[2]:PctSavkWhLbl		= {	if (IfValidAnd( ResultSummary[2]:PctSavingskWh    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[2]:PctSavingskWh    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[2]:PctSavingskWh    )  endif  }
	"Set ResultSummary[2]:PctSavThermsLbl"		Proj:ResultSummary[2]:PctSavThermsLbl	= {	if (IfValidAnd( ResultSummary[2]:PctSavingsTherms > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[2]:PctSavingsTherms < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[2]:PctSavingsTherms )  endif  }
	"Set ResultSummary[2]:PctSavTDVLbl"			Proj:ResultSummary[2]:PctSavTDVLbl		= {	if (IfValidAnd( ResultSummary[2]:PctSavingsTDV    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[2]:PctSavingsTDV    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[2]:PctSavingsTDV    )  endif  }
	"Set ResultSummary[2]:PctSavCmpTDVLbl"		Proj:ResultSummary[2]:PctSavCmpTDVLbl	= {	if (IfValidAnd( ResultSummary[2]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[2]:PctSavingsCmpTDV < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[2]:PctSavingsCmpTDV )  endif  }
	"Set ResultSummary[2]:PctSavSrcLbl"			Proj:ResultSummary[2]:PctSavSrcLbl		= {	if (IfValidAnd( ResultSummary[2]:PctSavingsSrc    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[2]:PctSavingsSrc    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[2]:PctSavingsSrc    )  endif  }   ; SAC 11/26/22
	; SAC 3/21/16 - added tier results
	; SAC 5/23/16 - modified to require QII (tic #671)
	"Set ResultSummary[2]:MeetsTier1"			Proj:ResultSummary[2]:MeetsTier1		= {	if (StdDesignBase >= 2016 .AND. IfValidAnd( ResultSummary[2]:PctSavingsCmpTDV >= 14.95 ) .AND.
																															IfValidAnd( HERSProj:QII > 0.5 )) then  1  else  0  endif  }
	"Set ResultSummary[2]:MeetsTier2"			Proj:ResultSummary[2]:MeetsTier2		= {	if (StdDesignBase >= 2016 .AND. IfValidAnd( ResultSummary[2]:PctSavingsCmpTDV >= 29.95 ) .AND.
																															IfValidAnd( HERSProj:QII > 0.5 )) then  1  else  0  endif  }

; -- EAST Facing --
  ; Standard Site Electric Use
	"Set ResultSummary[3]:Title1[5]"				Proj:ResultSummary[3]:Title1[5]		= {	if (EnergyCodeYearNum < 2022) then  "Standard"    else if (EnergyCodeYearNum < 2025) then  "Standard Design:"  else  "Standard Design"  endif endif  }
	"Set ResultSummary[3]:Title2[5]"				Proj:ResultSummary[3]:Title2[5]		= {	if (EnergyCodeYearNum < 2022) then  "Design"      else if (EnergyCodeYearNum < 2025) then  "Site"              else  "Site Elec."       endif endif  }
	"Set ResultSummary[3]:Title3[5]"				Proj:ResultSummary[3]:Title3[5]		= {	if (EnergyCodeYearNum < 2022) then  "Site (kWh)"  else  "(kWh/yr)"             endif  }
	"Set ResultSummary[3]:Enduse1[5]"			Proj:ResultSummary[3]:Enduse1[5]		= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0 .OR. RunResultsE[1]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[1]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse2[5]"			Proj:ResultSummary[3]:Enduse2[5]		= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0 .OR. RunResultsE[2]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[2]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse3[5]"			Proj:ResultSummary[3]:Enduse3[5]		= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0 .OR. RunResultsE[3]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[3]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse4[5]"			Proj:ResultSummary[3]:Enduse4[5]		= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0 .OR. RunResultsE[4]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[4]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse5[5]"			Proj:ResultSummary[3]:Enduse5[5]		= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0 .OR. RunResultsE[5]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[5]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse14[5]"			Proj:ResultSummary[3]:Enduse14[5]	= {	if (LocalCompAssigned( RunResultsE[14] ) == 0 .OR. RunResultsE[14]:StdElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[14]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse6[5]"			Proj:ResultSummary[3]:Enduse6[5]		= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0 .OR. RunResultsE[6]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[6]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse7[5]"			Proj:ResultSummary[3]:Enduse7[5]		= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0 .OR. RunResultsE[7]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[7]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse8[5]"			Proj:ResultSummary[3]:Enduse8[5]		= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0 .OR. RunResultsE[8]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[8]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse9[5]"			Proj:ResultSummary[3]:Enduse9[5]		= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0 .OR. RunResultsE[9]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[9]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse10[5]"			Proj:ResultSummary[3]:Enduse10[5]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[10]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse11[5]"			Proj:ResultSummary[3]:Enduse11[5]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0 .OR. RunResultsE[11]:StdElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[11]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse12[5]"			Proj:ResultSummary[3]:Enduse12[5]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0 .OR. RunResultsE[12]:StdElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[12]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse13[5]"			Proj:ResultSummary[3]:Enduse13[5]	= {	if (LocalCompAssigned( RunResultsE[13] ) == 0 .OR. RunResultsE[13]:StdElecEnergy > -0.00001) then  UNDEFINED  ; SAC 1/11/18
																													else  FltToStr( (int( (RunResultsE[13]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
	"Set ResultSummary[3]:Enduse10[2]"			Proj:ResultSummary[3]:Enduse10[2]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsE[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse11[2]"			Proj:ResultSummary[3]:Enduse11[2]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsE[11]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse12[2]"			Proj:ResultSummary[3]:Enduse12[2]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0 .OR. RunResultsE[12]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsE[12]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }

  ; Standard Site Natural Gas Use
	"Set ResultSummary[3]:Title1[6]"				Proj:ResultSummary[3]:Title1[6]		= {	if (EnergyCodeYearNum < 2022) then  "Standard"       else  UNDEFINED   endif  }
	"Set ResultSummary[3]:Title2[6]"				Proj:ResultSummary[3]:Title2[6]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "Site"  else  "Site Gas"  endif endif  }
	"Set ResultSummary[3]:Title3[6]"				Proj:ResultSummary[3]:Title3[6]		= {	if (EnergyCodeYearNum < 2022) then  "Site (therms)"  else  "(therms/yr)"  endif  }
	"Set ResultSummary[3]:Enduse1[6]"			Proj:ResultSummary[3]:Enduse1[6]		= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0 .OR. (RunResultsE[1]:StdNatGasEnergy  < 0.00001 .AND. RunResultsE[1]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[1]:StdNatGasEnergy  + RunResultsE[1]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse2[6]"			Proj:ResultSummary[3]:Enduse2[6]		= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0 .OR. (RunResultsE[2]:StdNatGasEnergy  < 0.00001 .AND. RunResultsE[2]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[2]:StdNatGasEnergy  + RunResultsE[2]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse3[6]"			Proj:ResultSummary[3]:Enduse3[6]		= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0 .OR. (RunResultsE[3]:StdNatGasEnergy  < 0.00001 .AND. RunResultsE[3]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[3]:StdNatGasEnergy  + RunResultsE[3]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse4[6]"			Proj:ResultSummary[3]:Enduse4[6]		= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0 .OR. (RunResultsE[4]:StdNatGasEnergy  < 0.00001 .AND. RunResultsE[4]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[4]:StdNatGasEnergy  + RunResultsE[4]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse5[6]"			Proj:ResultSummary[3]:Enduse5[6]		= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0 .OR. (RunResultsE[5]:StdNatGasEnergy  < 0.00001 .AND. RunResultsE[5]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[5]:StdNatGasEnergy  + RunResultsE[5]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse6[6]"			Proj:ResultSummary[3]:Enduse6[6]		= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0 .OR. (RunResultsE[6]:StdNatGasEnergy  < 0.00001 .AND. RunResultsE[6]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[6]:StdNatGasEnergy  + RunResultsE[6]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse7[6]"			Proj:ResultSummary[3]:Enduse7[6]		= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0 .OR. (RunResultsE[7]:StdNatGasEnergy  < 0.00001 .AND. RunResultsE[7]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[7]:StdNatGasEnergy  + RunResultsE[7]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse8[6]"			Proj:ResultSummary[3]:Enduse8[6]		= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0 .OR. (RunResultsE[8]:StdNatGasEnergy  < 0.00001 .AND. RunResultsE[8]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[8]:StdNatGasEnergy  + RunResultsE[8]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse9[6]"			Proj:ResultSummary[3]:Enduse9[6]		= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0 .OR. (RunResultsE[9]:StdNatGasEnergy  < 0.00001 .AND. RunResultsE[9]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[9]:StdNatGasEnergy  + RunResultsE[9]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse10[6]"			Proj:ResultSummary[3]:Enduse10[6]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0 .OR. (RunResultsE[10]:StdNatGasEnergy < 0.00001 .AND. RunResultsE[10]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[10]:StdNatGasEnergy + RunResultsE[10]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse11[6]"			Proj:ResultSummary[3]:Enduse11[6]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0 .OR. (RunResultsE[11]:StdNatGasEnergy < 0.00001 .AND. RunResultsE[11]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[11]:StdNatGasEnergy + RunResultsE[11]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse12[6]"			Proj:ResultSummary[3]:Enduse12[6]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0 .OR. (RunResultsE[12]:StdNatGasEnergy < 0.00001 .AND. RunResultsE[12]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[12]:StdNatGasEnergy + RunResultsE[12]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
  ; Standard TDV
	"Set ResultSummary[3]:Title1[7]"				Proj:ResultSummary[3]:Title1[7]		= {	if (EnergyCodeYearNum < 2022) then  "Standard"       else  UNDEFINED        endif  }
	"Set ResultSummary[3]:Title2[7]"				Proj:ResultSummary[3]:Title2[7]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "EDR2"  else  Proj:CompMetricLbl_Short + ""  endif endif  }   ; SAC 01/29/23
	"Set ResultSummary[3]:Title3[7]"				Proj:ResultSummary[3]:Title3[7]		= {	if (EnergyCodeYearNum < 2022) then  "(kTDV/ft-yr)"  else if (EnergyCodeYearNum < 2025) then  "(kTDV/ft-yr)"  else  "($/ft)"  endif endif  }
	"Set ResultSummary[3]:Enduse1[7]"			Proj:ResultSummary[3]:Enduse1[7]		= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[1]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse2[7]"			Proj:ResultSummary[3]:Enduse2[7]		= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[2]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse3[7]"			Proj:ResultSummary[3]:Enduse3[7]		= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[3]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse4[7]"			Proj:ResultSummary[3]:Enduse4[7]		= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[4]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse5[7]"			Proj:ResultSummary[3]:Enduse5[7]		= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[5]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse6[7]"			Proj:ResultSummary[3]:Enduse6[7]		= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[6]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse7[7]"			Proj:ResultSummary[3]:Enduse7[7]		= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[7]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse8[7]"			Proj:ResultSummary[3]:Enduse8[7]		= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[8]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse9[7]"			Proj:ResultSummary[3]:Enduse9[7]		= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[9]:StandardTDV  ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse10[7]"			Proj:ResultSummary[3]:Enduse10[7]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[10]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse11[7]"			Proj:ResultSummary[3]:Enduse11[7]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[11]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse12[7]"			Proj:ResultSummary[3]:Enduse12[7]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[12]:StandardTDV ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse13[7]"			Proj:ResultSummary[3]:Enduse13[7]	= {	if (LocalCompAssigned( RunResultsE[13] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsE[13]:StandardTDV = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsE[13]:StandardTDV ), 2 )  endif endif  }
	"Set ResultSummary[3]:Enduse14[7]"			Proj:ResultSummary[3]:Enduse14[7]	= {	if (LocalCompAssigned( RunResultsE[14] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsE[14]:StandardTDV = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsE[14]:StandardTDV ), 2 )  endif endif  }

; mjb-10/16/13	subtract PVCredit from Prop Design - E
	;"Set ResultSummary[3]:Enduse13[4]"			Proj:ResultSummary[3]:Enduse13[4]	= {	FltToStr( (PVCredit[1] * -1), 2 )  }
   ; SAC 10/6/16 - 2019 PV
	"Set ResultSummary[3]:Enduse13[4]"			Proj:ResultSummary[3]:Enduse13[4]	= {	if (EnergyCodeYearNum >= 2019)
                                                                                 then  if (LocalCompAssigned( RunResultsE[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[13]:ProposedTDV ), 2 )  endif
                                                                                 else  if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( (RunResultsE[6]:PropPVCreditTDV[1] * -1), 2 )  endif  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
 	"Set ResultSummary[3]:Enduse10[4]"			Proj:ResultSummary[3]:Enduse10[4]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[10]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse11[4]"			Proj:ResultSummary[3]:Enduse11[4]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[11]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse12[4]"			Proj:ResultSummary[3]:Enduse12[4]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[12]:ProposedTDV[1] ), 2 )  endif  }
  ; SAC 4/17/15 - copy CompResultsMsg down from Proj into EUseSummary (to ensure that it is carried into subsequent models and back to user input)
	"Set ResultSummary[3]:CompResultsMsg"		Proj:ResultSummary[3]:CompResultsMsg	= {	if (GlobalStatus( Proj:CompResultsMsg ) > 0) then  Proj:CompResultsMsg  else  UNCHANGED  endif  }
  ; SAC 3/3/16 - ensure access to PVMinRatedPower in projects following analysis (tic #609)
	"Set ResultSummary[3]:PVMinRatedPower"		Proj:ResultSummary[3]:PVMinRatedPower	= {	if (IfValidAnd( Proj:PVCompCredit > 0 ) .AND. IfValidAnd( Proj:PVCredit[1] > 0 ) .AND. IfValidAnd( Proj:PVMinRatedPower[2] > 0 ))
																														then  Proj:PVMinRatedPower[2]  else  UNCHANGED  endif  }

  ; Compliance Margin TDV
	"Set ResultSummary[3]:Title1[8]"				Proj:ResultSummary[3]:Title1[8]		= {	if (EnergyCodeYearNum < 2022) then  "Compliance"     else if (EnergyCodeYearNum < 2025) then  "Compliance Margins:"  else "Compliance Margins"  endif endif  }   ; SAC 11/24/22
	"Set ResultSummary[3]:Title2[8]"				Proj:ResultSummary[3]:Title2[8]		= {	if (EnergyCodeYearNum < 2022) then  "Margin"         else if (EnergyCodeYearNum < 2025) then  "EDR2"                 else  Proj:CompMetricLbl_Short + ""       endif endif  }   ; SAC 01/29/23
	"Set ResultSummary[3]:Title3[8]"				Proj:ResultSummary[3]:Title3[8]		= {	if (EnergyCodeYearNum < 2022) then  "(kTDV/ft-yr)"  else if (EnergyCodeYearNum < 2025) then  "(kTDV/ft-yr)"        else  "($/ft)"  endif endif  }
	"Set ResultSummary[3]:Enduse1[8]"			Proj:ResultSummary[3]:Enduse1[8]		= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[1]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse2[8]"			Proj:ResultSummary[3]:Enduse2[8]		= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[2]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse3[8]"			Proj:ResultSummary[3]:Enduse3[8]		= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[3]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse4[8]"			Proj:ResultSummary[3]:Enduse4[8]		= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[4]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse5[8]"			Proj:ResultSummary[3]:Enduse5[8]		= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[5]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse14[8]"			Proj:ResultSummary[3]:Enduse14[8]	= {	if (LocalCompAssigned( RunResultsE[14] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[14]:CompMarginTDV ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse6[8]"			Proj:ResultSummary[3]:Enduse6[8]		= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[6]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse7[8]"			Proj:ResultSummary[3]:Enduse7[8]		= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[7]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse8[8]"			Proj:ResultSummary[3]:Enduse8[8]		= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[8]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse9[8]"			Proj:ResultSummary[3]:Enduse9[8]		= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[9]:CompMarginTDV  ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse10[8]"			Proj:ResultSummary[3]:Enduse10[8]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[10]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse11[8]"			Proj:ResultSummary[3]:Enduse11[8]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[11]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse12[8]"			Proj:ResultSummary[3]:Enduse12[8]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[12]:CompMarginTDV ), 2 )  endif  }
   ; SAC 10/6/16 - 2019 PV
 	"Set ResultSummary[3]:Enduse13[8]"			Proj:ResultSummary[3]:Enduse13[8]	= {	if (EnergyCodeYearNum >= 2019)
                                                                                 then  if (LocalCompAssigned( RunResultsE[13] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[13]:CompMarginTDV,     2 )  endif
                                                                                 else  if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[6]:PropPVCreditTDV[1], 2 )  endif  endif  }

	"Adjust Summary SelfUtilizationCredit (SUC) results-E"	   Proj:Action =        ; SAC 07/22/23 (2025)
      {  if (RunAbbrev == "s3") then  EvalRulelist( "CARes_SelfUtilizationCredit_2025_E" )
         else  UNCHANGED  endif  }

  ; Pass/Fail result
 	"Set ResultSummary[3]:MetricPassFail[1] (SLCC-Eff)"   Proj:ResultSummary[3]:MetricPassFail[1] = {	if (EnergyCodeYearNum < 2025 .OR. LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  if (RunResultsE[11]:CompMarginTDV >= 0) then "Pass"  else  "Fail"  endif endif  }  ; SAC 11/22/22 (2025)
 	"Set ResultSummary[3]:MetricPassFail[2] (SLCC-Tot)"   Proj:ResultSummary[3]:MetricPassFail[2] = {	if (EnergyCodeYearNum < 2025 .OR. LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  if (RunResultsE[10]:CompMarginTDV >= 0) then "Pass"  else  "Fail"  endif endif  } 
 	"Set ResultSummary[3]:MetricPassFail[3] (Src-Tot)"    Proj:ResultSummary[3]:MetricPassFail[3] = {	if (EnergyCodeYearNum < 2025 .OR. LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  if (RunResultsE[10]:CompMarginSrc >= 0) then "Pass"  else  "Fail"  endif endif  } 
 	"Set ResultSummary[3]:PassFail"				Proj:ResultSummary[3]:PassFail		= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  if (RunResultsE[11]:CompMarginTDV >= 0) then "PASS"  else  "FAIL"  endif endif  }

  ; Standard Electric Demand
	"Set ResultSummary[3]:Title1[11]"			Proj:ResultSummary[3]:Title1[11]		= {	"Standard"  }
	"Set ResultSummary[3]:Title2[11]"			Proj:ResultSummary[3]:Title2[11]		= {	"Design"  }
	"Set ResultSummary[3]:Title3[11]"			Proj:ResultSummary[3]:Title3[11]		= {	"(kW)"  }
	"Set ResultSummary[3]:Enduse1[11]"			Proj:ResultSummary[3]:Enduse1[11]	= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[1]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse2[11]"			Proj:ResultSummary[3]:Enduse2[11]	= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[2]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse3[11]"			Proj:ResultSummary[3]:Enduse3[11]	= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[3]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse4[11]"			Proj:ResultSummary[3]:Enduse4[11]	= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[4]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse5[11]"			Proj:ResultSummary[3]:Enduse5[11]	= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[5]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse14[11]"			Proj:ResultSummary[3]:Enduse14[11]	= {	if (LocalCompAssigned( RunResultsE[14] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[14]:StdElecDemand ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse6[11]"			Proj:ResultSummary[3]:Enduse6[11]	= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[6]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse7[11]"			Proj:ResultSummary[3]:Enduse7[11]	= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[7]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse8[11]"			Proj:ResultSummary[3]:Enduse8[11]	= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[8]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse9[11]"			Proj:ResultSummary[3]:Enduse9[11]	= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[9]:StdElecDemand  ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse10[11]"			Proj:ResultSummary[3]:Enduse10[11]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[10]:StdElecDemand ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse11[11]"			Proj:ResultSummary[3]:Enduse11[11]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[11]:StdElecDemand ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse12[11]"			Proj:ResultSummary[3]:Enduse12[11]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[12]:StdElecDemand ), 2 )  endif  }

  ; Demand & Energy Use Margins (added w/ CAHP mods 10/8/14)
	"Set ResultSummary[3]:MarginkW[1]"		Proj:ResultSummary[3]:MarginkW[1]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED
																												else  int(((ValidOr( RunResults[10]:StdElecDemand, 0 ) - ValidOr( RunResultsE[10]:PropElecDemand[1], 0 )) * 100) +0.5 ) / 100  endif  }
	"Set ResultSummary[3]:MarginkWh"			Proj:ResultSummary[3]:MarginkWh		= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED
																												else  int((((ValidOr( RunResults[10]:StdElecEnergy, 0 ) - ValidOr( RunResultsE[10]:PropElecEnergy[1], 0 )) * CondFloorArea / 3.413) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[3]:MarginTherms"		Proj:ResultSummary[3]:MarginTherms	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED
																												else  int((((ValidOr( RunResults[10]:StdNatGasEnergy, 0 ) - ValidOr( RunResultsE[10]:PropNatGasEnergy[1], 0 )) * CondFloorArea / 100) * 100) +0.5 ) / 100  endif  }
  ; Additional elec demand storage (SAC 10/7/16)
   "Set ResultSummary[3]:PropElecDemand[1]"  Proj:ResultSummary[3]:PropElecDemand[1]   = {   if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED
																												         else  ValidOr( RunResultsE[10]:PropElecDemand[1], 0 )  endif  }
   "Set ResultSummary[3]:PropElecDemand[2]"  Proj:ResultSummary[3]:PropElecDemand[2]   = {   if (LocalCompAssigned( RunResultsE[10] ) == 0 .OR. LocalStatus( RunResultsE[10]:PropElecDemand[2] ) < 1) then  UNDEFINED
																												         else  ValidOr( RunResultsE[10]:PropElecDemand[2], 0 )  endif  }
   "Set ResultSummary[3]:StdElecDemand"      Proj:ResultSummary[3]:StdElecDemand       = {   if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED
																												         else  ValidOr( RunResults[10]:StdElecDemand, 0 )  endif  }
   "Set ResultSummary[3]:DRtgElecDemand"     Proj:ResultSummary[3]:DRtgElecDemand      = {   if (LocalCompAssigned( RunResultsE[10] ) == 0 .OR. LocalStatus( RunResultsE[10]:DRtgElecDemand ) < 1) then  UNDEFINED
																												         else  ValidOr( RunResultsE[10]:DRtgElecDemand, 0 )  endif  }
	"Set ResultSummary[3]:MarginkW[2]"		   Proj:ResultSummary[3]:MarginkW[2]	      = {	if (LocalCompAssigned( RunResultsE[10] ) == 0 .OR. LocalStatus( ResultSummary[3]:PropElecDemand[2] ) < 1) then  UNDEFINED
																												         else  int(((ResultSummary[3]:DRtgElecDemand - ResultSummary[3]:PropElecDemand[2]) * 100) +0.5 ) / 100  endif  }
  ; Percent Savings values for reporting
	"Set ResultSummary[3]:PctSavingskW"			Proj:ResultSummary[3]:PctSavingskW		= {	if (IfValidAnd( RunResults[10]:StdElecDemand > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[10]:StdElecDemand   - ValidOr( RunResultsE[10]:PropElecDemand[1],   0 )) * 100 / RunResults[10]:StdElecDemand  ) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[3]:PctSavingskWh"		Proj:ResultSummary[3]:PctSavingskWh		= {	if (IfValidAnd( RunResults[10]:StdElecEnergy > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[10]:StdElecEnergy   - ValidOr( RunResultsE[10]:PropElecEnergy[1],   0 )) * 100 / RunResults[10]:StdElecEnergy  ) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[3]:PctSavingsTherms"	Proj:ResultSummary[3]:PctSavingsTherms	= {	if (IfValidAnd( RunResults[10]:StdNatGasEnergy > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[10]:StdNatGasEnergy - ValidOr( RunResultsE[10]:PropNatGasEnergy[1], 0 )) * 100 / RunResults[10]:StdNatGasEnergy) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[3]:PctSavingsTDV"		Proj:ResultSummary[3]:PctSavingsTDV		= {	if (IfValidAnd( RunResults[10]:StandardTDV     > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[10]:StandardTDV     - ValidOr( RunResultsE[10]:ProposedTDV[1],      0 )) * 100 / RunResults[10]:StandardTDV    ) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[3]:PctSavingsCmpTDV"	Proj:ResultSummary[3]:PctSavingsCmpTDV	= {	if (IfValidAnd( RunResults[11]:StandardTDV     > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[11]:StandardTDV     - ValidOr( RunResultsE[11]:ProposedTDV[1],      0 )) * 100 / RunResults[11]:StandardTDV    ) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[3]:PctSavingsSrc"		Proj:ResultSummary[3]:PctSavingsSrc		= {	if (IfValidAnd( RunResults[10]:StandardSrc     > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[10]:StandardSrc     - ValidOr( RunResultsE[10]:ProposedSrc[1],      0 )) * 100 / RunResults[10]:StandardSrc    ) * 10) +0.5 ) / 10  endif  }     ; SAC 11/26/22
	"Set ResultSummary[3]:PctSavkWLbl"			Proj:ResultSummary[3]:PctSavkWLbl		= {	if (IfValidAnd( ResultSummary[3]:PctSavingskW     > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[3]:PctSavingskW     < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[3]:PctSavingskW     )  endif  }
	"Set ResultSummary[3]:PctSavkWhLbl"			Proj:ResultSummary[3]:PctSavkWhLbl		= {	if (IfValidAnd( ResultSummary[3]:PctSavingskWh    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[3]:PctSavingskWh    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[3]:PctSavingskWh    )  endif  }
	"Set ResultSummary[3]:PctSavThermsLbl"		Proj:ResultSummary[3]:PctSavThermsLbl	= {	if (IfValidAnd( ResultSummary[3]:PctSavingsTherms > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[3]:PctSavingsTherms < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[3]:PctSavingsTherms )  endif  }
	"Set ResultSummary[3]:PctSavTDVLbl"			Proj:ResultSummary[3]:PctSavTDVLbl		= {	if (IfValidAnd( ResultSummary[3]:PctSavingsTDV    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[3]:PctSavingsTDV    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[3]:PctSavingsTDV    )  endif  }
	"Set ResultSummary[3]:PctSavCmpTDVLbl"		Proj:ResultSummary[3]:PctSavCmpTDVLbl	= {	if (IfValidAnd( ResultSummary[3]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[3]:PctSavingsCmpTDV < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[3]:PctSavingsCmpTDV )  endif  }
	"Set ResultSummary[3]:PctSavSrcLbl"			Proj:ResultSummary[3]:PctSavSrcLbl		= {	if (IfValidAnd( ResultSummary[3]:PctSavingsSrc    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[3]:PctSavingsSrc    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[3]:PctSavingsSrc    )  endif  }   ; SAC 11/26/22
	; SAC 3/21/16 - added tier results
	; SAC 5/23/16 - modified to require QII (tic #671)
	"Set ResultSummary[3]:MeetsTier1"			Proj:ResultSummary[3]:MeetsTier1		= {	if (StdDesignBase >= 2016 .AND. IfValidAnd( ResultSummary[3]:PctSavingsCmpTDV >= 14.95 ) .AND.
																															IfValidAnd( HERSProj:QII > 0.5 )) then  1  else  0  endif  }
	"Set ResultSummary[3]:MeetsTier2"			Proj:ResultSummary[3]:MeetsTier2		= {	if (StdDesignBase >= 2016 .AND. IfValidAnd( ResultSummary[3]:PctSavingsCmpTDV >= 29.95 ) .AND.
																															IfValidAnd( HERSProj:QII > 0.5 )) then  1  else  0  endif  }

; -- SOUTH Facing --
  ; Standard Site Electric Use
	"Set ResultSummary[4]:Title1[5]"				Proj:ResultSummary[4]:Title1[5]		= {	if (EnergyCodeYearNum < 2022) then  "Standard"    else if (EnergyCodeYearNum < 2025) then  "Standard Design:"  else  "Standard Design"  endif endif  }
	"Set ResultSummary[4]:Title2[5]"				Proj:ResultSummary[4]:Title2[5]		= {	if (EnergyCodeYearNum < 2022) then  "Design"      else if (EnergyCodeYearNum < 2025) then  "Site"              else  "Site Elec."       endif endif  }
	"Set ResultSummary[4]:Title3[5]"				Proj:ResultSummary[4]:Title3[5]		= {	if (EnergyCodeYearNum < 2022) then  "Site (kWh)"  else  "(kWh/yr)"             endif  }
	"Set ResultSummary[4]:Enduse1[5]"			Proj:ResultSummary[4]:Enduse1[5]		= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0 .OR. RunResultsS[1]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[1]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse2[5]"			Proj:ResultSummary[4]:Enduse2[5]		= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0 .OR. RunResultsS[2]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[2]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse3[5]"			Proj:ResultSummary[4]:Enduse3[5]		= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0 .OR. RunResultsS[3]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[3]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse4[5]"			Proj:ResultSummary[4]:Enduse4[5]		= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0 .OR. RunResultsS[4]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[4]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse5[5]"			Proj:ResultSummary[4]:Enduse5[5]		= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0 .OR. RunResultsS[5]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[5]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse14[5]"			Proj:ResultSummary[4]:Enduse14[5]	= {	if (LocalCompAssigned( RunResultsS[14] ) == 0 .OR. RunResultsS[14]:StdElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[14]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse6[5]"			Proj:ResultSummary[4]:Enduse6[5]		= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0 .OR. RunResultsS[6]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[6]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse7[5]"			Proj:ResultSummary[4]:Enduse7[5]		= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0 .OR. RunResultsS[7]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[7]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse8[5]"			Proj:ResultSummary[4]:Enduse8[5]		= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0 .OR. RunResultsS[8]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[8]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse9[5]"			Proj:ResultSummary[4]:Enduse9[5]		= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0 .OR. RunResultsS[9]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[9]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse10[5]"			Proj:ResultSummary[4]:Enduse10[5]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[10]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse11[5]"			Proj:ResultSummary[4]:Enduse11[5]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0 .OR. RunResultsS[11]:StdElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[11]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse12[5]"			Proj:ResultSummary[4]:Enduse12[5]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0 .OR. RunResultsS[12]:StdElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[12]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse13[5]"			Proj:ResultSummary[4]:Enduse13[5]	= {	if (LocalCompAssigned( RunResultsS[13] ) == 0 .OR. RunResultsS[13]:StdElecEnergy > -0.00001) then  UNDEFINED  ; SAC 1/11/18
																													else  FltToStr( (int( (RunResultsS[13]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
	"Set ResultSummary[4]:Enduse10[2]"			Proj:ResultSummary[4]:Enduse10[2]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse11[2]"			Proj:ResultSummary[4]:Enduse11[2]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[11]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse12[2]"			Proj:ResultSummary[4]:Enduse12[2]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0 .OR. RunResultsS[12]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[12]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
  ; Standard Site Natural Gas Use
	"Set ResultSummary[4]:Title1[6]"				Proj:ResultSummary[4]:Title1[6]		= {	if (EnergyCodeYearNum < 2022) then  "Standard"       else  UNDEFINED   endif  }
	"Set ResultSummary[4]:Title2[6]"				Proj:ResultSummary[4]:Title2[6]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "Site"  else  "Site Gas"  endif endif  }
	"Set ResultSummary[4]:Title3[6]"				Proj:ResultSummary[4]:Title3[6]		= {	if (EnergyCodeYearNum < 2022) then  "Site (therms)"  else  "(therms/yr)"  endif  }
	"Set ResultSummary[4]:Enduse1[6]"			Proj:ResultSummary[4]:Enduse1[6]		= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0 .OR. (RunResultsS[1]:StdNatGasEnergy  < 0.00001 .AND. RunResultsS[1]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[1]:StdNatGasEnergy  + RunResultsS[1]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse2[6]"			Proj:ResultSummary[4]:Enduse2[6]		= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0 .OR. (RunResultsS[2]:StdNatGasEnergy  < 0.00001 .AND. RunResultsS[2]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[2]:StdNatGasEnergy  + RunResultsS[2]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse3[6]"			Proj:ResultSummary[4]:Enduse3[6]		= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0 .OR. (RunResultsS[3]:StdNatGasEnergy  < 0.00001 .AND. RunResultsS[3]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[3]:StdNatGasEnergy  + RunResultsS[3]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse4[6]"			Proj:ResultSummary[4]:Enduse4[6]		= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0 .OR. (RunResultsS[4]:StdNatGasEnergy  < 0.00001 .AND. RunResultsS[4]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[4]:StdNatGasEnergy  + RunResultsS[4]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse5[6]"			Proj:ResultSummary[4]:Enduse5[6]		= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0 .OR. (RunResultsS[5]:StdNatGasEnergy  < 0.00001 .AND. RunResultsS[5]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[5]:StdNatGasEnergy  + RunResultsS[5]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse14[6]"			Proj:ResultSummary[4]:Enduse14[6]	= {	if (LocalCompAssigned( RunResultsS[14] ) == 0 .OR. (RunResultsS[14]:StdNatGasEnergy < 0.00001 .AND. RunResultsS[14]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[14]:StdNatGasEnergy + RunResultsS[14]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse6[6]"			Proj:ResultSummary[4]:Enduse6[6]		= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0 .OR. (RunResultsS[6]:StdNatGasEnergy  < 0.00001 .AND. RunResultsS[6]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[6]:StdNatGasEnergy  + RunResultsS[6]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse7[6]"			Proj:ResultSummary[4]:Enduse7[6]		= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0 .OR. (RunResultsS[7]:StdNatGasEnergy  < 0.00001 .AND. RunResultsS[7]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[7]:StdNatGasEnergy  + RunResultsS[7]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse8[6]"			Proj:ResultSummary[4]:Enduse8[6]		= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0 .OR. (RunResultsS[8]:StdNatGasEnergy  < 0.00001 .AND. RunResultsS[8]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[8]:StdNatGasEnergy  + RunResultsS[8]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse9[6]"			Proj:ResultSummary[4]:Enduse9[6]		= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0 .OR. (RunResultsS[9]:StdNatGasEnergy  < 0.00001 .AND. RunResultsS[9]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[9]:StdNatGasEnergy  + RunResultsS[9]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse10[6]"			Proj:ResultSummary[4]:Enduse10[6]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0 .OR. (RunResultsS[10]:StdNatGasEnergy < 0.00001 .AND. RunResultsS[10]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[10]:StdNatGasEnergy + RunResultsS[10]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse11[6]"			Proj:ResultSummary[4]:Enduse11[6]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0 .OR. (RunResultsS[11]:StdNatGasEnergy < 0.00001 .AND. RunResultsS[11]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[11]:StdNatGasEnergy + RunResultsS[11]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse12[6]"			Proj:ResultSummary[4]:Enduse12[6]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0 .OR. (RunResultsS[12]:StdNatGasEnergy < 0.00001 .AND. RunResultsS[12]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[12]:StdNatGasEnergy + RunResultsS[12]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
  ; Standard TDV
	"Set ResultSummary[4]:Title1[7]"				Proj:ResultSummary[4]:Title1[7]		= {	if (EnergyCodeYearNum < 2022) then  "Standard"       else  UNDEFINED        endif  }
	"Set ResultSummary[4]:Title2[7]"				Proj:ResultSummary[4]:Title2[7]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "EDR2"  else  CompMetricLbl_Short + ""  endif endif  }   ; SAC 11/23/22  ; SAC 01/27/23
	"Set ResultSummary[4]:Title3[7]"				Proj:ResultSummary[4]:Title3[7]		= {	if (EnergyCodeYearNum < 2022) then  "(kTDV/ft-yr)"  else if (EnergyCodeYearNum < 2025) then  "(kTDV/ft-yr)"  else  "($/ft)"  endif endif  }
	"Set ResultSummary[4]:Enduse1[7]"			Proj:ResultSummary[4]:Enduse1[7]		= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[1]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse2[7]"			Proj:ResultSummary[4]:Enduse2[7]		= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[2]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse3[7]"			Proj:ResultSummary[4]:Enduse3[7]		= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[3]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse4[7]"			Proj:ResultSummary[4]:Enduse4[7]		= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[4]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse5[7]"			Proj:ResultSummary[4]:Enduse5[7]		= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[5]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse6[7]"			Proj:ResultSummary[4]:Enduse6[7]		= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[6]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse7[7]"			Proj:ResultSummary[4]:Enduse7[7]		= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[7]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse8[7]"			Proj:ResultSummary[4]:Enduse8[7]		= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[8]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse9[7]"			Proj:ResultSummary[4]:Enduse9[7]		= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[9]:StandardTDV  ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse10[7]"			Proj:ResultSummary[4]:Enduse10[7]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[10]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse11[7]"			Proj:ResultSummary[4]:Enduse11[7]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[11]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse12[7]"			Proj:ResultSummary[4]:Enduse12[7]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[12]:StandardTDV ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse13[7]"			Proj:ResultSummary[4]:Enduse13[7]	= {	if (LocalCompAssigned( RunResultsS[13] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsS[13]:StandardTDV = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsS[13]:StandardTDV ), 2 )  endif endif  }
	"Set ResultSummary[4]:Enduse14[7]"			Proj:ResultSummary[4]:Enduse14[7]	= {	if (LocalCompAssigned( RunResultsS[14] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsS[14]:StandardTDV = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsS[14]:StandardTDV ), 2 )  endif endif  }

; mjb-10/16/13	subtract PVCredit from Prop Design - S
	;"Set ResultSummary[4]:Enduse13[4]"			Proj:ResultSummary[4]:Enduse13[4]	= {	FltToStr( (PVCredit[1] * -1), 2 )  }
   ; SAC 10/6/16 - 2019 PV
	"Set ResultSummary[4]:Enduse13[4]"			Proj:ResultSummary[4]:Enduse13[4]	= {	if (EnergyCodeYearNum >= 2019)
                                                                                 then  if (LocalCompAssigned( RunResultsS[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[13]:ProposedTDV ), 2 )  endif
                                                                                 else  if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( (RunResultsS[6]:PropPVCreditTDV[1] * -1), 2 )  endif  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
 	"Set ResultSummary[4]:Enduse10[4]"			Proj:ResultSummary[4]:Enduse10[4]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[10]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse11[4]"			Proj:ResultSummary[4]:Enduse11[4]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[11]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse12[4]"			Proj:ResultSummary[4]:Enduse12[4]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[12]:ProposedTDV[1] ), 2 )  endif  }
  ; SAC 4/17/15 - copy CompResultsMsg down from Proj into EUseSummary (to ensure that it is carried into subsequent models and back to user input)
	"Set ResultSummary[4]:CompResultsMsg"		Proj:ResultSummary[4]:CompResultsMsg	= {	if (GlobalStatus( Proj:CompResultsMsg ) > 0) then  Proj:CompResultsMsg  else  UNCHANGED  endif  }
  ; SAC 3/3/16 - ensure access to PVMinRatedPower in projects following analysis (tic #609)
	"Set ResultSummary[4]:PVMinRatedPower"		Proj:ResultSummary[4]:PVMinRatedPower	= {	if (IfValidAnd( Proj:PVCompCredit > 0 ) .AND. IfValidAnd( Proj:PVCredit[1] > 0 ) .AND. IfValidAnd( Proj:PVMinRatedPower[2] > 0 ))
																														then  Proj:PVMinRatedPower[2]  else  UNCHANGED  endif  }

  ; Compliance Margin TDV
	"Set ResultSummary[4]:Title1[8]"				Proj:ResultSummary[4]:Title1[8]		= {	if (EnergyCodeYearNum < 2022) then  "Compliance"     else if (EnergyCodeYearNum < 2025) then  "Compliance Margins:"  else "Compliance Margins"  endif endif  }   ; SAC 11/24/22
	"Set ResultSummary[4]:Title2[8]"				Proj:ResultSummary[4]:Title2[8]		= {	if (EnergyCodeYearNum < 2022) then  "Margin"         else if (EnergyCodeYearNum < 2025) then  "EDR2"                 else  CompMetricLbl_Short + ""   endif endif  }   ; SAC 01/27/23
	"Set ResultSummary[4]:Title3[8]"				Proj:ResultSummary[4]:Title3[8]		= {	if (EnergyCodeYearNum < 2022) then  "(kTDV/ft-yr)"  else if (EnergyCodeYearNum < 2025) then  "(kTDV/ft-yr)"        else  "($/ft)"  endif endif  }
	"Set ResultSummary[4]:Enduse1[8]"			Proj:ResultSummary[4]:Enduse1[8]		= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[1]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse2[8]"			Proj:ResultSummary[4]:Enduse2[8]		= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[2]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse3[8]"			Proj:ResultSummary[4]:Enduse3[8]		= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[3]:CompMarginTDV  ), 2 )  endif  }	"Set ResultSummary[4]:Enduse3[7]"			Proj:ResultSummary[4]:Enduse3[7]		= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[3]:StandardTDV  ), 2 )  endif  }

	"Set ResultSummary[4]:Enduse4[8]"			Proj:ResultSummary[4]:Enduse4[8]		= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[4]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse5[8]"			Proj:ResultSummary[4]:Enduse5[8]		= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[5]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse14[8]"			Proj:ResultSummary[4]:Enduse14[8]	= {	if (LocalCompAssigned( RunResultsS[14] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[14]:CompMarginTDV ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse6[8]"			Proj:ResultSummary[4]:Enduse6[8]		= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[6]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse7[8]"			Proj:ResultSummary[4]:Enduse7[8]		= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[7]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse8[8]"			Proj:ResultSummary[4]:Enduse8[8]		= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[8]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse9[8]"			Proj:ResultSummary[4]:Enduse9[8]		= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[9]:CompMarginTDV  ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse10[8]"			Proj:ResultSummary[4]:Enduse10[8]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[10]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse11[8]"			Proj:ResultSummary[4]:Enduse11[8]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[11]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse12[8]"			Proj:ResultSummary[4]:Enduse12[8]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[12]:CompMarginTDV ), 2 )  endif  }
   ; SAC 10/6/16 - 2019 PV
 	"Set ResultSummary[4]:Enduse13[8]"			Proj:ResultSummary[4]:Enduse13[8]	= {	if (EnergyCodeYearNum >= 2019)
                                                                                 then  if (LocalCompAssigned( RunResultsS[13] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[13]:CompMarginTDV,     2 )  endif
                                                                                 else  if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[6]:PropPVCreditTDV[1], 2 )  endif  endif  }

	"Adjust Summary SelfUtilizationCredit (SUC) results-S"	   Proj:Action =        ; SAC 07/22/23 (2025)
      {  if (RunAbbrev == "s3") then  EvalRulelist( "CARes_SelfUtilizationCredit_2025_S" )
         else  UNCHANGED  endif  }

  ; Pass/Fail result
 	"Set ResultSummary[4]:MetricPassFail[1] (SLCC-Eff)"   Proj:ResultSummary[4]:MetricPassFail[1] = {	if (EnergyCodeYearNum < 2025 .OR. LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  if (RunResultsS[11]:CompMarginTDV >= 0) then "Pass"  else  "Fail"  endif endif  }  ; SAC 11/22/22 (2025)
 	"Set ResultSummary[4]:MetricPassFail[2] (SLCC-Tot)"   Proj:ResultSummary[4]:MetricPassFail[2] = {	if (EnergyCodeYearNum < 2025 .OR. LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  if (RunResultsS[10]:CompMarginTDV >= 0) then "Pass"  else  "Fail"  endif endif  } 
 	"Set ResultSummary[4]:MetricPassFail[3] (Src-Tot)"    Proj:ResultSummary[4]:MetricPassFail[3] = {	if (EnergyCodeYearNum < 2025 .OR. LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  if (RunResultsS[10]:CompMarginSrc >= 0) then "Pass"  else  "Fail"  endif endif  } 
 	"Set ResultSummary[4]:PassFail"				Proj:ResultSummary[4]:PassFail		= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  if (RunResultsS[11]:CompMarginTDV >= 0) then "PASS"  else  "FAIL"  endif endif  }

  ; Standard Electric Demand
	"Set ResultSummary[4]:Title1[11]"			Proj:ResultSummary[4]:Title1[11]		= {	"Standard"  }
	"Set ResultSummary[4]:Title2[11]"			Proj:ResultSummary[4]:Title2[11]		= {	"Design"  }
	"Set ResultSummary[4]:Title3[11]"			Proj:ResultSummary[4]:Title3[11]		= {	"(kW)"  }
	"Set ResultSummary[4]:Enduse1[11]"			Proj:ResultSummary[4]:Enduse1[11]	= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[1]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse2[11]"			Proj:ResultSummary[4]:Enduse2[11]	= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[2]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse3[11]"			Proj:ResultSummary[4]:Enduse3[11]	= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[3]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse4[11]"			Proj:ResultSummary[4]:Enduse4[11]	= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[4]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse5[11]"			Proj:ResultSummary[4]:Enduse5[11]	= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[5]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse14[11]"			Proj:ResultSummary[4]:Enduse14[11]	= {	if (LocalCompAssigned( RunResultsS[14] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[14]:StdElecDemand ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse6[11]"			Proj:ResultSummary[4]:Enduse6[11]	= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[6]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse7[11]"			Proj:ResultSummary[4]:Enduse7[11]	= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[7]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse8[11]"			Proj:ResultSummary[4]:Enduse8[11]	= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[8]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse9[11]"			Proj:ResultSummary[4]:Enduse9[11]	= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[9]:StdElecDemand  ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse10[11]"			Proj:ResultSummary[4]:Enduse10[11]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[10]:StdElecDemand ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse11[11]"			Proj:ResultSummary[4]:Enduse11[11]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[11]:StdElecDemand ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse12[11]"			Proj:ResultSummary[4]:Enduse12[11]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[12]:StdElecDemand ), 2 )  endif  }

  ; Demand & Energy Use Margins (added w/ CAHP mods 10/8/14)
	"Set ResultSummary[4]:MarginkW[1]"		Proj:ResultSummary[4]:MarginkW[1]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED
																												else  int(((ValidOr( RunResults[10]:StdElecDemand, 0 ) - ValidOr( RunResultsS[10]:PropElecDemand[1], 0 )) * 100) +0.5 ) / 100  endif  }
	"Set ResultSummary[4]:MarginkWh"			Proj:ResultSummary[4]:MarginkWh		= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED
																												else  int((((ValidOr( RunResults[10]:StdElecEnergy, 0 ) - ValidOr( RunResultsS[10]:PropElecEnergy[1], 0 )) * CondFloorArea / 3.413) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[4]:MarginTherms"		Proj:ResultSummary[4]:MarginTherms	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED
																												else  int((((ValidOr( RunResults[10]:StdNatGasEnergy, 0 ) - ValidOr( RunResultsS[10]:PropNatGasEnergy[1], 0 )) * CondFloorArea / 100) * 100) +0.5 ) / 100  endif  }
  ; Additional elec demand storage (SAC 10/7/16)
   "Set ResultSummary[4]:PropElecDemand[1]"  Proj:ResultSummary[4]:PropElecDemand[1]   = {   if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED
																												         else  ValidOr( RunResultsS[10]:PropElecDemand[1], 0 )  endif  }
   "Set ResultSummary[4]:PropElecDemand[2]"  Proj:ResultSummary[4]:PropElecDemand[2]   = {   if (LocalCompAssigned( RunResultsS[10] ) == 0 .OR. LocalStatus( RunResultsS[10]:PropElecDemand[2] ) < 1) then  UNDEFINED
																												         else  ValidOr( RunResultsS[10]:PropElecDemand[2], 0 )  endif  }
   "Set ResultSummary[4]:StdElecDemand"      Proj:ResultSummary[4]:StdElecDemand       = {   if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED
																												         else  ValidOr( RunResults[10]:StdElecDemand, 0 )  endif  }
   "Set ResultSummary[4]:DRtgElecDemand"     Proj:ResultSummary[4]:DRtgElecDemand      = {   if (LocalCompAssigned( RunResultsS[10] ) == 0 .OR. LocalStatus( RunResultsS[10]:DRtgElecDemand ) < 1) then  UNDEFINED
																												         else  ValidOr( RunResultsS[10]:DRtgElecDemand, 0 )  endif  }
	"Set ResultSummary[4]:MarginkW[2]"		   Proj:ResultSummary[4]:MarginkW[2]	      = {	if (LocalCompAssigned( RunResultsS[10] ) == 0 .OR. LocalStatus( ResultSummary[4]:PropElecDemand[2] ) < 1) then  UNDEFINED
																												         else  int(((ResultSummary[4]:DRtgElecDemand - ResultSummary[4]:PropElecDemand[2]) * 100) +0.5 ) / 100  endif  }
  ; Percent Savings values for reporting
	"Set ResultSummary[4]:PctSavingskW"			Proj:ResultSummary[4]:PctSavingskW		= {	if (IfValidAnd( RunResults[10]:StdElecDemand > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[10]:StdElecDemand   - ValidOr( RunResultsS[10]:PropElecDemand[1],   0 )) * 100 / RunResults[10]:StdElecDemand  ) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[4]:PctSavingskWh"		Proj:ResultSummary[4]:PctSavingskWh		= {	if (IfValidAnd( RunResults[10]:StdElecEnergy > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[10]:StdElecEnergy   - ValidOr( RunResultsS[10]:PropElecEnergy[1],   0 )) * 100 / RunResults[10]:StdElecEnergy  ) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[4]:PctSavingsTherms"	Proj:ResultSummary[4]:PctSavingsTherms	= {	if (IfValidAnd( RunResults[10]:StdNatGasEnergy > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[10]:StdNatGasEnergy - ValidOr( RunResultsS[10]:PropNatGasEnergy[1], 0 )) * 100 / RunResults[10]:StdNatGasEnergy) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[4]:PctSavingsTDV"		Proj:ResultSummary[4]:PctSavingsTDV		= {	if (IfValidAnd( RunResults[10]:StandardTDV     > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[10]:StandardTDV     - ValidOr( RunResultsS[10]:ProposedTDV[1],      0 )) * 100 / RunResults[10]:StandardTDV    ) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[4]:PctSavingsCmpTDV"	Proj:ResultSummary[4]:PctSavingsCmpTDV	= {	if (IfValidAnd( RunResults[11]:StandardTDV     > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[11]:StandardTDV     - ValidOr( RunResultsS[11]:ProposedTDV[1],      0 )) * 100 / RunResults[11]:StandardTDV    ) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[4]:PctSavingsSrc"		Proj:ResultSummary[4]:PctSavingsSrc		= {	if (IfValidAnd( RunResults[10]:StandardSrc     > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[10]:StandardSrc     - ValidOr( RunResultsS[10]:ProposedSrc[1],      0 )) * 100 / RunResults[10]:StandardSrc    ) * 10) +0.5 ) / 10  endif  }     ; SAC 11/26/22
	"Set ResultSummary[4]:PctSavkWLbl"			Proj:ResultSummary[4]:PctSavkWLbl		= {	if (IfValidAnd( ResultSummary[4]:PctSavingskW     > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[4]:PctSavingskW     < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[4]:PctSavingskW     )  endif  }
	"Set ResultSummary[4]:PctSavkWhLbl"			Proj:ResultSummary[4]:PctSavkWhLbl		= {	if (IfValidAnd( ResultSummary[4]:PctSavingskWh    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[4]:PctSavingskWh    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[4]:PctSavingskWh    )  endif  }
	"Set ResultSummary[4]:PctSavThermsLbl"		Proj:ResultSummary[4]:PctSavThermsLbl	= {	if (IfValidAnd( ResultSummary[4]:PctSavingsTherms > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[4]:PctSavingsTherms < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[4]:PctSavingsTherms )  endif  }
	"Set ResultSummary[4]:PctSavTDVLbl"			Proj:ResultSummary[4]:PctSavTDVLbl		= {	if (IfValidAnd( ResultSummary[4]:PctSavingsTDV    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[4]:PctSavingsTDV    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[4]:PctSavingsTDV    )  endif  }
	"Set ResultSummary[4]:PctSavCmpTDVLbl"		Proj:ResultSummary[4]:PctSavCmpTDVLbl	= {	if (IfValidAnd( ResultSummary[4]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[4]:PctSavingsCmpTDV < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[4]:PctSavingsCmpTDV )  endif  }
	"Set ResultSummary[4]:PctSavSrcLbl"			Proj:ResultSummary[4]:PctSavSrcLbl		= {	if (IfValidAnd( ResultSummary[4]:PctSavingsSrc    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[4]:PctSavingsSrc    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[4]:PctSavingsSrc    )  endif  }   ; SAC 11/26/22
	; SAC 3/21/16 - added tier results
	; SAC 5/23/16 - modified to require QII (tic #671)
	"Set ResultSummary[4]:MeetsTier1"			Proj:ResultSummary[4]:MeetsTier1		= {	if (StdDesignBase >= 2016 .AND. IfValidAnd( ResultSummary[4]:PctSavingsCmpTDV >= 14.95 ) .AND.
																															IfValidAnd( HERSProj:QII > 0.5 )) then  1  else  0  endif  }
	"Set ResultSummary[4]:MeetsTier2"			Proj:ResultSummary[4]:MeetsTier2		= {	if (StdDesignBase >= 2016 .AND. IfValidAnd( ResultSummary[4]:PctSavingsCmpTDV >= 29.95 ) .AND.
																															IfValidAnd( HERSProj:QII > 0.5 )) then  1  else  0  endif  }

; -- WEST Facing --
  ; Standard Site Electric Use
	"Set ResultSummary[5]:Title1[5]"				Proj:ResultSummary[5]:Title1[5]		= {	if (EnergyCodeYearNum < 2022) then  "Standard"    else if (EnergyCodeYearNum < 2025) then  "Standard Design:"  else  "Standard Design"  endif endif  }
	"Set ResultSummary[5]:Title2[5]"				Proj:ResultSummary[5]:Title2[5]		= {	if (EnergyCodeYearNum < 2022) then  "Design"      else if (EnergyCodeYearNum < 2025) then  "Site"              else  "Site Elec."       endif endif  }
	"Set ResultSummary[5]:Title3[5]"				Proj:ResultSummary[5]:Title3[5]		= {	if (EnergyCodeYearNum < 2022) then  "Site (kWh)"  else  "(kWh/yr)"             endif  }
	"Set ResultSummary[5]:Enduse1[5]"			Proj:ResultSummary[5]:Enduse1[5]		= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0 .OR. RunResultsW[1]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[1]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse2[5]"			Proj:ResultSummary[5]:Enduse2[5]		= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0 .OR. RunResultsW[2]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[2]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse3[5]"			Proj:ResultSummary[5]:Enduse3[5]		= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0 .OR. RunResultsW[3]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[3]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse4[5]"			Proj:ResultSummary[5]:Enduse4[5]		= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0 .OR. RunResultsW[4]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[4]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse5[5]"			Proj:ResultSummary[5]:Enduse5[5]		= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0 .OR. RunResultsW[5]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[5]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse14[5]"			Proj:ResultSummary[5]:Enduse14[5]	= {	if (LocalCompAssigned( RunResultsW[14] ) == 0 .OR. RunResultsW[14]:StdElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[14]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse6[5]"			Proj:ResultSummary[5]:Enduse6[5]		= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0 .OR. RunResultsW[6]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[6]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse7[5]"			Proj:ResultSummary[5]:Enduse7[5]		= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0 .OR. RunResultsW[7]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[7]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse8[5]"			Proj:ResultSummary[5]:Enduse8[5]		= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0 .OR. RunResultsW[8]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[8]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse9[5]"			Proj:ResultSummary[5]:Enduse9[5]		= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0 .OR. RunResultsW[9]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[9]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse10[5]"			Proj:ResultSummary[5]:Enduse10[5]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[10]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse11[5]"			Proj:ResultSummary[5]:Enduse11[5]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0 .OR. RunResultsW[11]:StdElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[11]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse12[5]"			Proj:ResultSummary[5]:Enduse12[5]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0 .OR. RunResultsW[12]:StdElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[12]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse13[5]"			Proj:ResultSummary[5]:Enduse13[5]	= {	if (LocalCompAssigned( RunResultsW[13] ) == 0 .OR. RunResultsW[13]:StdElecEnergy > -0.00001) then  UNDEFINED  ; SAC 1/11/18
																													else  FltToStr( (int( (RunResultsW[13]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
	"Set ResultSummary[5]:Enduse10[2]"			Proj:ResultSummary[5]:Enduse10[2]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsW[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse11[2]"			Proj:ResultSummary[5]:Enduse11[2]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsW[11]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse12[2]"			Proj:ResultSummary[5]:Enduse12[2]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0 .OR. RunResultsW[12]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsW[12]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
  ; Standard Site Natural Gas Use
	"Set ResultSummary[5]:Title1[6]"				Proj:ResultSummary[5]:Title1[6]		= {	if (EnergyCodeYearNum < 2022) then  "Standard"       else  UNDEFINED   endif  }
	"Set ResultSummary[5]:Title2[6]"				Proj:ResultSummary[5]:Title2[6]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "Site"  else  "Site Gas"  endif endif  }
	"Set ResultSummary[5]:Title3[6]"				Proj:ResultSummary[5]:Title3[6]		= {	if (EnergyCodeYearNum < 2022) then  "Site (therms)"  else  "(therms/yr)"  endif  }
	"Set ResultSummary[5]:Enduse1[6]"			Proj:ResultSummary[5]:Enduse1[6]		= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0 .OR. (RunResultsW[1]:StdNatGasEnergy  < 0.00001 .AND. RunResultsW[1]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[1]:StdNatGasEnergy  + RunResultsW[1]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse2[6]"			Proj:ResultSummary[5]:Enduse2[6]		= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0 .OR. (RunResultsW[2]:StdNatGasEnergy  < 0.00001 .AND. RunResultsW[2]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[2]:StdNatGasEnergy  + RunResultsW[2]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse3[6]"			Proj:ResultSummary[5]:Enduse3[6]		= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0 .OR. (RunResultsW[3]:StdNatGasEnergy  < 0.00001 .AND. RunResultsW[3]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[3]:StdNatGasEnergy  + RunResultsW[3]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse4[6]"			Proj:ResultSummary[5]:Enduse4[6]		= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0 .OR. (RunResultsW[4]:StdNatGasEnergy  < 0.00001 .AND. RunResultsW[4]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[4]:StdNatGasEnergy  + RunResultsW[4]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse5[6]"			Proj:ResultSummary[5]:Enduse5[6]		= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0 .OR. (RunResultsW[5]:StdNatGasEnergy  < 0.00001 .AND. RunResultsW[5]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[5]:StdNatGasEnergy  + RunResultsW[5]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse14[6]"			Proj:ResultSummary[5]:Enduse14[6]	= {	if (LocalCompAssigned( RunResultsW[14] ) == 0 .OR. (RunResultsW[14]:StdNatGasEnergy < 0.00001 .AND. RunResultsW[14]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[14]:StdNatGasEnergy + RunResultsW[14]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse6[6]"			Proj:ResultSummary[5]:Enduse6[6]		= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0 .OR. (RunResultsW[6]:StdNatGasEnergy  < 0.00001 .AND. RunResultsW[6]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[6]:StdNatGasEnergy  + RunResultsW[6]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse7[6]"			Proj:ResultSummary[5]:Enduse7[6]		= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0 .OR. (RunResultsW[7]:StdNatGasEnergy  < 0.00001 .AND. RunResultsW[7]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[7]:StdNatGasEnergy  + RunResultsW[7]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse8[6]"			Proj:ResultSummary[5]:Enduse8[6]		= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0 .OR. (RunResultsW[8]:StdNatGasEnergy  < 0.00001 .AND. RunResultsW[8]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[8]:StdNatGasEnergy  + RunResultsW[8]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse9[6]"			Proj:ResultSummary[5]:Enduse9[6]		= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0 .OR. (RunResultsW[9]:StdNatGasEnergy  < 0.00001 .AND. RunResultsW[9]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[9]:StdNatGasEnergy  + RunResultsW[9]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse10[6]"			Proj:ResultSummary[5]:Enduse10[6]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0 .OR. (RunResultsW[10]:StdNatGasEnergy < 0.00001 .AND. RunResultsW[10]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[10]:StdNatGasEnergy + RunResultsW[10]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse11[6]"			Proj:ResultSummary[5]:Enduse11[6]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0 .OR. (RunResultsW[11]:StdNatGasEnergy < 0.00001 .AND. RunResultsW[11]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[11]:StdNatGasEnergy + RunResultsW[11]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse12[6]"			Proj:ResultSummary[5]:Enduse12[6]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0 .OR. (RunResultsW[12]:StdNatGasEnergy < 0.00001 .AND. RunResultsW[12]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[12]:StdNatGasEnergy + RunResultsW[12]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
  ; Standard TDV
	"Set ResultSummary[5]:Title1[7]"				Proj:ResultSummary[5]:Title1[7]		= {	if (EnergyCodeYearNum < 2022) then  "Standard"       else  UNDEFINED        endif  }
	"Set ResultSummary[5]:Title2[7]"				Proj:ResultSummary[5]:Title2[7]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "EDR2"  else  CompMetricLbl_Short + ""  endif endif  }   ; SAC 11/23/22  ; SAC 01/27/23
	"Set ResultSummary[5]:Title3[7]"				Proj:ResultSummary[5]:Title3[7]		= {	if (EnergyCodeYearNum < 2022) then  "(kTDV/ft-yr)"  else if (EnergyCodeYearNum < 2025) then  "(kTDV/ft-yr)"  else  "($/ft)"  endif endif  }
	"Set ResultSummary[5]:Enduse1[7]"			Proj:ResultSummary[5]:Enduse1[7]		= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[1]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse2[7]"			Proj:ResultSummary[5]:Enduse2[7]		= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[2]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse3[7]"			Proj:ResultSummary[5]:Enduse3[7]		= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[3]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse4[7]"			Proj:ResultSummary[5]:Enduse4[7]		= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[4]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse5[7]"			Proj:ResultSummary[5]:Enduse5[7]		= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[5]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse6[7]"			Proj:ResultSummary[5]:Enduse6[7]		= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[6]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse7[7]"			Proj:ResultSummary[5]:Enduse7[7]		= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[7]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse8[7]"			Proj:ResultSummary[5]:Enduse8[7]		= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[8]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse9[7]"			Proj:ResultSummary[5]:Enduse9[7]		= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[9]:StandardTDV  ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse10[7]"			Proj:ResultSummary[5]:Enduse10[7]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[10]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse11[7]"			Proj:ResultSummary[5]:Enduse11[7]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[11]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse12[7]"			Proj:ResultSummary[5]:Enduse12[7]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[12]:StandardTDV ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse13[7]"			Proj:ResultSummary[5]:Enduse13[7]	= {	if (LocalCompAssigned( RunResultsW[13] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsW[13]:StandardTDV = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsW[13]:StandardTDV ), 2 )  endif endif  }
	"Set ResultSummary[5]:Enduse14[7]"			Proj:ResultSummary[5]:Enduse14[7]	= {	if (LocalCompAssigned( RunResultsW[14] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsW[14]:StandardTDV = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsW[14]:StandardTDV ), 2 )  endif endif  }

; mjb-10/16/13	subtract PVCredit from Prop Design - W
	;"Set ResultSummary[5]:Enduse13[4]"			Proj:ResultSummary[5]:Enduse13[4]	= {	FltToStr( (PVCredit[1] * -1), 2 )  }
   ; SAC 10/6/16 - 2019 PV
	"Set ResultSummary[5]:Enduse13[4]"			Proj:ResultSummary[5]:Enduse13[4]	= {	if (EnergyCodeYearNum >= 2019)
                                                                                 then  if (LocalCompAssigned( RunResultsW[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[13]:ProposedTDV ), 2 )  endif
                                                                                 else  if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( (RunResultsW[6]:PropPVCreditTDV[1] * -1), 2 )  endif  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
 	"Set ResultSummary[5]:Enduse10[4]"			Proj:ResultSummary[5]:Enduse10[4]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[10]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse11[4]"			Proj:ResultSummary[5]:Enduse11[4]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[11]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse12[4]"			Proj:ResultSummary[5]:Enduse12[4]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[12]:ProposedTDV[1] ), 2 )  endif  }
  ; SAC 4/17/15 - copy CompResultsMsg down from Proj into EUseSummary (to ensure that it is carried into subsequent models and back to user input)
	"Set ResultSummary[5]:CompResultsMsg"		Proj:ResultSummary[5]:CompResultsMsg	= {	if (GlobalStatus( Proj:CompResultsMsg ) > 0) then  Proj:CompResultsMsg  else  UNCHANGED  endif  }
  ; SAC 3/3/16 - ensure access to PVMinRatedPower in projects following analysis (tic #609)
	"Set ResultSummary[5]:PVMinRatedPower"		Proj:ResultSummary[5]:PVMinRatedPower	= {	if (IfValidAnd( Proj:PVCompCredit > 0 ) .AND. IfValidAnd( Proj:PVCredit[1] > 0 ) .AND. IfValidAnd( Proj:PVMinRatedPower[2] > 0 ))
																														then  Proj:PVMinRatedPower[2]  else  UNCHANGED  endif  }

  ; Compliance Margin TDV
	"Set ResultSummary[5]:Title1[8]"				Proj:ResultSummary[5]:Title1[8]		= {	if (EnergyCodeYearNum < 2022) then  "Compliance"     else if (EnergyCodeYearNum < 2025) then  "Compliance Margins:"  else "Compliance Margins"  endif endif  }   ; SAC 11/24/22
	"Set ResultSummary[5]:Title2[8]"				Proj:ResultSummary[5]:Title2[8]		= {	if (EnergyCodeYearNum < 2022) then  "Margin"         else if (EnergyCodeYearNum < 2025) then  "EDR2"                 else  CompMetricLbl_Short + ""   endif endif  }   ; SAC 01/27/23
	"Set ResultSummary[5]:Title3[8]"				Proj:ResultSummary[5]:Title3[8]		= {	if (EnergyCodeYearNum < 2022) then  "(kTDV/ft-yr)"  else if (EnergyCodeYearNum < 2025) then  "(kTDV/ft-yr)"        else  "($/ft)"  endif endif  }
	"Set ResultSummary[5]:Enduse1[8]"			Proj:ResultSummary[5]:Enduse1[8]		= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[1]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse2[8]"			Proj:ResultSummary[5]:Enduse2[8]		= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[2]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse3[8]"			Proj:ResultSummary[5]:Enduse3[8]		= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[3]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse4[8]"			Proj:ResultSummary[5]:Enduse4[8]		= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[4]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse5[8]"			Proj:ResultSummary[5]:Enduse5[8]		= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[5]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse14[8]"			Proj:ResultSummary[5]:Enduse14[8]	= {	if (LocalCompAssigned( RunResultsW[14] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[14]:CompMarginTDV ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse6[8]"			Proj:ResultSummary[5]:Enduse6[8]		= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[6]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse7[8]"			Proj:ResultSummary[5]:Enduse7[8]		= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[7]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse8[8]"			Proj:ResultSummary[5]:Enduse8[8]		= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[8]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse9[8]"			Proj:ResultSummary[5]:Enduse9[8]		= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[9]:CompMarginTDV  ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse10[8]"			Proj:ResultSummary[5]:Enduse10[8]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[10]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse11[8]"			Proj:ResultSummary[5]:Enduse11[8]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[11]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse12[8]"			Proj:ResultSummary[5]:Enduse12[8]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[12]:CompMarginTDV ), 2 )  endif  }
   ; SAC 10/6/16 - 2019 PV
 	"Set ResultSummary[5]:Enduse13[8]"			Proj:ResultSummary[5]:Enduse13[8]	= {	if (EnergyCodeYearNum >= 2019)
                                                                                 then  if (LocalCompAssigned( RunResultsW[13] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[13]:CompMarginTDV,     2 )  endif
                                                                                 else  if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[6]:PropPVCreditTDV[1], 2 )  endif  endif  }

	"Adjust Summary SelfUtilizationCredit (SUC) results-W"	   Proj:Action =        ; SAC 07/22/23 (2025)
      {  if (RunAbbrev == "s3") then  EvalRulelist( "CARes_SelfUtilizationCredit_2025_W" )
         else  UNCHANGED  endif  }

  ; Pass/Fail result
 	"Set ResultSummary[5]:MetricPassFail[1] (SLCC-Eff)"   Proj:ResultSummary[5]:MetricPassFail[1] = {	if (EnergyCodeYearNum < 2025 .OR. LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  if (RunResultsW[11]:CompMarginTDV >= 0) then "Pass"  else  "Fail"  endif endif  }  ; SAC 11/22/22 (2025)
 	"Set ResultSummary[5]:MetricPassFail[2] (SLCC-Tot)"   Proj:ResultSummary[5]:MetricPassFail[2] = {	if (EnergyCodeYearNum < 2025 .OR. LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  if (RunResultsW[10]:CompMarginTDV >= 0) then "Pass"  else  "Fail"  endif endif  } 
 	"Set ResultSummary[5]:MetricPassFail[3] (Src-Tot)"    Proj:ResultSummary[5]:MetricPassFail[3] = {	if (EnergyCodeYearNum < 2025 .OR. LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  if (RunResultsW[10]:CompMarginSrc >= 0) then "Pass"  else  "Fail"  endif endif  } 
 	"Set ResultSummary[5]:PassFail"				Proj:ResultSummary[5]:PassFail		= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  if (RunResultsW[11]:CompMarginTDV >= 0) then "PASS"  else  "FAIL"  endif endif  }

  ; Standard Electric Demand
	"Set ResultSummary[5]:Title1[11]"			Proj:ResultSummary[5]:Title1[11]		= {	"Standard"  }
	"Set ResultSummary[5]:Title2[11]"			Proj:ResultSummary[5]:Title2[11]		= {	"Design"  }
	"Set ResultSummary[5]:Title3[11]"			Proj:ResultSummary[5]:Title3[11]		= {	"(kW)"  }
	"Set ResultSummary[5]:Enduse1[11]"			Proj:ResultSummary[5]:Enduse1[11]	= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[1]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse2[11]"			Proj:ResultSummary[5]:Enduse2[11]	= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[2]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse3[11]"			Proj:ResultSummary[5]:Enduse3[11]	= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[3]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse4[11]"			Proj:ResultSummary[5]:Enduse4[11]	= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[4]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse5[11]"			Proj:ResultSummary[5]:Enduse5[11]	= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[5]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse14[11]"			Proj:ResultSummary[5]:Enduse14[11]	= {	if (LocalCompAssigned( RunResultsW[14] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[14]:StdElecDemand ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse6[11]"			Proj:ResultSummary[5]:Enduse6[11]	= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[6]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse7[11]"			Proj:ResultSummary[5]:Enduse7[11]	= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[7]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse8[11]"			Proj:ResultSummary[5]:Enduse8[11]	= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[8]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse9[11]"			Proj:ResultSummary[5]:Enduse9[11]	= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[9]:StdElecDemand  ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse10[11]"			Proj:ResultSummary[5]:Enduse10[11]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[10]:StdElecDemand ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse11[11]"			Proj:ResultSummary[5]:Enduse11[11]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[11]:StdElecDemand ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse12[11]"			Proj:ResultSummary[5]:Enduse12[11]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[12]:StdElecDemand ), 2 )  endif  }

  ; Demand & Energy Use Margins (added w/ CAHP mods 10/8/14)
	"Set ResultSummary[5]:MarginkW[1]"		Proj:ResultSummary[5]:MarginkW[1]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED
																												else  int(((ValidOr( RunResultsW[10]:StdElecDemand, 0 ) - ValidOr( RunResultsW[10]:PropElecDemand[1], 0 )) * 100) +0.5 ) / 100  endif  }
	"Set ResultSummary[5]:MarginkWh"			Proj:ResultSummary[5]:MarginkWh		= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED
																												else  int((((ValidOr( RunResultsW[10]:StdElecEnergy, 0 ) - ValidOr( RunResultsW[10]:PropElecEnergy[1], 0 )) * CondFloorArea / 3.413) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[5]:MarginTherms"		Proj:ResultSummary[5]:MarginTherms	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED
																												else  int((((ValidOr( RunResultsW[10]:StdNatGasEnergy, 0 ) - ValidOr( RunResultsW[10]:PropNatGasEnergy[1], 0 )) * CondFloorArea / 100) * 100) +0.5 ) / 100  endif  }
  ; Additional elec demand storage (SAC 10/7/16)
   "Set ResultSummary[5]:PropElecDemand[1]"  Proj:ResultSummary[5]:PropElecDemand[1]   = {   if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED
																												         else  ValidOr( RunResultsW[10]:PropElecDemand[1], 0 )  endif  }
   "Set ResultSummary[5]:PropElecDemand[2]"  Proj:ResultSummary[5]:PropElecDemand[2]   = {   if (LocalCompAssigned( RunResultsW[10] ) == 0 .OR. LocalStatus( RunResultsW[10]:PropElecDemand[2] ) < 1) then  UNDEFINED
																												         else  ValidOr( RunResultsW[10]:PropElecDemand[2], 0 )  endif  }
   "Set ResultSummary[5]:StdElecDemand"      Proj:ResultSummary[5]:StdElecDemand       = {   if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED
																												         else  ValidOr( RunResults[10]:StdElecDemand, 0 )  endif  }
   "Set ResultSummary[5]:DRtgElecDemand"     Proj:ResultSummary[5]:DRtgElecDemand      = {   if (LocalCompAssigned( RunResultsW[10] ) == 0 .OR. LocalStatus( RunResultsW[10]:DRtgElecDemand ) < 1) then  UNDEFINED
																												         else  ValidOr( RunResultsW[10]:DRtgElecDemand, 0 )  endif  }
	"Set ResultSummary[5]:MarginkW[2]"		   Proj:ResultSummary[5]:MarginkW[2]	      = {	if (LocalCompAssigned( RunResultsW[10] ) == 0 .OR. LocalStatus( ResultSummary[5]:PropElecDemand[2] ) < 1) then  UNDEFINED
																												         else  int(((ResultSummary[5]:DRtgElecDemand - ResultSummary[5]:PropElecDemand[2]) * 100) +0.5 ) / 100  endif  }
  ; Percent Savings values for reporting
	"Set ResultSummary[5]:PctSavingskW"			Proj:ResultSummary[5]:PctSavingskW		= {	if (IfValidAnd( RunResultsW[10]:StdElecDemand > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResultsW[10]:StdElecDemand   - ValidOr( RunResultsW[10]:PropElecDemand[1],   0 )) * 100 / RunResultsW[10]:StdElecDemand  ) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[5]:PctSavingskWh"		Proj:ResultSummary[5]:PctSavingskWh		= {	if (IfValidAnd( RunResultsW[10]:StdElecEnergy > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResultsW[10]:StdElecEnergy   - ValidOr( RunResultsW[10]:PropElecEnergy[1],   0 )) * 100 / RunResultsW[10]:StdElecEnergy  ) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[5]:PctSavingsTherms"	Proj:ResultSummary[5]:PctSavingsTherms	= {	if (IfValidAnd( RunResultsW[10]:StdNatGasEnergy > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResultsW[10]:StdNatGasEnergy - ValidOr( RunResultsW[10]:PropNatGasEnergy[1], 0 )) * 100 / RunResultsW[10]:StdNatGasEnergy) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[5]:PctSavingsTDV"		Proj:ResultSummary[5]:PctSavingsTDV		= {	if (IfValidAnd( RunResultsW[10]:StandardTDV     > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResultsW[10]:StandardTDV     - ValidOr( RunResultsW[10]:ProposedTDV[1],      0 )) * 100 / RunResultsW[10]:StandardTDV    ) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[5]:PctSavingsCmpTDV"	Proj:ResultSummary[5]:PctSavingsCmpTDV	= {	if (IfValidAnd( RunResultsW[11]:StandardTDV     > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResultsW[11]:StandardTDV     - ValidOr( RunResultsW[11]:ProposedTDV[1],      0 )) * 100 / RunResultsW[11]:StandardTDV    ) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[5]:PctSavingsSrc"		Proj:ResultSummary[5]:PctSavingsSrc		= {	if (IfValidAnd( RunResultsW[10]:StandardSrc     > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResultsW[10]:StandardSrc     - ValidOr( RunResultsW[10]:ProposedSrc[1],      0 )) * 100 / RunResultsW[10]:StandardSrc    ) * 10) +0.5 ) / 10  endif  }     ; SAC 11/26/22
	"Set ResultSummary[5]:PctSavkWLbl"			Proj:ResultSummary[5]:PctSavkWLbl		= {	if (IfValidAnd( ResultSummary[5]:PctSavingskW     > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[5]:PctSavingskW     < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[5]:PctSavingskW     )  endif  }
	"Set ResultSummary[5]:PctSavkWhLbl"			Proj:ResultSummary[5]:PctSavkWhLbl		= {	if (IfValidAnd( ResultSummary[5]:PctSavingskWh    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[5]:PctSavingskWh    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[5]:PctSavingskWh    )  endif  }
	"Set ResultSummary[5]:PctSavThermsLbl"		Proj:ResultSummary[5]:PctSavThermsLbl	= {	if (IfValidAnd( ResultSummary[5]:PctSavingsTherms > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[5]:PctSavingsTherms < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[5]:PctSavingsTherms )  endif  }
	"Set ResultSummary[5]:PctSavTDVLbl"			Proj:ResultSummary[5]:PctSavTDVLbl		= {	if (IfValidAnd( ResultSummary[5]:PctSavingsTDV    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[5]:PctSavingsTDV    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[5]:PctSavingsTDV    )  endif  }
	"Set ResultSummary[5]:PctSavCmpTDVLbl"		Proj:ResultSummary[5]:PctSavCmpTDVLbl	= {	if (IfValidAnd( ResultSummary[5]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[5]:PctSavingsCmpTDV < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[5]:PctSavingsCmpTDV )  endif  }
	"Set ResultSummary[5]:PctSavSrcLbl"			Proj:ResultSummary[5]:PctSavSrcLbl		= {	if (IfValidAnd( ResultSummary[5]:PctSavingsSrc    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[5]:PctSavingsSrc    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[5]:PctSavingsSrc    )  endif  }   ; SAC 11/26/22
	; SAC 3/21/16 - added tier results
	; SAC 5/23/16 - modified to require QII (tic #671)
	"Set ResultSummary[5]:MeetsTier1"			Proj:ResultSummary[5]:MeetsTier1		= {	if (StdDesignBase >= 2016 .AND. IfValidAnd( ResultSummary[5]:PctSavingsCmpTDV >= 14.95 ) .AND.
																															IfValidAnd( HERSProj:QII > 0.5 )) then  1  else  0  endif  }
	"Set ResultSummary[5]:MeetsTier2"			Proj:ResultSummary[5]:MeetsTier2		= {	if (StdDesignBase >= 2016 .AND. IfValidAnd( ResultSummary[5]:PctSavingsCmpTDV >= 29.95 ) .AND.
																															IfValidAnd( HERSProj:QII > 0.5 )) then  1  else  0  endif  }

         ; SAC 12/02/20 - add in PV export results (primarily for 2022 research)
   "Set Proj:ResultSummary[2]:StdPV_Total kWh"        Proj:ResultSummary[2]:StdPV_Total     =
      {  -1 * ValidOr( RunResultsN[13]:StdElecEnergy[1], 0 ) * CondFloorArea / 3.412  }
   "Set Proj:ResultSummary[2]:StdPV_Export kWh"       Proj:ResultSummary[2]:StdPV_Export    =
      {  if (IfValidAnd( ResultSummary[2]:StdPV_Total > 0 )==0) then  0
         else  -1 * ApplyHourlyResultMultipliers_Neg( "none", "none", 1, 1, "none", 0, 0, "Standard", "MtrElec", "Tot" ) / 3.412
         endif  }
   "Set Proj:ResultSummary[2]:StdPV_PctExport %"      Proj:ResultSummary[2]:StdPV_PctExport =
      {  if (IfValidAnd( ResultSummary[2]:StdPV_Export > 0 )==0) then  0
         else  ResultSummary[2]:StdPV_Export * 100 / ResultSummary[2]:StdPV_Total  endif  }
   "Set Proj:ResultSummary[3]:StdPV_Total kWh"        Proj:ResultSummary[3]:StdPV_Total     = {  ResultSummary[2]:StdPV_Total      }
   "Set Proj:ResultSummary[3]:StdPV_Export kWh"       Proj:ResultSummary[3]:StdPV_Export    = {  ResultSummary[2]:StdPV_Export     }
   "Set Proj:ResultSummary[3]:StdPV_PctExport %"      Proj:ResultSummary[3]:StdPV_PctExport = {  ResultSummary[2]:StdPV_PctExport  }
   "Set Proj:ResultSummary[4]:StdPV_Total kWh"        Proj:ResultSummary[4]:StdPV_Total     = {  ResultSummary[2]:StdPV_Total      }
   "Set Proj:ResultSummary[4]:StdPV_Export kWh"       Proj:ResultSummary[4]:StdPV_Export    = {  ResultSummary[2]:StdPV_Export     }
   "Set Proj:ResultSummary[4]:StdPV_PctExport %"      Proj:ResultSummary[4]:StdPV_PctExport = {  ResultSummary[2]:StdPV_PctExport  }
   "Set Proj:ResultSummary[5]:StdPV_Total kWh"        Proj:ResultSummary[5]:StdPV_Total     = {  ResultSummary[2]:StdPV_Total      }
   "Set Proj:ResultSummary[5]:StdPV_Export kWh"       Proj:ResultSummary[5]:StdPV_Export    = {  ResultSummary[2]:StdPV_Export     }
   "Set Proj:ResultSummary[5]:StdPV_PctExport %"      Proj:ResultSummary[5]:StdPV_PctExport = {  ResultSummary[2]:StdPV_PctExport  }

END

;*************************************************************************
RULELIST "CARes_StandardSummary_PVonly_NESW" 1 0 1 1
;*************************************************************************

	; can call generic StandardSummary rulelist to set worst case Standard summary data
	"Call subordinate rulelist to set worst case Standard summary"		Proj:Action = {	EvalRulelist( "CARes_StandardSummary_PVonly" )  }

; -- NORTH Facing --
  ; Standard TDV
 	"Set ResultSummary[2]:Enduse10[7]"			Proj:ResultSummary[2]:Enduse10[7]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[10]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse11[7]"			Proj:ResultSummary[2]:Enduse11[7]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[11]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse12[7]"			Proj:ResultSummary[2]:Enduse12[7]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[12]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse13[7]"			Proj:ResultSummary[2]:Enduse13[7]	= {	if (LocalCompAssigned( RunResultsN[13] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsN[13]:StandardTDV = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsN[13]:StandardTDV ), 2 )  endif endif  }
	"Set ResultSummary[2]:Enduse14[7]"			Proj:ResultSummary[2]:Enduse14[7]	= {	if (LocalCompAssigned( RunResultsN[14] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsN[14]:StandardTDV = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsN[14]:StandardTDV ), 2 )  endif endif  }

  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
 	"Set ResultSummary[2]:Enduse10[4]"			Proj:ResultSummary[2]:Enduse10[4]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[10]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse11[4]"			Proj:ResultSummary[2]:Enduse11[4]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[11]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse12[4]"			Proj:ResultSummary[2]:Enduse12[4]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[12]:ProposedTDV[1] ), 2 )  endif  }
  ; SAC 4/17/15 - copy CompResultsMsg down from Proj into EUseSummary (to ensure that it is carried into subsequent models and back to user input)
	"Set ResultSummary[2]:CompResultsMsg"		Proj:ResultSummary[2]:CompResultsMsg	= {	if (GlobalStatus( Proj:CompResultsMsg ) > 0) then  Proj:CompResultsMsg  else  UNCHANGED  endif  }
  ; SAC 3/3/16 - ensure access to PVMinRatedPower in projects following analysis (tic #609)
	"Set ResultSummary[2]:PVMinRatedPower"		Proj:ResultSummary[2]:PVMinRatedPower	= {	if (IfValidAnd( Proj:PVCompCredit > 0 ) .AND. IfValidAnd( Proj:PVCredit[1] > 0 ) .AND. IfValidAnd( Proj:PVMinRatedPower[2] > 0 ))
																														then  Proj:PVMinRatedPower[2]  else  UNCHANGED  endif  }

  ; Compliance Margin TDV
	"Set ResultSummary[2]:Enduse14[8]"			Proj:ResultSummary[2]:Enduse14[8]	= {	if (LocalCompAssigned( RunResultsN[14] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[14]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse10[8]"			Proj:ResultSummary[2]:Enduse10[8]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[10]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse11[8]"			Proj:ResultSummary[2]:Enduse11[8]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[11]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse12[8]"			Proj:ResultSummary[2]:Enduse12[8]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[12]:CompMarginTDV ), 2 )  endif  }
   ; SAC 10/6/16 - 2019 PV
 	"Set ResultSummary[2]:Enduse13[8]"			Proj:ResultSummary[2]:Enduse13[8]	= {	if (EnergyCodeYearNum >= 2019)
                                                                                 then  if (LocalCompAssigned( RunResultsN[13] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[13]:CompMarginTDV,     2 )  endif
                                                                                 else  if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[6]:PropPVCreditTDV[1], 2 )  endif  endif  }
  ; Pass/Fail result
 	"Set ResultSummary[2]:MetricPassFail[1] (SLCC-Eff)"   Proj:ResultSummary[2]:MetricPassFail[1] = {	if (EnergyCodeYearNum < 2025 .OR. LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  if (RunResultsN[11]:CompMarginTDV >= 0) then "Pass"  else  "Fail"  endif endif  }  ; SAC 11/22/22 (2025)
 	"Set ResultSummary[2]:MetricPassFail[2] (SLCC-Tot)"   Proj:ResultSummary[2]:MetricPassFail[2] = {	if (EnergyCodeYearNum < 2025 .OR. LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  if (RunResultsN[10]:CompMarginTDV >= 0) then "Pass"  else  "Fail"  endif endif  } 
 	"Set ResultSummary[2]:MetricPassFail[3] (Src-Tot)"    Proj:ResultSummary[2]:MetricPassFail[3] = {	if (EnergyCodeYearNum < 2025 .OR. LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  if (RunResultsN[10]:CompMarginSrc >= 0) then "Pass"  else  "Fail"  endif endif  } 
 	"Set ResultSummary[2]:PassFail"				Proj:ResultSummary[2]:PassFail		= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  if (RunResultsN[11]:CompMarginTDV >= 0) then "PASS"  else  "FAIL"  endif endif  }

  ; Percent Savings values for reporting
	"Set ResultSummary[2]:PctSavingsTDV"		Proj:ResultSummary[2]:PctSavingsTDV		= {	if (IfValidAnd( RunResults[10]:StandardTDV     > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[10]:StandardTDV     - ValidOr( RunResultsN[10]:ProposedTDV[1],      0 )) * 100 / RunResults[10]:StandardTDV    ) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[2]:PctSavingsCmpTDV"	Proj:ResultSummary[2]:PctSavingsCmpTDV	= {	if (IfValidAnd( RunResults[11]:StandardTDV     > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[11]:StandardTDV     - ValidOr( RunResultsN[11]:ProposedTDV[1],      0 )) * 100 / RunResults[11]:StandardTDV    ) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[2]:PctSavTDVLbl"			Proj:ResultSummary[2]:PctSavTDVLbl		= {	if (IfValidAnd( ResultSummary[2]:PctSavingsTDV    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[2]:PctSavingsTDV    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[2]:PctSavingsTDV    )  endif  }
	"Set ResultSummary[2]:PctSavCmpTDVLbl"		Proj:ResultSummary[2]:PctSavCmpTDVLbl	= {	if (IfValidAnd( ResultSummary[2]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[2]:PctSavingsCmpTDV < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[2]:PctSavingsCmpTDV )  endif  }
	; SAC 3/21/16 - added tier results
	; SAC 5/23/16 - modified to require QII (tic #671)
	"Set ResultSummary[2]:MeetsTier1"			Proj:ResultSummary[2]:MeetsTier1		= {	if (StdDesignBase >= 2016 .AND. IfValidAnd( ResultSummary[2]:PctSavingsCmpTDV >= 14.95 ) .AND.
																															IfValidAnd( HERSProj:QII > 0.5 )) then  1  else  0  endif  }
	"Set ResultSummary[2]:MeetsTier2"			Proj:ResultSummary[2]:MeetsTier2		= {	if (StdDesignBase >= 2016 .AND. IfValidAnd( ResultSummary[2]:PctSavingsCmpTDV >= 29.95 ) .AND.
																															IfValidAnd( HERSProj:QII > 0.5 )) then  1  else  0  endif  }

; -- EAST Facing --
  ; Standard TDV
 	"Set ResultSummary[3]:Enduse10[7]"			Proj:ResultSummary[3]:Enduse10[7]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[10]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse11[7]"			Proj:ResultSummary[3]:Enduse11[7]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[11]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse12[7]"			Proj:ResultSummary[3]:Enduse12[7]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[12]:StandardTDV ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse13[7]"			Proj:ResultSummary[3]:Enduse13[7]	= {	if (LocalCompAssigned( RunResultsE[13] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsE[13]:StandardTDV = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsE[13]:StandardTDV ), 2 )  endif endif  }
	"Set ResultSummary[3]:Enduse14[7]"			Proj:ResultSummary[3]:Enduse14[7]	= {	if (LocalCompAssigned( RunResultsE[14] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsE[14]:StandardTDV = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsE[14]:StandardTDV ), 2 )  endif endif  }

; mjb-10/16/13	subtract PVCredit from Prop Design - E
	;"Set ResultSummary[3]:Enduse13[4]"			Proj:ResultSummary[3]:Enduse13[4]	= {	FltToStr( (PVCredit[1] * -1), 2 )  }
   ; SAC 10/6/16 - 2019 PV
	"Set ResultSummary[3]:Enduse13[4]"			Proj:ResultSummary[3]:Enduse13[4]	= {	if (EnergyCodeYearNum >= 2019)
                                                                                 then  if (LocalCompAssigned( RunResultsE[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[13]:ProposedTDV ), 2 )  endif
                                                                                 else  if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( (RunResultsE[6]:PropPVCreditTDV[1] * -1), 2 )  endif  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
 	"Set ResultSummary[3]:Enduse10[4]"			Proj:ResultSummary[3]:Enduse10[4]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[10]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse11[4]"			Proj:ResultSummary[3]:Enduse11[4]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[11]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse12[4]"			Proj:ResultSummary[3]:Enduse12[4]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[12]:ProposedTDV[1] ), 2 )  endif  }
  ; SAC 4/17/15 - copy CompResultsMsg down from Proj into EUseSummary (to ensure that it is carried into subsequent models and back to user input)
	"Set ResultSummary[3]:CompResultsMsg"		Proj:ResultSummary[3]:CompResultsMsg	= {	if (GlobalStatus( Proj:CompResultsMsg ) > 0) then  Proj:CompResultsMsg  else  UNCHANGED  endif  }
  ; SAC 3/3/16 - ensure access to PVMinRatedPower in projects following analysis (tic #609)
	"Set ResultSummary[3]:PVMinRatedPower"		Proj:ResultSummary[3]:PVMinRatedPower	= {	if (IfValidAnd( Proj:PVCompCredit > 0 ) .AND. IfValidAnd( Proj:PVCredit[1] > 0 ) .AND. IfValidAnd( Proj:PVMinRatedPower[2] > 0 ))
																														then  Proj:PVMinRatedPower[2]  else  UNCHANGED  endif  }

  ; Compliance Margin TDV
	"Set ResultSummary[3]:Enduse14[8]"			Proj:ResultSummary[3]:Enduse14[8]	= {	if (LocalCompAssigned( RunResultsE[14] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[14]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse10[8]"			Proj:ResultSummary[3]:Enduse10[8]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[10]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse11[8]"			Proj:ResultSummary[3]:Enduse11[8]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[11]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse12[8]"			Proj:ResultSummary[3]:Enduse12[8]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[12]:CompMarginTDV ), 2 )  endif  }
   ; SAC 10/6/16 - 2019 PV
 	"Set ResultSummary[3]:Enduse13[8]"			Proj:ResultSummary[3]:Enduse13[8]	= {	if (EnergyCodeYearNum >= 2019)
                                                                                 then  if (LocalCompAssigned( RunResultsE[13] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[13]:CompMarginTDV,     2 )  endif
                                                                                 else  if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[6]:PropPVCreditTDV[1], 2 )  endif  endif  }
  ; Pass/Fail result
 	"Set ResultSummary[3]:MetricPassFail[1] (SLCC-Eff)"   Proj:ResultSummary[3]:MetricPassFail[1] = {	if (EnergyCodeYearNum < 2025 .OR. LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  if (RunResultsE[11]:CompMarginTDV >= 0) then "Pass"  else  "Fail"  endif endif  }  ; SAC 11/22/22 (2025)
 	"Set ResultSummary[3]:MetricPassFail[2] (SLCC-Tot)"   Proj:ResultSummary[3]:MetricPassFail[2] = {	if (EnergyCodeYearNum < 2025 .OR. LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  if (RunResultsE[10]:CompMarginTDV >= 0) then "Pass"  else  "Fail"  endif endif  } 
 	"Set ResultSummary[3]:MetricPassFail[3] (Src-Tot)"    Proj:ResultSummary[3]:MetricPassFail[3] = {	if (EnergyCodeYearNum < 2025 .OR. LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  if (RunResultsE[10]:CompMarginSrc >= 0) then "Pass"  else  "Fail"  endif endif  } 
 	"Set ResultSummary[3]:PassFail"				Proj:ResultSummary[3]:PassFail		= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  if (RunResultsE[11]:CompMarginTDV >= 0) then "PASS"  else  "FAIL"  endif endif  }

  ; Percent Savings values for reporting
	"Set ResultSummary[3]:PctSavingsTDV"		Proj:ResultSummary[3]:PctSavingsTDV		= {	if (IfValidAnd( RunResults[10]:StandardTDV     > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[10]:StandardTDV     - ValidOr( RunResultsE[10]:ProposedTDV[1],      0 )) * 100 / RunResults[10]:StandardTDV    ) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[3]:PctSavingsCmpTDV"	Proj:ResultSummary[3]:PctSavingsCmpTDV	= {	if (IfValidAnd( RunResults[11]:StandardTDV     > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[11]:StandardTDV     - ValidOr( RunResultsE[11]:ProposedTDV[1],      0 )) * 100 / RunResults[11]:StandardTDV    ) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[3]:PctSavTDVLbl"			Proj:ResultSummary[3]:PctSavTDVLbl		= {	if (IfValidAnd( ResultSummary[3]:PctSavingsTDV    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[3]:PctSavingsTDV    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[3]:PctSavingsTDV    )  endif  }
	"Set ResultSummary[3]:PctSavCmpTDVLbl"		Proj:ResultSummary[3]:PctSavCmpTDVLbl	= {	if (IfValidAnd( ResultSummary[3]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[3]:PctSavingsCmpTDV < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[3]:PctSavingsCmpTDV )  endif  }
	; SAC 3/21/16 - added tier results
	; SAC 5/23/16 - modified to require QII (tic #671)
	"Set ResultSummary[3]:MeetsTier1"			Proj:ResultSummary[3]:MeetsTier1		= {	if (StdDesignBase >= 2016 .AND. IfValidAnd( ResultSummary[3]:PctSavingsCmpTDV >= 14.95 ) .AND.
																															IfValidAnd( HERSProj:QII > 0.5 )) then  1  else  0  endif  }
	"Set ResultSummary[3]:MeetsTier2"			Proj:ResultSummary[3]:MeetsTier2		= {	if (StdDesignBase >= 2016 .AND. IfValidAnd( ResultSummary[3]:PctSavingsCmpTDV >= 29.95 ) .AND.
																															IfValidAnd( HERSProj:QII > 0.5 )) then  1  else  0  endif  }

; -- SOUTH Facing --
  ; Standard TDV
 	"Set ResultSummary[4]:Enduse10[7]"			Proj:ResultSummary[4]:Enduse10[7]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[10]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse11[7]"			Proj:ResultSummary[4]:Enduse11[7]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[11]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse12[7]"			Proj:ResultSummary[4]:Enduse12[7]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[12]:StandardTDV ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse13[7]"			Proj:ResultSummary[4]:Enduse13[7]	= {	if (LocalCompAssigned( RunResultsS[13] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsS[13]:StandardTDV = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsS[13]:StandardTDV ), 2 )  endif endif  }
	"Set ResultSummary[4]:Enduse14[7]"			Proj:ResultSummary[4]:Enduse14[7]	= {	if (LocalCompAssigned( RunResultsS[14] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsS[14]:StandardTDV = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsS[14]:StandardTDV ), 2 )  endif endif  }

; mjb-10/16/13	subtract PVCredit from Prop Design - S
	;"Set ResultSummary[4]:Enduse13[4]"			Proj:ResultSummary[4]:Enduse13[4]	= {	FltToStr( (PVCredit[1] * -1), 2 )  }
   ; SAC 10/6/16 - 2019 PV
	"Set ResultSummary[4]:Enduse13[4]"			Proj:ResultSummary[4]:Enduse13[4]	= {	if (EnergyCodeYearNum >= 2019)
                                                                                 then  if (LocalCompAssigned( RunResultsS[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[13]:ProposedTDV ), 2 )  endif
                                                                                 else  if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( (RunResultsS[6]:PropPVCreditTDV[1] * -1), 2 )  endif  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
 	"Set ResultSummary[4]:Enduse10[4]"			Proj:ResultSummary[4]:Enduse10[4]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[10]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse11[4]"			Proj:ResultSummary[4]:Enduse11[4]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[11]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse12[4]"			Proj:ResultSummary[4]:Enduse12[4]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[12]:ProposedTDV[1] ), 2 )  endif  }
  ; SAC 4/17/15 - copy CompResultsMsg down from Proj into EUseSummary (to ensure that it is carried into subsequent models and back to user input)
	"Set ResultSummary[4]:CompResultsMsg"		Proj:ResultSummary[4]:CompResultsMsg	= {	if (GlobalStatus( Proj:CompResultsMsg ) > 0) then  Proj:CompResultsMsg  else  UNCHANGED  endif  }
  ; SAC 3/3/16 - ensure access to PVMinRatedPower in projects following analysis (tic #609)
	"Set ResultSummary[4]:PVMinRatedPower"		Proj:ResultSummary[4]:PVMinRatedPower	= {	if (IfValidAnd( Proj:PVCompCredit > 0 ) .AND. IfValidAnd( Proj:PVCredit[1] > 0 ) .AND. IfValidAnd( Proj:PVMinRatedPower[2] > 0 ))
																														then  Proj:PVMinRatedPower[2]  else  UNCHANGED  endif  }

  ; Compliance Margin TDV
	"Set ResultSummary[4]:Enduse14[8]"			Proj:ResultSummary[4]:Enduse14[8]	= {	if (LocalCompAssigned( RunResultsS[14] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[14]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse10[8]"			Proj:ResultSummary[4]:Enduse10[8]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[10]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse11[8]"			Proj:ResultSummary[4]:Enduse11[8]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[11]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse12[8]"			Proj:ResultSummary[4]:Enduse12[8]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[12]:CompMarginTDV ), 2 )  endif  }
   ; SAC 10/6/16 - 2019 PV
 	"Set ResultSummary[4]:Enduse13[8]"			Proj:ResultSummary[4]:Enduse13[8]	= {	if (EnergyCodeYearNum >= 2019)
                                                                                 then  if (LocalCompAssigned( RunResultsS[13] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[13]:CompMarginTDV,     2 )  endif
                                                                                 else  if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[6]:PropPVCreditTDV[1], 2 )  endif  endif  }
  ; Pass/Fail result
 	"Set ResultSummary[4]:MetricPassFail[1] (SLCC-Eff)"   Proj:ResultSummary[4]:MetricPassFail[1] = {	if (EnergyCodeYearNum < 2025 .OR. LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  if (RunResultsS[11]:CompMarginTDV >= 0) then "Pass"  else  "Fail"  endif endif  }  ; SAC 11/22/22 (2025)
 	"Set ResultSummary[4]:MetricPassFail[2] (SLCC-Tot)"   Proj:ResultSummary[4]:MetricPassFail[2] = {	if (EnergyCodeYearNum < 2025 .OR. LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  if (RunResultsS[10]:CompMarginTDV >= 0) then "Pass"  else  "Fail"  endif endif  } 
 	"Set ResultSummary[4]:MetricPassFail[3] (Src-Tot)"    Proj:ResultSummary[4]:MetricPassFail[3] = {	if (EnergyCodeYearNum < 2025 .OR. LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  if (RunResultsS[10]:CompMarginSrc >= 0) then "Pass"  else  "Fail"  endif endif  } 
 	"Set ResultSummary[4]:PassFail"				Proj:ResultSummary[4]:PassFail		= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  if (RunResultsS[11]:CompMarginTDV >= 0) then "PASS"  else  "FAIL"  endif endif  }

  ; Percent Savings values for reporting
	"Set ResultSummary[4]:PctSavingsTDV"		Proj:ResultSummary[4]:PctSavingsTDV		= {	if (IfValidAnd( RunResults[10]:StandardTDV     > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[10]:StandardTDV     - ValidOr( RunResultsS[10]:ProposedTDV[1],      0 )) * 100 / RunResults[10]:StandardTDV    ) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[4]:PctSavingsCmpTDV"	Proj:ResultSummary[4]:PctSavingsCmpTDV	= {	if (IfValidAnd( RunResults[11]:StandardTDV     > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResults[11]:StandardTDV     - ValidOr( RunResultsS[11]:ProposedTDV[1],      0 )) * 100 / RunResults[11]:StandardTDV    ) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[4]:PctSavTDVLbl"			Proj:ResultSummary[4]:PctSavTDVLbl		= {	if (IfValidAnd( ResultSummary[4]:PctSavingsTDV    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[4]:PctSavingsTDV    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[4]:PctSavingsTDV    )  endif  }
	"Set ResultSummary[4]:PctSavCmpTDVLbl"		Proj:ResultSummary[4]:PctSavCmpTDVLbl	= {	if (IfValidAnd( ResultSummary[4]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[4]:PctSavingsCmpTDV < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[4]:PctSavingsCmpTDV )  endif  }
	; SAC 3/21/16 - added tier results
	; SAC 5/23/16 - modified to require QII (tic #671)
	"Set ResultSummary[4]:MeetsTier1"			Proj:ResultSummary[4]:MeetsTier1		= {	if (StdDesignBase >= 2016 .AND. IfValidAnd( ResultSummary[4]:PctSavingsCmpTDV >= 14.95 ) .AND.
																															IfValidAnd( HERSProj:QII > 0.5 )) then  1  else  0  endif  }
	"Set ResultSummary[4]:MeetsTier2"			Proj:ResultSummary[4]:MeetsTier2		= {	if (StdDesignBase >= 2016 .AND. IfValidAnd( ResultSummary[4]:PctSavingsCmpTDV >= 29.95 ) .AND.
																															IfValidAnd( HERSProj:QII > 0.5 )) then  1  else  0  endif  }

; -- WEST Facing --
  ; Standard TDV
 	"Set ResultSummary[5]:Enduse10[7]"			Proj:ResultSummary[5]:Enduse10[7]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[10]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse11[7]"			Proj:ResultSummary[5]:Enduse11[7]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[11]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse12[7]"			Proj:ResultSummary[5]:Enduse12[7]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[12]:StandardTDV ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse13[7]"			Proj:ResultSummary[5]:Enduse13[7]	= {	if (LocalCompAssigned( RunResultsW[13] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsW[13]:StandardTDV = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsW[13]:StandardTDV ), 2 )  endif endif  }
	"Set ResultSummary[5]:Enduse14[7]"			Proj:ResultSummary[5]:Enduse14[7]	= {	if (LocalCompAssigned( RunResultsW[14] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsW[14]:StandardTDV = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsW[14]:StandardTDV ), 2 )  endif endif  }

; mjb-10/16/13	subtract PVCredit from Prop Design - W
	;"Set ResultSummary[5]:Enduse13[4]"			Proj:ResultSummary[5]:Enduse13[4]	= {	FltToStr( (PVCredit[1] * -1), 2 )  }
   ; SAC 10/6/16 - 2019 PV
	"Set ResultSummary[5]:Enduse13[4]"			Proj:ResultSummary[5]:Enduse13[4]	= {	if (EnergyCodeYearNum >= 2019)
                                                                                 then  if (LocalCompAssigned( RunResultsW[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[13]:ProposedTDV ), 2 )  endif
                                                                                 else  if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( (RunResultsW[6]:PropPVCreditTDV[1] * -1), 2 )  endif  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
 	"Set ResultSummary[5]:Enduse10[4]"			Proj:ResultSummary[5]:Enduse10[4]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[10]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse11[4]"			Proj:ResultSummary[5]:Enduse11[4]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[11]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse12[4]"			Proj:ResultSummary[5]:Enduse12[4]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[12]:ProposedTDV[1] ), 2 )  endif  }
  ; SAC 4/17/15 - copy CompResultsMsg down from Proj into EUseSummary (to ensure that it is carried into subsequent models and back to user input)
	"Set ResultSummary[5]:CompResultsMsg"		Proj:ResultSummary[5]:CompResultsMsg	= {	if (GlobalStatus( Proj:CompResultsMsg ) > 0) then  Proj:CompResultsMsg  else  UNCHANGED  endif  }
  ; SAC 3/3/16 - ensure access to PVMinRatedPower in projects following analysis (tic #609)
	"Set ResultSummary[5]:PVMinRatedPower"		Proj:ResultSummary[5]:PVMinRatedPower	= {	if (IfValidAnd( Proj:PVCompCredit > 0 ) .AND. IfValidAnd( Proj:PVCredit[1] > 0 ) .AND. IfValidAnd( Proj:PVMinRatedPower[2] > 0 ))
																														then  Proj:PVMinRatedPower[2]  else  UNCHANGED  endif  }

  ; Compliance Margin TDV
	"Set ResultSummary[5]:Enduse14[8]"			Proj:ResultSummary[5]:Enduse14[8]	= {	if (LocalCompAssigned( RunResultsW[14] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[14]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse10[8]"			Proj:ResultSummary[5]:Enduse10[8]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[10]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse11[8]"			Proj:ResultSummary[5]:Enduse11[8]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[11]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse12[8]"			Proj:ResultSummary[5]:Enduse12[8]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[12]:CompMarginTDV ), 2 )  endif  }
   ; SAC 10/6/16 - 2019 PV
 	"Set ResultSummary[5]:Enduse13[8]"			Proj:ResultSummary[5]:Enduse13[8]	= {	if (EnergyCodeYearNum >= 2019)
                                                                                 then  if (LocalCompAssigned( RunResultsW[13] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[13]:CompMarginTDV,     2 )  endif
                                                                                 else  if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[6]:PropPVCreditTDV[1], 2 )  endif  endif  }
  ; Pass/Fail result
 	"Set ResultSummary[5]:MetricPassFail[1] (SLCC-Eff)"   Proj:ResultSummary[5]:MetricPassFail[1] = {	if (EnergyCodeYearNum < 2025 .OR. LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  if (RunResultsW[11]:CompMarginTDV >= 0) then "Pass"  else  "Fail"  endif endif  }  ; SAC 11/22/22 (2025)
 	"Set ResultSummary[5]:MetricPassFail[2] (SLCC-Tot)"   Proj:ResultSummary[5]:MetricPassFail[2] = {	if (EnergyCodeYearNum < 2025 .OR. LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  if (RunResultsW[10]:CompMarginTDV >= 0) then "Pass"  else  "Fail"  endif endif  } 
 	"Set ResultSummary[5]:MetricPassFail[3] (Src-Tot)"    Proj:ResultSummary[5]:MetricPassFail[3] = {	if (EnergyCodeYearNum < 2025 .OR. LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  if (RunResultsW[10]:CompMarginSrc >= 0) then "Pass"  else  "Fail"  endif endif  } 
 	"Set ResultSummary[5]:PassFail"				Proj:ResultSummary[5]:PassFail		= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  if (RunResultsW[11]:CompMarginTDV >= 0) then "PASS"  else  "FAIL"  endif endif  }

  ; Percent Savings values for reporting
	"Set ResultSummary[5]:PctSavingsTDV"		Proj:ResultSummary[5]:PctSavingsTDV		= {	if (IfValidAnd( RunResultsW[10]:StandardTDV     > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResultsW[10]:StandardTDV     - ValidOr( RunResultsW[10]:ProposedTDV[1],      0 )) * 100 / RunResultsW[10]:StandardTDV    ) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[5]:PctSavingsCmpTDV"	Proj:ResultSummary[5]:PctSavingsCmpTDV	= {	if (IfValidAnd( RunResultsW[11]:StandardTDV     > 0.001 )==0) then  UNDEFINED
																														else  int((((RunResultsW[11]:StandardTDV     - ValidOr( RunResultsW[11]:ProposedTDV[1],      0 )) * 100 / RunResultsW[11]:StandardTDV    ) * 10) +0.5 ) / 10  endif  }
	"Set ResultSummary[5]:PctSavTDVLbl"			Proj:ResultSummary[5]:PctSavTDVLbl		= {	if (IfValidAnd( ResultSummary[5]:PctSavingsTDV    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[5]:PctSavingsTDV    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[5]:PctSavingsTDV    )  endif  }
	"Set ResultSummary[5]:PctSavCmpTDVLbl"		Proj:ResultSummary[5]:PctSavCmpTDVLbl	= {	if (IfValidAnd( ResultSummary[5]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[5]:PctSavingsCmpTDV < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[5]:PctSavingsCmpTDV )  endif  }
	; SAC 3/21/16 - added tier results
	; SAC 5/23/16 - modified to require QII (tic #671)
	"Set ResultSummary[5]:MeetsTier1"			Proj:ResultSummary[5]:MeetsTier1		= {	if (StdDesignBase >= 2016 .AND. IfValidAnd( ResultSummary[5]:PctSavingsCmpTDV >= 14.95 ) .AND.
																															IfValidAnd( HERSProj:QII > 0.5 )) then  1  else  0  endif  }
	"Set ResultSummary[5]:MeetsTier2"			Proj:ResultSummary[5]:MeetsTier2		= {	if (StdDesignBase >= 2016 .AND. IfValidAnd( ResultSummary[5]:PctSavingsCmpTDV >= 29.95 ) .AND.
																															IfValidAnd( HERSProj:QII > 0.5 )) then  1  else  0  endif  }
END

;************************************************************************* SAC 07/21/23
RULELIST "CARes_SelfUtilizationCredit_2025_NESW" 1 0 1 1
;*************************************************************************
; -- NORTH Facing --
   ; SAC 1/22/18 - Battery adjustments for GHC to Compliance Enduse Details (grid harmonization credit)
	"Set ResultSummary[2]:Enduse99[2]"			Proj:ResultSummary[2]:Enduse99[2]	= {
         if (IfValidAnd( ResultSummary[2]:GHCEnergyEffElec > 0.00001 )==0) then  UNDEFINED  
         else  FltToStr( (int( ResultSummary[2]:GHCEnergyEffElec + 0.5 )), 0 )  endif  }
	"Adj ResultSummary[2]:Enduse14[2]"			Proj:ResultSummary[2]:Enduse14[2]	= {
         if (LocalStatus( ResultSummary[2]:Enduse99[2] ) < 1) then  UNCHANGED  
         else if (ResultSummary[2]:GHCEnergyEffCap >= (-1 * RunResultsN[14]:ProposedTDV[1])) then  UNDEFINED
         else  FltToStr( (int( (RunResultsN[14]:PropElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 ) -
                          int( ResultSummary[2]:GHCEnergyEffElec + 0.5 )), 0 )  endif endif  }
   ; SAC 2/2/19 - revised logic to reference new PFlxTDV property (tic #1053)
	"Set ResultSummary[2]:Enduse98[17]"			Proj:ResultSummary[2]:Enduse98[17]	= {
			if (LocalStatus( ResultSummary[2]:PFlxElecEnergy[1] ) < 1) then  UNDEFINED
         else  FltToStr( ResultSummary[2]:PFlxElecEnergy[1], 0 )  endif  }
	"Set ResultSummary[2]:Enduse98[2]"			Proj:ResultSummary[2]:Enduse98[2]	= {  ResultSummary[2]:Enduse98[17]  }
	"Set ResultSummary[2]:Enduse10[2]"			Proj:ResultSummary[2]:Enduse10[2]	= {
	      if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  
			else  FltToStr( (int( ( RunResultsN[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )) + ValidOr( ResultSummary[2]:PFlxElecEnergy[1], 0 ), 0 )  endif  }

   ; SAC 1/22/18 - Battery adjustments for GHC to Compliance Enduse Details (grid harmonization credit)
	"Set ResultSummary[2]:Enduse99[4]"			Proj:ResultSummary[2]:Enduse99[4]	= {
         if (IfValidAnd( ResultSummary[2]:GHCEnergyEffTDV > 0.00001 )==0) then  "0.00"  
         else  FltToStr( (-1 * ResultSummary[2]:GHCEnergyEffTDV), 2 )  endif  }
	"Adj ResultSummary[2]:Enduse14[4]"			Proj:ResultSummary[2]:Enduse14[4]	= {
         if (IfValidAnd( ResultSummary[2]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResultsN[14]:ProposedTDV[1] + ResultSummary[2]:GHCEnergyEffTDV), 2 )  endif  }
   ; SAC 2/2/19 - Reporting of Flexibility credit (tic #1053)
	"Set ResultSummary[2]:Enduse98[19]"			Proj:ResultSummary[2]:Enduse98[19]	= {
			if (LocalStatus( ResultSummary[2]:PFlxTDV[1] ) < 1) then  UNDEFINED
         else  FltToStr( ResultSummary[2]:PFlxTDV[1], 2 )  endif  }
	"Set ResultSummary[2]:Enduse98[4]"			Proj:ResultSummary[2]:Enduse98[4]	= {  ResultSummary[2]:Enduse98[19]  }
	"Set ResultSummary[2]:Enduse10[4]"			Proj:ResultSummary[2]:Enduse10[4]	= {
	      if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED
	      else  FltToStr( (int(RunResultsN[10]:ProposedTDV[1]*100+0.5)/100) + ValidOr( ResultSummary[2]:PFlxTDV[1], 0 ), 2 )  endif  }

   ; SAC 1/22/18 - Battery adjustments for GHC to Compliance Enduse Details (grid harmonization credit)
	"Set ResultSummary[2]:Enduse99[8]"			Proj:ResultSummary[2]:Enduse99[8]	= {
         if (IfValidAnd( ResultSummary[2]:GHCEnergyEffTDV > 0.00001 )==0) then  "0.00"  
         else  FltToStr( ResultSummary[2]:GHCEnergyEffTDV, 2 )  endif  }
	"Adj ResultSummary[2]:Enduse14[8]"			Proj:ResultSummary[2]:Enduse14[8]	= {
         if (IfValidAnd( ResultSummary[2]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResultsN[14]:StandardTDV - RunResultsN[14]:ProposedTDV[1] - ResultSummary[2]:GHCEnergyEffTDV), 2 )  endif  }
   ; SAC 1/22/18 - Compliance Total adjustments for Battery GHC (grid harmonization credit)
	"Adj ResultSummary[2]:Enduse11[4]"			Proj:ResultSummary[2]:Enduse11[4]	= {
         if (LocalCompAssigned( RunResultsN[11] ) == 0 .OR. IfValidAnd( ResultSummary[2]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else  FltToStr( (RunResultsN[11]:ProposedTDV[1] - ResultSummary[2]:GHCEnergyEffTDV), 2 )  endif  }
 	"Adj ResultSummary[2]:Enduse11[8]"			Proj:ResultSummary[2]:Enduse11[8]	= {
         if (LocalCompAssigned( RunResultsN[11] ) == 0 .OR. IfValidAnd( ResultSummary[2]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else  FltToStr( (RunResultsN[11]:CompMarginTDV + ResultSummary[2]:GHCEnergyEffTDV), 2 )  endif  }
	"Adj ResultSummary[2]:PctSavingsCmpTDV"	Proj:ResultSummary[2]:PctSavingsCmpTDV	= {
         if (IfValidAnd( RunResultsN[11]:StandardTDV > 0.001 )==0 .OR. IfValidAnd( ResultSummary[2]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else  int((((RunResultsN[11]:StandardTDV - ValidOr( RunResultsN[11]:ProposedTDV[1], 0 ) + ResultSummary[2]:GHCEnergyEffTDV) * 100 / RunResultsN[11]:StandardTDV ) * 10) +0.5 ) / 10  endif  }
	"Adj ResultSummary[2]:PctSavCmpTDVLbl"		Proj:ResultSummary[2]:PctSavCmpTDVLbl	= {
         if (IfValidAnd( ResultSummary[2]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else if (IfValidAnd( ResultSummary[2]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[2]:PctSavingsCmpTDV < -0.0001 )==0) then  "-" 
         else  Format( "%.1f", ResultSummary[2]:PctSavingsCmpTDV )  endif endif  }

; -- EAST Facing --
   ; SAC 1/22/18 - Battery adjustments for GHC to Compliance Enduse Details (grid harmonization credit)
	"Set ResultSummary[3]:Enduse99[2]"			Proj:ResultSummary[3]:Enduse99[2]	= {
         if (IfValidAnd( ResultSummary[3]:GHCEnergyEffElec > 0.00001 )==0) then  UNDEFINED  
         else  FltToStr( (int( ResultSummary[3]:GHCEnergyEffElec + 0.5 )), 0 )  endif  }
	"Adj ResultSummary[3]:Enduse14[2]"			Proj:ResultSummary[3]:Enduse14[2]	= {
         if (LocalStatus( ResultSummary[3]:Enduse99[2] ) < 1) then  UNCHANGED  
         else if (ResultSummary[3]:GHCEnergyEffCap >= (-1 * RunResultsE[14]:ProposedTDV[1])) then  UNDEFINED
         else  FltToStr( (int( (RunResultsE[14]:PropElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 ) -
                          int( ResultSummary[3]:GHCEnergyEffElec + 0.5 )), 0 )  endif endif  }
   ; SAC 2/2/19 - revised logic to reference new PFlxTDV property (tic #1053)
	"Set ResultSummary[3]:Enduse98[17]"			Proj:ResultSummary[3]:Enduse98[17]	= {
			if (LocalStatus( ResultSummary[3]:PFlxElecEnergy[1] ) < 1) then  UNDEFINED
         else  FltToStr( ResultSummary[3]:PFlxElecEnergy[1], 0 )  endif  }
	"Set ResultSummary[3]:Enduse98[2]"			Proj:ResultSummary[3]:Enduse98[2]	= {  ResultSummary[3]:Enduse98[17]  }
	"Set ResultSummary[3]:Enduse10[2]"			Proj:ResultSummary[3]:Enduse10[2]	= {
	      if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  
			else  FltToStr( (int( ( RunResultsE[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )) + ValidOr( ResultSummary[3]:PFlxElecEnergy[1], 0 ), 0 )  endif  }

   ; SAC 1/22/18 - Battery adjustments for GHC to Compliance Enduse Details (grid harmonization credit)
	"Set ResultSummary[3]:Enduse99[4]"			Proj:ResultSummary[3]:Enduse99[4]	= {
         if (IfValidAnd( ResultSummary[3]:GHCEnergyEffTDV > 0.00001 )==0) then  "0.00"  
         else  FltToStr( (-1 * ResultSummary[3]:GHCEnergyEffTDV), 2 )  endif  }
	"Adj ResultSummary[3]:Enduse14[4]"			Proj:ResultSummary[3]:Enduse14[4]	= {
         if (IfValidAnd( ResultSummary[3]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResultsE[14]:ProposedTDV[1] + ResultSummary[3]:GHCEnergyEffTDV), 2 )  endif  }
   ; SAC 2/2/19 - Reporting of Flexibility credit (tic #1053)
	"Set ResultSummary[3]:Enduse98[19]"			Proj:ResultSummary[3]:Enduse98[19]	= {
			if (LocalStatus( ResultSummary[3]:PFlxTDV[1] ) < 1) then  UNDEFINED
         else  FltToStr( ResultSummary[3]:PFlxTDV[1], 2 )  endif  }
	"Set ResultSummary[3]:Enduse98[4]"			Proj:ResultSummary[3]:Enduse98[4]	= {  ResultSummary[3]:Enduse98[19]  }
	"Set ResultSummary[3]:Enduse10[4]"			Proj:ResultSummary[3]:Enduse10[4]	= {
	      if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED
	      else  FltToStr( (int(RunResultsE[10]:ProposedTDV[1]*100+0.5)/100) + ValidOr( ResultSummary[3]:PFlxTDV[1], 0 ), 2 )  endif  }

   ; SAC 1/22/18 - Battery adjustments for GHC to Compliance Enduse Details (grid harmonization credit)
	"Set ResultSummary[3]:Enduse99[8]"			Proj:ResultSummary[3]:Enduse99[8]	= {
         if (IfValidAnd( ResultSummary[3]:GHCEnergyEffTDV > 0.00001 )==0) then  "0.00"  
         else  FltToStr( ResultSummary[3]:GHCEnergyEffTDV, 2 )  endif  }
	"Adj ResultSummary[3]:Enduse14[8]"			Proj:ResultSummary[3]:Enduse14[8]	= {
         if (IfValidAnd( ResultSummary[3]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResultsE[14]:StandardTDV - RunResultsE[14]:ProposedTDV[1] - ResultSummary[3]:GHCEnergyEffTDV), 2 )  endif  }
   ; SAC 1/22/18 - Compliance Total adjustments for Battery GHC (grid harmonization credit)
	"Adj ResultSummary[3]:Enduse11[4]"			Proj:ResultSummary[3]:Enduse11[4]	= {
         if (LocalCompAssigned( RunResultsE[11] ) == 0 .OR. IfValidAnd( ResultSummary[3]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else  FltToStr( (RunResultsE[11]:ProposedTDV[1] - ResultSummary[3]:GHCEnergyEffTDV), 2 )  endif  }
 	"Adj ResultSummary[3]:Enduse11[8]"			Proj:ResultSummary[3]:Enduse11[8]	= {
         if (LocalCompAssigned( RunResultsE[11] ) == 0 .OR. IfValidAnd( ResultSummary[3]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else  FltToStr( (RunResultsE[11]:CompMarginTDV + ResultSummary[3]:GHCEnergyEffTDV), 2 )  endif  }
	"Adj ResultSummary[3]:PctSavingsCmpTDV"	Proj:ResultSummary[3]:PctSavingsCmpTDV	= {
         if (IfValidAnd( RunResultsE[11]:StandardTDV > 0.001 )==0 .OR. IfValidAnd( ResultSummary[3]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else  int((((RunResultsE[11]:StandardTDV - ValidOr( RunResultsE[11]:ProposedTDV[1], 0 ) + ResultSummary[3]:GHCEnergyEffTDV) * 100 / RunResultsE[11]:StandardTDV ) * 10) +0.5 ) / 10  endif  }
	"Adj ResultSummary[3]:PctSavCmpTDVLbl"		Proj:ResultSummary[3]:PctSavCmpTDVLbl	= {
         if (IfValidAnd( ResultSummary[3]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else if (IfValidAnd( ResultSummary[3]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[3]:PctSavingsCmpTDV < -0.0001 )==0) then  "-" 
         else  Format( "%.1f", ResultSummary[3]:PctSavingsCmpTDV )  endif endif  }

; -- SOUTH Facing --
   ; SAC 1/22/18 - Battery adjustments for GHC to Compliance Enduse Details (grid harmonization credit)
	"Set ResultSummary[4]:Enduse99[2]"			Proj:ResultSummary[4]:Enduse99[2]	= {
         if (IfValidAnd( ResultSummary[4]:GHCEnergyEffElec > 0.00001 )==0) then  UNDEFINED  
         else  FltToStr( (int( ResultSummary[4]:GHCEnergyEffElec + 0.5 )), 0 )  endif  }
	"Adj ResultSummary[4]:Enduse14[2]"			Proj:ResultSummary[4]:Enduse14[2]	= {
         if (LocalStatus( ResultSummary[4]:Enduse99[2] ) < 1) then  UNCHANGED  
         else if (ResultSummary[4]:GHCEnergyEffCap >= (-1 * RunResultsS[14]:ProposedTDV[1])) then  UNDEFINED
         else  FltToStr( (int( (RunResultsS[14]:PropElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 ) -
                          int( ResultSummary[4]:GHCEnergyEffElec + 0.5 )), 0 )  endif endif  }
   ; SAC 2/2/19 - revised logic to reference new PFlxTDV property (tic #1053)
	"Set ResultSummary[4]:Enduse98[17]"			Proj:ResultSummary[4]:Enduse98[17]	= {
			if (LocalStatus( ResultSummary[4]:PFlxElecEnergy[1] ) < 1) then  UNDEFINED
         else  FltToStr( ResultSummary[4]:PFlxElecEnergy[1], 0 )  endif  }
	"Set ResultSummary[4]:Enduse98[2]"			Proj:ResultSummary[4]:Enduse98[2]	= {  ResultSummary[4]:Enduse98[17]  }
	"Set ResultSummary[4]:Enduse10[2]"			Proj:ResultSummary[4]:Enduse10[2]	= {
	      if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  
			else  FltToStr( (int( ( RunResultsS[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )) + ValidOr( ResultSummary[4]:PFlxElecEnergy[1], 0 ), 0 )  endif  }

   ; SAC 1/22/18 - Battery adjustments for GHC to Compliance Enduse Details (grid harmonization credit)
	"Set ResultSummary[4]:Enduse99[4]"			Proj:ResultSummary[4]:Enduse99[4]	= {
         if (IfValidAnd( ResultSummary[4]:GHCEnergyEffTDV > 0.00001 )==0) then  "0.00"  
         else  FltToStr( (-1 * ResultSummary[4]:GHCEnergyEffTDV), 2 )  endif  }
	"Adj ResultSummary[4]:Enduse14[4]"			Proj:ResultSummary[4]:Enduse14[4]	= {
         if (IfValidAnd( ResultSummary[4]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResultsS[14]:ProposedTDV[1] + ResultSummary[4]:GHCEnergyEffTDV), 2 )  endif  }
   ; SAC 2/2/19 - Reporting of Flexibility credit (tic #1053)
	"Set ResultSummary[4]:Enduse98[19]"			Proj:ResultSummary[4]:Enduse98[19]	= {
			if (LocalStatus( ResultSummary[4]:PFlxTDV[1] ) < 1) then  UNDEFINED
         else  FltToStr( ResultSummary[4]:PFlxTDV[1], 2 )  endif  }
	"Set ResultSummary[4]:Enduse98[4]"			Proj:ResultSummary[4]:Enduse98[4]	= {  ResultSummary[4]:Enduse98[19]  }
	"Set ResultSummary[4]:Enduse10[4]"			Proj:ResultSummary[4]:Enduse10[4]	= {
	      if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED
	      else  FltToStr( (int(RunResultsS[10]:ProposedTDV[1]*100+0.5)/100) + ValidOr( ResultSummary[4]:PFlxTDV[1], 0 ), 2 )  endif  }

   ; SAC 1/22/18 - Battery adjustments for GHC to Compliance Enduse Details (grid harmonization credit)
	"Set ResultSummary[4]:Enduse99[8]"			Proj:ResultSummary[4]:Enduse99[8]	= {
         if (IfValidAnd( ResultSummary[4]:GHCEnergyEffTDV > 0.00001 )==0) then  "0.00"  
         else  FltToStr( ResultSummary[4]:GHCEnergyEffTDV, 2 )  endif  }
	"Adj ResultSummary[4]:Enduse14[8]"			Proj:ResultSummary[4]:Enduse14[8]	= {
         if (IfValidAnd( ResultSummary[4]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResultsS[14]:StandardTDV - RunResultsS[14]:ProposedTDV[1] - ResultSummary[4]:GHCEnergyEffTDV), 2 )  endif  }
   ; SAC 1/22/18 - Compliance Total adjustments for Battery GHC (grid harmonization credit)
	"Adj ResultSummary[4]:Enduse11[4]"			Proj:ResultSummary[4]:Enduse11[4]	= {
         if (LocalCompAssigned( RunResultsS[11] ) == 0 .OR. IfValidAnd( ResultSummary[4]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else  FltToStr( (RunResultsS[11]:ProposedTDV[1] - ResultSummary[4]:GHCEnergyEffTDV), 2 )  endif  }
 	"Adj ResultSummary[4]:Enduse11[8]"			Proj:ResultSummary[4]:Enduse11[8]	= {
         if (LocalCompAssigned( RunResultsS[11] ) == 0 .OR. IfValidAnd( ResultSummary[4]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else  FltToStr( (RunResultsS[11]:CompMarginTDV + ResultSummary[4]:GHCEnergyEffTDV), 2 )  endif  }
	"Adj ResultSummary[4]:PctSavingsCmpTDV"	Proj:ResultSummary[4]:PctSavingsCmpTDV	= {
         if (IfValidAnd( RunResultsS[11]:StandardTDV > 0.001 )==0 .OR. IfValidAnd( ResultSummary[4]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else  int((((RunResultsS[11]:StandardTDV - ValidOr( RunResultsS[11]:ProposedTDV[1], 0 ) + ResultSummary[4]:GHCEnergyEffTDV) * 100 / RunResultsS[11]:StandardTDV ) * 10) +0.5 ) / 10  endif  }
	"Adj ResultSummary[4]:PctSavCmpTDVLbl"		Proj:ResultSummary[4]:PctSavCmpTDVLbl	= {
         if (IfValidAnd( ResultSummary[4]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else if (IfValidAnd( ResultSummary[4]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[4]:PctSavingsCmpTDV < -0.0001 )==0) then  "-" 
         else  Format( "%.1f", ResultSummary[4]:PctSavingsCmpTDV )  endif endif  }

; -- WEST Facing --
   ; SAC 1/22/18 - Battery adjustments for GHC to Compliance Enduse Details (grid harmonization credit)
	"Set ResultSummary[5]:Enduse99[2]"			Proj:ResultSummary[5]:Enduse99[2]	= {
         if (IfValidAnd( ResultSummary[5]:GHCEnergyEffElec > 0.00001 )==0) then  UNDEFINED  
         else  FltToStr( (int( ResultSummary[5]:GHCEnergyEffElec + 0.5 )), 0 )  endif  }
	"Adj ResultSummary[5]:Enduse14[2]"			Proj:ResultSummary[5]:Enduse14[2]	= {
         if (LocalStatus( ResultSummary[5]:Enduse99[2] ) < 1) then  UNCHANGED  
         else if (ResultSummary[5]:GHCEnergyEffCap >= (-1 * RunResultsW[14]:ProposedTDV[1])) then  UNDEFINED
         else  FltToStr( (int( (RunResultsW[14]:PropElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 ) -
                          int( ResultSummary[5]:GHCEnergyEffElec + 0.5 )), 0 )  endif endif  }
   ; SAC 2/2/19 - revised logic to reference new PFlxTDV property (tic #1053)
	"Set ResultSummary[5]:Enduse98[17]"			Proj:ResultSummary[5]:Enduse98[17]	= {
			if (LocalStatus( ResultSummary[5]:PFlxElecEnergy[1] ) < 1) then  UNDEFINED
         else  FltToStr( ResultSummary[5]:PFlxElecEnergy[1], 0 )  endif  }
	"Set ResultSummary[5]:Enduse98[2]"			Proj:ResultSummary[5]:Enduse98[2]	= {  ResultSummary[5]:Enduse98[17]  }
	"Set ResultSummary[5]:Enduse10[2]"			Proj:ResultSummary[5]:Enduse10[2]	= {
	      if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  
			else  FltToStr( (int( ( RunResultsW[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )) + ValidOr( ResultSummary[5]:PFlxElecEnergy[1], 0 ), 0 )  endif  }

   ; SAC 1/22/18 - Battery adjustments for GHC to Compliance Enduse Details (grid harmonization credit)
	"Set ResultSummary[5]:Enduse99[4]"			Proj:ResultSummary[5]:Enduse99[4]	= {
         if (IfValidAnd( ResultSummary[5]:GHCEnergyEffTDV > 0.00001 )==0) then  "0.00"  
         else  FltToStr( (-1 * ResultSummary[5]:GHCEnergyEffTDV), 2 )  endif  }
	"Adj ResultSummary[5]:Enduse14[4]"			Proj:ResultSummary[5]:Enduse14[4]	= {
         if (IfValidAnd( ResultSummary[5]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResultsW[14]:ProposedTDV[1] + ResultSummary[5]:GHCEnergyEffTDV), 2 )  endif  }
   ; SAC 2/2/19 - Reporting of Flexibility credit (tic #1053)
	"Set ResultSummary[5]:Enduse98[19]"			Proj:ResultSummary[5]:Enduse98[19]	= {
			if (LocalStatus( ResultSummary[5]:PFlxTDV[1] ) < 1) then  UNDEFINED
         else  FltToStr( ResultSummary[5]:PFlxTDV[1], 2 )  endif  }
	"Set ResultSummary[5]:Enduse98[4]"			Proj:ResultSummary[5]:Enduse98[4]	= {  ResultSummary[5]:Enduse98[19]  }
	"Set ResultSummary[5]:Enduse10[4]"			Proj:ResultSummary[5]:Enduse10[4]	= {
	      if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED
	      else  FltToStr( (int(RunResultsW[10]:ProposedTDV[1]*100+0.5)/100) + ValidOr( ResultSummary[5]:PFlxTDV[1], 0 ), 2 )  endif  }

   ; SAC 1/22/18 - Battery adjustments for GHC to Compliance Enduse Details (grid harmonization credit)
	"Set ResultSummary[5]:Enduse99[8]"			Proj:ResultSummary[5]:Enduse99[8]	= {
         if (IfValidAnd( ResultSummary[5]:GHCEnergyEffTDV > 0.00001 )==0) then  "0.00"  
         else  FltToStr( ResultSummary[5]:GHCEnergyEffTDV, 2 )  endif  }
	"Adj ResultSummary[5]:Enduse14[8]"			Proj:ResultSummary[5]:Enduse14[8]	= {
         if (IfValidAnd( ResultSummary[5]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResultsW[14]:StandardTDV - RunResultsW[14]:ProposedTDV[1] - ResultSummary[5]:GHCEnergyEffTDV), 2 )  endif  }
   ; SAC 1/22/18 - Compliance Total adjustments for Battery GHC (grid harmonization credit)
	"Adj ResultSummary[5]:Enduse11[4]"			Proj:ResultSummary[5]:Enduse11[4]	= {
         if (LocalCompAssigned( RunResultsW[11] ) == 0 .OR. IfValidAnd( ResultSummary[5]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else  FltToStr( (RunResultsW[11]:ProposedTDV[1] - ResultSummary[5]:GHCEnergyEffTDV), 2 )  endif  }
 	"Adj ResultSummary[5]:Enduse11[8]"			Proj:ResultSummary[5]:Enduse11[8]	= {
         if (LocalCompAssigned( RunResultsW[11] ) == 0 .OR. IfValidAnd( ResultSummary[5]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else  FltToStr( (RunResultsW[11]:CompMarginTDV + ResultSummary[5]:GHCEnergyEffTDV), 2 )  endif  }
	"Adj ResultSummary[5]:PctSavingsCmpTDV"	Proj:ResultSummary[5]:PctSavingsCmpTDV	= {
         if (IfValidAnd( RunResultsW[11]:StandardTDV > 0.001 )==0 .OR. IfValidAnd( ResultSummary[5]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else  int((((RunResultsW[11]:StandardTDV - ValidOr( RunResultsW[11]:ProposedTDV[1], 0 ) + ResultSummary[5]:GHCEnergyEffTDV) * 100 / RunResultsW[11]:StandardTDV ) * 10) +0.5 ) / 10  endif  }
	"Adj ResultSummary[5]:PctSavCmpTDVLbl"		Proj:ResultSummary[5]:PctSavCmpTDVLbl	= {
         if (IfValidAnd( ResultSummary[5]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else if (IfValidAnd( ResultSummary[5]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[5]:PctSavingsCmpTDV < -0.0001 )==0) then  "-" 
         else  Format( "%.1f", ResultSummary[5]:PctSavingsCmpTDV )  endif endif  }
END


;*************************************************************************
RULELIST "CARes_DesignRatingSummary_NESW" 1 0 1 1
;*************************************************************************

;		; Worst case run RunResults[*] all set now, so start by setting up PROPOSED summary data for the worst case run
;		"Call subordinate rulelist to set worst case Proposed summary"		Proj:Action = {	EvalRulelist( "CARes_ProposedSummary_Main" )  }
	; can call generic DesignRatingSummary rulelist to set worst case DesignRating summary data
	"Call subordinate rulelist to set worst case DesignRating summary"		Proj:Action = {	EvalRulelist( "CARes_DesignRatingSummary" )  }

; -- NORTH Facing --
  ; DesignRating Site Electric Use
	"Set ResultSummary[2]:Title1[12]"			Proj:ResultSummary[2]:Title1[12]		= {	if (EnergyCodeYearNum < 2022) then  "Reference"   else  "Reference Design:"  endif  }
	"Set ResultSummary[2]:Title2[12]"			Proj:ResultSummary[2]:Title2[12]		= {	if (EnergyCodeYearNum < 2022) then  "Design"      else if (EnergyCodeYearNum < 2025) then  "Site"  else  "Site Elec."  endif endif  }  ; SAC 12/01/22
	"Set ResultSummary[2]:Title3[12]"			Proj:ResultSummary[2]:Title3[12]		= {	if (EnergyCodeYearNum < 2022) then  "Site (kWh)"  else  "(kWh/yr)"              endif  }
	"Set ResultSummary[2]:Enduse1[12]"			Proj:ResultSummary[2]:Enduse1[12]	= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0 .OR. RunResultsN[1]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[1]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse2[12]"			Proj:ResultSummary[2]:Enduse2[12]	= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0 .OR. RunResultsN[2]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[2]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse3[12]"			Proj:ResultSummary[2]:Enduse3[12]	= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0 .OR. RunResultsN[3]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[3]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse4[12]"			Proj:ResultSummary[2]:Enduse4[12]	= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0 .OR. RunResultsN[4]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[4]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse5[12]"			Proj:ResultSummary[2]:Enduse5[12]	= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0 .OR. RunResultsN[5]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[5]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse14[12]"			Proj:ResultSummary[2]:Enduse14[12]	= {	if (LocalCompAssigned( RunResultsN[14] ) == 0 .OR. RunResultsN[14]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[14]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse6[12]"			Proj:ResultSummary[2]:Enduse6[12]	= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0 .OR. RunResultsN[6]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[6]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse7[12]"			Proj:ResultSummary[2]:Enduse7[12]	= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0 .OR. RunResultsN[7]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[7]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse8[12]"			Proj:ResultSummary[2]:Enduse8[12]	= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0 .OR. RunResultsN[8]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[8]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse9[12]"			Proj:ResultSummary[2]:Enduse9[12]	= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0 .OR. RunResultsN[9]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[9]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse10[12]"			Proj:ResultSummary[2]:Enduse10[12]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0 .OR. RunResultsN[10]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[10]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse11[12]"			Proj:ResultSummary[2]:Enduse11[12]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0 .OR. RunResultsN[11]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[11]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse12[12]"			Proj:ResultSummary[2]:Enduse12[12]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0 .OR. RunResultsN[12]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[12]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
  ; SAC 4/8/15 - refresh lighting and total Proposed results following (possible) resets due to design rating lighting credit reductions
  ; SAC 6/25/17 - updated to include PV results
  ; Proposed Site ELEC Use
	"Set ResultSummary[2]:Enduse6[17]"			Proj:ResultSummary[2]:Enduse6[17]	= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0 .OR. RunResultsN[6]:PropElecEnergy[2]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[6]:PropElecEnergy[2]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
   ; SAC 2/2/19 - Incorporate Flexibility credit into totals via new EUseSummary:PFlx* properties (tic #1053)
	"Set ResultSummary[2]:Enduse10[17]"			Proj:ResultSummary[2]:Enduse10[17]	= {
	      if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  
			else  FltToStr( (int( (RunResultsN[10]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )) + ValidOr( ResultSummary[2]:PFlxElecEnergy[1], 0 ), 0 )  endif  }
	"Set ResultSummary[2]:Enduse11[17]"			Proj:ResultSummary[2]:Enduse11[17]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0 .OR. RunResultsN[11]:PropElecEnergy[2] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[11]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse12[17]"			Proj:ResultSummary[2]:Enduse12[17]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0 .OR. RunResultsN[12]:PropElecEnergy[2] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[12]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse13[17]"			Proj:ResultSummary[2]:Enduse13[17]	= {	if (LocalCompAssigned( RunResultsN[13] ) == 0 .OR. RunResultsN[13]:PropElecEnergy[2] > 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[13]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
   ; SAC 1/6/18 - Battery adjustments for GHC (grid harmonization credit)
	"Set ResultSummary[2]:Enduse99[17]"			Proj:ResultSummary[2]:Enduse99[17]	= {
         if (IfValidAnd( ResultSummary[2]:GHCEnergyEffElec > 0.00001 )==0) then  UNDEFINED  
         else  FltToStr( (int( ResultSummary[2]:GHCEnergyEffElec + 0.5 )), 0 )  endif  }
	"Adj ResultSummary[2]:Enduse14[17]"			Proj:ResultSummary[2]:Enduse14[17]	= {
         if (LocalStatus( ResultSummary[2]:Enduse99[17] ) < 1) then  UNCHANGED  
         else if (ResultSummary[2]:GHCEnergyEffCap >= (-1 * RunResultsN[14]:ProposedTDV[3])) then  UNDEFINED
         else  FltToStr( (int( (RunResultsN[14]:PropElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 ) -
                          int( ResultSummary[2]:GHCEnergyEffElec + 0.5 )), 0 )  endif endif  }
   ; SAC 1/22/18 - Battery adjustments for GHC to Compliance Enduse Details (grid harmonization credit)
	"Set ResultSummary[2]:Enduse99[2]"			Proj:ResultSummary[2]:Enduse99[2]	= {
         if (IfValidAnd( ResultSummary[2]:GHCEnergyEffElec > 0.00001 )==0) then  UNDEFINED  
         else  FltToStr( (int( ResultSummary[2]:GHCEnergyEffElec + 0.5 )), 0 )  endif  }
	"Adj ResultSummary[2]:Enduse14[2]"			Proj:ResultSummary[2]:Enduse14[2]	= {
         if (LocalStatus( ResultSummary[2]:Enduse99[2] ) < 1) then  UNCHANGED  
         else if (ResultSummary[2]:GHCEnergyEffCap >= (-1 * RunResultsN[14]:ProposedTDV[1])) then  UNDEFINED
         else  FltToStr( (int( (RunResultsN[14]:PropElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 ) -
                          int( ResultSummary[2]:GHCEnergyEffElec + 0.5 )), 0 )  endif endif  }
   ; SAC 2/2/19 - revised logic to reference new PFlxTDV property (tic #1053)
	"Set ResultSummary[2]:Enduse98[17]"			Proj:ResultSummary[2]:Enduse98[17]	= {
			if (LocalStatus( ResultSummary[2]:PFlxElecEnergy[1] ) < 1) then  UNDEFINED
         else  FltToStr( ResultSummary[2]:PFlxElecEnergy[1], 0 )  endif  }
	"Set ResultSummary[2]:Enduse98[2]"			Proj:ResultSummary[2]:Enduse98[2]	= {  ResultSummary[2]:Enduse98[17]  }
	"Set ResultSummary[2]:Enduse10[2]"			Proj:ResultSummary[2]:Enduse10[2]	= {
	      if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  
			else  FltToStr( (int( ( RunResultsN[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )) + ValidOr( ResultSummary[2]:PFlxElecEnergy[1], 0 ), 0 )  endif  }

  ; Proposed Site FUEL Use
	"Set ResultSummary[2]:Enduse6[18]"			Proj:ResultSummary[2]:Enduse6[18]	= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0 .OR. (RunResultsN[6]:PropNatGasEnergy[2]  < 0.00001 .AND. RunResultsN[6]:PropOtherEnergy[2]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr(      ((RunResultsN[6]:PropNatGasEnergy[2]  + RunResultsN[6]:PropOtherEnergy[2] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse10[18]"			Proj:ResultSummary[2]:Enduse10[18]	= {
	      if (LocalCompAssigned( RunResultsN[10] ) == 0 .OR. (RunResultsN[10]:PropNatGasEnergy[2] < 0.00001 .AND. RunResultsN[10]:PropOtherEnergy[2] < 0.00001)) then  UNDEFINED  
			else  FltToStr( ((RunResultsN[10]:PropNatGasEnergy[2] + RunResultsN[10]:PropOtherEnergy[2]) * Proj:CondFloorArea / 100) +
                         ValidOr( ResultSummary[2]:PFlxNatGasEnergy[1], 0 ) + ValidOr( ResultSummary[2]:PFlxOtherEnergy[1], 0 ), 1 )  endif  }
	"Set ResultSummary[2]:Enduse11[18]"			Proj:ResultSummary[2]:Enduse11[18]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0 .OR. (RunResultsN[11]:PropNatGasEnergy[2] < 0.00001 .AND. RunResultsN[11]:PropOtherEnergy[2] < 0.00001)) then  UNDEFINED  
																													else  FltToStr(      ((RunResultsN[11]:PropNatGasEnergy[2] + RunResultsN[11]:PropOtherEnergy[2]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse12[18]"			Proj:ResultSummary[2]:Enduse12[18]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0 .OR. (RunResultsN[12]:PropNatGasEnergy[2] < 0.00001 .AND. RunResultsN[12]:PropOtherEnergy[2] < 0.00001)) then  UNDEFINED  
																													else  FltToStr(      ((RunResultsN[12]:PropNatGasEnergy[2] + RunResultsN[12]:PropOtherEnergy[2]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse13[18]"			Proj:ResultSummary[2]:Enduse13[18]	= {	UNDEFINED  }  ; PV
  ; Proposed TDV
	"Set ResultSummary[2]:Enduse6[19]"			Proj:ResultSummary[2]:Enduse6[19]	= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[6]:ProposedTDV[2]  ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse10[19]"			Proj:ResultSummary[2]:Enduse10[19]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[10]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse11[19]"			Proj:ResultSummary[2]:Enduse11[19]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[11]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse12[19]"			Proj:ResultSummary[2]:Enduse12[19]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[12]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse13[19]"			Proj:ResultSummary[2]:Enduse13[19]	= {	if (LocalCompAssigned( RunResultsN[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[13]:ProposedTDV[2] ), 2 )  endif  }

  ; DesignRating Site Natural Gas Use
	"Set ResultSummary[2]:Title1[13]"			Proj:ResultSummary[2]:Title1[13]		= {	if (EnergyCodeYearNum < 2022) then  "Reference"      else  UNDEFINED   endif  }
	"Set ResultSummary[2]:Title2[13]"			Proj:ResultSummary[2]:Title2[13]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "Site"  else  "Site Gas"  endif endif  }  ; SAC 12/01/22
	"Set ResultSummary[2]:Title3[13]"			Proj:ResultSummary[2]:Title3[13]		= {	if (EnergyCodeYearNum < 2022) then  "Site (therms)"  else  "(therms/yr)"  endif  }
	"Set ResultSummary[2]:Enduse1[13]"			Proj:ResultSummary[2]:Enduse1[13]	= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0 .OR.  (RunResultsN[1]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsN[1]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[1]:DRtgNatGasEnergy  + RunResultsN[1]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse2[13]"			Proj:ResultSummary[2]:Enduse2[13]	= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0 .OR.  (RunResultsN[2]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsN[2]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[2]:DRtgNatGasEnergy  + RunResultsN[2]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse3[13]"			Proj:ResultSummary[2]:Enduse3[13]	= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0 .OR.  (RunResultsN[3]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsN[3]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[3]:DRtgNatGasEnergy  + RunResultsN[3]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse4[13]"			Proj:ResultSummary[2]:Enduse4[13]	= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0 .OR.  (RunResultsN[4]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsN[4]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[4]:DRtgNatGasEnergy  + RunResultsN[4]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse5[13]"			Proj:ResultSummary[2]:Enduse5[13]	= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0 .OR.  (RunResultsN[5]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsN[5]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[5]:DRtgNatGasEnergy  + RunResultsN[5]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse14[13]"			Proj:ResultSummary[2]:Enduse14[13]	= {	if (LocalCompAssigned( RunResultsN[14] ) == 0 .OR.  (RunResultsN[14]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsN[14]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[14]:DRtgNatGasEnergy + RunResultsN[14]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse6[13]"			Proj:ResultSummary[2]:Enduse6[13]	= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0 .OR.  (RunResultsN[6]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsN[6]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[6]:DRtgNatGasEnergy  + RunResultsN[6]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse7[13]"			Proj:ResultSummary[2]:Enduse7[13]	= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0 .OR.  (RunResultsN[7]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsN[7]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[7]:DRtgNatGasEnergy  + RunResultsN[7]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse8[13]"			Proj:ResultSummary[2]:Enduse8[13]	= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0 .OR.  (RunResultsN[8]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsN[8]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[8]:DRtgNatGasEnergy  + RunResultsN[8]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse9[13]"			Proj:ResultSummary[2]:Enduse9[13]	= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0 .OR.  (RunResultsN[9]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsN[9]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[9]:DRtgNatGasEnergy  + RunResultsN[9]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse10[13]"			Proj:ResultSummary[2]:Enduse10[13]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0 .OR.  (RunResultsN[10]:DRtgNatGasEnergy < 0.00001 .AND. RunResultsN[10]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[10]:DRtgNatGasEnergy + RunResultsN[10]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse11[13]"			Proj:ResultSummary[2]:Enduse11[13]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0 .OR.  (RunResultsN[11]:DRtgNatGasEnergy < 0.00001 .AND. RunResultsN[11]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[11]:DRtgNatGasEnergy + RunResultsN[11]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse12[13]"			Proj:ResultSummary[2]:Enduse12[13]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0 .OR.  (RunResultsN[12]:DRtgNatGasEnergy < 0.00001 .AND. RunResultsN[12]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[12]:DRtgNatGasEnergy + RunResultsN[12]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
   ; SAC 2/2/19 - Flexibility results via new PFlxTDV property (tic #1053)
	"Set ResultSummary[2]:Enduse98[18]"			Proj:ResultSummary[2]:Enduse98[18]	= {
         if (LocalStatus( ResultSummary[2]:PFlxNatGasEnergy[1] ) < 1 .AND. LocalStatus( ResultSummary[2]:PFlxOtherEnergy[1] ) < 1) then  UNDEFINED  
         else  FltToStr( ValidOr( ResultSummary[2]:PFlxNatGasEnergy[1], 0 ) + ValidOr( ResultSummary[2]:PFlxOtherEnergy[1], 0 ), 1 )  endif  }
	"Set ResultSummary[2]:Enduse98[3]"			Proj:ResultSummary[2]:Enduse98[3]	= {  ResultSummary[2]:Enduse98[18]  }
	"Set ResultSummary[2]:Enduse10[3]"			Proj:ResultSummary[2]:Enduse10[3]	= {
	      if (LocalCompAssigned( RunResultsN[10] ) == 0 .OR. (RunResultsN[10]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsN[10]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
			else  FltToStr( (int(((RunResultsN[10]:PropNatGasEnergy[1] + RunResultsN[10]:PropOtherEnergy[1]) * Proj:CondFloorArea / 10)+0.5) / 10) +
                        ValidOr( ResultSummary[2]:PFlxNatGasEnergy[1], 0 ) + ValidOr( ResultSummary[2]:PFlxOtherEnergy[1], 0 ), 1 )  endif  }
  ; DesignRating TDV
	"Set ResultSummary[2]:Title1[14]"			Proj:ResultSummary[2]:Title1[14]		= {	if (EnergyCodeYearNum < 2022) then  "Reference"      else  UNDEFINED        endif  }
	"Set ResultSummary[2]:Title2[14]"			Proj:ResultSummary[2]:Title2[14]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else  "EDR2"           endif  }
	"Set ResultSummary[2]:Title3[14]"			Proj:ResultSummary[2]:Title3[14]		= {	if (EnergyCodeYearNum < 2022) then  "(kTDV/ft-yr)"  else if (EnergyCodeYearNum < 2025) then  "(kTDV/ft-yr)"  else  "($/ft)"  endif endif  }  ; SAC 12/01/22
   ; SAC 10/2/17 - switched from reporting DRtgTDV w/o fuel adjustment mult applied to DRtgTDV W/ fuel adjustment mult applied
	"Set ResultSummary[2]:Enduse1[14]"			Proj:ResultSummary[2]:Enduse1[14]	= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[1]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse2[14]"			Proj:ResultSummary[2]:Enduse2[14]	= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[2]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse3[14]"			Proj:ResultSummary[2]:Enduse3[14]	= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[3]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse4[14]"			Proj:ResultSummary[2]:Enduse4[14]	= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[4]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse5[14]"			Proj:ResultSummary[2]:Enduse5[14]	= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[5]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse6[14]"			Proj:ResultSummary[2]:Enduse6[14]	= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[6]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse7[14]"			Proj:ResultSummary[2]:Enduse7[14]	= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[7]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse8[14]"			Proj:ResultSummary[2]:Enduse8[14]	= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[8]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse9[14]"			Proj:ResultSummary[2]:Enduse9[14]	= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[9]:DesignRatingTDV[2]  ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse10[14]"			Proj:ResultSummary[2]:Enduse10[14]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[10]:DesignRatingTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse11[14]"			Proj:ResultSummary[2]:Enduse11[14]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[11]:DesignRatingTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse12[14]"			Proj:ResultSummary[2]:Enduse12[14]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[12]:DesignRatingTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse13[14]"			Proj:ResultSummary[2]:Enduse13[14]	= {	if (LocalCompAssigned( RunResultsN[13] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsN[13]:DesignRatingTDV[2] = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsN[13]:DesignRatingTDV[2] ), 2 )  endif endif  }
	"Set ResultSummary[2]:Enduse14[14]"			Proj:ResultSummary[2]:Enduse14[14]	= {	if (LocalCompAssigned( RunResultsN[14] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsN[14]:DesignRatingTDV[2] = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsN[14]:DesignRatingTDV[2] ), 2 )  endif endif  }

; mjb-10/16/13	subtract PVCredit from Prop Design - N
;	"Set ResultSummary[2]:Enduse13[19]"			Proj:ResultSummary[2]:Enduse13[19]	= {	if (EnergyCodeYearNum >= 2019)
;                                                                                 then  if (LocalCompAssigned( RunResultsN[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[13]:ProposedTDV[2] ), 2 )  endif
;                                                                                 else  if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( (RunResultsN[6]:PropPVCreditTDV[2] * -1), 2 )  endif endif  }
	"Set ResultSummary[2]:Enduse13[19]"			Proj:ResultSummary[2]:Enduse13[19]	= {	if (LocalCompAssigned( RunResultsN[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[13]:ProposedTDV[2] ), 2 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
 	"Set ResultSummary[2]:Enduse10[19]"			Proj:ResultSummary[2]:Enduse10[19]	= {
 	      if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED
 	      else  FltToStr( (RunResultsN[10]:ProposedTDV[2] + ValidOr( ResultSummary[2]:PFlxTDV[1], 0 )), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse11[19]"			Proj:ResultSummary[2]:Enduse11[19]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[11]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse12[19]"			Proj:ResultSummary[2]:Enduse12[19]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[12]:ProposedTDV[2] ), 2 )  endif  }
   ; SAC 1/7/18 - Battery adjustments for GHC (grid harmonization credit)
	"Set ResultSummary[2]:Enduse99[19]"			Proj:ResultSummary[2]:Enduse99[19]	= {
         if (IfValidAnd( ResultSummary[2]:GHCEnergyEffTDV > 0.00001 )==0) then  "0.00"  
         else  FltToStr( (-1 * ResultSummary[2]:GHCEnergyEffTDV), 2 )  endif  }
	"Adj ResultSummary[2]:Enduse14[19]"			Proj:ResultSummary[2]:Enduse14[19]	= {
         if (IfValidAnd( ResultSummary[2]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResultsN[14]:ProposedTDV[3] + ResultSummary[2]:GHCEnergyEffTDV), 2 )  endif  }
   ; SAC 1/22/18 - Battery adjustments for GHC to Compliance Enduse Details (grid harmonization credit)
	"Set ResultSummary[2]:Enduse99[4]"			Proj:ResultSummary[2]:Enduse99[4]	= {
         if (IfValidAnd( ResultSummary[2]:GHCEnergyEffTDV > 0.00001 )==0) then  "0.00"  
         else  FltToStr( (-1 * ResultSummary[2]:GHCEnergyEffTDV), 2 )  endif  }
	"Adj ResultSummary[2]:Enduse14[4]"			Proj:ResultSummary[2]:Enduse14[4]	= {
         if (IfValidAnd( ResultSummary[2]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResultsN[14]:ProposedTDV[1] + ResultSummary[2]:GHCEnergyEffTDV), 2 )  endif  }
   ; SAC 2/2/19 - Reporting of Flexibility credit (tic #1053)
	"Set ResultSummary[2]:Enduse98[19]"			Proj:ResultSummary[2]:Enduse98[19]	= {
			if (LocalStatus( ResultSummary[2]:PFlxTDV[1] ) < 1) then  UNDEFINED
         else  FltToStr( ResultSummary[2]:PFlxTDV[1], 2 )  endif  }
	"Set ResultSummary[2]:Enduse98[4]"			Proj:ResultSummary[2]:Enduse98[4]	= {  ResultSummary[2]:Enduse98[19]  }
	"Set ResultSummary[2]:Enduse10[4]"			Proj:ResultSummary[2]:Enduse10[4]	= {
	      if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED
	      else  FltToStr( (int(RunResultsN[10]:ProposedTDV[1]*100+0.5)/100) + ValidOr( ResultSummary[2]:PFlxTDV[1], 0 ), 2 )  endif  }

  ; DesignRating Margin TDV
	"Set ResultSummary[2]:Title1[15]"			Proj:ResultSummary[2]:Title1[15]		= {	if (EnergyCodeYearNum < 2022) then  "Design Rating"  else if (EnergyCodeYearNum < 2025) then  "Design Rating Margins:"  else  "Design Rating Margins"  endif endif  }  ; SAC 12/01/22
	"Set ResultSummary[2]:Title2[15]"			Proj:ResultSummary[2]:Title2[15]		= {	if (EnergyCodeYearNum < 2022) then  "Margin"         else  "EDR2"                    endif  }
	"Set ResultSummary[2]:Title3[15]"			Proj:ResultSummary[2]:Title3[15]		= {	if (EnergyCodeYearNum < 2022) then  "(kTDV/ft-yr)"  else if (EnergyCodeYearNum < 2025) then  "(kTDV/ft-yr)"  else  "($/ft)"  endif endif  }  ; SAC 12/01/22
   ; SAC 10/2/17 - switched from reporting delta with DRtgTDV w/o fuel adjustment mult applied to DRtgTDV W/ fuel adjustment mult applied
	"Set ResultSummary[2]:Enduse1[15]"			Proj:ResultSummary[2]:Enduse1[15]	= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[1]:DesignRatingTDV[2]  - RunResultsN[1]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse2[15]"			Proj:ResultSummary[2]:Enduse2[15]	= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[2]:DesignRatingTDV[2]  - RunResultsN[2]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse3[15]"			Proj:ResultSummary[2]:Enduse3[15]	= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[3]:DesignRatingTDV[2]  - RunResultsN[3]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse4[15]"			Proj:ResultSummary[2]:Enduse4[15]	= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[4]:DesignRatingTDV[2]  - RunResultsN[4]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse5[15]"			Proj:ResultSummary[2]:Enduse5[15]	= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[5]:DesignRatingTDV[2]  - RunResultsN[5]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse14[15]"			Proj:ResultSummary[2]:Enduse14[15]	= {	if (LocalCompAssigned( RunResultsN[14] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[14]:DesignRatingTDV[2] - RunResultsN[14]:ProposedTDV[2] ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse6[15]"			Proj:ResultSummary[2]:Enduse6[15]	= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[6]:DesignRatingTDV[2]  - RunResultsN[6]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse7[15]"			Proj:ResultSummary[2]:Enduse7[15]	= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[7]:DesignRatingTDV[2]  - RunResultsN[7]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse8[15]"			Proj:ResultSummary[2]:Enduse8[15]	= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[8]:DesignRatingTDV[2]  - RunResultsN[8]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse9[15]"			Proj:ResultSummary[2]:Enduse9[15]	= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[9]:DesignRatingTDV[2]  - RunResultsN[9]:ProposedTDV[2]  ), 2 )  endif  }
   ; SAC 2/2/19 - Flexibility reporting via new PFlxTDV property (tic #1053)
 	"Set ResultSummary[2]:Enduse10[15]"			Proj:ResultSummary[2]:Enduse10[15]	= {
 	      if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED
 	      else  FltToStr( (int((RunResultsN[10]:DesignRatingTDV[2]*100)+0.5) - int((RunResultsN[10]:ProposedTDV[2]*100)+0.5)) / 100 - ValidOr( ResultSummary[2]:PFlxTDV[1], 0 ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse11[15]"			Proj:ResultSummary[2]:Enduse11[15]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[11]:DesignRatingTDV[2] - RunResultsN[11]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse12[15]"			Proj:ResultSummary[2]:Enduse12[15]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[12]:DesignRatingTDV[2] - RunResultsN[12]:ProposedTDV[2] ), 2 )  endif  }
 	;"Set ResultSummary[2]:Enduse13[15]"			Proj:ResultSummary[2]:Enduse13[15]	= {	FltToStr( PVCredit, 2 )  }
 	;"Set ResultSummary[2]:Enduse13[15]"			Proj:ResultSummary[2]:Enduse13[15]	= {	if (EnergyCodeYearNum >= 2019)
   ;                                                                              then  if (LocalCompAssigned( RunResultsN[13] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[13]:CompMarginTDV,     2 )  endif
   ;                                                                              else  if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[6]:PropPVCreditTDV[2], 2 )  endif endif  }
 	;"Set ResultSummary[2]:Enduse13[15]"			Proj:ResultSummary[2]:Enduse13[15]	= {	if (LocalCompAssigned( RunResultsN[13] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[13]:CompMarginTDV,     2 )  endif  }
 	"Set ResultSummary[2]:Enduse13[15]"			Proj:ResultSummary[2]:Enduse13[15]	= {	if (LocalCompAssigned( RunResultsN[13] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[13]:DesignRatingTDV[2] - RunResultsN[13]:ProposedTDV[2] ), 2 )  endif  }
   ; SAC 1/7/18 - Battery adjustments for GHC (grid harmonization credit)
	"Set ResultSummary[2]:Enduse99[15]"			Proj:ResultSummary[2]:Enduse99[15]	= {
         if (IfValidAnd( ResultSummary[2]:GHCEnergyEffTDV > 0.00001 )==0) then  "0.00"  
         else  FltToStr( ResultSummary[2]:GHCEnergyEffTDV, 2 )  endif  }
	"Adj ResultSummary[2]:Enduse14[15]"			Proj:ResultSummary[2]:Enduse14[15]	= {
         if (IfValidAnd( ResultSummary[2]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResultsN[14]:DesignRatingTDV[2] - RunResultsN[14]:ProposedTDV[2] - ResultSummary[2]:GHCEnergyEffTDV), 2 )  endif  }
   ; SAC 1/22/18 - Battery adjustments for GHC to Compliance Enduse Details (grid harmonization credit)
	"Set ResultSummary[2]:Enduse99[8]"			Proj:ResultSummary[2]:Enduse99[8]	= {
         if (IfValidAnd( ResultSummary[2]:GHCEnergyEffTDV > 0.00001 )==0) then  "0.00"  
         else  FltToStr( ResultSummary[2]:GHCEnergyEffTDV, 2 )  endif  }
	"Adj ResultSummary[2]:Enduse14[8]"			Proj:ResultSummary[2]:Enduse14[8]	= {
         if (IfValidAnd( ResultSummary[2]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResultsN[14]:StandardTDV - RunResultsN[14]:ProposedTDV[1] - ResultSummary[2]:GHCEnergyEffTDV), 2 )  endif  }
   ; SAC 1/22/18 - Compliance Total adjustments for Battery GHC (grid harmonization credit)
	"Adj ResultSummary[2]:Enduse11[4]"			Proj:ResultSummary[2]:Enduse11[4]	= {
         if (LocalCompAssigned( RunResultsN[11] ) == 0 .OR. IfValidAnd( ResultSummary[2]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else  FltToStr( (RunResultsN[11]:ProposedTDV[1] - ResultSummary[2]:GHCEnergyEffTDV), 2 )  endif  }
 	"Adj ResultSummary[2]:Enduse11[8]"			Proj:ResultSummary[2]:Enduse11[8]	= {
         if (LocalCompAssigned( RunResultsN[11] ) == 0 .OR. IfValidAnd( ResultSummary[2]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else  FltToStr( (RunResultsN[11]:CompMarginTDV + ResultSummary[2]:GHCEnergyEffTDV), 2 )  endif  }
	"Adj ResultSummary[2]:PctSavingsCmpTDV"	Proj:ResultSummary[2]:PctSavingsCmpTDV	= {
         if (IfValidAnd( RunResultsN[11]:StandardTDV > 0.001 )==0 .OR. IfValidAnd( ResultSummary[2]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else  int((((RunResultsN[11]:StandardTDV - ValidOr( RunResultsN[11]:ProposedTDV[1], 0 ) + ResultSummary[2]:GHCEnergyEffTDV) * 100 / RunResultsN[11]:StandardTDV ) * 10) +0.5 ) / 10  endif  }
	"Adj ResultSummary[2]:PctSavCmpTDVLbl"		Proj:ResultSummary[2]:PctSavCmpTDVLbl	= {
         if (IfValidAnd( ResultSummary[2]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else if (IfValidAnd( ResultSummary[2]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[2]:PctSavingsCmpTDV < -0.0001 )==0) then  "-" 
         else  Format( "%.1f", ResultSummary[2]:PctSavingsCmpTDV )  endif endif  }
   ; SAC 2/2/19 - Reporting of Flexibility credit (tic #1053)
	"Set ResultSummary[2]:Enduse98[15]"			Proj:ResultSummary[2]:Enduse98[15]	= {  FltToStr( -ValidOr( ResultSummary[2]:PFlxTDV[1], 0 ), 2 )  }

;	  ; Pass/Fail result
;	 	"Set ResultSummary[2]:PassFail"				Proj:ResultSummary[2]:PassFail		= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  if (RunResultsN[11]:CompMarginTDV >= 0) then "PASS"  else  "FAIL"  endif endif  }

  ; DesignRating Electric Demand
	"Set ResultSummary[2]:Title1[16]"			Proj:ResultSummary[2]:Title1[16]		= {	"Reference"  }
	"Set ResultSummary[2]:Title2[16]"			Proj:ResultSummary[2]:Title2[16]		= {	"Design"     }
	"Set ResultSummary[2]:Title3[16]"			Proj:ResultSummary[2]:Title3[16]		= {	"(kW)"  }
	"Set ResultSummary[2]:Enduse1[16]"			Proj:ResultSummary[2]:Enduse1[16]	= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[1]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse2[16]"			Proj:ResultSummary[2]:Enduse2[16]	= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[2]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse3[16]"			Proj:ResultSummary[2]:Enduse3[16]	= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[3]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse4[16]"			Proj:ResultSummary[2]:Enduse4[16]	= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[4]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse5[16]"			Proj:ResultSummary[2]:Enduse5[16]	= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[5]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse14[16]"			Proj:ResultSummary[2]:Enduse14[16]	= {	if (LocalCompAssigned( RunResultsN[14] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[14]:DRtgElecDemand ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse6[16]"			Proj:ResultSummary[2]:Enduse6[16]	= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[6]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse7[16]"			Proj:ResultSummary[2]:Enduse7[16]	= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[7]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse8[16]"			Proj:ResultSummary[2]:Enduse8[16]	= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[8]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse9[16]"			Proj:ResultSummary[2]:Enduse9[16]	= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[9]:DRtgElecDemand  ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse10[16]"			Proj:ResultSummary[2]:Enduse10[16]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[10]:DRtgElecDemand ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse11[16]"			Proj:ResultSummary[2]:Enduse11[16]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[11]:DRtgElecDemand ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse12[16]"			Proj:ResultSummary[2]:Enduse12[16]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[12]:DRtgElecDemand ), 2 )  endif  }

  ; Additional elec demand storage (SAC 10/26/16)
   "Set ResultSummary[2]:PropElecDemand[2]"  Proj:ResultSummary[2]:PropElecDemand[2]   = {   if (LocalCompAssigned( RunResultsN[10] ) == 0 .OR. LocalStatus( RunResultsN[10]:PropElecDemand[2] ) < 1) then  UNDEFINED
																												         else  ValidOr( RunResultsN[10]:PropElecDemand[2], 0 )  endif  }
   "Set ResultSummary[2]:DRtgElecDemand"     Proj:ResultSummary[2]:DRtgElecDemand      = {   if (LocalCompAssigned( RunResultsN[10] ) == 0 .OR. LocalStatus( RunResultsN[10]:DRtgElecDemand ) < 1) then  UNDEFINED
																												         else  ValidOr( RunResultsN[10]:DRtgElecDemand, 0 )  endif  }
	"Set ResultSummary[2]:MarginkW[2]"		   Proj:ResultSummary[2]:MarginkW[2]	      = {	if (LocalCompAssigned( RunResultsN[10] ) == 0 .OR. LocalStatus( ResultSummary[2]:PropElecDemand[2] ) < 1) then  UNDEFINED
																												         else  int(((ResultSummary[2]:DRtgElecDemand - ResultSummary[2]:PropElecDemand[2]) * 100) +0.5 ) / 100  endif  }

;	  ; Demand & Energy Use Margins (added w/ CAHP mods 10/8/14)
;		"Set ResultSummary[2]:MarginkW"			Proj:ResultSummary[2]:MarginkW		= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED
;																													else  ValidOr( RunResults[10]:StdElecDemand, 0 ) - ValidOr( RunResultsN[10]:PropElecDemand[2], 0 )  endif  }
;		"Set ResultSummary[2]:MarginkWh"			Proj:ResultSummary[2]:MarginkWh		= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED
;																													else  (ValidOr( RunResults[10]:StdElecEnergy, 0 ) - ValidOr( RunResultsN[10]:PropElecEnergy, 0 )) * CondFloorArea / 3.413  endif  }
;		"Set ResultSummary[2]:MarginTherms"		Proj:ResultSummary[2]:MarginTherms	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED
;																													else  (ValidOr( RunResults[10]:StdNatGasEnergy, 0 ) - ValidOr( RunResultsN[10]:PropNatGasEnergy, 0 )) * CondFloorArea / 100  endif  }
;	  ; Percent Savings values for reporting
;		"Set ResultSummary[2]:PctSavingskW"			Proj:ResultSummary[2]:PctSavingskW		= {	if (IfValidAnd( RunResults[10]:StdElecDemand > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StdElecDemand   - ValidOr( RunResultsN[10]:PropElecDemand[2],   0 )) * 100 / RunResults[10]:StdElecDemand    endif  }
;		"Set ResultSummary[2]:PctSavingskWh"		Proj:ResultSummary[2]:PctSavingskWh		= {	if (IfValidAnd( RunResults[10]:StdElecEnergy > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StdElecEnergy   - ValidOr( RunResultsN[10]:PropElecEnergy,   0 )) * 100 / RunResults[10]:StdElecEnergy    endif  }
;		"Set ResultSummary[2]:PctSavingsTherms"	Proj:ResultSummary[2]:PctSavingsTherms	= {	if (IfValidAnd( RunResults[10]:StdNatGasEnergy > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StdNatGasEnergy - ValidOr( RunResultsN[10]:PropNatGasEnergy, 0 )) * 100 / RunResults[10]:StdNatGasEnergy  endif  }
;		"Set ResultSummary[2]:PctSavingsTDV"		Proj:ResultSummary[2]:PctSavingsTDV		= {	if (IfValidAnd( RunResults[10]:StandardTDV     > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StandardTDV     - ValidOr( RunResultsN[10]:ProposedTDV[2],      0 )) * 100 / RunResults[10]:StandardTDV      endif  }
;		"Set ResultSummary[2]:PctSavingsCmpTDV"	Proj:ResultSummary[2]:PctSavingsCmpTDV	= {	if (IfValidAnd( RunResults[11]:StandardTDV     > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[11]:StandardTDV     - ValidOr( RunResultsN[11]:ProposedTDV[2],      0 )) * 100 / RunResults[11]:StandardTDV      endif  }
;		"Set ResultSummary[2]:PctSavkWLbl"			Proj:ResultSummary[2]:PctSavkWLbl		= {	if (IfValidAnd( ResultSummary[2]:PctSavingskW     > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[2]:PctSavingskW     < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[2]:PctSavingskW     )  endif  }
;		"Set ResultSummary[2]:PctSavkWhLbl"			Proj:ResultSummary[2]:PctSavkWhLbl		= {	if (IfValidAnd( ResultSummary[2]:PctSavingskWh    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[2]:PctSavingskWh    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[2]:PctSavingskWh    )  endif  }
;		"Set ResultSummary[2]:PctSavThermsLbl"		Proj:ResultSummary[2]:PctSavThermsLbl	= {	if (IfValidAnd( ResultSummary[2]:PctSavingsTherms > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[2]:PctSavingsTherms < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[2]:PctSavingsTherms )  endif  }
;		"Set ResultSummary[2]:PctSavTDVLbl"			Proj:ResultSummary[2]:PctSavTDVLbl		= {	if (IfValidAnd( ResultSummary[2]:PctSavingsTDV    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[2]:PctSavingsTDV    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[2]:PctSavingsTDV    )  endif  }
;		"Set ResultSummary[2]:PctSavCmpTDVLbl"		Proj:ResultSummary[2]:PctSavCmpTDVLbl	= {	if (IfValidAnd( ResultSummary[2]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[2]:PctSavingsCmpTDV < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[2]:PctSavingsCmpTDV )  endif  }

; -- EAST Facing --
  ; DesignRating Site Electric Use
	"Set ResultSummary[3]:Title1[12]"			Proj:ResultSummary[3]:Title1[12]		= {	if (EnergyCodeYearNum < 2022) then  "Reference"   else  "Reference Design:"  endif  }
	"Set ResultSummary[3]:Title2[12]"			Proj:ResultSummary[3]:Title2[12]		= {	if (EnergyCodeYearNum < 2022) then  "Design"      else if (EnergyCodeYearNum < 2025) then  "Site"  else  "Site Elec."  endif endif  }  ; SAC 12/01/22
	"Set ResultSummary[3]:Title3[12]"			Proj:ResultSummary[3]:Title3[12]		= {	if (EnergyCodeYearNum < 2022) then  "Site (kWh)"  else  "(kWh/yr)"              endif  }
	"Set ResultSummary[3]:Enduse1[12]"			Proj:ResultSummary[3]:Enduse1[12]	= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0 .OR. RunResultsE[1]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[1]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse2[12]"			Proj:ResultSummary[3]:Enduse2[12]	= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0 .OR. RunResultsE[2]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[2]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse3[12]"			Proj:ResultSummary[3]:Enduse3[12]	= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0 .OR. RunResultsE[3]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[3]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse4[12]"			Proj:ResultSummary[3]:Enduse4[12]	= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0 .OR. RunResultsE[4]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[4]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse5[12]"			Proj:ResultSummary[3]:Enduse5[12]	= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0 .OR. RunResultsE[5]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[5]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse14[12]"			Proj:ResultSummary[3]:Enduse14[12]	= {	if (LocalCompAssigned( RunResultsE[14] ) == 0 .OR. RunResultsE[14]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[14]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse6[12]"			Proj:ResultSummary[3]:Enduse6[12]	= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0 .OR. RunResultsE[6]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[6]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse7[12]"			Proj:ResultSummary[3]:Enduse7[12]	= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0 .OR. RunResultsE[7]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[7]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse8[12]"			Proj:ResultSummary[3]:Enduse8[12]	= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0 .OR. RunResultsE[8]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[8]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse9[12]"			Proj:ResultSummary[3]:Enduse9[12]	= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0 .OR. RunResultsE[9]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[9]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse10[12]"			Proj:ResultSummary[3]:Enduse10[12]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0 .OR. RunResultsE[10]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[10]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse11[12]"			Proj:ResultSummary[3]:Enduse11[12]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0 .OR. RunResultsE[11]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[11]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse12[12]"			Proj:ResultSummary[3]:Enduse12[12]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0 .OR. RunResultsE[12]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[12]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
  ; SAC 4/8/15 - refresh lighting and total Proposed results following (possible) resets due to design rating lighting credit reductions
  ; SAC 6/25/17 - updated to include PV results
  ; Proposed Site ELEC Use
	"Set ResultSummary[3]:Enduse6[17]"			Proj:ResultSummary[3]:Enduse6[17]	= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0 .OR. RunResultsE[6]:PropElecEnergy[2]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[6]:PropElecEnergy[2]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
   ; SAC 2/2/19 - Incorporate Flexibility credit into totals via new EUseSummary:PFlx* properties (tic #1053)
	"Set ResultSummary[3]:Enduse10[17]"			Proj:ResultSummary[3]:Enduse10[17]	= {
	      if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  
			else  FltToStr( (int( (RunResultsE[10]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )) + ValidOr( ResultSummary[3]:PFlxElecEnergy[1], 0 ), 0 )  endif  }
	"Set ResultSummary[3]:Enduse11[17]"			Proj:ResultSummary[3]:Enduse11[17]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0 .OR. RunResultsE[11]:PropElecEnergy[2] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[11]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse12[17]"			Proj:ResultSummary[3]:Enduse12[17]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0 .OR. RunResultsE[12]:PropElecEnergy[2] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[12]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse13[17]"			Proj:ResultSummary[3]:Enduse13[17]	= {	if (LocalCompAssigned( RunResultsE[13] ) == 0 .OR. RunResultsE[13]:PropElecEnergy[2] > 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[13]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
   ; SAC 1/6/18 - Battery adjustments for GHC (grid harmonization credit)
	"Set ResultSummary[3]:Enduse99[17]"			Proj:ResultSummary[3]:Enduse99[17]	= {
         if (IfValidAnd( ResultSummary[3]:GHCEnergyEffElec > 0.00001 )==0) then  UNDEFINED  
         else  FltToStr( (int( ResultSummary[3]:GHCEnergyEffElec + 0.5 )), 0 )  endif  }
	"Adj ResultSummary[3]:Enduse14[17]"			Proj:ResultSummary[3]:Enduse14[17]	= {
         if (LocalStatus( ResultSummary[3]:Enduse99[17] ) < 1) then  UNCHANGED  
         else if (ResultSummary[3]:GHCEnergyEffCap >= (-1 * RunResultsE[14]:ProposedTDV[3])) then  UNDEFINED
         else  FltToStr( (int( (RunResultsE[14]:PropElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 ) -
                          int( ResultSummary[3]:GHCEnergyEffElec + 0.5 )), 0 )  endif endif  }
   ; SAC 1/22/18 - Battery adjustments for GHC to Compliance Enduse Details (grid harmonization credit)
	"Set ResultSummary[3]:Enduse99[2]"			Proj:ResultSummary[3]:Enduse99[2]	= {
         if (IfValidAnd( ResultSummary[3]:GHCEnergyEffElec > 0.00001 )==0) then  UNDEFINED  
         else  FltToStr( (int( ResultSummary[3]:GHCEnergyEffElec + 0.5 )), 0 )  endif  }
	"Adj ResultSummary[3]:Enduse14[2]"			Proj:ResultSummary[3]:Enduse14[2]	= {
         if (LocalStatus( ResultSummary[3]:Enduse99[2] ) < 1) then  UNCHANGED  
         else if (ResultSummary[3]:GHCEnergyEffCap >= (-1 * RunResultsE[14]:ProposedTDV[1])) then  UNDEFINED
         else  FltToStr( (int( (RunResultsE[14]:PropElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 ) -
                          int( ResultSummary[3]:GHCEnergyEffElec + 0.5 )), 0 )  endif endif  }
   ; SAC 2/2/19 - revised logic to reference new PFlxTDV property (tic #1053)
	"Set ResultSummary[3]:Enduse98[17]"			Proj:ResultSummary[3]:Enduse98[17]	= {
			if (LocalStatus( ResultSummary[3]:PFlxElecEnergy[1] ) < 1) then  UNDEFINED
         else  FltToStr( ResultSummary[3]:PFlxElecEnergy[1], 0 )  endif  }
	"Set ResultSummary[3]:Enduse98[2]"			Proj:ResultSummary[3]:Enduse98[2]	= {  ResultSummary[3]:Enduse98[17]  }
	"Set ResultSummary[3]:Enduse10[2]"			Proj:ResultSummary[3]:Enduse10[2]	= {
	      if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  
			else  FltToStr( (int( ( RunResultsE[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )) + ValidOr( ResultSummary[3]:PFlxElecEnergy[1], 0 ), 0 )  endif  }

  ; Proposed Site FUEL Use
	"Set ResultSummary[3]:Enduse6[18]"			Proj:ResultSummary[3]:Enduse6[18]	= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0 .OR. (RunResultsE[6]:PropNatGasEnergy[2]  < 0.00001 .AND. RunResultsE[6]:PropOtherEnergy[2]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr(      ((RunResultsE[6]:PropNatGasEnergy[2]  + RunResultsE[6]:PropOtherEnergy[2] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse10[18]"			Proj:ResultSummary[3]:Enduse10[18]	= {
	      if (LocalCompAssigned( RunResultsE[10] ) == 0 .OR. (RunResultsE[10]:PropNatGasEnergy[2] < 0.00001 .AND. RunResultsE[10]:PropOtherEnergy[2] < 0.00001)) then  UNDEFINED  
			else  FltToStr( ((RunResultsE[10]:PropNatGasEnergy[2] + RunResultsE[10]:PropOtherEnergy[2]) * Proj:CondFloorArea / 100) +
                         ValidOr( ResultSummary[3]:PFlxNatGasEnergy[1], 0 ) + ValidOr( ResultSummary[3]:PFlxOtherEnergy[1], 0 ), 1 )  endif  }
	"Set ResultSummary[3]:Enduse11[18]"			Proj:ResultSummary[3]:Enduse11[18]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0 .OR. (RunResultsE[11]:PropNatGasEnergy[2] < 0.00001 .AND. RunResultsE[11]:PropOtherEnergy[2] < 0.00001)) then  UNDEFINED  
																													else  FltToStr(      ((RunResultsE[11]:PropNatGasEnergy[2] + RunResultsE[11]:PropOtherEnergy[2]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse12[18]"			Proj:ResultSummary[3]:Enduse12[18]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0 .OR. (RunResultsE[12]:PropNatGasEnergy[2] < 0.00001 .AND. RunResultsE[12]:PropOtherEnergy[2] < 0.00001)) then  UNDEFINED  
																													else  FltToStr(      ((RunResultsE[12]:PropNatGasEnergy[2] + RunResultsE[12]:PropOtherEnergy[2]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse13[18]"			Proj:ResultSummary[3]:Enduse13[18]	= {	UNDEFINED  }  ; PV
  ; Proposed TDV
	"Set ResultSummary[3]:Enduse6[19]"			Proj:ResultSummary[3]:Enduse6[19]	= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[6]:ProposedTDV[2]  ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse10[19]"			Proj:ResultSummary[3]:Enduse10[19]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[10]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse11[19]"			Proj:ResultSummary[3]:Enduse11[19]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[11]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse12[19]"			Proj:ResultSummary[3]:Enduse12[19]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[12]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse13[19]"			Proj:ResultSummary[3]:Enduse13[19]	= {	if (LocalCompAssigned( RunResultsE[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[13]:ProposedTDV[2] ), 2 )  endif  }

  ; DesignRating Site Natural Gas Use
	"Set ResultSummary[3]:Title1[13]"			Proj:ResultSummary[3]:Title1[13]		= {	if (EnergyCodeYearNum < 2022) then  "Reference"      else  UNDEFINED   endif  }
	"Set ResultSummary[3]:Title2[13]"			Proj:ResultSummary[3]:Title2[13]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "Site"  else  "Site Gas"  endif endif  }  ; SAC 12/01/22
	"Set ResultSummary[3]:Title3[13]"			Proj:ResultSummary[3]:Title3[13]		= {	if (EnergyCodeYearNum < 2022) then  "Site (therms)"  else  "(therms/yr)"  endif  }
	"Set ResultSummary[3]:Enduse1[13]"			Proj:ResultSummary[3]:Enduse1[13]	= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0 .OR.  (RunResultsE[1]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsE[1]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[1]:DRtgNatGasEnergy  + RunResultsE[1]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse2[13]"			Proj:ResultSummary[3]:Enduse2[13]	= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0 .OR.  (RunResultsE[2]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsE[2]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[2]:DRtgNatGasEnergy  + RunResultsE[2]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse3[13]"			Proj:ResultSummary[3]:Enduse3[13]	= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0 .OR.  (RunResultsE[3]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsE[3]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[3]:DRtgNatGasEnergy  + RunResultsE[3]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse4[13]"			Proj:ResultSummary[3]:Enduse4[13]	= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0 .OR.  (RunResultsE[4]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsE[4]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[4]:DRtgNatGasEnergy  + RunResultsE[4]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse5[13]"			Proj:ResultSummary[3]:Enduse5[13]	= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0 .OR.  (RunResultsE[5]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsE[5]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[5]:DRtgNatGasEnergy  + RunResultsE[5]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse14[13]"			Proj:ResultSummary[3]:Enduse14[13]	= {	if (LocalCompAssigned( RunResultsE[14] ) == 0 .OR.  (RunResultsE[14]:DRtgNatGasEnergy < 0.00001 .AND. RunResultsE[14]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[14]:DRtgNatGasEnergy + RunResultsE[14]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse6[13]"			Proj:ResultSummary[3]:Enduse6[13]	= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0 .OR.  (RunResultsE[6]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsE[6]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[6]:DRtgNatGasEnergy  + RunResultsE[6]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse7[13]"			Proj:ResultSummary[3]:Enduse7[13]	= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0 .OR.  (RunResultsE[7]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsE[7]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[7]:DRtgNatGasEnergy  + RunResultsE[7]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse8[13]"			Proj:ResultSummary[3]:Enduse8[13]	= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0 .OR.  (RunResultsE[8]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsE[8]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[8]:DRtgNatGasEnergy  + RunResultsE[8]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse9[13]"			Proj:ResultSummary[3]:Enduse9[13]	= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0 .OR.  (RunResultsE[9]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsE[9]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[9]:DRtgNatGasEnergy  + RunResultsE[9]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse10[13]"			Proj:ResultSummary[3]:Enduse10[13]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0 .OR.  (RunResultsE[10]:DRtgNatGasEnergy < 0.00001 .AND. RunResultsE[10]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[10]:DRtgNatGasEnergy + RunResultsE[10]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse11[13]"			Proj:ResultSummary[3]:Enduse11[13]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0 .OR.  (RunResultsE[11]:DRtgNatGasEnergy < 0.00001 .AND. RunResultsE[11]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[11]:DRtgNatGasEnergy + RunResultsE[11]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse12[13]"			Proj:ResultSummary[3]:Enduse12[13]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0 .OR.  (RunResultsE[12]:DRtgNatGasEnergy < 0.00001 .AND. RunResultsE[12]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[12]:DRtgNatGasEnergy + RunResultsE[12]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
   ; SAC 2/2/19 - Flexibility results via new PFlxTDV property (tic #1053)
	"Set ResultSummary[3]:Enduse98[18]"			Proj:ResultSummary[3]:Enduse98[18]	= {
         if (LocalStatus( ResultSummary[3]:PFlxNatGasEnergy[1] ) < 1 .AND. LocalStatus( ResultSummary[3]:PFlxOtherEnergy[1] ) < 1) then  UNDEFINED  
         else  FltToStr( ValidOr( ResultSummary[3]:PFlxNatGasEnergy[1], 0 ) + ValidOr( ResultSummary[3]:PFlxOtherEnergy[1], 0 ), 1 )  endif  }
	"Set ResultSummary[3]:Enduse98[3]"			Proj:ResultSummary[3]:Enduse98[3]	= {  ResultSummary[3]:Enduse98[18]  }
	"Set ResultSummary[3]:Enduse10[3]"			Proj:ResultSummary[3]:Enduse10[3]	= {
	      if (LocalCompAssigned( RunResultsE[10] ) == 0 .OR. (RunResultsE[10]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsE[10]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
			else  FltToStr( (int(((RunResultsE[10]:PropNatGasEnergy[1] + RunResultsE[10]:PropOtherEnergy[1]) * Proj:CondFloorArea / 10)+0.5) / 10) +
                        ValidOr( ResultSummary[3]:PFlxNatGasEnergy[1], 0 ) + ValidOr( ResultSummary[3]:PFlxOtherEnergy[1], 0 ), 1 )  endif  }
  ; DesignRating TDV
	"Set ResultSummary[3]:Title1[14]"			Proj:ResultSummary[3]:Title1[14]		= {	if (EnergyCodeYearNum < 2022) then  "Reference"      else  UNDEFINED        endif  }
	"Set ResultSummary[3]:Title2[14]"			Proj:ResultSummary[3]:Title2[14]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else  "EDR2"           endif  }
	"Set ResultSummary[3]:Title3[14]"			Proj:ResultSummary[3]:Title3[14]		= {	if (EnergyCodeYearNum < 2022) then  "(kTDV/ft-yr)"  else if (EnergyCodeYearNum < 2025) then  "(kTDV/ft-yr)"  else  "($/ft)"  endif endif  }  ; SAC 12/01/22
   ; SAC 10/2/17 - switched from reporting DRtgTDV w/o fuel adjustment mult applied to DRtgTDV W/ fuel adjustment mult applied
	"Set ResultSummary[3]:Enduse1[14]"			Proj:ResultSummary[3]:Enduse1[14]	= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[1]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse2[14]"			Proj:ResultSummary[3]:Enduse2[14]	= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[2]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse3[14]"			Proj:ResultSummary[3]:Enduse3[14]	= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[3]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse4[14]"			Proj:ResultSummary[3]:Enduse4[14]	= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[4]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse5[14]"			Proj:ResultSummary[3]:Enduse5[14]	= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[5]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse6[14]"			Proj:ResultSummary[3]:Enduse6[14]	= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[6]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse7[14]"			Proj:ResultSummary[3]:Enduse7[14]	= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[7]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse8[14]"			Proj:ResultSummary[3]:Enduse8[14]	= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[8]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse9[14]"			Proj:ResultSummary[3]:Enduse9[14]	= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[9]:DesignRatingTDV[2]  ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse10[14]"			Proj:ResultSummary[3]:Enduse10[14]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[10]:DesignRatingTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse11[14]"			Proj:ResultSummary[3]:Enduse11[14]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[11]:DesignRatingTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse12[14]"			Proj:ResultSummary[3]:Enduse12[14]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[12]:DesignRatingTDV[2] ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse13[14]"			Proj:ResultSummary[3]:Enduse13[14]	= {	if (LocalCompAssigned( RunResultsE[13] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsE[13]:DesignRatingTDV[2] = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsE[13]:DesignRatingTDV[2] ), 2 )  endif endif  }
	"Set ResultSummary[3]:Enduse14[14]"			Proj:ResultSummary[3]:Enduse14[14]	= {	if (LocalCompAssigned( RunResultsE[14] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsE[14]:DesignRatingTDV[2] = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsE[14]:DesignRatingTDV[2] ), 2 )  endif endif  }

; mjb-10/16/13	subtract PVCredit from Prop Design - E
	;"Set ResultSummary[3]:Enduse13[4]"			Proj:ResultSummary[3]:Enduse13[4]	= {	FltToStr( (PVCredit * -1), 2 )  }
	;"Set ResultSummary[3]:Enduse13[19]"			Proj:ResultSummary[3]:Enduse13[19]	= {	if (EnergyCodeYearNum >= 2019)
   ;                                                                              then  if (LocalCompAssigned( RunResultsE[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[13]:ProposedTDV[2] ), 2 )  endif
   ;                                                                              else  if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( (RunResultsE[6]:PropPVCreditTDV[2] * -1), 2 )  endif endif  }
	"Set ResultSummary[3]:Enduse13[19]"			Proj:ResultSummary[3]:Enduse13[19]	= {	if (LocalCompAssigned( RunResultsE[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[13]:ProposedTDV[2] ), 2 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
 	"Set ResultSummary[3]:Enduse10[19]"			Proj:ResultSummary[3]:Enduse10[19]	= {
 	      if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED
 	      else  FltToStr( (RunResultsE[10]:ProposedTDV[2] + ValidOr( ResultSummary[3]:PFlxTDV[1], 0 )), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse11[19]"			Proj:ResultSummary[3]:Enduse11[19]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[11]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse12[19]"			Proj:ResultSummary[3]:Enduse12[19]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[12]:ProposedTDV[2] ), 2 )  endif  }
   ; SAC 1/7/18 - Battery adjustments for GHC (grid harmonization credit)
	"Set ResultSummary[3]:Enduse99[19]"			Proj:ResultSummary[3]:Enduse99[19]	= {
         if (IfValidAnd( ResultSummary[3]:GHCEnergyEffTDV > 0.00001 )==0) then  "0.00"  
         else  FltToStr( (-1 * ResultSummary[3]:GHCEnergyEffTDV), 2 )  endif  }
	"Adj ResultSummary[3]:Enduse14[19]"			Proj:ResultSummary[3]:Enduse14[19]	= {
         if (IfValidAnd( ResultSummary[3]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResultsE[14]:ProposedTDV[3] + ResultSummary[3]:GHCEnergyEffTDV), 2 )  endif  }
   ; SAC 1/22/18 - Battery adjustments for GHC to Compliance Enduse Details (grid harmonization credit)
	"Set ResultSummary[3]:Enduse99[4]"			Proj:ResultSummary[3]:Enduse99[4]	= {
         if (IfValidAnd( ResultSummary[3]:GHCEnergyEffTDV > 0.00001 )==0) then  "0.00"  
         else  FltToStr( (-1 * ResultSummary[3]:GHCEnergyEffTDV), 2 )  endif  }
	"Adj ResultSummary[3]:Enduse14[4]"			Proj:ResultSummary[3]:Enduse14[4]	= {
         if (IfValidAnd( ResultSummary[3]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResultsE[14]:ProposedTDV[1] + ResultSummary[3]:GHCEnergyEffTDV), 2 )  endif  }
   ; SAC 2/2/19 - Reporting of Flexibility credit (tic #1053)
	"Set ResultSummary[3]:Enduse98[19]"			Proj:ResultSummary[3]:Enduse98[19]	= {
			if (LocalStatus( ResultSummary[3]:PFlxTDV[1] ) < 1) then  UNDEFINED
         else  FltToStr( ResultSummary[3]:PFlxTDV[1], 2 )  endif  }
	"Set ResultSummary[3]:Enduse98[4]"			Proj:ResultSummary[3]:Enduse98[4]	= {  ResultSummary[3]:Enduse98[19]  }
	"Set ResultSummary[3]:Enduse10[4]"			Proj:ResultSummary[3]:Enduse10[4]	= {
	      if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED
	      else  FltToStr( (int(RunResultsE[10]:ProposedTDV[1]*100+0.5)/100) + ValidOr( ResultSummary[3]:PFlxTDV[1], 0 ), 2 )  endif  }

  ; DesignRating Margin TDV
	"Set ResultSummary[3]:Title1[15]"			Proj:ResultSummary[3]:Title1[15]		= {	if (EnergyCodeYearNum < 2022) then  "Design Rating"  else if (EnergyCodeYearNum < 2025) then  "Design Rating Margins:"  else  "Design Rating Margins"  endif endif  }  ; SAC 12/01/22
	"Set ResultSummary[3]:Title2[15]"			Proj:ResultSummary[3]:Title2[15]		= {	if (EnergyCodeYearNum < 2022) then  "Margin"         else  "EDR2"                    endif  }
	"Set ResultSummary[3]:Title3[15]"			Proj:ResultSummary[3]:Title3[15]		= {	if (EnergyCodeYearNum < 2022) then  "(kTDV/ft-yr)"  else if (EnergyCodeYearNum < 2025) then  "(kTDV/ft-yr)"  else  "($/ft)"  endif endif  }  ; SAC 12/01/22
   ; SAC 10/2/17 - switched from reporting delta with DRtgTDV w/o fuel adjustment mult applied to DRtgTDV W/ fuel adjustment mult applied
	"Set ResultSummary[3]:Enduse1[15]"			Proj:ResultSummary[3]:Enduse1[15]	= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[1]:DesignRatingTDV[2]  - RunResultsE[1]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse2[15]"			Proj:ResultSummary[3]:Enduse2[15]	= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[2]:DesignRatingTDV[2]  - RunResultsE[2]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse3[15]"			Proj:ResultSummary[3]:Enduse3[15]	= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[3]:DesignRatingTDV[2]  - RunResultsE[3]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse4[15]"			Proj:ResultSummary[3]:Enduse4[15]	= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[4]:DesignRatingTDV[2]  - RunResultsE[4]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse5[15]"			Proj:ResultSummary[3]:Enduse5[15]	= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[5]:DesignRatingTDV[2]  - RunResultsE[5]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse14[15]"			Proj:ResultSummary[3]:Enduse14[15]	= {	if (LocalCompAssigned( RunResultsE[14] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[14]:DesignRatingTDV[2] - RunResultsE[14]:ProposedTDV[2] ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse6[15]"			Proj:ResultSummary[3]:Enduse6[15]	= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[6]:DesignRatingTDV[2]  - RunResultsE[6]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse7[15]"			Proj:ResultSummary[3]:Enduse7[15]	= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[7]:DesignRatingTDV[2]  - RunResultsE[7]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse8[15]"			Proj:ResultSummary[3]:Enduse8[15]	= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[8]:DesignRatingTDV[2]  - RunResultsE[8]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse9[15]"			Proj:ResultSummary[3]:Enduse9[15]	= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[9]:DesignRatingTDV[2]  - RunResultsE[9]:ProposedTDV[2]  ), 2 )  endif  }
   ; SAC 2/2/19 - Flexibility reporting via new PFlxTDV property (tic #1053)
 	"Set ResultSummary[3]:Enduse10[15]"			Proj:ResultSummary[3]:Enduse10[15]	= {
 	      if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED
 	      else  FltToStr( (int((RunResultsE[10]:DesignRatingTDV[2]*100)+0.5) - int((RunResultsE[10]:ProposedTDV[2]*100)+0.5)) / 100 - ValidOr( ResultSummary[3]:PFlxTDV[1], 0 ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse11[15]"			Proj:ResultSummary[3]:Enduse11[15]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[11]:DesignRatingTDV[2] - RunResultsE[11]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse12[15]"			Proj:ResultSummary[3]:Enduse12[15]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[12]:DesignRatingTDV[2] - RunResultsE[12]:ProposedTDV[2] ), 2 )  endif  }
 	;"Set ResultSummary[3]:Enduse13[15]"			Proj:ResultSummary[3]:Enduse13[15]	= {	FltToStr( PVCredit, 2 )  }
 	;"Set ResultSummary[3]:Enduse13[15]"			Proj:ResultSummary[3]:Enduse13[15]	= {	if (EnergyCodeYearNum >= 2019)
   ;                                                                              then  if (LocalCompAssigned( RunResultsE[13] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[13]:CompMarginTDV,     2 )  endif
   ;                                                                              else  if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[6]:PropPVCreditTDV[2], 2 )  endif endif  }
 	;"Set ResultSummary[3]:Enduse13[15]"			Proj:ResultSummary[3]:Enduse13[15]	= {	if (LocalCompAssigned( RunResultsE[13] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[13]:CompMarginTDV,     2 )  endif  }
 	"Set ResultSummary[3]:Enduse13[15]"			Proj:ResultSummary[3]:Enduse13[15]	= {	if (LocalCompAssigned( RunResultsE[13] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[13]:DesignRatingTDV[2] - RunResultsE[13]:ProposedTDV[2] ), 2 )  endif  }
   ; SAC 1/7/18 - Battery adjustments for GHC (grid harmonization credit)
	"Set ResultSummary[3]:Enduse99[15]"			Proj:ResultSummary[3]:Enduse99[15]	= {
         if (IfValidAnd( ResultSummary[3]:GHCEnergyEffTDV > 0.00001 )==0) then  "0.00"  
         else  FltToStr( ResultSummary[3]:GHCEnergyEffTDV, 2 )  endif  }
	"Adj ResultSummary[3]:Enduse14[15]"			Proj:ResultSummary[3]:Enduse14[15]	= {
         if (IfValidAnd( ResultSummary[3]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResultsE[14]:DesignRatingTDV[2] - RunResultsE[14]:ProposedTDV[2] - ResultSummary[3]:GHCEnergyEffTDV), 2 )  endif  }
   ; SAC 1/22/18 - Battery adjustments for GHC to Compliance Enduse Details (grid harmonization credit)
	"Set ResultSummary[3]:Enduse99[8]"			Proj:ResultSummary[3]:Enduse99[8]	= {
         if (IfValidAnd( ResultSummary[3]:GHCEnergyEffTDV > 0.00001 )==0) then  "0.00"  
         else  FltToStr( ResultSummary[3]:GHCEnergyEffTDV, 2 )  endif  }
	"Adj ResultSummary[3]:Enduse14[8]"			Proj:ResultSummary[3]:Enduse14[8]	= {
         if (IfValidAnd( ResultSummary[3]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResultsE[14]:StandardTDV - RunResultsE[14]:ProposedTDV[1] - ResultSummary[3]:GHCEnergyEffTDV), 2 )  endif  }
   ; SAC 1/22/18 - Compliance Total adjustments for Battery GHC (grid harmonization credit)
	"Adj ResultSummary[3]:Enduse11[4]"			Proj:ResultSummary[3]:Enduse11[4]	= {
         if (LocalCompAssigned( RunResultsE[11] ) == 0 .OR. IfValidAnd( ResultSummary[3]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else  FltToStr( (RunResultsE[11]:ProposedTDV[1] - ResultSummary[3]:GHCEnergyEffTDV), 2 )  endif  }
 	"Adj ResultSummary[3]:Enduse11[8]"			Proj:ResultSummary[3]:Enduse11[8]	= {
         if (LocalCompAssigned( RunResultsE[11] ) == 0 .OR. IfValidAnd( ResultSummary[3]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else  FltToStr( (RunResultsE[11]:CompMarginTDV + ResultSummary[3]:GHCEnergyEffTDV), 2 )  endif  }
	"Adj ResultSummary[3]:PctSavingsCmpTDV"	Proj:ResultSummary[3]:PctSavingsCmpTDV	= {
         if (IfValidAnd( RunResultsE[11]:StandardTDV > 0.001 )==0 .OR. IfValidAnd( ResultSummary[3]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else  int((((RunResultsE[11]:StandardTDV - ValidOr( RunResultsE[11]:ProposedTDV[1], 0 ) + ResultSummary[3]:GHCEnergyEffTDV) * 100 / RunResultsE[11]:StandardTDV ) * 10) +0.5 ) / 10  endif  }
	"Adj ResultSummary[3]:PctSavCmpTDVLbl"		Proj:ResultSummary[3]:PctSavCmpTDVLbl	= {
         if (IfValidAnd( ResultSummary[3]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else if (IfValidAnd( ResultSummary[3]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[3]:PctSavingsCmpTDV < -0.0001 )==0) then  "-" 
         else  Format( "%.1f", ResultSummary[3]:PctSavingsCmpTDV )  endif endif  }
   ; SAC 2/2/19 - Reporting of Flexibility credit (tic #1053)
	"Set ResultSummary[3]:Enduse98[15]"			Proj:ResultSummary[3]:Enduse98[15]	= {  FltToStr( -ValidOr( ResultSummary[3]:PFlxTDV[1], 0 ), 2 )  }

;	  ; Pass/Fail result
;	 	"Set ResultSummary[3]:PassFail"				Proj:ResultSummary[3]:PassFail		= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  if (RunResultsE[11]:CompMarginTDV >= 0) then "PASS"  else  "FAIL"  endif endif  }

  ; DesignRating Electric Demand
	"Set ResultSummary[3]:Title1[16]"			Proj:ResultSummary[3]:Title1[16]		= {	"Reference"  }
	"Set ResultSummary[3]:Title2[16]"			Proj:ResultSummary[3]:Title2[16]		= {	"Design"     }
	"Set ResultSummary[3]:Title3[16]"			Proj:ResultSummary[3]:Title3[16]		= {	"(kW)"  }
	"Set ResultSummary[3]:Enduse1[16]"			Proj:ResultSummary[3]:Enduse1[16]	= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[1]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse2[16]"			Proj:ResultSummary[3]:Enduse2[16]	= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[2]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse3[16]"			Proj:ResultSummary[3]:Enduse3[16]	= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[3]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse4[16]"			Proj:ResultSummary[3]:Enduse4[16]	= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[4]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse5[16]"			Proj:ResultSummary[3]:Enduse5[16]	= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[5]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse14[16]"			Proj:ResultSummary[3]:Enduse14[16]	= {	if (LocalCompAssigned( RunResultsE[14] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[14]:DRtgElecDemand ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse6[16]"			Proj:ResultSummary[3]:Enduse6[16]	= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[6]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse7[16]"			Proj:ResultSummary[3]:Enduse7[16]	= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[7]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse8[16]"			Proj:ResultSummary[3]:Enduse8[16]	= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[8]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse9[16]"			Proj:ResultSummary[3]:Enduse9[16]	= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[9]:DRtgElecDemand  ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse10[16]"			Proj:ResultSummary[3]:Enduse10[16]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[10]:DRtgElecDemand ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse11[16]"			Proj:ResultSummary[3]:Enduse11[16]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[11]:DRtgElecDemand ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse12[16]"			Proj:ResultSummary[3]:Enduse12[16]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[12]:DRtgElecDemand ), 2 )  endif  }

  ; Additional elec demand storage (SAC 10/26/16)
   "Set ResultSummary[3]:PropElecDemand[2]"  Proj:ResultSummary[3]:PropElecDemand[2]   = {   if (LocalCompAssigned( RunResultsE[10] ) == 0 .OR. LocalStatus( RunResultsE[10]:PropElecDemand[2] ) < 1) then  UNDEFINED
																												         else  ValidOr( RunResultsE[10]:PropElecDemand[2], 0 )  endif  }
   "Set ResultSummary[3]:DRtgElecDemand"     Proj:ResultSummary[3]:DRtgElecDemand      = {   if (LocalCompAssigned( RunResultsE[10] ) == 0 .OR. LocalStatus( RunResultsE[10]:DRtgElecDemand ) < 1) then  UNDEFINED
																												         else  ValidOr( RunResultsE[10]:DRtgElecDemand, 0 )  endif  }
	"Set ResultSummary[3]:MarginkW[2]"		   Proj:ResultSummary[3]:MarginkW[2]	      = {	if (LocalCompAssigned( RunResultsE[10] ) == 0 .OR. LocalStatus( ResultSummary[3]:PropElecDemand[2] ) < 1) then  UNDEFINED
																												         else  int(((ResultSummary[3]:DRtgElecDemand - ResultSummary[3]:PropElecDemand[2]) * 100) +0.5 ) / 100  endif  }

;	  ; Demand & Energy Use Margins (added w/ CAHP mods 10/8/14)
;		"Set ResultSummary[3]:MarginkW"			Proj:ResultSummary[3]:MarginkW		= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED
;																													else  ValidOr( RunResults[10]:StdElecDemand, 0 ) - ValidOr( RunResultsE[10]:PropElecDemand[2], 0 )  endif  }
;		"Set ResultSummary[3]:MarginkWh"			Proj:ResultSummary[3]:MarginkWh		= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED
;																													else  (ValidOr( RunResults[10]:StdElecEnergy, 0 ) - ValidOr( RunResultsE[10]:PropElecEnergy, 0 )) * CondFloorArea / 3.413  endif  }
;		"Set ResultSummary[3]:MarginTherms"		Proj:ResultSummary[3]:MarginTherms	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED
;																													else  (ValidOr( RunResults[10]:StdNatGasEnergy, 0 ) - ValidOr( RunResultsE[10]:PropNatGasEnergy, 0 )) * CondFloorArea / 100  endif  }
;	  ; Percent Savings values for reporting
;		"Set ResultSummary[3]:PctSavingskW"			Proj:ResultSummary[3]:PctSavingskW		= {	if (IfValidAnd( RunResults[10]:StdElecDemand > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StdElecDemand   - ValidOr( RunResultsE[10]:PropElecDemand[2],   0 )) * 100 / RunResults[10]:StdElecDemand    endif  }
;		"Set ResultSummary[3]:PctSavingskWh"		Proj:ResultSummary[3]:PctSavingskWh		= {	if (IfValidAnd( RunResults[10]:StdElecEnergy > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StdElecEnergy   - ValidOr( RunResultsE[10]:PropElecEnergy,   0 )) * 100 / RunResults[10]:StdElecEnergy    endif  }
;		"Set ResultSummary[3]:PctSavingsTherms"	Proj:ResultSummary[3]:PctSavingsTherms	= {	if (IfValidAnd( RunResults[10]:StdNatGasEnergy > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StdNatGasEnergy - ValidOr( RunResultsE[10]:PropNatGasEnergy, 0 )) * 100 / RunResults[10]:StdNatGasEnergy  endif  }
;		"Set ResultSummary[3]:PctSavingsTDV"		Proj:ResultSummary[3]:PctSavingsTDV		= {	if (IfValidAnd( RunResults[10]:StandardTDV     > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StandardTDV     - ValidOr( RunResultsE[10]:ProposedTDV[2],      0 )) * 100 / RunResults[10]:StandardTDV      endif  }
;		"Set ResultSummary[3]:PctSavingsCmpTDV"	Proj:ResultSummary[3]:PctSavingsCmpTDV	= {	if (IfValidAnd( RunResults[11]:StandardTDV     > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[11]:StandardTDV     - ValidOr( RunResultsE[11]:ProposedTDV[2],      0 )) * 100 / RunResults[11]:StandardTDV      endif  }
;		"Set ResultSummary[3]:PctSavkWLbl"			Proj:ResultSummary[3]:PctSavkWLbl		= {	if (IfValidAnd( ResultSummary[3]:PctSavingskW     > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[3]:PctSavingskW     < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[3]:PctSavingskW     )  endif  }
;		"Set ResultSummary[3]:PctSavkWhLbl"			Proj:ResultSummary[3]:PctSavkWhLbl		= {	if (IfValidAnd( ResultSummary[3]:PctSavingskWh    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[3]:PctSavingskWh    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[3]:PctSavingskWh    )  endif  }
;		"Set ResultSummary[3]:PctSavThermsLbl"		Proj:ResultSummary[3]:PctSavThermsLbl	= {	if (IfValidAnd( ResultSummary[3]:PctSavingsTherms > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[3]:PctSavingsTherms < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[3]:PctSavingsTherms )  endif  }
;		"Set ResultSummary[3]:PctSavTDVLbl"			Proj:ResultSummary[3]:PctSavTDVLbl		= {	if (IfValidAnd( ResultSummary[3]:PctSavingsTDV    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[3]:PctSavingsTDV    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[3]:PctSavingsTDV    )  endif  }
;		"Set ResultSummary[3]:PctSavCmpTDVLbl"		Proj:ResultSummary[3]:PctSavCmpTDVLbl	= {	if (IfValidAnd( ResultSummary[3]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[3]:PctSavingsCmpTDV < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[3]:PctSavingsCmpTDV )  endif  }

; -- SOUTH Facing --
  ; DesignRating Site Electric Use
	"Set ResultSummary[4]:Title1[12]"			Proj:ResultSummary[4]:Title1[12]		= {	if (EnergyCodeYearNum < 2022) then  "Reference"   else  "Reference Design:"  endif  }
	"Set ResultSummary[4]:Title2[12]"			Proj:ResultSummary[4]:Title2[12]		= {	if (EnergyCodeYearNum < 2022) then  "Design"      else if (EnergyCodeYearNum < 2025) then  "Site"  else  "Site Elec."  endif endif  }  ; SAC 12/01/22
	"Set ResultSummary[4]:Title3[12]"			Proj:ResultSummary[4]:Title3[12]		= {	if (EnergyCodeYearNum < 2022) then  "Site (kWh)"  else  "(kWh/yr)"              endif  }
	"Set ResultSummary[4]:Enduse1[12]"			Proj:ResultSummary[4]:Enduse1[12]	= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0 .OR. RunResultsS[1]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[1]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse2[12]"			Proj:ResultSummary[4]:Enduse2[12]	= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0 .OR. RunResultsS[2]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[2]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse3[12]"			Proj:ResultSummary[4]:Enduse3[12]	= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0 .OR. RunResultsS[3]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[3]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse4[12]"			Proj:ResultSummary[4]:Enduse4[12]	= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0 .OR. RunResultsS[4]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[4]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse5[12]"			Proj:ResultSummary[4]:Enduse5[12]	= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0 .OR. RunResultsS[5]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[5]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse14[12]"			Proj:ResultSummary[4]:Enduse14[12]	= {	if (LocalCompAssigned( RunResultsS[14] ) == 0 .OR. RunResultsS[14]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[14]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse6[12]"			Proj:ResultSummary[4]:Enduse6[12]	= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0 .OR. RunResultsS[6]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[6]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse7[12]"			Proj:ResultSummary[4]:Enduse7[12]	= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0 .OR. RunResultsS[7]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[7]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse8[12]"			Proj:ResultSummary[4]:Enduse8[12]	= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0 .OR. RunResultsS[8]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[8]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse9[12]"			Proj:ResultSummary[4]:Enduse9[12]	= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0 .OR. RunResultsS[9]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[9]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse10[12]"			Proj:ResultSummary[4]:Enduse10[12]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0 .OR. RunResultsS[10]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[10]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse11[12]"			Proj:ResultSummary[4]:Enduse11[12]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0 .OR. RunResultsS[11]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[11]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse12[12]"			Proj:ResultSummary[4]:Enduse12[12]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0 .OR. RunResultsS[12]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[12]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
  ; SAC 4/8/15 - refresh lighting and total Proposed results following (possible) resets due to design rating lighting credit reductions
  ; SAC 6/25/17 - updated to include PV results
  ; Proposed Site ELEC Use
	"Set ResultSummary[4]:Enduse6[17]"			Proj:ResultSummary[4]:Enduse6[17]	= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0 .OR. RunResultsS[6]:PropElecEnergy[2]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[6]:PropElecEnergy[2]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
   ; SAC 2/2/19 - Incorporate Flexibility credit into totals via new EUseSummary:PFlx* properties (tic #1053)
	"Set ResultSummary[4]:Enduse10[17]"			Proj:ResultSummary[4]:Enduse10[17]	= {
	      if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  
			else  FltToStr( (int( (RunResultsS[10]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )) + ValidOr( ResultSummary[4]:PFlxElecEnergy[1], 0 ), 0 )  endif  }
	"Set ResultSummary[4]:Enduse11[17]"			Proj:ResultSummary[4]:Enduse11[17]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0 .OR. RunResultsS[11]:PropElecEnergy[2] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[11]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse12[17]"			Proj:ResultSummary[4]:Enduse12[17]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0 .OR. RunResultsS[12]:PropElecEnergy[2] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[12]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse13[17]"			Proj:ResultSummary[4]:Enduse13[17]	= {	if (LocalCompAssigned( RunResultsS[13] ) == 0 .OR. RunResultsS[13]:PropElecEnergy[2] > 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[13]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
   ; SAC 1/6/18 - Battery adjustments for GHC (grid harmonization credit)
	"Set ResultSummary[4]:Enduse99[17]"			Proj:ResultSummary[4]:Enduse99[17]	= {
         if (IfValidAnd( ResultSummary[4]:GHCEnergyEffElec > 0.00001 )==0) then  UNDEFINED  
         else  FltToStr( (int( ResultSummary[4]:GHCEnergyEffElec + 0.5 )), 0 )  endif  }
	"Adj ResultSummary[4]:Enduse14[17]"			Proj:ResultSummary[4]:Enduse14[17]	= {
         if (LocalStatus( ResultSummary[4]:Enduse99[17] ) < 1) then  UNCHANGED  
         else if (ResultSummary[4]:GHCEnergyEffCap >= (-1 * RunResultsS[14]:ProposedTDV[3])) then  UNDEFINED
         else  FltToStr( (int( (RunResultsS[14]:PropElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 ) -
                          int( ResultSummary[4]:GHCEnergyEffElec + 0.5 )), 0 )  endif endif  }
   ; SAC 1/22/18 - Battery adjustments for GHC to Compliance Enduse Details (grid harmonization credit)
	"Set ResultSummary[4]:Enduse99[2]"			Proj:ResultSummary[4]:Enduse99[2]	= {
         if (IfValidAnd( ResultSummary[4]:GHCEnergyEffElec > 0.00001 )==0) then  UNDEFINED  
         else  FltToStr( (int( ResultSummary[4]:GHCEnergyEffElec + 0.5 )), 0 )  endif  }
	"Adj ResultSummary[4]:Enduse14[2]"			Proj:ResultSummary[4]:Enduse14[2]	= {
         if (LocalStatus( ResultSummary[4]:Enduse99[2] ) < 1) then  UNCHANGED  
         else if (ResultSummary[4]:GHCEnergyEffCap >= (-1 * RunResultsS[14]:ProposedTDV[1])) then  UNDEFINED
         else  FltToStr( (int( (RunResultsS[14]:PropElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 ) -
                          int( ResultSummary[4]:GHCEnergyEffElec + 0.5 )), 0 )  endif endif  }
   ; SAC 2/2/19 - revised logic to reference new PFlxTDV property (tic #1053)
	"Set ResultSummary[4]:Enduse98[17]"			Proj:ResultSummary[4]:Enduse98[17]	= {
			if (LocalStatus( ResultSummary[4]:PFlxElecEnergy[1] ) < 1) then  UNDEFINED
         else  FltToStr( ResultSummary[4]:PFlxElecEnergy[1], 0 )  endif  }
	"Set ResultSummary[4]:Enduse98[2]"			Proj:ResultSummary[4]:Enduse98[2]	= {  ResultSummary[4]:Enduse98[17]  }
	"Set ResultSummary[4]:Enduse10[2]"			Proj:ResultSummary[4]:Enduse10[2]	= {
	      if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  
			else  FltToStr( (int( ( RunResultsS[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )) + ValidOr( ResultSummary[4]:PFlxElecEnergy[1], 0 ), 0 )  endif  }

  ; Proposed Site FUEL Use
	"Set ResultSummary[4]:Enduse6[18]"			Proj:ResultSummary[4]:Enduse6[18]	= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0 .OR. (RunResultsS[6]:PropNatGasEnergy[2]  < 0.00001 .AND. RunResultsS[6]:PropOtherEnergy[2]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr(      ((RunResultsS[6]:PropNatGasEnergy[2]  + RunResultsS[6]:PropOtherEnergy[2] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse10[18]"			Proj:ResultSummary[4]:Enduse10[18]	= {
	      if (LocalCompAssigned( RunResultsS[10] ) == 0 .OR. (RunResultsS[10]:PropNatGasEnergy[2] < 0.00001 .AND. RunResultsS[10]:PropOtherEnergy[2] < 0.00001)) then  UNDEFINED  
			else  FltToStr( ((RunResultsS[10]:PropNatGasEnergy[2] + RunResultsS[10]:PropOtherEnergy[2]) * Proj:CondFloorArea / 100) +
                         ValidOr( ResultSummary[4]:PFlxNatGasEnergy[1], 0 ) + ValidOr( ResultSummary[4]:PFlxOtherEnergy[1], 0 ), 1 )  endif  }
	"Set ResultSummary[4]:Enduse11[18]"			Proj:ResultSummary[4]:Enduse11[18]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0 .OR. (RunResultsS[11]:PropNatGasEnergy[2] < 0.00001 .AND. RunResultsS[11]:PropOtherEnergy[2] < 0.00001)) then  UNDEFINED  
																													else  FltToStr(      ((RunResultsS[11]:PropNatGasEnergy[2] + RunResultsS[11]:PropOtherEnergy[2]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse12[18]"			Proj:ResultSummary[4]:Enduse12[18]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0 .OR. (RunResultsS[12]:PropNatGasEnergy[2] < 0.00001 .AND. RunResultsS[12]:PropOtherEnergy[2] < 0.00001)) then  UNDEFINED  
																													else  FltToStr(      ((RunResultsS[12]:PropNatGasEnergy[2] + RunResultsS[12]:PropOtherEnergy[2]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse13[18]"			Proj:ResultSummary[4]:Enduse13[18]	= {	UNDEFINED  }  ; PV
  ; Proposed TDV
	"Set ResultSummary[4]:Enduse6[19]"			Proj:ResultSummary[4]:Enduse6[19]	= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[6]:ProposedTDV[2]  ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse10[19]"			Proj:ResultSummary[4]:Enduse10[19]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[10]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse11[19]"			Proj:ResultSummary[4]:Enduse11[19]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[11]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse12[19]"			Proj:ResultSummary[4]:Enduse12[19]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[12]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse13[19]"			Proj:ResultSummary[4]:Enduse13[19]	= {	if (LocalCompAssigned( RunResultsS[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[13]:ProposedTDV[2] ), 2 )  endif  }

  ; DesignRating Site Natural Gas Use
	"Set ResultSummary[4]:Title1[13]"			Proj:ResultSummary[4]:Title1[13]		= {	if (EnergyCodeYearNum < 2022) then  "Reference"      else  UNDEFINED   endif  }
	"Set ResultSummary[4]:Title2[13]"			Proj:ResultSummary[4]:Title2[13]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "Site"  else  "Site Gas"  endif endif  }  ; SAC 12/01/22
	"Set ResultSummary[4]:Title3[13]"			Proj:ResultSummary[4]:Title3[13]		= {	if (EnergyCodeYearNum < 2022) then  "Site (therms)"  else  "(therms/yr)"  endif  }
	"Set ResultSummary[4]:Enduse1[13]"			Proj:ResultSummary[4]:Enduse1[13]	= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0 .OR.  (RunResultsS[1]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsS[1]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[1]:DRtgNatGasEnergy  + RunResultsS[1]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse2[13]"			Proj:ResultSummary[4]:Enduse2[13]	= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0 .OR.  (RunResultsS[2]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsS[2]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[2]:DRtgNatGasEnergy  + RunResultsS[2]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse3[13]"			Proj:ResultSummary[4]:Enduse3[13]	= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0 .OR.  (RunResultsS[3]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsS[3]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[3]:DRtgNatGasEnergy  + RunResultsS[3]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse4[13]"			Proj:ResultSummary[4]:Enduse4[13]	= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0 .OR.  (RunResultsS[4]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsS[4]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[4]:DRtgNatGasEnergy  + RunResultsS[4]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse5[13]"			Proj:ResultSummary[4]:Enduse5[13]	= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0 .OR.  (RunResultsS[5]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsS[5]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[5]:DRtgNatGasEnergy  + RunResultsS[5]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse14[13]"			Proj:ResultSummary[4]:Enduse14[13]	= {	if (LocalCompAssigned( RunResultsS[14] ) == 0 .OR.  (RunResultsS[14]:DRtgNatGasEnergy < 0.00001 .AND. RunResultsS[14]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[14]:DRtgNatGasEnergy + RunResultsS[14]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse6[13]"			Proj:ResultSummary[4]:Enduse6[13]	= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0 .OR.  (RunResultsS[6]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsS[6]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[6]:DRtgNatGasEnergy  + RunResultsS[6]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse7[13]"			Proj:ResultSummary[4]:Enduse7[13]	= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0 .OR.  (RunResultsS[7]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsS[7]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[7]:DRtgNatGasEnergy  + RunResultsS[7]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse8[13]"			Proj:ResultSummary[4]:Enduse8[13]	= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0 .OR.  (RunResultsS[8]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsS[8]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[8]:DRtgNatGasEnergy  + RunResultsS[8]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse9[13]"			Proj:ResultSummary[4]:Enduse9[13]	= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0 .OR.  (RunResultsS[9]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsS[9]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[9]:DRtgNatGasEnergy  + RunResultsS[9]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse10[13]"			Proj:ResultSummary[4]:Enduse10[13]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0 .OR.  (RunResultsS[10]:DRtgNatGasEnergy < 0.00001 .AND. RunResultsS[10]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[10]:DRtgNatGasEnergy + RunResultsS[10]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse11[13]"			Proj:ResultSummary[4]:Enduse11[13]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0 .OR.  (RunResultsS[11]:DRtgNatGasEnergy < 0.00001 .AND. RunResultsS[11]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[11]:DRtgNatGasEnergy + RunResultsS[11]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse12[13]"			Proj:ResultSummary[4]:Enduse12[13]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0 .OR.  (RunResultsS[12]:DRtgNatGasEnergy < 0.00001 .AND. RunResultsS[12]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[12]:DRtgNatGasEnergy + RunResultsS[12]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
   ; SAC 2/2/19 - Flexibility results via new PFlxTDV property (tic #1053)
	"Set ResultSummary[4]:Enduse98[18]"			Proj:ResultSummary[4]:Enduse98[18]	= {
         if (LocalStatus( ResultSummary[4]:PFlxNatGasEnergy[1] ) < 1 .AND. LocalStatus( ResultSummary[4]:PFlxOtherEnergy[1] ) < 1) then  UNDEFINED  
         else  FltToStr( ValidOr( ResultSummary[4]:PFlxNatGasEnergy[1], 0 ) + ValidOr( ResultSummary[4]:PFlxOtherEnergy[1], 0 ), 1 )  endif  }
	"Set ResultSummary[4]:Enduse98[3]"			Proj:ResultSummary[4]:Enduse98[3]	= {  ResultSummary[4]:Enduse98[18]  }
	"Set ResultSummary[4]:Enduse10[3]"			Proj:ResultSummary[4]:Enduse10[3]	= {
	      if (LocalCompAssigned( RunResultsS[10] ) == 0 .OR. (RunResultsS[10]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsS[10]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
			else  FltToStr( (int(((RunResultsS[10]:PropNatGasEnergy[1] + RunResultsS[10]:PropOtherEnergy[1]) * Proj:CondFloorArea / 10)+0.5) / 10) +
                        ValidOr( ResultSummary[4]:PFlxNatGasEnergy[1], 0 ) + ValidOr( ResultSummary[4]:PFlxOtherEnergy[1], 0 ), 1 )  endif  }
  ; DesignRating TDV
	"Set ResultSummary[4]:Title1[14]"			Proj:ResultSummary[4]:Title1[14]		= {	if (EnergyCodeYearNum < 2022) then  "Reference"      else  UNDEFINED        endif  }
	"Set ResultSummary[4]:Title2[14]"			Proj:ResultSummary[4]:Title2[14]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else  "EDR2"           endif  }
	"Set ResultSummary[4]:Title3[14]"			Proj:ResultSummary[4]:Title3[14]		= {	if (EnergyCodeYearNum < 2022) then  "(kTDV/ft-yr)"  else if (EnergyCodeYearNum < 2025) then  "(kTDV/ft-yr)"  else  "($/ft)"  endif endif  }  ; SAC 12/01/22
   ; SAC 10/2/17 - switched from reporting DRtgTDV w/o fuel adjustment mult applied to DRtgTDV W/ fuel adjustment mult applied
	"Set ResultSummary[4]:Enduse1[14]"			Proj:ResultSummary[4]:Enduse1[14]	= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[1]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse2[14]"			Proj:ResultSummary[4]:Enduse2[14]	= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[2]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse3[14]"			Proj:ResultSummary[4]:Enduse3[14]	= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[3]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse4[14]"			Proj:ResultSummary[4]:Enduse4[14]	= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[4]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse5[14]"			Proj:ResultSummary[4]:Enduse5[14]	= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[5]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse6[14]"			Proj:ResultSummary[4]:Enduse6[14]	= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[6]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse7[14]"			Proj:ResultSummary[4]:Enduse7[14]	= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[7]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse8[14]"			Proj:ResultSummary[4]:Enduse8[14]	= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[8]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse9[14]"			Proj:ResultSummary[4]:Enduse9[14]	= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[9]:DesignRatingTDV[2]  ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse10[14]"			Proj:ResultSummary[4]:Enduse10[14]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[10]:DesignRatingTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse11[14]"			Proj:ResultSummary[4]:Enduse11[14]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[11]:DesignRatingTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse12[14]"			Proj:ResultSummary[4]:Enduse12[14]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[12]:DesignRatingTDV[2] ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse13[14]"			Proj:ResultSummary[4]:Enduse13[14]	= {	if (LocalCompAssigned( RunResultsS[13] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsS[13]:DesignRatingTDV[2] = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsS[13]:DesignRatingTDV[2] ), 2 )  endif endif  }
	"Set ResultSummary[4]:Enduse14[14]"			Proj:ResultSummary[4]:Enduse14[14]	= {	if (LocalCompAssigned( RunResultsS[14] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsS[14]:DesignRatingTDV[2] = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsS[14]:DesignRatingTDV[2] ), 2 )  endif endif  }

; mjb-10/16/13	subtract PVCredit from Prop Design - S
	;"Set ResultSummary[4]:Enduse13[4]"			Proj:ResultSummary[4]:Enduse13[4]	= {	FltToStr( (PVCredit * -1), 2 )  }
	;"Set ResultSummary[4]:Enduse13[19]"			Proj:ResultSummary[4]:Enduse13[19]	= {	if (EnergyCodeYearNum >= 2019)
   ;                                                                              then  if (LocalCompAssigned( RunResultsS[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[13]:ProposedTDV[2] ), 2 )  endif
   ;                                                                              else  if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( (RunResultsS[6]:PropPVCreditTDV[2] * -1), 2 )  endif endif  }
	"Set ResultSummary[4]:Enduse13[19]"			Proj:ResultSummary[4]:Enduse13[19]	= {	if (LocalCompAssigned( RunResultsS[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[13]:ProposedTDV[2] ), 2 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
 	"Set ResultSummary[4]:Enduse10[19]"			Proj:ResultSummary[4]:Enduse10[19]	= {
 	      if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED
 	      else  FltToStr( (RunResultsS[10]:ProposedTDV[2] + ValidOr( ResultSummary[4]:PFlxTDV[1], 0 )), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse11[19]"			Proj:ResultSummary[4]:Enduse11[19]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[11]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse12[19]"			Proj:ResultSummary[4]:Enduse12[19]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[12]:ProposedTDV[2] ), 2 )  endif  }
   ; SAC 1/7/18 - Battery adjustments for GHC (grid harmonization credit)
	"Set ResultSummary[4]:Enduse99[19]"			Proj:ResultSummary[4]:Enduse99[19]	= {
         if (IfValidAnd( ResultSummary[4]:GHCEnergyEffTDV > 0.00001 )==0) then  "0.00"  
         else  FltToStr( (-1 * ResultSummary[4]:GHCEnergyEffTDV), 2 )  endif  }
	"Adj ResultSummary[4]:Enduse14[19]"			Proj:ResultSummary[4]:Enduse14[19]	= {
         if (IfValidAnd( ResultSummary[4]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResultsS[14]:ProposedTDV[3] + ResultSummary[4]:GHCEnergyEffTDV), 2 )  endif  }
   ; SAC 1/22/18 - Battery adjustments for GHC to Compliance Enduse Details (grid harmonization credit)
	"Set ResultSummary[4]:Enduse99[4]"			Proj:ResultSummary[4]:Enduse99[4]	= {
         if (IfValidAnd( ResultSummary[4]:GHCEnergyEffTDV > 0.00001 )==0) then  "0.00"  
         else  FltToStr( (-1 * ResultSummary[4]:GHCEnergyEffTDV), 2 )  endif  }
	"Adj ResultSummary[4]:Enduse14[4]"			Proj:ResultSummary[4]:Enduse14[4]	= {
         if (IfValidAnd( ResultSummary[4]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResultsS[14]:ProposedTDV[1] + ResultSummary[4]:GHCEnergyEffTDV), 2 )  endif  }
   ; SAC 2/2/19 - Reporting of Flexibility credit (tic #1053)
	"Set ResultSummary[4]:Enduse98[19]"			Proj:ResultSummary[4]:Enduse98[19]	= {
			if (LocalStatus( ResultSummary[4]:PFlxTDV[1] ) < 1) then  UNDEFINED
         else  FltToStr( ResultSummary[4]:PFlxTDV[1], 2 )  endif  }
	"Set ResultSummary[4]:Enduse98[4]"			Proj:ResultSummary[4]:Enduse98[4]	= {  ResultSummary[4]:Enduse98[19]  }
	"Set ResultSummary[4]:Enduse10[4]"			Proj:ResultSummary[4]:Enduse10[4]	= {
	      if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED
	      else  FltToStr( (int(RunResultsS[10]:ProposedTDV[1]*100+0.5)/100) + ValidOr( ResultSummary[4]:PFlxTDV[1], 0 ), 2 )  endif  }

  ; DesignRating Margin TDV
	"Set ResultSummary[4]:Title1[15]"			Proj:ResultSummary[4]:Title1[15]		= {	if (EnergyCodeYearNum < 2022) then  "Design Rating"  else if (EnergyCodeYearNum < 2025) then  "Design Rating Margins:"  else  "Design Rating Margins"  endif endif  }  ; SAC 12/01/22
	"Set ResultSummary[4]:Title2[15]"			Proj:ResultSummary[4]:Title2[15]		= {	if (EnergyCodeYearNum < 2022) then  "Margin"         else  "EDR2"                    endif  }
	"Set ResultSummary[4]:Title3[15]"			Proj:ResultSummary[4]:Title3[15]		= {	if (EnergyCodeYearNum < 2022) then  "(kTDV/ft-yr)"  else if (EnergyCodeYearNum < 2025) then  "(kTDV/ft-yr)"  else  "($/ft)"  endif endif  }  ; SAC 12/01/22
   ; SAC 10/2/17 - switched from reporting delta with DRtgTDV w/o fuel adjustment mult applied to DRtgTDV W/ fuel adjustment mult applied
	"Set ResultSummary[4]:Enduse1[15]"			Proj:ResultSummary[4]:Enduse1[15]	= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[1]:DesignRatingTDV[2]  - RunResultsS[1]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse2[15]"			Proj:ResultSummary[4]:Enduse2[15]	= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[2]:DesignRatingTDV[2]  - RunResultsS[2]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse3[15]"			Proj:ResultSummary[4]:Enduse3[15]	= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[3]:DesignRatingTDV[2]  - RunResultsS[3]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse4[15]"			Proj:ResultSummary[4]:Enduse4[15]	= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[4]:DesignRatingTDV[2]  - RunResultsS[4]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse5[15]"			Proj:ResultSummary[4]:Enduse5[15]	= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[5]:DesignRatingTDV[2]  - RunResultsS[5]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse14[15]"			Proj:ResultSummary[4]:Enduse14[15]	= {	if (LocalCompAssigned( RunResultsS[14] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[14]:DesignRatingTDV[2] - RunResultsS[14]:ProposedTDV[2] ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse6[15]"			Proj:ResultSummary[4]:Enduse6[15]	= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[6]:DesignRatingTDV[2]  - RunResultsS[6]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse7[15]"			Proj:ResultSummary[4]:Enduse7[15]	= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[7]:DesignRatingTDV[2]  - RunResultsS[7]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse8[15]"			Proj:ResultSummary[4]:Enduse8[15]	= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[8]:DesignRatingTDV[2]  - RunResultsS[8]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse9[15]"			Proj:ResultSummary[4]:Enduse9[15]	= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[9]:DesignRatingTDV[2]  - RunResultsS[9]:ProposedTDV[2]  ), 2 )  endif  }
   ; SAC 2/2/19 - Flexibility reporting via new PFlxTDV property (tic #1053)
 	"Set ResultSummary[4]:Enduse10[15]"			Proj:ResultSummary[4]:Enduse10[15]	= {
 	      if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED
 	      else  FltToStr( (int((RunResultsS[10]:DesignRatingTDV[2]*100)+0.5) - int((RunResultsS[10]:ProposedTDV[2]*100)+0.5)) / 100 - ValidOr( ResultSummary[4]:PFlxTDV[1], 0 ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse11[15]"			Proj:ResultSummary[4]:Enduse11[15]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[11]:DesignRatingTDV[2] - RunResultsS[11]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse12[15]"			Proj:ResultSummary[4]:Enduse12[15]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[12]:DesignRatingTDV[2] - RunResultsS[12]:ProposedTDV[2] ), 2 )  endif  }
 	;"Set ResultSummary[4]:Enduse13[15]"			Proj:ResultSummary[4]:Enduse13[15]	= {	FltToStr( PVCredit, 2 )  }
 	;"Set ResultSummary[4]:Enduse13[15]"			Proj:ResultSummary[4]:Enduse13[15]	= {	if (EnergyCodeYearNum >= 2019)
   ;                                                                              then  if (LocalCompAssigned( RunResultsS[13] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[13]:CompMarginTDV,     2 )  endif
   ;                                                                              else  if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[6]:PropPVCreditTDV[2], 2 )  endif endif  }
 	;"Set ResultSummary[4]:Enduse13[15]"			Proj:ResultSummary[4]:Enduse13[15]	= {	if (LocalCompAssigned( RunResultsS[13] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[13]:CompMarginTDV,     2 )  endif  }
 	"Set ResultSummary[4]:Enduse13[15]"			Proj:ResultSummary[4]:Enduse13[15]	= {	if (LocalCompAssigned( RunResultsS[13] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[13]:DesignRatingTDV[2] - RunResultsS[13]:ProposedTDV[2] ), 2 )  endif  }
   ; SAC 1/7/18 - Battery adjustments for GHC (grid harmonization credit)
	"Set ResultSummary[4]:Enduse99[15]"			Proj:ResultSummary[4]:Enduse99[15]	= {
         if (IfValidAnd( ResultSummary[4]:GHCEnergyEffTDV > 0.00001 )==0) then  "0.00"  
         else  FltToStr( ResultSummary[4]:GHCEnergyEffTDV, 2 )  endif  }
	"Adj ResultSummary[4]:Enduse14[15]"			Proj:ResultSummary[4]:Enduse14[15]	= {
         if (IfValidAnd( ResultSummary[4]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResultsS[14]:DesignRatingTDV[2] - RunResultsS[14]:ProposedTDV[2] - ResultSummary[4]:GHCEnergyEffTDV), 2 )  endif  }
   ; SAC 1/22/18 - Battery adjustments for GHC to Compliance Enduse Details (grid harmonization credit)
	"Set ResultSummary[4]:Enduse99[8]"			Proj:ResultSummary[4]:Enduse99[8]	= {
         if (IfValidAnd( ResultSummary[4]:GHCEnergyEffTDV > 0.00001 )==0) then  "0.00"  
         else  FltToStr( ResultSummary[4]:GHCEnergyEffTDV, 2 )  endif  }
	"Adj ResultSummary[4]:Enduse14[8]"			Proj:ResultSummary[4]:Enduse14[8]	= {
         if (IfValidAnd( ResultSummary[4]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResultsS[14]:StandardTDV - RunResultsS[14]:ProposedTDV[1] - ResultSummary[4]:GHCEnergyEffTDV), 2 )  endif  }
   ; SAC 1/22/18 - Compliance Total adjustments for Battery GHC (grid harmonization credit)
	"Adj ResultSummary[4]:Enduse11[4]"			Proj:ResultSummary[4]:Enduse11[4]	= {
         if (LocalCompAssigned( RunResultsS[11] ) == 0 .OR. IfValidAnd( ResultSummary[4]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else  FltToStr( (RunResultsS[11]:ProposedTDV[1] - ResultSummary[4]:GHCEnergyEffTDV), 2 )  endif  }
 	"Adj ResultSummary[4]:Enduse11[8]"			Proj:ResultSummary[4]:Enduse11[8]	= {
         if (LocalCompAssigned( RunResultsS[11] ) == 0 .OR. IfValidAnd( ResultSummary[4]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else  FltToStr( (RunResultsS[11]:CompMarginTDV + ResultSummary[4]:GHCEnergyEffTDV), 2 )  endif  }
	"Adj ResultSummary[4]:PctSavingsCmpTDV"	Proj:ResultSummary[4]:PctSavingsCmpTDV	= {
         if (IfValidAnd( RunResultsS[11]:StandardTDV > 0.001 )==0 .OR. IfValidAnd( ResultSummary[4]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else  int((((RunResultsS[11]:StandardTDV - ValidOr( RunResultsS[11]:ProposedTDV[1], 0 ) + ResultSummary[4]:GHCEnergyEffTDV) * 100 / RunResultsS[11]:StandardTDV ) * 10) +0.5 ) / 10  endif  }
	"Adj ResultSummary[4]:PctSavCmpTDVLbl"		Proj:ResultSummary[4]:PctSavCmpTDVLbl	= {
         if (IfValidAnd( ResultSummary[4]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else if (IfValidAnd( ResultSummary[4]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[4]:PctSavingsCmpTDV < -0.0001 )==0) then  "-" 
         else  Format( "%.1f", ResultSummary[4]:PctSavingsCmpTDV )  endif endif  }
   ; SAC 2/2/19 - Reporting of Flexibility credit (tic #1053)
	"Set ResultSummary[4]:Enduse98[15]"			Proj:ResultSummary[4]:Enduse98[15]	= {  FltToStr( -ValidOr( ResultSummary[4]:PFlxTDV[1], 0 ), 2 )  }

;	  ; Pass/Fail result
;	 	"Set ResultSummary[4]:PassFail"				Proj:ResultSummary[4]:PassFail		= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  if (RunResultsS[11]:CompMarginTDV >= 0) then "PASS"  else  "FAIL"  endif endif  }

  ; DesignRating Electric Demand
	"Set ResultSummary[4]:Title1[16]"			Proj:ResultSummary[4]:Title1[16]		= {	"Reference"  }
	"Set ResultSummary[4]:Title2[16]"			Proj:ResultSummary[4]:Title2[16]		= {	"Design"     }
	"Set ResultSummary[4]:Title3[16]"			Proj:ResultSummary[4]:Title3[16]		= {	"(kW)"  }
	"Set ResultSummary[4]:Enduse1[16]"			Proj:ResultSummary[4]:Enduse1[16]	= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[1]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse2[16]"			Proj:ResultSummary[4]:Enduse2[16]	= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[2]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse3[16]"			Proj:ResultSummary[4]:Enduse3[16]	= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[3]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse4[16]"			Proj:ResultSummary[4]:Enduse4[16]	= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[4]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse5[16]"			Proj:ResultSummary[4]:Enduse5[16]	= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[5]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse14[16]"			Proj:ResultSummary[4]:Enduse14[16]	= {	if (LocalCompAssigned( RunResultsS[14] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[14]:DRtgElecDemand ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse6[16]"			Proj:ResultSummary[4]:Enduse6[16]	= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[6]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse7[16]"			Proj:ResultSummary[4]:Enduse7[16]	= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[7]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse8[16]"			Proj:ResultSummary[4]:Enduse8[16]	= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[8]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse9[16]"			Proj:ResultSummary[4]:Enduse9[16]	= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[9]:DRtgElecDemand  ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse10[16]"			Proj:ResultSummary[4]:Enduse10[16]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[10]:DRtgElecDemand ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse11[16]"			Proj:ResultSummary[4]:Enduse11[16]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[11]:DRtgElecDemand ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse12[16]"			Proj:ResultSummary[4]:Enduse12[16]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[12]:DRtgElecDemand ), 2 )  endif  }

  ; Additional elec demand storage (SAC 10/26/16)
   "Set ResultSummary[4]:PropElecDemand[2]"  Proj:ResultSummary[4]:PropElecDemand[2]   = {   if (LocalCompAssigned( RunResultsS[10] ) == 0 .OR. LocalStatus( RunResultsS[10]:PropElecDemand[2] ) < 1) then  UNDEFINED
																												         else  ValidOr( RunResultsS[10]:PropElecDemand[2], 0 )  endif  }
   "Set ResultSummary[4]:DRtgElecDemand"     Proj:ResultSummary[4]:DRtgElecDemand      = {   if (LocalCompAssigned( RunResultsS[10] ) == 0 .OR. LocalStatus( RunResultsS[10]:DRtgElecDemand ) < 1) then  UNDEFINED
																												         else  ValidOr( RunResultsS[10]:DRtgElecDemand, 0 )  endif  }
	"Set ResultSummary[4]:MarginkW[2]"		   Proj:ResultSummary[4]:MarginkW[2]	      = {	if (LocalCompAssigned( RunResultsS[10] ) == 0 .OR. LocalStatus( ResultSummary[4]:PropElecDemand[2] ) < 1) then  UNDEFINED
																												         else  int(((ResultSummary[4]:DRtgElecDemand - ResultSummary[4]:PropElecDemand[2]) * 100) +0.5 ) / 100  endif  }

;	  ; Demand & Energy Use Margins (added w/ CAHP mods 10/8/14)
;		"Set ResultSummary[4]:MarginkW"			Proj:ResultSummary[4]:MarginkW		= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED
;																													else  ValidOr( RunResults[10]:StdElecDemand, 0 ) - ValidOr( RunResultsS[10]:PropElecDemand[2], 0 )  endif  }
;		"Set ResultSummary[4]:MarginkWh"			Proj:ResultSummary[4]:MarginkWh		= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED
;																													else  (ValidOr( RunResults[10]:StdElecEnergy, 0 ) - ValidOr( RunResultsS[10]:PropElecEnergy, 0 )) * CondFloorArea / 3.413  endif  }
;		"Set ResultSummary[4]:MarginTherms"		Proj:ResultSummary[4]:MarginTherms	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED
;																													else  (ValidOr( RunResults[10]:StdNatGasEnergy, 0 ) - ValidOr( RunResultsS[10]:PropNatGasEnergy, 0 )) * CondFloorArea / 100  endif  }
;	  ; Percent Savings values for reporting
;		"Set ResultSummary[4]:PctSavingskW"			Proj:ResultSummary[4]:PctSavingskW		= {	if (IfValidAnd( RunResults[10]:StdElecDemand > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StdElecDemand   - ValidOr( RunResultsS[10]:PropElecDemand[2],   0 )) * 100 / RunResults[10]:StdElecDemand    endif  }
;		"Set ResultSummary[4]:PctSavingskWh"		Proj:ResultSummary[4]:PctSavingskWh		= {	if (IfValidAnd( RunResults[10]:StdElecEnergy > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StdElecEnergy   - ValidOr( RunResultsS[10]:PropElecEnergy,   0 )) * 100 / RunResults[10]:StdElecEnergy    endif  }
;		"Set ResultSummary[4]:PctSavingsTherms"	Proj:ResultSummary[4]:PctSavingsTherms	= {	if (IfValidAnd( RunResults[10]:StdNatGasEnergy > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StdNatGasEnergy - ValidOr( RunResultsS[10]:PropNatGasEnergy, 0 )) * 100 / RunResults[10]:StdNatGasEnergy  endif  }
;		"Set ResultSummary[4]:PctSavingsTDV"		Proj:ResultSummary[4]:PctSavingsTDV		= {	if (IfValidAnd( RunResults[10]:StandardTDV     > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StandardTDV     - ValidOr( RunResultsS[10]:ProposedTDV[2],      0 )) * 100 / RunResults[10]:StandardTDV      endif  }
;		"Set ResultSummary[4]:PctSavingsCmpTDV"	Proj:ResultSummary[4]:PctSavingsCmpTDV	= {	if (IfValidAnd( RunResults[11]:StandardTDV     > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[11]:StandardTDV     - ValidOr( RunResultsS[11]:ProposedTDV[2],      0 )) * 100 / RunResults[11]:StandardTDV      endif  }
;		"Set ResultSummary[4]:PctSavkWLbl"			Proj:ResultSummary[4]:PctSavkWLbl		= {	if (IfValidAnd( ResultSummary[4]:PctSavingskW     > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[4]:PctSavingskW     < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[4]:PctSavingskW     )  endif  }
;		"Set ResultSummary[4]:PctSavkWhLbl"			Proj:ResultSummary[4]:PctSavkWhLbl		= {	if (IfValidAnd( ResultSummary[4]:PctSavingskWh    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[4]:PctSavingskWh    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[4]:PctSavingskWh    )  endif  }
;		"Set ResultSummary[4]:PctSavThermsLbl"		Proj:ResultSummary[4]:PctSavThermsLbl	= {	if (IfValidAnd( ResultSummary[4]:PctSavingsTherms > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[4]:PctSavingsTherms < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[4]:PctSavingsTherms )  endif  }
;		"Set ResultSummary[4]:PctSavTDVLbl"			Proj:ResultSummary[4]:PctSavTDVLbl		= {	if (IfValidAnd( ResultSummary[4]:PctSavingsTDV    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[4]:PctSavingsTDV    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[4]:PctSavingsTDV    )  endif  }
;		"Set ResultSummary[4]:PctSavCmpTDVLbl"		Proj:ResultSummary[4]:PctSavCmpTDVLbl	= {	if (IfValidAnd( ResultSummary[4]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[4]:PctSavingsCmpTDV < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[4]:PctSavingsCmpTDV )  endif  }

; -- WEST Facing --
  ; DesignRating Site Electric Use
	"Set ResultSummary[5]:Title1[12]"			Proj:ResultSummary[5]:Title1[12]		= {	if (EnergyCodeYearNum < 2022) then  "Reference"   else  "Reference Design:"  endif  }
	"Set ResultSummary[5]:Title2[12]"			Proj:ResultSummary[5]:Title2[12]		= {	if (EnergyCodeYearNum < 2022) then  "Design"      else if (EnergyCodeYearNum < 2025) then  "Site"  else  "Site Elec."  endif endif  }  ; SAC 12/01/22
	"Set ResultSummary[5]:Title3[12]"			Proj:ResultSummary[5]:Title3[12]		= {	if (EnergyCodeYearNum < 2022) then  "Site (kWh)"  else  "(kWh/yr)"              endif  }
	"Set ResultSummary[5]:Enduse1[12]"			Proj:ResultSummary[5]:Enduse1[12]	= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0 .OR. RunResultsW[1]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[1]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse2[12]"			Proj:ResultSummary[5]:Enduse2[12]	= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0 .OR. RunResultsW[2]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[2]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse3[12]"			Proj:ResultSummary[5]:Enduse3[12]	= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0 .OR. RunResultsW[3]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[3]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse4[12]"			Proj:ResultSummary[5]:Enduse4[12]	= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0 .OR. RunResultsW[4]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[4]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse5[12]"			Proj:ResultSummary[5]:Enduse5[12]	= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0 .OR. RunResultsW[5]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[5]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse14[12]"			Proj:ResultSummary[5]:Enduse14[12]	= {	if (LocalCompAssigned( RunResultsW[14] ) == 0 .OR. RunResultsW[14]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[14]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse6[12]"			Proj:ResultSummary[5]:Enduse6[12]	= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0 .OR. RunResultsW[6]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[6]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse7[12]"			Proj:ResultSummary[5]:Enduse7[12]	= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0 .OR. RunResultsW[7]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[7]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse8[12]"			Proj:ResultSummary[5]:Enduse8[12]	= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0 .OR. RunResultsW[8]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[8]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse9[12]"			Proj:ResultSummary[5]:Enduse9[12]	= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0 .OR. RunResultsW[9]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[9]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse10[12]"			Proj:ResultSummary[5]:Enduse10[12]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0 .OR. RunResultsW[10]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[10]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse11[12]"			Proj:ResultSummary[5]:Enduse11[12]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0 .OR. RunResultsW[11]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[11]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse12[12]"			Proj:ResultSummary[5]:Enduse12[12]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0 .OR. RunResultsW[12]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[12]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
  ; SAC 4/8/15 - refresh lighting and total Proposed results following (possible) resets due to design rating lighting credit reductions
  ; SAC 6/25/17 - updated to include PV results
  ; Proposed Site ELEC Use
	"Set ResultSummary[5]:Enduse6[17]"			Proj:ResultSummary[5]:Enduse6[17]	= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0 .OR. RunResultsW[6]:PropElecEnergy[2]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[6]:PropElecEnergy[2]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
   ; SAC 2/2/19 - Incorporate Flexibility credit into totals via new EUseSummary:PFlx* properties (tic #1053)
	"Set ResultSummary[5]:Enduse10[17]"			Proj:ResultSummary[5]:Enduse10[17]	= {
	      if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  
			else  FltToStr( (int( (RunResultsW[10]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )) + ValidOr( ResultSummary[5]:PFlxElecEnergy[1], 0 ), 0 )  endif  }
	"Set ResultSummary[5]:Enduse11[17]"			Proj:ResultSummary[5]:Enduse11[17]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0 .OR. RunResultsW[11]:PropElecEnergy[2] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[11]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse12[17]"			Proj:ResultSummary[5]:Enduse12[17]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0 .OR. RunResultsW[12]:PropElecEnergy[2] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[12]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse13[17]"			Proj:ResultSummary[5]:Enduse13[17]	= {	if (LocalCompAssigned( RunResultsW[13] ) == 0 .OR. RunResultsW[13]:PropElecEnergy[2] > 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[13]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
   ; SAC 1/6/18 - Battery adjustments for GHC (grid harmonization credit)
	"Set ResultSummary[5]:Enduse99[17]"			Proj:ResultSummary[5]:Enduse99[17]	= {
         if (IfValidAnd( ResultSummary[5]:GHCEnergyEffElec > 0.00001 )==0) then  UNDEFINED  
         else  FltToStr( (int( ResultSummary[5]:GHCEnergyEffElec + 0.5 )), 0 )  endif  }
	"Adj ResultSummary[5]:Enduse14[17]"			Proj:ResultSummary[5]:Enduse14[17]	= {
         if (LocalStatus( ResultSummary[5]:Enduse99[17] ) < 1) then  UNCHANGED  
         else if (ResultSummary[5]:GHCEnergyEffCap >= (-1 * RunResultsW[14]:ProposedTDV[3])) then  UNDEFINED
         else  FltToStr( (int( (RunResultsW[14]:PropElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 ) -
                          int( ResultSummary[5]:GHCEnergyEffElec + 0.5 )), 0 )  endif endif  }
   ; SAC 1/22/18 - Battery adjustments for GHC to Compliance Enduse Details (grid harmonization credit)
	"Set ResultSummary[5]:Enduse99[2]"			Proj:ResultSummary[5]:Enduse99[2]	= {
         if (IfValidAnd( ResultSummary[5]:GHCEnergyEffElec > 0.00001 )==0) then  UNDEFINED  
         else  FltToStr( (int( ResultSummary[5]:GHCEnergyEffElec + 0.5 )), 0 )  endif  }
	"Adj ResultSummary[5]:Enduse14[2]"			Proj:ResultSummary[5]:Enduse14[2]	= {
         if (LocalStatus( ResultSummary[5]:Enduse99[2] ) < 1) then  UNCHANGED  
         else if (ResultSummary[5]:GHCEnergyEffCap >= (-1 * RunResultsW[14]:ProposedTDV[1])) then  UNDEFINED
         else  FltToStr( (int( (RunResultsW[14]:PropElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 ) -
                          int( ResultSummary[5]:GHCEnergyEffElec + 0.5 )), 0 )  endif endif  }
   ; SAC 2/2/19 - revised logic to reference new PFlxTDV property (tic #1053)
	"Set ResultSummary[5]:Enduse98[17]"			Proj:ResultSummary[5]:Enduse98[17]	= {
			if (LocalStatus( ResultSummary[5]:PFlxElecEnergy[1] ) < 1) then  UNDEFINED
         else  FltToStr( ResultSummary[5]:PFlxElecEnergy[1], 0 )  endif  }
	"Set ResultSummary[5]:Enduse98[2]"			Proj:ResultSummary[5]:Enduse98[2]	= {  ResultSummary[5]:Enduse98[17]  }
	"Set ResultSummary[5]:Enduse10[2]"			Proj:ResultSummary[5]:Enduse10[2]	= {
	      if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  
			else  FltToStr( (int( ( RunResultsW[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )) + ValidOr( ResultSummary[5]:PFlxElecEnergy[1], 0 ), 0 )  endif  }

  ; Proposed Site FUEL Use
	"Set ResultSummary[5]:Enduse6[18]"			Proj:ResultSummary[5]:Enduse6[18]	= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0 .OR. (RunResultsW[6]:PropNatGasEnergy[2]  < 0.00001 .AND. RunResultsW[6]:PropOtherEnergy[2]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr(      ((RunResultsW[6]:PropNatGasEnergy[2]  + RunResultsW[6]:PropOtherEnergy[2] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse10[18]"			Proj:ResultSummary[5]:Enduse10[18]	= {
	      if (LocalCompAssigned( RunResultsW[10] ) == 0 .OR. (RunResultsW[10]:PropNatGasEnergy[2] < 0.00001 .AND. RunResultsW[10]:PropOtherEnergy[2] < 0.00001)) then  UNDEFINED  
			else  FltToStr( ((RunResultsW[10]:PropNatGasEnergy[2] + RunResultsW[10]:PropOtherEnergy[2]) * Proj:CondFloorArea / 100) +
                         ValidOr( ResultSummary[5]:PFlxNatGasEnergy[1], 0 ) + ValidOr( ResultSummary[5]:PFlxOtherEnergy[1], 0 ), 1 )  endif  }
	"Set ResultSummary[5]:Enduse11[18]"			Proj:ResultSummary[5]:Enduse11[18]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0 .OR. (RunResultsW[11]:PropNatGasEnergy[2] < 0.00001 .AND. RunResultsW[11]:PropOtherEnergy[2] < 0.00001)) then  UNDEFINED  
																													else  FltToStr(      ((RunResultsW[11]:PropNatGasEnergy[2] + RunResultsW[11]:PropOtherEnergy[2]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse12[18]"			Proj:ResultSummary[5]:Enduse12[18]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0 .OR. (RunResultsW[12]:PropNatGasEnergy[2] < 0.00001 .AND. RunResultsW[12]:PropOtherEnergy[2] < 0.00001)) then  UNDEFINED  
																													else  FltToStr(      ((RunResultsW[12]:PropNatGasEnergy[2] + RunResultsW[12]:PropOtherEnergy[2]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse13[18]"			Proj:ResultSummary[5]:Enduse13[18]	= {	UNDEFINED  }  ; PV
   ; SAC 2/2/19 - Flexibility results via new PFlxTDV property (tic #1053)
	"Set ResultSummary[5]:Enduse98[18]"			Proj:ResultSummary[5]:Enduse98[18]	= {
         if (LocalStatus( ResultSummary[5]:PFlxNatGasEnergy[1] ) < 1 .AND. LocalStatus( ResultSummary[5]:PFlxOtherEnergy[1] ) < 1) then  UNDEFINED  
         else  FltToStr( ValidOr( ResultSummary[5]:PFlxNatGasEnergy[1], 0 ) + ValidOr( ResultSummary[5]:PFlxOtherEnergy[1], 0 ), 1 )  endif  }
	"Set ResultSummary[5]:Enduse98[3]"			Proj:ResultSummary[5]:Enduse98[3]	= {  ResultSummary[5]:Enduse98[18]  }
	"Set ResultSummary[5]:Enduse10[3]"			Proj:ResultSummary[5]:Enduse10[3]	= {
	      if (LocalCompAssigned( RunResultsW[10] ) == 0 .OR. (RunResultsW[10]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsW[10]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
			else  FltToStr( (int(((RunResultsW[10]:PropNatGasEnergy[1] + RunResultsW[10]:PropOtherEnergy[1]) * Proj:CondFloorArea / 10)+0.5) / 10) +
                        ValidOr( ResultSummary[5]:PFlxNatGasEnergy[1], 0 ) + ValidOr( ResultSummary[5]:PFlxOtherEnergy[1], 0 ), 1 )  endif  }
  ; Proposed TDV
	"Set ResultSummary[5]:Enduse6[19]"			Proj:ResultSummary[5]:Enduse6[19]	= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[6]:ProposedTDV[2]  ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse10[19]"			Proj:ResultSummary[5]:Enduse10[19]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[10]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse11[19]"			Proj:ResultSummary[5]:Enduse11[19]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[11]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse12[19]"			Proj:ResultSummary[5]:Enduse12[19]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[12]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse13[19]"			Proj:ResultSummary[5]:Enduse13[19]	= {	if (LocalCompAssigned( RunResultsW[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[13]:ProposedTDV[2] ), 2 )  endif  }

  ; DesignRating Site Natural Gas Use
	"Set ResultSummary[5]:Title1[13]"			Proj:ResultSummary[5]:Title1[13]		= {	if (EnergyCodeYearNum < 2022) then  "Reference"      else  UNDEFINED   endif  }
	"Set ResultSummary[5]:Title2[13]"			Proj:ResultSummary[5]:Title2[13]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else if (EnergyCodeYearNum < 2025) then  "Site"  else  "Site Gas"  endif endif  }  ; SAC 12/01/22
	"Set ResultSummary[5]:Title3[13]"			Proj:ResultSummary[5]:Title3[13]		= {	if (EnergyCodeYearNum < 2022) then  "Site (therms)"  else  "(therms/yr)"  endif  }
	"Set ResultSummary[5]:Enduse1[13]"			Proj:ResultSummary[5]:Enduse1[13]	= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0 .OR.  (RunResultsW[1]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsW[1]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[1]:DRtgNatGasEnergy  + RunResultsW[1]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse2[13]"			Proj:ResultSummary[5]:Enduse2[13]	= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0 .OR.  (RunResultsW[2]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsW[2]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[2]:DRtgNatGasEnergy  + RunResultsW[2]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse3[13]"			Proj:ResultSummary[5]:Enduse3[13]	= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0 .OR.  (RunResultsW[3]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsW[3]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[3]:DRtgNatGasEnergy  + RunResultsW[3]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse4[13]"			Proj:ResultSummary[5]:Enduse4[13]	= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0 .OR.  (RunResultsW[4]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsW[4]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[4]:DRtgNatGasEnergy  + RunResultsW[4]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse5[13]"			Proj:ResultSummary[5]:Enduse5[13]	= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0 .OR.  (RunResultsW[5]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsW[5]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[5]:DRtgNatGasEnergy  + RunResultsW[5]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse14[13]"			Proj:ResultSummary[5]:Enduse14[13]	= {	if (LocalCompAssigned( RunResultsW[14] ) == 0 .OR.  (RunResultsW[14]:DRtgNatGasEnergy < 0.00001 .AND. RunResultsW[14]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[14]:DRtgNatGasEnergy + RunResultsW[14]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse6[13]"			Proj:ResultSummary[5]:Enduse6[13]	= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0 .OR.  (RunResultsW[6]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsW[6]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[6]:DRtgNatGasEnergy  + RunResultsW[6]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse7[13]"			Proj:ResultSummary[5]:Enduse7[13]	= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0 .OR.  (RunResultsW[7]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsW[7]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[7]:DRtgNatGasEnergy  + RunResultsW[7]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse8[13]"			Proj:ResultSummary[5]:Enduse8[13]	= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0 .OR.  (RunResultsW[8]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsW[8]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[8]:DRtgNatGasEnergy  + RunResultsW[8]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse9[13]"			Proj:ResultSummary[5]:Enduse9[13]	= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0 .OR.  (RunResultsW[9]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsW[9]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[9]:DRtgNatGasEnergy  + RunResultsW[9]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse10[13]"			Proj:ResultSummary[5]:Enduse10[13]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0 .OR.  (RunResultsW[10]:DRtgNatGasEnergy < 0.00001 .AND. RunResultsW[10]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[10]:DRtgNatGasEnergy + RunResultsW[10]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse11[13]"			Proj:ResultSummary[5]:Enduse11[13]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0 .OR.  (RunResultsW[11]:DRtgNatGasEnergy < 0.00001 .AND. RunResultsW[11]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[11]:DRtgNatGasEnergy + RunResultsW[11]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse12[13]"			Proj:ResultSummary[5]:Enduse12[13]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0 .OR.  (RunResultsW[12]:DRtgNatGasEnergy < 0.00001 .AND. RunResultsW[12]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[12]:DRtgNatGasEnergy + RunResultsW[12]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
   ; SAC 2/2/19 - Flexibility results via new PFlxTDV property (tic #1053)
	"Set ResultSummary[5]:Enduse98[18]"			Proj:ResultSummary[5]:Enduse98[18]	= {
         if (LocalStatus( ResultSummary[5]:PFlxNatGasEnergy[1] ) < 1 .AND. LocalStatus( ResultSummary[5]:PFlxOtherEnergy[1] ) < 1) then  UNDEFINED  
         else  FltToStr( ValidOr( ResultSummary[5]:PFlxNatGasEnergy[1], 0 ) + ValidOr( ResultSummary[5]:PFlxOtherEnergy[1], 0 ), 1 )  endif  }
	"Set ResultSummary[5]:Enduse98[3]"			Proj:ResultSummary[5]:Enduse98[3]	= {  ResultSummary[5]:Enduse98[18]  }
	"Set ResultSummary[5]:Enduse10[3]"			Proj:ResultSummary[5]:Enduse10[3]	= {
	      if (LocalCompAssigned( RunResultsW[10] ) == 0 .OR. (RunResultsW[10]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsW[10]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
			else  FltToStr( (int(((RunResultsW[10]:PropNatGasEnergy[1] + RunResultsW[10]:PropOtherEnergy[1]) * Proj:CondFloorArea / 10)+0.5) / 10) +
                        ValidOr( ResultSummary[5]:PFlxNatGasEnergy[1], 0 ) + ValidOr( ResultSummary[5]:PFlxOtherEnergy[1], 0 ), 1 )  endif  }
  ; DesignRating TDV
	"Set ResultSummary[5]:Title1[14]"			Proj:ResultSummary[5]:Title1[14]		= {	if (EnergyCodeYearNum < 2022) then  "Reference"      else  UNDEFINED        endif  }
	"Set ResultSummary[5]:Title2[14]"			Proj:ResultSummary[5]:Title2[14]		= {	if (EnergyCodeYearNum < 2022) then  "Design"         else  "EDR2"           endif  }
	"Set ResultSummary[5]:Title3[14]"			Proj:ResultSummary[5]:Title3[14]		= {	if (EnergyCodeYearNum < 2022) then  "(kTDV/ft-yr)"  else if (EnergyCodeYearNum < 2025) then  "(kTDV/ft-yr)"  else  "($/ft)"  endif endif  }  ; SAC 12/01/22
   ; SAC 10/2/17 - switched from reporting DRtgTDV w/o fuel adjustment mult applied to DRtgTDV W/ fuel adjustment mult applied
	"Set ResultSummary[5]:Enduse1[14]"			Proj:ResultSummary[5]:Enduse1[14]	= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[1]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse2[14]"			Proj:ResultSummary[5]:Enduse2[14]	= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[2]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse3[14]"			Proj:ResultSummary[5]:Enduse3[14]	= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[3]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse4[14]"			Proj:ResultSummary[5]:Enduse4[14]	= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[4]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse5[14]"			Proj:ResultSummary[5]:Enduse5[14]	= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[5]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse6[14]"			Proj:ResultSummary[5]:Enduse6[14]	= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[6]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse7[14]"			Proj:ResultSummary[5]:Enduse7[14]	= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[7]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse8[14]"			Proj:ResultSummary[5]:Enduse8[14]	= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[8]:DesignRatingTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse9[14]"			Proj:ResultSummary[5]:Enduse9[14]	= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[9]:DesignRatingTDV[2]  ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse10[14]"			Proj:ResultSummary[5]:Enduse10[14]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[10]:DesignRatingTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse11[14]"			Proj:ResultSummary[5]:Enduse11[14]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[11]:DesignRatingTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse12[14]"			Proj:ResultSummary[5]:Enduse12[14]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[12]:DesignRatingTDV[2] ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse13[14]"			Proj:ResultSummary[5]:Enduse13[14]	= {	if (LocalCompAssigned( RunResultsW[13] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsW[13]:DesignRatingTDV[2] = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsW[13]:DesignRatingTDV[2] ), 2 )  endif endif  }
	"Set ResultSummary[5]:Enduse14[14]"			Proj:ResultSummary[5]:Enduse14[14]	= {	if (LocalCompAssigned( RunResultsW[14] ) == 0) then  UNDEFINED
                                                                                       else if (IfValidAnd(   RunResultsW[14]:DesignRatingTDV[2] = 0 )) then  " "  else  FltToStr( LocalRef( RunResultsW[14]:DesignRatingTDV[2] ), 2 )  endif endif  }

; mjb-10/16/13	subtract PVCredit from Prop Design - W
	;"Set ResultSummary[5]:Enduse13[4]"			Proj:ResultSummary[5]:Enduse13[4]	= {	FltToStr( (PVCredit * -1), 2 )  }
	;"Set ResultSummary[5]:Enduse13[19]"			Proj:ResultSummary[5]:Enduse13[19]	= {	if (EnergyCodeYearNum >= 2019)
   ;                                                                              then  if (LocalCompAssigned( RunResultsW[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[13]:ProposedTDV[2] ), 2 )  endif
   ;                                                                              else  if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( (RunResultsW[6]:PropPVCreditTDV[2] * -1), 2 )  endif endif  }
	"Set ResultSummary[5]:Enduse13[19]"			Proj:ResultSummary[5]:Enduse13[19]	= {	if (LocalCompAssigned( RunResultsW[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[13]:ProposedTDV[2] ), 2 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
 	"Set ResultSummary[5]:Enduse10[19]"			Proj:ResultSummary[5]:Enduse10[19]	= {
 	      if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED
 	      else  FltToStr( (RunResultsW[10]:ProposedTDV[2] + ValidOr( ResultSummary[5]:PFlxTDV[1], 0 )), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse11[19]"			Proj:ResultSummary[5]:Enduse11[19]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[11]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse12[19]"			Proj:ResultSummary[5]:Enduse12[19]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[12]:ProposedTDV[2] ), 2 )  endif  }
   ; SAC 1/7/18 - Battery adjustments for GHC (grid harmonization credit)
	"Set ResultSummary[5]:Enduse99[19]"			Proj:ResultSummary[5]:Enduse99[19]	= {
         if (IfValidAnd( ResultSummary[5]:GHCEnergyEffTDV > 0.00001 )==0) then  "0.00"  
         else  FltToStr( (-1 * ResultSummary[5]:GHCEnergyEffTDV), 2 )  endif  }
	"Adj ResultSummary[5]:Enduse14[19]"			Proj:ResultSummary[5]:Enduse14[19]	= {
         if (IfValidAnd( ResultSummary[5]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResultsW[14]:ProposedTDV[3] + ResultSummary[5]:GHCEnergyEffTDV), 2 )  endif  }
   ; SAC 1/22/18 - Battery adjustments for GHC to Compliance Enduse Details (grid harmonization credit)
	"Set ResultSummary[5]:Enduse99[4]"			Proj:ResultSummary[5]:Enduse99[4]	= {
         if (IfValidAnd( ResultSummary[5]:GHCEnergyEffTDV > 0.00001 )==0) then  "0.00"  
         else  FltToStr( (-1 * ResultSummary[5]:GHCEnergyEffTDV), 2 )  endif  }
	"Adj ResultSummary[5]:Enduse14[4]"			Proj:ResultSummary[5]:Enduse14[4]	= {
         if (IfValidAnd( ResultSummary[5]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResultsW[14]:ProposedTDV[1] + ResultSummary[5]:GHCEnergyEffTDV), 2 )  endif  }
   ; SAC 2/2/19 - Reporting of Flexibility credit (tic #1053)
	"Set ResultSummary[5]:Enduse98[19]"			Proj:ResultSummary[5]:Enduse98[19]	= {
			if (LocalStatus( ResultSummary[5]:PFlxTDV[1] ) < 1) then  UNDEFINED
         else  FltToStr( ResultSummary[5]:PFlxTDV[1], 2 )  endif  }
	"Set ResultSummary[5]:Enduse98[4]"			Proj:ResultSummary[5]:Enduse98[4]	= {  ResultSummary[5]:Enduse98[19]  }
	"Set ResultSummary[5]:Enduse10[4]"			Proj:ResultSummary[5]:Enduse10[4]	= {
	      if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED
	      else  FltToStr( (int(RunResultsW[10]:ProposedTDV[1]*100+0.5)/100) + ValidOr( ResultSummary[5]:PFlxTDV[1], 0 ), 2 )  endif  }

  ; DesignRating Margin TDV
	"Set ResultSummary[5]:Title1[15]"			Proj:ResultSummary[5]:Title1[15]		= {	if (EnergyCodeYearNum < 2022) then  "Design Rating"  else if (EnergyCodeYearNum < 2025) then  "Design Rating Margins:"  else  "Design Rating Margins"  endif endif  }  ; SAC 12/01/22
	"Set ResultSummary[5]:Title2[15]"			Proj:ResultSummary[5]:Title2[15]		= {	if (EnergyCodeYearNum < 2022) then  "Margin"         else  "EDR2"                    endif  }
	"Set ResultSummary[5]:Title3[15]"			Proj:ResultSummary[5]:Title3[15]		= {	if (EnergyCodeYearNum < 2022) then  "(kTDV/ft-yr)"  else if (EnergyCodeYearNum < 2025) then  "(kTDV/ft-yr)"  else  "($/ft)"  endif endif  }  ; SAC 12/01/22
   ; SAC 10/2/17 - switched from reporting delta with DRtgTDV w/o fuel adjustment mult applied to DRtgTDV W/ fuel adjustment mult applied
	"Set ResultSummary[5]:Enduse1[15]"			Proj:ResultSummary[5]:Enduse1[15]	= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[1]:DesignRatingTDV[2]  - RunResultsW[1]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse2[15]"			Proj:ResultSummary[5]:Enduse2[15]	= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[2]:DesignRatingTDV[2]  - RunResultsW[2]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse3[15]"			Proj:ResultSummary[5]:Enduse3[15]	= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[3]:DesignRatingTDV[2]  - RunResultsW[3]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse4[15]"			Proj:ResultSummary[5]:Enduse4[15]	= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[4]:DesignRatingTDV[2]  - RunResultsW[4]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse5[15]"			Proj:ResultSummary[5]:Enduse5[15]	= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[5]:DesignRatingTDV[2]  - RunResultsW[5]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse14[15]"			Proj:ResultSummary[5]:Enduse14[15]	= {	if (LocalCompAssigned( RunResultsW[14] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[14]:DesignRatingTDV[2] - RunResultsW[14]:ProposedTDV[2] ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse6[15]"			Proj:ResultSummary[5]:Enduse6[15]	= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[6]:DesignRatingTDV[2]  - RunResultsW[6]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse7[15]"			Proj:ResultSummary[5]:Enduse7[15]	= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[7]:DesignRatingTDV[2]  - RunResultsW[7]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse8[15]"			Proj:ResultSummary[5]:Enduse8[15]	= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[8]:DesignRatingTDV[2]  - RunResultsW[8]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse9[15]"			Proj:ResultSummary[5]:Enduse9[15]	= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[9]:DesignRatingTDV[2]  - RunResultsW[9]:ProposedTDV[2]  ), 2 )  endif  }
   ; SAC 2/2/19 - Flexibility reporting via new PFlxTDV property (tic #1053)
 	"Set ResultSummary[5]:Enduse10[15]"			Proj:ResultSummary[5]:Enduse10[15]	= {
 	      if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED
 	      else  FltToStr( (int((RunResultsW[10]:DesignRatingTDV[2]*100)+0.5) - int((RunResultsW[10]:ProposedTDV[2]*100)+0.5)) / 100 - ValidOr( ResultSummary[5]:PFlxTDV[1], 0 ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse11[15]"			Proj:ResultSummary[5]:Enduse11[15]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[11]:DesignRatingTDV[2] - RunResultsW[11]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse12[15]"			Proj:ResultSummary[5]:Enduse12[15]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[12]:DesignRatingTDV[2] - RunResultsW[12]:ProposedTDV[2] ), 2 )  endif  }
 	;"Set ResultSummary[5]:Enduse13[15]"			Proj:ResultSummary[5]:Enduse13[15]	= {	FltToStr( PVCredit, 2 )  }
 	;"Set ResultSummary[5]:Enduse13[15]"			Proj:ResultSummary[5]:Enduse13[15]	= {	if (EnergyCodeYearNum >= 2019)
   ;                                                                              then  if (LocalCompAssigned( RunResultsW[13] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[13]:CompMarginTDV,     2 )  endif
   ;                                                                              else  if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[6]:PropPVCreditTDV[2], 2 )  endif endif  }
 	;"Set ResultSummary[5]:Enduse13[15]"			Proj:ResultSummary[5]:Enduse13[15]	= {	if (LocalCompAssigned( RunResultsW[13] ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[13]:CompMarginTDV,     2 )  endif  }
 	"Set ResultSummary[5]:Enduse13[15]"			Proj:ResultSummary[5]:Enduse13[15]	= {	if (LocalCompAssigned( RunResultsW[13] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[13]:DesignRatingTDV[2] - RunResultsW[13]:ProposedTDV[2] ), 2 )  endif  }
   ; SAC 1/7/18 - Battery adjustments for GHC (grid harmonization credit)
	"Set ResultSummary[5]:Enduse99[15]"			Proj:ResultSummary[5]:Enduse99[15]	= {
         if (IfValidAnd( ResultSummary[5]:GHCEnergyEffTDV > 0.00001 )==0) then  "0.00"  
         else  FltToStr( ResultSummary[5]:GHCEnergyEffTDV, 2 )  endif  }
	"Adj ResultSummary[5]:Enduse14[15]"			Proj:ResultSummary[5]:Enduse14[15]	= {
         if (IfValidAnd( ResultSummary[5]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResultsW[14]:DesignRatingTDV[2] - RunResultsW[14]:ProposedTDV[2] - ResultSummary[5]:GHCEnergyEffTDV), 2 )  endif  }
   ; SAC 1/22/18 - Battery adjustments for GHC to Compliance Enduse Details (grid harmonization credit)
	"Set ResultSummary[5]:Enduse99[8]"			Proj:ResultSummary[5]:Enduse99[8]	= {
         if (IfValidAnd( ResultSummary[5]:GHCEnergyEffTDV > 0.00001 )==0) then  "0.00"  
         else  FltToStr( ResultSummary[5]:GHCEnergyEffTDV, 2 )  endif  }
	"Adj ResultSummary[5]:Enduse14[8]"			Proj:ResultSummary[5]:Enduse14[8]	= {
         if (IfValidAnd( ResultSummary[5]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED  
         else  FltToStr( (RunResultsW[14]:StandardTDV - RunResultsW[14]:ProposedTDV[1] - ResultSummary[5]:GHCEnergyEffTDV), 2 )  endif  }
   ; SAC 1/22/18 - Compliance Total adjustments for Battery GHC (grid harmonization credit)
	"Adj ResultSummary[5]:Enduse11[4]"			Proj:ResultSummary[5]:Enduse11[4]	= {
         if (LocalCompAssigned( RunResultsW[11] ) == 0 .OR. IfValidAnd( ResultSummary[5]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else  FltToStr( (RunResultsW[11]:ProposedTDV[1] - ResultSummary[5]:GHCEnergyEffTDV), 2 )  endif  }
 	"Adj ResultSummary[5]:Enduse11[8]"			Proj:ResultSummary[5]:Enduse11[8]	= {
         if (LocalCompAssigned( RunResultsW[11] ) == 0 .OR. IfValidAnd( ResultSummary[5]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else  FltToStr( (RunResultsW[11]:CompMarginTDV + ResultSummary[5]:GHCEnergyEffTDV), 2 )  endif  }
	"Adj ResultSummary[5]:PctSavingsCmpTDV"	Proj:ResultSummary[5]:PctSavingsCmpTDV	= {
         if (IfValidAnd( RunResultsW[11]:StandardTDV > 0.001 )==0 .OR. IfValidAnd( ResultSummary[5]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else  int((((RunResultsW[11]:StandardTDV - ValidOr( RunResultsW[11]:ProposedTDV[1], 0 ) + ResultSummary[5]:GHCEnergyEffTDV) * 100 / RunResultsW[11]:StandardTDV ) * 10) +0.5 ) / 10  endif  }
	"Adj ResultSummary[5]:PctSavCmpTDVLbl"		Proj:ResultSummary[5]:PctSavCmpTDVLbl	= {
         if (IfValidAnd( ResultSummary[5]:GHCEnergyEffTDV > 0.00001 )==0) then  UNCHANGED
         else if (IfValidAnd( ResultSummary[5]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[5]:PctSavingsCmpTDV < -0.0001 )==0) then  "-" 
         else  Format( "%.1f", ResultSummary[5]:PctSavingsCmpTDV )  endif endif  }
   ; SAC 2/2/19 - Reporting of Flexibility credit (tic #1053)
	"Set ResultSummary[5]:Enduse98[15]"			Proj:ResultSummary[5]:Enduse98[15]	= {  FltToStr( -ValidOr( ResultSummary[5]:PFlxTDV[1], 0 ), 2 )  }

;	  ; Pass/Fail result
;	 	"Set ResultSummary[5]:PassFail"				Proj:ResultSummary[5]:PassFail		= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  if (RunResultsW[11]:CompMarginTDV >= 0) then "PASS"  else  "FAIL"  endif endif  }

  ; DesignRating Electric Demand
	"Set ResultSummary[5]:Title1[16]"			Proj:ResultSummary[5]:Title1[16]		= {	"Reference"  }
	"Set ResultSummary[5]:Title2[16]"			Proj:ResultSummary[5]:Title2[16]		= {	"Design"     }
	"Set ResultSummary[5]:Title3[16]"			Proj:ResultSummary[5]:Title3[16]		= {	"(kW)"  }
	"Set ResultSummary[5]:Enduse1[16]"			Proj:ResultSummary[5]:Enduse1[16]	= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[1]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse2[16]"			Proj:ResultSummary[5]:Enduse2[16]	= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[2]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse3[16]"			Proj:ResultSummary[5]:Enduse3[16]	= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[3]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse4[16]"			Proj:ResultSummary[5]:Enduse4[16]	= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[4]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse5[16]"			Proj:ResultSummary[5]:Enduse5[16]	= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[5]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse14[16]"			Proj:ResultSummary[5]:Enduse14[16]	= {	if (LocalCompAssigned( RunResultsW[14] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[14]:DRtgElecDemand ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse6[16]"			Proj:ResultSummary[5]:Enduse6[16]	= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[6]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse7[16]"			Proj:ResultSummary[5]:Enduse7[16]	= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[7]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse8[16]"			Proj:ResultSummary[5]:Enduse8[16]	= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[8]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse9[16]"			Proj:ResultSummary[5]:Enduse9[16]	= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[9]:DRtgElecDemand  ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse10[16]"			Proj:ResultSummary[5]:Enduse10[16]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[10]:DRtgElecDemand ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse11[16]"			Proj:ResultSummary[5]:Enduse11[16]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[11]:DRtgElecDemand ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse12[16]"			Proj:ResultSummary[5]:Enduse12[16]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[12]:DRtgElecDemand ), 2 )  endif  }

  ; Additional elec demand storage (SAC 10/26/16)
   "Set ResultSummary[5]:PropElecDemand[2]"  Proj:ResultSummary[5]:PropElecDemand[2]   = {   if (LocalCompAssigned( RunResultsW[10] ) == 0 .OR. LocalStatus( RunResultsW[10]:PropElecDemand[2] ) < 1) then  UNDEFINED
																												         else  ValidOr( RunResultsW[10]:PropElecDemand[2], 0 )  endif  }
   "Set ResultSummary[5]:DRtgElecDemand"     Proj:ResultSummary[5]:DRtgElecDemand      = {   if (LocalCompAssigned( RunResultsW[10] ) == 0 .OR. LocalStatus( RunResultsW[10]:DRtgElecDemand ) < 1) then  UNDEFINED
																												         else  ValidOr( RunResultsW[10]:DRtgElecDemand, 0 )  endif  }
	"Set ResultSummary[5]:MarginkW[2]"		   Proj:ResultSummary[5]:MarginkW[2]	      = {	if (LocalCompAssigned( RunResultsW[10] ) == 0 .OR. LocalStatus( ResultSummary[5]:PropElecDemand[2] ) < 1) then  UNDEFINED
																												         else  int(((ResultSummary[5]:DRtgElecDemand - ResultSummary[5]:PropElecDemand[2]) * 100) +0.5 ) / 100  endif  }

;	  ; Demand & Energy Use Margins (added w/ CAHP mods 10/8/14)
;		"Set ResultSummary[5]:MarginkW"			Proj:ResultSummary[5]:MarginkW		= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED
;																													else  ValidOr( RunResultsW[10]:StdElecDemand, 0 ) - ValidOr( RunResultsW[10]:PropElecDemand[2], 0 )  endif  }
;		"Set ResultSummary[5]:MarginkWh"			Proj:ResultSummary[5]:MarginkWh		= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED
;																													else  (ValidOr( RunResultsW[10]:StdElecEnergy, 0 ) - ValidOr( RunResultsW[10]:PropElecEnergy, 0 )) * CondFloorArea / 3.413  endif  }
;		"Set ResultSummary[5]:MarginTherms"		Proj:ResultSummary[5]:MarginTherms	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED
;																													else  (ValidOr( RunResultsW[10]:StdNatGasEnergy, 0 ) - ValidOr( RunResultsW[10]:PropNatGasEnergy, 0 )) * CondFloorArea / 100  endif  }
;	  ; Percent Savings values for reporting
;		"Set ResultSummary[5]:PctSavingskW"			Proj:ResultSummary[5]:PctSavingskW		= {	if (IfValidAnd( RunResultsW[10]:StdElecDemand > 0.001 )==0) then  UNDEFINED
;																															else  (RunResultsW[10]:StdElecDemand   - ValidOr( RunResultsW[10]:PropElecDemand[2],   0 )) * 100 / RunResultsW[10]:StdElecDemand    endif  }
;		"Set ResultSummary[5]:PctSavingskWh"		Proj:ResultSummary[5]:PctSavingskWh		= {	if (IfValidAnd( RunResultsW[10]:StdElecEnergy > 0.001 )==0) then  UNDEFINED
;																															else  (RunResultsW[10]:StdElecEnergy   - ValidOr( RunResultsW[10]:PropElecEnergy,   0 )) * 100 / RunResultsW[10]:StdElecEnergy    endif  }
;		"Set ResultSummary[5]:PctSavingsTherms"	Proj:ResultSummary[5]:PctSavingsTherms	= {	if (IfValidAnd( RunResultsW[10]:StdNatGasEnergy > 0.001 )==0) then  UNDEFINED
;																															else  (RunResultsW[10]:StdNatGasEnergy - ValidOr( RunResultsW[10]:PropNatGasEnergy, 0 )) * 100 / RunResultsW[10]:StdNatGasEnergy  endif  }
;		"Set ResultSummary[5]:PctSavingsTDV"		Proj:ResultSummary[5]:PctSavingsTDV		= {	if (IfValidAnd( RunResultsW[10]:StandardTDV     > 0.001 )==0) then  UNDEFINED
;																															else  (RunResultsW[10]:StandardTDV     - ValidOr( RunResultsW[10]:ProposedTDV[2],      0 )) * 100 / RunResultsW[10]:StandardTDV      endif  }
;		"Set ResultSummary[5]:PctSavingsCmpTDV"	Proj:ResultSummary[5]:PctSavingsCmpTDV	= {	if (IfValidAnd( RunResultsW[11]:StandardTDV     > 0.001 )==0) then  UNDEFINED
;																															else  (RunResultsW[11]:StandardTDV     - ValidOr( RunResultsW[11]:ProposedTDV[2],      0 )) * 100 / RunResultsW[11]:StandardTDV      endif  }
;		"Set ResultSummary[5]:PctSavkWLbl"			Proj:ResultSummary[5]:PctSavkWLbl		= {	if (IfValidAnd( ResultSummary[5]:PctSavingskW     > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[5]:PctSavingskW     < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[5]:PctSavingskW     )  endif  }
;		"Set ResultSummary[5]:PctSavkWhLbl"			Proj:ResultSummary[5]:PctSavkWhLbl		= {	if (IfValidAnd( ResultSummary[5]:PctSavingskWh    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[5]:PctSavingskWh    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[5]:PctSavingskWh    )  endif  }
;		"Set ResultSummary[5]:PctSavThermsLbl"		Proj:ResultSummary[5]:PctSavThermsLbl	= {	if (IfValidAnd( ResultSummary[5]:PctSavingsTherms > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[5]:PctSavingsTherms < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[5]:PctSavingsTherms )  endif  }
;		"Set ResultSummary[5]:PctSavTDVLbl"			Proj:ResultSummary[5]:PctSavTDVLbl		= {	if (IfValidAnd( ResultSummary[5]:PctSavingsTDV    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[5]:PctSavingsTDV    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[5]:PctSavingsTDV    )  endif  }
;		"Set ResultSummary[5]:PctSavCmpTDVLbl"		Proj:ResultSummary[5]:PctSavCmpTDVLbl	= {	if (IfValidAnd( ResultSummary[5]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[5]:PctSavingsCmpTDV < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[5]:PctSavingsCmpTDV )  endif  }

; SAC 1/7/18 - moved down here from above prior to GHC calcs
; SAC 3/30/15 - ADDED BACK IN - WorstOrientation setting stuff since this needs to be set inside DesignRating model BEMProc instance in order for results CSV export to function properly
; -- NOW -- Calculate WORST case scenario and reference THOSE RunResults objects in the main RunResults[] elements
	"Determine which RunResults is Worst case"	Proj:WorstOrientation	= {
         if (EnergyCodeYearNum >= 2019 .AND. LocalStatus( WorstOrientation ) > 0) then  UNCHANGED
         else if (RunResultsN[11]:CompMarginTDV <= RunResultsE[11]:CompMarginTDV .AND.
						RunResultsN[11]:CompMarginTDV <= RunResultsS[11]:CompMarginTDV .AND.
						RunResultsN[11]:CompMarginTDV <= RunResultsW[11]:CompMarginTDV )	then	1
			else if (RunResultsE[11]:CompMarginTDV <= RunResultsN[11]:CompMarginTDV .AND.
						RunResultsE[11]:CompMarginTDV <= RunResultsS[11]:CompMarginTDV .AND.
						RunResultsE[11]:CompMarginTDV <= RunResultsW[11]:CompMarginTDV )	then	2
			else if (RunResultsS[11]:CompMarginTDV <= RunResultsN[11]:CompMarginTDV .AND.
						RunResultsS[11]:CompMarginTDV <= RunResultsE[11]:CompMarginTDV .AND.
						RunResultsS[11]:CompMarginTDV <= RunResultsW[11]:CompMarginTDV )	then	3	else	4	endif endif endif endif  }
;"dbg" Proj:Action = { PostMessageToLog( "   Setting worst orientation to %g", WorstOrientation )  }
	"Call rules to set Worst case RunResults"		Proj:Action		= {	switch (WorstOrientation)
																								case  2 :  EvalRulelist( "CARes_RunResults_SetWorst_E" )
																								case  3 :  EvalRulelist( "CARes_RunResults_SetWorst_S" )
																								case  4 :  EvalRulelist( "CARes_RunResults_SetWorst_W" )
																								default :  EvalRulelist( "CARes_RunResults_SetWorst_N" )
																							endswitch  }
END


;*************************************************************************
RULELIST "CARes_SummaryTab" 1 0 1 1
;*************************************************************************
;	"Set EUseSummary:ComplyMessage"		EUseSummary:ComplyMessage		= {	if (GlobalCompAssigned( Proj:RunResults[11] ) == 0) then  UNDEFINED
;																									else if (Proj:RunResultsW[11]:CompMarginTDV >= 0) then "COMPLIES"  else  "DOES NOT COMPLY"  endif endif  }
	"Set EUseSummary:ComplyMessage"		EUseSummary:ComplyMessage		= {	if (Proj:RunResults[11]:CompMarginTDV >= 0) then "COMPLIES"  else  "DOES NOT COMPLY"  endif  }

	"Set EUseSummary:SummaryCol1[4]"		EUseSummary:SummaryCol1[4]		= {	"Standard Design"  }
	"Set EUseSummary:SummaryCol1[5]"		EUseSummary:SummaryCol1[5]		= {	"Proposed Design"  }

	"Set EUseSummary:SummaryCol2[1]"		EUseSummary:SummaryCol2[1]		= {	"Compliance"     }
	"Set EUseSummary:SummaryCol2[2]"		EUseSummary:SummaryCol2[2]		= {	"Total"          }
	"Set EUseSummary:SummaryCol2[3]"		EUseSummary:SummaryCol2[3]		= {	"(kTDV/ft-yr)"  }
;	"Set EUseSummary:SummaryCol2[4]"		EUseSummary:SummaryCol2[4]		= {	if (GlobalCompAssigned( Proj:RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( GlobalRef( Proj:RunResults[11]:StandardTDV ), 2 )  endif  }
;	"Set EUseSummary:SummaryCol2[5]"		EUseSummary:SummaryCol2[5]		= {	if (GlobalCompAssigned( Proj:RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( GlobalRef( Proj:RunResults[11]:ProposedTDV ), 2 )  endif  }
	"Set EUseSummary:SummaryCol2[4]"		EUseSummary:SummaryCol2[4]		= {	FltToStr( Proj:RunResults[11]:StandardTDV, 2 )  }
	"Set EUseSummary:SummaryCol2[5]"		EUseSummary:SummaryCol2[5]		= {	FltToStr( Proj:RunResults[11]:ProposedTDV[1], 2 )  }

	"Set EUseSummary:SummaryCol3[1]"		EUseSummary:SummaryCol3[1]		= {	"Compliance"     }
	"Set EUseSummary:SummaryCol3[2]"		EUseSummary:SummaryCol3[2]		= {	"Margin"         }
	"Set EUseSummary:SummaryCol3[3]"		EUseSummary:SummaryCol3[3]		= {	"(kTDV/ft-yr)"  }
;	"Set EUseSummary:SummaryCol3[5]"		EUseSummary:SummaryCol3[5]		= {	if (GlobalCompAssigned( Proj:RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( GlobalRef( Proj:RunResults[11]:CompMarginTDV ), 2 )  endif  }
	"Set EUseSummary:SummaryCol3[5]"		EUseSummary:SummaryCol3[5]		= {	FltToStr( Proj:RunResults[11]:CompMarginTDV, 2 )  }
END

;*************************************************************************
RULELIST "CARes_SummaryTab_2019" 1 0 1 1
;*************************************************************************
   ; SAC 12/12/17 - added EUseSummary:MarginEfficEDR & MarginFinalEDR for more consistent compliance result & reporting
   "Set EUseSummary:MarginEfficEDR - Efficiency (without PV & flexibility credit) EDR margin"
      EUseSummary:MarginEfficEDR  = {
         if (LocalStatus( DesignRatingStdNoPV ) < 1 .OR.
             LocalStatus( DesignRatingNoPV    ) < 1) then  UNDEFINED
         else  (int( (DesignRatingStdNoPV * 10)+0.5 ) - int( (DesignRatingNoPV * 10)+0.5 )) / 10
         endif  }
   "Set EUseSummary:MarginFinalEDR - Final EDR margin"
      EUseSummary:MarginFinalEDR  = {
         if (LocalStatus( DesignRatingStd ) < 1 .OR.
             LocalStatus( DesignRating    ) < 1) then  UNDEFINED
         else  (int( (DesignRatingStd * 10)+0.5 ) - int( (DesignRating * 10)+0.5 )) / 10
         endif  }
; moved setting of EUseSummary:StdDesignPVSize over to BudgetConversion rules - SAC 1/11/18
;   "Set EUseSummary:StdDesignPVSize - PV system size needed to offset electric use of standard mixed fuel model"
;      EUseSummary:StdDesignPVSize  = {
;         if (IfValidAnd( StdMixedFuelPV != 0 )==0) then  0
;         else  -1 * ValidOr( StdMixedFuelkWh, 0 ) / StdMixedFuelPV
;         endif  } 

   "Set EUseSummary:PassFail"          EUseSummary:PassFail          = {
         if (IfValidAnd( Proj:ResultSummary[1]:MarginEfficEDR >= 0 ) .AND.
             IfValidAnd( Proj:ResultSummary[1]:MarginFinalEDR >= 0 ))
         then  "PASS"  else  "FAIL"  endif  }
;         if (IfValidAnd( Proj:ResultSummary[1]:DesignRatingStdNoPV >= Proj:ResultSummary[1]:DesignRatingNoPV ) .AND.
;             IfValidAnd( Proj:ResultSummary[1]:DesignRatingStd     >= Proj:ResultSummary[1]:DesignRating     ))
;         then  "PASS"  else  "FAIL"  endif  }
   "Set EUseSummary:ComplyMessage"     EUseSummary:ComplyMessage     = {
         if (IfValidAnd( PassFail = "PASS" ))
         then "COMPLIES"  else  "DOES NOT COMPLY"  endif  }

	"Set EUseSummary:SummaryCol1[4]"		EUseSummary:SummaryCol1[4]		= {	"Standard Design"  }
	"Set EUseSummary:SummaryCol1[5]"		EUseSummary:SummaryCol1[5]		= {	"Proposed Design"  }

	"Set EUseSummary:SummaryCol2[1]"		EUseSummary:SummaryCol2[1]		= {	"Compliance"     }
	"Set EUseSummary:SummaryCol2[2]"		EUseSummary:SummaryCol2[2]		= {	"Energy Use"     }  ; was:  "Total"          }
	"Set EUseSummary:SummaryCol2[3]"		EUseSummary:SummaryCol2[3]		= {	"(kTDV/ft-yr)"  }
	"Set EUseSummary:SummaryCol2[4]"		EUseSummary:SummaryCol2[4]		= {	FltToStr( Proj:RunResults[11]:StandardTDV, 2 )  }
	"Set EUseSummary:SummaryCol2[5]"		EUseSummary:SummaryCol2[5]		= {	FltToStr( Proj:RunResults[11]:ProposedTDV[1], 2 )  }

; compliance margin for <= 2016
;	"Set EUseSummary:SummaryCol3[1]"		EUseSummary:SummaryCol3[1]		= {	"Compliance"     }
;	"Set EUseSummary:SummaryCol3[2]"		EUseSummary:SummaryCol3[2]		= {	"Margin"         }
;	"Set EUseSummary:SummaryCol3[3]"		EUseSummary:SummaryCol3[3]		= {	"(kTDV/ft-yr)"  }
;	"Set EUseSummary:SummaryCol3[5]"		EUseSummary:SummaryCol3[5]		= {	FltToStr( Proj:RunResults[11]:CompMarginTDV, 2 )  }

; compliance margin for >= 2019
;	"Set EUseSummary:SummaryColNPVMarg[1]"    EUseSummary:SummaryColNPVMarg[1]   = {  "Efficiency"  }
	"Set EUseSummary:SummaryColNPVMarg[2]"    EUseSummary:SummaryColNPVMarg[2]   = {  "Efficiency"  }
	"Set EUseSummary:SummaryColNPVMarg[3]"    EUseSummary:SummaryColNPVMarg[3]   = {  "(EDR)"           }
	"Set EUseSummary:SummaryColNPVMarg[5]"    EUseSummary:SummaryColNPVMarg[5]   = {  FltToStr( Proj:ResultSummary[1]:MarginEfficEDR, 1 )  }  ; Proj:ResultSummary[1]:DesignRatingStdNoPV - Proj:ResultSummary[1]:DesignRatingNoPV, 1 )  }

;	"Set EUseSummary:SummaryColFinMarg[1]"    EUseSummary:SummaryColFinMarg[1]   = {  "Final"   }
	"Set EUseSummary:SummaryColFinMarg[2]"    EUseSummary:SummaryColFinMarg[2]   = {  "Total"   }
	"Set EUseSummary:SummaryColFinMarg[3]"    EUseSummary:SummaryColFinMarg[3]   = {  "(EDR)"           }
	"Set EUseSummary:SummaryColFinMarg[5]"    EUseSummary:SummaryColFinMarg[5]   = {  FltToStr( Proj:ResultSummary[1]:MarginFinalEDR, 1 )  }  ; Proj:ResultSummary[1]:DesignRatingStd - Proj:ResultSummary[1]:DesignRating, 1 )  }


;	"Set EUseSummary:SummaryColNoPVDR[1]"     EUseSummary:SummaryColNoPVDR[1]    = {  ""  }
	"Set EUseSummary:SummaryColNoPVDR[2]"     EUseSummary:SummaryColNoPVDR[2]    = {  "Efficiency"  }
	"Set EUseSummary:SummaryColNoPVDR[3]"     EUseSummary:SummaryColNoPVDR[3]    = {  "(EDR)"           }
   "Set EUseSummary:SummaryColNoPVDR[4]"     EUseSummary:SummaryColNoPVDR[4]    = {  FltToStr( Proj:ResultSummary[1]:DesignRatingStdNoPV, 1 )  }
	"Set EUseSummary:SummaryColNoPVDR[5]"     EUseSummary:SummaryColNoPVDR[5]    = {  FltToStr( Proj:ResultSummary[1]:DesignRatingNoPV,    1 )  }

;	"Set EUseSummary:SummaryColPVOnlyDR[1]"   EUseSummary:SummaryColPVOnlyDR[1]  = {  ""  }
	"Set EUseSummary:SummaryColPVOnlyDR[2]"   EUseSummary:SummaryColPVOnlyDR[2]  = {  "Flexibility"  }
	"Set EUseSummary:SummaryColPVOnlyDR[3]"   EUseSummary:SummaryColPVOnlyDR[3]  = {  "(EDR)"           }
   "Set EUseSummary:SummaryColPVOnlyDR[4]"   EUseSummary:SummaryColPVOnlyDR[4]  = {  FltToStr( Proj:ResultSummary[1]:DesignRatingStdPVOnly, 1 )  }
	"Set EUseSummary:SummaryColPVOnlyDR[5]"   EUseSummary:SummaryColPVOnlyDR[5]  = {  FltToStr( Proj:ResultSummary[1]:DesignRatingPVOnly,    1 )  }

;	"Set EUseSummary:SummaryColFinDR[1]"      EUseSummary:SummaryColFinDR[1]     = {  ""  }
	"Set EUseSummary:SummaryColFinDR[2]"      EUseSummary:SummaryColFinDR[2]     = {  "Total"  }
	"Set EUseSummary:SummaryColFinDR[3]"      EUseSummary:SummaryColFinDR[3]     = {  "(EDR)"           }
   "Set EUseSummary:SummaryColFinDR[4]"      EUseSummary:SummaryColFinDR[4]     = {  FltToStr( Proj:ResultSummary[1]:DesignRatingStd, 1 )  }
	"Set EUseSummary:SummaryColFinDR[5]"      EUseSummary:SummaryColFinDR[5]     = {  FltToStr( Proj:ResultSummary[1]:DesignRating,    1 )  }

  ; SAC 10/6/17 - round carbon emissions values for display
   "Call rulelist to round carbon emissions results"  Proj:Action = {   EvalRulelist( "CARes_RoundResults_Carbon" )  }
END

;*************************************************************************   - SAC 6/12/19
RULELIST "CARes_SummaryTab_2022" 1 0 1 1
;*************************************************************************
   "evaluate 2019 rulelist to populate most fields for 2022+"    Proj:Action  =     ; SAC 6/12/19
      {  EvalRulelist( "CARes_SummaryTab_2019" )  }

   ; SAC 6/12/19 - EDR1 unique to 2022
   "Set EUseSummary:EDR1Margin"     EUseSummary:EDR1Margin  =
      {  if (LocalStatus( EDR1DesignRatingStd ) < 1 .OR.
             LocalStatus( EDR1DesignRating    ) < 1) then  UNDEFINED
         else  (int( (EDR1DesignRatingStd * 10)+0.5 ) - int( (EDR1DesignRating * 10)+0.5 )) / 10
         endif  }

   "Set EUseSummary:PassFail"          EUseSummary:PassFail          = {
         if (IfValidAnd( Proj:ResultSummary[1]:MarginEfficEDR >= 0 ) .AND.
             IfValidAnd( Proj:ResultSummary[1]:MarginFinalEDR >= 0 ) .AND.
             IfValidAnd( Proj:ResultSummary[1]:EDR1Margin     >= 0 ))
         then  "PASS"  else  "FAIL"  endif  }
   "Set EUseSummary:ComplyMessage"     EUseSummary:ComplyMessage     = {
         if (IfValidAnd( PassFail = "PASS" ))
         then "COMPLIES"  else  "DOES NOT COMPLY"  endif  }

; mods to 2019 labels
	"Set EUseSummary:SummaryColNPVMarg[3]"    EUseSummary:SummaryColNPVMarg[3]   = {  "(EDR2)"           }
	"Set EUseSummary:SummaryColFinMarg[3]"    EUseSummary:SummaryColFinMarg[3]   = {  "(EDR2)"           }
	"Set EUseSummary:SummaryColNoPVDR[3]"     EUseSummary:SummaryColNoPVDR[3]    = {  "(EDR2)"           }
	"Set EUseSummary:SummaryColPVOnlyDR[3]"   EUseSummary:SummaryColPVOnlyDR[3]  = {  "(EDR2)"           }
	"Set EUseSummary:SummaryColFinDR[3]"      EUseSummary:SummaryColFinDR[3]     = {  "(EDR2)"           }

; column data specific to 2022+
	"Set EUseSummary:SummaryColEDR1Marg[2]"   EUseSummary:SummaryColEDR1Marg[2]  = {  "Source"   }
	"Set EUseSummary:SummaryColEDR1Marg[3]"   EUseSummary:SummaryColEDR1Marg[3]  = {  "(EDR1)"           }
	"Set EUseSummary:SummaryColEDR1Marg[5]"   EUseSummary:SummaryColEDR1Marg[5]  = {  FltToStr( Proj:ResultSummary[1]:EDR1Margin, 1 )  }

	"Set EUseSummary:SummaryColEDR1[2]"       EUseSummary:SummaryColEDR1[2]      = {  "Source"  }
	"Set EUseSummary:SummaryColEDR1[3]"       EUseSummary:SummaryColEDR1[3]      = {  "(EDR1)"           }
   "Set EUseSummary:SummaryColEDR1[4]"       EUseSummary:SummaryColEDR1[4]      = {  FltToStr( Proj:ResultSummary[1]:EDR1DesignRatingStd, 1 )  }
	"Set EUseSummary:SummaryColEDR1[5]"       EUseSummary:SummaryColEDR1[5]      = {  FltToStr( Proj:ResultSummary[1]:EDR1DesignRating,    1 )  }

END

;*************************************************************************   - SAC 11/22/22
RULELIST "CARes_SummaryTab_2025" 1 0 1 1
;*************************************************************************
   "evaluate 2019 rulelist to populate most fields for 2022+"    Proj:Action  =     ; SAC 6/12/19
      {  EvalRulelist( "CARes_SummaryTab_2019" )  }

;   ; SAC 6/12/19 - EDR1 unique to 2022
;   "Set EUseSummary:EDR1Margin"     EUseSummary:EDR1Margin  =
;      {  if (LocalStatus( EDR1DesignRatingStd ) < 1 .OR.
;             LocalStatus( EDR1DesignRating    ) < 1) then  UNDEFINED
;         else  (int( (EDR1DesignRatingStd * 10)+0.5 ) - int( (EDR1DesignRating * 10)+0.5 )) / 10
;         endif  }

   "Set EUseSummary:PassFail"          EUseSummary:PassFail          =     ; added PeakCoolElec metric - SAC 08/08/23  ; enable 'n/a' - SAC 08/14/23
      {  if (IfValidAnd( Proj:ResultSummary[1]:MetricPassFail[1]     = "Pass" ) .AND.
             IfValidAnd( Proj:ResultSummary[1]:MetricPassFail[2]     = "Pass" ) .AND.
             IfValidAnd( Proj:ResultSummary[1]:MetricPassFail[3]     = "Pass" ) .AND.
            (IfValidAnd( Proj:ResultSummary[1]:PeakCoolElecLabels[4] = "Pass" ) .OR. IfValidAnd( Proj:ResultSummary[1]:PeakCoolElecLabels[4] = "n/a" )))
         then  "PASS"  else  "FAIL"  endif  }
   "Set EUseSummary:ComplyMessage"     EUseSummary:ComplyMessage     = {
         if (IfValidAnd( PassFail = "PASS" ))
         then "COMPLIES"  else  "DOES NOT COMPLY"  endif  }

;; mods to 2019 labels
;	"Set EUseSummary:SummaryColNPVMarg[3]"    EUseSummary:SummaryColNPVMarg[3]   = {  "(EDR2)"           }
;	"Set EUseSummary:SummaryColFinMarg[3]"    EUseSummary:SummaryColFinMarg[3]   = {  "(EDR2)"           }
;	"Set EUseSummary:SummaryColNoPVDR[3]"     EUseSummary:SummaryColNoPVDR[3]    = {  "(EDR2)"           }
;	"Set EUseSummary:SummaryColPVOnlyDR[3]"   EUseSummary:SummaryColPVOnlyDR[3]  = {  "(EDR2)"           }
;	"Set EUseSummary:SummaryColFinDR[3]"      EUseSummary:SummaryColFinDR[3]     = {  "(EDR2)"           }
;
;; column data specific to 2022+
;	"Set EUseSummary:SummaryColEDR1Marg[2]"   EUseSummary:SummaryColEDR1Marg[2]  = {  "Source"   }
;	"Set EUseSummary:SummaryColEDR1Marg[3]"   EUseSummary:SummaryColEDR1Marg[3]  = {  "(EDR1)"           }
;	"Set EUseSummary:SummaryColEDR1Marg[5]"   EUseSummary:SummaryColEDR1Marg[5]  = {  FltToStr( Proj:ResultSummary[1]:EDR1Margin, 1 )  }
;
;	"Set EUseSummary:SummaryColEDR1[2]"       EUseSummary:SummaryColEDR1[2]      = {  "Source"  }
;	"Set EUseSummary:SummaryColEDR1[3]"       EUseSummary:SummaryColEDR1[3]      = {  "(EDR1)"           }
;   "Set EUseSummary:SummaryColEDR1[4]"       EUseSummary:SummaryColEDR1[4]      = {  FltToStr( Proj:ResultSummary[1]:EDR1DesignRatingStd, 1 )  }
;	"Set EUseSummary:SummaryColEDR1[5]"       EUseSummary:SummaryColEDR1[5]      = {  FltToStr( Proj:ResultSummary[1]:EDR1DesignRating,    1 )  }

END

;*************************************************************************
RULELIST "CARes_SummaryTab_NESW" 1 0 1 1
;*************************************************************************
;	"Set EUseSummary:ComplyMessage"		EUseSummary:ComplyMessage		= {	if (GlobalCompAssigned( Proj:RunResults[11] ) == 0) then  UNDEFINED
;																									else if (Proj:RunResults[11]:CompMarginTDV >= 0) then "COMPLIES"  else  "DOES NOT COMPLY"  endif endif  }
	"Set EUseSummary:ComplyMessage"		EUseSummary:ComplyMessage		= {	if (Proj:RunResults[11]:CompMarginTDV >= 0) then "COMPLIES"  else  "DOES NOT COMPLY"  endif  }

	"Set EUseSummary:SummaryCol1[4]"		EUseSummary:SummaryCol1[4]		= {	"Standard Design"  }
	"Set EUseSummary:SummaryCol1[5]"		EUseSummary:SummaryCol1[5]		= {	"Proposed Designs:"  }
;	"Set EUseSummary:SummaryCol1[6]"		EUseSummary:SummaryCol1[6]		= {	if (GlobalCompAssigned( Proj:ResultSummary[2] ) == 0) then  UNDEFINED  else  Proj:ResultSummary[2]:Name  endif  }
;	"Set EUseSummary:SummaryCol1[7]"		EUseSummary:SummaryCol1[7]		= {	if (GlobalCompAssigned( Proj:ResultSummary[3] ) == 0) then  UNDEFINED  else  Proj:ResultSummary[3]:Name  endif  }
;	"Set EUseSummary:SummaryCol1[8]"		EUseSummary:SummaryCol1[8]		= {	if (GlobalCompAssigned( Proj:ResultSummary[4] ) == 0) then  UNDEFINED  else  Proj:ResultSummary[4]:Name  endif  }
;	"Set EUseSummary:SummaryCol1[9]"		EUseSummary:SummaryCol1[9]		= {	if (GlobalCompAssigned( Proj:ResultSummary[5] ) == 0) then  UNDEFINED  else  Proj:ResultSummary[5]:Name  endif  }
	"Set EUseSummary:SummaryCol1[6]"		EUseSummary:SummaryCol1[6]		= {	Proj:ResultSummary[2]:Name  }
	"Set EUseSummary:SummaryCol1[7]"		EUseSummary:SummaryCol1[7]		= {	Proj:ResultSummary[3]:Name  }
	"Set EUseSummary:SummaryCol1[8]"		EUseSummary:SummaryCol1[8]		= {	Proj:ResultSummary[4]:Name  }
	"Set EUseSummary:SummaryCol1[9]"		EUseSummary:SummaryCol1[9]		= {	Proj:ResultSummary[5]:Name  }

	"Set EUseSummary:SummaryCol2[1]"		EUseSummary:SummaryCol2[1]		= {	"Compliance"     }
	"Set EUseSummary:SummaryCol2[2]"		EUseSummary:SummaryCol2[2]		= {	"Total"          }
	"Set EUseSummary:SummaryCol2[3]"		EUseSummary:SummaryCol2[3]		= {	"(kTDV/ft-yr)"  }
;	"Set EUseSummary:SummaryCol2[4]"		EUseSummary:SummaryCol2[4]		= {	if (GlobalCompAssigned( Proj:RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( GlobalRef( Proj:RunResultsN[11]:StandardTDV ), 2 )  endif  }
;	"Set EUseSummary:SummaryCol2[6]"		EUseSummary:SummaryCol2[6]		= {	if (GlobalCompAssigned( Proj:RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( GlobalRef( Proj:RunResultsN[11]:ProposedTDV ), 2 )  endif  }
;	"Set EUseSummary:SummaryCol2[7]"		EUseSummary:SummaryCol2[7]		= {	if (GlobalCompAssigned( Proj:RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( GlobalRef( Proj:RunResultsE[11]:ProposedTDV ), 2 )  endif  }
;	"Set EUseSummary:SummaryCol2[8]"		EUseSummary:SummaryCol2[8]		= {	if (GlobalCompAssigned( Proj:RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( GlobalRef( Proj:RunResultsS[11]:ProposedTDV ), 2 )  endif  }
;	"Set EUseSummary:SummaryCol2[9]"		EUseSummary:SummaryCol2[9]		= {	if (GlobalCompAssigned( Proj:RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( GlobalRef( Proj:RunResultsW[11]:ProposedTDV ), 2 )  endif  }
	"Set EUseSummary:SummaryCol2[4]"		EUseSummary:SummaryCol2[4]		= {	FltToStr( Proj:RunResultsN[11]:StandardTDV, 2 )  }
	"Set EUseSummary:SummaryCol2[6]"		EUseSummary:SummaryCol2[6]		= {	FltToStr( Proj:RunResultsN[11]:ProposedTDV[1], 2 )  }
	"Set EUseSummary:SummaryCol2[7]"		EUseSummary:SummaryCol2[7]		= {	FltToStr( Proj:RunResultsE[11]:ProposedTDV[1], 2 )  }
	"Set EUseSummary:SummaryCol2[8]"		EUseSummary:SummaryCol2[8]		= {	FltToStr( Proj:RunResultsS[11]:ProposedTDV[1], 2 )  }
	"Set EUseSummary:SummaryCol2[9]"		EUseSummary:SummaryCol2[9]		= {	FltToStr( Proj:RunResultsW[11]:ProposedTDV[1], 2 )  }

	"Set EUseSummary:SummaryCol3[1]"		EUseSummary:SummaryCol3[1]		= {	"Compliance"     }
	"Set EUseSummary:SummaryCol3[2]"		EUseSummary:SummaryCol3[2]		= {	"Margin"         }
	"Set EUseSummary:SummaryCol3[3]"		EUseSummary:SummaryCol3[3]		= {	"(kTDV/ft-yr)"  }
;	"Set EUseSummary:SummaryCol3[6]"		EUseSummary:SummaryCol3[6]		= {	if (GlobalCompAssigned( Proj:RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( GlobalRef( Proj:RunResultsN[11]:CompMarginTDV ), 2 )  endif  }
;	"Set EUseSummary:SummaryCol3[7]"		EUseSummary:SummaryCol3[7]		= {	if (GlobalCompAssigned( Proj:RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( GlobalRef( Proj:RunResultsE[11]:CompMarginTDV ), 2 )  endif  }
;	"Set EUseSummary:SummaryCol3[8]"		EUseSummary:SummaryCol3[8]		= {	if (GlobalCompAssigned( Proj:RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( GlobalRef( Proj:RunResultsS[11]:CompMarginTDV ), 2 )  endif  }
;	"Set EUseSummary:SummaryCol3[9]"		EUseSummary:SummaryCol3[9]		= {	if (GlobalCompAssigned( Proj:RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( GlobalRef( Proj:RunResultsW[11]:CompMarginTDV ), 2 )  endif  }
	"Set EUseSummary:SummaryCol3[6]"		EUseSummary:SummaryCol3[6]		= {	FltToStr( Proj:RunResultsN[11]:CompMarginTDV, 2 )  }
	"Set EUseSummary:SummaryCol3[7]"		EUseSummary:SummaryCol3[7]		= {	FltToStr( Proj:RunResultsE[11]:CompMarginTDV, 2 )  }
	"Set EUseSummary:SummaryCol3[8]"		EUseSummary:SummaryCol3[8]		= {	FltToStr( Proj:RunResultsS[11]:CompMarginTDV, 2 )  }
	"Set EUseSummary:SummaryCol3[9]"		EUseSummary:SummaryCol3[9]		= {	FltToStr( Proj:RunResultsW[11]:CompMarginTDV, 2 )  }
END

;*************************************************************************
RULELIST "CARes_SummaryTab_2019_NESW" 1 0 1 1
;*************************************************************************
   ; SAC 12/12/17 - added EUseSummary:MarginEfficEDR & MarginFinalEDR for more consistent compliance result & reporting
   "Set EUseSummary:MarginEfficEDR - Efficiency (without PV & flexibility credit) EDR margin"
      EUseSummary:MarginEfficEDR  = {
         if (LocalStatus( DesignRatingStdNoPV ) < 1 .OR.
             LocalStatus( DesignRatingNoPV    ) < 1) then  UNDEFINED
         else  (int( (DesignRatingStdNoPV * 10)+0.5 ) - int( (DesignRatingNoPV * 10)+0.5 )) / 10
         endif  }
   "Set EUseSummary:MarginFinalEDR - Final EDR margin"
      EUseSummary:MarginFinalEDR  = {
         if (LocalStatus( DesignRatingStd ) < 1 .OR.
             LocalStatus( DesignRating    ) < 1) then  UNDEFINED
         else  (int( (DesignRatingStd * 10)+0.5 ) - int( (DesignRating * 10)+0.5 )) / 10
         endif  }
; moved setting of EUseSummary:StdDesignPVSize over to BudgetConversion rules - SAC 1/11/18
;   "Set EUseSummary:StdDesignPVSize - PV system size needed to offset electric use of standard mixed fuel model"
;      EUseSummary:StdDesignPVSize  = {
;         if (IfValidAnd( StdMixedFuelPV != 0 )==0) then  0
;         else  -1 * ValidOr( StdMixedFuelkWh, 0 ) / StdMixedFuelPV
;         endif  } 

   "Set EUseSummary:PassFail"          EUseSummary:PassFail          = {
         if (IfValidAnd( Proj:ResultSummary[2]:MarginEfficEDR >= 0 ) .AND.
             IfValidAnd( Proj:ResultSummary[2]:MarginFinalEDR >= 0 ) .AND.
             IfValidAnd( Proj:ResultSummary[3]:MarginEfficEDR >= 0 ) .AND.
             IfValidAnd( Proj:ResultSummary[3]:MarginFinalEDR >= 0 ) .AND.
             IfValidAnd( Proj:ResultSummary[4]:MarginEfficEDR >= 0 ) .AND.
             IfValidAnd( Proj:ResultSummary[4]:MarginFinalEDR >= 0 ) .AND.
             IfValidAnd( Proj:ResultSummary[5]:MarginEfficEDR >= 0 ) .AND.
             IfValidAnd( Proj:ResultSummary[5]:MarginFinalEDR >= 0 ))
         then  "PASS"  else  "FAIL"  endif  }
;         if (IfValidAnd( Proj:ResultSummary[2]:DesignRatingStdNoPV >= Proj:ResultSummary[2]:DesignRatingNoPV ) .AND.
;             IfValidAnd( Proj:ResultSummary[2]:DesignRatingStd     >= Proj:ResultSummary[2]:DesignRating     ) .AND.
;             IfValidAnd( Proj:ResultSummary[3]:DesignRatingStdNoPV >= Proj:ResultSummary[3]:DesignRatingNoPV ) .AND.
;             IfValidAnd( Proj:ResultSummary[3]:DesignRatingStd     >= Proj:ResultSummary[3]:DesignRating     ) .AND.
;             IfValidAnd( Proj:ResultSummary[4]:DesignRatingStdNoPV >= Proj:ResultSummary[4]:DesignRatingNoPV ) .AND.
;             IfValidAnd( Proj:ResultSummary[4]:DesignRatingStd     >= Proj:ResultSummary[4]:DesignRating     ) .AND.
;             IfValidAnd( Proj:ResultSummary[5]:DesignRatingStdNoPV >= Proj:ResultSummary[5]:DesignRatingNoPV ) .AND.
;             IfValidAnd( Proj:ResultSummary[5]:DesignRatingStd     >= Proj:ResultSummary[5]:DesignRating     ))
;         then  "PASS"  else  "FAIL"  endif  }
   "Set EUseSummary:ComplyMessage"     EUseSummary:ComplyMessage     = {
         if (IfValidAnd( PassFail = "PASS" ))
         then "COMPLIES"  else  "DOES NOT COMPLY"  endif  }

	"Set EUseSummary:SummaryCol1[4]"		EUseSummary:SummaryCol1[4]		= {	"Standard Design"  }
	"Set EUseSummary:SummaryCol1[5]"		EUseSummary:SummaryCol1[5]		= {	"Proposed Designs:"  }
	"Set EUseSummary:SummaryCol1[6]"		EUseSummary:SummaryCol1[6]		= {	Proj:ResultSummary[2]:Name  }
	"Set EUseSummary:SummaryCol1[7]"		EUseSummary:SummaryCol1[7]		= {	Proj:ResultSummary[3]:Name  }
	"Set EUseSummary:SummaryCol1[8]"		EUseSummary:SummaryCol1[8]		= {	Proj:ResultSummary[4]:Name  }
	"Set EUseSummary:SummaryCol1[9]"		EUseSummary:SummaryCol1[9]		= {	Proj:ResultSummary[5]:Name  }

	"Set EUseSummary:SummaryCol2[1]"		EUseSummary:SummaryCol2[1]		= {	"Compliance"     }
	"Set EUseSummary:SummaryCol2[2]"		EUseSummary:SummaryCol2[2]		= {	"Energy Use"     }  ; was:  "Total"          }
	"Set EUseSummary:SummaryCol2[3]"		EUseSummary:SummaryCol2[3]		= {	"(kTDV/ft-yr)"  }
	"Set EUseSummary:SummaryCol2[4]"		EUseSummary:SummaryCol2[4]		= {	FltToStr( Proj:RunResultsN[11]:StandardTDV, 2 )  }
	"Set EUseSummary:SummaryCol2[6]"		EUseSummary:SummaryCol2[6]		= {	FltToStr( Proj:RunResultsN[11]:ProposedTDV[1], 2 )  }
	"Set EUseSummary:SummaryCol2[7]"		EUseSummary:SummaryCol2[7]		= {	FltToStr( Proj:RunResultsE[11]:ProposedTDV[1], 2 )  }
	"Set EUseSummary:SummaryCol2[8]"		EUseSummary:SummaryCol2[8]		= {	FltToStr( Proj:RunResultsS[11]:ProposedTDV[1], 2 )  }
	"Set EUseSummary:SummaryCol2[9]"		EUseSummary:SummaryCol2[9]		= {	FltToStr( Proj:RunResultsW[11]:ProposedTDV[1], 2 )  }

; compliance margin for <= 2016
;	"Set EUseSummary:SummaryCol3[1]"		EUseSummary:SummaryCol3[1]		= {	"Compliance"     }
;	"Set EUseSummary:SummaryCol3[2]"		EUseSummary:SummaryCol3[2]		= {	"Margin"         }
;	"Set EUseSummary:SummaryCol3[3]"		EUseSummary:SummaryCol3[3]		= {	"(kTDV/ft-yr)"  }
;	"Set EUseSummary:SummaryCol3[6]"		EUseSummary:SummaryCol3[6]		= {	FltToStr( Proj:RunResultsN[11]:CompMarginTDV, 2 )  }
;	"Set EUseSummary:SummaryCol3[7]"		EUseSummary:SummaryCol3[7]		= {	FltToStr( Proj:RunResultsE[11]:CompMarginTDV, 2 )  }
;	"Set EUseSummary:SummaryCol3[8]"		EUseSummary:SummaryCol3[8]		= {	FltToStr( Proj:RunResultsS[11]:CompMarginTDV, 2 )  }
;	"Set EUseSummary:SummaryCol3[9]"		EUseSummary:SummaryCol3[9]		= {	FltToStr( Proj:RunResultsW[11]:CompMarginTDV, 2 )  }

; compliance margin for >= 2019
;	"Set EUseSummary:SummaryColNPVMarg[1]"    EUseSummary:SummaryColNPVMarg[1]   = {  "Efficiency"  }
	"Set EUseSummary:SummaryColNPVMarg[2]"    EUseSummary:SummaryColNPVMarg[2]   = {  "Efficiency"  }
	"Set EUseSummary:SummaryColNPVMarg[3]"    EUseSummary:SummaryColNPVMarg[3]   = {  "(EDR)"           }
	"Set EUseSummary:SummaryColNPVMarg[6]"    EUseSummary:SummaryColNPVMarg[6]   = {  FltToStr( Proj:ResultSummary[2]:MarginEfficEDR, 1 )  }   ; Proj:ResultSummary[2]:DesignRatingStdNoPV - Proj:ResultSummary[2]:DesignRatingNoPV, 1 )  }
	"Set EUseSummary:SummaryColNPVMarg[7]"    EUseSummary:SummaryColNPVMarg[7]   = {  FltToStr( Proj:ResultSummary[3]:MarginEfficEDR, 1 )  }   ; Proj:ResultSummary[3]:DesignRatingStdNoPV - Proj:ResultSummary[3]:DesignRatingNoPV, 1 )  }
	"Set EUseSummary:SummaryColNPVMarg[8]"    EUseSummary:SummaryColNPVMarg[8]   = {  FltToStr( Proj:ResultSummary[4]:MarginEfficEDR, 1 )  }   ; Proj:ResultSummary[4]:DesignRatingStdNoPV - Proj:ResultSummary[4]:DesignRatingNoPV, 1 )  }
	"Set EUseSummary:SummaryColNPVMarg[9]"    EUseSummary:SummaryColNPVMarg[9]   = {  FltToStr( Proj:ResultSummary[5]:MarginEfficEDR, 1 )  }   ; Proj:ResultSummary[5]:DesignRatingStdNoPV - Proj:ResultSummary[5]:DesignRatingNoPV, 1 )  }

;	"Set EUseSummary:SummaryColFinMarg[1]"    EUseSummary:SummaryColFinMarg[1]   = {  "Final"   }
	"Set EUseSummary:SummaryColFinMarg[2]"    EUseSummary:SummaryColFinMarg[2]   = {  "Total"   }
	"Set EUseSummary:SummaryColFinMarg[3]"    EUseSummary:SummaryColFinMarg[3]   = {  "(EDR)"           }
	"Set EUseSummary:SummaryColFinMarg[6]"    EUseSummary:SummaryColFinMarg[6]   = {  FltToStr( Proj:ResultSummary[2]:MarginFinalEDR, 1 )  }   ; Proj:ResultSummary[2]:DesignRatingStd - Proj:ResultSummary[2]:DesignRating, 1 )  }
	"Set EUseSummary:SummaryColFinMarg[7]"    EUseSummary:SummaryColFinMarg[7]   = {  FltToStr( Proj:ResultSummary[3]:MarginFinalEDR, 1 )  }   ; Proj:ResultSummary[3]:DesignRatingStd - Proj:ResultSummary[3]:DesignRating, 1 )  }
	"Set EUseSummary:SummaryColFinMarg[8]"    EUseSummary:SummaryColFinMarg[8]   = {  FltToStr( Proj:ResultSummary[4]:MarginFinalEDR, 1 )  }   ; Proj:ResultSummary[4]:DesignRatingStd - Proj:ResultSummary[4]:DesignRating, 1 )  }
	"Set EUseSummary:SummaryColFinMarg[9]"    EUseSummary:SummaryColFinMarg[9]   = {  FltToStr( Proj:ResultSummary[5]:MarginFinalEDR, 1 )  }   ; Proj:ResultSummary[5]:DesignRatingStd - Proj:ResultSummary[5]:DesignRating, 1 )  }


;	"Set EUseSummary:SummaryColNoPVDR[1]"     EUseSummary:SummaryColNoPVDR[1]    = {  ""  }
	"Set EUseSummary:SummaryColNoPVDR[2]"     EUseSummary:SummaryColNoPVDR[2]    = {  "Efficiency"  }
	"Set EUseSummary:SummaryColNoPVDR[3]"     EUseSummary:SummaryColNoPVDR[3]    = {  "(EDR)"           }
   "Set EUseSummary:SummaryColNoPVDR[4]"     EUseSummary:SummaryColNoPVDR[4]    = {  FltToStr( Proj:ResultSummary[2]:DesignRatingStdNoPV, 1 )  }
	"Set EUseSummary:SummaryColNoPVDR[6]"     EUseSummary:SummaryColNoPVDR[6]    = {  FltToStr( Proj:ResultSummary[2]:DesignRatingNoPV,    1 )  }
	"Set EUseSummary:SummaryColNoPVDR[7]"     EUseSummary:SummaryColNoPVDR[7]    = {  FltToStr( Proj:ResultSummary[3]:DesignRatingNoPV,    1 )  }
	"Set EUseSummary:SummaryColNoPVDR[8]"     EUseSummary:SummaryColNoPVDR[8]    = {  FltToStr( Proj:ResultSummary[4]:DesignRatingNoPV,    1 )  }
	"Set EUseSummary:SummaryColNoPVDR[9]"     EUseSummary:SummaryColNoPVDR[9]    = {  FltToStr( Proj:ResultSummary[5]:DesignRatingNoPV,    1 )  }

;	"Set EUseSummary:SummaryColPVOnlyDR[1]"   EUseSummary:SummaryColPVOnlyDR[1]  = {  ""  }
	"Set EUseSummary:SummaryColPVOnlyDR[2]"   EUseSummary:SummaryColPVOnlyDR[2]  = {  "Flexibility"  }
	"Set EUseSummary:SummaryColPVOnlyDR[3]"   EUseSummary:SummaryColPVOnlyDR[3]  = {  "(EDR)"           }
   "Set EUseSummary:SummaryColPVOnlyDR[4]"   EUseSummary:SummaryColPVOnlyDR[4]  = {  FltToStr( Proj:ResultSummary[2]:DesignRatingStdPVOnly, 1 )  }
	"Set EUseSummary:SummaryColPVOnlyDR[6]"   EUseSummary:SummaryColPVOnlyDR[6]  = {  FltToStr( Proj:ResultSummary[2]:DesignRatingPVOnly,    1 )  }
	"Set EUseSummary:SummaryColPVOnlyDR[7]"   EUseSummary:SummaryColPVOnlyDR[7]  = {  FltToStr( Proj:ResultSummary[3]:DesignRatingPVOnly,    1 )  }
	"Set EUseSummary:SummaryColPVOnlyDR[8]"   EUseSummary:SummaryColPVOnlyDR[8]  = {  FltToStr( Proj:ResultSummary[4]:DesignRatingPVOnly,    1 )  }
	"Set EUseSummary:SummaryColPVOnlyDR[9]"   EUseSummary:SummaryColPVOnlyDR[9]  = {  FltToStr( Proj:ResultSummary[5]:DesignRatingPVOnly,    1 )  }

;	"Set EUseSummary:SummaryColFinDR[1]"      EUseSummary:SummaryColFinDR[1]     = {  ""  }
	"Set EUseSummary:SummaryColFinDR[2]"      EUseSummary:SummaryColFinDR[2]     = {  "Total"  }
	"Set EUseSummary:SummaryColFinDR[3]"      EUseSummary:SummaryColFinDR[3]     = {  "(EDR)"           }
   "Set EUseSummary:SummaryColFinDR[4]"      EUseSummary:SummaryColFinDR[4]     = {  FltToStr( Proj:ResultSummary[2]:DesignRatingStd, 1 )  }
	"Set EUseSummary:SummaryColFinDR[6]"      EUseSummary:SummaryColFinDR[6]     = {  FltToStr( Proj:ResultSummary[2]:DesignRating,    1 )  }
	"Set EUseSummary:SummaryColFinDR[7]"      EUseSummary:SummaryColFinDR[7]     = {  FltToStr( Proj:ResultSummary[3]:DesignRating,    1 )  }
	"Set EUseSummary:SummaryColFinDR[8]"      EUseSummary:SummaryColFinDR[8]     = {  FltToStr( Proj:ResultSummary[4]:DesignRating,    1 )  }
	"Set EUseSummary:SummaryColFinDR[9]"      EUseSummary:SummaryColFinDR[9]     = {  FltToStr( Proj:ResultSummary[5]:DesignRating,    1 )  }
END
;*************************************************************************

;*************************************************************************   - SAC 6/14/19
RULELIST "CARes_SummaryTab_2022_NESW" 1 0 1 1
;*************************************************************************
   "evaluate 2019 rulelist to populate most fields for 2022+"    Proj:Action  =     ; SAC 6/12/19
      {  EvalRulelist( "CARes_SummaryTab_2019_NESW" )  }

   ; SAC 6/12/19 - EDR1 unique to 2022
   "Set EUseSummary:EDR1Margin"     EUseSummary:EDR1Margin  =
      {  if (LocalStatus( EDR1DesignRatingStd ) < 1 .OR.
             LocalStatus( EDR1DesignRating    ) < 1) then  UNDEFINED
         else  (int( (EDR1DesignRatingStd * 10)+0.5 ) - int( (EDR1DesignRating * 10)+0.5 )) / 10
         endif  }

   "Set EUseSummary:PassFail"          EUseSummary:PassFail          = {
         if (IfValidAnd( Proj:ResultSummary[2]:MarginEfficEDR >= 0 ) .AND.
             IfValidAnd( Proj:ResultSummary[2]:MarginFinalEDR >= 0 ) .AND.
             IfValidAnd( Proj:ResultSummary[2]:EDR1Margin     >= 0 ) .AND.
             IfValidAnd( Proj:ResultSummary[3]:MarginEfficEDR >= 0 ) .AND.
             IfValidAnd( Proj:ResultSummary[3]:MarginFinalEDR >= 0 ) .AND.
             IfValidAnd( Proj:ResultSummary[3]:EDR1Margin     >= 0 ) .AND.
             IfValidAnd( Proj:ResultSummary[4]:MarginEfficEDR >= 0 ) .AND.
             IfValidAnd( Proj:ResultSummary[4]:MarginFinalEDR >= 0 ) .AND.
             IfValidAnd( Proj:ResultSummary[4]:EDR1Margin     >= 0 ) .AND.
             IfValidAnd( Proj:ResultSummary[5]:MarginEfficEDR >= 0 ) .AND.
             IfValidAnd( Proj:ResultSummary[5]:MarginFinalEDR >= 0 ) .AND.
             IfValidAnd( Proj:ResultSummary[5]:EDR1Margin     >= 0 ))
         then  "PASS"  else  "FAIL"  endif  }
   "Set EUseSummary:ComplyMessage"     EUseSummary:ComplyMessage     = {
         if (IfValidAnd( PassFail = "PASS" ))
         then "COMPLIES"  else  "DOES NOT COMPLY"  endif  }

; mods to 2019 labels
	"Set EUseSummary:SummaryColNPVMarg[3]"    EUseSummary:SummaryColNPVMarg[3]   = {  "(EDR2)"           }
	"Set EUseSummary:SummaryColFinMarg[3]"    EUseSummary:SummaryColFinMarg[3]   = {  "(EDR2)"           }
	"Set EUseSummary:SummaryColNoPVDR[3]"     EUseSummary:SummaryColNoPVDR[3]    = {  "(EDR2)"           }
	"Set EUseSummary:SummaryColPVOnlyDR[3]"   EUseSummary:SummaryColPVOnlyDR[3]  = {  "(EDR2)"           }
	"Set EUseSummary:SummaryColFinDR[3]"      EUseSummary:SummaryColFinDR[3]     = {  "(EDR2)"           }

; column data specific to 2022+
	"Set EUseSummary:SummaryColEDR1Marg[2]"   EUseSummary:SummaryColEDR1Marg[2]  = {  "Source"   }
	"Set EUseSummary:SummaryColEDR1Marg[3]"   EUseSummary:SummaryColEDR1Marg[3]  = {  "(EDR1)"           }
	"Set EUseSummary:SummaryColEDR1Marg[6]"   EUseSummary:SummaryColEDR1Marg[6]  = {  FltToStr( Proj:ResultSummary[2]:EDR1Margin, 1 )  }
	"Set EUseSummary:SummaryColEDR1Marg[7]"   EUseSummary:SummaryColEDR1Marg[7]  = {  FltToStr( Proj:ResultSummary[3]:EDR1Margin, 1 )  }
	"Set EUseSummary:SummaryColEDR1Marg[8]"   EUseSummary:SummaryColEDR1Marg[8]  = {  FltToStr( Proj:ResultSummary[4]:EDR1Margin, 1 )  }
	"Set EUseSummary:SummaryColEDR1Marg[9]"   EUseSummary:SummaryColEDR1Marg[9]  = {  FltToStr( Proj:ResultSummary[5]:EDR1Margin, 1 )  }

	"Set EUseSummary:SummaryColEDR1[2]"       EUseSummary:SummaryColEDR1[2]      = {  "Source"  }
	"Set EUseSummary:SummaryColEDR1[3]"       EUseSummary:SummaryColEDR1[3]      = {  "(EDR1)"           }
   "Set EUseSummary:SummaryColEDR1[4]"       EUseSummary:SummaryColEDR1[4]      = {  FltToStr( Proj:ResultSummary[2]:EDR1DesignRatingStd, 1 )  }
	"Set EUseSummary:SummaryColEDR1[6]"       EUseSummary:SummaryColEDR1[6]      = {  FltToStr( Proj:ResultSummary[2]:EDR1DesignRating,    1 )  }
	"Set EUseSummary:SummaryColEDR1[7]"       EUseSummary:SummaryColEDR1[7]      = {  FltToStr( Proj:ResultSummary[3]:EDR1DesignRating,    1 )  }
	"Set EUseSummary:SummaryColEDR1[8]"       EUseSummary:SummaryColEDR1[8]      = {  FltToStr( Proj:ResultSummary[4]:EDR1DesignRating,    1 )  }
	"Set EUseSummary:SummaryColEDR1[9]"       EUseSummary:SummaryColEDR1[9]      = {  FltToStr( Proj:ResultSummary[5]:EDR1DesignRating,    1 )  }

END
;*************************************************************************

;*************************************************************************   - SAC 11/22/22 (2025)
RULELIST "CARes_SummaryTab_2025_NESW" 1 0 1 1
;*************************************************************************
   "evaluate 2019 rulelist to populate most fields for 2022+"    Proj:Action  =     ; SAC 6/12/19
      {  EvalRulelist( "CARes_SummaryTab_2019_NESW" )  }

   ; SAC 6/12/19 - EDR1 unique to 2022
   "Set EUseSummary:EDR1Margin"     EUseSummary:EDR1Margin  =
      {  if (LocalStatus( EDR1DesignRatingStd ) < 1 .OR.
             LocalStatus( EDR1DesignRating    ) < 1) then  UNDEFINED
         else  (int( (EDR1DesignRatingStd * 10)+0.5 ) - int( (EDR1DesignRating * 10)+0.5 )) / 10
         endif  }

   "Set EUseSummary:PassFail"          EUseSummary:PassFail          =     ; added PeakCoolElec metric - SAC 08/08/23
      {  if (IfValidAnd( Proj:ResultSummary[2]:MetricPassFail[1]     = "Pass" ) .AND.
             IfValidAnd( Proj:ResultSummary[2]:MetricPassFail[2]     = "Pass" ) .AND.
             IfValidAnd( Proj:ResultSummary[2]:MetricPassFail[3]     = "Pass" ) .AND.
             IfValidAnd( Proj:ResultSummary[3]:MetricPassFail[1]     = "Pass" ) .AND.
             IfValidAnd( Proj:ResultSummary[3]:MetricPassFail[2]     = "Pass" ) .AND.
             IfValidAnd( Proj:ResultSummary[3]:MetricPassFail[3]     = "Pass" ) .AND.
             IfValidAnd( Proj:ResultSummary[4]:MetricPassFail[1]     = "Pass" ) .AND.
             IfValidAnd( Proj:ResultSummary[4]:MetricPassFail[2]     = "Pass" ) .AND.
             IfValidAnd( Proj:ResultSummary[4]:MetricPassFail[3]     = "Pass" ) .AND.
             IfValidAnd( Proj:ResultSummary[5]:MetricPassFail[1]     = "Pass" ) .AND.
             IfValidAnd( Proj:ResultSummary[5]:MetricPassFail[2]     = "Pass" ) .AND.
             IfValidAnd( Proj:ResultSummary[5]:MetricPassFail[3]     = "Pass" ) .AND.
            (IfValidAnd( Proj:ResultSummary[2]:PeakCoolElecLabels[4] = "Pass" ) .OR. IfValidAnd( Proj:ResultSummary[2]:PeakCoolElecLabels[4] = "n/a" )) .AND.
            (IfValidAnd( Proj:ResultSummary[3]:PeakCoolElecLabels[4] = "Pass" ) .OR. IfValidAnd( Proj:ResultSummary[3]:PeakCoolElecLabels[4] = "n/a" )) .AND.
            (IfValidAnd( Proj:ResultSummary[4]:PeakCoolElecLabels[4] = "Pass" ) .OR. IfValidAnd( Proj:ResultSummary[4]:PeakCoolElecLabels[4] = "n/a" )) .AND.
            (IfValidAnd( Proj:ResultSummary[5]:PeakCoolElecLabels[4] = "Pass" ) .OR. IfValidAnd( Proj:ResultSummary[5]:PeakCoolElecLabels[4] = "n/a" )))
         then  "PASS"  else  "FAIL"  endif  }
   "Set EUseSummary:ComplyMessage"     EUseSummary:ComplyMessage     = {
         if (IfValidAnd( PassFail = "PASS" ))
         then "COMPLIES"  else  "DOES NOT COMPLY"  endif  }

; mods to 2019 labels
;	"Set EUseSummary:SummaryColFinMarg[3]"    EUseSummary:SummaryColFinMarg[3]   = {  "(EDR2)"           }
;	"Set EUseSummary:SummaryColNoPVDR[3]"     EUseSummary:SummaryColNoPVDR[3]    = {  "(EDR2)"           }
;	"Set EUseSummary:SummaryColPVOnlyDR[3]"   EUseSummary:SummaryColPVOnlyDR[3]  = {  "(EDR2)"           }
;	"Set EUseSummary:SummaryColFinDR[3]"      EUseSummary:SummaryColFinDR[3]     = {  "(EDR2)"           }

; column data specific to 2025+
	"Set EUseSummary:SummaryColNPVMarg[2]"    EUseSummary:SummaryColNPVMarg[2]   = {  Format( "Eff. %s", Proj:CompMetricLbl_Short )   }    ; SAC 01/27/23
	"Set EUseSummary:SummaryColNPVMarg[3]"    EUseSummary:SummaryColNPVMarg[3]   = {  "($/ft)"           }  ; SAC 11/28/22
	"Set EUseSummary:SummaryColNPVMarg[6]"    EUseSummary:SummaryColNPVMarg[6]   = {  Proj:ResultSummary[2]:Enduse11[8]  }  ; FltToStr( Proj:ResultSummary[2]:MarginEfficEDR, 1 )  }   ; Proj:ResultSummary[2]:DesignRatingStdNoPV - Proj:ResultSummary[2]:DesignRatingNoPV, 1 )  }
	"Set EUseSummary:SummaryColNPVMarg[7]"    EUseSummary:SummaryColNPVMarg[7]   = {  Proj:ResultSummary[3]:Enduse11[8]  }  ; FltToStr( Proj:ResultSummary[3]:MarginEfficEDR, 1 )  }   ; Proj:ResultSummary[3]:DesignRatingStdNoPV - Proj:ResultSummary[3]:DesignRatingNoPV, 1 )  }
	"Set EUseSummary:SummaryColNPVMarg[8]"    EUseSummary:SummaryColNPVMarg[8]   = {  Proj:ResultSummary[4]:Enduse11[8]  }  ; FltToStr( Proj:ResultSummary[4]:MarginEfficEDR, 1 )  }   ; Proj:ResultSummary[4]:DesignRatingStdNoPV - Proj:ResultSummary[4]:DesignRatingNoPV, 1 )  }
	"Set EUseSummary:SummaryColNPVMarg[9]"    EUseSummary:SummaryColNPVMarg[9]   = {  Proj:ResultSummary[5]:Enduse11[8]  }  ; FltToStr( Proj:ResultSummary[5]:MarginEfficEDR, 1 )  }   ; Proj:ResultSummary[5]:DesignRatingStdNoPV - Proj:ResultSummary[5]:DesignRatingNoPV, 1 )  }

	"Set EUseSummary:SummaryColEDR1Marg[2]"   EUseSummary:SummaryColEDR1Marg[2]  = {  "Source"   }
	"Set EUseSummary:SummaryColEDR1Marg[3]"   EUseSummary:SummaryColEDR1Marg[3]  = {  "(kBtu/ft-yr)"           }
	"Set EUseSummary:SummaryColEDR1Marg[6]"   EUseSummary:SummaryColEDR1Marg[6]  = {  Proj:ResultSummary[2]:Enduse10[33]  }  ; FltToStr( Proj:ResultSummary[2]:EDR1Margin, 1 )  }
	"Set EUseSummary:SummaryColEDR1Marg[7]"   EUseSummary:SummaryColEDR1Marg[7]  = {  Proj:ResultSummary[3]:Enduse10[33]  }  ; FltToStr( Proj:ResultSummary[3]:EDR1Margin, 1 )  }
	"Set EUseSummary:SummaryColEDR1Marg[8]"   EUseSummary:SummaryColEDR1Marg[8]  = {  Proj:ResultSummary[4]:Enduse10[33]  }  ; FltToStr( Proj:ResultSummary[4]:EDR1Margin, 1 )  }
	"Set EUseSummary:SummaryColEDR1Marg[9]"   EUseSummary:SummaryColEDR1Marg[9]  = {  Proj:ResultSummary[5]:Enduse10[33]  }  ; FltToStr( Proj:ResultSummary[5]:EDR1Margin, 1 )  }

	"Set EUseSummary:SummaryColEDR1[2]"       EUseSummary:SummaryColEDR1[2]      = {  "Source"  }
	"Set EUseSummary:SummaryColEDR1[3]"       EUseSummary:SummaryColEDR1[3]      = {  "(kBtu/ft-yr)"           }
;   "Set EUseSummary:SummaryColEDR1[4]"       EUseSummary:SummaryColEDR1[4]      = {  FltToStr( Proj:ResultSummary[2]:EDR1DesignRatingStd, 1 )  }
	"Set EUseSummary:SummaryColEDR1[6]"       EUseSummary:SummaryColEDR1[6]      = {  Proj:ResultSummary[2]:Enduse10[31]  }  ; FltToStr( Proj:ResultSummary[2]:EDR1DesignRating,    1 )  }
	"Set EUseSummary:SummaryColEDR1[7]"       EUseSummary:SummaryColEDR1[7]      = {  Proj:ResultSummary[3]:Enduse10[31]  }  ; FltToStr( Proj:ResultSummary[3]:EDR1DesignRating,    1 )  }
	"Set EUseSummary:SummaryColEDR1[8]"       EUseSummary:SummaryColEDR1[8]      = {  Proj:ResultSummary[4]:Enduse10[31]  }  ; FltToStr( Proj:ResultSummary[4]:EDR1DesignRating,    1 )  }
	"Set EUseSummary:SummaryColEDR1[9]"       EUseSummary:SummaryColEDR1[9]      = {  Proj:ResultSummary[5]:Enduse10[31]  }  ; FltToStr( Proj:ResultSummary[5]:EDR1DesignRating,    1 )  }

	"Set EUseSummary:SummaryColCmpSLCCMarg[2]"   EUseSummary:SummaryColCmpSLCCMarg[2]  = {  Format( "Comp. %s", Proj:CompMetricLbl_Short )   }
	"Set EUseSummary:SummaryColCmpSLCCMarg[3]"   EUseSummary:SummaryColCmpSLCCMarg[3]  = {  "($/ft)"           }
	"Set EUseSummary:SummaryColCmpSLCCMarg[6]"   EUseSummary:SummaryColCmpSLCCMarg[6]  = {  Proj:ResultSummary[2]:Enduse10[8]  } 
	"Set EUseSummary:SummaryColCmpSLCCMarg[7]"   EUseSummary:SummaryColCmpSLCCMarg[7]  = {  Proj:ResultSummary[3]:Enduse10[8]  } 
	"Set EUseSummary:SummaryColCmpSLCCMarg[8]"   EUseSummary:SummaryColCmpSLCCMarg[8]  = {  Proj:ResultSummary[4]:Enduse10[8]  } 
	"Set EUseSummary:SummaryColCmpSLCCMarg[9]"   EUseSummary:SummaryColCmpSLCCMarg[9]  = {  Proj:ResultSummary[5]:Enduse10[8]  } 

	"Set EUseSummary:SummaryColCmpSLCC[2]"       EUseSummary:SummaryColCmpSLCC[2]      = {  Format( "Comp. %s", Proj:CompMetricLbl_Short )  }
	"Set EUseSummary:SummaryColCmpSLCC[3]"       EUseSummary:SummaryColCmpSLCC[3]      = {  "($/ft)"           }
	"Set EUseSummary:SummaryColCmpSLCC[6]"       EUseSummary:SummaryColCmpSLCC[6]      = {  Proj:ResultSummary[2]:Enduse10[4]  } 
	"Set EUseSummary:SummaryColCmpSLCC[7]"       EUseSummary:SummaryColCmpSLCC[7]      = {  Proj:ResultSummary[3]:Enduse10[4]  } 
	"Set EUseSummary:SummaryColCmpSLCC[8]"       EUseSummary:SummaryColCmpSLCC[8]      = {  Proj:ResultSummary[4]:Enduse10[4]  } 
	"Set EUseSummary:SummaryColCmpSLCC[9]"       EUseSummary:SummaryColCmpSLCC[9]      = {  Proj:ResultSummary[5]:Enduse10[4]  } 

END
;*************************************************************************

;*************************************************************************   Store combined PV+Battery results to special EUseSummary array for display in 2025+ UI - SAC 06/07/23
RULELIST  "EUseSummary_CombinePVBatteryResults" 1 0 1 1
   ; setup Proj:EUseSmryDecPrec[*] w/ EndusePVB decimal precision settings
   "Set EUseSmryDecPrec[*] to 2"      for:#ARR=(2to38)   Proj:EUseSmryDecPrec[#ARR]  = { 2 }
   "Set EUseSmryDecPrec[23-30] to 0"  for:#ARR=(23to30)  Proj:EUseSmryDecPrec[#ARR]  = { 0 }
   "Set EUseSmryDecPrec[2] to 0"  Proj:EUseSmryDecPrec[2]  = { 0 }   "Set EUseSmryDecPrec[5] to 0"  Proj:EUseSmryDecPrec[5]  = { 0 }
   "Set EUseSmryDecPrec[12] to 0" Proj:EUseSmryDecPrec[12] = { 0 }   "Set EUseSmryDecPrec[17] to 0" Proj:EUseSmryDecPrec[17] = { 0 }
   "Set EUseSmryDecPrec[3] to 1"  Proj:EUseSmryDecPrec[3]  = { 1 }   "Set EUseSmryDecPrec[6] to 1"  Proj:EUseSmryDecPrec[6]  = { 1 }
   "Set EUseSmryDecPrec[13] to 1" Proj:EUseSmryDecPrec[13] = { 1 }   "Set EUseSmryDecPrec[18] to 1" Proj:EUseSmryDecPrec[18] = { 1 }

   "Set EUseSummary:EndusePVB[1]"      EUseSummary:EndusePVB[1]   = {  "PV & Battery"  }
   "Set EUseSummary:EndusePVB[2-38]"   for:#ARR=(2to38)     EUseSummary:EndusePVB[#ARR]   =
      {  if ( (LocalStatus( Enduse13[#ARR] ) < 1 .OR. IfValidAnd( Enduse13[#ARR] = " " )) .AND.
              (LocalStatus( Enduse14[#ARR] ) < 1 .OR. IfValidAnd( Enduse14[#ARR] = " " )) ) then  UNDEFINED
         else if (LocalStatus( Enduse14[#ARR] ) < 1 .OR. IfValidAnd( Enduse14[#ARR] = " " ))
         then  FltToStr(  StrToFlt( Enduse13[#ARR] ), Proj:EUseSmryDecPrec[#ARR] )
         else if (LocalStatus( Enduse13[#ARR] ) < 1 .OR. IfValidAnd( Enduse13[#ARR] = " " ))
         then  FltToStr(  StrToFlt( Enduse14[#ARR] ), Proj:EUseSmryDecPrec[#ARR] )
         else  FltToStr( (StrToFlt( Enduse13[#ARR] ) + StrToFlt( Enduse14[#ARR] )), Proj:EUseSmryDecPrec[#ARR] )
         endif endif endif  }

   ; blast all Proj:EUseSmryDecPrec[*] settings
   "Blast EUseSmryDecPrec[*]"      for:#ARR=(2to38)   Proj:EUseSmryDecPrec[#ARR]  = { UNDEFINED }
END
;*************************************************************************

;*************************************************************************   - SAC 6/23/20 (tic #1210)
RULELIST  "ProcessResults_DHWSolarSys_OG300SSF" 1 0 1 1
   "Set Proj:MaxPropDHWSolarSysRef"    Proj:MaxPropDHWSolarSysRef  = {  MaxAllComp( DHWSolarSys:FloorAreaServed )  }
   "Set Proj:ResultSummary[1]:PropDHW_SSF[1] if largest DHWSolarSys an OG-300 system"     Proj:ResultSummary[1]:PropDHW_SSF[1] =
      {  if (IfValidAnd( MaxPropDHWSolarSysRef:ErrID > 0 )==0 .AND.
             IfValidAnd( MaxPropDHWSolarSysRef:RatingProgram = 3 ) .AND.
             IfValidAnd( MaxPropDHWSolarSysRef:RatedSSF > 0 ))
         then  MaxPropDHWSolarSysRef:RatedSSF
         else  UNCHANGED  endif  }
END
;*************************************************************************
RULELIST  "ProcessResults_DHWSolarSys_OG300SSF_N" 1 0 1 1
   "Set Proj:MaxPropDHWSolarSysRef"    Proj:MaxPropDHWSolarSysRef  = {  MaxAllComp( DHWSolarSys:FloorAreaServed )  }
   "Set Proj:ResultSummary[2]:PropDHW_SSF[1] if largest DHWSolarSys an OG-300 system"     Proj:ResultSummary[2]:PropDHW_SSF[1] =
      {  if (IfValidAnd( MaxPropDHWSolarSysRef:ErrID > 0 )==0 .AND.
             IfValidAnd( MaxPropDHWSolarSysRef:RatingProgram = 3 ) .AND.
             IfValidAnd( MaxPropDHWSolarSysRef:RatedSSF > 0 ))
         then  MaxPropDHWSolarSysRef:RatedSSF
         else  UNCHANGED  endif  }
END
;*************************************************************************
RULELIST  "ProcessResults_DHWSolarSys_OG300SSF_E" 1 0 1 1
   "Set Proj:MaxPropDHWSolarSysRef"    Proj:MaxPropDHWSolarSysRef  = {  MaxAllComp( DHWSolarSys:FloorAreaServed )  }
   "Set Proj:ResultSummary[3]:PropDHW_SSF[1] if largest DHWSolarSys an OG-300 system"     Proj:ResultSummary[3]:PropDHW_SSF[1] =
      {  if (IfValidAnd( MaxPropDHWSolarSysRef:ErrID > 0 )==0 .AND.
             IfValidAnd( MaxPropDHWSolarSysRef:RatingProgram = 3 ) .AND.
             IfValidAnd( MaxPropDHWSolarSysRef:RatedSSF > 0 ))
         then  MaxPropDHWSolarSysRef:RatedSSF
         else  UNCHANGED  endif  }
END
;*************************************************************************
RULELIST  "ProcessResults_DHWSolarSys_OG300SSF_S" 1 0 1 1
   "Set Proj:MaxPropDHWSolarSysRef"    Proj:MaxPropDHWSolarSysRef  = {  MaxAllComp( DHWSolarSys:FloorAreaServed )  }
   "Set Proj:ResultSummary[4]:PropDHW_SSF[1] if largest DHWSolarSys an OG-300 system"     Proj:ResultSummary[4]:PropDHW_SSF[1] =
      {  if (IfValidAnd( MaxPropDHWSolarSysRef:ErrID > 0 )==0 .AND.
             IfValidAnd( MaxPropDHWSolarSysRef:RatingProgram = 3 ) .AND.
             IfValidAnd( MaxPropDHWSolarSysRef:RatedSSF > 0 ))
         then  MaxPropDHWSolarSysRef:RatedSSF
         else  UNCHANGED  endif  }
END
;*************************************************************************
RULELIST  "ProcessResults_DHWSolarSys_OG300SSF_W" 1 0 1 1
   "Set Proj:MaxPropDHWSolarSysRef"    Proj:MaxPropDHWSolarSysRef  = {  MaxAllComp( DHWSolarSys:FloorAreaServed )  }
   "Set Proj:ResultSummary[5]:PropDHW_SSF[1] if largest DHWSolarSys an OG-300 system"     Proj:ResultSummary[5]:PropDHW_SSF[1] =
      {  if (IfValidAnd( MaxPropDHWSolarSysRef:ErrID > 0 )==0 .AND.
             IfValidAnd( MaxPropDHWSolarSysRef:RatingProgram = 3 ) .AND.
             IfValidAnd( MaxPropDHWSolarSysRef:RatedSSF > 0 ))
         then  MaxPropDHWSolarSysRef:RatedSSF
         else  UNCHANGED  endif  }
END
;*************************************************************************


;*************************************************************************   - SAC 6/22/20 (tic #1208)
RULELIST "CARes_ReportDHWSSF" 1 0 1 1
   "Set Proj:ResultSummary[1]:DHW_SSF_Summary[1]"     Proj:ResultSummary[1]:DHW_SSF_Summary[1] = {  "DHW SSF:"  }
   "Set Proj:ResultSummary[1]:DHW_SSF_Summary[2]"     Proj:ResultSummary[1]:DHW_SSF_Summary[2] =
      {  if (IfValidAnd( ResultSummary[1]:PropDHW_SSF[1] > 0 ))
         then  Format( "%.2f Prop", ResultSummary[1]:PropDHW_SSF[1] )
         else if (IfValidAnd( ResultSummary[1]:StdDHW_SSF > 0 ))
         then  Format( "%.2f Std", ResultSummary[1]:StdDHW_SSF )
         else  UNDEFINED  endif endif  }
   "Set Proj:ResultSummary[1]:DHW_SSF_Summary[3]"     Proj:ResultSummary[1]:DHW_SSF_Summary[3] =
      {  if (IfValidAnd( ResultSummary[1]:PropDHW_SSF[1] > 0 ) .AND.
             IfValidAnd( ResultSummary[1]:StdDHW_SSF > 0 ))
         then  Format( "%.2f Std", ResultSummary[1]:StdDHW_SSF )
         else  UNDEFINED  endif  }
END
;*************************************************************************   - SAC 6/22/20 (tic #1208)
RULELIST "CARes_ReportDHWSSF_NESW" 1 0 1 1
   "evaluate non-orientation rulelist to setup initial strings"    Proj:Action  =
      {  EvalRulelist( "CARes_ReportDHWSSF" )  }
                                                              
   "Set Proj:ResultSummary[2]:DHW_SSF_Summary[1]"     Proj:ResultSummary[2]:DHW_SSF_Summary[1] = {  ResultSummary[1]:DHW_SSF_Summary[1]  }
   "Set Proj:ResultSummary[2]:DHW_SSF_Summary[2]"     Proj:ResultSummary[2]:DHW_SSF_Summary[2] = {  ResultSummary[1]:DHW_SSF_Summary[2]  }
   "Set Proj:ResultSummary[2]:DHW_SSF_Summary[3]"     Proj:ResultSummary[2]:DHW_SSF_Summary[3] = {  ResultSummary[1]:DHW_SSF_Summary[3]  }

   "Set Proj:ResultSummary[3]:DHW_SSF_Summary[1]"     Proj:ResultSummary[3]:DHW_SSF_Summary[1] = {  ResultSummary[1]:DHW_SSF_Summary[1]  }
   "Set Proj:ResultSummary[3]:DHW_SSF_Summary[2]"     Proj:ResultSummary[3]:DHW_SSF_Summary[2] = {  ResultSummary[1]:DHW_SSF_Summary[2]  }
   "Set Proj:ResultSummary[3]:DHW_SSF_Summary[3]"     Proj:ResultSummary[3]:DHW_SSF_Summary[3] = {  ResultSummary[1]:DHW_SSF_Summary[3]  }

   "Set Proj:ResultSummary[4]:DHW_SSF_Summary[1]"     Proj:ResultSummary[4]:DHW_SSF_Summary[1] = {  ResultSummary[1]:DHW_SSF_Summary[1]  }
   "Set Proj:ResultSummary[4]:DHW_SSF_Summary[2]"     Proj:ResultSummary[4]:DHW_SSF_Summary[2] = {  ResultSummary[1]:DHW_SSF_Summary[2]  }
   "Set Proj:ResultSummary[4]:DHW_SSF_Summary[3]"     Proj:ResultSummary[4]:DHW_SSF_Summary[3] = {  ResultSummary[1]:DHW_SSF_Summary[3]  }

   "Set Proj:ResultSummary[5]:DHW_SSF_Summary[1]"     Proj:ResultSummary[5]:DHW_SSF_Summary[1] = {  ResultSummary[1]:DHW_SSF_Summary[1]  }
   "Set Proj:ResultSummary[5]:DHW_SSF_Summary[2]"     Proj:ResultSummary[5]:DHW_SSF_Summary[2] = {  ResultSummary[1]:DHW_SSF_Summary[2]  }
   "Set Proj:ResultSummary[5]:DHW_SSF_Summary[3]"     Proj:ResultSummary[5]:DHW_SSF_Summary[3] = {  ResultSummary[1]:DHW_SSF_Summary[3]  }
END
;*************************************************************************


;*************************************************************************
;*************************************************************************
;88888
RULELIST  "FinalCompliance" 1 0 0 1
;
;   Rules which make the final determination of whether the building passes
;   the compliance test or not.
;
;*************************************************************************
;*************************************************************************

   ;--------------------------------------------------------------------
   ; ... Rules
   ;--------------------------------------------------------------------

END
;*************************************************************************


;*************************************************************************
RULELIST "CheckFileHash"   1 0 0 0
;*************************************************************************

	"Set Proj:FileHashStatus - check #1"	Proj:FileHashStatus	= {
							if (LocalStatus( FileHashToCheck ) < 1 .OR. LocalStatus( FileHashID ) < 1) then  1
							else if (strlen( FileHashToCheck ) < 64) then  2
							else if (CAResFileHashes:HaveHash1( "HashID", FileHashID ) > 0.5)
							then	if (FileHashToCheck == CAResFileHashes:Hash1( "HashID", FileHashID )) then  0  else  3  endif
							else  0  endif endif endif  }
	"Set Proj:FileHashStatus - check #2"	Proj:FileHashStatus	= {
							if (FileHashStatus == 3 .AND. CAResFileHashes:HaveHash2( "HashID", FileHashID ) > 0.5)
							then  if (FileHashToCheck == CAResFileHashes:Hash2( "HashID", FileHashID )) then  0  else  4  endif
							else  UNCHANGED  endif  }
END

;*************************************************************************
RULELIST "SetReportKeys"   1 0 0 0
;*************************************************************************
; Res - Open Source - 9/8/13  - SAC 1/13/17 - new security updates
   "Set Proj:RptPrvKey[1]"    Proj:RptPrvKey[1]  = {   if (CAResKeys:NumRecs( "KeyType", "Prv" ) >=  1) then  CAResKeys:KeyText( "KeyIndex", SecurityKeyIdx, "KeyType", "Prv", "KeyRec",  1 )  else  UNDEFINED  endif  }
   "Set Proj:RptPrvKey[2]"    Proj:RptPrvKey[2]  = {   if (CAResKeys:NumRecs( "KeyType", "Prv" ) >=  2) then  CAResKeys:KeyText( "KeyIndex", SecurityKeyIdx, "KeyType", "Prv", "KeyRec",  2 )  else  UNDEFINED  endif  }
   "Set Proj:RptPrvKey[3]"    Proj:RptPrvKey[3]  = {   if (CAResKeys:NumRecs( "KeyType", "Prv" ) >=  3) then  CAResKeys:KeyText( "KeyIndex", SecurityKeyIdx, "KeyType", "Prv", "KeyRec",  3 )  else  UNDEFINED  endif  }
   "Set Proj:RptPrvKey[4]"    Proj:RptPrvKey[4]  = {   if (CAResKeys:NumRecs( "KeyType", "Prv" ) >=  4) then  CAResKeys:KeyText( "KeyIndex", SecurityKeyIdx, "KeyType", "Prv", "KeyRec",  4 )  else  UNDEFINED  endif  }
   "Set Proj:RptPrvKey[5]"    Proj:RptPrvKey[5]  = {   if (CAResKeys:NumRecs( "KeyType", "Prv" ) >=  5) then  CAResKeys:KeyText( "KeyIndex", SecurityKeyIdx, "KeyType", "Prv", "KeyRec",  5 )  else  UNDEFINED  endif  }
   "Set Proj:RptPrvKey[6]"    Proj:RptPrvKey[6]  = {   if (CAResKeys:NumRecs( "KeyType", "Prv" ) >=  6) then  CAResKeys:KeyText( "KeyIndex", SecurityKeyIdx, "KeyType", "Prv", "KeyRec",  6 )  else  UNDEFINED  endif  }
   "Set Proj:RptPrvKey[7]"    Proj:RptPrvKey[7]  = {   if (CAResKeys:NumRecs( "KeyType", "Prv" ) >=  7) then  CAResKeys:KeyText( "KeyIndex", SecurityKeyIdx, "KeyType", "Prv", "KeyRec",  7 )  else  UNDEFINED  endif  }
   "Set Proj:RptPrvKey[8]"    Proj:RptPrvKey[8]  = {   if (CAResKeys:NumRecs( "KeyType", "Prv" ) >=  8) then  CAResKeys:KeyText( "KeyIndex", SecurityKeyIdx, "KeyType", "Prv", "KeyRec",  8 )  else  UNDEFINED  endif  }
   "Set Proj:RptPrvKey[9]"    Proj:RptPrvKey[9]  = {   if (CAResKeys:NumRecs( "KeyType", "Prv" ) >=  9) then  CAResKeys:KeyText( "KeyIndex", SecurityKeyIdx, "KeyType", "Prv", "KeyRec",  9 )  else  UNDEFINED  endif  }

   "Set Proj:RptPubKey[1]"    Proj:RptPubKey[1]  = {   if (CAResKeys:NumRecs( "KeyType", "Pub" ) >=  1) then  CAResKeys:KeyText( "KeyIndex", SecurityKeyIdx, "KeyType", "Pub", "KeyRec",  1 )  else  UNDEFINED  endif  }
   "Set Proj:RptPubKey[2]"    Proj:RptPubKey[2]  = {   if (CAResKeys:NumRecs( "KeyType", "Pub" ) >=  2) then  CAResKeys:KeyText( "KeyIndex", SecurityKeyIdx, "KeyType", "Pub", "KeyRec",  2 )  else  UNDEFINED  endif  }
   "Set Proj:RptPubKey[3]"    Proj:RptPubKey[3]  = {   if (CAResKeys:NumRecs( "KeyType", "Pub" ) >=  3) then  CAResKeys:KeyText( "KeyIndex", SecurityKeyIdx, "KeyType", "Pub", "KeyRec",  3 )  else  UNDEFINED  endif  }
   "Set Proj:RptPubKey[4]"    Proj:RptPubKey[4]  = {   if (CAResKeys:NumRecs( "KeyType", "Pub" ) >=  4) then  CAResKeys:KeyText( "KeyIndex", SecurityKeyIdx, "KeyType", "Pub", "KeyRec",  4 )  else  UNDEFINED  endif  }
END
;*************************************************************************


;*************************************************************************
;*************************************************************************

ENDFILE
