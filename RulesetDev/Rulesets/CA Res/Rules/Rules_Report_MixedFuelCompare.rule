// Rules related to reporting of model inputs and results for Res Mixed Fuel Comparison (MxdFuelCmpr) tool - SAC 06/24/22
//
// -------------------------------------------------------------------------
//  Copyright (c) 2022, SAC Software Solutions, LLC
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are
//  met:
// 
//    * Redistributions of source code must retain the above copyright
//  notice, this list of conditions and the following disclaimer.
//    * Redistributions in binary form must reproduce the above copyright
//  notice, this list of conditions and the following disclaimer in
//  the documentation and/or other materials provided with the
//  distribution.
//    * Neither the name of the California Energy Commission nor the names of its
//  contributors may be used to endorse or promote products
//  derived from this software without specific prior written
//  permission.
//
//  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
//  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
//  TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
//  PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL CALIFORNIA ENERGY COMMISSION
//  BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
//  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
//  SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
//  BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
//  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
//  OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
//  ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
// -------------------------------------------------------------------------


;************************************************************************* SAC 06/27/22
RULELIST "MxdFuelCmprReport_Main" 1 0 0 0
; Purpose: to write building model REsults to CSV file and merge in Inputs portion

;   "write BEMBase details to export"  Proj:Action = {  StoreBEMProc( "b4-mxdfuelcmprrpt-main", 0 )  }

   "Open MxdFuelCmprRpt CSV file"      Proj:MxdFuelCmprRptFileIdx =
      {  OpenExportFile( ModelPath + ModelFile + " - MxdFuelCmpr.csv", "wt" )  }

   "Write MxdFuelCmprRpt CSV Header-1"    Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, "10,1,Row/Col model details data begin\n" )  }
   "Write MxdFuelCmprRpt CSV Header-2"    Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, "Model Details and Results Report\n" )  }
   "Write MxdFuelCmprRpt CSV Header-3"    Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, ",Ruleset:,%c%s%c\n", 34, ValidOr( CompMgrVersion,   "" ), 34 )  }
   "Write MxdFuelCmprRpt CSV Header-4"    Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, ",CSE:,%c%s%c\n",     34, ValidOr( PrimSimEngingVer, "" ), 34 )  }
   "Write MxdFuelCmprRpt CSV Header-5"    Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, "Run Title:,,%c%s%c\n", 34, ValidOr( RunTitle, "" ), 34 )  }
   "Write MxdFuelCmprRpt CSV Header-6"    Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, "Run Date/Time:,,%s\n", ValidOr( RunDateISO, "" ) )  }
   "Write MxdFuelCmprRpt CSV Header-7"    Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, "Model File:,,%c%s%s%c\n\n\n", 34, ValidOr( ModelPathFwd, "" ), ValidOr( ProjFileName, "" ), 34 )  }

   "Write MxdFuelCmprRpt CSV Bldg - Builder"          Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, "Building,Builder,%c%s%c,,Proj:Owner\n", 34, ValidOr( Owner, "" ), 34 )  }
   "Write MxdFuelCmprRpt CSV Bldg - Orientation"      Proj:Action  =
      {  if (IfValidAnd( AllOrientations > 0 ))
         then  WriteToExportFile( MxdFuelCmprRptFileIdx, ",Orientation,AllOrientations,,Proj:AllOrientations\n" )
         else  WriteToExportFile( MxdFuelCmprRptFileIdx, ",Orientation,%g,,Proj:FrontOrientation\n", ValidOr( FrontOrientation, 0 ) )  endif  }

   "Write MxdFuelCmprRpt CSV Bldg - Climate Zone"           Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, ",Climate Zone,%c%s%c,,Proj:ClimateZone\n", 34, EnumString( ClimateZone ), 34 )  }
   "Write MxdFuelCmprRpt CSV Bldg - Building Type"          Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, ",Building Type,%s,,Proj:IsMultiFamily\n", ValidOr( BldgTypeTblStr, "" ) )  }
   "Write MxdFuelCmprRpt CSV Bldg - Fuel Choice"            Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, ",Fuel Choice,%s,,Proj:GasType\n", EnumString( GasType ) )  }
   "Write MxdFuelCmprRpt CSV Bldg - Modeling Software Ver"  Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, ",Modeling Software Version,%c%s%c,,Proj:SoftwareVersionDetail\n", 34, ValidOr( SoftwareVersionDetail, "" ), 34 )  }
   "Write MxdFuelCmprRpt CSV Bldg - Model Run Date"         Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, ",Model Run Date,%s,,Proj:RunDateISO\n", ValidOr( RunDateISO, "" ) )  }
   ;"Write MxdFuelCmprRpt CSV Bldg - Standards Version"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, ",Standards Version,%s,,Proj:StandardsVersion\n", EnumString( StandardsVersion ) )  }
   "Write MxdFuelCmprRpt CSV Bldg - Standards Version"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, ",Standards Version,%s,,Proj:StandardsVersion\n", ValidOr( StandardsVerSave, "" ) )  }
   "Write MxdFuelCmprRpt CSV Bldg - HERS Registry"          Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, ",HERS Registry,,,\n" )  }
   "Write MxdFuelCmprRpt CSV Bldg - HERS Registry Job ID"   Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, ",HERS Registry Job ID,,,\n" )  }
   "Write MxdFuelCmprRpt CSV Bldg - Conditioned Floor Area" Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, ",Conditioned Floor Area,%g,,Proj:CondFloorArea\n", ValidOr( CondFloorArea, 0 ) )  }
   "Write MxdFuelCmprRpt CSV Bldg - # of Bedrooms"          Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, ",Number of Bedrooms,%g,,Proj:NumBedrooms\n", ValidOr( NumBedrooms, 0 ) )  }
   "Write MxdFuelCmprRpt CSV Bldg - # of Dwelling Units"    Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, ",Number of Dwelling Units,%g,,Proj:NumDwellingUnits\n", ValidOr( NumDwellingUnits, 0 ) )  }
   "Write MxdFuelCmprRpt CSV Bldg - # of Stories"           Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, ",Number of Stories,%g,,Proj:NumStories\n", ValidOr( NumStories, 1 ) )  }
   "Write MxdFuelCmprRpt CSV Bldg - # of Zones"             Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, ",Number of Zones,%g,,\n", ComponentCount( Zone ) + ComponentCount( Zone ) )  }
   "Write MxdFuelCmprRpt CSV Bldg - Has Garage"             Proj:Action  =
      {  if (IfValidAnd( HasGarage > 0 ))
         then  WriteToExportFile( MxdFuelCmprRptFileIdx, ",Has Garage,Yes,,Proj:HasGarage\n" )
         else  WriteToExportFile( MxdFuelCmprRptFileIdx, ",Has Garage,No,,Proj:HasGarage\n" )  endif  }
   "Write MxdFuelCmprRpt CSV Bldg - Is Natural Gas Avail"   Proj:Action  =
      {  if (IfValidAnd( NatGasAvailable > 0 ))
         then  WriteToExportFile( MxdFuelCmprRptFileIdx, ",Is Natural Gas Available,Yes,,Proj:NatGasAvailable\n" )
         else  WriteToExportFile( MxdFuelCmprRptFileIdx, ",Is Natural Gas Available,No,,Proj:NatGasAvailable\n" )  endif  }

   "Write MxdFuelCmprRpt CSV Bldg - Final EDR"              Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, "Compliance and Incentives,Final EDR,%g,,Proj:ResultSummary[1]:DesignRating\n",  ValidOr( ResultSummary[1]:DesignRating, 0 ) )  }
   "Write MxdFuelCmprRpt CSV Bldg - Efficiency EDR "        Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, ",Efficiency EDR,%g,,Proj:ResultSummary[1]:DesignRatingNoPV\n",             ValidOr( ResultSummary[1]:DesignRatingNoPV, 0 ) )  }
   "Write MxdFuelCmprRpt CSV Bldg - Standard Final EDR"     Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, ",Standard Final EDR,%g,,Proj:ResultSummary[1]:DesignRatingStd\n",          ValidOr( ResultSummary[1]:DesignRatingStd, 0 ) )  }
   "Write MxdFuelCmprRpt CSV Bldg - Standard Effic. EDR"    Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, ",Standard Efficiency EDR,%g,,Proj:ResultSummary[1]:DesignRatingStdNoPV\n", ValidOr( ResultSummary[1]:DesignRatingStdNoPV, 0 ) )  }
   "Write MxdFuelCmprRpt CSV Bldg - Delta EDR Final"        Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, ",Delta EDR Final,%g,,Proj:ResultSummary[1]:MarginFinalEDR\n",              ValidOr( ResultSummary[1]:MarginFinalEDR, 0 ) )  }
   "Write MxdFuelCmprRpt CSV Bldg - Percent Above Code"     Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, ",Percent Above Code,%g,,Proj:ResultSummary[1]:PctSavingsCmpTDV\n",         ValidOr( ResultSummary[1]:PctSavingsCmpTDV, 0 ) )  }
   "Write MxdFuelCmprRpt CSV Bldg - Base Incentive"         Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, ",Base Incentive,,,Proj:?\n" )  }
   "Write MxdFuelCmprRpt CSV Bldg - Incremental Incentive"  Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, ",Incremental Incentive,,,Proj:?\n" )  }
   "Write MxdFuelCmprRpt CSV Bldg - Total Incentive"        Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, ",Total Incentive,,,Proj:?\n" )  }

   "Write MxdFuelCmprRpt CSV Bldg - kWh plan margin"        Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, "Energy Savings,kWh plan margin,,,Proj:?\n" )  }
   "Write MxdFuelCmprRpt CSV Bldg - kW plan margin"         Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, ",kW plan margin,,,Proj:?\n" )  }
   "Write MxdFuelCmprRpt CSV Bldg - therms plan margin"     Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, ",therms plan margin,,,Proj:?\n" )  }
   "Write MxdFuelCmprRpt CSV Bldg - CO2 plan margin"        Proj:Action  = {  WriteToExportFile( MxdFuelCmprRptFileIdx, ",CO2 plan margin,,,Proj:?\n" )  }

   ; concatenate Inputs CSV onto report file @ this point - SAC 06/28/22
   "Insert MxdFuelCmpr Input CSV into Report file here"     Proj:Action  = {  ExportFileConcat( MxdFuelCmprRptFileIdx, ProcessingPath + ModelFile + " - MxdFuelCmpr-Inputs.csv" )  }
   ;"Insert MxdFuelCmpr Input CSV into Report file here"     Proj:Action  = {  ExportFileConcat( MxdFuelCmprRptFileIdx, "%s%s - MxdFuelCmpr-Inputs.csv", ProcessingPath, ModelFile )  }

   ; continue writing results data to bottom of report export CSV - SAC 06/29/22
   "Export Enduse Results - Total"           Proj:Action = {  EvalRulelist( "MxdFuelCmprReport_Results_Total" , 1 )  }
   "Export Enduse Results - SpcHtg"          Proj:Action = {  EvalRulelist( "MxdFuelCmprReport_Results_SpcHtg", 1 )  }
   "Export Enduse Results - SpcClg"          Proj:Action = {  EvalRulelist( "MxdFuelCmprReport_Results_SpcClg", 1 )  }
   "Export Enduse Results - IAQ"             Proj:Action = {  EvalRulelist( "MxdFuelCmprReport_Results_IAQ"   , 1 )  }
   "Export Enduse Results - WtrHtg"          Proj:Action = {  EvalRulelist( "MxdFuelCmprReport_Results_WtrHtg", 1 )  }
   "Export Enduse Results - IntLtg"          Proj:Action = {  EvalRulelist( "MxdFuelCmprReport_Results_IntLtg", 1 )  }
   "Export Enduse Results - Appl"            Proj:Action = {  EvalRulelist( "MxdFuelCmprReport_Results_Appl"  , 1 )  }
   "Export Enduse Results - Plugs"           Proj:Action = {  EvalRulelist( "MxdFuelCmprReport_Results_Plugs" , 1 )  }
   "Export Enduse Results - ExtLtg"          Proj:Action = {  EvalRulelist( "MxdFuelCmprReport_Results_ExtLtg", 1 )  }
   "Export Enduse Results - PVBatt"          Proj:Action = {  EvalRulelist( "MxdFuelCmprReport_Results_PVBatt", 1 )  }
   "Export Enduse Results - CO2 Exp/Cons"    Proj:Action = {  EvalRulelist( "MxdFuelCmprReport_Results_CO2ExpCons", 1 )  }

   "Close MxdFuelCmprRpt CSV file"     Proj:Action =
      {  CloseExportFile( MxdFuelCmprRptFileIdx )  }

;   "write BEMBase details to export"  Proj:Action = {  StoreBEMProc( "after-mxdfuelcmprrpt-main", 0 )  }
;   "pause analysis"  Proj:Action = {  MessageBox(  "after writing MxdFuelCmprReport export CSV" )  }

END
;*************************************************************************



;************************************************************************* SAC 06/24/22
RULELIST "MxdFuelCmprReport_Inputs" 1 0 0 0
; Purpose: to write building model INPUTS to CSV file, to be concatenated onto a corresponding Results CSV following analysis

;   "write BEMBase details to export"  Proj:Action = {  StoreBEMProc( Format( "b4-mxdfuelcmprrpt-inp-%s", RunAbbrev ), 0 )  }


   "Open MxdFuelCmpr Input CSV file"      Proj:MxdFuelCmprInpFileIdx =
      {  OpenExportFile( ProcessingPath + ModelFile + " - MxdFuelCmpr-Inputs.csv", "wt" )  }


   "Write MxdFuelCmpr Input CSV HVAC-Bldg-1 UsePreCooling"     Proj:Action  =
      {  if (IfValidAnd( UsePreCooling > 0 ) .AND. IfValidAnd( PreCl_DataValid > 0 ))
         then  WriteToExportFile( MxdFuelCmprInpFileIdx, "HVAC - Building Level,Use Precooling?,Yes,,Proj:UsePreCooling\n" )
         else  WriteToExportFile( MxdFuelCmprInpFileIdx, "HVAC - Building Level,Use Precooling?,No,,Proj:UsePreCooling\n" )  endif  }
   "Write MxdFuelCmpr Input CSV HVAC-Bldg-2 ZonalControl"      Proj:Action  =
      {  if (IfValidAnd( ZonalControl > 0 ))
         then  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Zonal Control Credit?,Yes,,Proj:ZonalControl\n" )
         else  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Zonal Control Credit?,No,,Proj:ZonalControl\n" )  endif  }


   ; to do - sort by FloorAreaSrvdInclV
   "Set HVACSys:MxdFuelCmprCompIdx"    HVACSys:MxdFuelCmprCompIdx =     ; for now sorted only by create order
      {  if (FloorAreaSrvdInclV < 1) then  0
         else if (SumAll( HVACSys:MxdFuelCmprCompIdx ) < 1) then  1
         else  MaxAll( HVACSys:MxdFuelCmprCompIdx ) + 1  endif endif  }
   "Export HVACSys data"   for:#Sys=(1to10)  HVACSys:Action = 
      {  if (MxdFuelCmprCompIdx != #Sys) then  UNCHANGED
         else  EvalRulelist( "MxdFuelCmprReport_Inputs_HVACSys", 1 )  endif  }



   ; to do - sort by ???
   "Set DHWSys:MxdFuelCmprCompIdx"     DHWSys:MxdFuelCmprCompIdx =      ; for now sorted only by create order
      {  if (FloorAreaServed < 1) then  0
         else if (SumAll( DHWSys:MxdFuelCmprCompIdx ) < 1) then  1
         else  MaxAll( DHWSys:MxdFuelCmprCompIdx ) + 1  endif endif  }
   "Export DHWSys data"   for:#Sys=(1to10)   DHWSys:Action = 
      {  if (MxdFuelCmprCompIdx != #Sys) then  UNCHANGED
         else  EvalRulelist( "MxdFuelCmprReport_Inputs_DHWSys", 1 )  endif  }




;   "Write MxdFuelCmpr Input CSV record for each EvaporativeCooler ZnSys"   ZnSys:Action =
;      {  if (Type = "EvaporativeCooler" .AND. LocalCompAssigned( CtrlZnRef ))
;         then  EvalRulelist( "ModekitPrep_HybridCooling_ZnSys", 1 )
;         else  UNCHANGED  endif  }



   "Close MxdFuelCmpr Input CSV file"     Proj:Action =
      {  CloseExportFile( MxdFuelCmprInpFileIdx )  }


;           "MxdFuelCmprInpFileIdx",  BEMP_Int,  4,  1,  0,  Pres,  "",          0,  0,                              1801, "index of export CSV file listing building model inputs (N/E/S/W for All Orientation runs)",  ""  
;           "MxdFuelCmprRptFileIdx",  BEMP_Int,  4,  1,  0,  Pres,  "",          0,  0,                              1801, "index of export CSV file listing all building model details (N/E/S/W for All Orientation runs)",  ""  



;   "write BEMBase details to export"  Proj:Action = {  StoreBEMProc( Format( "after-modelkit-prep-%s", RunAbbrev ), 0 )  }
;   "pause analysis"  Proj:Action = {  MessageBox(  Format( "after writing Modelkit processing CSV for run: %s", RunAbbrev ) )  }

END
;*************************************************************************


;************************************************************************* SAC 06/26/22
RULELIST "MxdFuelCmprReport_Inputs_HVACSys" 1 0 0 0

   "Write HVACSys:Name"                HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, "HVAC System %g,Name,%c%s%c,,HVACSys:Name\n", MxdFuelCmprCompIdx, 34, Name, 34 )  }
   "Write HVACSys:Type"                HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",System Type,%c%s%c,,HVACSys:Type\n", 34, EnumString( Type ), 34 )  }
   "Write HVACSys:FloorAreaSrvdInclV"  HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Area Served,%g,ft2,HVACSys:FloorAreaSrvdInclV\n", FloorAreaSrvdInclV )  }

   "Write HVACSys:DistribSystem"       HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Distribution System,%c%s%c,,HVACSys:DistribSystem\n", 34, ValidOr( DistribSystem:Name, "" ), 34 )  }
   "Write HVACSys:Fan"                 HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Fan,%c%s%c,,HVACSys:Fan\n", 34, ValidOr( Fan:Name, "" ), 34 )  }

   "Write HVACSys:DistribSystem data"  HVACSys:Action  =
      {  if (LocalCompAssigned( DistribSystem ) < 1)
         then  EvalRulelist( "MxdFuelCmprReport_Inputs_HVACSys_DistribNone", 1 )
         else  EvalRulelist( "MxdFuelCmprReport_Inputs_HVACSys_Distrib",     1 )  endif  }

   "Write HVACSys:Fan data"            HVACSys:Action  =
      {  if (LocalCompAssigned( Fan ) < 1)
         then  EvalRulelist( "MxdFuelCmprReport_Inputs_HVACSys_FanNone", 1 )
         else  EvalRulelist( "MxdFuelCmprReport_Inputs_HVACSys_Fan",     1 )  endif  }

   "Write HVACSys:HtPumpSystem[1] data"            HVACSys:Action  =
      {  if (Type != 2 .OR. IfValidAnd( HtPumpSystemCount[1] > 0 )==0 .OR.
             IfValidAnd( NumHtPumpSystemTypes > 0 )==0 .OR.
             LocalCompAssigned( HtPumpSystem[1] ) < 1)
         then  EvalRulelist( "MxdFuelCmprReport_Inputs_HVACSys_HtPump1None", 1 )
         else  EvalRulelist( "MxdFuelCmprReport_Inputs_HVACSys_HtPump1",     1 )  endif  }

   "Write HVACSys:HeatSystem[1] data"              HVACSys:Action  =
      {  if (Type == 2 .OR. IfValidAnd( HeatSystemCount[1] > 0 )==0 .OR.
             IfValidAnd( NumHeatSystemTypes > 0 )==0 .OR.
             LocalCompAssigned( HeatSystem[1] ) < 1)
         then  EvalRulelist( "MxdFuelCmprReport_Inputs_HVACSys_Heat1None", 1 )
         else  EvalRulelist( "MxdFuelCmprReport_Inputs_HVACSys_Heat1",     1 )  endif  }

   "Write HVACSys:CoolSystem[1] data"              HVACSys:Action  =
      {  if (Type == 2 .OR. IfValidAnd( CoolSystemCount[1] > 0 )==0 .OR.
             IfValidAnd( NumCoolSystemTypes > 0 )==0 .OR.
             LocalCompAssigned( CoolSystem[1] ) < 1)
         then  EvalRulelist( "MxdFuelCmprReport_Inputs_HVACSys_Cool1None", 1 )
         else  EvalRulelist( "MxdFuelCmprReport_Inputs_HVACSys_Cool1",     1 )  endif  }

END
;*************************************************************************

;************************************************************************* SAC 06/26/22
RULELIST "MxdFuelCmprReport_Inputs_HVACSys_Distrib" 1 0 0 0

   "Write HVACSys:DistribSystem:Name"           HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, "HVAC %g - Distribution System,Dist. System - Name,%c%s%c,,HVACSys:DistribSystem:Name\n", MxdFuelCmprCompIdx, 34, DistribSystem:Name, 34 )  }
   "Write HVACSys:DistribSystem:Type"           HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Type,%c%s%c,,HVACSys:DistribSystem:Type\n", 34, EnumString( DistribSystem:Type ), 34 )  }
   "Write HVACSys:DistribSystem:DuctInsRvalue"  HVACSys:Action  =
      {  if (DistribSystem:DuctsPresent < 0.5)
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Supply Duct Insulation Value,n/a,degF-ft2-h/Btu,HVACSys:DistribSystem:DuctInsRvalue\n" )
         else if ( (IfValidAnd( DistribSystem:DuctsPresent > 0 ) .AND. IfValidAnd( DistribSystem:DuctDesign > 0 )) .OR.
                   IfValidAnd( DistribSystem:DuctInsRvalue >= 0 ) )
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Supply Duct Insulation Value,%g,degF-ft2-h/Btu,HVACSys:DistribSystem:DuctInsRvalue\n", DistribSystem:DuctInsRvalue )
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Supply Duct Insulation Value,,degF-ft2-h/Btu,HVACSys:DistribSystem:DuctInsRvalue\n" )  endif endif  }
   "Write HVACSys:DistribSystem:RetDuctInsRvalue"  HVACSys:Action  =
      {  if (DistribSystem:DuctsPresent < 0.5)
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Return Duct Insulation Value,n/a,degF-ft2-h/Btu,HVACSys:DistribSystem:RetDuctInsRvalue\n" )
         else if ( (IfValidAnd( DistribSystem:DuctsPresent > 0 ) .AND. IfValidAnd( DistribSystem:DuctDesign > 0 )) .OR.
                   IfValidAnd( DistribSystem:RetDuctInsRvalue >= 0 ) )
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Return Duct Insulation Value,%g,degF-ft2-h/Btu,HVACSys:DistribSystem:RetDuctInsRvalue\n", DistribSystem:RetDuctInsRvalue )
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Return Duct Insulation Value,,degF-ft2-h/Btu,HVACSys:DistribSystem:RetDuctInsRvalue\n" )  endif endif  }
   "Write HVACSys:DistribSystem:HasBypassDuct"     HVACSys:Action  =
      {  if (DistribSystem:DuctsPresent < 0.5)
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Has Bypass Ducts,n/a,,HVACSys:DistribSystem:HasBypassDuct\n" )
         else if (IfValidAnd( DistribSystem:HasBypassDuct > 0 ))
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Has Bypass Ducts,Yes,,HVACSys:DistribSystem:HasBypassDuct\n" )
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Has Bypass Ducts,No,,HVACSys:DistribSystem:HasBypassDuct\n" )  endif endif  }
   "Write HVACSys:DistribSystem:DefaultSystem"     HVACSys:Action  =
      {  if (DistribSystem:DuctsPresent < 0.5)
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Use defaults for all inputs,n/a,,HVACSys:DistribSystem:DefaultSystem\n" )
         else if (IfValidAnd( DistribSystem:DefaultSystem > 0 ))
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Use defaults for all inputs,Yes,,HVACSys:DistribSystem:DefaultSystem\n" )
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Use defaults for all inputs,No,,HVACSys:DistribSystem:DefaultSystem\n" )  endif endif  }
   "Write HVACSys:DistribSystem:LowLkgAH"     HVACSys:Action  =
      {  if (DistribSystem:DuctsPresent < 0.5 .OR. IfValidAnd( DistribSystem:DefaultSystem > 0 ))
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Low Leakage Air Handler,n/a,,HVACSys:DistribSystem:LowLkgAH\n" )
         else if (IfValidAnd( DistribSystem:LowLkgAH > 0 ))
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Low Leakage Air Handler,Yes,,HVACSys:DistribSystem:LowLkgAH\n" )
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Low Leakage Air Handler,No,,HVACSys:DistribSystem:LowLkgAH\n" )  endif endif  }
   "Write HVACSys:DistribSystem:LowLkgAH"     HVACSys:Action  =
      {  if (DistribSystem:DuctsPresent < 0.5 .OR. IfValidAnd( DistribSystem:DefaultSystem > 0 ) .OR. Type == 6)
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Verified Duct Design,n/a,,HVACSys:DistribSystem:DuctDesign\n" )
         else if (IfValidAnd( DistribSystem:DuctDesign > 0 ))
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Verified Duct Design,Yes,,HVACSys:DistribSystem:DuctDesign\n" )
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Verified Duct Design,No,,HVACSys:DistribSystem:DuctDesign\n" )  endif endif  }

   "Write HVACSys:DistribSystem:SupplyDuctLocUse"     HVACSys:Action  =
      {  if (DistribSystem:DuctsPresent < 0.5)
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Supply Duct Location,n/a,,HVACSys:DistribSystem:SupplyDuctLocUse\n" )
         else if (LocalCompAssigned( DistribSystem:SupplyDuctLocUse ))
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Supply Duct Location,%c%s%c,,HVACSys:DistribSystem:SupplyDuctLocUse\n", 34, DistribSystem:SupplyDuctLocUse:Name, 34 )
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Supply Duct Location,,,HVACSys:DistribSystem:SupplyDuctLocUse\n" )  endif endif  }

   ;      else if (Type > 12.5 .AND. IfValidAnd( DefaultSystem > 0 )==0 .AND. LocalCompAssigned( DistribSystem:SupplyDuctLoc:Name ))
   ;      then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Supply Duct Location,%c%s%c,,HVACSys:DistribSystem:SupplyDuctLoc\n", 34, DistribSystem:SupplyDuctLoc:Name, 34 )

   ;      else if (Type == 1 .AND. IfValidAnd( DefaultSystem > 0 )==0 .AND. LocalCompAssigned( DistribSystem:SupplyDuctAttic:Name ))
   ;      then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Supply Duct Location,%c%s%c,,HVACSys:DistribSystem:SupplyDuctAttic\n", 34, DistribSystem:SupplyDuctAttic:Name, 34 )

   ;      else if (IfValidAnd( DistribSystem:DuctDesign > 0 ))
   ;      then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Supply Duct Location,%c%s%c,,HVACSys:DistribSystem:SupplyRptLocation\n", 34, , 34 )
   ;      else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Supply Duct Location,,,HVACSys:DistribSystem:SupplyRptLocation\n" )  endif endif  }

	; CTRL, "SupplyDuctLoc",  30413, TDCT_Combo,  420, 380, 300, 160, 25, FNT_STD, "",                                           TA_LEFT,     0, 4,     1, TA_LEFT, 4, 4,  Type > 12.5 And DefaultSystem = 0,   Type > 12.5,  0, 0,  "Supply duct location"       
	; CTRL, "ReturnDuctLoc",  30414, TDCT_Combo,  420, 410, 300, 160, 25, FNT_STD, "",                                           TA_LEFT,     0, 4,     1, TA_LEFT, 4, 4,  Type > 12.5 And DefaultSystem = 0,   Type > 12.5,  0, 0,  "Return duct location"       
	; CTRL, "SupplyDuctAttic",30441, TDCT_Combo,  420, 380, 300, 160, 25, FNT_STD, "",                                           TA_RIGHT,    0, 4,     1, TA_LEFT, 4, 4,  DefaultSystem = 0,   Type = 1 And DefaultSystem = 0,  0, 0,  "Supply duct attic"       
	; CTRL, "ReturnDuctAttic",30442, TDCT_Combo,  420, 410, 300, 160, 25, FNT_STD, "",                                           TA_RIGHT,    0, 4,     1, TA_LEFT, 4, 4,  DefaultSystem = 0,   Type = 1 And DefaultSystem = 0,  0, 0,  "Return duct attic"       

   ;SupplyRptLocation = RVal: "Attic"  (1)
   ;ReturnRptLocation = RVal: "Attic"  (1)

   ;1,           "SupplyDuctLocUse",	 BEMP_Obj,  1,  0,  0,  Pres,  "",                 0,  5, "Zone", 0, "", "Attic", 0, "", "Garage", 0, "", "CrawlSpace", 0, "", "OtherZone", 0, "",	 1080, "Final/simulted location of supply ducts.",  "" 
   ;1,           "ReturnDuctLocUse",	 BEMP_Obj,  1,  0,  0,  Pres,  "",                 0,  5, "Zone", 0, "", "Attic", 0, "", "Garage", 0, "", "CrawlSpace", 0, "", "OtherZone", 0, "",   1080, "Final/simulted location of return ducts.",  "" 

   "Write HVACSys:DistribSystem:ReturnDuctLocUse"     HVACSys:Action  =
      {  if (DistribSystem:DuctsPresent < 0.5)
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Return Duct Location,n/a,,HVACSys:DistribSystem:ReturnDuctLocUse\n" )
         else if (LocalCompAssigned( DistribSystem:ReturnDuctLocUse ))
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Return Duct Location,%c%s%c,,HVACSys:DistribSystem:ReturnDuctLocUse\n", 34, DistribSystem:ReturnDuctLocUse:Name, 34 )
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Return Duct Location,,,HVACSys:DistribSystem:ReturnDuctLocUse\n" )  endif endif  }

END
;************************************************************************* SAC 06/26/22
RULELIST "MxdFuelCmprReport_Inputs_HVACSys_DistribNone" 1 0 0 0
   "Write HVACSys:DistribSystem:Name"              HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, "HVAC %g - Distribution System,Dist. System - Name,,,HVACSys:DistribSystem:Name\n", MxdFuelCmprCompIdx )  }
   "Write HVACSys:DistribSystem:Type"              HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Type,,,HVACSys:DistribSystem:Type\n" )  }
   "Write HVACSys:DistribSystem:DuctInsRvalOpt"    HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Duct Insulation Value,,,HVACSys:DistribSystem:DuctInsRvalOpt\n" )  }
   "Write HVACSys:DistribSystem:DuctInsRvalue"     HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Supply Duct Insulation Value,,°F-ft2-h/Btu,HVACSys:DistribSystem:DuctInsRvalue\n" )  }
   "Write HVACSys:DistribSystem:RetDuctInsRvalue"  HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Return Duct Insulation Value,,°F-ft2-h/Btu,HVACSys:DistribSystem:DuctInsRvalue\n" )  }
   "Write HVACSys:DistribSystem:HasBypassDuct"     HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Has Bypass Ducts,,,HVACSys:DistribSystem:HasBypassDuct\n" )  }
   "Write HVACSys:DistribSystem:DefaultSystem"     HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Use defaults for all inputs,,,HVACSys:DistribSystem:DefaultSystem\n" )  }
   "Write HVACSys:DistribSystem:LowLkgAH"          HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Low Leakage Air Handler,,,HVACSys:DistribSystem:LowLkgAH\n" )  }
   "Write HVACSys:DistribSystem:LowLkgAH"          HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Verified Duct Design,,,HVACSys:DistribSystem:DuctDesign\n" )  }
   "Write HVACSys:DistribSystem:SupplyDuctLocUse"  HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Supply Duct Location,,,HVACSys:DistribSystem:SupplyDuctLocUse\n" )  }
   "Write HVACSys:DistribSystem:ReturnDuctLocUse"  HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dist. System - Return Duct Location,,,HVACSys:DistribSystem:ReturnDuctLocUse\n" )  }
END
;*************************************************************************

;************************************************************************* SAC 06/27/22
RULELIST "MxdFuelCmprReport_Inputs_HVACSys_Fan" 1 0 0 0
   "Write HVACSys:Fan:Name"         HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, "HVAC %g - Fan,Fan - Name,%c%s%c,,HVACSys:Fan:Name\n", MxdFuelCmprCompIdx, 34, Fan:Name, 34 )  }
   "Write HVACSys:Fan:Type"         HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Fan - Type,%c%s%c,,HVACSys:Fan:Type\n", 34, EnumString( Fan:Type ), 34 )  }
   "Write HVACSys:Fan:WperCFMCool"  HVACSys:Action  =
      {  if (IfValidAnd( Fan:WperCFMCool >= 0 ) )
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Fan - Power,%g,W/CFM,HVACSys:Fan:WperCFMCool\n", Fan:WperCFMCool )
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Fan - Power,,W/CFM,HVACSys:Fan:WperCFMCool\n" )  endif  }
END
;************************************************************************* SAC 06/27/22
RULELIST "MxdFuelCmprReport_Inputs_HVACSys_FanNone" 1 0 0 0
   "Write HVACSys:Fan:Name"         HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, "HVAC %g - Fan,Fan - Name,,,HVACSys:Fan:Name\n", MxdFuelCmprCompIdx )  }
   "Write HVACSys:Fan:Type"         HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Fan - Type,,,HVACSys:Fan:Type\n" )  }
   "Write HVACSys:Fan:WperCFMCool"  HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Fan - Power,,W/CFM,HVACSys:Fan:WperCFMCool\n" )  }
END
;*************************************************************************

;************************************************************************* SAC 06/27/22
RULELIST "MxdFuelCmprReport_Inputs_HVACSys_HtPump1" 1 0 0 0
   "Write HVACSys:HtPumpSystem[1]:Name"         HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, "HVAC %g - Ht. Pump Data,Ht. Pump 1 - Name,%c%s%c,,HVACSys:HtPumpSystem[1]:Name\n", MxdFuelCmprCompIdx, 34, HtPumpSystem[1]:Name, 34 )  }
   "Write HVACSys:HtPumpSystem[1]:Type"         HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Ht. Pump 1 - Type,%c%s%c,,HVACSys:HtPumpSystem[1]:Type\n", 34, EnumString( HtPumpSystem[1]:Type ), 34 )  }
   "Write HVACSys:HtPumpSystemCount[1]"         HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Ht. Pump 1 - Count,%g,,HVACSys:HtPumpSystemCount[1]\n", HtPumpSystemCount[1] )  }
   "Write HVACSys:HtPumpSystem[1]:HSPF"         HVACSys:Action  =
      {  if (IfValidAnd( HtPumpSystem[1]:ShowHSPF > 0 ) .AND. IfValidAnd( HtPumpSystem[1]:HSPF >= 0 ) )
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Ht. Pump 1 - HSPF,%g,ratio,HVACSys:HtPumpSystem[1]:HSPF\n", HtPumpSystem[1]:HSPF )
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Ht. Pump 1 - HSPF,,ratio,HVACSys:HtPumpSystem[1]:HSPF\n" )  endif  }

   "Write HVACSys:HtPumpSystem[1]:SEER"         HVACSys:Action  =
      {  if (IfValidAnd( HtPumpSystem[1]:IsAvailable > 0 ) .AND. IfValidAnd( HtPumpSystem[1]:Show4717COPs > 0 )==0 .AND.
             IfValidAnd( HtPumpSystem[1]:ShowCEER > 0 )==0 .AND. IfValidAnd( HtPumpSystem[1]:SEER >= 0 ) )
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Ht. Pump 1 - SEER,%g,(kBtu/h)/kW,HVACSys:HtPumpSystem[1]:SEER\n", HtPumpSystem[1]:SEER )
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Ht. Pump 1 - SEER,,(kBtu/h)/kW,HVACSys:HtPumpSystem[1]:SEER\n" )  endif  }

   "Write HVACSys:HtPumpSystem[1]:EER"          HVACSys:Action  =
      {  if (IfValidAnd( HtPumpSystem[1]:IsAvailable > 0 ) .AND. IfValidAnd( HtPumpSystem[1]:ShowCEER > 0 )==0 .AND.
             IfValidAnd( HtPumpSystem[1]:EER >= 0 ) )
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Ht. Pump 1 - EER,%g,kBtuh/kW,HVACSys:HtPumpSystem[1]:EER\n", HtPumpSystem[1]:EER )
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Ht. Pump 1 - EER,,kBtuh/kW,HVACSys:HtPumpSystem[1]:EER\n" )  endif  }


;  	 CTRL, "HSPF",             30210, TDCT_Edit,    90, 260,  25,  75, 11, FNT_STD, "HSPF:",                                 TA_LEFT,   -60, 4,     1, TA_LEFT, 4, 4,  None,       ShowHSPF > 0,                              -61, 40,  "ratio of BTU heat output over the heating season to watt-hours of electricity used"
;  	 CTRL, "HeatPower",        30211, TDCT_Edit,    90, 290,  25,  75, 11, FNT_STD, "Power:",                                TA_LEFT,   -60, 4,     1, TA_LEFT, 4, 4,  None,       ShowHeatPower > 0,                         -61, 40,  "heating power (watts)"
;  
;  	 CTRL, "AutoSize",         30312, TDCT_Check,   30, 332,  22, 140,  2, FNT_STD, "Auto-Size Capacity",                    TA_LEFT,     0, 4,     0, TA_LEFT, 0, 0,  None,       IsAvailable > 0 And Type != 22 And Proj:EnableHPAutosize > 0,     0,  0,  "Whether or not auto-size heat pump capacity using the simulation engine"   ; SAC 9/22/17
;  
;  	 CTRL, "",                   997, TDCT_Label,  168, 358,  19,  90, -1, FNT_STD, "Capacity (Btuh)",                       TA_RIGHT,    0, 0,     0, TA_LEFT, 0, 0,  None,       IsAvailable > 0 And AutoSize = 0,            0,  0,  ""
;  	 CTRL, "",                   998, TDCT_Label,  182, 358,  19,  80, -1, FNT_STD, "COP (ratio)",                           TA_LEFT,     0, 0,     0, TA_LEFT, 0, 0,  None,       IsAvailable > 0 And Show4717COPs > 0,        0,  0,  ""
;  
;  	; SAC 5/6/14 - toggle OFF 47deg label for GSHP (not rated based on temperature for this type of equipment)
;  	 CTRL, "",                   996, TDCT_Label,   30, 384,  20,  58, -1, FNT_STD, "@ 47°F:",                               TA_LEFT,     0, 0,     0, TA_LEFT, 0, 0,  None,       IsAvailable > 0 And AutoSize = 0 And Type != 12,              0,  0,  ""
;  	 CTRL, "Cap47",            30214, TDCT_Edit,    90, 380,  25,  75, 11, FNT_STD, "",                                      TA_LEFT,    -1, 4,     0, TA_LEFT, 4, 4,  None,       IsAvailable > 0 And AutoSize = 0,            0,  0,  ""
;  	 CTRL, "COP47",            30215, TDCT_Edit,   185, 380,  25,  50, 11, FNT_STD, "",                                      TA_LEFT,    -1, 4,     0, TA_LEFT, 4, 4,  None,       IsAvailable > 0 And Show4717COPs > 0,        0,  0,  ""
;  
;  	 CTRL, "Cap35",            30216, TDCT_Edit,    90, 410,  25,  75, 11, FNT_STD, "@ 35°F:",                               TA_LEFT,   -60, 4,     0, TA_LEFT, 4, 4,  None,       IsAvailable > 0 And Proj:AnalysisType = 0 And AutoSize = 0, -61,  0,  ""
;  	 CTRL, "COP35",            30217, TDCT_Edit,   185, 410,  25,  50, 11, FNT_STD, "",                                      TA_LEFT,    -1, 4,     0, TA_LEFT, 4, 4,  None,       IsAvailable > 0 And Proj:AnalysisType = 0,   0,  0,  ""
;  
;  	 CTRL, "Cap17",            30218, TDCT_Edit,    90, 440,  25,  75, 11, FNT_STD, "@ 17°F:",                               TA_LEFT,   -60, 4,     0, TA_LEFT, 4, 4,  None,       IsAvailable > 0 And AutoSize = 0 And Type != 12 And Type != 7 And IsPackaged = 0,       -61,  0,  ""
;  	 CTRL, "COP17",            30219, TDCT_Edit,   185, 440,  25,  50, 11, FNT_STD, "",                                      TA_LEFT,    -1, 4,     0, TA_LEFT, 4, 4,  None,       IsAvailable > 0 And Show4717COPs > 0 And Type = 11,      0,  0,  ""
;  
;  ; SAC 11/4/18 - added for VCHP
;  	 CTRL, "VCHPDucts",        30226, TDCT_Combo,   90, 470, 350, 155, 25, FNT_STD, "Ducts:",                                TA_LEFT,   -60, 4,     1, TA_LEFT, 4, 4,  None,       IsAvailable > 0 And Type = 22,                    -87,  0,  "Whether VCHP is Unducted, Ducted or Partially Ducted" 
;  	 CTRL, "VCHPCertAutoFan",  30227, TDCT_Check,   93, 502,  22, 150,  2, FNT_STD, "Certified Auto-Fan",                    TA_LEFT,     0, 4,     0, TA_LEFT, 0, 0,  None,       IsAvailable > 0 And Type = 22 And VCHPDucts > 0,    0,  0,  "Whether ducted VCHP unit is certified as auto-fan" 
;  
;     ; added Dual Fuel HP options - SAC 12/08/20  ; ported from 2022 and shown only for Proj:EnableResearchMode > 0 - SAC 03/05/21
;  	 CTRL, "IsDualFuel",       30240, TDCT_Check,   30, 532,  22, 113,  2, FNT_STD, "Dual Fuel HP",                          TA_LEFT,     0, 4,     0, TA_LEFT, 0, 0,  None,       Proj:EnableResearchMode > 0 And IsAvailable > 0 And AllowDualFuel > 0,    0,  0,  "Whether or not this system is dual fuel (fuel backup heat)" 
;  	 CTRL, "AFUE",             30241, TDCT_Edit,   195, 530,  25,  40, 11, FNT_STD, "AFUE:",                                 TA_LEFT,   -50, 4,     1, TA_LEFT, 4, 4,  None,       Proj:EnableResearchMode > 0 And IsAvailable > 0 And AllowDualFuel > 0 And IsDualFuel > 0,  -51, 20,  "Annual Fuel Use Efficiency from DOE test procedure for backup gas heat source"
;  	 CTRL, "HasHPLockout",     30242, TDCT_Check,   50, 562,  22, 143,  2, FNT_STD, "Has Lockout Temp.",                     TA_LEFT,     0, 4,     0, TA_LEFT, 0, 0,  None,       Proj:EnableResearchMode > 0 And IsAvailable > 0 And AllowDualFuel > 0 And IsDualFuel > 0,    0,  0,  "Whether or not this HP has a lockout temperature" 
;  	 CTRL, "HPLockoutTemp",    30243, TDCT_Edit,   195, 560,  25,  40, 11, FNT_STD, "",                                      TA_LEFT,    -1, 4,     1, TA_LEFT, 4, 4,  None,       Proj:EnableResearchMode > 0 And IsAvailable > 0 And AllowDualFuel > 0 And IsDualFuel > 0 And HasHPLockout > 0,  0, 30,  "HP lockout temperature"
;  
;  	 CTRL, "",                   993, TDCT_Label,  310, 235,  19, 200, -1, FNT_STD, "Cooling Performance:",                  TA_LEFT,     0, 0,     0, TA_LEFT, 0, 0,  None,       IsAvailable > 0,   0,  0,  ""
;  	 CTRL, "",                   992, TDCT_Line,   440, 243, 560, 243, -1, FNT_STD, "",                                      TA_CENTER,   0, 0,     0, TA_LEFT, 0, 0,  None,       IsAvailable > 0,   0,  0,  ""
;  
;  	 CTRL, "SEERCEERLabel",      991, TDCT_Label,  320, 264,  19,  80, -1, FNT_STD, "",                                      TA_LEFT,     0, 0,     0, TA_LEFT, 0, 0,  None,       IsAvailable > 0,   0,  0,  ""
;  	 CTRL, "SEER",             30306, TDCT_Edit,   405, 260,  25,  75, 11, FNT_STD, "",                                      TA_LEFT,    -1, 4,     0, TA_LEFT, 4, 4,  None,       IsAvailable > 0 And Show4717COPs < 1 And ShowCEER < 1,   0, 80,  "Seasonal Energy Efficiency Ratio from DOE test procedure at 82°F" 
;  	 CTRL, "CEER",             30313, TDCT_Edit,   405, 260,  25,  75, 11, FNT_STD, "",                                      TA_LEFT,    -1, 4,     0, TA_LEFT, 4, 4,  None,       IsAvailable > 0 And ShowCEER > 0,                        0, 80,  "Combined Energy Efficiency Ratio" 
;      CTRL, "EER",              30307, TDCT_Edit,   405, 290,  25,  75, 11, FNT_STD, "EER:",                                  TA_LEFT,   -85, 4,     0, TA_LEFT, 4, 4,  UseEERinAnalysis > 0,       IsAvailable > 0 And ShowCEER < 1,      -87, 80,  "Energy Efficiency Ratio at 95°F outdoor temperature"              
;      CTRL, "UseEERinAnalysis", 30311, TDCT_Check,  320, 320,  22, 250,  2, FNT_STD, "Use this EER in compliance analysis",   TA_LEFT,     0, 4,     0, TA_LEFT, 0, 0,  None,       ShowUseEER > 0 And ShowCEER < 1,             0,  0,  "Whether or not the EER value should be used in compliance analysis and reporting"  
;  	 CTRL, "CFMperTon",        30308, TDCT_Edit,   405, 350,  25,  75, 11, FNT_STD, "CFM per Ton:",                          TA_LEFT,   -85, 4,     1, TA_LEFT, 4, 4,  None,       IsAvailable > 0 And ShowCFMperTon > 0,     -87, 80,  "Cooling air flow in CFM per nominal ton of AC capacity"           
;  	 CTRL, "ACCharge",         30309, TDCT_Combo,  405, 380, 350, 155, 25, FNT_STD, "AC Charge:",                            TA_LEFT,   -85, 4,     1, TA_LEFT, 4, 4,  None,       IsAvailable > 0 And Type != 12 And Type != 7 And IsPackaged < 1,                                     -87,  0,  ""                                                                 
;  	 CTRL, "RefrigerantType",  30310, TDCT_Combo,  405, 412, 350, 155, 25, FNT_STD, "Refrigerant:",                          TA_LEFT,   -85, 4,     1, TA_LEFT, 4, 4,  None,       IsAvailable > 0 And ShowRefrigerant > 0,   -87,  0,  ""                                                                 
;  
;  	 CTRL, "IsMultiSpeed",     30322, TDCT_Check,  320, 442,  22, 180,  2, FNT_STD, "Multi-Speed Compressor",                TA_LEFT,     0, 4,     0, TA_LEFT, 0, 0,  None,       ShowMultiSpeed > 0 And Show4717COPs < 1 And Type !=10 And Type < 20,  0,  0,  "Whether or not the compressor is multi/variable speed"  
;  	 CTRL, "IsZonal",          30323, TDCT_Check,  320, 470,  22, 180,  2, FNT_STD, "Zonally Controlled",                	 TA_LEFT,     0, 4,     0, TA_LEFT, 0, 0,  None,       ShowIsZonal > 0,     0,  0,  "Whether or not the cooling system is zonally controlled"  
;  	 CTRL, "ClSizingFactor",   30321, TDCT_Edit,   405, 500,  25,  75, 11, FNT_STD, "Sizing Factor:",                        TA_LEFT,   -85, 4,     1, TA_LEFT, 4, 4,  Proj:AnalysisType = 0,  IsAvailable > 0 And Show4717COPs < 1, -87, 40,  "Cooling capacity sizing factor"

END
;************************************************************************* SAC 06/27/22
RULELIST "MxdFuelCmprReport_Inputs_HVACSys_HtPump1None" 1 0 0 0
   "Write HVACSys:HtPumpSystem[1]:Name"         HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, "HVAC %g - Ht. Pump Data,Ht. Pump 1 - Name,,,HVACSys:HtPumpSystem[1]:Name\n", MxdFuelCmprCompIdx )  }
   "Write HVACSys:HtPumpSystem[1]:Type"         HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Ht. Pump 1 - Type,,,HVACSys:HtPumpSystem[1]:Type\n" )  }
   "Write HVACSys:HtPumpSystemCount[1]"         HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Ht. Pump 1 - Count,,,HVACSys:HtPumpSystemCount[1]\n" )  }
   "Write HVACSys:HtPumpSystem[1]:HSPF"         HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Ht. Pump 1 - HSPF,,ratio,HVACSys:HtPumpSystem[1]:HSPF\n" )  }
   "Write HVACSys:HtPumpSystem[1]:SEER"         HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Ht. Pump 1 - SEER,,(kBtu/h)/kW,HVACSys:HtPumpSystem[1]:SEER\n" )  }
   "Write HVACSys:HtPumpSystem[1]:EER"          HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Ht. Pump 1 - EER,,kBtuh/kW,HVACSys:HtPumpSystem[1]:EER\n" )  }

END
;*************************************************************************

;************************************************************************* SAC 06/27/22
RULELIST "MxdFuelCmprReport_Inputs_HVACSys_Heat1" 1 0 0 0
   "Write HVACSys:HeatSystem[1]:Name"         HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, "HVAC %g - Heating Systems Data,Heating System 1 - Name,%c%s%c,,HVACSys:HeatSystem[1]:Name\n", MxdFuelCmprCompIdx, 34, HeatSystem[1]:Name, 34 )  }
   "Write HVACSys:HeatSystem[1]:Type"         HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Heating System 1 - Type,%c%s%c,,HVACSys:HeatSystem[1]:Type\n", 34, EnumString( HeatSystem[1]:Type ), 34 )  }
   "Write HVACSys:HeatSystemCount[1]"         HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Heating System 1 - Count,%g,,HVACSys:HeatSystemCount[1]\n", HeatSystemCount[1] )  }
   "Write HVACSys:HeatSystem[1]:AFUE"         HVACSys:Action  =
      {  if (IfValidAnd( HeatSystem[1]:IsAvailable > 0 ) .AND. IfValidAnd( HeatSystem[1]:DisplayAFUE > 0 ) .AND.
             IfValidAnd( HeatSystem[1]:AFUE >= 0 ) )
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Heating System 1 - AFUE,%g,%,HVACSys:HeatSystem[1]:AFUE\n", HeatSystem[1]:AFUE )
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Heating System 1 - AFUE,,%,HVACSys:HeatSystem[1]:AFUE\n" )  endif  }

; screen inputs
;	 CTRL, "AFUE",           30206, TDCT_Edit,    70, 230,  25,  75, 11, FNT_STD, "AFUE:",                                 TA_LEFT,   -50, 4,     1, TA_LEFT, 4, 4,  None,       IsAvailable > 0 And DisplayAFUE > 0,       -51, 20,  "Annual Fuel Use Efficiency from DOE test procedure (0-100%)."
;
;	 CTRL, "SizingFactor",   30231, TDCT_Edit,   475, 290,  25,  50, 11, FNT_STD, "Sizing Factor:",                        TA_LEFT,   -85, 4,     1, TA_LEFT, 4, 4,  Proj:AnalysisType = 0,  IsAvailable > 0 And AutoSize = 1,  -87, 40,  "Heating capacity sizing factor"
;	 CTRL, "TotalCapacity",  30290, TDCT_Edit,   460, 320,  25,  65, 11, FNT_STD, "Capacity:",                             TA_LEFT,   -70, 4,     1, TA_LEFT, 4, 4,  Proj:AnalysisType = 0,  IsAvailable > 0 And AutoSize = 0,  -72, 40,  "Heating capacity"
;
;	 CTRL, "CHWHeater",     30236, TDCT_Combo,  300, 410, 350, 240, 12, FNT_STD, "Combined Hydronic Water Heater:",        TA_LEFT,  -210, 4,     0, TA_LEFT, 0, 0,  None,       Type = 9,  -212,  0,  ""

END
;************************************************************************* SAC 06/27/22
RULELIST "MxdFuelCmprReport_Inputs_HVACSys_Heat1None" 1 0 0 0
   "Write HVACSys:HeatSystem[1]:Name"         HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, "HVAC %g - Heating Systems Data,Heating System 1 - Name,,,HVACSys:HeatSystem[1]:Name\n", MxdFuelCmprCompIdx )  }
   "Write HVACSys:HeatSystem[1]:Type"         HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Heating System 1 - Type,,,HVACSys:HeatSystem[1]:Type\n" )  }
   "Write HVACSys:HeatSystemCount[1]"         HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Heating System 1 - Count,,,HVACSys:HeatSystemCount[1]\n" )  }
   "Write HVACSys:HeatSystem[1]:AFUE"         HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Heating System 1 - AFUE,,%,HVACSys:HeatSystem[1]:AFUE\n" )  }
END
;*************************************************************************

;************************************************************************* SAC 06/29/22
RULELIST "MxdFuelCmprReport_Inputs_HVACSys_Cool1" 1 0 0 0
   "Write HVACSys:CoolSystem[1]:Name"         HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, "HVAC %g - Cooling Systems Data,Cooling System 1 - Name,%c%s%c,,HVACSys:CoolSystem[1]:Name\n", MxdFuelCmprCompIdx, 34, CoolSystem[1]:Name, 34 )  }
   "Write HVACSys:CoolSystem[1]:Type"         HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - Type,%c%s%c,,HVACSys:CoolSystem[1]:Type\n", 34, EnumString( CoolSystem[1]:Type ), 34 )  }
   "Write HVACSys:CoolSystemCount[1]"         HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - Count,%g,,HVACSys:CoolSystemCount[1]\n", CoolSystemCount[1] )  }

   "Write HVACSys:CoolSystem[1]:SEER"         HVACSys:Action  =
      {  if (IfValidAnd( CoolSystem[1]:ShowSEER > 0 ) .AND. IfValidAnd( CoolSystem[1]:SEER >= 0 ) )
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - SEER,%g,(kBtu/h)/kW,HVACSys:CoolSystem[1]:SEER\n", CoolSystem[1]:SEER )
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - SEER,,(kBtu/h)/kW,HVACSys:CoolSystem[1]:SEER\n" )  endif  }
   "Write HVACSys:CoolSystem[1]:EER"          HVACSys:Action  =
      {  if (IfValidAnd( CoolSystem[1]:ShowEER > 0 ) .AND. IfValidAnd( CoolSystem[1]:EER >= 0 ) )
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - EER,%g,kBtuh/kW,HVACSys:CoolSystem[1]:EER\n", CoolSystem[1]:EER )
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - EER,,kBtuh/kW,HVACSys:CoolSystem[1]:EER\n" )  endif  }
   "Write HVACSys:CoolSystem[1]:UseEERinAnalysis"  HVACSys:Action  =
      {  if (IfValidAnd( CoolSystem[1]:ShowSEER > 0 ) .AND. IfValidAnd( CoolSystem[1]:ShowEER > 0 ) )
         then  if (IfValidAnd( CoolSystem[1]:UseEERinAnalysis > 0 ))
               then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - Use this EER for Compliance,Yes,,HVACSys:CoolSystem[1]:UseEERinAnalysis\n" )
               else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - Use this EER for Compliance,No,,HVACSys:CoolSystem[1]:UseEERinAnalysis\n" )  endif
         else        WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - Use this EER for Compliance,,,HVACSys:CoolSystem[1]:UseEERinAnalysis\n" )  endif  }
   "Write HVACSys:CoolSystem[1]:CFMperTon"   HVACSys:Action  =
      {  if (IfValidAnd( CoolSystem[1]:IsAvailable > 0 ) .AND. IfValidAnd( CoolSystem[1]:Type != 5 ) .AND. IfValidAnd( CoolSystem[1]:Type != 25 ) )
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - CFM per Ton,%g,CFM/ton,HVACSys:CoolSystem[1]:CFMperTon\n", CoolSystem[1]:CFMperTon )
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - CFM per Ton,,CFM/ton,HVACSys:CoolSystem[1]:CFMperTon\n" )  endif  }
   "Write HVACSys:CoolSystem[1]:ACCharge"   HVACSys:Action  =
      {  if (IfValidAnd( CoolSystem[1]:IsAvailable > 0 ) .AND. IfValidAnd( CoolSystem[1]:IsPackaged < 1 ) .AND. IfValidAnd( CoolSystem[1]:Type != 5 ) )
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - AC Charge,%s,,HVACSys:CoolSystem[1]:ACCharge\n", EnumString( CoolSystem[1]:ACCharge ) )
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - AC Charge,,,HVACSys:CoolSystem[1]:ACCharge\n" )  endif  }
   "Write HVACSys:CoolSystem[1]:RefrigerantType"   HVACSys:Action  =
      {  if (IfValidAnd( CoolSystem[1]:IsAvailable > 0 ) .AND. IfValidAnd( CoolSystem[1]:IsPackaged < 1 ) .AND. IfValidAnd( CoolSystem[1]:Type != 5 ) )
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - Refrigerant Type,%s,,HVACSys:CoolSystem[1]:RefrigerantType\n", EnumString( CoolSystem[1]:RefrigerantType ) )
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - Refrigerant Type,,,HVACSys:CoolSystem[1]:RefrigerantType\n" )  endif  }
   "Write HVACSys:CoolSystem[1]:IsMultiSpeed"   HVACSys:Action  =
      {  if (IfValidAnd( CoolSystem[1]:ShowMultiSpeed > 0 ))
         then  if (IfValidAnd( CoolSystem[1]:IsMultiSpeed > 0 ))
               then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - Multi-Speed Compressor,Yes,,HVACSys:CoolSystem[1]:IsMultiSpeed\n" )
               else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - Multi-Speed Compressor,No,,HVACSys:CoolSystem[1]:IsMultiSpeed\n" )  endif
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - Multi-Speed Compressor,,,HVACSys:CoolSystem[1]:IsMultiSpeed\n" )  endif  }
   "Write HVACSys:CoolSystem[1]:IsZonal"   HVACSys:Action  =
      {  if (IfValidAnd( CoolSystem[1]:ShowIsZonal > 0 ))
         then  if (IfValidAnd( CoolSystem[1]:IsZonal > 0 ))
               then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - Zonally Controlled,Yes,,HVACSys:CoolSystem[1]:IsZonal\n" )
               else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - Zonally Controlled,No,,HVACSys:CoolSystem[1]:IsZonal\n" )  endif
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - Zonally Controlled,,,HVACSys:CoolSystem[1]:IsZonal\n" )  endif  }

; screen inputs
;	 CTRL, "SEER",             30306, TDCT_Edit,   125, 150,  25,  75, 11, FNT_STD, "SEER:",                                 TA_LEFT,  -105, 4,     0, TA_LEFT, 4, 4,  None,       ShowSEER > 0,                        -107, 80,  "Seasonal Energy Efficiency Ratio from DOE test procedure at 82°F" 
;	 CTRL, "EERb",             30308, TDCT_Edit,   125, 180,  25,  75, 11, FNT_STD, "EERb:",                                 TA_LEFT,  -105, 4,     0, TA_LEFT, 4, 4,  None,       IsAvailable > 0 And Type = 14,       -107, 80,  "Integrated Energy Efficiency Ratio from AHRI test procedure for Evap Condensers" 
;	 CTRL, "EER",              30307, TDCT_Edit,   125, 180,  25,  75, 11, FNT_STD, "EER:",                                  TA_LEFT,  -105, 4,     0, TA_LEFT, 4, 4,  UseEERinAnalysis > 0, ShowEER  > 0,              -107, 80,  "Energy Efficiency Ratio at 95°F outdoor temperature"              
;	 CTRL, "UseEERinAnalysis", 30310, TDCT_Check,  300, 180,  22, 250,  2, FNT_STD, "Use this EER in compliance analysis",   TA_LEFT,     0, 4,     0, TA_LEFT, 0, 0,  None,       ShowEER  > 0 And ShowSEER > 0,          0,  0,  "Whether or not the EER value should be used in compliance analysis and reporting"  
;	 CTRL, "EERa",             30309, TDCT_Edit,   125, 150,  25,  75, 11, FNT_STD, "EERa:",                                 TA_LEFT,  -105, 4,     0, TA_LEFT, 4, 4,  None,       IsAvailable > 0 And Type = 14,       -107, 80,  "EER for Evaporative Condensers"              
;	 CTRL, "CEER",             30316, TDCT_Edit,   125, 210,  25,  75, 11, FNT_STD, "CEER:",                                 TA_LEFT,  -105, 4,     0, TA_LEFT, 4, 4,  None,       ShowCEER > 0,                        -107, 80,  "Combined Energy Efficiency Ratio" 
;	 CTRL, "CFMperTon",        30311, TDCT_Edit,   125, 240,  25,  75, 11, FNT_STD, "CFM per Ton:",                          TA_LEFT,  -105, 4,     1, TA_LEFT, 4, 4,  None,       IsAvailable > 0 And Type != 5 And Type != 25,  -107, 80,  "Cooling air flow in CFM per nominal ton of AC capacity"           
;	 CTRL, "ACCharge",         30312, TDCT_Combo,  125, 270, 350, 155, 25, FNT_STD, "AC Charge:",                            TA_LEFT,  -105, 4,     1, TA_LEFT, 4, 4,  None,       IsAvailable > 0 And IsPackaged < 1 And Type != 5,  -107,  0,  ""   
;	 CTRL, "RefrigerantType",  30313, TDCT_Combo,  125, 300, 350, 155, 25, FNT_STD, "Refrigerant Type:",                     TA_LEFT,  -105, 4,     1, TA_LEFT, 4, 4,  None,       IsAvailable > 0 And IsPackaged < 1 And Type != 5,  -107,  0,  ""    
;
;	 CTRL, "IsMultiSpeed",     30322, TDCT_Check,  370, 210,  22, 180,  2, FNT_STD, "Multi-Speed Compressor",                TA_LEFT,     0, 4,     0, TA_LEFT, 0, 0,  None,       ShowMultiSpeed > 0,     0,  0,  "Whether or not the compressor is multi/variable speed"  
;	 CTRL, "IsZonal",          30323, TDCT_Check,  370, 240,  22, 160,  2, FNT_STD, "Zonally Controlled",                	 TA_LEFT,     0, 4,     0, TA_LEFT, 0, 0,  None,       ShowIsZonal > 0,     0,  0,  "Whether or not the cooling system is zonally controlled"  
;	 CTRL, "SizingFactor",     30321, TDCT_Edit,   475, 270,  25,  50, 11, FNT_STD, "Sizing Factor:",                        TA_LEFT,   -85, 4,     1, TA_LEFT, 4, 4,  Proj:AnalysisType = 0,  IsAvailable > 0 And AutoSize = 1,  -87, 40,  "Cooling capacity sizing factor"
;	 CTRL, "TotalCapacity",    30390, TDCT_Edit,   460, 270,  25,  65, 11, FNT_STD, "Capacity:",                             TA_LEFT,   -70, 4,     1, TA_LEFT, 4, 4,  Proj:AnalysisType = 0,  IsAvailable > 0 And AutoSize = 0,  -72, 40,  "Cooling capacity at standard AHRI rating conditions."

END
;************************************************************************* SAC 06/29/22
RULELIST "MxdFuelCmprReport_Inputs_HVACSys_Cool1None" 1 0 0 0
   "Write HVACSys:CoolSystem[1]:Name"         HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, "HVAC %g - Cooling Systems Data,Cooling System 1 - Name,,,HVACSys:CoolSystem[1]:Name\n", MxdFuelCmprCompIdx )  }
   "Write HVACSys:CoolSystem[1]:Type"         HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - Type,,,HVACSys:CoolSystem[1]:Type\n" )  }
   "Write HVACSys:CoolSystemCount[1]"         HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - Count,,,HVACSys:CoolSystemCount[1]\n" )  }

   "Write HVACSys:CoolSystem[1]:SEER"              HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - SEER,,(kBtu/h)/kW,HVACSys:CoolSystem[1]:SEER\n" )  }
   "Write HVACSys:CoolSystem[1]:EER"               HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - EER,,kBtuh/kW,HVACSys:CoolSystem[1]:EER\n" )  }
   "Write HVACSys:CoolSystem[1]:UseEERinAnalysis"  HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - Use this EER for Compliance,,,HVACSys:CoolSystem[1]:UseEERinAnalysis\n" )  }
   "Write HVACSys:CoolSystem[1]:CFMperTon"         HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - CFM per Ton,,CFM/ton,HVACSys:CoolSystem[1]:CFMperTon\n" )  }
   "Write HVACSys:CoolSystem[1]:ACCharge"          HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - AC Charge,,,HVACSys:CoolSystem[1]:ACCharge\n" )  }
   "Write HVACSys:CoolSystem[1]:RefrigerantType"   HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - Refrigerant Type,,,HVACSys:CoolSystem[1]:RefrigerantType\n" )  }
   "Write HVACSys:CoolSystem[1]:IsMultiSpeed"      HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - Multi-Speed Compressor,,,HVACSys:CoolSystem[1]:IsMultiSpeed\n" )  }
   "Write HVACSys:CoolSystem[1]:IsZonal"           HVACSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Cooling System 1 - Zonally Controlled,,,HVACSys:CoolSystem[1]:IsZonal\n" )  }
END
;*************************************************************************




;************************************************************************* SAC 07/01/22
RULELIST "MxdFuelCmprReport_Inputs_DHWSys" 1 0 0 0

   "Write DHWSys:Name"                 DHWSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, "DHW System %g,Name,%c%s%c,,DHWSys:Name\n", MxdFuelCmprCompIdx, 34, Name, 34 )  }
   "Write DHW Compact Dist Option"     DHWSys:Action  =
      {  if (Proj:SFamCompactDistrib > 0)
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",DHW Distribution Compactness,%c%s%c,,Proj:SFamCompactDistrib\n", 34, EnumString( Proj:SFamCompactDistrib ), 34 )
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",DHW Distribution Compactness,,,Proj:SFamCompactDistrib\n" )  endif  }
   "Write DHW Compact Dist Option"     DHWSys:Action  =
      {  if (Proj:SFamCompactDistrib > 0 .AND. IfValidAnd( Proj:SFamCompactFactor < 1 ) .AND.
             (IfValidAnd( Proj:SFamCDSpecFixDists < 1 ) .OR. IfValidAnd( Proj:SFamCDWeightedDist <= 10000 )))
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",DHW Distribution Compactness Factor,%g,,Proj:SFamCompactFactor\n", Proj:SFamCompactFactor )
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",DHW Distribution Compactness Factor,,,Proj:SFamCompactFactor\n" )  endif  }
   "Write DHWSys:SystemType"           DHWSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Dwelling Unit Dist.,%c%s%c,,DHWSys:SystemType\n", 34, EnumString( SystemType ), 34 )  }
   "Write DHW Drain Water Recovery Used"     DHWSys:Action  =
      {  if (IfValidAnd( NumDWHRSysRefs >= 1 ) .AND. IfValidAnd( TotDWHRSysShowers > 0 ) .AND.
             FindInString( DWHRSysSummaryMsg, "ERROR" ) < 0)
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Drain Water Recovery Used,%c%s%c,,DHWSys:DWHRSysSummaryMsg\n", 34, DWHRSysSummaryMsg, 34 )
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Drain Water Recovery Used,No,,DHWSys:DWHRSysSummaryMsg\n" )  endif  }
   "Write DHW Drain Water Recovery Efficiency - 1"    DHWSys:Action  =
      {  if (IfValidAnd( NumDWHRSysRefs >= 1 ) .AND. IfValidAnd( TotDWHRSysShowers > 0 ) .AND.
             FindInString( DWHRSysSummaryMsg, "ERROR" ) < 0 .AND. IfValidAnd( DWHRSysRef[1]:CSARatedEff > 0 ))
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Drain Water Recovery Efficiency - 1,%g,%,DHWSys:DWHRSysRef[1]:CSARatedEff\n", DWHRSysRef[1]:CSARatedEff )
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Drain Water Recovery Efficiency,,%,DHWSys:DWHRSysRef[1]:CSARatedEff\n" )  endif  }
   "Write DHW Drain Water Recovery Efficiency - 2-6"     for:#HRS=(2to6)   DHWSys:Action  =
      {  if (IfValidAnd( NumDWHRSysRefs >= #HRS ) .AND. IfValidAnd( TotDWHRSysShowers > 0 ) .AND.
             FindInString( DWHRSysSummaryMsg, "ERROR" ) < 0 .AND. IfValidAnd( DWHRSysRef[#HRS]:CSARatedEff > 0 ))
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",Drain Water Recovery Efficiency - #HRS,%g,%,DHWSys:DWHRSysRef[#HRS]:CSARatedEff\n", DWHRSysRef[#HRS]:CSARatedEff )
         else  UNCHANGED  endif  }

; Proj screens
;	 CTRL, "SFamCompactDistrib",    30140, TDCT_Combo, 210, 215, 100, 200, 12, FNT_STD, "DHW Distribution Compactness:", TA_LEFT,  -190, 4,    0, TA_LEFT, 0, 0,  None,             IsMultiFamily < 1,     -192,  0,  "Compact distribution credit option"
;	 CTRL, "SFamCDDistMessage",     30143, TDCT_Label,  40, 243,  18, 710,  -1, FNT_STD, "",	                           TA_LEFT,   547, 0,    0, TA_LEFT, 0, 0,  None,             IsMultiFamily < 1 And SFamCompactDistrib > 0,    0,  0,  ""      
;	 CTRL, "SFamCmpctDistDescrip",  30142, TDCT_RTF,    60, 265, 130, 785,   0, FNT_STD, "",                             TA_LEFT,     0, 0,    0, TA_LEFT, 0, 0,  SFamCompactDistrib = -1,  IsMultiFamily < 1 And SFamCompactDistrib > 0,    0,  0,  "limits & restrictions on selected DHW Compact Distribution Credit"
;	 CTRL, "SFamUserCompactFactor", 30146, TDCT_Edit,   570, 215,  25,  50, 11, FNT_STD, "Compactness Factor:",             TA_RIGHT, -5, 4,   1, TA_LEFT, 4, 4,  SFamCompactDistrib = 2,  SFamCompactDistrib > 0 And SFamCDSpecFixDists < 1,    -155, 40,  "DHW distribution compactness factor simulated for all compatible DHW systems"
;    CTRL, "SFamCDSpecFixDists",    30145, TDCT_Check,  665, 217,  22, 185,  0, FNT_STD, "Specify Fixture Distances",       TA_LEFT,  0, 4,    0, TA_LEFT, 0, 0,  None,                    SFamCompactDistrib > 0,                                  0,  0,  "whether or not fixture distances are to be entered for each DHW system"   ; SAC 09/29/21 (tic #1277)

; DHWSys screens
;	 CTRL, "SystemType",         30104, TDCT_Combo, 185, 285, 500,  400, 12, FNT_STD, "Dwelling Unit Distribution:",        TA_LEFT, -165, 4,    0, TA_LEFT, 0, 0,  None,    None,       0,  0,  "The type of Water Heating system"
;
;	 CTRL, "TotShowersServed", 30108, TDCT_Edit,   270,  65,  25,  40,  0, FNT_STD, "Total showers served by this DHW system:", TA_LEFT, -250, 4,  0, TA_LEFT, 0, 0,  None,     CentralDHW < 1 And Proj:IsMultiFamily < 1,  -252,  0,  "The number of showers this DHWSys serves (for single dwelling units)"
;	 CTRL, "DWHRSysSummaryMsg",30109, TDCT_Label,   40,  95,  18, 550, -1, FNT_STD, "",                                   TA_LEFT,     0, 0,     0, TA_LEFT, 0, 0,  None,       None,	          0,  0,  ""      
;	 CTRL, "",		            30110, TDCT_Label,   20, 159,  18,   0, -1, FNT_STD, "Drain Water Heat Recovery System(s):",  TA_LEFT,   0, 0,     0, TA_LEFT, 0, 0,  None,       Proj:IsMultiFamily < 1,                        0,  0,  ""      
;	 CTRL, "",		            30111, TDCT_Label,  325, 141,  17,   0, -1, FNT_STD, "Shower",	                               TA_CENTER,   0, 0,     0, TA_LEFT, 0, 0,  None,       Proj:IsMultiFamily < 1 And NumDWHRSysRefs > 0,		0,  0,  ""      
;	 CTRL, "",		            30112, TDCT_Label,  325, 159,  18,   0, -1, FNT_STD, "Drains",	                               TA_CENTER,   0, 0,     0, TA_LEFT, 0, 0,  None,       Proj:IsMultiFamily < 1 And NumDWHRSysRefs > 0,		0,  0,  ""      
;	 CTRL, "",		           301111, TDCT_Label,  358, 123,  17,   0, -1, FNT_STD, "Warmed Water Feeds...",	                TA_LEFT,     0, 0,     0, TA_LEFT, 0, 0,  None,       Proj:IsMultiFamily < 1 And NumDWHRSysRefs > 0,		0,  0,  ""      
;	 CTRL, "",		           301121, TDCT_Label,  395, 141,  17,   0, -1, FNT_STD, "Showers",	                            TA_CENTER,   0, 0,     0, TA_LEFT, 0, 0,  None,       Proj:IsMultiFamily < 1 And NumDWHRSysRefs > 0,		0,  0,  ""      
;	 CTRL, "",		           301131, TDCT_Label,  395, 159,  18,   0, -1, FNT_STD, "(cold-side)",	                         TA_CENTER,   0, 0,     0, TA_LEFT, 0, 0,  None,       Proj:IsMultiFamily < 1 And NumDWHRSysRefs > 0,		0,  0,  ""      
;	 CTRL, "",		           301122, TDCT_Label,  460, 141,  18,   0, -1, FNT_STD, "Water",	                               TA_CENTER,   0, 0,     0, TA_LEFT, 0, 0,  None,       Proj:IsMultiFamily < 1 And NumDWHRSysRefs > 0,		0,  0,  ""      
;	 CTRL, "",		           301132, TDCT_Label,  460, 159,  18,   0, -1, FNT_STD, "Heater",	                               TA_CENTER,   0, 0,     0, TA_LEFT, 0, 0,  None,       Proj:IsMultiFamily < 1 And NumDWHRSysRefs > 0,		0,  0,  ""      
;	 CTRL, "DWHRSysRef[1]",       30115, TDCT_Combo,   35, 180, 350, 250, 12, FNT_STD, "1:",                                 TA_LEFT,   -15, 4,     0, TA_LEFT, 0, 0,  None,       Proj:IsMultiFamily < 1,                                                  -17,  0,  "Drain water heat recovery system assignment"
;	 CTRL, "DWHRSysShowers[1]",   30116, TDCT_Edit,   305, 180,  25,  40,  0, FNT_STD, "",          			                TA_LEFT,     0, 4,     0, TA_LEFT, 0, 0,  None,       Proj:IsMultiFamily < 1 And NumDWHRSysRefs > 0,                             0,  0,  "The number of DWHRSystems of this type and configuration"
;	 CTRL, "DWHRSysTakeCold[1]",  30117, TDCT_Edit,   375, 180,  25,  40,  0, FNT_STD, "",          			                TA_LEFT,     0, 4,     0, TA_LEFT, 0, 0,  None,       Proj:IsMultiFamily < 1 And NumDWHRSysRefs > 0 And DWHRSysShowers[1] > 0,   0,  0,  "Number of shower fixtures that take cold-side water via this DWHRSystem"
;	 CTRL, "DWHRSysFeedHeater[1]",30118, TDCT_Check,  452, 180,  22,  18,  2, FNT_STD, "",                                   TA_LEFT,     0, 4,     0, TA_LEFT, 0, 0,  None,       Proj:IsMultiFamily < 1 And NumDWHRSysRefs > 0 And DWHRSysShowers[1] > 0,   0,  0,  "Whether or not water heater cold-side feed water passes through this DWHRSystem"


   "Write DHWSys Heaters 1-6"    for:#Htr=(1to6)      DHWSys:Action  =
      {  if (CentralDHWTypeVal >= 2) then  UNCHANGED
         else if (NumDHWHeaters >= #Htr .AND. IfValidAnd( HeaterMult[#Htr] > 0 ) .AND.
                  LocalCompAssigned( DHWHeater[#Htr] ))
         then  if (IfValidAnd( DHWHeater[#Htr]:HeaterElementType = 5 ))
               then  EvalRulelist( "MxdFuelCmprReport_Inputs_DHWSys_HPWHtr#Htr", 1 )
               else if (IfValidAnd( DHWHeater[#Htr]:HeaterElementType = 1 ))
               then  EvalRulelist( "MxdFuelCmprReport_Inputs_DHWSys_GasHtr#Htr", 1 )
               else if (IfValidAnd( DHWHeater[#Htr]:HeaterElementType = 0 ))
               then  EvalRulelist( "MxdFuelCmprReport_Inputs_DHWSys_ElecHtr#Htr", 1 )
               else  UNCHANGED  endif endif endif
         else  UNCHANGED  endif endif  }

; DHWSys - DHWHeater assignment screens
;  	 CTRL, "",		            30221, TDCT_Label,   20, 489,  18,   0, -1, FNT_STD, "Water Heater(s):",             	      TA_LEFT,    0, 0,     0, TA_LEFT, 0, 0,  None,       CentralDHWTypeVal < 2,		0,  0,  ""      
;  	 CTRL, "",		            30208, TDCT_Label,  275, 489,  18, 200, -1, FNT_STD, "Count",	                              TA_CENTER,  0, 0,     0, TA_LEFT, 0, 0,  None,       CentralDHWTypeVal < 2,		0,  0,  ""      
;  	 CTRL, "DHWHeater[1]",     30109, TDCT_Combo,   35, 510, 350, 210, 12, FNT_STD, "1:",                                   TA_LEFT,  -15, 4,     0, TA_LEFT, 0, 0,  None,       CentralDHWTypeVal < 2,                           -17,  0,  ""
;  	 CTRL, "HeaterMult[1]",    30110, TDCT_Edit,   260, 510,  25,  30,  0, FNT_STD, "",          			                  TA_LEFT,    0, 4,     0, TA_LEFT, 0, 0,  None,       NumDHWHeaters > 0 And CentralDHWTypeVal < 2 And Proj:BypassRuleLimits < 1,       0,  0,  "The number of water heaters of this type"
;  	 CTRL, "HeaterMultFlt[1]", 30210, TDCT_Edit,   255, 510,  25,  40, 11, FNT_STD, "",          			                  TA_LEFT,    0, 4,     0, TA_LEFT, 0, 0,  None,       NumDHWHeaters > 0 And CentralDHWTypeVal < 2 And Proj:BypassRuleLimits > 0,       0,  0,  "The number of water heaters of this type (fractional)"
;  	 CTRL, "DHWHeater[2]",     30111, TDCT_Combo,   35, 540, 350, 210, 12, FNT_STD, "2:",                                   TA_LEFT,  -15, 4,     0, TA_LEFT, 0, 0,  None,       NumDHWHeaters > 0 And CentralDHWTypeVal < 2,     -17,  0,  ""
;    	 CTRL, "HeaterMult[2]",    30112, TDCT_Edit,   260, 540,  25,  30,  0, FNT_STD, "",         			                     TA_LEFT,    0, 4,     0, TA_LEFT, 0, 0,  None,       NumDHWHeaters > 1 And CentralDHWTypeVal < 2 And Proj:BypassRuleLimits < 1,       0,  0,  "The number of water heaters of this type"
;  	 CTRL, "HeaterMultFlt[2]", 30212, TDCT_Edit,   255, 540,  25,  40, 11, FNT_STD, "",          			                  TA_LEFT,    0, 4,     0, TA_LEFT, 0, 0,  None,       NumDHWHeaters > 1 And CentralDHWTypeVal < 2 And Proj:BypassRuleLimits > 0,       0,  0,  "The number of water heaters of this type (fractional)"
;  	 CTRL, "DHWHeater[3]",     30113, TDCT_Combo,   35, 570, 350, 210, 12, FNT_STD, "3:",                                   TA_LEFT,  -15, 4,     0, TA_LEFT, 0, 0,  None,       NumDHWHeaters > 1 And CentralDHWTypeVal < 2,     -17,  0,  ""
;    	 CTRL, "HeaterMult[3]",    30114, TDCT_Edit,   260, 570,  25,  30,  0, FNT_STD, "",         			                     TA_LEFT,    0, 4,     0, TA_LEFT, 0, 0,  None,       NumDHWHeaters > 2 And CentralDHWTypeVal < 2 And Proj:BypassRuleLimits < 1,       0,  0,  "The number of water heaters of this type"
;  	 CTRL, "HeaterMultFlt[3]", 30214, TDCT_Edit,   255, 570,  25,  40, 11, FNT_STD, "",          			                  TA_LEFT,    0, 4,     0, TA_LEFT, 0, 0,  None,       NumDHWHeaters > 2 And CentralDHWTypeVal < 2 And Proj:BypassRuleLimits > 0,       0,  0,  "The number of water heaters of this type (fractional)"

END
;************************************************************************* SAC 07/01/22
RULELIST "MxdFuelCmprReport_Inputs_DHWSys_HPWHtr1" 1 0 0 0

   "Write DHWSys:DHWHeater[1]:Name"          DHWSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, "DHW %g - HPWH Data,HPWH 1 - Name,%c%s%c,,DHWSys:DHWHeater[1]:Name\n", MxdFuelCmprCompIdx, 34, DHWHeater[1]:Name, 34 )  }
   "Write DHWSys:DHWHeater[1]:HPWHCategory"  DHWSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",HPWH 1 - Category,%c%s%c,,DHWSys:DHWHeater[1]:HPWHCategory\n", 34, EnumString( DHWHeater[1]:HPWHCategory ), 34 )  }
   "Write DHWSys:HeaterMult[1]"              DHWSys:Action  = {  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",HPWH 1 - Count,%g,,DHWSys:HeaterMult[1]\n", HeaterMult[1] )  }

   "Write DHWSys:DHWHeater[1]: Energy Factor"   DHWSys:Action  =
      {  if (DHWHeater[1]:HPWHCategory == 4 .AND. IfValidAnd( DHWHeater[1]:EnergyFactor > 0 ))   ; Non-UEF Rated
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",HPWH 1 - Energy Factor,%g,,DHWSys:DHWHeater[1]:EnergyFactor\n", DHWHeater[1]:EnergyFactor )
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",HPWH 1 - Energy Factor,,,DHWSys:DHWHeater[1]:EnergyFactor\n" )  endif  }
   "Write DHWSys:DHWHeater[1]: UEF"             DHWSys:Action  =
      {  if (DHWHeater[1]:HPWHCategory == 3 .AND. IfValidAnd( DHWHeater[1]:EnergyFactor > 0 ))   ; UEF Rated
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",HPWH 1 - UEF,%g,,DHWSys:DHWHeater[1]:EnergyFactor\n", DHWHeater[1]:EnergyFactor )
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",HPWH 1 - UEF,,,DHWSys:DHWHeater[1]:EnergyFactor\n" )  endif  }
   "Write DHWSys:DHWHeater[1]:TankVolume"       DHWSys:Action  =
      {  if (IfValidAnd( DHWHeater[1]:ShowTankVolume > 0 ) .AND. IfValidAnd( DHWHeater[1]:TankVolume > 0 )) 
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",HPWH 1 - Tank Volume,%g,gal,DHWSys:DHWHeater[1]:TankVolume\n", DHWHeater[1]:TankVolume )
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",HPWH 1 - Tank Volume,,gal,DHWSys:DHWHeater[1]:TankVolume\n" )  endif  }
   "Write DHWSys:DHWHeater[1]:FirstHourRating"  DHWSys:Action  =
      {  if ( (IfValidAnd( DHWHeater[1]:IsUEFHtPump = 1 ) .OR. IfValidAnd( DHWHeater[1]:HeaterType = 12 ) .OR. IfValidAnd( DHWHeater[1]:HeaterType = 14 )) .AND.
              IfValidAnd( DHWHeater[1]:FirstHourRating > 0 )) 
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",HPWH 1 - First Hour Rating,%g,gal,DHWSys:DHWHeater[1]:FirstHourRating\n", DHWHeater[1]:FirstHourRating )
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",HPWH 1 - First Hour Rating,,gal,DHWSys:DHWHeater[1]:FirstHourRating\n" )  endif  }
   "Write DHWSys:DHWHeater[1]:TankOutside"   DHWSys:Action  =
      {  if (IfValidAnd( DHWHeater[1]:ShowTankLocation > 0 )) 
         then  if (IfValidAnd( DHWHeater[1]:TankOutside > 0 ))
               then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",HPWH 1 - Tank Outside,Yes,,DHWSys:DHWHeater[1]:TankOutside\n" )
               else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",HPWH 1 - Tank Outside,No,,DHWSys:DHWHeater[1]:TankOutside\n" )  endif
         else        WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",HPWH 1 - Tank Outside,,,DHWSys:DHWHeater[1]:TankOutside\n" )  endif  }
   "Write DHWSys:DHWHeater[1]:TankZone"      DHWSys:Action  =
      {  if (IfValidAnd( DHWHeater[1]:ShowTankLocation > 0 ) .AND. IfValidAnd( DHWHeater[1]:TankOutside > 0 )==0 .AND.
             LocalCompAssigned( DHWHeater[1]:TankZone ) > 0) 
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",HPWH 1 - Location,%c%s%c,,DHWSys:DHWHeater[1]:TankZone\n", 34, DHWHeater[1]:TankZone:Name, 34 )
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",HPWH 1 - Location,,,DHWSys:DHWHeater[1]:TankZone\n" )  endif  }
   "Write DHWSys:DHWHeater[1]:HPWHBrand"     DHWSys:Action  =
      {  if ( IfValidAnd( DHWHeater[1]:HeaterElementType = 5 ) .AND. IfValidAnd( DHWHeater[1]:HPWH_NEEARated > 0 ) .AND.
              IfValidAnd( DHWHeater[1]:HPWHBrand > 0 )) 
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",HPWH 1 - NEEA Brand,%c%s%c,,DHWSys:DHWHeater[1]:HPWHBrand\n", 34, EnumString( DHWHeater[1]:HPWHBrand ), 34 )
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",HPWH 1 - NEEA Brand,,,DHWSys:DHWHeater[1]:HPWHBrand\n" )  endif  }
   "Write DHWSys:DHWHeater[1]:HPWHModel"     DHWSys:Action  =
      {  if ( IfValidAnd( DHWHeater[1]:HeaterElementType = 5 ) .AND. IfValidAnd( DHWHeater[1]:HPWH_NEEARated > 0 ) .AND.
              IfValidAnd( DHWHeater[1]:HPWHModel > 0 )) 
         then  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",HPWH 1 - NEEA Model,%c%s%c,,DHWSys:DHWHeater[1]:HPWHModel\n", 34, EnumString( DHWHeater[1]:HPWHModel ), 34 )
         else  WriteToExportFile( Proj:MxdFuelCmprInpFileIdx, ",HPWH 1 - NEEA Model,,,DHWSys:DHWHeater[1]:HPWHModel\n" )  endif  }

; screen
;    CTRL, "Name",              30203, TDCT_Edit,    70,  60,  25, 190, 99, FNT_STD, "Name:",                            TA_LEFT,  -50, 4,     0, TA_LEFT, 0, 0,  None,       None,                    0,  0,  "Name of this water heater"
;
;	 CTRL, "UserMsg",          302031, TDCT_Label,  280,  64,  20, 303, -1, FNT_BOLD, "",		                           TA_LEFT, -304, 0,     0, TA_LEFT, 0, 0,  None,       None,                    0,  0,  ""   ; SAC 02/02/21
;
;	 CTRL, "HeaterElementType", 30204, TDCT_Combo,  110,  90, 240, 150, 12, FNT_STD, "Heater Type:",                     TA_LEFT,  -90, 4,     0, TA_LEFT, 0, 0,  None,       None,                  -92,  0,  "Type of heating element"
;	 CTRL, "HPWHCategory",      30200, TDCT_Combo,   90, 120, 240, 170, 12, FNT_STD, "Category:",                        TA_LEFT,  -70, 4,     0, TA_LEFT, 0, 0,  None,       HeaterElementType = 5,       -72,  0,  "Type/category of HPWH"   ; SAC 02/01/21 (tic #1260)
;
;    CTRL, "HPWHBrand",         30225, TDCT_Combo,  445,  90, 400, 135, 12, FNT_STD, "NEEA HPWH Brand:",                 TA_LEFT, -135, 4,     0, TA_LEFT, 0, 0,  None,       HeaterElementType = 5 And HPWH_NEEARated > 0, -137,  0,  "Brand of heat pump water heater"
;    CTRL, "HPWHModel",         30231, TDCT_Combo,  355, 120, 400, 225, 12, FNT_STD, "Model:",                           TA_LEFT,  -45, 4,     0, TA_LEFT, 0, 0,  None,       HeaterElementType = 5 And HPWH_NEEARated > 0 And HPWHBrand > 1,  -47,  0,  "Model of heat pump water heater"
;    CTRL, "HPWHComModel",      30199, TDCT_Combo,  355, 150, 400, 225, 12, FNT_STD, "Model:",                           TA_LEFT,  -45, 4,     0, TA_LEFT, 0, 0,  None,       HeaterElementType = 5 And HPWH_ComProduct > 0,                   -47,  0,  "Model of commercial heat pump water heater"
;    CTRL, "TankType",          30205, TDCT_Combo,  110, 150, 240, 275, 12, FNT_STD, "Tank Type:",             	         TA_LEFT,  -90, 4,     0, TA_LEFT, 0, 0,  None,       HeaterElementType != 5,                        -92,  0,  "Type of water heating tank"
;
;	 CTRL, "NonStdTankVolume",	 31207, TDCT_Edit,   490, 180,  25,  60, 11, FNT_STD, "Non-Standard Tank Volume:",		   TA_LEFT, -180, 4,     1, TA_LEFT, 4, 4,  None,       HeaterElementType = 5 And HPWH_NEEARated > 0 And HPWHBrand = 22 And IsElecCentralHtr > 0,	 -182, 30,  ""    ; SAC 10/25/19
;
;	; SAC 11/10/15 - added new elec mini tank inputs
;    CTRL, "HasElecMiniTank",   30220, TDCT_Check,  350, 185,  22, 180,  0, FNT_STD, "Includes Electric Mini Tank",      TA_LEFT,    0, 4,     0, TA_LEFT, 0, 0,  None,       AllowElecMiniTank > 0,         0,  0,  "" 
;    CTRL, "ElecMiniTankPower", 30221, TDCT_Edit,   500, 210,  25,  60, 11, FNT_STD, "Tank Power (standby):",		      TA_LEFT, -140, 4,     1, TA_LEFT, 4, 4,  None,       AllowElecMiniTank > 0 And HasElecMiniTank > 0,   -142, 22,  ""
;
;  ; added to facilitate UEF-rated heaters (tic #801) - SAC 6/29/17
;	 CTRL, "EfficiencyLabel",  302061, TDCT_Label,   20, 184,  20, 138, -1, FNT_STD, "",		                           TA_LEFT,    0, 0,     0, TA_LEFT, 0, 0,  None,       ShowEnergyFactor > 0 Or HeaterType <= 3 Or HeaterType >= 10,  0,  0,  ""
;
;   ; Efficiency and Standby Loss fraction replace Energy Factor for Large Storage water heater 8/27/2013 dh  //  SAC 10/8/15 - added indirect
;    CTRL, "EnergyFactor",      30214, TDCT_Edit,   160, 180,  25,  75, 11, FNT_STD, "",	         		               TA_LEFT,   -1, 4,     1, TA_LEFT, 4, 4,  None,       HeaterType = 2 Or HeaterType = 3 Or HeaterType = 0 Or HeaterType = 1 Or HeaterType = 16,  -142,  0,  ""
;    CTRL, "StandbyLossFrac",   30213, TDCT_Edit,   470, 210,  25,  95, 11, FNT_STD, "Standby Loss Fraction:",		      TA_LEFT, -140, 4,     1, TA_LEFT, 4, 4,  None,       HeaterType = 3 Or HeaterType = 13,	                         -142,  0,  "Standby Loss fraction"
;    CTRL, "StandbyLossFrac",   30216, TDCT_Edit,   470, 210,  25,  95, 11, FNT_STD, "Pilot Energy (Btu/hr):",		      TA_LEFT, -140, 4,     1, TA_LEFT, 4, 4,  None,       PilotEnergyActive > 0,	                -142,  0,  "Pilot energy use (Btu/hr)"
;
;   ; Energy Factor irrelevant for unfired tanks 9/11/2013 dh  //  Energy Factor not needed with electric mini tanks 3/4/2014 dh  //  SAC 10/8/15 - removed for Indirect
;    CTRL, "EnergyFactor",      30206, TDCT_Edit,   160, 180,  25,  75, 11, FNT_STD, "",            		      	      TA_LEFT,   -1, 4,     1, TA_LEFT, 4, 4,  None,       ShowEnergyFactor > 0 Or HeaterType = 11 Or HeaterType = 13,      -142,  0,  ""
;
;   ; Input Rating irrelevant for Heat Pump and unfired tanks 9/11/2013 dh   - SAC 6/11/18 - removed for most TankTypes tic #940
;	 CTRL, "InputRating",       30209, TDCT_Edit,   160, 210,  25,  90, 11, FNT_STD, "Input Rating:",			            TA_LEFT, -140, 4,     1, TA_LEFT, 4, 4,  None,       ShowInputRating > 0,	-142,  0,  ""
;	 CTRL, "InputRatingUnits",  30210, TDCT_Label,  257, 214,  20,  50, -1, FNT_STD, "",				                     TA_LEFT,    0, 0,     0, TA_LEFT, 0, 0,  None,       ShowInputRating > 0,	   0,  0,  ""
;
;	 CTRL, "TankVolume",	       30207, TDCT_Edit,   160, 240,  25,  75, 11, FNT_STD, "Tank Volume:",		       	      TA_LEFT, -140, 4,     1, TA_LEFT, 4, 4,  TankVolumeEditable > 0,   ShowTankVolume > 0,	 -145, 30,  ""           
;
;   ; SAC 10/8/15 - added interior tank insulation and moved inputs to right of screen
;	 CTRL, "",                  31212, TDCT_Label,  330, 250,  18, 155, 12, FNT_STD, "Tank Insulation R-values:",        TA_LEFT,    0, 0,     0, TA_LEFT, 0, 0,  None,       HeaterType = 7 Or HeaterType = 1 Or HeaterType = 0 Or HeaterType = 16,    0,  0,  ""
;	 CTRL, "",                    994, TDCT_Line,   485, 258, 575, 258, -1, FNT_STD, "",                                 TA_CENTER,  0, 0,     0, TA_LEFT, 0, 0,  None,       HeaterType = 7 Or HeaterType = 1 Or HeaterType = 0 Or HeaterType = 16,    0,  0,  ""
;	; drh 10 December 2013 ExtInsRVal hidden for all except unfired & indirectly-fired tanks  //  SAC 10/8/15 - show for Boiler
;	 CTRL, "ExtInsulRVal",      30208, TDCT_Edit,   440, 270,  25,  65, 11, FNT_STD, "Exterior:",	                     TA_LEFT,  -60, 4,     1, TA_LEFT, 4, 4,  None,       HeaterType = 7 Or HeaterType = 1 Or HeaterType = 0 Or HeaterType = 16,  -62,  80,  ""
;	 CTRL, "IntInsulRVal",      30217, TDCT_Edit,   440, 300,  25,  65, 11, FNT_STD, "Interior:",	                     TA_LEFT,  -60, 4,     1, TA_LEFT, 4, 4,  None,       HeaterType = 7 Or HeaterType = 1 Or HeaterType = 0 Or HeaterType = 16,  -62,  80,  ""
;
;   ; SAC 10/18/17 - 2019 research
;	 CTRL, "StandbyLossMult",  302171, TDCT_Edit,   490, 300,  25,  45, 11, FNT_STD, "Standby Loss Mult:",	            TA_LEFT, -110, 4,     0, TA_LEFT, 4, 4,  None,       HeaterElementType = 5 And Proj:BypassRuleLimits > 0, -112,  0,  "DHW system standby loss multiplier (for simulating insulation blanket on HPWHs)"
;	 CTRL, "StandbyLossMult",  302172, TDCT_Edit,   490, 300,  25,  45, 11, FNT_STD, "Standby Loss Mult:",	            TA_LEFT, -110, 4,     0, TA_LEFT, 4, 4,  None,       HeaterElementType = 0 And ShowTankLocation > 0.5 And Proj:BypassRuleLimits > 0, -112,  0,  "DHW system standby loss multiplier (for simulating insulation blanket on ResX WHs)"
;
;   ; Ambient Conditions for unfired & indirectly-fired tanks 9/12/2013 dh
;	 CTRL, "AmbientCond",       30215, TDCT_Combo,  160, 270, 200, 135, 12, FNT_STD, "Ambient Conditions:",              TA_LEFT, -140, 4,     0, TA_LEFT, 0, 0,  None,       HeaterType =7 Or HeaterType =1,        -142,  0,  "Tank location"
;
;   ; 2016 UEF-rated modeled using EF - SAC 6/29/17
;      ;  10, "Consumer Instantaneous (UEF)"  /  11, "Commercial Instantaneous (TE)"  /  12, "Consumer Storage (UEF)"  /  13, "Commercial Storage (TE & SBL)"  /  14, "Residential-Duty Commercial Storage (UEF)"  /  15, "Residential-Duty Commercial Instantaneous (UEF)"
;	 CTRL, "RatedFlow",         30251, TDCT_Edit,   160, 270,  25,  75, 11, FNT_STD, "Flow Rate:",                       TA_LEFT, -140, 4,     1, TA_LEFT, 4, 4,  None,       HeaterType = 10 Or HeaterType = 15,    -142,  40,  ""  ; max gpm at 67 F temp rise (required)"  ?? valid for UEF ??
;	 CTRL, "FirstHourRating",   30252, TDCT_Edit,   160, 270,  25,  75, 11, FNT_STD, "First Hour Rating:",               TA_LEFT, -140, 4,     1, TA_LEFT, 4, 4,  None,       IsUEFHtPump = 1 Or HeaterType = 12 Or HeaterType = 14,    -142,  40,  "" 
; 	 CTRL, "RecovEffLabel",     30255, TDCT_Label,   20, 304,  20, 138, -1, FNT_STD, "",				                     TA_LEFT,    0, 0,     0, TA_LEFT, 0, 0,  None,       DispUEFRecovEff > 0,         0,   0,  "" 
;	 CTRL, "RecovEff",          30253, TDCT_Edit,   160, 300,  25,  75, 11, FNT_STD, "",                                 TA_LEFT,   -1, 4,     1, TA_LEFT, 4, 4,  None,       DispUEFRecovEff > 0,      -142,  40,  ""
;
;   ; UEF-rated Instantaneous - SAC 5/26/17   - SAC 3/1/18 revised to hide unless BypassRuleLimits (tic #993)
;	 CTRL, "RatedFlow",         30241, TDCT_Edit,   160, 210,  25,  75, 11, FNT_STD, "Rated Flow:",                      TA_LEFT, -140, 4,     1, TA_LEFT, 4, 4,  None,       HeaterType = 9 And Proj:BypassRuleLimits > 0,   -142,  40,  "max gpm at 67 F temp rise (required)"
;	 CTRL, "AnnFuelUse",        30242, TDCT_Edit,   160, 240,  25,  75, 11, FNT_STD, "Annual Fuel Use:",                 TA_LEFT, -140, 4,     1, TA_LEFT, 4, 4,  None,       HeaterType = 9 And Proj:BypassRuleLimits > 0,   -142,  60,  "'yellow label' annual fuel use (required)"
;	 CTRL, "AnnElecUse",        30243, TDCT_Edit,   160, 270,  25,  75, 11, FNT_STD, "Ann Electric Use:",                TA_LEFT, -140, 4,     1, TA_LEFT, 4, 4,  None,       HeaterType = 9 And Proj:BypassRuleLimits > 0,   -142,  40,  "'yellow label' annual electric use (required)"
;	 CTRL, "StandbyElec",       30244, TDCT_Edit,   160, 300,  25,  75, 11, FNT_STD, "Standby Elec Power:",              TA_LEFT, -140, 4,     1, TA_LEFT, 4, 4,  None,       HeaterType = 9 And Proj:BypassRuleLimits > 0,   -142,  40,  "standby power (optional, default 4)"
;
;	 CTRL, "RecovEff",          30211, TDCT_Edit,   160, 390,  25,  75, 11, FNT_STD, "Recovery Efficiency:",			      TA_LEFT, -140, 4,     1, TA_LEFT, 4, 4,  None,        CanBeCHWHeater > 0 And HeaterType != 8 And HeaterType < 9 And HeaterElementType != 5,	-142, 30,  ""           
;	 CTRL, "",                  32212, TDCT_Label,  272, 394,  20, 300, 12, FNT_STD, "(only needed for Hydronic Space Heating)",	TA_LEFT,  0, 0,   0, TA_LEFT, 0, 0,  None,  CanBeCHWHeater > 0 And HeaterType != 8 And HeaterType < 9 And HeaterElementType != 5,  -200,  0,  ""
;
;	; SAC 3/19/16 - detailed HPWH model inputs
;    CTRL, "TankOutside",       30226, TDCT_Check,   20, 332,  22, 225,  0, FNT_STD, "Tank Outside or in Exterior Closet",  TA_LEFT,    0, 4,     0, TA_LEFT, 0, 0,  None,       ShowTankLocation > 0,                        0,  0,  "Tank located outside or in an exterior closet?" 
;	 CTRL, "TankZone",          30227, TDCT_Combo,  310, 330, 400, 180, 12, FNT_STD, "Location:",                           TA_RIGHT,  -5, 4,     0, TA_LEFT, 0, 0,  None,       ShowTankLocation > 0 And TankOutside < 1,  -62,  0,  "Location of tank"
;    CTRL, "ASHPTSrcOutside",   30228, TDCT_Check,   20, 362,  22, 145,  0, FNT_STD, "Compressor Outside",                  TA_LEFT,    0, 4,     0, TA_LEFT, 0, 0,  None,       HeaterElementType = 5 And ASHPType > 0 And ASHPSplit > 0,    0,  0,  "Compressor air source outside?" 
;	 CTRL, "ASHPTSrcZone",      30229, TDCT_Combo,  230, 360, 400, 180, 12, FNT_STD, "Location:",                           TA_RIGHT,  -5, 4,     0, TA_LEFT, 0, 0,  None,       HeaterElementType = 5 And ASHPType > 0 And ASHPSplit > 0 And ASHPTSrcOutside < 1,  -62,  0,  "Location of compressor (air source)"

END
;*************************************************************************





;************************************************************************* SAC 06/29/22
RULELIST "MxdFuelCmprReport_Results_Total" 1 0 0 0
   "Write Proj:RunResults[11]:PropElecEnergy[1]"   Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, "Total Energy Data,Proposed - Total Electric,%g,kWh,Proj:RunResults[11]:PropElecEnergy[1]\n", ValidOr( RunResults[11]:PropElecEnergy[1], 0 ) * ValidOr( CondFloorArea, 0 ) / 3.412 )  }
   "Write Proj:RunResults[11]:PropElecDemand[1]"   Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total Demand,%g,kW,Proj:RunResults[11]:PropElecDemand[1]\n", ValidOr( RunResults[11]:PropElecDemand[1], 0 ) )  }
   "Write Proj:RunResults[11]:PropNatGasEnergy[1]" Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total Fuel,%g,therms,Proj:RunResults[11]:PropNatGasEnergy[1]\n", (ValidOr( RunResults[11]:PropNatGasEnergy[1], 0 ) + ValidOr( RunResults[11]:PropOtherEnergy[1], 0 )) * ValidOr( CondFloorArea, 0 ) / 100 )  }
   "Write Proj:RunResults[11]:ProposedTDV[1]"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total TDV,%g,kTDV/ft2-yr,Proj:RunResults[11]:ProposedTDV[1]\n", ValidOr( RunResults[11]:ProposedTDV[1], 0 ) )  }
   "Write Proj:RunResults[11]:PropTotalCarbon[1]"  Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total CO2,%g,kg,Proj:RunResults[11]:PropTotalCarbon[1]\n", ValidOr( RunResults[11]:PropTotalCarbon[1], 0 ) * ValidOr( CondFloorArea, 0 ) * 1000 )  }
   "Write Proj:RunResults[11]:StdElecEnergy"       Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - Total Electric,%g,kWh,Proj:RunResults[11]:StdElecEnergy\n", ValidOr( RunResults[11]:StdElecEnergy, 0 ) * ValidOr( CondFloorArea, 0 ) / 3.412 )  }
   "Write Proj:RunResults[11]:StdElecDemand"       Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - Total Demand,%g,kW,Proj:RunResults[11]:StdElecDemand\n", ValidOr( RunResults[11]:StdElecDemand, 0 ) )  }
   "Write Proj:RunResults[11]:StdNatGasEnergy"     Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - Total Fuel,%g,therms,Proj:RunResults[11]:StdNatGasEnergy\n", (ValidOr( RunResults[11]:StdNatGasEnergy, 0 ) + ValidOr( RunResults[11]:StdOtherEnergy, 0 )) * ValidOr( CondFloorArea, 0 ) / 100 )  }
   "Write Proj:RunResults[11]:StandardTDV"         Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - Total TDV,%g,kTDV/ft2-yr,Proj:RunResults[11]:StandardTDV\n", ValidOr( RunResults[11]:StandardTDV, 0 ) )  }
   "Write Proj:RunResults[11]:StdTotalCarbon"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - Total CO2,%g,kg,Proj:RunResults[11]:StdTotalCarbon\n", ValidOr( RunResults[11]:StdTotalCarbon, 0 ) * ValidOr( CondFloorArea, 0 ) * 1000 )  }
   "Write Proj:RunResults[11]: ElecEnergy margin"  Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Margin - Total Electric,%g,kWh,\n",  (ValidOr( RunResults[11]:StdElecEnergy, 0 ) - ValidOr( RunResults[11]:PropElecEnergy[1], 0 )) * ValidOr( CondFloorArea, 0 ) / 3.412 )  }
   "Write Proj:RunResults[11]: Demand margin"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Margin - Total Demand,%g,kW,\n",     (ValidOr( RunResults[11]:StdElecDemand, 0 ) - ValidOr( RunResults[11]:PropElecDemand[1], 0 )) )  }
   "Write Proj:RunResults[11]: FuelEnergy margin"  Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Margin - Total Fuel,%g,therms,\n",   (ValidOr( RunResults[11]:StdNatGasEnergy, 0 ) + ValidOr( RunResults[11]:StdOtherEnergy, 0 ) - ValidOr( RunResults[11]:PropNatGasEnergy[1], 0 ) - ValidOr( RunResults[11]:PropOtherEnergy[1], 0 )) * ValidOr( CondFloorArea, 0 ) / 100 )  }
   "Write Proj:RunResults[11]: TDV margin"         Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Margin - Total TDV,%g,kTDV/ft2-yr,\n", (ValidOr( RunResults[11]:StandardTDV, 0 ) - ValidOr( RunResults[11]:ProposedTDV[1], 0 )) )  }
   "Write Proj:RunResults[11]: Carbon margin"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Margin - Total CO2,%g,kg,\n",        (ValidOr( RunResults[11]:StdTotalCarbon, 0 ) - ValidOr( RunResults[11]:PropTotalCarbon[1], 0 )) * ValidOr( CondFloorArea, 0 ) * 1000 )  }
END
;************************************************************************* 1
RULELIST "MxdFuelCmprReport_Results_SpcHtg" 1 0 0 0
   "Write Proj:RunResults[1]:PropElecEnergy[1]"   Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, "Space Heating Energy Data,Proposed - Total Electric,%g,kWh,Proj:RunResults[1]:PropElecEnergy[1]\n", ValidOr( RunResults[1]:PropElecEnergy[1], 0 ) * ValidOr( CondFloorArea, 0 ) / 3.412 )  }
   "Write Proj:RunResults[1]:PropElecDemand[1]"   Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total Demand,%g,kW,Proj:RunResults[1]:PropElecDemand[1]\n", ValidOr( RunResults[1]:PropElecDemand[1], 0 ) )  }
   "Write Proj:RunResults[1]:PropNatGasEnergy[1]" Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total Fuel,%g,therms,Proj:RunResults[1]:PropNatGasEnergy[1]\n", (ValidOr( RunResults[1]:PropNatGasEnergy[1], 0 ) + ValidOr( RunResults[1]:PropOtherEnergy[1], 0 )) * ValidOr( CondFloorArea, 0 ) / 100 )  }
   "Write Proj:RunResults[1]:ProposedTDV[1]"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total TDV,%g,kTDV/ft2-yr,Proj:RunResults[1]:ProposedTDV[1]\n", ValidOr( RunResults[1]:ProposedTDV[1], 0 ) )  }
   "Write Proj:RunResults[1]:PropTotalCarbon[1]"  Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total CO2,%g,kg,Proj:RunResults[1]:PropTotalCarbon[1]\n", ValidOr( RunResults[1]:PropTotalCarbon[1], 0 ) * ValidOr( CondFloorArea, 0 ) * 1000 )  }
   "Write Proj:RunResults[1]:StdElecEnergy"       Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - Total Electric,%g,kWh,Proj:RunResults[1]:StdElecEnergy\n", ValidOr( RunResults[1]:StdElecEnergy, 0 ) * ValidOr( CondFloorArea, 0 ) / 3.412 )  }
   "Write Proj:RunResults[1]:StdElecDemand"       Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - Total Demand,%g,kW,Proj:RunResults[1]:StdElecDemand\n", ValidOr( RunResults[1]:StdElecDemand, 0 ) )  }
   "Write Proj:RunResults[1]:StdNatGasEnergy"     Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - Total Fuel,%g,therms,Proj:RunResults[1]:StdNatGasEnergy\n", (ValidOr( RunResults[1]:StdNatGasEnergy, 0 ) + ValidOr( RunResults[1]:StdOtherEnergy, 0 )) * ValidOr( CondFloorArea, 0 ) / 100 )  }
   "Write Proj:RunResults[1]:StandardTDV"         Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - Total TDV,%g,kTDV/ft2-yr,Proj:RunResults[1]:StandardTDV\n", ValidOr( RunResults[1]:StandardTDV, 0 ) )  }
   "Write Proj:RunResults[1]:StdTotalCarbon"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - Total CO2,%g,kg,Proj:RunResults[1]:StdTotalCarbon\n", ValidOr( RunResults[1]:StdTotalCarbon, 0 ) * ValidOr( CondFloorArea, 0 ) * 1000 )  }
   "Write Proj:RunResults[1]: ElecEnergy margin"  Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Margin - Total Electric,%g,kWh,\n",  (ValidOr( RunResults[1]:StdElecEnergy, 0 ) - ValidOr( RunResults[1]:PropElecEnergy[1], 0 )) * ValidOr( CondFloorArea, 0 ) / 3.412 )  }
   "Write Proj:RunResults[1]: Demand margin"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Margin - Total Demand,%g,kW,\n",     (ValidOr( RunResults[1]:StdElecDemand, 0 ) - ValidOr( RunResults[1]:PropElecDemand[1], 0 )) )  }
   "Write Proj:RunResults[1]: FuelEnergy margin"  Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Margin - Total Fuel,%g,therms,\n",   (ValidOr( RunResults[1]:StdNatGasEnergy, 0 ) + ValidOr( RunResults[1]:StdOtherEnergy, 0 ) - ValidOr( RunResults[1]:PropNatGasEnergy[1], 0 ) - ValidOr( RunResults[1]:PropOtherEnergy[1], 0 )) * ValidOr( CondFloorArea, 0 ) / 100 )  }
   "Write Proj:RunResults[1]: TDV margin"         Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Margin - Total TDV,%g,kTDV/ft2-yr,\n", (ValidOr( RunResults[1]:StandardTDV, 0 ) - ValidOr( RunResults[1]:ProposedTDV[1], 0 )) )  }
   "Write Proj:RunResults[1]: Carbon margin"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Margin - Total CO2,%g,kg,\n",        (ValidOr( RunResults[1]:StdTotalCarbon, 0 ) - ValidOr( RunResults[1]:PropTotalCarbon[1], 0 )) * ValidOr( CondFloorArea, 0 ) * 1000 )  }
END
;************************************************************************* 2
RULELIST "MxdFuelCmprReport_Results_SpcClg" 1 0 0 0
   "Write Proj:RunResults[2]:PropElecEnergy[1]"   Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, "Space Cooling Energy Data,Proposed - Total Electric,%g,kWh,Proj:RunResults[2]:PropElecEnergy[1]\n", ValidOr( RunResults[2]:PropElecEnergy[1], 0 ) * ValidOr( CondFloorArea, 0 ) / 3.412 )  }
   "Write Proj:RunResults[2]:PropElecDemand[1]"   Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total Demand,%g,kW,Proj:RunResults[2]:PropElecDemand[1]\n", ValidOr( RunResults[2]:PropElecDemand[1], 0 ) )  }
   "Write Proj:RunResults[2]:PropNatGasEnergy[1]" Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total Fuel,%g,therms,Proj:RunResults[2]:PropNatGasEnergy[1]\n", (ValidOr( RunResults[2]:PropNatGasEnergy[1], 0 ) + ValidOr( RunResults[2]:PropOtherEnergy[1], 0 )) * ValidOr( CondFloorArea, 0 ) / 100 )  }
   "Write Proj:RunResults[2]:ProposedTDV[1]"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total TDV,%g,kTDV/ft2-yr,Proj:RunResults[2]:ProposedTDV[1]\n", ValidOr( RunResults[2]:ProposedTDV[1], 0 ) )  }
   "Write Proj:RunResults[2]:PropTotalCarbon[1]"  Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total CO2,%g,kg,Proj:RunResults[2]:PropTotalCarbon[1]\n", ValidOr( RunResults[2]:PropTotalCarbon[1], 0 ) * ValidOr( CondFloorArea, 0 ) * 1000 )  }
   "Write Proj:RunResults[2]:StdElecEnergy"       Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - Total Electric,%g,kWh,Proj:RunResults[2]:StdElecEnergy\n", ValidOr( RunResults[2]:StdElecEnergy, 0 ) * ValidOr( CondFloorArea, 0 ) / 3.412 )  }
   "Write Proj:RunResults[2]:StdElecDemand"       Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - Total Demand,%g,kW,Proj:RunResults[2]:StdElecDemand\n", ValidOr( RunResults[2]:StdElecDemand, 0 ) )  }
   "Write Proj:RunResults[2]:StdNatGasEnergy"     Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - Total Fuel,%g,therms,Proj:RunResults[2]:StdNatGasEnergy\n", (ValidOr( RunResults[2]:StdNatGasEnergy, 0 ) + ValidOr( RunResults[2]:StdOtherEnergy, 0 )) * ValidOr( CondFloorArea, 0 ) / 100 )  }
   "Write Proj:RunResults[2]:StandardTDV"         Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - Total TDV,%g,kTDV/ft2-yr,Proj:RunResults[2]:StandardTDV\n", ValidOr( RunResults[2]:StandardTDV, 0 ) )  }
   "Write Proj:RunResults[2]:StdTotalCarbon"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - Total CO2,%g,kg,Proj:RunResults[2]:StdTotalCarbon\n", ValidOr( RunResults[2]:StdTotalCarbon, 0 ) * ValidOr( CondFloorArea, 0 ) * 1000 )  }
   "Write Proj:RunResults[2]: ElecEnergy margin"  Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Margin - Total Electric,%g,kWh,\n",  (ValidOr( RunResults[2]:StdElecEnergy, 0 ) - ValidOr( RunResults[2]:PropElecEnergy[1], 0 )) * ValidOr( CondFloorArea, 0 ) / 3.412 )  }
   "Write Proj:RunResults[2]: Demand margin"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Margin - Total Demand,%g,kW,\n",     (ValidOr( RunResults[2]:StdElecDemand, 0 ) - ValidOr( RunResults[2]:PropElecDemand[1], 0 )) )  }
   "Write Proj:RunResults[2]: FuelEnergy margin"  Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Margin - Total Fuel,%g,therms,\n",   (ValidOr( RunResults[2]:StdNatGasEnergy, 0 ) + ValidOr( RunResults[2]:StdOtherEnergy, 0 ) - ValidOr( RunResults[2]:PropNatGasEnergy[1], 0 ) - ValidOr( RunResults[2]:PropOtherEnergy[1], 0 )) * ValidOr( CondFloorArea, 0 ) / 100 )  }
   "Write Proj:RunResults[2]: TDV margin"         Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Margin - Total TDV,%g,kTDV/ft2-yr,\n", (ValidOr( RunResults[2]:StandardTDV, 0 ) - ValidOr( RunResults[2]:ProposedTDV[1], 0 )) )  }
   "Write Proj:RunResults[2]: Carbon margin"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Margin - Total CO2,%g,kg,\n",        (ValidOr( RunResults[2]:StdTotalCarbon, 0 ) - ValidOr( RunResults[2]:PropTotalCarbon[1], 0 )) * ValidOr( CondFloorArea, 0 ) * 1000 )  }
END
;************************************************************************* 3
RULELIST "MxdFuelCmprReport_Results_IAQ" 1 0 0 0
   "Write Proj:RunResults[3]:PropElecEnergy[1]"   Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, "IAQ Energy Data,Proposed - Total Electric,%g,kWh,Proj:RunResults[3]:PropElecEnergy[1]\n", ValidOr( RunResults[3]:PropElecEnergy[1], 0 ) * ValidOr( CondFloorArea, 0 ) / 3.412 )  }
   "Write Proj:RunResults[3]:PropElecDemand[1]"   Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total Demand,%g,kW,Proj:RunResults[3]:PropElecDemand[1]\n", ValidOr( RunResults[3]:PropElecDemand[1], 0 ) )  }
   "Write Proj:RunResults[3]:PropNatGasEnergy[1]" Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total Fuel,%g,therms,Proj:RunResults[3]:PropNatGasEnergy[1]\n", (ValidOr( RunResults[3]:PropNatGasEnergy[1], 0 ) + ValidOr( RunResults[3]:PropOtherEnergy[1], 0 )) * ValidOr( CondFloorArea, 0 ) / 100 )  }
   "Write Proj:RunResults[3]:ProposedTDV[1]"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total TDV,%g,kTDV/ft2-yr,Proj:RunResults[3]:ProposedTDV[1]\n", ValidOr( RunResults[3]:ProposedTDV[1], 0 ) )  }
   "Write Proj:RunResults[3]:PropTotalCarbon[1]"  Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total CO2,%g,kg,Proj:RunResults[3]:PropTotalCarbon[1]\n", ValidOr( RunResults[3]:PropTotalCarbon[1], 0 ) * ValidOr( CondFloorArea, 0 ) * 1000 )  }
   "Write Proj:RunResults[3]:StdElecEnergy"       Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - Total Electric,%g,kWh,Proj:RunResults[3]:StdElecEnergy\n", ValidOr( RunResults[3]:StdElecEnergy, 0 ) * ValidOr( CondFloorArea, 0 ) / 3.412 )  }
   "Write Proj:RunResults[3]:StdElecDemand"       Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - Total Demand,%g,kW,Proj:RunResults[3]:StdElecDemand\n", ValidOr( RunResults[3]:StdElecDemand, 0 ) )  }
   "Write Proj:RunResults[3]:StdNatGasEnergy"     Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - Total Fuel,%g,therms,Proj:RunResults[3]:StdNatGasEnergy\n", (ValidOr( RunResults[3]:StdNatGasEnergy, 0 ) + ValidOr( RunResults[3]:StdOtherEnergy, 0 )) * ValidOr( CondFloorArea, 0 ) / 100 )  }
   "Write Proj:RunResults[3]:StandardTDV"         Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - Total TDV,%g,kTDV/ft2-yr,Proj:RunResults[3]:StandardTDV\n", ValidOr( RunResults[3]:StandardTDV, 0 ) )  }
   "Write Proj:RunResults[3]:StdTotalCarbon"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - Total CO2,%g,kg,Proj:RunResults[3]:StdTotalCarbon\n", ValidOr( RunResults[3]:StdTotalCarbon, 0 ) * ValidOr( CondFloorArea, 0 ) * 1000 )  }
   "Write Proj:RunResults[3]: ElecEnergy margin"  Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Margin - Total Electric,%g,kWh,\n",  (ValidOr( RunResults[3]:StdElecEnergy, 0 ) - ValidOr( RunResults[3]:PropElecEnergy[1], 0 )) * ValidOr( CondFloorArea, 0 ) / 3.412 )  }
   "Write Proj:RunResults[3]: Demand margin"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Margin - Total Demand,%g,kW,\n",     (ValidOr( RunResults[3]:StdElecDemand, 0 ) - ValidOr( RunResults[3]:PropElecDemand[1], 0 )) )  }
   "Write Proj:RunResults[3]: FuelEnergy margin"  Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Margin - Total Fuel,%g,therms,\n",   (ValidOr( RunResults[3]:StdNatGasEnergy, 0 ) + ValidOr( RunResults[3]:StdOtherEnergy, 0 ) - ValidOr( RunResults[3]:PropNatGasEnergy[1], 0 ) - ValidOr( RunResults[3]:PropOtherEnergy[1], 0 )) * ValidOr( CondFloorArea, 0 ) / 100 )  }
   "Write Proj:RunResults[3]: TDV margin"         Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Margin - Total TDV,%g,kTDV/ft2-yr,\n", (ValidOr( RunResults[3]:StandardTDV, 0 ) - ValidOr( RunResults[3]:ProposedTDV[1], 0 )) )  }
   "Write Proj:RunResults[3]: Carbon margin"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Margin - Total CO2,%g,kg,\n",        (ValidOr( RunResults[3]:StdTotalCarbon, 0 ) - ValidOr( RunResults[3]:PropTotalCarbon[1], 0 )) * ValidOr( CondFloorArea, 0 ) * 1000 )  }
END
;************************************************************************* 5
RULELIST "MxdFuelCmprReport_Results_WtrHtg" 1 0 0 0
   "Write Proj:RunResults[5]:PropElecEnergy[1]"   Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, "Water Heating Energy Data,Proposed - Total Electric,%g,kWh,Proj:RunResults[5]:PropElecEnergy[1]\n", ValidOr( RunResults[5]:PropElecEnergy[1], 0 ) * ValidOr( CondFloorArea, 0 ) / 3.412 )  }
   "Write Proj:RunResults[5]:PropElecDemand[1]"   Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total Demand,%g,kW,Proj:RunResults[5]:PropElecDemand[1]\n", ValidOr( RunResults[5]:PropElecDemand[1], 0 ) )  }
   "Write Proj:RunResults[5]:PropNatGasEnergy[1]" Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total Fuel,%g,therms,Proj:RunResults[5]:PropNatGasEnergy[1]\n", (ValidOr( RunResults[5]:PropNatGasEnergy[1], 0 ) + ValidOr( RunResults[5]:PropOtherEnergy[1], 0 )) * ValidOr( CondFloorArea, 0 ) / 100 )  }
   "Write Proj:RunResults[5]:ProposedTDV[1]"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total TDV,%g,kTDV/ft2-yr,Proj:RunResults[5]:ProposedTDV[1]\n", ValidOr( RunResults[5]:ProposedTDV[1], 0 ) )  }
   "Write Proj:RunResults[5]:PropTotalCarbon[1]"  Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total CO2,%g,kg,Proj:RunResults[5]:PropTotalCarbon[1]\n", ValidOr( RunResults[5]:PropTotalCarbon[1], 0 ) * ValidOr( CondFloorArea, 0 ) * 1000 )  }
   "Write Proj:RunResults[5]:StdElecEnergy"       Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - Total Electric,%g,kWh,Proj:RunResults[5]:StdElecEnergy\n", ValidOr( RunResults[5]:StdElecEnergy, 0 ) * ValidOr( CondFloorArea, 0 ) / 3.412 )  }
   "Write Proj:RunResults[5]:StdElecDemand"       Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - Total Demand,%g,kW,Proj:RunResults[5]:StdElecDemand\n", ValidOr( RunResults[5]:StdElecDemand, 0 ) )  }
   "Write Proj:RunResults[5]:StdNatGasEnergy"     Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - Total Fuel,%g,therms,Proj:RunResults[5]:StdNatGasEnergy\n", (ValidOr( RunResults[5]:StdNatGasEnergy, 0 ) + ValidOr( RunResults[5]:StdOtherEnergy, 0 )) * ValidOr( CondFloorArea, 0 ) / 100 )  }
   "Write Proj:RunResults[5]:StandardTDV"         Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - Total TDV,%g,kTDV/ft2-yr,Proj:RunResults[5]:StandardTDV\n", ValidOr( RunResults[5]:StandardTDV, 0 ) )  }
   "Write Proj:RunResults[5]:StdTotalCarbon"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - Total CO2,%g,kg,Proj:RunResults[5]:StdTotalCarbon\n", ValidOr( RunResults[5]:StdTotalCarbon, 0 ) * ValidOr( CondFloorArea, 0 ) * 1000 )  }
   "Write Proj:RunResults[5]: ElecEnergy margin"  Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Margin - Total Electric,%g,kWh,\n",  (ValidOr( RunResults[5]:StdElecEnergy, 0 ) - ValidOr( RunResults[5]:PropElecEnergy[1], 0 )) * ValidOr( CondFloorArea, 0 ) / 3.412 )  }
   "Write Proj:RunResults[5]: Demand margin"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Margin - Total Demand,%g,kW,\n",     (ValidOr( RunResults[5]:StdElecDemand, 0 ) - ValidOr( RunResults[5]:PropElecDemand[1], 0 )) )  }
   "Write Proj:RunResults[5]: FuelEnergy margin"  Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Margin - Total Fuel,%g,therms,\n",   (ValidOr( RunResults[5]:StdNatGasEnergy, 0 ) + ValidOr( RunResults[5]:StdOtherEnergy, 0 ) - ValidOr( RunResults[5]:PropNatGasEnergy[1], 0 ) - ValidOr( RunResults[5]:PropOtherEnergy[1], 0 )) * ValidOr( CondFloorArea, 0 ) / 100 )  }
   "Write Proj:RunResults[5]: TDV margin"         Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Margin - Total TDV,%g,kTDV/ft2-yr,\n", (ValidOr( RunResults[5]:StandardTDV, 0 ) - ValidOr( RunResults[5]:ProposedTDV[1], 0 )) )  }
   "Write Proj:RunResults[5]: Carbon margin"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Margin - Total CO2,%g,kg,\n",        (ValidOr( RunResults[5]:StdTotalCarbon, 0 ) - ValidOr( RunResults[5]:PropTotalCarbon[1], 0 )) * ValidOr( CondFloorArea, 0 ) * 1000 )  }
END
;************************************************************************* 6
RULELIST "MxdFuelCmprReport_Results_IntLtg" 1 0 0 0
   "Write Proj:RunResults[6]:PropElecEnergy[1]"   Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, "Interior Lighting Energy Data,Proposed - Total Electric,%g,kWh,Proj:RunResults[6]:PropElecEnergy[1]\n", ValidOr( RunResults[6]:PropElecEnergy[1], 0 ) * ValidOr( CondFloorArea, 0 ) / 3.412 )  }
   "Write Proj:RunResults[6]:PropElecDemand[1]"   Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total Demand,%g,kW,Proj:RunResults[6]:PropElecDemand[1]\n", ValidOr( RunResults[6]:PropElecDemand[1], 0 ) )  }
   "Write Proj:RunResults[6]:ProposedTDV[1]"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total TDV,%g,kTDV/ft2-yr,Proj:RunResults[6]:ProposedTDV[1]\n", ValidOr( RunResults[6]:ProposedTDV[1], 0 ) )  }
   "Write Proj:RunResults[6]:PropTotalCarbon[1]"  Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total CO2,%g,kg,Proj:RunResults[6]:PropTotalCarbon[1]\n", ValidOr( RunResults[6]:PropTotalCarbon[1], 0 ) * ValidOr( CondFloorArea, 0 ) * 1000 )  }
END
;************************************************************************* 7
RULELIST "MxdFuelCmprReport_Results_Appl" 1 0 0 0
   "Write Proj:RunResults[7]:PropElecEnergy[1]"   Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, "Appl. & Cooking Energy Data,Proposed - Total Electric,%g,kWh,Proj:RunResults[7]:PropElecEnergy[1]\n", ValidOr( RunResults[7]:PropElecEnergy[1], 0 ) * ValidOr( CondFloorArea, 0 ) / 3.412 )  }
   "Write Proj:RunResults[7]:PropElecDemand[1]"   Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total Demand,%g,kW,Proj:RunResults[7]:PropElecDemand[1]\n", ValidOr( RunResults[7]:PropElecDemand[1], 0 ) )  }
   "Write Proj:RunResults[7]:PropNatGasEnergy[1]" Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total Fuel,%g,therms,Proj:RunResults[7]:PropNatGasEnergy[1]\n", (ValidOr( RunResults[7]:PropNatGasEnergy[1], 0 ) + ValidOr( RunResults[7]:PropOtherEnergy[1], 0 )) * ValidOr( CondFloorArea, 0 ) / 100 )  }
   "Write Proj:RunResults[7]:ProposedTDV[1]"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total TDV,%g,kTDV/ft2-yr,Proj:RunResults[7]:ProposedTDV[1]\n", ValidOr( RunResults[7]:ProposedTDV[1], 0 ) )  }
   "Write Proj:RunResults[7]:PropTotalCarbon[1]"  Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total CO2,%g,kg,Proj:RunResults[7]:PropTotalCarbon[1]\n", ValidOr( RunResults[7]:PropTotalCarbon[1], 0 ) * ValidOr( CondFloorArea, 0 ) * 1000 )  }
END
;************************************************************************* 8
RULELIST "MxdFuelCmprReport_Results_Plugs" 1 0 0 0
   "Write Proj:RunResults[8]:PropElecEnergy[1]"   Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, "Plug Loads Energy Data,Proposed - Total Electric,%g,kWh,Proj:RunResults[8]:PropElecEnergy[1]\n", ValidOr( RunResults[8]:PropElecEnergy[1], 0 ) * ValidOr( CondFloorArea, 0 ) / 3.412 )  }
   "Write Proj:RunResults[8]:PropElecDemand[1]"   Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total Demand,%g,kW,Proj:RunResults[8]:PropElecDemand[1]\n", ValidOr( RunResults[8]:PropElecDemand[1], 0 ) )  }
   "Write Proj:RunResults[8]:ProposedTDV[1]"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total TDV,%g,kTDV/ft2-yr,Proj:RunResults[8]:ProposedTDV[1]\n", ValidOr( RunResults[8]:ProposedTDV[1], 0 ) )  }
   "Write Proj:RunResults[8]:PropTotalCarbon[1]"  Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total CO2,%g,kg,Proj:RunResults[8]:PropTotalCarbon[1]\n", ValidOr( RunResults[8]:PropTotalCarbon[1], 0 ) * ValidOr( CondFloorArea, 0 ) * 1000 )  }
END
;************************************************************************* 9
RULELIST "MxdFuelCmprReport_Results_ExtLtg" 1 0 0 0
   "Write Proj:RunResults[9]:PropElecEnergy[1]"   Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, "Exterior Lighting Energy Data,Proposed - Total Electric,%g,kWh,Proj:RunResults[9]:PropElecEnergy[1]\n", ValidOr( RunResults[9]:PropElecEnergy[1], 0 ) * ValidOr( CondFloorArea, 0 ) / 3.412 )  }
   "Write Proj:RunResults[9]:PropElecDemand[1]"   Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total Demand,%g,kW,Proj:RunResults[9]:PropElecDemand[1]\n", ValidOr( RunResults[9]:PropElecDemand[1], 0 ) )  }
   "Write Proj:RunResults[9]:ProposedTDV[1]"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total TDV,%g,kTDV/ft2-yr,Proj:RunResults[9]:ProposedTDV[1]\n", ValidOr( RunResults[9]:ProposedTDV[1], 0 ) )  }
   "Write Proj:RunResults[9]:PropTotalCarbon[1]"  Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Total CO2,%g,kg,Proj:RunResults[9]:PropTotalCarbon[1]\n", ValidOr( RunResults[9]:PropTotalCarbon[1], 0 ) * ValidOr( CondFloorArea, 0 ) * 1000 )  }
END
;************************************************************************* 13, 14
RULELIST "MxdFuelCmprReport_Results_PVBatt" 1 0 0 0
   "Write Proj:RunResults[13]:PropTotalCarbon[1]"  Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, "PV/Battery CO2 Data,Proposed - PV CO2,%g,kg,Proj:RunResults[13]:PropTotalCarbon[1]\n", ValidOr( RunResults[13]:PropTotalCarbon[1], 0 ) * ValidOr( CondFloorArea, 0 ) * 1000 )  }
   "Write Proj:RunResults[13]:StdTotalCarbon"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - PV CO2,%g,kg,Proj:RunResults[13]:StdTotalCarbon\n", ValidOr( RunResults[13]:StdTotalCarbon, 0 ) * ValidOr( CondFloorArea, 0 ) * 1000 )  }
   "Write Proj:RunResults[13]: Carbon margin"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Margin - PV CO2,%g,kg,\n",        (ValidOr( RunResults[13]:StdTotalCarbon, 0 ) - ValidOr( RunResults[13]:PropTotalCarbon[1], 0 )) * ValidOr( CondFloorArea, 0 ) * 1000 )  }
   "Write Proj:RunResults[14]:PropTotalCarbon[1]"  Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - Battery CO2,%g,kg,Proj:RunResults[14]:PropTotalCarbon[1]\n", ValidOr( RunResults[14]:PropTotalCarbon[1], 0 ) * ValidOr( CondFloorArea, 0 ) * 1000 )  }
   "Write Proj:RunResults[14]:StdTotalCarbon"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - Battery CO2,%g,kg,Proj:RunResults[14]:StdTotalCarbon\n", ValidOr( RunResults[14]:StdTotalCarbon, 0 ) * ValidOr( CondFloorArea, 0 ) * 1000 )  }
   "Write Proj:RunResults[14]: Carbon margin"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Margin - Battery CO2,%g,kg,\n",        (ValidOr( RunResults[14]:StdTotalCarbon, 0 ) - ValidOr( RunResults[14]:PropTotalCarbon[1], 0 )) * ValidOr( CondFloorArea, 0 ) * 1000 )  }
END
;*************************************************************************
RULELIST "MxdFuelCmprReport_Results_CO2ExpCons" 1 0 0 0
   "Write Proj:ResultSummary[1]:StdNoSolFlxCarbon"       Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, "CO2 Export/Consumed Data,Standard - CO2 Potential,%g,tonne,Proj:ResultSummary[1]:StdNoSolFlxCarbon\n", ValidOr( ResultSummary[1]:StdNoSolFlxCarbon, 0 ) )  }
   "Write Proj:ResultSummary[1]:StdSelfConsCarbon"       Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - CO2 Saved - Self Consumed,%g,tonne,Proj:ResultSummary[1]:StdSelfConsCarbon\n", ValidOr( ResultSummary[1]:StdSelfConsCarbon, 0 ) )  }
   "Write Proj:ResultSummary[1]:StdExportCarbon"         Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - CO2 Saved - Exported,%g,tonne,Proj:ResultSummary[1]:StdExportCarbon\n", ValidOr( ResultSummary[1]:StdExportCarbon, 0 ) )  }
   "Write Proj:ResultSummary[1]:StdFinalCarbon"          Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - CO2 Generated Total,%g,tonne,Proj:ResultSummary[1]:StdFinalCarbon\n", ValidOr( ResultSummary[1]:StdFinalCarbon, 0 ) )  }
   "Write Proj:ResultSummary[1]:StdExclExpCarbon"        Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Standard - CO2 Generated Minus Exports,%g,tonne,Proj:ResultSummary[1]:StdExclExpCarbon\n", ValidOr( ResultSummary[1]:StdExclExpCarbon, 0 ) )  }
   "Write Proj:ResultSummary[1]:PropNoSolFlxCarbon[1]"   Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - CO2 Potential,%g,tonne,Proj:ResultSummary[1]:PropNoSolFlxCarbon[1]\n", ValidOr( ResultSummary[1]:PropNoSolFlxCarbon[1], 0 ) )  }
   "Write Proj:ResultSummary[1]:PropSelfConsCarbon[1]"   Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - CO2 Saved - Self Consumed,%g,tonne,Proj:ResultSummary[1]:PropSelfConsCarbon[1]\n", ValidOr( ResultSummary[1]:PropSelfConsCarbon[1], 0 ) )  }
   "Write Proj:ResultSummary[1]:PropExportCarbon[1]"     Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - CO2 Saved - Exported,%g,tonne,Proj:ResultSummary[1]:PropExportCarbon[1]\n", ValidOr( ResultSummary[1]:PropExportCarbon[1], 0 ) )  }
   "Write Proj:ResultSummary[1]:PropFinalCarbon[1]"      Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - CO2 Generated Total,%g,tonne,Proj:ResultSummary[1]:PropFinalCarbon[1]\n", ValidOr( ResultSummary[1]:PropFinalCarbon[1], 0 ) )  }
   "Write Proj:ResultSummary[1]:PropExclExpCarbon[1]"    Proj:Action  = {  WriteToExportFile( MxdFuelCmprInpFileIdx, ",Proposed - CO2 Generated Minus Exports,%g,tonne,Proj:ResultSummary[1]:PropExclExpCarbon[1]\n", ValidOr( ResultSummary[1]:PropExclExpCarbon[1], 0 ) )  }
END
;*************************************************************************




;*************************************************************************
ENDFILE

